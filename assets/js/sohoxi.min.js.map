{"version":3,"sources":["../../src/utils/debug.js","../../src/utils/xss.js","../../src/utils/dom.js","../../src/utils/breakpoints.js","../../src/utils/debounced-resize.js","../../src/utils/debounced-resize.jquery.js","../../src/utils/environment.js","../../src/utils/behaviors.js","../../src/utils/utils.js","../../src/utils/string.js","../../src/components/locale/locale.js","../../src/utils/deprecated.js","../../src/utils/base.js","../../src/utils/renderloop.js","../../src/components/theme/theme.js","../../src/components/personalize/personalize.js","../../src/components/personalize/personalize.bootstrap.js","../../src/components/personalize/personalize.jquery.js","../../src/components/form/form.js","../../src/utils/highlight.js","../../src/components/arrange/arrange.js","../../src/components/arrange/arrange.jquery.js","../../src/components/drag/drag.js","../../src/components/drag/drag.jquery.js","../../src/components/place/place.js","../../src/components/place/place.jquery.js","../../src/components/icons/icons.js","../../src/components/icons/icons.jquery.js","../../src/components/button/button.js","../../src/components/button/button.jquery.js","../../src/components/hyperlinks/hyperlinks.js","../../src/components/hyperlinks/hyperlinks.jquery.js","../../src/components/mask/masks.js","../../src/components/mask/mask-api.js","../../src/components/mask/mask-input.js","../../src/components/mask/mask-input.jquery.js","../../src/components/popupmenu/popupmenu.js","../../src/components/popupmenu/popupmenu.jquery.js","../../src/components/about/about.js","../../src/components/about/about.jquery.js","../../src/utils/animations.js","../../src/components/accordion/accordion.js","../../src/components/accordion/accordion.jquery.js","../../src/utils/lifecycle.js","../../node_modules/promise-polyfill/src/index.js","../../node_modules/promise-polyfill/src/finally.js","../../src/components/listfilter/listfilter.js","../../src/components/tmpl/tmpl.js","../../src/components/autocomplete/autocomplete.js","../../src/components/autocomplete/autocomplete.jquery.js","../../src/components/searchfield/searchfield.js","../../src/components/searchfield/searchfield.jquery.js","../../src/components/applicationmenu/applicationmenu.js","../../src/components/applicationmenu/applicationmenu.jquery.js","../../src/components/blockgrid/blockgrid.js","../../src/components/blockgrid/blockgrid.jquery.js","../../src/components/busyindicator/busyindicator.js","../../src/components/busyindicator/busyindicator.jquery.js","../../src/components/charts/charts.js","../../src/components/bullet/bullet.js","../../src/components/completion-chart/completion-chart.js","../../src/components/sparkline/sparkline.js","../../src/components/emptymessage/emptymessage.js","../../src/components/emptymessage/emptymessage.jquery.js","../../src/components/line/line.js","../../src/components/column/column.js","../../src/components/bar/bar.js","../../src/components/pie/pie.js","../../src/components/radar/radar.js","../../src/components/charts/charts.jquery.js","../../src/components/monthview/monthview.js","../../src/components/calendar/calendar.js","../../src/components/calendar/calendar.jquery.js","../../src/components/circlepager/circlepager.js","../../src/components/circlepager/circlepager.jquery.js","../../src/components/colorpicker/colorpicker.js","../../src/components/colorpicker/colorpicker.jquery.js","../../src/components/expandablearea/expandablearea.js","../../src/components/expandablearea/expandablearea.jquery.js","../../src/components/compositeform/compositeform.js","../../src/components/compositeform/compositeform.jquery.js","../../src/components/contextualactionpanel/contextualactionpanel.js","../../src/components/contextualactionpanel/contextualactionpanel.jquery.js","../../src/components/tooltip/tooltip.js","../../src/components/tooltip/tooltip.jquery.js","../../src/components/popover/popover.jquery.js","../../src/components/dropdown/dropdown.js","../../src/components/dropdown/dropdown.jquery.js","../../src/components/timepicker/timepicker.js","../../src/components/timepicker/timepicker.jquery.js","../../src/components/validation/validation.js","../../src/components/toast/toast.js","../../src/components/toast/toast.jquery.js","../../src/components/validation/validator.js","../../src/components/validation/validation.jquery.js","../../src/components/validation/validation.utils.js","../../src/components/datepicker/datepicker.js","../../src/components/datepicker/datepicker.jquery.js","../../src/components/editor/editor.js","../../src/components/editor/editor.jquery.js","../../src/components/hierarchy/hierarchy.js","../../src/components/hierarchy/hierarchy.jquery.js","../../src/components/field-filter/field-filter.js","../../src/components/field-filter/field-filter.jquery.js","../../src/components/field-options/field-options.js","../../src/components/field-options/field-options.jquery.js","../../src/components/fileupload/fileupload.js","../../src/components/fileupload/fileupload.jquery.js","../../src/components/fileupload-advanced/fileupload-advanced.js","../../src/components/fileupload-advanced/fileupload-advanced.jquery.js","../../src/components/homepage/homepage.js","../../src/components/homepage/homepage.jquery.js","../../src/components/pager/pager.js","../../src/components/pager/pager.jquery.js","../../src/components/listview/listview.js","../../src/components/listview/listview.jquery.js","../../src/components/listbuilder/listbuilder.js","../../src/components/listbuilder/listbuilder.jquery.js","../../src/components/modal/modal.js","../../src/components/message/message.js","../../src/components/message/message.jquery.js","../../src/components/modal/modal.jquery.js","../../src/components/monthview/monthview.jquery.js","../../src/components/multiselect/multiselect.js","../../src/components/multiselect/multiselect.jquery.js","../../src/components/notification/notification.js","../../src/components/notification/notification.jquery.js","../../src/components/progress/progress.js","../../src/components/progress/progress.jquery.js","../../src/components/popdown/popdown.js","../../src/components/popdown/popdown.jquery.js","../../src/components/rating/rating.js","../../src/components/rating/rating.jquery.js","../../src/components/signin/signin.js","../../src/components/signin/signin.jquery.js","../../src/components/slider/slider.js","../../src/components/slider/slider.jquery.js","../../src/components/zoom/zoom.js","../../src/components/zoom/zoom.jquery.js","../../src/components/spinbox/spinbox.js","../../src/components/spinbox/spinbox.jquery.js","../../src/components/splitter/splitter.js","../../src/components/splitter/splitter.jquery.js","../../src/components/swaplist/swaplist.js","../../src/components/swaplist/swaplist.jquery.js","../../src/components/scrollaction/scrollaction.js","../../src/components/scrollaction/scrollaction.jquery.js","../../src/components/stepchart/stepchart.js","../../src/components/stepchart/stepchart.jquery.js","../../src/components/tabs/tabs.js","../../src/components/tabs/tabs.jquery.js","../../src/components/tag/tag.js","../../src/components/tag/tag.jquery.js","../../src/components/textarea/textarea.js","../../src/components/textarea/textarea.jquery.js","../../src/components/toolbar/toolbar.js","../../src/components/toolbar/toolbar.jquery.js","../../src/components/toolbar-flex/toolbar-flex.item.js","../../src/components/toolbar-flex/toolbar-flex.item.jquery.js","../../src/components/toolbar-flex/toolbar-flex.js","../../src/components/toolbar-flex/toolbar-flex.jquery.js","../../src/components/searchfield/toolbarsearchfield.jquery.js","../../src/components/trackdirty/trackdirty.js","../../src/components/trackdirty/trackdirty.jquery.js","../../src/components/tree/tree.js","../../src/components/tree/tree.jquery.js","../../src/components/treemap/treemap.js","../../src/components/treemap/treemap.jquery.js","../../src/components/wizard/wizard.js","../../src/components/wizard/wizard.jquery.js","../../src/components/datagrid/datagrid.formatters.js","../../src/components/datagrid/datagrid.editors.js","../../src/utils/excel.js","../../src/components/datagrid/datagrid.groupby.js","../../src/components/datagrid/datagrid.js","../../src/components/datagrid/datagrid.jquery.js","../../src/components/form-compact/form-compact.js","../../src/components/form-compact/form-compact.jquery.js","../../src/components/header/header.js","../../src/components/header/header.jquery.js","../../src/components/lookup/lookup.js","../../src/components/lookup/lookup.jquery.js","../../src/components/tabs-multi/multi-tabs.js","../../src/components/tabs-multi/multi-tabs.jquery.js","../../src/patterns/list-detail/list-detail.js","../../src/patterns/list-detail/list-detail.jquery.js","../../src/patterns/stepprocess/stepprocess.js","../../src/patterns/stepprocess/stepprocess.jquery.js","../../src/behaviors/initialize/initialize.js","../../src/behaviors/initialize/initialize.jquery.js","../../src/behaviors/longpress/longpress.js","../../src/components/personalize/personalize.hooks.js"],"names":["log","type","message","label","xssUtils","str","newStr","replace","html","allowed","whitelist","toLowerCase","match","join","tags","$0","$1","indexOf","santizedHtml","string","this","stripTags","value","newValue","map","&","<",">","\"","'","String","url","length","DOM","element","HTMLElement","SVGElement","attributes","cn","className","el","classList","RegExp","test","classAttr","getAttribute","_len","arguments","Array","_key","i","add","hasClass","_len2","_key2","remove","newClassName","classes","split","j","$","isElement","rect","getBoundingClientRect","rectObj","prop","isNaN","contents","domEl","insertAdjacentHTML","xssClean","parentNode","removeChild","attribute","setAttribute","markup","sanitizeHTML","innerHTML","breakpoints","phone","slim","phablet","phone-to-tablet","wide-tablet","tablet-to-desktop","desktop","desktop-to-extralarge","debounce","func","threshold","execAsap","timeout","args","obj","clearTimeout","apply","setTimeout","current","afterElement","window","getComputedStyle","document","body","getPropertyValue","isAbove","breakpoint","bp","width","isBelow","compare","last","cur","triggerHandler","previous","isHidden","cl","contains","size","phonedown","tablet","extralarge","hiddenClassName","visibleClassName","toString","fn","isHiddenAtBreakpoint","first","bind","trigger","UTIL_NAME","Environment","browser","features","touch","navigator","MaxTouchPoints","msMaxTouchPoints","os","devicespecs","rtl","attr","set","addBrowserClasses","addGlobalResize","addGlobalEvents","addDeviceSpecs","ua","userAgent","vendor","opera","platform","cssClasses","name","version","appVersion","documentMode","iDevices","device","addClass","nAppVer","nUAgent","appName","parseFloat","majorVersion","parseInt","nameOffset","verOffset","ix","substring","lastIndexOf","toUpperCase","mobile","clientStrings","s","r","id","cs","osVersion","exec","currentBrowser","browserVersion","browserMajorVersion","isMobile","currentOSVersion","debouncedResize","on","_this","self","globalMouseActive","globalTouchActive","e","preventDefault","scrollTop","target","removeGlobalEvents","off","HideFocus","init","smoothScrollTo","duration","dfd","Deferred","reject","resolve","Math","round","fail","scrollLeft","startTime","Date","now","endTime","startLeft","distance","previousLeft","scrollFrame","point","start","end","x","smoothStep","frameLeft","defer","callback","timer","requestAnimationFrame","isIE11","isIE10","prototype","$el","isClick","isFocused","labelClicked","is","next","removeClass","handleMousedown","env","updated","teardown","hideFocus","each","instance","data","destroy","removeData","smoothScroll","bindFirst","handlers","_data","handler","pop","splice","uniqueIdCount","visible","expr","filters","parents","addBack","filter","css","cssPropSupport","propStr","prefixes","capitalizedProp","charAt","substr","style","vendorProp","transitionEndName","WebkitTransition","MozTransition","MSTransition","OTransition","transition","extend","focusable","mapName","img","nodeName","isTabIndexNotNaN","href","disabled","undefined","listEvents","utils","isValidOptions","o","_typeof","resolveFunctionBasedSettings","uniqueId","prefix","suffix","predefinedId","getArrayFromList","parseSettings","options","changedStr","regex","replaceDoubleQuotes","JSON","parse","err","parseOptions","results","targets","item","push","coerceToBoolean","b","coerceSettingsToBoolean","settings","targetPropsArr","isArray","Object","keys","forEach","key","l","delay","speed","interval","counter","update","setInterval","clearInterval","event","cancel","pause","resume","copyToClipboard","text","clipboardData","setData","queryCommandSupported","textarea","createElement","textContent","position","appendChild","select","execCommand","ex","clearable","xButton","find","createIconElement","icon","clear","val","focus","checkContents","handleKeydown","altKey","insertAfter","tabIndex","elemEvents","actualChar","which","toAscii","188","190","191","192","220","222","221","219","173","187","186","189","shiftUps","96","49","50","51","52","53","54","55","56","57","48","45","61","91","93","92","59","37","38","39","44","46","47","hasOwnProperty","call","shiftKey","fromCharCode","equals","a","stringify","convertToHTMLElement","fixSVGIcons","rootElement","xlinkNS","elem","NodeList","uses","getElementsByTagName","getAttributeNS","setAttributeNS","getViewportSize","max","documentElement","clientWidth","innerWidth","height","clientHeight","innerHeight","getContainerScrollDistance","containers","left","top","getHiddenSize","defaults","dims","outerWidth","outerHeight","parentElement","includeMargin","hasDefinedParentElement","clone","appendTo","hiddenParents","props","webkitTransition","mozTransition","msTransition","visibility","display","oldProps","old","padding","bottom","right","scrollWidth","scrollHeight","_this2","isString","isNumber","safeSetSelection","startPos","endPos","activeElement","setSelectionRange","mergeSettings","incomingOptions","defaultOptions","isHTML","math","Error","fps","Infinity","array","scope","classStr","sign","listObj","unboundSlice","slice","Function","getScrollbarWidth","outer","widthNoScroll","offsetWidth","overflow","inner","widthWithScroll","stringUtils","delCount","newSubStr","abs","pos","num","fontsize","canvas","context","getContext","font","metrics","measureText","year","month","day","textWidth","canvasTW","escapeRegExp","existingCulturePath","babelHelpers.typeof","SohoConfig","culturesPath","Locale","currentLocale","currentLanguage","cultures","languages","defaultLocales","lang","default","supportedLocales","defaultLocale","updateLanguage","isRTL","removeAttr","flipIconsHorizontally","getCulturesPath","scripts","src","idx","cultureInHead","isThere","correctLocale","locale","correctLanguage","addCulture","langData","direction","nativeName","messages","appendLocaleScript","isCurrent","useLocale","script","onload","setCurrentLocale","dff","onerror","nonce","head","promise","dataName","getLocale","setLanguage","done","formatDate","date","localeData","tDate2","parseDate","pattern","ret","cal","calendars","dateFormat","short","getFullYear","getMonth","getDate","dayOfWeek","getDay","hours","getHours","mins","getMinutes","seconds","getSeconds","millis","getMilliseconds","conversions","fromGregorian","islamicParts","toGregorian","gregorianDate","pad","months","wide","abbreviated","dayPeriods","days","timezoneDate","shortName","getTimeZone","longName","trim","timeZoneName","time","toLocaleTimeString","toTimeString","dateToTimeZone","timeZone","toLocaleString","dateToUTC","UTC","number","convertNumberToEnglish","arabic","devanagari","chineseFinancialTraditional","chineseFinancialSimplified","chinese","isValidDate","getTime","dateString","isStrict","thisLocaleCalendar","calendar","orgDatestring","formatParts","dateStringParts","dateObj","isDateTime","isUTC","shortTimeZone","longTimeZone","lastIdx","lastChar","newFormat","newDateString","getDatePart","hasDays","numberValue","lastDay","abrMonth","textMonths","len","k","twoToFourDigitYear","h","ss","ms","mm","return","leapYear","isUndefindedYear","isUndefindedMonth","isUndefindedDay","twoDigitYear","filter1","filter2","filter3","filter4","numbers","useLanguage","languageData","language","formatNumber","formattedNum","curFormat","percentFormat","decimal","minimumFractionDigits","maximumFractionDigits","currencySign","format","currencyFormat","percentSign","parseNumber","toFixed","parts","truncateDecimals","groupSizes","sep","group","expandedNum","expandNumber","minusSign","isNegative","escape","decimalPlaces","floor","numberString","firstGroup","nthGroup","reversed","reverse","minDigits","maxDigits","multiplier","pow","adjustedNum","truncatedNum","decimals","input","numSettings","numString","NaN","translate","showAsUndefined","extendTranslations","base","separator","timeSeparator","medium","long","full","timestamp","datetime","timeFormat","n","z","toLocaleUpperCase","toLocaleLowerCase","capitalize","capitalizeWords","words","icons","iconName","getIconName","inArray","closest","methodName","method","result","warnAboutDeprecation","newMethod","oldMethod","newMethodName","oldMethodName","console","warn","deprecateMethod","wrapper","Base","location","hash","getCurrentURL","getBaseURL","RENDERLOOP_DEFAULTS","noAutoStart","instanceSettings","performance","RenderLoopItem","opts","updateDuration","setFuncs","paused","elapsedTime","RenderLoop","items","renderLoop","updateCallback","timeoutCallback","noTimeout","doRemoveOnNextTick","doLoop","deltaTime","tick","loopItem","modifiedArgs","timeUntilNextUpdate","delta","stop","totalDuration","queue","buildRenderLoopItem","namespace","noNamespace","numberDuration","Number","register","unregister","cb","getFromQueue","retreivedItem","removedItem","pausedItem","resumableItem","theme","currentTheme","allColors","colors","themes","themeColors","color","palette","personalizationColors","personalize","amber","backgroundColorClass","amethyst","azure","emerald","graphite","ruby","slate","turquoise","setTheme","themeId","themeObj","PERSONALIZE_DEFAULTS","blockUI","Personalize","cssTheme","getThemeFromStylesheet","setColors","handleEvents","newColor","noAnimate","thisTheme","validateHex","hex","appendStyleSheet","cssRules","sheet","getElementById","createTextNode","getColorStyleSheet","header","defaultColors","subheader","getLuminousColorShade","button","inactive","verticalBorder","horizontalBorder","hover","btnColorHeader","btnColorSubheader","lum","rgb","c","min","path","queryParamIndex","incomingTheme","blockUi","originalCss","newCss","unBlockUi","themePath","isMin","before","backgroundColor","pageOverlay","append","fadeOut","personalization","disable","index","jQuery","enable","readonly","control","addCssClassToParent","elemArray","cssClass","parent","querySelectorAll","querySelector","elements","rules","highlight","pat","innerHighlight","node","skip","spannode","middlebit","middleclone","nodeType","splitText","cloneNode","replaceChild","childNodes","tagName","unhighlight","firstChild","normalize","ARRANGE_DEFAULTS","handle","itemsSelector","connectWith","isVisualItems","placeholder","placeholderCssClass","Arrange","isTouch","isIe","getElementByTouchInList","list","y","returns","listJq","offset","dragTouchElement","elm","orig","originalEvent","changedTouches","pageY","pageX","unbind","dragStart","dragEnd","dragWhileDragging","getVisualIndex","children","not","isHandle","status","placeholders","dragDrop","dragging","startIndex","placeholderTouch","insertBefore","dt","dataTransfer","effectAllowed","after","show","detach","endIndex","overItem","overIndex","stopPropagation","touches","dropEffect","hide","over","arrange","DRAG_DEFAULTS","axis","cloneCssClass","clonePosIsFixed","cloneAppendTo","containment","obstacle","underElements","containmentOffset","Drag","finish","getElementsFromPoint","upperYLimit","upperXLimit","move","container","elemOffset","elemWidth","movingRight","obstacleOffset","constraints","originalPos","applyCssStyle","applyCss","elementsFromPoint","msElementsFromPoint","d","pointerEvents","elementFromPoint","priority","getPropertyPriority","setProperty","targetTouches","xpos","ypos","mouseMoveEvent","docMouseUpEvent","mouseUpEvent","drag","DEFAULT_PLACE_SETTINGS","bleedFromContainer","parentXAlignment","parentYAlignment","placement","strategies","PLACE_STRATEGIES","PLACE_POSITIONS","PLACE_X_ALIGNMENTS","PLACE_Y_ALIGNMENTS","PLACEMENT_OBJECT_SETTING_KEYS","PlacementObject","placementOptions","setCoordinate","modified","sanitize","Place","isReasonableDefault","setting","limits","containerOffsetX","containerOffsetY","useParentHeight","useParentWidth","strat","coordinate","build","originalStyles","w","place","render","placementObj","unitRegex","curr","clearOldStyles","placeWithParent","placeWithCoords","parentRect","getDimensions","elRect","getContainer","containerIsBody","scrollX","scrollY","doPlacementAgainstParent","incomingPlacementObj","coords","p","aX","aY","cX","cY","cW","getCoordsFromPlacement","handlePlacementCallback","checkBleeds","bleeds","nudge","clockwise","flip","originalx","originaly","shrink","accountForScrolling","containerStyle","modalParent","containerBleed","BoundingRect","containerRect","windowH","windowW","getBoundary","edge","rightViewportEdge","newWidth","bottomViewportEdge","newHeight","offRightEdge","offLeftEdge","offTopEdge","offBottomEdge","nudges","wasNudged","attemptedFlips","giveup","isXCoord","getOppositeDir","dir","getDistance","tried","originalDir","newDir","perpendicularDir","oppPerpendicularDir","originalDistance","targetDistance","wasFlipped","tmp","perpendicularDistance","oppPerpendicularDistance","performFlip","dimension","useX","useY","leftViewportEdge","topViewportEdge","strategy","setArrowPosition","arrow","targetRect","elementRect","arrowRect","newArrowRect","hideArrow","removeAttribute","opposite","positionOpts","ICON_DEFAULTS","use","Icon","getExistingUseTag","getBasedUseTag","useTag","xlinkHref","normalizeIconOptions","class","concat","createIcon","createIconPath","changeIcon","svg","BUTTON_DEFAULTS","toggleOnIcon","toggleOffIcon","hideMenuArrow","replaceText","Button","isSafari","isFirefox","ddIcon","hasIcon","isPressed","toggleClass","tooltip","content","btnOffset","xPos","yPos","ripple","prepend","animateWithJS","elStyle","scale","opacity","animate","moreTooltip","HYPERLINK_DEFAULTS","Hyperlink","previousSettings","focusBehavior","hyperlink","masks","EMPTY_STRING","PLACEHOLDER_CHAR","CARET_TRAP","NON_DIGITS_REGEX","DIGITS_REGEX","ALPHAS_REGEX","ANY_REGEX","DEFAULT_API_OPTIONS","pipe","LEGACY_DEFS","#","0","*","?","~","m","DEFAULT_CONFORM_OPTIONS","caretTrapIndexes","guide","previousMaskResult","placeholderChar","selection","keepCharacterPositions","DEFAULT_NUMBER_MASK_OPTIONS","allowThousandsSeparator","symbols","currency","negative","thousands","allowDecimal","decimalLimit","requireDecimal","allowNegative","allowLeadingZeroes","integerLimit","convertToMask","strNumber","char","getRegexForPart","part","types","any","digits","alphas","arr","numberMask","rawValue","PREFIX","SUFFIX","DECIMAL","THOUSANDS","prefixLength","suffixLength","thousandsSeparatorSymbolLength","thisRawValue","rawValueLength","indexOfLastDecimal","hasDecimal","integer","fraction","mask","thousandsSeparatorRegex","numberOfThousandSeparators","localeOptions","useGrouping","addThousandsSeparator","instanceOf","DEFAULT_DATETIME_MASK_OPTIONS","dayPeriodSeparator","dateSeparator","DATE_MAX_VALUES","dd","MMM","MM","M","yy","yyyy","hh","H","HH","MaskAPI","configure","dateMask","digitRegex","splitterStr","removeDuplicates","splitterRegex","formatArray","rawValueArray","maxValue","rawValueStr","rawValueFirstDigit","maxFirstDigit","nextPart","thisPartSize","literals","rangeDateMask","delimeter","delimiterArr","firstDate","secondDate","autocorrectedDatePipe","processResult","indexesOfPipedChars","dateFormatArray","minValue","conformedValueArr","conformedValue","placeholderRegex","maskPieces","conformedPieces","some","textValue","characterIndexes","defs","definitions","_convertPatternFromString","patternOptions","process","providedMask","originalValue","caretPos","maskResult","maskOpts","caretTrapInfo","_processCaretTraps","maskWithoutCaretTraps","indexes","_conformToMask","pipeResult","pipedValue","pipedCharIndexes","_convertMaskToPlaceholder","charactersRejected","suppressGuide","prevMaskResultLength","maskLength","placeholderLength","resultStr","editDistance","isAddition","indexOfFirstChange","indexOfLastChange","compensatingPlaceholderChars","rawValueArr","isNew","shouldOffset","placeholderLoop","charInPlaceholder","rawValueChar","shift","rawValueArrLength","indexOfNextAvailablePlaceholderChar","charData","indexOfLastFilledPlaceholderChar","indexOfCaretTrap","adjustCaretPosition","nonPlaceholderFilter","previousConformedValueLength","conformedValueLength","editLength","possiblyHasRejectedChar","startingSearchIndex","trackRightCharacter","targetChar","normalizedConformedValue","intersection","previousLeftMaskChars","previousPlaceholder","masklengthChanged","targetIsMaskMovingLeft","pipedChars","countTargetCharInPipedChars","countTargetCharInIntersection","requiredNumberOfMatches","numberOfEncounteredMatches","lastPlaceholderChar","legacyKeys","DEFAULT_MASK_INPUT_OPTIONS","maskAPI","processOnBlur","processOnInitialize","MaskInput","setLocale","_replaceLegacySettings","datepicker","state","focusEventHandler","initialValue","addEventListener","inputEventHandler","blurEventHandler","readOnly","_hasChangedValue","_isEdgeIE","api","posBegin","selectionStart","posEnd","selectionEnd","_isAndroid","_getSafeRawValue","processed","finalValue","adjustCaretOpts","previousValue","inputValue","modes","html5DataMask","html5DataMaskMode","mode","thousandsSeparator","html5DataThousands","thousandsSep","hasThousandsInPattern","decimalParts","html5DataMustComplete","mustComplete","showSymbol","symbolSetting","symbol","detectableSymbol","replacementRegex","symbolWithWhitespace","placementType","removeEventListener","maskinput","maskedinput","POPUPMENU_DEFAULTS","menu","autoFocus","mouseFocus","attachToBody","removeOnDestroy","beforeOpen","ariaListbox","eventObj","returnFocus","showArrow","triggerSelect","placementOpts","predefined","duplicateMenu","PopupMenu","setup","addMarkup","iconFilteringSetup","open","isOpen","menuId","predefinedItems","triggerId","preExistingWrapper","originalParent","prev","wrap","popup","containerClass","addFieldShort","markupItems","renderItem","wrapMenuItems","settingsArr","menuObj","template","stripWhitespace","headingText","sectionSelectClass","heading","nextSectionSelect","iconsClass","hasIcons","noMenuWrap","disabledClass","hiddenClass","selectableClass","submenuClass","submenu","ddicon","selectable","toData","contextElement","liData","decodeListItem","li","submenuItem","submenuLiData","lis","span","submenuWrapper","$a","$li","classNameExists","refreshMenuItem","itemA","itemIcon","itemIconUse","innerText","submenuItems","isSubmenuItem","leftClick","disableBrowserContextMenu","contextMenuHandler","isLeftClick","keydownThenClick","btn","holdingDownClick","rightClick","close","doOpen","originalE","openedWithTouch","handleKeys","handleItemClick","excludes","stopImmediatePropagation","checkbox","isPicker","isAutocomplete","getPrev","getLast","getNext","getFirst","prevs","prevAll","targetA","nexts","nextAll","rowCount","colorsLength","currentOffsetTop","colorItem","offsetTop","openSubmenu","anchor","selectionResult","iconFilteringUpdate","isInSelectableSection","isInMultiselectSection","alink","link","audibleText","getPositionFromEvent","clientX","clientY","mouse","menuDimensions","offsetHeight","getCoordinates","toolbarParent","insideToolbar","insideToolbarTitle","isNotFullToolbar","isPagerMenu","alignRight","alignLeft","one","thisE","positionObj","handleAfterPlace","wrapperPlace","callSource","isSubmenu","targetMenu","response","newContent","callbackOpts","ajaxReturn","useDelay","tooltipAPI","openDropdown","dropDownApi","closeList","zIndex","orientation","handleCloseEvent","frame","ready","tracker","startY","menuToClose","menuitem","documentE","isLeft","canClose","canOpen","showSubmenu","ul","wrapperWidth","wrapperLeft","menuWidth","menuHeight","differenceFromBottomY","mainWrapperOffset","singleMenu","multipleMenu","singleSection","isInSingleSelectSection","multipleSection","returnObj","prevUntil","nextUntil","getSelected","isCancelled","noFocus","triggerElement","menuElement","ajaxContent","insertTarget","searchfield","unwrap","popupmenu","ABOUT_DEFAULTS","copyrightYear","deviceSpecs","productName","useDefaultCopyright","About","isBody","defaultCopyright","modal","viewBox","title","productAndVersion","specs","getDeviceSpecs","cookiesEnabled","buttons","userLanguage","cookieEnabled","modalApi","about","ANIMATE_OPEN_DEFAULTS","timing","animateOpen","eventName","$self","dim","cDim","transitionEndCallback","prevVal","endVal","ANIMATE_CLOSED_DEFAULTS","animateClosed","isAnimating","ACCORDION_DEFAULTS","allowOnePane","displayChevron","enableTooltips","rerouteOnLinkClick","source","Accordion","headers","setupTooltips","noFilterReset","anchors","panes","isGlobalBuild","headersHaveIcons","containerPane","isTopLevel","checkIfIcons","outerIcon","role","aria-hidden","expander","expanderIcon","isActive","isExpanded","expanderIconOpts","description","pane","aria-haspopup","collapse","targetsToExpand","expand","currentlyFiltered","handleHeaderClick","isDisabled","isFiltered","handleAnchorClick","ngLink","originalSelection","closePopups","toggle","isControllingDetails","handleExpanderClick","setInitialOriginalSelection","ascend","prevHeader","descend","nextHeader","flatten","addElementReference","buildHeaderJSON","parentNesting","parentArr","headerData","subheaders","subheaderData","targetArray","subitem","parentsUntil","Element","dontCollapseHeaders","continueExpand","headerParents","collapseDfds","expandDfds","handleAfterExpand","_$","when","expandAll","_$2","dfds","always","closeChildren","handleAfterCollapse","collapseAll","_$3","animationCallback","ui","getElements","eventTarget","noDescend","adjacentHeaders","currentIndex","get","ensureAlphaNumeric","focusOriginalType","doReset","_this3","collapsePromise","then","toFilter","allParentHeaders","parentPanes","parentHeaders","expandPromise","unfilter","_this4","currentFocus","globalEventTeardown","headerElems","iconAPI","headerWhereMouseDown","globalEventSetup","clickInterceptor","elementType","getElementType","hideTooltip","_this5","removeTooltipData","selector","tooltipTimer","extraClass","accordion","EXCLUDED_FROM_CLOSE_CHILDREN","EXCLUDED_FROM_HANDLE_RESIZE","canCall","canAccessAPI","findControlsOnElements","elems","foundControls","dataEntry","triggerAPIMethod","siftFor","rootElem","filteredOutElements","DOMelements","siftedControls","handleResize","setTimeoutFunc","noop","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","deferred","_immediateFn","onFulfilled","onRejected","finale","thisArg","_unhandledRejectionFn","reason","prom","constructor","all","remaining","res","race","values","setImmediate","filterModes","LISTFILTER_DEFAULTS","caseSensitive","filterMode","searchableTextCallback","ListFilter","preset","checks","term","isJQuery","getSearchableContent","thisItem","targetContent","makeArray","keywords","keyword","Tmpl","compile","invert","output","ctx","_loop","childCode","depth","inverted","","code","raw","comment","isRaw","partial","Option","AUTOCOMPLETE_DEFAULTS","sourceArguments","autoSelectFirstItem","highlightMatchedText","highlightCallback","targetProp","hasAlias","alias","originalItem","testContent","resultIteratorCallback","dataset","highlightTarget","listItemId","hasValue","clearResultsCallback","displayResultsCallback","Autocomplete","listFilterSettings","listFilter","autocomplete","isLoading","openList","empty","templateAttr","tmpl","DEFAULT_AUTOCOMPLETE_TEMPLATE","filterResult","modifiedFilterResults","filterOpts","currentDataSet","handleListResults","popupOpts","renderedTmpl","maxWidth","noSelect","checkActiveElement","domListParent","dontClosePopup","listIsOpen","handleAutocompleteKeydown","highlighted","getHighlighted","keyCode","eq","handleAutocompleteInput","getDataFromSource","activeElem","field","buffer","searchTerm","deferredStatus","loadingTimeout","sourceType","sourceData","keywordData","mergeData","dataItem","isExists","ii","keywordItem","iii","getOwnPropertyNames","doneData","sourceURL","request","getJSON","resetFilters","handleAutocompleteFocus","allAnchors","anchorOrEvent","isEvent","Event","currentTarget","dataIndex","dataValue","stripHTML","handleAfterListOpen","stringSource","modifiedSettings","SEARCHFIELD_COLLAPSE_MODES","SEARCHFIELD_DEFAULTS","resultsCallback","allResultsCallback","showAllResults","showGoButton","goButtonCopy","goButtonAction","categories","categoryMultiselect","showCategoryText","collapsible","SearchField","isContainedByFlexToolbar","toolbarParents","toolbarFlexParents","buttonsetElem","titleElem","containmentParent","moduleTabs","categoryButton","isCollapsible","isCurrentlyCollapsible","shouldBeFullWidth","toolbarFlexItem","autocompleteAPI","isContextSearch","coerceBooleanSettings","setupEvents","inlineLabel","isInlineLabel","autocompleteDataAttr","aria-label","prependTo","customClasses","collapsibleOnMobile","hasCategories","setCategories","categoryListType","removeListType","setCategoryButtonText","collapseButton","goButton","resizeTimer","calculateSearchfieldWidth","simpleAdjustOnBreakpoint","adjustOnBreakpoint","appendToParent","calculateOpenWidth","setOpenWidth","appendToButtonset","saveFocus","focusElem","restoreFocus","focusTimer","elemBeforeWrapper","headerCondition","shouldExpandOnMobile","hasGoButton","handleFocus","handleSafeBlur","handleClick","handlePopupBeforeOpen","handleCategorySelected","handleCategoryFocus","handleGoButtonClick","handleGoButtonFocus","handleBlur","collapseResponsive","addMoreLink","addNoneLink","setAsActive","force","doFocus","addDocumentDeactivationEvents","wrapperClasses","active","autocompleteListElem","has","hasFocus","blurTimer","removeDocumentDeactivationEvents","clearResponsiveState","hasDeactivationEvents","handleOutsideClick","handleOutsideKeydown","isSearchfieldElement","keyName","ctrlKey","isExpanding","contextClassMethod","altClassMethod","action","searchfieldValue","categorySelection","getCategoryData","getSelectedCategories","getFillSize","leftBoundary","rightBoundary","leftBoundaryNum","rightBoundaryNum","boundary","getEdgeFromBoundary","edges","setClosedWidth","closedWidth","buttonStyle","borderLeftWidth","paddingLeft","paddingRight","subtractWidth","openWidth","categoryButtonStyle","goButtonStyle","buttonset","nextElem","baseWidth","targetWidthProp","computedStyle","getCategories","onlyReturnSelected","checked","category","updateCategories","valueTypes","previouslySelected","selected","isCollapsing","notFullWidth","buttonsetWidth","containerSizeSetters","eventArgs","expandTimer","collapseTimer","previouslyCollapsedByKey","focused","textMethod","more","moreLink","none","noneLink","APPLICATIONMENU_DEFAULTS","dismissOnClickMobile","filterable","openOnLarge","triggers","onExpandSwitcher","onCollapseSwitcher","ApplicationMenu","hasTrigger","hasTriggers","dataBreakpoint","modifyTriggers","scrollTarget","masthead","accordionAPI","filterResultsCallback","openMenu","adjustHeight","switchTrigger","switcherPanel","getAdjacentContainerElement","handleTriggerEvents","closeMenu","handleKeyDown","notify","tag","isSticky","isLargerThanBreakpoint","testWidth","userOpened","userClosed","openedByClass","transitionEnd","transitonEndName","trig","norebuild","changed","handleSearchfieldInputEvent","filteredParentHeaders","handleDismissOnClick","blur","sfAPI","applicationmenu","BLOCKGRID_DEFAULTS","paging","pagesize","pagesizes","Blockgrid","pagerAPI","selectedRows","handlePaging","activeBlock","isCheckbox","selectBlock","previousFocusedElement","pager","componentAPI","allBlocks","allChecks","activeCheckbox","isChecked","isActivated","row","blockelements","displayedDataset","selectText","pagerInfo","pages","trueActivePage","activePage","firstRecordIdx","lastRecordIdx","checkedIdxs","tabindex","image","maintxt","subtxt","subtitle","renderBlock","blockgrid","BUSYINDICATOR_DEFAULTS","displayDelay","timeToComplete","transparentOverlay","overlayOnly","BusyIndicator","inlineLabelText","completionTime","loadingText","isDelayDefined","activate","closeTimeout","aria-live","loader","transparency","originalPositionProp","overlay","pseudoElem","setCssStyle","addScrollParent","fromEvent","removeScrollParent","bar1","bar2","bar3","bar4","bar5","t","scrollParent","getScrollParent","scrollParentHeight","locTop","properties","styleMerged","reduce","isScroll","found","busyindicator","charts","isIE","isIEEdge","tooltipSize","formatToSettings","formatter","d3","percentRound","appendTooltip","classed","removeTooltip","colorRange","colorNameRange","scaleOrdinal","range","colorNames","chartColor","chartType","specifiedColor","chartColorName","showTooltip","addLegend","series","isTwoColumn","legend","showMobile","currentWidth","widthPercent","option","seriesLine","hexColor","colorName","textBlock","percent","pct","legendPlacement","float","margin","legendAbbrName","replaceWith","legendShortName","handleElementClick","line","selectAll","nodes","isGrouped","isSingle","isStacked","clickedLegend","datum","selectionObj","selectElement","selectionInverse","inverse","isSelected","triggerData","isEmptyObject","setSelectedElement","isPositiveNegative","isBar","isTypePie","isTypeColumn","taskSelected","task","isPositive","ticksX","ticksY","pnPositiveText","pnNegativeText","pnTargetText","thisGroup","thisGroupId","selectedBars","thisData","isTargetBar","bar","thisArcData","thisIndex","groupIndex","groupElem","groupItems","isTrigger","setSelected","isToggle","internals","groups","legendsNode","isPie","nextSibling","legends","isLegends","barIndex","isStackedGroup","xGroup","setSelectedBar","g","isGroup","fieldName","fieldValue","chartData","groupName","groupValue","labelsColide","ticks","collides","d1","rect1","rect2","d2","applyAltLabels","dataArray","isNoEclipse","triggerContextMenu","labelFactor","word","lineNumber","lineHeight","dy","tspan","getComputedTextLength","BULLET_DEFAULTS","redrawOnResize","Bullet","tooltipInterval","tooltipDataCache","tooltipData","noMarkers","rowData","ranges","sort","descending","markers","measures","rangesAsc","ascending","markersAsc","measuresAsc","maxAll","minAll","x0","x1","scaleLinear","domain","nice","w1","enter","barColors","mouseEnterIdx","runInterval","da","merge","measure","lineColors","marker","markerColors","barHeight","diff","total","tickEnter","COMPLETION_CHART_DEFAULTS","CompletionChart","completed","isTarget","isAchievment","isUndefined","fixUndefined","defaultValue","toPercent","ds","localePercent","fixPercent","toValue","updateWidth","setFormat","isPrivate","formatterString","percentText","color1","color2","specColor","info","targetline","getSpecColor","totalText","difference","textOnly","getTotalText","completedColor","infoColor","bColor","infoText","styleColor","styleValue","_text","setJsonData","updateTargetline","updateBars","SPARKLINE_DEFAULTS","isDots","isPeakDot","isMinMax","isMedianRange","Sparkline","sparklineColors","tooltipIntervalMedianRange","tooltipIntervalDots","tooltipDataCacheMedianRange","tooltipDataCacheDots","dimensions","calculateAspectRatioFit","srcWidth","srcHeight","maxHeight","dotsize","median","scaleMedianRange","bot","posX","posY","ratio","EMPTYMESSAGE_DEFAULTS","EmptyMessage","click","emptymessage","LINE_DEFAULTS","isArea","isBubble","isScatterPlot","showLegend","hideDots","emptyMessage","Line","isFormatter","dots","radius","radiusOnHover","strokeWidth","axisLabels","isAxisLabels","atLeastOne","axisArray","thisAxis","longestLabel","longestLabelLength","isAxisXRotate","xAxis","rotate","getMaxes","maxData","isCardAction","isViewSmall","names","valueFormatterString","formatValue","labels","maxes","entries","xScale","yScale","zScale","numTicks","axisBottom","tickPadding","tickSize","tickFormat","yAxis","axisLeft","axisLabelsGroup","placeStyle","getBBox","formatText","parser","lineIdx","lineGroups","area","dc","y0","y1","db","totalLength","getTotalLength","ease","easeCubic","handleMouseEnter","mouseEnterData","obj2","key2","spans","df","de","dg","dh","di","dj","selectorData","i1","i2","i3","setInitialSelected","selectedIdx","setIdx","toggleSelected","COLUMN_DEFAULTS","Column","datasetStacked","legendHeight","yMinTarget","yMaxTarget","seriesStacked","pnColors","pnPatterns","pnLegends","pnSeries","yMin","yMax","positive","patterns","scaleBand","yStack","y2","parentName","stack","rangeRound","paddingInner","xAxisValues","maxesStacked","maxD","maxesD","lm","bandwidth","yMaxLength","tempLength","targetBars","pnBars","barsInGroup","isGroupSmaller","colorStr","onEndAllTransition","drawBars","isTargetBars","bars","yTextPadding","toConsumableArray","isTooltipBottom","thisShape","shape","ePageY","setPattern","allBars","triggerGroup","gIdx","BAR_DEFAULTS","isNormalized","longText","useLogScale","showLines","wrapWidth","Bar","maxTextWidth","yMap","legendMap","gindex","totalBarsInGroup","totalGroupArea","totalHeight","gap","maxBarHeight","smallViewport","mediumViewport","largeViewport","margins","isLongText","xMin","xMax","gMax","xDif","barWith","scaleLog","smallNumber","mediumNumber","largeNumber","totals","mid","hexColor2","xPosS","yPosS","kl","data2","isSingular","foundMid","middleTick","startsWith","scale0","isFinite","setTextValues","abbrName","settingsisStacked","PIE_DEFAULTS","isDonut","hideCenterLabel","showLinesMobile","lines","showTooltips","Pie","mainGroup","pie","arc","outerRadius","innerRadius","outerArc","center","isEmpty","sum","rounded","roundLargestRemainer","updateData","legendFormatter","addCenterLabel","randomize","toZero","random","centerLabel","arcs","insert","dotSize","dot","getOffset","rads","midAngle","isTop","PI","isRight","isBottom","animationSpeed","attrTween","interpolate","exit","shouldShow","centroid","styleTween","polyline","arcIndex","count","dVala","order","unsorted","startAngle","endAngle","RADAR_DEFAULTS","levels","opacityArea","dotRadius","opacityCircles","roundStrokes","showCrosslines","showAxisLabels","axisFormatter","Radar","allAxes","getNameText","angleSlice","extra","rScale","feMerge","axisGrid","roundedVal","cos","sin","radarLine","lineRadial","curve","curveBasisClosed","angle","curveCardinalClosed","blobWrapper","selectElem","chart","chartComponent","COMPONENT_NAME_DEFAULTS","activeDate","activeDateIslamic","isPopup","headerStyle","firstDayOfWeek","dates","minDate","maxDate","isEnable","restrictMonths","hideDays","showMonthYearPicker","advanceMonths","useRange","minDays","maxDays","selectForward","selectBackward","includeDisabled","onSelected","MonthView","setCurrentCalendar","rendered","prevButton","nextButton","table","dayNames","monthPicker","todayLink","showMonth","autoSize","hideButtons","onOpenCalendar","currentDate","currentCalendar","calendarName","isIslamic","setHours","setMinutes","setSeconds","elementDate","todayDateIslamic","currentMonth","currentYear","currentDay","narrow","monthName","firstDayofWeek","yearFirst","setFullYear","justYear","setSize","appendMonthYearPicker","leadDays","firstDayOfMonth","lastMonthDays","daysInMonth","thisMonthDays","nextMonthDayCnt","dayCnt","exYear","exMonth","exDay","dayMap","th","setDisabled","setLegendColor","padDate","tHours","tMinutes","tSeconds","isSeconds","todayDay","todayMonth","todayYear","startKey","currentIslamicDate","setRangeSelection","validatePrevNext","setDate","formatedDate","cell","setRangeOnCell","second","monthDropdown","monthMap","monthSpan","dropdown","yearDropdown","years","yearMap","yearSpan","firstDay","monthLengthBitmap","yearInfo","islamicYearIndex","islamicYear","yearIdx","dateIsDisabled","isDateDisabled","getDateRange","startDate","endDate","getLegendColor","hexToRgba","normalColor","hoverColor","thisElem","checkDate","checkHours","isNext","maxCell","minCell","picker","selectDay","selectToday","lastClickedKey","closePopup","dayObj","dayFilter","lenth","isKeyClick","charCode","allCell","allCellLength","handled","activeTabindex","setMonth","getCellDate","cellLength","firstCell","rowIdx","cellIdx","thisCell","cellDate","getDifferenceToDate","thisTd","aftertime","beforetime","setRangeSelected","daystomove","includeDisableClass","isFocus","eventTypes","events","showViewChanger","onRenderMonth","upcomingEventDays","modalTemplate","menuSelected","newEventDefaults","subject","isAllDay","comments","Calendar","renderEventTypes","renderMonth","renderViewChanger","eventTypeContainer","eventTypeMarkup","eventType","translationKey","initialize","monthViewContainer","monthView","monthViewHeader","renderAllEvents","appendUpcomingEvent","upcomingEventsContainer","daysUntil","upcomingEvent","upcomingEventsMarkup","startDay","starts","endDay","ends","dateRange","nextMonth","endYear","isDays","durationHours","durationUnits","viewChangerHtml","renderEventDetails","eventId","eventData","eventDetailsContainer","renderTmpl","renderSelectedEventDetails","getDayEvents","clearEventDetails","clearUpcomingEvents","filterEventTypes","checkboxes","dateDiff","useHours","isFullDay","isCallback","callOnRenderMonth","removeAllEvents","eventsSorted","renderEvent","endKey","addCalculatedFields","appendEvent","moreEvents","calendarEvents","getEventTypeColor","startsLocale","endsLocale","eventCnt","moreSpan","moreText","cnt","shortSubject","beforeShow","iconStatus","eventInfo","getEventTypeLabel","isSwitchingMonth","modalVisible","removeModal","evt","deleteEvent","showModalWithCallback","isAdd","showEventModal","inputs","addEvent","updateEvent","cleanEventData","dayEvents","containsHTML","startsLong","endsLong","typeLabel","addPlaceholder","toISOString","noComments","lastId","modalContents","modalOptions","closebutton","popover","keepOpen","tooltipElement","headerClass","isCancel","popupApi","clearEvents","CIRCLEPAGER_DEFAULTS","slidesToShow","startingSlide","loop","CirclePager","setElements","slides","createControls","initActiveSlide","showCollapsedView","slidesJQ","isVisible","activeIndex","htmlContent","numOfButtons","slide","temp","buttonText","lastIndex","isBulletsNav","previousButton","isVisibleInContainer","eRect","cRect","updateSlidesToShow","numOfSlides","responsiveSlidesToShow","controlButtons","showExpandedView","canfocus","circlepager","COLORPICKER_DEFAULTS","light","border","checkmark","two","dark","high-contrast","customColors","placeIn","showLabel","editable","uppercase","colorOnly","clearableText","ColorPicker","isIeEdge","isIe11","setCustomWidth","isEditor","colorpicker","swatch","setColor","addAria","getHexFromLabel","translated","getLabelFromHex","translateColorLabel","getHexValue","getLabelValue","aria-autocomplete","toggleList","isPickerOpen","updateColorMenu","popupmenuOpts","tooltipApi","colorHex","colorLabel","isValidHex","setValueOnField","invalid","targetAttr","colorText","isMenu","activeTheme","isBorderAll","checkThemes","checkmarkClass","colorNum","regexp","colorValue","isBorder","elemValue","v","decimal2rgb","rgb2hex","search","newRgb","elemParent","originalVal","eventStr","EXPANDABLEAREA_DEFAULTS","bottomBorder","ExpandableArea","footer","isCard","useHeaderExpander","expanded","aria-expanded","aria-controls","resize","toggleExpanded","applyIE11Fix","expandablearea","COMPOSITEFORM_DEFAULTS","expandedText","collapsedText","CompositeForm","componentClassList","expandableArea","hasSummary","expandableAreaAPI","setExpanderText","checkResponsive","changeExpanderText","isSideOriented","expanderText","textSpan","compositeform","CONTEXTUALACTIONPANEL_DEFAULTS","initializeContent","showCloseButton","centerTitle","ContextualActionPanel","modalAPI","panel","dataModal","setPanel","panelFromID","completeBuild","isIframe","hasSearchfield","toolbar","wrapAll","modalHeader","toolbarSearchfieldSection","toolbarHTML","toolbarCSSClass","useFlexToolbar","toolbarTitleSection","toolbarButtonsetSection","toolbarTitle","centerTextCSS","closeButton","standaloneSection","CAPToolbarButton","toolbarflex","passEvent","toolbarData","setActiveButton","handleToolbarSelected","contextualactionpanel","TOOLTIP_DEFAULTS","isError","isErrorColor","Tooltip","popupmenuAPI","setContent","descriptionId","titleAttr","isPopover","addClassToLinks","thisClass","scrollparent","setTargetContainer","showImmediately","hideImmediately","toggleTooltipDisplay","dontRender","settingsContent","noIncomingContent","doRender","contentCheck","callbackResult","renderPopover","renderTooltip","titleArea","contentArea","previousElementSibling","tooltipHTML","popoverWidth","firstElementChild","parentWidth","nodeValue","titleFrag","createDocumentFragment","closeBtnX","newSettings","isInPopup","mouseUpEventName","targetContainer","tooltipPlacementOpts","detachOpenEvents","moveSelectedOpts","DROPDOWN_DEFAULTS","closeOnSelect","maxSelected","moveSelected","moveSelectedToTop","multiple","noSearch","showEmptyGroupHeaders","showSelectAll","reload","onKeyDown","Dropdown","selectedValues","opt","overflowed","orgId","filterTerm","elemClassList","pseudoClassString","baseElement","isWrapped","getAttributes","attributesToCopy","getDataAttributes","dataSource","dataMaxselected","getMoveSelectedSetting","incomingSetting","useText","dataMoveSelected","reloadSourceOnOpen","dataCloseOnSelect","dataNoSearch","sizingStrings","classString","listfilter","setListIcon","setDisplayedValues","setInitial","setWidth","toggleTooltip","inputTimer","inputTimeout","setItemIcon","listIconItem","isIcon","listIcon","colorOver","specColorOver","classListOver","classOver","isClassList","isClassListOver","isSwatch","iconAttr","pseudoElemIcon","setTooltip","optText","getOptionText","setItemIconOverColor","targetIcon","iconRef","updateItemIcon","iconAtIndex","fill","updateList","listExists","listContents","ulContents","upTopOpts","hasOptGroups","reverseText","isMultiselect","selectedFilterMethod","groupsSelectedOpts","selectedOpts","buildLiHeader","buildLiOption","liMarkup","getNamedItem","hasTitle","badge","badgeColor","badgeHtml","liCssClasses","aCssClasses","copiedDataAttrs","trueValue","iconHtml","exp","getSearchRegex","allSelected","els","optgroupIndex","listUl","searchInput","highlightOption","maxlength","previousActiveDescendant","setBadge","copyClass","from","to","ignoreKeys","handleSearchEvents","searchKeyMode","isFiltering","handleAutoComplete","filterList","typeahead","unhighlightOptions","XMLSerializer","serializeToString","resetList","selectBlank","blank","selectedIndex","tdContainer","selectOption","isControl","handlePseudoElemKeydown","isEscapeKey","isOSX","selectStartsWith","keycode","useSearchInput","completeOpen","touchPrevented","isShort","isInGrid","rowHeight","noScroll","isDropdownElement","touchmove","clickDocument","itemSelected","selectListItem","newPos","modalScroll","parentScroll","parentElementStyle","parentElementBorderWidth","parentElementWidth","cssText","isRetina","devicePixelRatio","isChrome","borderTopWidth","borderBottomWidth","ulHeight","listHeight","searchInputHeight","isToBottom","isSmaller","ddOption","doSelectAll","isListClosable","scrollToOption","listOption","listOptions","selectOptions","noTrigger","optionVal","trimmed","clearSelection","isAdded","grep","optionValue","newOptions","selectValue","newIdx","totalMatches","searchMatches","badges","isManagedByTemplate","buildOption","attrToExclude","toExclude","attrToCopy","isExclude","attrib","isData","setCode","doSetting","TIMEPICKER_MODES","TIMEPICKER_DEFAULTS","minuteInterval","secondInterval","roundToInterval","TimePicker","sanitizeIntervals","defaultInterval","intValue","sanitizeRoundToInterval","hoursId","minutesId","secondsId","periodId","sanitizeMode","buildStandardPopup","setupStandardEvents","addMask","roundMinutes","closeTimePopup","openTimePopup","is24HourFormat","hourText","hasSeconds","hasDayPeriods","getTimeSeparator","toBoolean","periodParts","newVal","maskOptions","validate","popupContent","initValues","getTimeFromField","timeParts","hourCounter","maxHourCount","hourSelect","minuteCounter","minuteSelect","minutes","secondCounter","secondSelect","periodSelect","localeDays","localeCount","regexDay","period","realDayValue","placementParent","placementParentXAlignment","afterShow","setTimeOnField","containFocus","focusables","onPopupHide","buildRangePopup","setupRangeEvents","thisValue","endParts","timeparts","removeLeadingWhitespace","addLeadingZero","isDayPeriod","translateDayPeriod","timeString","ddHours","ddMinutes","ddSeconds","ddPeriod","toggleTimePopup","removePunctuation","sepRegex","timepicker","Validation","ValidationTypes","error","titleMessageID","pagingMessageID","errorsForm","alert","success","confirm","required","isNotEmpty","isRadioChecked","check","availableDate","datepickerApi","hasOptions","showTime","useUTC","rangeDate","checkRule","rule","newvalue","email","enableSubmit","submit","passwordConfirm","emailPositive","isValid","passwordReq","passwordValue","timepickerSettings","is24Hour","maxHours","valueHours","valueMins","valueSecs","period0","period1","TOAST_DEFAULTS","audibleOnly","progressBar","allowLink","Toast","maxHideTime","convertDelayToFPS","isPausePlay","percentage","toast","closeBtn","progress","closeTimer","VALIDATION_MESSAGE_DEFAULTS","inline","isHelpMessage","Validator","fields","isPlaceholderSupport","attachEvents","extractEvents","filterValidations","validations","setErrorIconOpacity","calculateTextWidth","fieldWidth","attribs","eventAttr","thisField","handleEventData","handleObj","selects","dropdownApi","submitHandler","validateForm","deferreds","setModalPrimaryBtn","modalBtn","modalFields","allValid","modalField","offsetParent","getTypes","setIconOnParent","errorIcon","iconTarget","parentContainer","iconContainer","dropdownParent","validationType","manageResult","showResultTooltip","dfrd","removePositive","isInline","addMessage","removeMessage","addPositive","getField","async","hasError","loc","dataMsg","appendedMsg","showInlineMessage","showTooltipMessage","showIcon","closestField","representationField","fieldRect","currX","xAdjustment","toggleRadioMessage","isShow","triggerEvents","oldData","ruleId","newData","noMoreMessages","resetForm","form","formFields","reset","validationTypes","validation","isFormValid","ERROR_MESSAGE_DEFAULTS","getMessage","dataAttr","strMessages","getMessages","getErrorMessage","scrollIntoView","alignToTop","isAlert","addError","errors","removeError","settingsAreAPIFunction","isValidAttr","validateField","Soho","components","DATEPICKER_DEFAULTS","useCurrentTime","DatePicker","isFullMonth","closeCalendar","calendarAPI","openCalendar","setFocusAfterOpen","setToday","insertDate","localeDateFormat","localeTimeFormat","show24Hours","addedValidation","data-validate","data-validation-events","setPlaceholder","timeOptions","timepickerContainer","calendarContainer","setValueFromField","getTimeString","setTime","setValue","todayDate","popoverOpts","popupClosestScrollable","originalDate","td","currentDateIslamic","isFocusAfterClose","resetRange","timepickerControl","popoverAPI","setRangeFirstPart","getRangeValue","isReset","dateTd","aria-selected","isTime","setRangeToElem","isSingleDate","_this6","labelDate","firstdate","setRangeValueFromField","_this7","alignDates","gregorianValue","islamicValue","islamicDateParts","islamicDateText","isHours24","twodigit","h12","h24","getCurrentDate","_this8","maskApi","EDITOR_DEFAULTS","editor","excludeButtons","firstHeader","secondHeader","pasteAsPlainText","isClickable","showIsClickable","onLinkClick","showHtmlView","preview","Editor","toolbarAPI","isMac","parentElements","previewRendered","defaultUrl","defaultClass","defaultTargetText","defaultIsClickable","SameWindow","NewWindow","defaultTarget","toggleSource","modals","initElements","bindSelect","bindPaste","setPlaceholders","bindWindowActions","setupKeyboardEvents","onPasteTriggered","contentEditable","aria-multiline","bindParagraphCreation","bindTab","initToolbar","bindButtons","bindModals","bindAnchorPreview","initTextarea","sourceViewActive","togglePlaceHolder","getCurrentElement","getSelectionStart","isListItemChild","createToolbar","setExcludedButtons","btns","exBtns","separatorIndex","numOfExcluded","toolbarCssClasses","sectionCss","moreButtonHTML","buttonsHTML","buttonTemplate","cpElements","switchToolbars","destroyToolbar","setupTextareaEvents","createTextarea","sourceView","textareaContainer","newTextareaID","labelContents","triggerClick","currentElement","bl","q","u","h3","h4","space","sv","metaKey","adjustSourceLineNumbers","YPadding","lineNumberCount","numberList","lineNumbers","wrapTextInTags","insertedText","selectedText","finalText","outerHTML","insertTextAreaContent","sel","createRange","btnType","buttonLabels","getButtonLabels","bold","italic","underline","strikethrough","foreColor","backColor","superscript","subscript","header1","header2","quote","orderedlist","unorderedlist","justifyLeft","justifyCenter","justifyRight","clearFormatting","visual","getIcon","textName","buttonLabelType","pre","indent","outdent","customButtonLabels","attrname","activateButton","checkSelection","execAction","createURLModal","createImageModal","savedSelection","saveSelection","selectionRange","restoreSelection","currentLink","findElementInSelection","updateCurrentLink","createLink","insertImage","urlModal","targetOptions","isTargetCustom","imageModal","emUrl","emClass","emTarget","emIsClickable","fixLinkFormat","_this9","cleanValue","rangeChildren","rangeStr","rangeImg","isCollapsed","getSelection","getRangeAt","rangeCount","commonAncestorContainer","rangeChild","HTMLImageElement","deleteContents","frag","lastNode","insertNode","cloneRange","setStartAfter","removeAllRanges","addRange","_this10","selectionTimer","selectionHandler","newSelection","hideToolbarActions","selectionElement","getSelectionElement","checkSelectionElement","getElement","localParent","errb","setToolbarButtonStates","checkActiveButtons","checkButtonState","colorpickerButtonState","getSelectedParentElement","command","queryCommandState","rangeSelectsSingleNode","startNode","startContainer","endContainer","hasChildNodes","endOffset","startOffset","pasteWrapper","paste","getData","paragraphs","defaultPrevented","htmlEntities","pasteHtmlAtCaret","pasteWrapperHtml","pastedData","DOMStringList","getCleanedHtml","templIE11","maxRun","deferredIE11","savedContent","waitForPastedData","thisNode","pasteHtml","pasteHTML","attributeStripper","badAttributes","isWordFormat","cleanWordHtml","stripAttribute","_this11","editorContainer","mousedown","setFocus","helper","cursor","savedSel","anchorNode","getrange","tagname","comprng","selparent","rng","collapsed","createTextRange","selectNodeContents","compareBoundaryPoints","Range","END_TO_START","START_TO_END","moveToElementText","compareEndPoints","restoreLinkSelection","contenteditable","execFormatBlock","colorpickerActions","toText","normalizeList","_this12","parentEl","getSelectionParentElement","parentTag","align","isFound","textAlign","getTextAlign","fragment","textNode","replaceTag","checkChildren","childrenNodes","l2","child","childChildren","clearFormatedTags","rangeAt","selectNode","s2s","s2e","START_TO_START","e2s","e2e","END_TO_END","containsNode","containsNodeInSelection","gParentEl","cpBtn","cpApi","queryCommandValue","focusNode","_this13","hasAttribute","selectionData","getSelectionData","checkJQ","toolbarApi","tooltips","colorpickers","setPreviewMode","containerClassList","elementClassList","isEditable","destroyPreviewMode","isPreview","_this14","isEnabled","isContains","copiedData","imageFile","getAsFile","reader","FileReader","readAsDataURL","spaces","badTags","re","stripStyles","styleStripper","stylesToKeep","strStyle","entry","getIndent","level","formatHtml","indentLevel","tokens","HIERARCHY_DEFAULTS","legendKey","templateId","mobileView","leafHeight","leafWidth","beforeExpand","renderSubLevel","layout","rootClass","Hierarchy","colorClass","isStackedLayout","setLayout","nodeId","nodeData","domObject","branch","leaf","dblClickEvent","hierarchy","targetInfo","isButton","isNotBack","isBack","svgHref","isCollapseButton","baseVal","isExpandButton","isForward","isActions","isAction","isAncestor","buildActionsMenu","actionReference","isForwardEvent","isBackEvent","isAddEvent","isExpandEvent","isCollapseEvent","isSelectedEvent","isActionsEvent","isActionEvent","allowLazyLoad","selectLeaf","updateActions","updatedActions","popupMenu","lineItemsToRemove","actions","getActionMenuItems","details","evenType","isLoaded","isLeaf","currentDataObject","newDataObject","params","isRootNode","checkForChildren","thisObj","thisNewDataObject","thisParams","addChildrenToObject","processData","selectorObject","isSubLevelChild","subListExists","createLeaf","updateState","closePopupMenu","actionButton","nodeTopLevel","thisLegend","thisChildren","rootNodeHTML","structure","toplevel","sublevel","chartContainer","createLegend","isSingleChildWithChildren","parentDataSet","backButton","isMultiRoot","multiRootHTML","multiRootText","ancestorPath","centeredNode","ancestorHTML","getTemplate","roots","root","renderSubChildren","subArray","subArrayChildren","childObject","topLevel","thislabel","chartClassName","elClassName","processDataForLeaf","thisNodeData","branchState","childLeaf","childLength","lf","setRootColor","ln","dataNode","isRoot","expandCaret","FIELDFILTER_DEFAULTS","dropdownOpts","FieldFilter","setFiltered","emptyTmpl","ffId","ffdropdown","ddApi","filtered","getTriggerData","getFilterType","setFilterType","fieldfilter","FIELDOPTIONS_DEFAULTS","FieldOptions","targetElem","fieldParent","popupmenuApi","lookup","isFileupload","isSearchfield","isColorpicker","isRadio","isFieldset","addFocused","removeFocused","doActive","doUnactive","canUnactive","relatedTarget","onPopupToggle","setTriggerCssTop","margin-bottom","padding-bottom","getTriggerTopVal","z-index","e2","fieldoptions","FILEUPLOAD_DEFAULTS","FileUpload","hasInlineLabel","fileInput","elemClass","instructions","shadowField","svgClose","orgLabel","fileInputValue","textInput","clearUploadFile","files","fileupload","FILEUPLOADADVANCED_DEFAULTS","isStandalone","standaloneClass","allowedTypes","maxFilesInProcess","maxFileSize","fileName","showBrowseButton","send","textDropArea","textDropAreaWithBrowse","textBtnCancel","textBtnCloseError","textBtnRemove","errorAllowedTypes","errorMaxFileSize","errorMaxFilesInProcess","FileUploadAdvanced","cssClassList","fileExtensions","isExtra","dropArea","showError","handleFileUpload","isFileTypeAllowed","fd","FormData","createStatus","sendFileToServer","file","formatFileSize","btnCancel","rightSide","animationLength","setProgress","setAbort","jqxhr","abort","setCompleted","formData","tempData","ceil","ext","bytes","fileuploadadvanced","HOMEPAGE_DEFAULTS","columns","easing","gutterSize","widgetWidth","widgetHeight","Homepage","isTransitionsSupports","supportsTransitions","initHeroWidget","initColumns","rowsAndCols","heroWidget","initRowsAndCols","getAvailability","block","smallest","rows","innerCheck","cols","col","fitBlock","addRow","setBlocks","cards","blocks","card","arrayIndexMove","bpXL","bpDesktop","bpTablet","bpPhone","xl","maxAttr","marginLeft","available","box","totalWidth","applyCubicBezier","cubicBezier","detachEvents","homepage","FOCUSABLE_SELECTOR","PAGER_DEFAULTS","hideOnOnePage","showPageSizeSelector","smallPageSizeSelector","onPageSizeChange","showFirstButton","enableFirstButton","showPreviousButton","enablePreviousButton","showNextButton","enableNextButton","showLastButton","enableLastButton","indeterminate","onFirstPage","onPreviousPage","onNextPage","onLastPage","firstPageTooltip","previousPageTooltip","nextPageTooltip","lastPageTooltip","Pager","filteredPages","filteredTotal","grandTotal","previousOperation","previousTrigger","serverDatasetTotal","isFilteredClientside","filteredActivePage","pagingInfo","focusableElements","pagerBar","numberButtons","isTable","pageSelectorInput","isListView","pageSizeSelectorButton","showSmallPageSizeSelector","createPagerBar","setActivePage","widgetContainer","mainContainer","widgetContent","widgetFooter","currentPage","triggerPagingEvents","pageCount","activePageIdx","previousSibling","isFirst","isLast","lastChild","operation","toggleOption","isShowPageSizeSelectorCall","showButton","enableButton","op","useFiltering","searchActivePage","pageNum","saveUserSettings","adjustPageCount","totalPages","_pageCount","renderButtons","buttonHTML","doRenderFirstButton","doRenderPreviousButton","doRenderNextButton","doRenderLastButton","disableFirstButton","disablePreviousButton","disableNextButton","disableLastButton","disableFirstIndeterminate","firstPage","disableLastIndeterminate","lastPage","hasDataset","buttonsToRender","pageSizeButtonSize","availableButtonWidth","maxNumberButtons","maxDistanceFromCenter","renderButton","visibleContent","audibleContent","tooltipContent","targetPageNum","isAriaSelected","isAriaDisabled","isControlDisabled","pageAttr","numberButtonHTML","renderPageSelectorInput","lastValue","maskSettings","renderPageSizeSelectorButton","pageSizeLi","dropdownIcon","translatedText","isAudible","recordHtml","pageSizeButton","menuItems","changePageSize","renderBar","hidePagerBar","initTabIndexes","tabbables","previousActivePage","updatePagingInfo","isResponse","hideDisabledPagers","buttonAPI","LISTVIEW_DEFAULTS","searchable","selectOnFocus","showCheckboxes","hoverable","forceToRenderOnEmptyDs","disableItemDeactivation","pagerSettings","ListView","oldSettingTypes","refresh","selectedItems","lastSelectedItem","isSelectedAll","sortInit","globalDataset","x-ms-format-detection","cardWidgetContent","emptyMessageContainer","getTotals","property","isServerSide","renderPager","filteredDataset","focusItem","selectedToolbar","toggleMoreMenu","aria-posinset","aria-setsize","updatedPagerInfo","getPageableElements","loadData","ajaxDs","toggleAll","selectItemsBetweenIndexes","deselectItemsBetweenIndexes","item1","item1W","handleSearch","searchFieldVal","filteredResults","resetSearch","removeAllSelected","clearAllSelected","onEvent","setSortColumn","orderBy","reloadApi","reloadApiNoSort","sortFunction","primer","deselect","unselect","isMixed","triggerStr","selectedData","posinset","toolbarControl","toggleItemActivation","deactivateItem","activateItem","activatedItem","updateSearch","searchfieldApi","isSelect","isMultiple","newItem","handlePageChange","handlePageSizeChange","pagingOpts","listview","inlineOpts","combinedSettings","LISTBUILDER_DEFAULTS","btnAdd","btnEdit","btnDelete","btnGoUp","btnGoDown","templateNewItem","templateItemContent","ListBuilder","loadListview","initDataset","lv","listApi","extractNodeData","setAction","isjQuery","topButtons","arrangeApi","topButtonsClick","getDataByNode","updateAttributes","indexBeforeMove","updatedEventsStr","updatedData","addItem","editItem","moveItemUp","moveItemDown","isNewItem","commitEdit","makeEditable","origValue","escapeHTML","editInput","deleteItem","jquery","moveCursorToEnd","updateDataset","getListItem","listbuilder","MODAL_DEFAULTS","frameHeight","frameWidth","showCloseBtn","Modal","reStructure","isCAP","capAPI","mainContent","isAttachedToBody","isOnTop","dialog","oldActive","appendContent","addButtons","isAppended","busyIndicator","hr","disableSubmit","primaryButton","dropdowns","bodywrapper","flexToolbar","btnWidth","isPanel","modalButtons","inlineBtns","decorateButtons","isDefault","audible","attrs","attrTypes","searchfieldSettings","sizeInner","messageArea","elemCanOpen","currentModalApi","lastModalIndex","h1","descById","removeNoScroll","getTabbableElements","keepFocus","tabParent","focusElement","calcHeight","calcWidth","hasPager","toolbars","allTabbableElements","tabbableElements","apiModal","elemCanClose","destroyCallback","MESSAGE_DEFAULTS","allowedTags","Message","allowTags","messageContent","resizable","modalData","monthview","MULTISELECT_DEFAULTS","MultiSelect","multiselect","NOTIFICATION_DEFAULTS","linkText","Notification","notificationEl","htmlIcon","htmlText","htmlButton","notification","PROGRESS_DEFAULTS","Progress","updateAria","aria-valuenow","aria-valuemax","perc","POPDOWN_DEFAULTS","Popdown","tryPopdownElement","popdown","ariaExpanded","hasValidTriggerSetting","setFocusinEvent","scrollDistance","winH","winW","adjustX","adjustY","XoffsetFromTrigger","YoffsetFromTrigger","po","rightEdgePos","popdownRect","triggerRect","deltaRightEdge","bottomEdgePos","RATING_DEFAULTS","Rating","allInputs","fillStar","inpt","emptyStar","halfStar","currentValue","chkIdx","svgSelector","rating","SIGNIN_DEFAULTS","SignIn","isCapslock","shifton","modifiers","cssIcon","msCapsLockWarningOff","iconCapslock","signin","SLIDER_DEFAULTS","step","persistTooltip","Slider","isInt","roundToIncrement","increment","pointA","pointB","bX","bY","sqrt","buildSettings","bindEvents","parsedTicks","isTooltipPersist","strings","minTick","getModifiedTextValue","maxTick","equalsMin","equalsMax","vals","isVertical","originalElement","hitarea","isRtlHorizontal","isRtlVertical","minHeight","minWidth","handles","labelText","handleLower","handleHigher","aria-orientation","aria-valuemin","convertValueToPercentage","positionTick","updateRange","handleRangeClick","mouseX","mouseY","clickCoords","firstHandleCoords","oldVals","dLower","targetOldVal","targetHandle","wh","conversion","rangeVal","convertPercentageToValue","checkHandleDifference","moveBy","decreaseValue","increaseValue","activateHandle","deactivateHandle","enableHandleDrag","draggableOptions","thisHandle","adjustedHeight","updateTooltip","updateHandleFromDraggable","disableHandleDrag","dragAPI","getIncrement","incrementBy","testVal","updatedVal","finalVal","decrement","decrementBy","percentages","getColorClosestToValue","borderColor","posAttrs","cssProps","positionHandle","basePosition","realPercentage","origPercent","updatedPercent","tooltipLow","tooltipHigh","very-poor","poor","adequate","good","very-good","superior","highestTickColor","minVal","maxVal","valueText","aria-valuetext","lowVal","highVal","slider","Zoom","viewport","enableZoom","disableZoom","noZoomTimeout","zoom","SPINBOX_DEFAULTS","autocorrectOnBlur","validateOnInput","Spinbox","setInitialValue","checkForNumeric","fieldOptionsTrigger","down","up","maskValue","newMask","tempMin","tempMax","longerVal","maskSize","enableLongPress","addButtonStyle","longPressInterval","disableLongPress","removeButtonStyle","isReadonly","safeFocus","handleKeyPress","handleInput","correctValue","handleKeyup","handleAfterPaste","updateVal","isNumeric","setIsDisabled","preventClick","spinbox","SPLITTER_DEFAULTS","side","save","Splitter","splitter","thisSide","parentHeight","docBody","isSplitterRightSide","isSplitterHorizontal","thisPrev","leftSide","savedOffset","offsetLeft","splitTo","topPanel","localStorage","documentWidth","iframes","aria-dropeffect","aria-grabbed","toggleSelection","resizeTop","resizeLeft","leftArg","resizeRight","SWAPLIST_DEFAULTS","additional","availableClass","selectedClass","additionalClass","availableBtn","selectedBtnLeft","selectedBtnRight","additionalBtn","draggable","SwapList","isAdditional","isMultiSelectClass","makeDraggable","initSelected","disabledBtnStr","actionButtons","selectedButtons","tabButtonsStr","dragElements","dragEnterWhileDragging","dragOverWhileDragging","selections","owner","related","droptarget","isInSelection","dragged","draggedIndex","numOfSelectionsClass","itemContentClass","itemContentTempl","moveElements","clearSelections","setSelectionsItems","unselectElements","itemsData","currentSize","afterUpdate","isDragAndDropSupports","div","isMatchMediaSupports","matchMedia","msMatchMedia","isMaxWidth","matches","draggTouchElement","hasModifier","addDropeffects","clearDropeffects","dataList","getDataList","nodeIndex","syncDataset","droptargetNodes","ownerAPI","dropTargetAPI","ownerDataList","dtDataList","isMoved","mOwner","mItem","dtIndex","ownerIndex","l3","ownerItem","focusIdx","focusClass","getItems","getAvailable","getAdditional","draggedMakeSelected","moveTo","itemsLen","slideUp","isLess","swaplist","SCROLLACTION_DEFAULTS","scrollActionTarget","classToAdd","ScrollAction","lastScrollTop","scrollaction","DEFAULT_STEPCHART_OPTIONS","steps","inProgress","iconType","completedText","extraText","allCompletedColor","inProgressColor","StepChart","stepchart","tabContainerTypes","TABS_DEFAULTS","addTabButton","addTabButtonCallback","appMenuTrigger","appMenuTriggerText","ajaxOptions","beforeActivate","containerElement","changeTabOnHashChange","hashChangeCallback","lazyLoad","moduleTabsTooltips","tabCounts","verticalResponsive","Tabs","tabsIndex","tabPanelContainer","moveTabPanelContainer","isVerticalTabs","bodyPageContainer","tablistContainer","isScrollableTabs","noClass","closestHeader","tablist","deltaY","aria-multiselectable","renderHelperMarkup","panels","popupLi","popupA","popupHref","popupPanel","popupIcon","closeDismissibleTab","tabs","selectedAnchor","matchingTabs","nestedTabControls","isModuleTabs","setOverflow","positionFocusState","hasAnimatedBar","animatedBar","focusBar","renderEdgeFading","auxilaryButtonLocation","focusState","moreButton","handleAddFocusData","hrefs","closeDismissibleTabs","handleTabClick","wasTapped","handleTabFocus","handleTabKeyDown","tab","closeDropdownMenuItem","scrollTabList","handleDismissibleTabKeydown","setupHelperMarkupEvents","handlePanelKeydown","noFocusedTabs","noPopupMenusOpen","hideFocusState","newTabId","newTabOptions","newTabIndex","tabId","currentLi","handleMoreButtonClick","handleMoreButtonKeydown","handleMoreButtonFocus","handleAddButton","handleAddButtonKeydown","handleAddButtonFocus","removeHelperMarkupEvents","handleAppMenuTabKeydown","changeHash","isURL","hasMoreButton","buildPopupMenu","dataFocusedClick","focusedByKeyboard","isTabOverflowed","passableKeys","isPassableKey","oldHref","allExcludes","currentA","targetLi","previousTab","nextTab","handleOutboundLink","isAddTabButton","focusStateTarget","lastTab","findLastVisibleTab","existing","nameParts","newIndex","newId","stringName","isDismissible","externalSettings","firstTab","ignoreResponsiveCheck","defocusBar","handleVerticalTabResize","renderVisiblePanel","handleRebuild","rebuild","makeVertical","isResponsiveVerticalTabs","isNested","isNestedInLayoutTabs","elemStyle","elemOuterHeight","useRelativePath","origin","isInResponsiveMode","isHeaderTabs","getPanel","nestedInModuleTabs","nestedInHeaderTabs","hasTabContainerClass","isTab","isAnchor","getAnchor","getMenuItem","moreMenu","getPreviousTab","getTab","menuAPI","activateAdjacentTab","doGetTab","activatePreviousTab","targetTab","targetPanel","targetPanelElem","oldTab","oldPanel","selectedStateTarget","activeStateTarget","completeActivate","vetoResult","ddMenu","ddTab","childToolbars","tablistContainerElem","containerWidth","containerId","createTabPanel","handleStringSource","dataType","ajax","safeHref","param","paramIndex","hashIndex","insertIndex","resizeNestedTabs","atIndex","startFromZero","getObjectFromSelector","sourceString","isDropdown","tabHeaderMarkup","anchorMarkup","tabContentMarkup","targetIndex","nonSpecialTabs","finalIndex","atBeginningOfTabset","conditionInsertTabBefore","insertIntoTabset","adjustModuleTabs","doActivate","disableBeforeClose","targetAnchor","hasTargetPanel","targetLiIndex","notATab","prevLi","wasSelected","popupAPI","parentMenu","menuItem","activateTargetA","doInsert","checkPopupMenuItems","getRemainingMenuItems","getTabFromId","disableTab","enableTab","rename","hasCounts","hasTooltip","doesTabExist","updateCount","getActiveTab","getVisibleTabs","tabHash","getOverflowTabs","hasMoreIndex","checkModuleTabs","tablistStyle","tablistHeight","overflowCondition","adjustSpilloverNumber","sizeableTabs","appTrigger","hasAppTrigger","tabContainerW","visibleTabSize","appTriggerSize","anchorStyle","anchorPadding","cutoff","isSideBySide","moreDiv","overflowedTabs","countDiv","modHref","startingHref","menuHtml","shouldBeSelectable","buildMenuItem","$item","$itemA","onclick","cloneLis","originalA","xOffset","originalTab","handleDismissibleIconClick","listMenu","currentMenuItem","isFocusedElement","pseudoKeycode","focusFirstVisibleTab","nextMenuItem","liTop","tablistTop","targetFocus","scrollingTablist","tablistScrollWidth","tablistScrollLeft","targetStyle","animationTimeout","tabCoords","tabContainerDims","adjustedLeft","adjustedRight","unhide","focusStateElem","targetPos","targetClassList","isNotHeaderTabs","tabMoreWidth","accountForPadding","targetRectObj","parentPadding","tabLeftMargin","tmpLeft","adjustForParentContainer","targetPosString","doHide","disableOtherTabs","isPartial","disabledElems","originalTabindex","originalDisabled","attrTarget","tabUrlArray","tabUrl","verticaltabs","TAG_DEFAULTS","Tag","btnDismissable","TEXTAREA_DEFAULTS","autoGrow","autoGrowAnimate","autoGrowAnimateSpeed","autoGrowMaxHeight","characterCounter","maxLength","printable","charRemainingText","charMaxText","Textarea","getMaxLength","printarea","updateCounter","isPrintable","oldHeight","countLinebreaks","isExtraLinebreaks","TOOLBAR_DEFAULTS","rightAligned","maxVisibleButtons","resizeContainers","favorButtonset","moreMenuSettings","noSearchfieldReinvoke","Toolbar","buildAriaLabel","cutoffTitle","moreContainer","buttonsetItems","sf","searchfieldOpts","popupMenuInstance","moreAriaAttr","buildMoreActionsMenuItem","defaultMenuItems","hasDefaultMenuItems","menuButtonSettings","refreshMoreActionsMenu","activeButton","isItemOverflowed","setActiveToolbarItem","adjustMenuItemVisibility","searchfieldWrapper","getItemText","submenuDesignIcon","linkspan","addItemLinksRecursively","diffMenu","parentItem","diffMenuItem","dmi","omi","dmiA","omiA","dmiID","dmiAID","omiSubMenu","dmiSubMenu","appendTarget","tooltipText","popupLiText","getLastVisibleButton","handleSelected","handleTransferToMenuButtonItem","containerDims","moduleTabsParent","originalMenuButton","itemLink","itemEvts","toolbarEvts","popupTrigger","evtTypes","delegateCount","isActionButton","getFirstVisibleButton","navigate","sizeContainers","getButtonsetButtons","titleSize","buttonsetSize","containerElem","moreElem","toolbarDims","buttonsetDims","titleDims","moreDims","toolbarPadding","hasTitleSizeGetter","hasButtonsetSizeGetter","targetTitleWidth","targetButtonsetWidth","addPx","getMoreOrLast","getActiveButton","moreButtonIsDisabled","getVisibleButtons","hiddenButtons","visibleButtons","hidden","iconDisplay","$elem","elemIsHidden","numIcons","itemIndexInButtonset","moreButtonIsVisible","itemRect","buttonsetRect","itemOutsideXEdge","hasNoMoreButton","shouldFocus","lastVisibleButton","isHeader","prevLabel","prevSpan","dataTooltip","moreMenuChildren","teardownMoreActionsMenuItem","doRemove","submenuContainer","searchFields","TOOLBAR_ELEMENTS","TOOLBAR_COMPONENT_APIS","actionbutton","menubutton","toolbarsearchfield","TOOLBAR_FLEX_ITEM_DEFAULTS","componentSettings","ToolbarFlexItem","elemObj","getToolbarItemType","section","trueSelected","hasNoOverflowedItems","boolean","triggerSelectedEvent","$element","componentType","hasReadOnly","elemRect","sectionRect","isTrue","menuIsEmpty","trueHasNoOverflowedItems","focusedItem","itemLinkAPI","elementLink","handleActionButtonBeforeOpen","handleActionButtonResize","renderMoreActionsMenu","$menu","teardownPredefinedItems","toPopupmenuData","linkToolbarItems","menuRendered","actionButtonLink","itemData","itemRefreshCallback","unlinkToolbarItems","doUnlinkSubmenuItem","actionMenuElement","$originalMenuElement","itemElement","originalButton","originalButtonAPI","popupmenuData","doLinkSubmenuItem","menuItemData","originalMenuElement","menuElem","originalSubmenuData","addMenuElementLinks","toolbarflexitem","oldDestroy","TOOLBAR_FLEX_DEFAULTS","beforeMoreMenuOpen","ToolbarFlex","trueFocusedItem","sections","itemComponentSettings","keydownListener","keyupListener","clickListener","handleItemKeydown","getItemFromElement","preventScrolling","clickByEnterKey","clearClickByEnter","allSelectors","defined","searchfieldAPI","hasFocusableItems","canManageFocus","overflowedItems","doSetFocus","originalDirection","targetItem","getItemData","trueDisabled","bool","TRACKDIRTY_DEFAULTS","Trackdirty","valMethod","isOriginal","original","getAbsolutePosition","msg","textArea","firstInput","trackdirty","TREE_DEFAULTS","hideCheckboxes","useStepUI","folderIconOpen","folderIconClosed","sortable","onBeforeSelect","onExpand","onCollapse","originalEnablementState","Tree","initTree","focusFirst","attachMenu","createSortable","links","selectableAttr","decorateNode","setNodeStatus","iconToSet","hideCheckbox","parentCount","badgeData","alertIcon","isParentsDisabled","childSection","listCount","siblings","subNode","getBadgeHtml","hasIconClass","setTreeIcon","aClass","iconStr","selectNodeById","selectNodeByJquerySelector","unSelectedNode","syncNode","jsonData","continueSelectNode","selectNodeFinish","loading","setStatus","thisNodes","isFirstSkipped","getSelectedStatus","toArray","unselected","toggleNode","findById","addChildNodes","accessNode","nodeClass","openNode","nextTarget","nodeTarget","closeNode","popupEl","nextNode","getNextNode","prevNode","getPreviousNode","arrangeDataset","getNodeHtml","nodeToUpdate","updateNode","hasKeyInData","arrangedData","traverse","arranged","clean","findkey","selectHtml","selectedOptionText","alertIconAttr","ariaDisabled","isChildren","liClassList","addToDataset","updatedNode","findIndex","unshift","subresult","getNodeByIdIfSelected","getSelectedNodes","subTarget","json","nodeJQ","classAttribute","addNode","isBeforeOrAfter","badgeAttr","addAsChild","isFalse","nodetext","enabled","newBadge","parseBool","convertFileToFolder","removeChildren","removeNode","doDrag","targetArrow","linkSelector","thisClone","startUl","startIcon","startLi","startFolderNode","startWidth","setDragOver","overDirection","overNode","convertFolderToFile","cloneSvg","treeRec","exMargin","isBeforeStart","isAfterSttart","rec","doAction","outOfRange","marginTop","nextElementSibling","newFolder","iconClass","dragApi","preserveEnablementState","enablementStates","restoreEnablementState","origNode","tree","TREEMAP_DEFAULTS","labelFormatter","showTitle","Treemap","create","treemap","leaves","WIZARD_DEFAULTS","Wizard","completedRange","buildTicks","settingTicks","ngClick","positionTicks","tickPos","getPoint","currentTick","widthPercentage","trueIndex","wizard","formatters","Text","Input","inlineEditor","Placeholder","Ellipsis","textOverflow","Password","Readonly","isReturnValue","formatted","value2","sourceFormat","Time","parseTime","Lookup","editorOptions","Decimal","numberFormat","Integer","colHref","rowNavigation","hyperlinkTooltip","iconFile","Template","Drilldown","RowReorder","Checkbox","hiddenText","wasJustUpdated","SelectionCheckbox","isRowSelected","Actions","singleline","contentTooltip","unescapeHTML","Expander","GroupRow","groupSettings","groupable","rowHtml","groupRowFormatter","GroupFooterRow","visibleColumnsLeft","frozenColumns","visibleColumnsRight","columnIdxById","aggregate","groupFooterRowFormatter","SummaryRow","afterText","beforeText","summaryText","summaryTextPlacement","treeDepth","isExpandedBtnDisabled","isAllChildrenFiltered","expandedBtnDisabledHtml","ClassRange","Badge","colorClasses","Alert","Image","alt","Color","Colorpicker","formattedValue","compareValue","caseInsensitive","labelOrValue","Fileupload","Favorite","showEmpty","Status","rowStatus","TargetedAchievement","isWhite","showPercentText","addStandardInputFeatures","column","maskMode","useMask","editors","useValue","inputType","editorWidth","setUnit","commitCellEdit","apiPopover","setNextActiveCell","quickEditMode","grid","rowNodes","activeCell","datasetValue","valueAttr","Formatters","useMultiple","handleClear","openFileChooserWindow","clickArguments","openDialog","ow","excel","customDs","datasetToHtml","appendRows","tbody","createTHead","insertRow","allHeaderNodes","headerNodes","headerNode","insertCell","nonExportables","attrExportable","attrAriaColindex","innerEl","exportConvertNegative","isTypeExcel","msSaveBlob","blob","Blob","URL","createObjectURL","objectUrl","download","revokeObjectURL","base64","tableHtml","tableJq","appendRow","tr","btoa","unescape","encodeURIComponent","copyToDataSet","colIndex","dataSet","validateFields","Editors","filterType","rawVal","startColIndex","currentRowData","newRowData","renderRows","syncSelectedUI","pagerRefresh","exportToExcel","worksheetName","worksheet","cleanExtra","exportToCsv","csv","rowContent","formatCsv","groupBy","memo","chosen","pick","stem","where","converter","NEGATIVE_INFINITY","exclude","aggregators","aggregator","currentObj","DATAGRID_DEFAULTS","actionableMode","cellNavigation","showHoverState","alternateRowShading","columnReorder","saveColumns","focusAfterSort","isList","headerMenuId","menuBeforeOpen","headerMenuSelected","headerMenuBeforeOpen","selectChildren","allowSelectAcrossPages","spacerColumn","showNewRowIndicator","stretchColumn","twoLineHeader","clickToSelect","initializeToolbar","hidePagerOnOnePage","filterWhenTyping","disableClientFilter","disableClientSort","resultsText","showFilterTotal","virtualized","virtualRowBuffer","rowReorder","showDirty","showSelectAllCheckBox","allowOneExpandedRow","disableRowDeactivation","sizeColumnsEqually","expandableRow","columnGroups","treeGrid","onPostRenderCell","onDestroyCell","onEditCell","onExpandRow","searchExpandableRow","allowChildExpandOnMatch","Datagrid","tableBody","isWindows","initSettings","originalColumns","columnsFromString","removeToolbarOnDestroy","nonVisibleCellErrors","recordCount","totalWidths","totalMinWidths","dontSyncUi","rowSpans","headerWidths","filterRowRendered","_selectedRows","restoreColumns","restoreUserSettings","appendToolbar","setTreeDepth","setRowGrouping","setTreeRootNodes","firstRender","headerContainer","ignoredColumnById","sortColumn","sortField","sortAsc","gridCount","lastSelectedRow","contextualToolbar","columnId","isToggleFilter","preserveSelected","triggerSource","hasLeftPane","hasRightPane","bodyContainer","bodyWrapperLeft","tableLeft","bodyWrapperCenter","bodyWrapperRight","tableRight","isInitialRender","clearHeaderCache","renderHeader","setEmptyMessage","checkEmptyMessage","buttonSelector","htmlToDataset","specifiedCols","firstRow","colSpecs","colName","newRow","rowNode","setActiveCell","oldValue","removeRow","nosync","unselectRow","removeSelected","keywordFilter","searchField","clearFilter","pagerType","sortId","filterExpr","updatedPagingInfo","dirtyArray","unSelectAllRows","restoreFilter","restoreSortOrder","savedFilter","filterConditions","restoreFilterClientSide","cellNode","displayCounts","pathname","visibleColumns","skipBuiltIn","lastColumnIdx","lastColumn","getColumnGroup","colGroups","colspan","updateColumnGroup","originalColGroups","groupHeaders","newColspan","headGroups","columnsLen","visibleColumnsLen","getGroupsTotal","getDiff","groupsTotal","groupColspan","groupHeaderEl","updateGroupHeadersAfterColumnReorder","indexFrom","indexTo","headerText","headerRows","headerColGroups","headerColGroupCols","hiddenStr","colspanStr","groupedHeaderAlignmentClass","isSortable","isResizable","isExportable","exportable","isSelection","headerAlignmentClass","getHeaderAlignmentClass","hideable","headerTooltip","reorderable","sortIndicator","columnWidth","filterRowHtml","headerRow","headerHtml","headerContainerLeft","headerTableLeft","headerTableWidth","headerTableMinWidth","headerColGroupLeft","headerRowLeft","headerContainerCenter","headerTable","headerColGroup","headerContainerRight","headerTableRight","headerColGroupRight","headerRowRight","syncHeaderCheckbox","setScrollClass","attachFilterRowEvents","createDraggableColumns","setSortIndicator","applyFilter","activeEllipsisHeaderAll","headerAlign","filterSetDatepicker","operator","isRange","initDatepicker","columnDef","filterMarkup","filterId","integerDefaults","filterButtonHtml","filterDisabled","decimalDefaults","rowElem","columnById","typingTimer","isInViewport","adjustPosLeft","datepickerEl","lookupEl","timepickerEl","filterItemHtml","btnMarkup","toggleFilterRow","conditions","setFilterConditions","checkRow","isMatch","rowValue","rowValueStr","conditionValue","rangeData","fmt","getValues","rValue","cValue","setYear","setMilliseconds","_ret","dataSetLen","checkChildNodes","childNode","isGroupFiltered","setChildExpandOnMatch","setSearchActivePage","checkNodes","childrenLen","keywordSearch","condition","getExtraTop","topPositions","normal","groupFilterable","getTargetHeight","heights","showTarget","headerPos","offPos","extraTopPos","dragStartEvent","setDraggableColumnTargets","targetColumn","draggableStatus","dragEvent","draggableColumnTargets","dragendEvent","tempArray","updateColumns","x2","createDraggableRows","reorderRow","moveDown","startRow","endRow","startRowIdx","rowTemplate","allRows","syncSelectedRowsIdx","treeRootNodes","iterate","originalDataset","GroupBy","aggregatorOptions","tableHtmlLeft","tableHtmlRight","pagerState","bodyColGroupHtmlLeft","bodyColGroupHtml","bodyColGroupHtmlRight","triggerDestroyCell","tableBodyLeft","tableBodyRight","groupArray","filteredCount","sortDataset","rowStatusTooltip","isRowVisible","suppressGroupRow","groupHtml","showOnlyGroupRow","groupFooterRow","currentCount","summaryRow","calculateTotals","summaryRowHtml","bodyColGroupLeft","bodyColGroup","bodyColGroupRight","setVirtualHeight","afterRender","_loop2","component","lineage","drilldown","childIdx","colIdx","updateCellNode","spinboxes","setAlternateRowShading","syncSelectedRows","_loop3","cacheVirtualStats","containerHeight","bodyH","rowH","virtualRange","bodyHeight","rowIndex","vTop","topSpacer","bottomSpacer","topRow","bottomRow","defaultFormatter","dataRowIdx","actualIndex","isFooter","actualIndexLineage","skipChildren","isEven","isSummaryRow","containerHtml","skipColumns","treeDepthItem","currentDepth","visibleColumnsCenter","groupRowHtml","groupFooterHtml","ariaRowindex","_rowactivated","summaryRowFormatter","treeExpansionField","fieldVal","ariaReadonly","cellValue","rowspan","calculateRowspan","colWidth","hasColSpans","isCellDirty","contentVisible","rowTemplateHeight","childRowHtml","maxText","chooseHeader","hasButton","groupVal","hasTag","hasAlert","cacheWidths","hasVisibleScrollbars","hasScrollBarV","hasScrollBarH","cacheColumnWidths","calculateColumnWidth","widthSpecified","colPercWidth","widthPixel","percentWidth","diff2","Aggregators","rowstatus","isForced","headerColumn","headerFilter","iconAlert","iconSuccess","iconError","iconInfo","handleShow","isHeaderColumn","cacheTooltip","containerEl","getOuterWidth","forced","textwidth","handleHide","isGridtooltip","marginRight","updateRow","rerender","resetPager","canUseLocalStorage","sortOrder","savedSettings","getItem","exception","columnStr","orgColumn","lsCols","savedColumns","savedRowHeight","savedSortOrder","savedPagesize","savedShowPageSizeSelector","savedActivePage","restoreActivePage","resetColumns","removeItem","hideColumn","colSpan","syncExpandableRowColspan","visibleColumnCount","showColumn","pastedValue","personalizeColumns","spanNext","isColumnsChanged","selectedEvent","chk","setColumnWidth","columnSettings","isEllipsisActiveHeader","columnEl","activeEllipsisHeader","textEl","isEllipsisActive","resizeColumnWidth","idOrNode","tableWidth","createResizeHandle","resizeHandle","startingLeft","draggingLeft","columnStartWidth","currentHeader","lastCount","formatInteger","countText","triggerRowEvent","actualRowIndex","dataRowIndex","actualPagingRowIndex","handleScrollX","handleScrollY","highlightSearchRows","oldScroll","hitBottom","hitTop","hasLineFeed","hasCarriageReturn","hasBoth","splitData","startRowCount","stayInEditMode","toggleRowDetail","toggleGroupChildren","toggleChildren","isSelectionCheckbox","canSelect","activatedRow","selectRowsBetweenIndexes","toggleRowActivation","toggleRowSelection","makeCellEditable","isSubscribedTo","headerDetail","extraMargin","leftEdge","rightEdge","alignToLeft","leftPos","selectAllRows","refreshSelectedRowHeight","med","buttonSet","labelMarkup","searchfieldMarkup","collapsibleFilter","dateFilter","resetLayout","advancedFilter","views","filterRow","fullWidth","thisSearch","xIcon","filterKeywordSearch","checkColumn","rowContainers","cellText","isSearchExpandableRow","findInRows","pagingRowIndex","selectRows","_selected","selectClasses","selectRow","gData","actualIdx","visualRowNode","page","pagingIdx","headerCheckbox","rowsLength","selectedRowsLength","dataRowNode","activateRow","deactivateRow","rowJq","actualRowNode","deactivateRowNode","deactivateAllRowNodes","activateAllRowNodes","activated","unselectNode","selIdx","selectedRowCount","nodeElems","nodeToUse","checkboxToUse","isSiblings","findRowsByValue","matchedRows","syncBodyScroll","prevRow","nextRow","isGroupRow","visibleRows","getVisibleRows","visibleRow","getNextVisibleCell","currentCell","lastCell","groupNode","nextCell","getGroupCell","lastRow","containsTextField","containsTriggerField","noTextTypes","isCellEditable","cellParent","treeNode","treeExpandBtn","thisRow","cellWidth","isPlaceholder","max-width","min-width","isDirty","isUseActiveRow","dataRow","doCommit","validateCell","validator","messageText","gridInfo","showCellError","clearCellError","displayMessage","ruleName","clearNonVisibleCellErrors","showNonVisibleCellErrors","_loop4","showNonVisibleCellErrorType","tableerrors","nonVisiblePages","clearAllCellError","clearNodeErrors","clearRowError","clearAllErrors","resetRowStatus","clearDirty","clearDirtyClass","clearDirtyRow","clearDirtyCell","dirtyCells","cells","dirtyRows","showRowError","messageType","validateRow","validateAll","coerceValue","oldVal","serialize","updateCell","fromApiCall","coercedVal","isTreeGrid","rowstatusIcon","svgIcon","statusIcon","rowDataObj","nbrParts","escapedVal","isDirtyCellNotUndefined","escapedCoercedVal","cellNodeText","setIsDirtyAndIcon","relativeRow","visualRowIndex","leftNodes","centerNodes","rightNodes","prevCell","rowNum","dataRowNum","prevSpans","expandOnActivate","addChildren","setExpandedInDataset","rowElement","expandButton","setChildren","lev","nodeLevel","nodeIsExpanded","expandRow","detail","prevExpandRow","prevExpandButton","parentRow","parentRowIdx","parentdataRowIdx","prevDetail","prevActionBtn","currentClass","childrenLeft","childrenRight","wasFocused","setDirtyBeforeSort","setDirtyAfterSort","syncDatasetWithSelectedRows","tempNodeIndex","changes","oldIdx","newDirtyArray","isEquivalent","obj1","_equals","regExp","tooltipId","aTitle","isRowstatus","isSvg","isTh","isHeaderFilter","wrapperHTML","extraClassList","targetEl","isEllipsis","extraWidth","tooltipContentEl","placeOptions","handleAfterPlaceTooltip","isGridtooltipType","placeApi","datagrid","FORMCOMPACT_DEFAULTS","FormCompact","renderProps","setState","attributeNames","inputsObserver","MutationObserver","mutationsList","mutation","attributeName","config","observe","disconnect","formcompact","HEADER_DEFAULTS","addScrollClass","demoOptions","toolbarSettings","useAlternate","useBackButton","useBreadcrumb","usePopupmenu","wizardTicks","Header","toolbarElem","titleButton","query","hasTitleButton","initPageChanger","titleText","levelsDeep","isFlex","buildTitleButton","buildTabs","buildWizard","buildPopupmenu","scrollDiv","scrollThreshold","preTitleSection","appMenu","handleTitleButtonEvents","buildBreadcrumb","breadcrumbClass","breadcrumb","handleBreadcrumbClick","adjustBreadcrumb","bcMarkup","txt","tabsContainer","titlePopup","titlePopupMenu","viewTitle","drillup","returnValue","breadcrumbs","removeButton","removeBreadcrumb","removePopupmenu","removeTabs","removeWizard","removeBackButton","destroyBreadcrumb","destroyTabs","destroyWizard","LOOKUP_GRID_ID","LOOKUP_DEFAULTS","modalContent","autoApply","autoWidth","delimiter","applyAutoWidth","createGrid","createModal","thisMoreBtn","thisLabel","settingContent","insertRows","hasKeywordSearch","closeTearDown","lookupGrid","applyMinWidth","selectGridRows","selectedId","adjust","selectedIds","selectRowByValue","foundInData","currValue","isUpperCase","MULTITABS_DEFAULTS","tabContainers","TAB_CONTAINER_NAMES","MultiTabs","setupTabsInstance","tabContainer","didAdd","propname","multitabsID","checkForValidTabContainer","targetTabContainerName","tabMarkup","panelMarkup","allTabContainers","getFilterableTabContainers","originalTabContainerName","getTabContainer","ref","performOnAllContainers","additionalArgs","adjustModuleTabContainers","hideTabsInstance","showTabsInstance","destroyTabsInstance","multitabs","LIST_DETAIL_DEFAULTS","backElement","edgeBleed","edgeBleedBreakpoint","listElement","listCloseElement","detailElement","LIST_DETAIL_SUPPORTED_LIST_TYPES","getListType","ListDetail","setInternalElementReference","elemType","showDetail","listComponentType","API","getListAPI","backElementIcon","listContainsBackElement","detailContainsBackElement","childrenListDetailElements","setBreakpointChecks","abovePhoneBreakpoint","aboveTabletBreakpoint","storageConditions","queryForElem","handleBackClick","handleClose","addBackElementIconContext","isAboveBreakpoint","detailArea","removeBackElementIconContext","cancelClick","getCurrentSelectedListItem","listAPI","breakpointPropname","listdetail","STEPPROCESS_DEFAULTS","linearProgression","stepList","stepLi","stepLink","stepFolder","btnPrev","btnNext","btnSaveClose","beforeSelectStep","Stepprocess","stepListJq","initStepprocess","startingStepLink","selectStep","stepJq","stepLinkJq","stepFolderJq","stepLinks","aria-level","aria-disabled","folderClose","treeIcon","setIcon","folderOpen","svgElem","folderToggle","isFolder","getSelectedStep","getNextStep","curStepJq","curStepLinkJq","curStepFolderJq","nextStepLinkJq","nextStepFolderJq","stepLinkToSelect","theFolder","prevStepJq","getPreviousStep","prevStepLinkJq","goToNextStep","isStepping","goToPreviousStep","isInFolder","linearDirection","selectStepFinish","allStepLinksJq","parentIsFolder","showStepPanel","aTags","targetJq","contentScroll","stepListScroll","contentId","stepprocess","INITIALIZE_DEFAULTS","noinitExcludes","invoke","pluginName","matchedItems","PLUGIN_MAPPINGS","change","popupElem","popupData","triggerButton","searchfields","toolbarSearchfields","mapToInit","plugin","Initialize","initAll","LONGPRESS_DEFAULTS","mouseEvents","LongPress","evts","getInputEventNames","BEHAVIOR_NAME","fire","mouseup","mouseout","mousemove","killTimer","useMouse","testCondition","longPress"],"mappings":"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AWE,EAAMhpB,IAGnC,OAAOgpB,EAAMrrB,KAAK,MASpBuf,sBAlhDa,WAmhDX,IAAM+L,GACJ,SACA,iBACA,cACA,SACA,OACA,oBACA,MACA,WACA,YACA,YACA,kBACA,SACA,aACA,SACA,SACA,YACA,SACA,aACA,kBACA,aACA,eACA,YACA,cACA,QACA,gBACA,QACA,OACA,UACA,cACA,cACA,mBACA,OACA,gBACA,cACA,SACA,OACA,OACA,gBACA,cACA,OACA,WACA,kBACA,eACA,kBACA,SACA,eACA,UACA,cACA,eACA,SACA,eACA,eACA,aACA,WACA,YACA,YACA,WACA,uBACA,gBACA,qBACA,kBACA,UACA,qBACA,WACA,gBACA,eACA,gBACA,kBACA,aACA,OACA,qBACA,UACA,mBACA,WACA,SACA,MACA,QACA,iBACA,aACA,qBACA,sBACA,iBACA,kBACA,gBACA,aACA,YACA,eACA,WACA,QACA,kBACA,YACA,UACA,eACA,kBACA,eACA,mBACA,aACA,WACA,yBACA,SACA,cACA,mBACA,eACA,UACA,YACA,cACA,iBACA,WACA,UACA,WACA,aACA,eAGFvoB,EAAE,OAAOqL,KAAK,WACZ,IAAMmd,EAAWxoB,EAAExC,MAAMirB,cAErBD,IAA4C,IAAhCxoB,EAAE0oB,QAAQF,EAAUD,IAA0D,IAAzCvoB,EAAExC,MAAMmrB,QAAQ,cAAcvqB,QACjF4B,EAAExC,MAAM0I,SAAS,uBC1pDzB,SAAS0iB,EAAWC,GAClB,GAAsB,mBAAXA,EAAuB,CAChC,GAAsB,iBAAXA,EACT,OAAOA,EAET,MAAM,IAAI3P,YAAJ,IAAoB2P,EAApB,YAAAza,EAAoBya,IAApB,gDAIR,GAA2B,iBAAhBA,EAAOjjB,KAChB,OAAUijB,EAAOjjB,KAAjB,KAKF,IAAMkjB,EAAS,4BAA4BxhB,KAAKuhB,EAAO9kB,YACvD,OAAO+kB,EAAYA,EAAO,GAAnB,KAA4B,uBASrC,SAASC,EAAqBC,EAAWC,GACvC,IAAMC,EAAgBN,EAAWI,GAC3BG,EAAgBP,EAAWK,GAEV,YAAnB,oBAAOG,QAAP,Y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","sourcesContent":["/* eslint-disable no-console */\n\n// Easy flag for determining whether or not time will be logged to the console.\nexport const enableTimeLogging = false;\n\n/**\n * Start the logging timer\n * @param  {string} label Provide a way to match a timing operation.\n * @returns {void}\n */\nexport function logTimeStart(label) {\n  if (enableTimeLogging) {\n    console.time(label);\n  }\n}\n\n/**\n * End the logging timer and print the result\n * @param  {string} label End this matching timing operation\n * @returns {void}\n */\nexport function logTimeEnd(label) {\n  if (enableTimeLogging) {\n    console.timeEnd(label);\n  }\n}\n\n// Easy flag for allowing console debugging\nexport const enableConsoleLogging = false;\n\n/**\n * Simple wrapper for `console.[whatever]` to abstract out console access.\n * @param {string} type console display type\n * @param {string} message message type\n * @returns {void}\n */\nexport function log(type, message) {\n  if (!enableConsoleLogging) {\n    return;\n  }\n\n  if (!console) { // eslint-disable-line\n    return;\n  }\n\n  if (!message && typeof type === 'string') {\n    message = type;\n    type = 'log';\n  }\n\n  if (typeof !console[type] !== 'function') {  // eslint-disable-line\n    type = 'log';\n  }\n\n  console[type](`${message}`); // eslint-disable-line\n}\n","const xssUtils = {};\n\n/**\n * Takes a string and removes all html tags\n * @param {string} str The string to parse\n * @returns {string} The string minus html tags.\n */\nxssUtils.stripHTML = function stripHTML(str) {\n  let newStr = str;\n\n  if (!newStr) {\n    return '';\n  }\n\n  newStr = newStr.replace(/<\\/?[^>]+(>|$)/g, '');\n  return newStr;\n};\n\n/**\n * Remove all html tags except for the ones specified. I.E. White list to a specific set of accepted tags.\n * @private\n * @param {string} html HTML in string form\n * @param {string} allowed Comma seperated string of allowed tags e.g. '<b><i><p>''\n * @returns {string} the modified value\n */\nxssUtils.stripTags = function (html, allowed) {\n  if (!html) {\n    return '';\n  }\n\n  if (typeof html === 'number') {\n    return html;\n  }\n\n  const whitelist = ((`${allowed || ''}`)\n    .toLowerCase()\n    .match(/<[a-z][a-z0-9]*>/g) || [])\n    .join(''); // making sure the allowed arg is a string containing only tags in lowercase (<a><b><c>)\n\n  const tags = /<\\/?([a-z][a-z0-9]*)\\b[^>]*>/gi;\n  const commentsAndPhpTags = /<!--[\\s\\S]*?-->|<\\?(?:php)?[\\s\\S]*?\\?>/gi;\n  let returnHTML = '';\n  returnHTML = html.replace(commentsAndPhpTags, '')\n    .replace(tags, ($0, $1) => whitelist.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : ''); //eslint-disable-line\n  returnHTML = returnHTML.replace(tags, ($0, $1) => whitelist.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : ''); //eslint-disable-line\n  returnHTML = returnHTML.replace(tags, ($0, $1) => whitelist.indexOf('<' + $1.toLowerCase() + '>') > -1 ? $0 : ''); //eslint-disable-line\n\n  return returnHTML;\n};\n\n/**\n * Remove Script tags and all onXXX functions\n * @private\n * @param {string} html HTML in string form\n * @returns {string} the modified value\n */\nxssUtils.sanitizeHTML = function (html) {\n  let santizedHtml = html.replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/g, '');\n  santizedHtml = santizedHtml.replace(/<[^>]+/g, match => match.replace(/(\\/|\\s)on\\w+=(\\'|\")?[^\"]*(\\'|\")?/g, '')); // eslint-disable-line\n\n  // Remove console.logs\n  santizedHtml = santizedHtml.replace(/console.log(\\b[^<]*(?:(?!\\);)<[^<]*)*);/g, '');\n  santizedHtml = santizedHtml.replace(/console.log(\\b[^<]*(?:(?!\\))<[^<]*)*)/g, '');\n\n  // Remove nested script tags\n  santizedHtml = santizedHtml.replace(/<\\/script>/g, '');\n\n  return santizedHtml;\n};\n\n/**\n * Make sure a string is only alphanumeric (with dashes allowed.)\n * @private\n * @param {string} string HTML in string form\n * @returns {string} the modified value\n */\nxssUtils.ensureAlphaNumeric = function (string) {\n  if (typeof string === 'number') {\n    return string;\n  }\n  return this.stripTags(string).replace(/[^a-z0-9-]/gi, '', '');\n};\n\n/**\n * Escapes HTML, replacing special characters with encoded symbols.\n * Symbols taken from https://bit.ly/1iVkGlc\n * @private\n * @param {string} value HTML in string form\n * @returns {string} the modified value\n */\nxssUtils.escapeHTML = function (value) {\n  const newValue = value;\n  if (typeof newValue === 'string') {\n    const map = {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#x27;'\n    };\n    const reg = /[&<>\"']/ig;\n    return newValue.replace(reg, match => (map[match]));\n  }\n  return newValue;\n};\n\n/**\n * Un-escapes HTML, replacing encoded symbols with special characters.\n * Symbols taken from https://bit.ly/1iVkGlc\n * @private\n * @param {string} value HTML in string form\n * @returns {string} the modified value\n */\nxssUtils.unescapeHTML = function (value) {\n  let newValue = value;\n  if (typeof value === 'string') {\n    newValue = newValue.replace(/&amp;/g, '&');\n    newValue = newValue.replace(/&lt;/g, '<').replace(/&gt;/g, '>');\n    newValue = newValue.replace(/&quot;/g, '\"');\n    newValue = newValue.replace(/&#x27;/g, \"'\");\n    newValue = newValue.replace(/&#x2F;/g, '/');\n  }\n  return newValue;\n};\n\n/**\n * htmlentities() is a PHP function which converts special characters (like <)\n * into their escaped/encoded values (like &lt;). This is a JS verson of it.\n * This allows you to show to display the string without the browser reading it as HTML.\n * This is useful for encoding hrefs.\n * @private\n * @param {string} string string to process\n * @returns {string} the processed value\n */\nxssUtils.htmlEntities = function (string) {\n  return String(string)\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;');\n};\n\n/**\n * Ensure that a link is a local link (relative to the current page)\n * @private\n * @param {string} url string to process\n * @returns {boolean} If it is local or not\n */\nxssUtils.isUrlLocal = function (url) {\n  const isEmpty = (url === '');\n  return !isEmpty &&\n    ((url[0] === '/' && (url.length === 1 || (url[1] !== '/' && url[1] !== '\\\\'))) || // \"/\" or \"/foo\" but not \"//\" or \"/\\\"\n    (url.length > 1 && url[0] === '~' && url[1] === '/')) || // \"~/\" or \"~/foo\"\n    (url.length >= 1 && url[0] === '#'); // \"#\" or \"#foo\"\n};\n\nexport { xssUtils };\n","import { xssUtils } from './xss';\n\nconst DOM = {};\n\n/**\n * Returns an array containing an element's attributes.\n * @param {HTMLElement|SVGElement} element the element whose attributes are being accessed\n * @returns {object} list of attributes in name/value pairs.\n */\nDOM.getAttributes = function getAttributes(element) {\n  if (!element || (!(element instanceof HTMLElement) && !(element instanceof SVGElement))) {\n    return {};\n  }\n\n  return element.attributes;\n};\n\n/**\n * Adding, removing, and testing for classes\n * @param {HTMLElement} element the element to test\n * @returns {boolean} whether or not a className exists\n */\nDOM.classNameExists = function classNameExists(element) {\n  const cn = element.className;\n  return cn && cn.length > 0;\n};\n\n/**\n * Checks the element for the existence of a particular class.\n * @param {HTMLElement|SVGElement} el a element being checked.\n * @param {string} className a string representing a class name to check for.\n * @returns {boolean} whether or not the element's class attribute contains the string.\n */\nDOM.hasClass = function hasClass(el, className) {\n  if (!el.classList) {\n    return false;\n  }\n\n  // Use `className` if there's no `classList`\n  if (el.className) {\n    return new RegExp(`\\\\b${className}\\\\b`).test(el.className);\n  }\n\n  // If no `className`, this element is probably an SVG or other namespace element\n  const classAttr = el.getAttribute('class');\n  if (!classAttr || !classAttr.length) {\n    return false;\n  }\n  return classAttr.indexOf(className) > -1;\n};\n\n/**\n * Add a class to any element and handle multiple classes.\n * Handles DOM and SVG elements down to IE11\n * @param {HTMLElement} el a element being checked.\n * @param {...string} className a string representing a class name.\n */\nDOM.addClass = function addClass(el, ...className) {\n  for (let i = 0; i < className.length; i++) {\n    if (el.classList) {\n      el.classList.add(className[i]);\n    } else if (!DOM.hasClass(el, [i])) {\n      el.className += ` ${className[i]}`;\n    }\n  }\n};\n\n/**\n * Remove a class from any element and handle multiple classes.\n * Handles DOM and SVG elements down to IE11\n * @param {HTMLElement} el a element being checked.\n * @param {...string} className a string representing a class name.\n */\nDOM.removeClass = function removeClass(el, ...className) {\n  for (let i = 0; i < className.length; i++) {\n    if (el.classList) {\n      el.classList.remove(className[i]);\n    } else {\n      let newClassName = '';\n      const classes = el.className.split(' ');\n      for (let j = 0; j < classes.length; j++) {\n        if (classes[j] !== className[j]) {\n          newClassName += `${classes[i]} `;\n        }\n      }\n      this.className = newClassName;\n    }\n  }\n};\n\n/**\n * Checks if an element is valid\n * @param {HTMLElement|SVGElement|jQuery[]} el The element being checked\n * @returns {boolean} represents all values normally contained by a DOMRect or ClientRect\n */\nDOM.isElement = function isElement(el) {\n  if ((el instanceof HTMLElement) || (el instanceof SVGElement) || (el instanceof $ && el.length)) {\n    return true;\n  }\n  return false;\n};\n\n/**\n * Runs the generic _getBoundingClientRect()_ method on an element, but returns its results\n * as a plain object instead of a ClientRect\n * @param {HTMLElement|SVGElement|jQuery[]} el The element being manipulated\n * @returns {object} represents all values normally contained by a DOMRect or ClientRect\n */\nDOM.getDimensions = function getDimensions(el) {\n  if (!DOM.isElement(el)) {\n    return {};\n  }\n\n  if (el instanceof $) {\n    if (!el.length) {\n      return {};\n    }\n\n    el = el[0];\n  }\n\n  const rect = el.getBoundingClientRect();\n  const rectObj = {};\n\n  for (let prop in rect) { // eslint-disable-line\n    if (!isNaN(rect[prop])) {\n      rectObj[prop] = rect[prop];\n    }\n  }\n\n  return rectObj;\n};\n\n/**\n * Append content to a DOM element (like jQuery.append)\n * @param {HTMLElement|SVGElement|jQuery[]} el The element to append to\n * @param {string|jQuery} contents The html string or jQuery object.\n * @param {string} stripTags A list of tags to strip to prevent xss, or * for sanitizing and allowing all tags.\n */\nDOM.append = function append(el, contents, stripTags) {\n  let domEl = el;\n\n  if (el instanceof $ && el.length) {\n    domEl = domEl[0];\n  }\n\n  if (domEl instanceof HTMLElement || domEl instanceof SVGElement) {\n    domEl.insertAdjacentHTML('beforeend', this.xssClean(contents, stripTags));\n  }\n};\n\n/**\n * Remove a DOM Element\n * @param {HTMLElement|SVGElement|jQuery[]} el The element to remove.\n */\nDOM.remove = function append(el) {\n  let domEl = el;\n\n  if (el instanceof $ && el.length) {\n    domEl = domEl[0];\n  }\n\n  if ((domEl instanceof HTMLElement || domEl instanceof SVGElement) && el.parentNode) {\n    el.parentNode.removeChild(el);\n  }\n};\n\n/**\n * Set an attribute with an extra check that the object exists.\n * @param {HTMLElement|SVGElement|jQuery[]} el The element to set the attribute on\n * @param {string} attribute The attribute name.\n * @param {string} value The attribute value.\n */\nDOM.setAttribute = function append(el, attribute, value) {\n  let domEl = el;\n\n  if (el instanceof $ && el.length) {\n    domEl = domEl[0];\n  }\n\n  if (domEl instanceof HTMLElement || domEl instanceof SVGElement) {\n    domEl.setAttribute('attribute', value);\n  }\n};\n\n/**\n * Clean the markup before insertion.\n * @param {string|jQuery} contents The html string or jQuery object.\n * @param {string} stripTags A list of tags to strip to prevent xss, or * for sanitizing and allowing all tags.\n * @returns {string} the cleaned up markup\n */\nDOM.xssClean = function xssClean(contents, stripTags) {\n  let markup = contents;\n\n  if (stripTags && stripTags !== '*') {\n    markup = xssUtils.stripTags(contents, stripTags);\n  }\n\n  if (stripTags === '*') {\n    markup = xssUtils.sanitizeHTML(contents);\n  }\n\n  return markup;\n};\n\n/**\n * Append content to a DOM element (like jQuery.append)\n * @param {HTMLElement|SVGElement|jQuery[]} el The element to append to\n * @param {string|jQuery} contents The html string or jQuery object.\n * @param {string} stripTags A list of tags to strip to prevent xss, or * for sanitizing and allowing all tags.\n */\nDOM.html = function html(el, contents, stripTags) {\n  let domEl = el;\n\n  if (el instanceof $ && el.length) {\n    domEl = domEl[0];\n  }\n\n  if (domEl instanceof HTMLElement || domEl instanceof SVGElement) {\n    domEl.innerHTML = this.xssClean(contents, stripTags);\n  }\n};\n\nexport { DOM };\n","import { DOM } from './dom';\n\n// =================================================================\n// Soho JS-level Breakpoint Access\n// NOTE: these should match whatever the breakpoints are in \"/sass/_config.scss\"\n// =================================================================\nconst breakpoints = {\n  phone: 320,\n  slim: 400,\n  phablet: 610,\n  'phone-to-tablet': 767,\n  'wide-tablet': 968,\n  'tablet-to-desktop': 1280,\n  desktop: 1024,\n  'desktop-to-extralarge': 1600\n};\n\n/**\n * Get the name of the current CSS breakpoint by checking the popuplated 'content' value of the\n * <body> tag's `::after` pseudo-element.  These names should be reflected in the breakpoints object\n * above.\n * @returns {string} name of the current breakpoint\n */\nbreakpoints.current = function () {\n  const afterElement = window.getComputedStyle ? window.getComputedStyle(document.body, ':after') : false;\n  if (!afterElement) {\n    return '';\n  }\n  return (afterElement.getPropertyValue('content') || '').replace(/\"/g, '');\n};\n\n/**\n * @param {string} breakpoint matches one of the entries in the \"Soho.breakpoints\" object.\n * @returns {boolean} whether or not the window is currently wider than the breakpoint provided.\n */\nbreakpoints.isAbove = function isAbove(breakpoint) {\n  const bp = breakpoints[breakpoint];\n  if (!bp) {\n    return false;\n  }\n\n  const windowWidth = $(window).width();\n  return windowWidth > bp - 1;\n};\n\n/**\n * @param {string} breakpoint matches one of the entries in the \"Soho.breakpoints\" object.\n * @returns {boolean} whether or not the window is currently more narrow\n *  than the breakpoint provided.\n */\nbreakpoints.isBelow = function isBelow(breakpoint) {\n  const bp = breakpoints[breakpoint];\n  if (!bp) {\n    return false;\n  }\n\n  const windowWidth = $(window).width();\n  return windowWidth < bp;\n};\n\n/**\n * Compares the last-stored breakpoint with a check on the \"current\" breakpoint to see if the\n * breakpoint has changed.\n * @returns {void}\n */\nbreakpoints.compare = function compare() {\n  if (!this.last) {\n    this.last = '';\n  }\n\n  const cur = this.current();\n  if (this.last !== cur) {\n    $('body').triggerHandler('breakpoint-change', [{\n      previous: this.last,\n      current: cur\n    }]);\n    this.last = cur;\n  }\n};\n\n/**\n * Checks an element for Soho visibility classes and determines whether or not\n * should be hidden based on those values at the current breakpoint.\n * NOTE: this method does NOT determine if the element is ACTUALLY hidden with a\n * `display: none;` or `visibility: hidden;` rule.  It determines whether or not a CSS\n * visibility rule alone would hide the element.\n * @param {HTMLElement} element the element being checked.\n * @returns {boolean} whether or not the element is hidden at this breakpoint.\n */\nbreakpoints.isHidden = function (element) {\n  if (!element || !DOM.isElement(element)) {\n    return false;\n  }\n\n  // If there are no CSS classes on the element, return false.\n  const cl = element.classList;\n  if (!cl.length) {\n    return false;\n  }\n\n  // If it's always hidden, always return true.\n  if (cl.contains('hidden')) {\n    return true;\n  }\n\n  const bp = this.current();\n  const map = {\n    phonedown: 'xs',\n    phone: 'sm',\n    tablet: 'md',\n    desktop: 'lg',\n    extralarge: 'xl',\n  };\n  const size = map[bp];\n  const hiddenClassName = `hidden-${size}`;\n  const visibleClassName = `visible-${size}-`;\n\n  // Should be hidden on this breakpoint\n  if (cl.contains(hiddenClassName)) {\n    return true;\n  }\n\n  // If explicitly visible, return\n  if (cl.toString().indexOf(visibleClassName) > -1) {\n    return false;\n  }\n\n  // Simply return false if none of these thing are found\n  return false;\n};\n\n/**\n * jQuery wrapper for `Soho.breakpoints.isHidden()`\n * NOTE: if a jQuery selector with multiple elements is passed to this function,\n * it will only operate on the first one.\n * This method is NOT chainable.\n * @returns {boolean} whether or not the element is hidden at this breakpoint.\n */\n$.fn.isHiddenAtBreakpoint = function () {\n  if (!this.length) {\n    return false;\n  }\n  return breakpoints.isHidden($(this).first()[0]);\n};\n\nexport { breakpoints };\n","/**\n * Debounce method\n * @param {function} func the callback function to be run on a stagger.\n * @param {number} [threshold] the amount of time in CPU ticks to delay.\n * @param {boolean} [execAsap] if true, executes the callback immediately\n *  instead of waiting for the threshold to complete.\n * @returns {void}\n */\nfunction debounce(func, threshold, execAsap) {\n  let timeout;\n\n  return function debounced(...args) {\n    const obj = this;\n    function delayed() {\n      if (!execAsap) {\n        func.apply(obj, args);\n      }\n      timeout = null;\n    }\n\n    if (timeout) {\n      clearTimeout(timeout);\n    } else if (execAsap) {\n      func.apply(obj, args);\n    }\n\n    timeout = setTimeout(delayed, threshold || 250);\n  };\n}\n\nexport { debounce };\n","import { debounce } from './debounced-resize';\n\nconst debouncedResizeName = 'debouncedResize';\n\n/**\n * Bind the smartResize method to $.fn()\n * @param {function} fn the callback function to be bound on debounced resize\n * @returns {void}\n */\n$.fn[debouncedResizeName] = function (fn) {\n  if (fn) {\n    return this.bind('resize', debounce(fn));\n  }\n  return this.trigger(debouncedResizeName);\n};\n","import { version as SOHO_XI_VERSION } from '../../package.json';\nimport { breakpoints } from './breakpoints';\n\n// jQuery Components\nimport './debounced-resize.jquery';\n\n// Utility Name\nconst UTIL_NAME = 'environment';\n\n/**\n * @class {Environment}\n */\nconst Environment = {\n\n  browser: {},\n\n  features: {\n    touch: (('ontouchstart' in window) || (navigator.MaxTouchPoints > 0) || (navigator.msMaxTouchPoints > 0))\n  },\n\n  os: {},\n  devicespecs: {},\n\n  rtl: $('html').attr('dir') === 'rtl',\n\n  /**\n   * Builds run-time environment settings\n   */\n  set() {\n    $('html').attr('data-sohoxi-version', SOHO_XI_VERSION);\n    this.addBrowserClasses();\n    this.addGlobalResize();\n    this.addGlobalEvents();\n    this.addDeviceSpecs();\n  },\n\n  /**\n   * Global Classes for browser, version and device as needed.\n   */\n  addBrowserClasses() {\n    const ua = navigator.userAgent || navigator.vendor || window.opera;\n    const platform = navigator.platform;\n    const html = $('html');\n    let cssClasses = ''; // User-agent string\n\n    if (ua.indexOf('Safari') !== -1 &&\n        ua.indexOf('Chrome') === -1 &&\n        ua.indexOf('Android') === -1) {\n      cssClasses += 'is-safari ';\n      this.browser.name = 'safari';\n    }\n\n    if (ua.indexOf('Chrome') !== -1) {\n      cssClasses += 'is-chrome ';\n      this.browser.name = 'chrome';\n    }\n\n    const macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n    if (macosPlatforms.indexOf(platform) > -1 && !/Linux/.test(platform)) {\n      cssClasses += 'is-mac ';\n      this.os.name = 'Mac OS X';\n    }\n\n    if (ua.indexOf('Firefox') > 0) {\n      cssClasses += 'is-firefox ';\n      this.browser.name = 'firefox';\n    }\n\n    // Class-based detection for IE\n    if (ua.match(/Edge\\//)) {\n      cssClasses += 'ie ie-edge ';\n      this.browser.name = 'edge';\n      this.browser.version = navigator.appVersion.indexOf('Edge/18') > -1 ? '18' : '17';\n      cssClasses += `ie-edge${this.browser.version}`;\n    }\n    if (ua.match(/Trident/)) {\n      cssClasses += 'ie ';\n      this.browser.name = 'ie';\n    }\n    if (navigator.appVersion.indexOf('MSIE 8.0') > -1 ||\n      ua.indexOf('MSIE 8.0') > -1 ||\n      document.documentMode === 8) {\n      cssClasses += 'ie8 ';\n      this.browser.version = '8';\n    }\n    if (navigator.appVersion.indexOf('MSIE 9.0') > -1) {\n      cssClasses += 'ie9 ';\n      this.browser.version = '9';\n    }\n    if (navigator.appVersion.indexOf('MSIE 10.0') > -1) {\n      cssClasses += 'ie10 ';\n      this.browser.version = '10';\n    } else if (ua.match(/Trident\\/7\\./)) {\n      cssClasses += 'ie11 ';\n      this.browser.version = '11';\n    }\n\n    // Class-based detection for iOS\n    // /iPhone|iPod|iPad|Silk|Android|BlackBerry|Opera Mini|IEMobile/\n    if ((/iPhone|iPod|iPad/).test(ua)) {\n      cssClasses += 'ios ';\n      this.os.name = 'ios';\n\n      const iDevices = ['iPod', 'iPad', 'iPhone'];\n      for (let i = 0; i < iDevices.length; i++) {\n        if (new RegExp(iDevices[i]).test(ua)) {\n          cssClasses += `${iDevices[i].toLowerCase()} `;\n          this.device = iDevices[i];\n        }\n      }\n    }\n\n    if ((/Android/.test(ua))) {\n      cssClasses += 'android ';\n      this.os.name = 'android';\n    }\n\n    if (!this.os.name && /Linux/.test(platform)) {\n      this.os.name = 'linux';\n    }\n\n    html.addClass(cssClasses);\n  },\n\n  addDeviceSpecs() {\n    const unknown = '-';\n    const nAppVer = navigator.appVersion;\n    const nUAgent = navigator.userAgent;\n    let browser = navigator.appName;\n    let version = ` ${parseFloat(navigator.appVersion)}`;\n    let majorVersion = parseInt(navigator.appVersion, 10);\n    let nameOffset;\n    let verOffset;\n    let ix;\n\n    if ((verOffset = nUAgent.indexOf('Opera')) !== -1) { //eslint-disable-line\n      browser = 'Opera';\n      version = nUAgent.substring(verOffset + 6);\n      if ((verOffset = nUAgent.indexOf('Version')) !== -1) { //eslint-disable-line\n        version = nUAgent.substring(verOffset + 8);\n      }\n    }\n    if ((verOffset = nUAgent.indexOf('OPR')) !== -1) { //eslint-disable-line\n      browser = 'Opera';\n      version = nUAgent.substring(verOffset + 4);\n    } else if ((verOffset = nUAgent.indexOf('Edge')) !== -1) { //eslint-disable-line\n      browser = 'Microsoft Edge';\n      version = nUAgent.substring(verOffset + 5);\n    } else if ((verOffset = nUAgent.indexOf('MSIE')) !== -1) { //eslint-disable-line\n      browser = 'Microsoft Internet Explorer';\n      version = nUAgent.substring(verOffset + 5);\n    } else if ((verOffset = nUAgent.indexOf('Chrome')) !== -1) { //eslint-disable-line\n      browser = 'Chrome';\n      version = nUAgent.substring(verOffset + 7);\n    } else if ((verOffset = nUAgent.indexOf('Safari')) !== -1) { //eslint-disable-line\n      browser = 'Safari';\n      version = nUAgent.substring(verOffset + 7);\n      if ((verOffset = nUAgent.indexOf('Version')) !== -1) { //eslint-disable-line\n        version = nUAgent.substring(verOffset + 8);\n      }\n    } else if ((verOffset = nUAgent.indexOf('Firefox')) !== -1) { //eslint-disable-line\n      browser = 'Firefox';\n      version = nUAgent.substring(verOffset + 8);\n    } else if (nUAgent.indexOf('Trident/') !== -1) { //eslint-disable-line\n      browser = 'Microsoft Internet Explorer';\n      version = nUAgent.substring(nUAgent.indexOf('rv:') + 3);\n    } else if ((nameOffset = nUAgent.lastIndexOf(' ') + 1) < (verOffset = nUAgent.lastIndexOf('/'))) { //eslint-disable-line\n      browser = nUAgent.substring(nameOffset, verOffset);\n      version = nUAgent.substring(verOffset + 1);\n      if (browser.toLowerCase() === browser.toUpperCase()) {\n        browser = navigator.appName;\n      }\n    }\n    // Trim the version string\n    if ((ix = version.indexOf(';')) !== -1) version = version.substring(0, ix); //eslint-disable-line\n    if ((ix = version.indexOf(' ')) !== -1) version = version.substring(0, ix); //eslint-disable-line\n    if ((ix = version.indexOf(')')) !== -1) version = version.substring(0, ix); //eslint-disable-line\n\n    majorVersion = ` ${parseInt(version, 10)}`;\n    if (isNaN(majorVersion)) {\n      version = ` ${parseFloat(navigator.appVersion)}`;\n      majorVersion = parseInt(navigator.appVersion, 10);\n    }\n\n    // mobile version\n    const mobile = /Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(nAppVer);\n\n    let os = unknown;\n\n    const clientStrings = [\n      { s: 'Windows 10', r: /(Windows 10.0|Windows NT 10.0)/ },\n      { s: 'Windows 8.1', r: /(Windows 8.1|Windows NT 6.3)/ },\n      { s: 'Windows 8', r: /(Windows 8|Windows NT 6.2)/ },\n      { s: 'Windows 7', r: /(Windows 7|Windows NT 6.1)/ },\n      { s: 'Android', r: /Android/ },\n      { s: 'Open BSD', r: /OpenBSD/ },\n      { s: 'Sun OS', r: /SunOS/ },\n      { s: 'Linux', r: /(Linux|X11)/ },\n      { s: 'iOS', r: /(iPhone|iPad|iPod)/ },\n      { s: 'Mac OS X', r: /Mac OS X/ },\n      { s: 'Mac OS', r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/ },\n      { s: 'UNIX', r: /UNIX/ }\n    ];\n\n    for (const id in clientStrings) { //eslint-disable-line\n      const cs = clientStrings[id];\n      if (cs.r.test(nUAgent)) {\n        os = cs.s;\n        break;\n      }\n    }\n\n    let osVersion = unknown;\n\n    if (/Windows/.test(os)) {\n      osVersion = /Windows (.*)/.exec(os)[1];\n    }\n\n    switch (os) { //eslint-disable-line\n      case 'Mac OS X':\n        osVersion = /Mac OS X (10[\\.\\_\\d]+)/.exec(nUAgent)[1].replace(/\\_/g, '.'); //eslint-disable-line\n        break;\n\n      case 'Android':\n        osVersion = /Android ([\\.\\_\\d]+)/.exec(nUAgent)[1]; //eslint-disable-line\n        break;\n\n      case 'iOS':\n        osVersion = /OS (\\d+)_?(\\d+)?/.exec(nUAgent); //eslint-disable-line\n        osVersion = `${osVersion[1]}.${osVersion[2]}.${(osVersion[3] | 0)}`; //eslint-disable-line\n        break;\n    }\n\n    this.devicespecs = {\n      currentBrowser: browser,\n      browserVersion: version,\n      browserMajorVersion: majorVersion,\n      isMobile: mobile,\n      os,\n      currentOSVersion: osVersion\n    };\n  },\n\n  /**\n   * Setup a global resize event trigger for controls to listen to\n   */\n  addGlobalResize() {\n    // Global resize event\n    $(window).debouncedResize(() => {\n      $('body').triggerHandler('resize', [window]);\n      breakpoints.compare();\n    });\n\n    // Also detect whenenver a load or orientation change occurs\n    $(window).on('orientationchange load', () => breakpoints.compare());\n  },\n\n  /**\n   * Sets up global UI-specific event handlers\n   * @returns {void}\n   */\n  addGlobalEvents() {\n    const self = this;\n\n    this.globalMouseActive = 0;\n    this.globalTouchActive = 0;\n\n    // Detect mouse/touch events on the body to help scrolling detection along\n    $('body')\n      .on(`mousedown.${UTIL_NAME}`, () => {\n        ++this.globalMouseActive;\n      })\n      .on(`mouseup.${UTIL_NAME}`, () => {\n        --this.globalMouseActive;\n      })\n      .on(`touchstart.${UTIL_NAME}`, () => {\n        ++this.globalTouchActive;\n      })\n      .on(`touchend.${UTIL_NAME}`, () => {\n        --this.globalTouchActive;\n      });\n\n    // On iOS, it's possible to scroll the body tag even if there's a `no-scroll` class attached\n    // This listener persists and will prevent scrolling on the body tag in the event of a `no-scroll`\n    // class, only in iOS environments\n    $(window).on(`scroll.${UTIL_NAME}`, (e) => {\n      if (self.os.name !== 'ios' || document.body.className.indexOf('no-scroll') === -1) {\n        return true;\n      }\n\n      // If a mouse button or touch is still active, continue as normal\n      if (this.globalTouchActive || this.globalMouseActive) {\n        return true;\n      }\n\n      e.preventDefault();\n      if (document.body.scrollTop > 0) {\n        document.body.scrollTop = 0;\n      }\n      return false;\n    });\n\n    // Prevent zooming on inputs/textareas' `focusin`/`focusout` events.\n    // Some components like Dropdown have this feature built in on their specified elements.\n    // This particular setup prevents zooming on input fields not tied to a component wrapper.\n    $('body').on(`focusin.${UTIL_NAME}`, 'input, textarea', (e) => {\n      const target = e.target;\n      if (target.className.indexOf('dropdown-search') > -1) {\n        return;\n      }\n\n      if (self.os.name === 'ios') {\n        $('head').triggerHandler('disable-zoom');\n      }\n    }).on(`focusout.${UTIL_NAME}`, 'input, textarea', (e) => {\n      const target = e.target;\n      if (target.className.indexOf('dropdown-search') > -1) {\n        return;\n      }\n\n      if (self.os.name === 'ios') {\n        $('head').triggerHandler('enable-zoom');\n      }\n    });\n  },\n\n  /**\n   * Tears down global UI-specific event handlers\n   * @returns {void}\n   */\n  removeGlobalEvents() {\n    $(window).off(`scroll.${UTIL_NAME}`);\n\n    $('body').off([\n      `focusin.${UTIL_NAME}`,\n      `focusout.${UTIL_NAME}`\n    ].join(' '));\n  }\n};\n\n/**\n * @returns {boolean} whether or not the current browser is IE11\n */\nEnvironment.browser.isIE11 = function () {\n  return Environment.browser.name === 'ie' && Environment.browser.version === '11';\n};\n\n/**\n * @returns {boolean} whether or not the current browser is IE10\n */\nEnvironment.browser.isIE10 = function () {\n  return Environment.browser.name === 'ie' && Environment.browser.version === '10';\n};\n\n/**\n * Automatically set up the environment by virtue of including this script\n */\nEnvironment.set();\n\nexport { Environment };\n","import { DOM } from './dom';\nimport { Environment as env } from './environment';\n\n/**\n * HideFocus Behavior\n * Only shows the focus state on key entry (tabs or arrows).\n * @param {HTMLElement|SVGElement} element the base element\n * @returns {HideFocus} component instance\n */\nfunction HideFocus(element) {\n  return this.init(element);\n}\n\nHideFocus.prototype = {\n  init(element) {\n    if (!this.element && (element instanceof HTMLElement || element instanceof SVGElement)) {\n      this.element = element;\n    }\n\n    const $el = $(element);\n    let isClick = false;\n    let isFocused = false;\n    let labelClicked = false;\n\n    // Checkbox, Radio buttons or Switch\n    if ($el.is('.checkbox, .radio, .switch')) {\n      let label = $el.next();\n      if (label.is('[type=\"hidden\"]')) {\n        label = label.next();\n      }\n      this.label = label[0];\n\n      $el.addClass('hide-focus')\n        .on('focusin.hide-focus', (e) => {\n          if (!isClick && !isFocused && !labelClicked) {\n            $el.removeClass('hide-focus');\n            $el.triggerHandler('hidefocusremove', [e]);\n          }\n          isClick = false;\n          isFocused = true;\n          labelClicked = false;\n        })\n        .on('focusout.hide-focus', (e) => {\n          $el.addClass('hide-focus');\n          labelClicked = label.is(labelClicked);\n          isClick = false;\n          isFocused = false;\n          $el.triggerHandler('hidefocusadd', [e]);\n        });\n\n      label.on('mousedown.hide-focus', function (e) {\n        labelClicked = this;\n        isClick = true;\n        $el.addClass('hide-focus');\n        $el.triggerHandler('hidefocusadd', [e]);\n      });\n    } else {\n      // All other elements (ie. Hyperlinks)\n      const handleMousedown = (e) => {\n        isClick = true;\n        $el.addClass('hide-focus');\n        $el.triggerHandler('hidefocusadd', [e]);\n      };\n      const isTouch = env.features.touch;\n\n      if (isTouch) {\n        $el.on('touchstart.hide-focus', (e) => {\n          handleMousedown(e);\n        });\n      }\n\n      $el.addClass('hide-focus')\n        .on('mousedown.hide-focus', (e) => {\n          handleMousedown(e);\n        })\n        .on('focusin.hide-focus', (e) => {\n          if (!isClick && !isFocused) {\n            $el.removeClass('hide-focus');\n            $el.triggerHandler('hidefocusremove', [e]);\n          }\n          isClick = false;\n          isFocused = true;\n        })\n        .on('focusout.hide-focus', (e) => {\n          $el.addClass('hide-focus');\n          isClick = false;\n          isFocused = false;\n          $el.triggerHandler('hidefocusadd', [e]);\n        });\n    }\n\n    return this;\n  },\n\n  updated() {\n    return this\n      .teardown()\n      .init();\n  },\n\n  teardown() {\n    if (this.label) {\n      $(this.label).off('mousedown.hide-focus');\n    }\n\n    const elemEvents = [\n      'focusin.hide-focus',\n      'focusout.hide-focus',\n      'mousedown.hide-focus',\n      'touchstart.hide-focus'\n    ];\n    $(this.element).off(elemEvents.join(' '));\n\n    return this;\n  }\n};\n\n/**\n * jQuery component wrapper for the HideFocus behavior\n * @returns {jQuery[]} components being acted on\n */\n$.fn.hideFocus = function () {\n  return this.each(function () {\n    let instance = $.data(this, 'hidefocus');\n    if (instance) {\n      instance.updated();\n    } else {\n      instance = $.data(this, 'hidefocus', new HideFocus(this));\n      instance.destroy = function destroy() {\n        this.teardown();\n        $.removeData(this, 'hidefocus');\n      };\n    }\n  });\n};\n\n/**\n * Allows for the smooth scrolling of an element's content area.\n * @param {HTMLElement|SVGElement|jQuery[]} el The element being manipulated.\n * @param {number} target target distance.\n * @param {number} duration the time that will be needed for the scrolling to complete.\n * @returns {$.Deferred} promise that resolved when scrolling completes.\n */\nfunction smoothScrollTo(el, target, duration) {\n  const dfd = $.Deferred();\n\n  if (!DOM.isElement(el)) {\n    // Not a workable element\n    return dfd.reject();\n  }\n\n  // Strip the jQuery\n  if (el instanceof $ && el.length) {\n    el = el[0];\n  }\n\n  // undefined (not zero) target should instantly resolve\n  if (target === undefined || target === null) {\n    return dfd.resolve();\n  }\n\n  if (isNaN(duration)) {\n    duration = 0;\n  }\n\n  target = Math.round(target);\n  duration = Math.round(duration);\n\n  if (duration < 0) {\n    // bad duration\n    return dfd.fail();\n  }\n\n  if (duration === 0) {\n    el.scrollLeft += target;\n    return dfd.resolve();\n  }\n\n  const startTime = Date.now();\n  const endTime = startTime + duration;\n  const startLeft = el.scrollLeft;\n  const distance = target;\n\n  // based on http://en.wikipedia.org/wiki/Smoothstep\n  function smoothStep(start, end, point) {\n    if (point <= start) { return 0; }\n    if (point >= end) { return 1; }\n    const x = (point - start) / (end - start); // interpolation\n    return x * x * (3 - 2 * x);\n  }\n\n  // This is to keep track of where the element's scrollLeft is\n  // supposed to be, based on what we're doing\n  let previousLeft = el.scrollLeft;\n\n  // This is like a think function from a game loop\n  function scrollFrame() {\n    if (el.scrollLeft !== previousLeft) {\n      // interrupted\n      dfd.reject();\n      return;\n    }\n\n    // set the scrollLeft for this frame\n    const now = Date.now();\n    const point = smoothStep(startTime, endTime, now);\n    const frameLeft = Math.round(startLeft + (distance * point));\n    el.scrollLeft = frameLeft;\n\n    // check if we're done!\n    if (now >= endTime) {\n      dfd.resolve();\n      return;\n    }\n\n    // If we were supposed to scroll but didn't, then we\n    // probably hit the limit, so consider it done; not\n    // interrupted.\n    if (el.scrollLeft === previousLeft && el.scrollLeft !== frameLeft) {\n      dfd.resolve();\n      return;\n    }\n    previousLeft = el.scrollLeft;\n\n    // schedule next frame for execution\n    setTimeout(scrollFrame, 0);\n  }\n\n  // boostrap the animation process\n  setTimeout(scrollFrame, 0);\n\n  return dfd;\n}\n\n/**\n * Binds the Soho Behavior _smoothScrollTo()_ to a jQuery selector\n * @param {number} target target distance to scroll the element\n * @param {number} duration the time that will be needed for the scrolling to complete.\n * @returns {$.Deferred} promise that resolved when scrolling completes.\n */\n$.fn.smoothScroll = function (target, duration) {\n  return smoothScrollTo(this, target, duration);\n};\n\n/**\n * Uses 'requestAnimationFrame' or 'setTimeout' to defer a function.\n * @param {function} callback the callback that runs on a deferment.\n * @param {number} timer how long to delay before running the callback.\n * @returns {function} either `requestAnimationFrame` or `setTimeout`\n */\nfunction defer(callback, timer) {\n  const deferMethod = typeof window.requestAnimationFrame !== 'undefined' ? window.requestAnimationFrame : setTimeout;\n  return deferMethod(callback, timer);\n}\n\nexport { HideFocus, smoothScrollTo, defer };\n","import { defer } from './behaviors';\nimport { Environment as env } from './environment';\nimport { DOM } from './dom';\n\n/**\n * Used for changing the stacking order of jQuery events.  This is needed to override certain\n * Events invoked by other plugins http://stackoverflow.com/questions/2360655\n * @private\n * @param {string} name the event name\n * @param {function} fn callback function that will be called during the supplied event name\n * @returns {void}\n */\n$.fn.bindFirst = function (name, fn) {\n  this.on(name, fn);\n  this.each(function () {\n    const handlers = $._data(this, 'events')[name.split('.')[0]]; // eslint-disable-line\n    // take out the handler we just inserted from the end\n    const handler = handlers.pop();\n    // move it at the beginning\n    handlers.splice(0, 0, handler);\n  });\n};\n\n/**\n * @private\n * uniqueIdCount is a baseline unique number that will be used when generating\n * uniqueIds for elements and components.\n */\nexport let uniqueIdCount = []; // eslint-disable-line\n\n/**\n * Detect whether or not a text string represents a valid CSS property.  This check\n * includes an attempt at checking for vendor-prefixed versions of the CSS property\n * provided.\n * @private\n * @param {string} prop a possible CSS property\n * @returns {string|null} If the property exists, it will be returned in string format.\n *  If the property doesn't exist, a null result is returned.\n */\n$.fn.cssPropSupport = function (prop) {\n  if (!prop) {\n    return null;\n  }\n\n  const el = $('<div></div>')[0];\n  const propStr = prop.toString();\n  const prefixes = ['Moz', 'Webkit', 'O', 'ms'];\n  const capitalizedProp = propStr.charAt(0).toUpperCase() + propStr.substr(1);\n\n  if (prop in el.style) {\n    $(el).remove();\n    return prop;\n  }\n\n  for (let i = 0; i < prefixes.length; i++) {\n    const vendorProp = prefixes[i] + capitalizedProp;\n    if (vendorProp in el.style) {\n      $(el).remove();\n      return vendorProp;\n    }\n  }\n\n  $(el).remove();\n  return null;\n};\n\n/**\n * Returns the name of the TransitionEnd event.\n * @private\n * @returns {string} a (possibly) vendor-adjusted CSS transition property name.\n */\n$.fn.transitionEndName = function () {\n  const prop = $.fn.cssPropSupport('transition');\n  const eventNames = {\n    WebkitTransition: 'webkitTransitionEnd',\n    MozTransition: 'transitionend',\n    MSTransition: 'msTransitionEnd',\n    OTransition: 'oTransitionEnd',\n    transition: 'transitionend'\n  };\n\n  return eventNames[prop] || null;\n};\n\n/**\n * Checks to see if a provided element is visible based on its CSS `visibility` property.\n * @private\n * @param {HTMLElement} element the element being checked.\n * @returns {boolean} whether or not the element is visible.\n */\nfunction visible(element) {\n  return $.expr.filters.visible(element) &&\n    !$(element).parents().addBack().filter(function () { return $.css(this, 'visibility') === 'hidden'; }).length;\n}\n\n/**\n * From jQueryUI Core: https://github.com/jquery/jquery-ui/blob/24756a978a977d7abbef5e5bce403837a01d964f/ui/jquery.ui.core.js#L93\n * Adapted from:  http://stackoverflow.com/questions/7668525/is-there-a-jquery-selector-to-get-all-elements-that-can-get-focus\n * Adds the ':focusable' selector to Sizzle to allow for the selection of elements\n * that can currently be focused.\n * @private\n * @param {HTMLElement} element the element being checked\n * @returns {boolean} whether or not the element is focusable.\n */\nfunction focusable(element) {\n  let map;\n  let mapName;\n  let img;\n  const nodeName = element.nodeName.toLowerCase();\n  const isTabIndexNotNaN = !isNaN($.attr(element, 'tabindex'));\n\n  if (nodeName === 'area') {\n    map = element.parentNode;\n    mapName = map.name;\n    if (!element.href || !mapName || map.nodeName.toLowerCase() !== 'map') {\n      return false;\n    }\n    img = $(`img[usemap=#${mapName}]`)[0];\n    return !!img && visible(img);\n  }\n\n  // The element and all of its ancestors must be visible.\n  // Return out fast if this isn't the case.\n  if (!visible(element)) {\n    return false;\n  }\n\n  const match = /input|select|textarea|button|object/.test(nodeName);\n  if (match) {\n    return !element.disabled;\n  }\n  if (nodeName === 'a') {\n    return (element.href !== undefined || isTabIndexNotNaN);\n  }\n  return isTabIndexNotNaN;\n}\n\n// Adds a `:focusable` selector to jQuery's selector library.\n$.extend($.expr[':'], {\n  focusable(element) {\n    return focusable(element, !isNaN($.attr(element, 'tabindex')));\n  }\n});\n\n/**\n * Returns a key/value list of currently attached event listeners\n * @private\n * @returns {object} containing list of event names as keys, and event listener functions as values.\n */\n$.fn.listEvents = function () {\n  let data = {};\n\n  this.each(function () {\n    data = $._data(this, 'events'); // eslint-disable-line\n  });\n\n  return data;\n};\n\nconst utils = {};\n\n/**\n * Generates a unique ID for an element based on the element's configuration, any\n * Soho components that are generated against it, and provided prefixes/suffixes.\n * @private\n * @param {HTMLElement} element the element being used for uniqueId capture\n * @param {string} [className] CSS classname (will be interpreted automatically\n *  if it's not provided)\n * @param {string} [prefix] optional prefix\n * @param {string} [suffix] optional suffix\n * @returns {string} the compiled uniqueID\n */\nutils.uniqueId = function (element, className, prefix, suffix) {\n  const predefinedId = element.id;\n\n  if (predefinedId && $(`#${predefinedId}`).length < 2) {\n    return predefinedId;\n  }\n\n  prefix = (!prefix ? '' : `${prefix}-`);\n  suffix = (!suffix ? '' : `-${suffix}`);\n  className = (!className ? utils.getArrayFromList(element.classList).join('-') : className);\n\n  if (!uniqueIdCount[className]) {\n    uniqueIdCount[className] = 1;\n  }\n  const str = `${prefix}${className}-${uniqueIdCount[className]}${suffix}`;\n  uniqueIdCount[className] += 1;\n  return str;\n};\n\n/**\n * Grabs an attribute from an HTMLElement containing stringified JSON syntax,\n * and interprets it into options.\n * @private\n * @param {HTMLElement} element the element whose settings are being interpreted\n * @param {string} [attr] optional different attribute to parse for settings\n * @returns {object} a list of interpreted settings for this element\n */\nutils.parseSettings = function parseSettings(element, attr) {\n  let options = {};\n  if (!element ||\n    (!(element instanceof HTMLElement) && !(element instanceof $)) ||\n    (element instanceof $ && !element.length)) {\n    return options;\n  }\n\n  if (element instanceof $) {\n    element = element[0];\n  }\n\n  // Use `data-options` as a default.\n  attr = attr || 'data-options';\n\n  const str = element.getAttribute(attr);\n  if (!str || typeof str !== 'string' || str.indexOf('{') === -1) {\n    return options;\n  }\n\n  // replace single to double quotes, since single-quotes may be necessary\n  // due to entry in markup.\n  function replaceDoubleQuotes(changedStr) {\n    return changedStr.replace(/'/g, '\"');\n  }\n\n  // Manually parse a string more in-depth\n  function manualParse(changedStr) {\n    // get keys\n    let regex = /({|,)(?:\\s*)(?:')?([A-Za-z_$\\.][A-Za-z0-9_ \\-\\.$]*)(?:')?(?:\\s*):/g; // eslint-disable-line\n\n    // add double quotes to keys\n    changedStr = changedStr.replace(regex, '$1\\\"$2\\\":'); // eslint-disable-line\n\n    // get strings in values\n    regex = /:(?:\\s*)(?!(true|false|null|undefined))([A-Za-z_$\\.#][A-Za-z0-9_ \\-\\.$]*)/g; // eslint-disable-line\n\n    // add double quotes to strings in values\n    changedStr = changedStr.replace(regex, ':\\\"$2\\\"'); // eslint-disable-line\n    changedStr = replaceDoubleQuotes(changedStr);\n    return changedStr;\n  }\n\n  try {\n    options = JSON.parse(replaceDoubleQuotes(str));\n  } catch (err) {\n    options = JSON.parse(manualParse(str));\n  }\n\n  return options;\n};\n\n/**\n * Deprecate `utils.parseOptions` in favor of `utils.parseSettings`.\n * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n * @private\n * @deprecated as of v4.4.0. Please use `parseSettings()` instead.\n * @param {HTMLElement|jQuery[]} element the element whose options are being parsed\n * @param {string} [attr] an optional alternate attribute name to use when obtaining settings\n * @returns {Object|Object[]} an object representation of parsed settings.\n */\nutils.parseOptions = function parseOptions(element, attr) {\n  return utils.parseSettings(element, attr);\n};\n\n/**\n* jQuery Behavior Wrapper for `utils.parseOptions`.\n* @deprecated as of v4.4.0. This is no longer necessary to call directly and should be avoided.\n* @private\n* @param {HTMLElement|jQuery[]} element the element whose options are being parsed\n* @param {string} [attr] an optional alternate attribute name to use when obtaining settings\n* @returns {Object|Object[]} an object representation of parsed settings.\n*/\n$.fn.parseOptions = function (element, attr) {\n  const results = [];\n  const isCalledDirectly = (element instanceof HTMLElement ||\n    element instanceof SVGElement || element instanceof $);\n  let targets = this;\n\n  if (isCalledDirectly) {\n    targets = $(element);\n  } else {\n    attr = element;\n    element = undefined;\n  }\n\n  targets.each(function (i, item) {\n    results.push({\n      element: this,\n      options: utils.parseOptions(item, attr)\n    });\n  });\n\n  if (results.length === 1) {\n    return results[0].options;\n  }\n  return results;\n};\n\n/**\n * Performs the usual Boolean coercion with the exception of the strings \"false\"\n * (case insensitive) and \"0\"\n * @private\n * @param {boolean|string|number} b the value to be checked\n * @returns {boolean} whether or not the value passed coerces to true.\n */\nutils.coerceToBoolean = function (b) {\n  return !(/^(false|0)$/i).test(b) && !!b;\n};\n\n/**\n * Coerces all properties inside of a settings object to a boolean.\n * @param {Object} settings incoming settings\n * @param {String[]} [targetPropsArr=undefined] optional array of specific settings keys to target.\n *  If no keys are provided, all keys will be targeted.\n * @returns {Object} modified settings.\n */\nutils.coerceSettingsToBoolean = function (settings, targetPropsArr) {\n  if (!targetPropsArr || !Array.isArray(targetPropsArr)) {\n    Object.keys(settings).forEach((key) => {\n      targetPropsArr.push(key);\n    });\n  }\n\n  let i;\n  let l;\n  for (i = 0, l = targetPropsArr.length; i < l; i++) {\n    settings[targetPropsArr[i]] = utils.coerceToBoolean(settings[targetPropsArr[i]]);\n  }\n\n  return settings;\n};\n\n/**\n * Timer - can be used for play/pause or stop for given time.\n * Use as new instance [ var timer = new $.fn.timer(function() {}, 6000); ]\n * then can be listen events as:\n * [ $(timer.event).on('update', function(e, data){console.log(data.counter)}); ]\n * or can access as [ timer.cancel(); -or- timer.pause(); -or- timer.resume(); ]\n * @private\n * @param {function} [callback] method that will run on each timer update\n * @param {number} delay amount of time between timer ticks\n * @returns {object} containing methods that can be run on the timer\n */\n$.fn.timer = function (callback, delay) {\n  const self = $(this);\n  const speed = 10;\n  let interval;\n  let counter = 0;\n\n  function cancel() {\n    self.triggerHandler('cancel');\n    clearInterval(interval);\n    counter = 0;\n  }\n\n  function pause() {\n    self.triggerHandler('pause');\n    clearInterval(interval);\n  }\n\n  function update() {\n    interval = setInterval(function () {\n      counter += speed;\n      self.triggerHandler('update', [{ counter }]);\n      if (counter > delay) {\n        self.triggerHandler('timeout');\n        callback.apply(arguments); // eslint-disable-line\n        clearInterval(interval);\n        counter = 0;\n      }\n    }, speed);\n  }\n\n  function resume() {\n    self.triggerHandler('resume');\n    update();\n  }\n\n  update();\n\n  return {\n    event: this,\n    cancel,\n    pause,\n    resume\n  };\n};\n\n/**\n * Copies a string to the clipboard. Must be called from within an event handler such as click.\n * May return false if it failed, but this is not always\n * possible. Browser support for Chrome 43+, Firefox 42+, Edge and IE 10+.\n * No Safari support, as of (Nov. 2015). Returns false.\n * IE: The clipboard feature may be disabled by an adminstrator. By default a prompt is\n * shown the first time the clipboard is used (per session).\n * @private\n * @param {string} text incoming text content\n * @returns {string|boolean} copied text, or a false result if there was an error\n */\n$.copyToClipboard = function (text) { // eslint-disable-line\n  if (window.clipboardData && window.clipboardData.setData) {\n    // IE specific code path to prevent textarea being shown while dialog is visible.\n    return window.clipboardData.setData('Text', text);\n  } else if (document.queryCommandSupported && document.queryCommandSupported('copy')) {\n    const textarea = document.createElement('textarea');\n    textarea.textContent = text;\n    textarea.style.position = 'fixed'; // Prevent scrolling to bottom of page in MS Edge.\n    document.body.appendChild(textarea);\n    textarea.select();\n    try {\n      return document.execCommand('copy'); // Security exception may be thrown by some browsers.\n    } catch (ex) {\n      // console.warn('Copy to clipboard failed.', ex);\n      return false;\n    } finally {\n      document.body.removeChild(textarea);\n    }\n  }\n};\n\n/**\n * Clearable (Shows an X to clear)\n * @private\n */\n$.fn.clearable = function () {\n  const self = this;\n  this.element = $(this);\n\n  const COMPONENT_NAME = 'clearable';\n\n  // Create an X icon button styles in icons.scss\n  this.xButton = this.element.find('.icon.close').first();\n  if (!this.xButton || !this.xButton.length) {\n    this.xButton = $.createIconElement({ classes: 'close is-empty', icon: 'close' }).icon();\n  }\n\n  // Clears the contents of the base element\n  this.clear = function () {\n    self.element.val('').trigger('change').focus().trigger('cleared');\n    self.checkContents();\n  };\n\n  // Event listener for the xButton's `keydown` event\n  this.handleKeydown = function (e) {\n    const key = e.key;\n\n    if (key === 'Enter' || (e.altKey && (key === 'Delete' || key === 'Backspace'))) {\n      e.preventDefault();\n      self.clear();\n    }\n  };\n\n  // Checks the contents of the base element (presumably an input field) for empty\n  this.checkContents = function () {\n    const text = self.element.val();\n    if (!text || !text.length) {\n      this.xButton.addClass('is-empty');\n    } else {\n      this.xButton.removeClass('is-empty');\n    }\n\n    this.element.trigger('contents-checked');\n  };\n\n  // Add the button to field parent\n  this.xButton.insertAfter(self.element);\n  this.xButton[0].tabIndex = 0;\n  this.xButton[0].setAttribute('focusable', true);\n\n  // Handle Events\n  this.xButton\n    .off([\n      `click.${COMPONENT_NAME}`,\n      `keydown.${COMPONENT_NAME}`\n    ].join(' '))\n    .on('click.clearable', this.clear)\n    .on('keydown.clearable', this.handleKeydown);\n\n  const elemEvents = [\n    `blur.${COMPONENT_NAME}`,\n    `change.${COMPONENT_NAME}`,\n    `keyup.${COMPONENT_NAME}`\n  ].join(' ');\n\n  this.element\n    .off(elemEvents)\n    .on(elemEvents, () => {\n      self.checkContents();\n    });\n\n  // Set initial state\n  this.checkContents();\n};\n\n/**\n * Replacement for String.fromCharCode() that takes meta keys into account when determining which\n * @private\n * character key was pressed.\n * @param {jQuery.Event} e jQuery-wrapped `keypress` event\n * @returns {string} text tcharacter\n */\nutils.actualChar = function (e) {\n  let key = e.which;\n  let character = '';\n  const toAscii = {\n    188: '44',\n    // '109': '45', // changes \"m\" to \"-\" when using keypress\n    190: '46',\n    191: '47',\n    192: '96',\n    220: '92',\n    222: '39',\n    221: '93',\n    219: '91',\n    173: '45',\n    187: '61', // IE Key codes\n    186: '59', // IE Key codes\n    189: '45' // IE Key codes\n  };\n  const shiftUps = {\n    96: '~',\n    49: '!',\n    50: '@',\n    51: '#',\n    52: '$',\n    53: '%',\n    54: '^',\n    55: '&',\n    56: '*',\n    57: '(',\n    48: ')',\n    45: '_',\n    61: '+',\n    91: '{',\n    93: '}',\n    92: '|',\n    59: ':',\n    37: '%',\n    38: '&',\n    39: '\"',\n    44: '<',\n    46: '>',\n    47: '?'\n  };\n\n  // Normalize weird keycodes\n  if (Object.prototype.hasOwnProperty.call(toAscii, key)) {\n    key = toAscii[key];\n  }\n\n  // Handle Numpad keys\n  if (key >= 96 && key <= 105) {\n    key -= 48;\n  }\n\n  // Convert Keycode to Character String\n  if (!e.shiftKey && (key >= 65 && key <= 90)) {\n    character = String.fromCharCode(key + 32);\n  } else if (e.shiftKey &&\n    Object.prototype.hasOwnProperty.call(shiftUps, key)) { // User was pressing Shift + any key\n    character = shiftUps[key];\n  } else {\n    character = String.fromCharCode(key);\n  }\n\n  return character;\n};\n\n/**\n * Get the actualy typed key from the event.\n * @private\n * @param  {object} e The event to check for the key.\n * @returns {string} The actual key typed.\n */\n$.actualChar = function (e) {\n  return utils.actualChar(e);\n};\n\n/**\n * Equate two values quickly in a truthy fashion\n * @private\n * @param {any} a first value\n * @param {any} b second value\n * @returns {boolean} whether the two items compare in a truthy fashion.\n */\nutils.equals = function equals(a, b) {\n  return JSON.stringify(a) === JSON.stringify(b);\n};\n\n/**\n * Converts an element wrapped in a jQuery collection down to its original HTMLElement reference.\n * If an HTMLElement is passed in, simply returns it.\n * If anything besides HTMLElements or jQuery[] is passed in, returns undefined;\n * @private\n * @param {any} item the item being evaluated\n * @returns {HTMLElement|undefined} the unwrapped item, or nothing.\n */\nDOM.convertToHTMLElement = function convertToHTMLElement(item) {\n  if (item instanceof HTMLElement) {\n    return item;\n  }\n\n  if (item instanceof $) {\n    if (item.length) {\n      item = item[0];\n    } else {\n      item = undefined;\n    }\n    return item;\n  }\n\n  return undefined;\n};\n\n/**\n * Object deep copy.\n * For now, alias jQuery.extend\n * Eventually we'll replace this with a non-jQuery extend method.\n * @private\n */\nutils.extend = $.extend;\n\n/**\n * Hack for IE11 and SVGs that get moved around/appended at inconvenient times.\n * The action of changing the xlink:href attribute to something else and back will fix the problem.\n * @private\n * @param {HTMLElement} rootElement the base element\n * @returns {void}\n */\nutils.fixSVGIcons = function fixSVGIcons(rootElement) {\n  if (env.browser.name !== 'ie' && env.browser.version !== '11') {\n    return;\n  }\n\n  if (rootElement === undefined) {\n    return;\n  }\n\n  const xlinkNS = 'http://www.w3.org/1999/xlink';\n\n  // Handle jQuery\n  if (rootElement instanceof $) {\n    if (!rootElement.length) {\n      return;\n    }\n\n    if (rootElement.length === 1) {\n      rootElement = rootElement[0];\n    } else {\n      rootElement.each((i, elem) => {\n        fixSVGIcons(elem);\n      });\n      return;\n    }\n  }\n\n  // Handle NodeList in an IE-friendly way\n  // https://developer.mozilla.org/en-US/docs/Web/API/NodeList#Example\n  if (rootElement instanceof NodeList) {\n    Array.prototype.forEach.call(rootElement, (elem) => {\n      fixSVGIcons(elem);\n    });\n    return;\n  }\n\n  setTimeout(() => {\n    const uses = rootElement.getElementsByTagName('use');\n    for (let i = 0; i < uses.length; i++) {\n      const attr = uses[i].getAttributeNS(xlinkNS, 'href');\n      uses[i].setAttributeNS(xlinkNS, 'href', 'x');\n      uses[i].setAttributeNS(xlinkNS, 'href', attr);\n    }\n  }, 1);\n};\n\n/**\n * Gets the current size of the viewport\n * @private\n * @returns {object} width/height of the viewport\n */\nutils.getViewportSize = function getViewportSize() {\n  return {\n    width: Math.max(document.documentElement.clientWidth, window.innerWidth || 0),\n    height: Math.max(document.documentElement.clientHeight, window.innerHeight || 0)\n  };\n};\n\n/**\n * Gets the various scrollable containers that an element is nested inside of, and returns\n *  their scrollHeight and scrollLeft values.\n * @private\n * @param {HTMLElement} element the base element to check for containment\n * @returns {object} containing references to the container element and its top/left\n */\nutils.getContainerScrollDistance = function getContainerScrollDistance(element) {\n  if (!DOM.isElement(element)) {\n    return [];\n  }\n\n  const containers = [];\n  const scrollableElements = [\n    '.scrollable', '.scrollable-x', '.scrollable-y', '.modal',\n    '.card-content', '.widget-content', '.tab-panel',\n    '.datagrid-content'\n  ];\n\n  $(element).parents(scrollableElements.join(', ')).each(function () {\n    const el = this;\n\n    containers.push({\n      element: el,\n      left: el.scrollLeft,\n      top: el.scrollTop\n    });\n  });\n\n  // Push the body's scroll area if it's not a \"no-scroll\" area\n  if (!document.body.classList.contains('no-scroll')) {\n    containers.push({\n      element: document.body,\n      left: document.body.scrollLeft,\n      top: document.body.scrollTop\n    });\n  }\n\n  return containers;\n};\n\n/**\n * Takes an element that is currently hidden by some means (FX: \"display: none;\")\n *  and gets its potential dimensions by checking a clone of the element that is NOT hidden.\n * @private\n * @param {HTMLElement|SVGElement|jQuery[]} el The element being manipulated.\n * @param {object} options incoming options.\n * @param {jQuery[]} [parentElement] the parent element where a clone of this\n *  hidden element will be attached.\n * @returns {object} containing various width/height properties of the element provided.\n */\nutils.getHiddenSize = function getHiddenSize(el, options) {\n  const defaults = {\n    dims: { width: 0, height: 0, innerWidth: 0, innerHeight: 0, outerWidth: 0, outerHeight: 0 },\n    parentElement: undefined,\n    includeMargin: false\n  };\n\n  if (!DOM.isElement(el)) {\n    return defaults.dims;\n  }\n\n  el = $(el);\n  options = $.extend({}, defaults, options);\n\n  // element becomes clone and appended to a parentElement, if defined\n  const hasDefinedParentElement = DOM.isElement(options.parentElement);\n  if (hasDefinedParentElement) {\n    el = el.clone().appendTo(options.parentElement);\n  }\n\n  const dims = options.dims;\n  const hiddenParents = el.parents().add(el);\n  const props = {\n    transition: 'none',\n    webkitTransition: 'none',\n    mozTransition: 'none',\n    msTransition: 'none',\n    visibility: 'hidden',\n    display: 'block',\n  };\n  const oldProps = [];\n\n  hiddenParents.each(function () {\n    const old = {};\n    const propTypes = Object.keys(props);\n    propTypes.forEach((name) => {\n      if (this.style[name]) {\n        old[name] = this.style[name];\n        this.style[name] = props[name];\n      }\n    });\n\n    oldProps.push(old);\n  });\n\n  dims.padding = {\n    bottom: el.css('padding-bottom'),\n    left: el.css('padding-left'),\n    right: el.css('padding-right'),\n    top: el.css('padding-top')\n  };\n  dims.width = el.width();\n  dims.outerWidth = el.outerWidth(options.includeMargin);\n  dims.innerWidth = el.innerWidth();\n  dims.scrollWidth = el[0].scrollWidth;\n  dims.height = el.height();\n  dims.innerHeight = el.innerHeight();\n  dims.outerHeight = el.outerHeight(options.includeMargin);\n  dims.scrollHeight = el[0].scrollHeight;\n\n  hiddenParents.each(function (i) {\n    const old = oldProps[i];\n    const propTypes = Object.keys(props);\n    propTypes.forEach((name) => {\n      if (old[name]) {\n        this.style[name] = old[name];\n      }\n    });\n  });\n\n  // element is ONLY removed when a parentElement is defined because it was cloned.\n  if (hasDefinedParentElement) {\n    el.remove();\n  }\n\n  return dims;\n};\n\n/**\n * Binds the Soho Util _getHiddenSize()_ to a jQuery selector\n * @private\n * @param {object} options - incoming options\n * @returns {object} hidden size\n */\n$.fn.getHiddenSize = function (options) {\n  return utils.getHiddenSize(this, options);\n};\n\n/**\n * Checks if a specific input is a String\n * @private\n * @param {any} value an object of unknown type to check\n * @returns {boolean} whether or not a specific input is a String\n */\nutils.isString = function isString(value) {\n  return typeof value === 'string' || value instanceof String;\n};\n\n/**\n * Checks if a specific input is a Number\n * @private\n * @param {any} value an object of unknown type to check\n * @returns {boolean} whether or not a specific input is a Number\n */\nutils.isNumber = function isNumber(value) {\n  return typeof value === 'number' && value.length === undefined && !isNaN(value);\n};\n\n/**\n * Safely changes the position of a text caret inside of an editable element.\n * In most cases, will call \"setSelectionRange\" on an editable element immediately, but in some\n * cases, will be deferred with `requestAnimationFrame` or `setTimeout`.\n * @private\n * @param {HTMLElement} element the element to get selection\n * @param {number} startPos starting position of the text caret\n * @param {number} endPos ending position of the text caret\n */\nutils.safeSetSelection = function safeSetSelection(element, startPos, endPos) {\n  if (startPos && endPos === undefined) {\n    endPos = startPos;\n  }\n\n  if (document.activeElement === element) {\n    if (env.os.name === 'android') {\n      defer(() => {\n        element.setSelectionRange(startPos, endPos, 'none');\n      }, 0);\n    } else {\n      element.setSelectionRange(startPos, endPos, 'none');\n    }\n  }\n};\n\n/**\n * Checks to see if a variable is valid for containing Soho component options.\n * @private\n * @param {object|function} o an object or function\n * @returns {boolean} whether or not the object type is valid\n */\nfunction isValidOptions(o) {\n  return (typeof o === 'object' || typeof o === 'function');\n}\n\n/**\n * In some cases, functions are passed to component constructors as the settings argument.\n * This method runs the settings function if it's present and returns the resulting object.\n * @private\n * @param {object|function} o represents settings\n * @returns {object} processed settings\n */\nfunction resolveFunctionBasedSettings(o) {\n  if (typeof o === 'function') {\n    return o();\n  }\n  return o;\n}\n\n/**\n * Merges various sets of options into a single object,\n * whose intention is to be set as options on a Soho component.\n * @private\n * @param {HTMLElement|SVGElement|jQuery[]} [element] the element to process for inline-settings\n * @param {Object|function} incomingOptions desired settings\n * @param {Object|function} [defaultOptions] optional base settings\n * @returns {object} processed settings\n */\nutils.mergeSettings = function mergeSettings(element, incomingOptions, defaultOptions) {\n  if (!incomingOptions || !isValidOptions(incomingOptions)) {\n    if (isValidOptions(defaultOptions)) {\n      incomingOptions = defaultOptions;\n    } else {\n      incomingOptions = {};\n    }\n  }\n\n  // Actually get ready to merge incoming options if we get to this point.\n  return utils.extend(\n    true, {},\n    resolveFunctionBasedSettings(defaultOptions || {}),\n    resolveFunctionBasedSettings(incomingOptions),\n    (element !== undefined ? utils.parseSettings(element) : {})\n  ); // possible to run this without an element present -- will simply skip this part\n};\n\n/**\n * Test if a string is Html or not\n * @private\n * @param  {string} string The string to test.\n * @returns {boolean} True if it is html.\n */\nutils.isHTML = function (string) {\n  return /(<([^>]+)>)/i.test(string);\n};\n\nconst math = {};\n\n/**\n * Convert `setTimeout/Interval` delay values (CPU ticks) into frames-per-second\n * (FPS) numeric values.\n * @private\n * @param {number} delay CPU Ticks\n * @returns {number} Frames Per Second\n */\nmath.convertDelayToFPS = function convertDelayToFPS(delay) {\n  if (isNaN(delay)) {\n    throw new Error('provided delay value is not a number');\n  }\n  return delay / 16.7;\n};\n\n/**\n * Convert `setTimeout/Interval` delay values (CPU ticks) into frames-per-second\n * (FPS) numeric values.\n * @private\n * @param {number} fps (Frames Per Second)\n * @returns {number} delay in CPU ticks\n */\nmath.convertFPSToDelay = function convertFPSToDelay(fps) {\n  if (isNaN(fps)) {\n    throw new Error('provided delay value is not a number');\n  }\n  return fps * 16.7;\n};\n\n/**\n *  Determines whether the passed value is a finite number.\n * @private\n * @param {number} value The number\n * @returns {boolean} If it is finite or not.\n */\nmath.isFinite = function isFinite(value) {\n  // 1. If Type(number) is not Number, return false.\n  if (typeof value !== 'number') {\n    return false;\n  }\n  // 2. If number is NaN, +, or , return false.\n  if (value !== value || value === Infinity || value === -Infinity) { //eslint-disable-line\n    return false;\n  }\n  // 3. Otherwise, return true.\n  return true;\n};\n\n/**\n * `Array.ForEach()`-style method that is also friendly to `NodeList` types.\n * @param {Array|NodeList} array incoming items\n * @param {function} callback the method to run\n * @param {object} scope the context in which to run the method\n */\nutils.forEach = function forEach(array, callback, scope) {\n  for (let i = 0; i < array.length; i++) {\n    callback.call(scope, array[i], i, array); // passes back stuff we need\n  }\n};\n\n/**\n * Function to check if element has css class\n * @private\n * @param {object} elem The DOM element\n * @param {string} classStr The css class name to check\n * @returns {boolean} true if found given css class\n */\nutils.hasClass = function hasClass(elem, classStr) {\n  let r = false;\n  if (elem) {\n    if ('classList' in elem) {\n      r = elem.classList.contains(classStr);\n    } else {\n      const classAttr = elem.getAttribute('class');\n      r = classAttr ? classAttr.split(/\\s+/).indexOf(classStr) !== -1 : false;\n    }\n  }\n  return r;\n};\n\n/**\n * Returns the sign of a number, indicating whether the number is positive, negative or zero\n * @param {number} x A number.\n * @returns {number} A number representing the sign of the given argument. If the argument is a positive number, negative number, positive zero or negative zero, the function will return 1, -1, 0 or -0 respectively. Otherwise, NaN is returned.\n */\nmath.sign = function (x) {\n  if (Math.sign) {\n    return Math.sign(x);\n  }\n\n  x = +x;\n  if (x === 0 || isNaN(x)) {\n    return x;\n  }\n  return x > 0 ? 1 : -1;\n};\n\n/**\n * Convenience method for using `Array.prototype.slice()` on an Array-like object (or an actual array)\n * to make a copy.\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice#Array-like_objects\n * @param {Array|NodeList} listObj an array-like object\n * @returns {array} containing the list in array format.\n */\nutils.getArrayFromList = function (listObj) {\n  const unboundSlice = Array.prototype.slice;\n  return Function.prototype.call.bind(unboundSlice)(listObj);\n};\n\n/**\n * Gets the OS scollbar width in pixels.\n * @returns {number} The width as a number.\n */\nutils.getScrollbarWidth = function () {\n  const outer = document.createElement('div');\n  outer.style.visibility = 'hidden';\n  outer.style.width = '100px';\n  document.body.appendChild(outer);\n\n  const widthNoScroll = outer.offsetWidth;\n  outer.style.overflow = 'scroll';\n\n  const inner = document.createElement('div');\n  inner.style.width = '100%';\n  outer.appendChild(inner);\n\n  const widthWithScroll = inner.offsetWidth;\n  outer.parentNode.removeChild(outer);\n\n  return widthNoScroll - widthWithScroll;\n};\n\nexport { utils, math };\n","const stringUtils = {};\n\n/**\n * Re-usable Empty String that can be referenced everywhere to save small amounts of space.\n */\nstringUtils.EMPTY = '';\n\n/**\n* The splice() method changes the content of a string by removing a range of\n* characters and/or adding new characters.\n*\n* @param {string} str The string that will be manipulated.\n* @param {number} start Index at which to start changing the string.\n* @param {number} delCount An integer indicating the number of old chars to remove.\n* @param {string} newSubStr The String that is spliced in.\n* @returns {string} A new string with the spliced substring.\n*/\nstringUtils.splice = function splice(str, start, delCount, newSubStr) {\n  return str.slice(0, start) + newSubStr + str.slice(start + Math.abs(delCount));\n};\n\n/**\n * Takes a string with possible duplicate characters and returns a string\n * containing ALL unique characters.  Useful for construction of REGEX objects\n * with characters from an input field, etc.\n * @param {string} str The string to process\n * @returns {string} The processed string\n */\nstringUtils.removeDuplicates = function removeDuplicates(str) {\n  return str\n    .split('')\n    .filter(function(item, pos, self) { //eslint-disable-line\n      return self.indexOf(item) === pos;\n    })\n    .join('');\n};\n\n/**\n * Takes a string and uses a regex test to detect the presence of HTML elements.\n * @param {string} str The string to search\n * @returns {boolean} True if the string is contained.\n */\nstringUtils.containsHTML = function containsHTML(str) {\n  return /<[a-z][\\s\\S]*>/i.test(str);\n};\n\n/**\n * Takes a string containing HTML and strips it of extraneous white space.\n * @param {string} str The string to parse\n * @returns {string} The string minus extraneous white space.\n */\nstringUtils.stripWhitespace = function stripWhitespace(str) {\n  return str.replace(/\\n/g, '')\n    .replace(/[\\t ]+</g, '<')\n    .replace(/>[\\t ]+</g, '><')\n    .replace(/>[\\t ]+$/g, '>');\n};\n\n/**\n * Capitalizes the first letter of a string\n * @param {string} str the incoming text\n * @returns {string} the modified text\n */\nstringUtils.capitalize = function capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n};\n\n/**\n * [capitalize description]\n * @param  {string} val A text string (\"true\" or \"false\") that can be converted to a boolean.\n * @returns {boolean} true or false\n */\nstringUtils.toBoolean = function capitalize(val) {\n  const num = +val;\n  return !isNaN(num) ? !!num : !!String(val).toLowerCase().replace(!!0, '');\n};\n\n/**\n * Return the width in pixels, assuming fontsize 14 as a default\n * @param  {string} text A text string to measure.\n * @param  {string} fontsize The elements font size (defaults to 14)\n * @returns {number} The text width.\n */\nstringUtils.textWidth = function capitalize(text, fontsize = 14) {\n  this.canvas = this.canvas || (this.canvas = document.createElement('canvas'));\n  const context = this.canvas.getContext('2d');\n  context.font = `${fontsize}px arial`;\n\n  const metrics = context.measureText(text);\n  return Math.round(metrics.width);\n};\n\n/**\n * Pad a date into a string with zeros added.\n * @private\n * @param {number} year The year to use.\n * @param {number} month The month to use.\n * @param {number} day The day to use.\n * @returns {void}\n */\nstringUtils.padDate = function padDate(year, month, day) {\n  return year + `0${month + 1}`.slice(-2) + `0${day}`.slice(-2);\n};\n\n/**\n * Calculate the width for given text string.\n * @private\n * @param {string} text string to process\n * @param {number} padding value for left + right\n * @param {string} font size and family used with the given text string\n * @returns {number} calculated width\n */\nstringUtils.textWidth = function textWidth(text, padding, font) {\n  this.canvasTW = this.canvasTW || (this.canvasTW = document.createElement('canvas'));\n  const context = this.canvasTW.getContext('2d');\n  context.font = font || '14px arial';\n\n  const metrics = context.measureText(text);\n  return Math.round(metrics.width + (padding || 0));\n};\n\n/**\n * Escape  user input to be treated as literal string with regular expressions\n * @private\n * @param {string} s string to process.\n * @returns {string} string after escaping.\n */\nstringUtils.escapeRegExp = function escapeRegExp(s) {\n  return s.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& whole matched string\n};\n\nexport { stringUtils }; //eslint-disable-line\n","/* eslint-disable no-nested-ternary, no-useless-escape */\nimport { Environment as env } from '../../utils/environment';\n\n// If `SohoConfig` exists with a `culturesPath` property, use that path for retrieving\n// culture files. This allows manually setting the directory for the culture files.\nlet existingCulturePath = '';\nif (typeof window.SohoConfig === 'object' && typeof window.SohoConfig.culturesPath === 'string') {\n  existingCulturePath = window.SohoConfig.culturesPath;\n}\n\n/**\n* The Locale component handles i18n\n* Data From: http://www.unicode.org/repos/cldr-aux/json/22.1/main/\n* For Docs See: http://ibm.co/1nXyNxp\n* @class Locale\n* @constructor\n*\n* @param {string} currentLocale  The Currently Set Locale\n* @param {object} cultures  Contains all currently-stored cultures.\n* @param {string} culturesPath  the web-server's path to culture files.\n*/\nconst Locale = {  // eslint-disable-line\n\n  currentLocale: { name: '', data: {} }, // default\n  currentLanguage: { name: '' }, // default\n  cultures: {},\n  languages: {},\n  culturesPath: existingCulturePath,\n  defaultLocales: [\n    { lang: 'af', default: 'af-ZA' },\n    { lang: 'ar', default: 'ar-EG' },\n    { lang: 'bg', default: 'bg-BG' },\n    { lang: 'cs', default: 'cs-CZ' },\n    { lang: 'da', default: 'da-DK' },\n    { lang: 'de', default: 'de-DE' },\n    { lang: 'el', default: 'el-GR' },\n    { lang: 'en', default: 'en-US' },\n    { lang: 'es', default: 'es-ES' },\n    { lang: 'et', default: 'et-ET' },\n    { lang: 'fi', default: 'fi-FI' },\n    { lang: 'fr', default: 'fr-FR' },\n    { lang: 'he', default: 'he-IL' },\n    { lang: 'hi', default: 'hi-IN' },\n    { lang: 'hr', default: 'hr-HR' },\n    { lang: 'hu', default: 'hu-HU' },\n    { lang: 'id', default: 'id-ID' },\n    { lang: 'it', default: 'it-IT' },\n    { lang: 'iw', default: 'he-IL' },\n    { lang: 'ja', default: 'ja-JP' },\n    { lang: 'ko', default: 'ko-KR' },\n    { lang: 'lt', default: 'lt-LT' },\n    { lang: 'lv', default: 'lv-LV' },\n    { lang: 'ms', default: 'ms-bn' },\n    { lang: 'nb', default: 'nb-NO' },\n    { lang: 'nl', default: 'nl-NL' },\n    { lang: 'no', default: 'no-NO' },\n    { lang: 'pl', default: 'pl-PL' },\n    { lang: 'pt', default: 'pt-PT' },\n    { lang: 'ro', default: 'ro-RO' },\n    { lang: 'ru', default: 'ru-RU' },\n    { lang: 'sk', default: 'sk-SK' },\n    { lang: 'sl', default: 'sl-SI' },\n    { lang: 'sv', default: 'sv-SE' },\n    { lang: 'th', default: 'th-TH' },\n    { lang: 'tr', default: 'tr-TR' },\n    { lang: 'uk', default: 'uk-UA' },\n    { lang: 'vi', default: 'vi-VN' },\n    { lang: 'zh', default: 'zh-CN' }\n  ],\n  supportedLocales: ['af-ZA', 'ar-EG', 'ar-SA', 'bg-BG', 'cs-CZ', 'da-DK', 'de-DE', 'el-GR',\n    'en-AU', 'en-GB', 'en-IN', 'en-NZ', 'en-US', 'en-ZA', 'es-AR', 'es-ES', 'es-MX',\n    'es-US', 'et-EE', 'fi-FI', 'fr-CA', 'fr-FR', 'he-IL', 'hi-IN', 'hr-HR',\n    'hu-HU', 'id-ID', 'it-IT', 'ja-JP', 'ko-KR', 'lt-LT', 'lv-LV', 'ms-bn', 'ms-my', 'nb-NO',\n    'nl-NL', 'no-NO', 'pl-PL', 'pt-BR', 'pt-PT', 'ro-RO', 'ru-RU', 'sk-SK', 'sl-SI', 'sv-SE', 'th-TH', 'tr-TR',\n    'uk-UA', 'vi-VN', 'zh-CN', 'zh-Hans', 'zh-Hant', 'zh-TW'],\n  defaultLocale: 'en-US',\n\n  /**\n   * Sets the current language in the Html Header\n   * @private\n   * @param  {string} lang The two digit language code.\n   */\n  updateLanguage(lang) {\n    const html = $('html');\n\n    html.attr('lang', lang);\n    if (this.isRTL()) {\n      html.attr('dir', 'rtl');\n    } else {\n      html.removeAttr('dir');\n    }\n\n    // ICONS: Right to Left Direction\n    if (this.isRTL()) {\n      Locale.flipIconsHorizontally();\n    }\n    $('body').removeClass('busy-loading-locale');\n  },\n\n  /**\n   * Get the path to the directory with the cultures\n   * @private\n   * @returns {string} path containing culture files.\n   */\n  getCulturesPath() {\n    if (!this.culturesPath) {\n      const scripts = document.getElementsByTagName('script');\n      const partialPathMin = 'sohoxi.min.js';\n      const partialPath = 'sohoxi.js';\n\n      for (let i = 0; i < scripts.length; i++) {\n        let src = scripts[i].src;\n\n        // remove from ? to end\n        const idx = src.indexOf('?');\n        if (src !== '' && idx > -1) {\n          src = src.substr(0, idx);\n        }\n\n        if (scripts[i].id === 'sohoxi-script') {\n          return `${src.substring(0, src.lastIndexOf('/'))}/`;\n        }\n\n        if (src.indexOf(partialPathMin) > -1) {\n          this.culturesPath = `${src.replace(partialPathMin, '')}cultures/`;\n        }\n        if (src.indexOf(partialPath) > -1) {\n          this.culturesPath = `${src.replace(partialPath, '')}cultures/`;\n        }\n      }\n    }\n    return this.culturesPath;\n  },\n\n  /**\n   * Checks if the culture is set as an inline script in the head tag.\n   * @private\n   * @returns {boolean} whether or not a culture file exists in the document header.\n   */\n  cultureInHead() {\n    let isThere = false;\n    const scripts = document.getElementsByTagName('script');\n    const partialPath = 'cultures';\n\n    for (let i = 0; i < scripts.length; i++) {\n      const src = scripts[i].src;\n\n      if (src.indexOf(partialPath) > -1) {\n        isThere = true;\n      }\n    }\n\n    return isThere;\n  },\n\n  /**\n   * Internally stores a new culture file for future use.\n   * @private\n   * @param {string} locale The locale to check.\n   * @returns {string} The actual locale to use.\n   */\n  correctLocale(locale) {\n    // Map incorrect java locale to correct locale\n    if (locale === 'in-ID') {\n      locale = 'id-ID';\n    }\n    if (locale.substr(0, 2) === 'iw') {\n      locale = 'he-IL';\n    }\n\n    const lang = locale.split('-')[0];\n    if (this.supportedLocales.indexOf(locale) === -1) {\n      locale = this.defaultLocales.filter(a => a.lang === lang);\n\n      if (locale && locale[0]) {\n        return locale[0].default;\n      }\n\n      locale = this.defaultLocale;\n    }\n\n    return locale;\n  },\n\n  /**\n   * Check if the language is supported, if not return 'en'.\n   * @private\n   * @param {string} lang The locale to check.\n   * @returns {string} The actual lang to use.\n   */\n  correctLanguage(lang) {\n    let correctLanguage = this.defaultLocales.filter(a => a.lang === lang);\n\n    if (correctLanguage && correctLanguage[0]) {\n      return lang;\n    }\n\n    // Map incorrect java locale to correct locale\n    if (lang === 'in') {\n      correctLanguage = 'id';\n    }\n    if (lang === 'iw') {\n      correctLanguage = 'he';\n    }\n\n    correctLanguage = this.defaultLocale.substr(0, 2);\n    return correctLanguage;\n  },\n\n  /**\n   * Internally stores a new culture file for future use.\n   * @private\n   * @param {string} locale The 4-character Locale ID\n   * @param {object} data Translation data and locale-specific functions, such as calendars.\n   * @param {object} langData Translation data if deperated.\n   * @returns {void}\n   */\n  addCulture(locale, data, langData) {\n    const lang = locale.substr(0, 2);\n\n    this.cultures[locale] = data;\n    this.cultures[locale].name = locale;\n    this.languages[lang] = {\n      name: lang,\n      direction: data.direction || (langData ? langData.direction : ''),\n      nativeName: data.nativeName || (langData ? langData.nativeName : ''),\n      messages: data.messages || (langData ? langData.messages : {})\n    };\n    if (!langData) {\n      delete this.cultures[locale].messages;\n    }\n  },\n\n  /**\n   * Append the local script to the page.\n   * @private\n   * @param {string} locale The locale name to append.\n   * @param {boolean} isCurrent If we should set this as the current locale\n   * @param {boolean} useLocale If we should resolve the promise base on locale\n   * @returns {void}\n   */\n  appendLocaleScript(locale, isCurrent, useLocale) {\n    const script = document.createElement('script');\n    script.src = `${this.getCulturesPath() + locale}.js`;\n\n    script.onload = () => {\n      if (isCurrent) {\n        this.setCurrentLocale(locale, this.cultures[locale]);\n        this.dff.resolve(locale);\n      }\n      if (useLocale) {\n        this.dff[locale].resolve(locale);\n      }\n    };\n\n    script.onerror = () => {\n      this.dff.reject();\n    };\n\n    if (typeof window.SohoConfig === 'object' && typeof window.SohoConfig.nonce === 'string') {\n      script.setAttribute('nonce', window.SohoConfig.nonce);\n    }\n\n    document.head.appendChild(script);\n  },\n\n  /**\n   * Sets the current locale.\n   * @param {string} locale The locale to fetch and set.\n   * @returns {jquery.deferred} which is resolved once the locale culture is retrieved and set\n   */\n  set(locale) {\n    const self = this;\n    this.dff = $.Deferred();\n    locale = this.correctLocale(locale);\n\n    if (locale === '') {\n      self.dff.resolve();\n      return this.dff.promise();\n    }\n\n    if (locale && locale !== 'en-US' && !this.cultures['en-US']) {\n      this.appendLocaleScript('en-US', false);\n    }\n\n    if (locale && !this.cultures[locale] && this.currentLocale.name !== locale) {\n      this.setCurrentLocale(locale);\n      // Fetch the local and cache it\n      this.appendLocaleScript(locale, true);\n    }\n\n    if (locale && self.currentLocale.data && self.currentLocale.dataName === locale) {\n      self.dff.resolve(self.currentLocale.name);\n    }\n\n    self.setCurrentLocale(locale, self.cultures[locale]);\n\n    if (self.cultures[locale] && this.cultureInHead()) {\n      self.dff.resolve(self.currentLocale.name);\n    }\n\n    return this.dff.promise();\n  },\n\n  /**\n   * Loads the locale without setting it.\n   * @param {string} locale The locale to fetch and set.\n   * @returns {jquery.deferred} which is resolved once the locale culture is retrieved and set\n   */\n  getLocale(locale) {\n    const self = this;\n    this.dff = this.dff || $.Deferred();\n    this.dff[locale] = $.Deferred();\n    locale = this.correctLocale(locale);\n\n    if (locale === '') {\n      const dff = $.Deferred();\n      dff.resolve();\n      return dff.promise();\n    }\n\n    if (locale && locale !== 'en-US' && !this.cultures['en-US']) {\n      this.appendLocaleScript('en-US', false, true);\n    }\n\n    if (locale && !this.cultures[locale] && this.currentLocale.name !== locale) {\n      this.appendLocaleScript(locale, false, true);\n    }\n\n    if (locale && self.currentLocale.data && self.currentLocale.dataName === locale) {\n      this.dff[locale].resolve(locale);\n    }\n    if (self.cultures[locale] && this.cultureInHead()) {\n      this.dff[locale].resolve(locale);\n    }\n\n    return this.dff[locale].promise();\n  },\n\n  /**\n   * Sets the current language, this can be independent and different from the current locale.\n   * @param {string} lang The two digit language code to use.\n   * @returns {jquery.deferred} which is resolved once the locale culture is retrieved and set\n   */\n  setLanguage(lang) {\n    // If not call set and load it and then set back the locale after.\n    // Make a new object for currentLanguage independent of currentLocale\n    // Change translate to use the right one\n    const currentLocale = this.currentLocale.name;\n\n    // Map incorrect java locale to correct locale\n    lang = this.correctLanguage(lang);\n\n    // Ensure the language / culture is loaded.\n    if (!this.languages[lang]) {\n      this.set(lang).done(() => {\n        this.set(currentLocale);\n        this.setLanguage(lang);\n      });\n    }\n\n    if (this.languages[lang]) {\n      this.currentLanguage = this.languages[lang];\n      this.updateLanguage(lang);\n    } else {\n      this.currentLanguage.name = lang;\n    }\n    return this.dff;\n  },\n\n  /**\n   * Chooses a stored locale dataset and sets it as \"current\"\n   * @private\n   * @param {string} name the 4-character Locale ID\n   * @param {object} data translation data and locale-specific functions, such as calendars.\n   * @returns {void}\n   */\n  setCurrentLocale(name, data) {\n    const lang = name.substr(0, 2);\n    this.currentLocale.name = name;\n\n    if (data) {\n      this.currentLocale.data = data;\n      this.currentLocale.dataName = name;\n      this.currentLanguage = this.languages[lang];\n      this.updateLanguage(lang);\n    }\n  },\n\n  /**\n  * Formats a date object and returns it parsed back using the current locale or settings.\n  * The symbols for date formatting use the CLDR at https://bit.ly/2Jg0a6m\n  * @param {date} value The date to show in the current locale.\n  * @param {object} options Additional date formatting settings.\n  * @returns {string} the formatted date.\n  */\n  formatDate(value, options) {\n    if (!options) {\n      options = { date: 'short' }; // can be date, time, datetime or pattern\n    }\n    const localeData = this.useLocale(options);\n\n    if (!value) {\n      return undefined;\n    }\n\n    if (value === '0000' || value === '000000' || value === '00000000') {\n      // Means no date in some applications\n      return '';\n    }\n\n    // Convert if a timezone string.\n    if (!(value instanceof Date) && typeof value === 'string' && value.indexOf('Z') > -1) {\n      const tDate1 = new Date(value);\n      value = tDate1;\n    }\n\n    if (!(value instanceof Date) && typeof value === 'string' && value.indexOf('T') > -1) {\n      const tDate1 = new Date(value);\n      value = tDate1;\n    }\n\n    // Convert if a string..\n    if (!(value instanceof Date) && typeof value === 'string') {\n      let tDate2 = Locale.parseDate(value, options);\n      if (isNaN(tDate2) && options.date === 'datetime' &&\n        value.substr(4, 1) === '-' &&\n        value.substr(7, 1) === '-') {\n        tDate2 = new Date(\n          value.substr(0, 4),\n          value.substr(5, 2) - 1,\n          value.substr(8, 2),\n          value.substr(11, 2),\n          value.substr(14, 2),\n          value.substr(17, 2)\n        );\n      }\n      value = tDate2;\n    }\n\n    if (!(value instanceof Date) && typeof value === 'number') {\n      const tDate3 = new Date(value);\n      value = tDate3;\n    }\n\n    if (!value) {\n      return undefined;\n    }\n\n    let pattern;\n    let ret = '';\n    const cal = (localeData.calendars ? localeData.calendars[0] : null);\n\n    if (options.pattern) {\n      pattern = options.pattern;\n    }\n\n    if (options.date) {\n      pattern = cal.dateFormat[options.date];\n    }\n\n    if (!pattern) {\n      pattern = cal.dateFormat.short;\n    }\n\n    let year = (value instanceof Array ? value[0] : value.getFullYear());\n    let month = (value instanceof Array ? value[1] : value.getMonth());\n    let day = (value instanceof Array ? value[2] : value.getDate());\n    const dayOfWeek = (value.getDay ? value.getDay() : '');\n    const hours = (value instanceof Array ? value[3] : value.getHours());\n    const mins = (value instanceof Array ? value[4] : value.getMinutes());\n    const seconds = (value instanceof Array ? value[5] : value.getSeconds());\n    const millis = (value instanceof Array ? value[6] : value.getMilliseconds());\n\n    if (cal && cal.conversions) {\n      if (options.fromGregorian) {\n        const islamicParts = cal.conversions.fromGregorian(value);\n        day = islamicParts[2];\n        month = islamicParts[1];\n        year = islamicParts[0];\n      } else if (options.toGregorian) {\n        const gregorianDate = cal.conversions.toGregorian(year, month, day);\n        day = gregorianDate.getDate();\n        month = gregorianDate.getMonth();\n        year = gregorianDate.getFullYear();\n      }\n    }\n\n    // Special\n    pattern = pattern.replace('de', 'nnnnn');\n    pattern = pattern.replace('ngy', 'nnnn');\n    pattern = pattern.replace('thng', 't1ng');\n    pattern = pattern.replace('den', 'nnn');\n\n    // Day of Month\n    ret = pattern.replace('dd', this.pad(day, 2));\n    ret = ret.replace('d', day);\n\n    // years\n    ret = ret.replace('yyyy', year);\n    ret = ret.replace('yy', year.toString().substr(2));\n    ret = ret.replace('y', year);\n\n    // Time\n    const showDayPeriods = ret.indexOf(' a') > -1;\n\n    if (showDayPeriods && hours === 0) {\n      ret = ret.replace('hh', 12);\n      ret = ret.replace('h', 12);\n    }\n\n    ret = ret.replace('hh', (hours > 12 ? this.pad(hours - 12, 2) : this.pad(hours, 2)));\n    ret = ret.replace('h', (hours > 12 ? hours - 12 : hours));\n    ret = ret.replace('HH', this.pad(hours, 2));\n    ret = ret.replace('H', hours);\n    ret = ret.replace('mm', this.pad(mins, 2));\n    ret = ret.replace('ss', this.pad(seconds, 2));\n    ret = ret.replace('SSS', this.pad(millis, 0));\n\n    // months\n    ret = ret.replace('MMMM', cal ? cal.months.wide[month] : null); // full\n    ret = ret.replace('MMM', cal ? cal.months.abbreviated[month] : null); // abreviation\n    if (pattern.indexOf('MMM') === -1) {\n      ret = ret.replace('MM', this.pad(month + 1, 2)); // number padded\n      ret = ret.replace('M', month + 1); // number unpadded\n    }\n\n    // PM\n    if (cal) {\n      ret = ret.replace(' a', ` ${hours >= 12 ? cal.dayPeriods[1] : cal.dayPeriods[0]}`);\n      ret = ret.replace('EEEE', cal.days.wide[dayOfWeek]); // Day of Week\n    }\n\n    // Day of Week\n    if (cal) {\n      ret = ret.replace('EEEE', cal.days.wide[dayOfWeek]); // Day of Week\n    }\n    ret = ret.replace('nnnnn', 'de');\n    ret = ret.replace('nnnn', 'ngy');\n    ret = ret.replace('t1ng', 'thng');\n    ret = ret.replace('nnn', 'den');\n\n    // Timezone\n    if (ret.indexOf('zz') > -1) {\n      const timezoneDate = new Date();\n      const shortName = this.getTimeZone(timezoneDate, 'short');\n      const longName = this.getTimeZone(timezoneDate, 'long');\n\n      ret = ret.replace('zzzz', longName);\n      ret = ret.replace('zz', shortName);\n    }\n\n    return ret.trim();\n  },\n\n  /**\n   * Get the timezone part of a date\n   * @param  {date} date The date object to use.\n   * @param  {string} timeZoneName Can be short or long.\n   * @returns {string} The time zone as a string.\n   */\n  getTimeZone(date, timeZoneName) {\n    const currentLocale = Locale.currentLocale.name || 'en-US';\n    const time = date.toLocaleTimeString(currentLocale);\n    let name = '';\n\n    if (env.browser.name === 'ie' && env.browser.version === '11') {\n      return (date).toTimeString().match(new RegExp('[A-Z](?!.*[\\(])', 'g')).join('');\n    }\n\n    if (timeZoneName === 'long') {\n      name = date.toLocaleTimeString(\n        currentLocale,\n        { timeZoneName: 'long' }\n      );\n      return name.replace(`${time} `, '');\n    }\n\n    name = date.toLocaleTimeString(\n      currentLocale,\n      { timeZoneName: 'short' }\n    );\n    return name.replace(`${time} `, '');\n  },\n\n  /**\n  * Takes a date object in the current locale and adjusts it for the given timezone.\n  * @param {date} date The utc date to show in the desired timezone.\n  * @param {string} timeZone The timezone name to show.\n  * @param {string} timeZoneName How to display the time zone name. Defaults to none. But can be short or long.\n  * @returns {date} the utc date\n  */\n  dateToTimeZone(date, timeZone, timeZoneName) {\n    if (env.browser.name === 'ie' && env.browser.version === '11') {\n      return `${(date).toLocaleString(Locale.currentLocale.name)} ${(date).toTimeString().match(new RegExp('[A-Z](?!.*[\\(])', 'g')).join('')}`;\n    }\n\n    return (date).toLocaleString(Locale.currentLocale.name, { timeZone, timeZoneName });\n  },\n\n  /**\n  * Formats a Date Object and return it in UTC format\n  * @param {date} date The date to show in the current locale.\n  * @returns {date} the utc date\n  */\n  dateToUTC(date) {\n    return new Date(Date.UTC(\n      date.getFullYear(),\n      date.getMonth(),\n      date.getDate(),\n      date.getHours(),\n      date.getMinutes(),\n      date.getSeconds()\n    ));\n  },\n\n  /**\n  * Formats a number into the current locale using toLocaleString\n  * See: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString#Using_locales\n  * @param {number} number The number to convert\n  * @param {string} locale The number to convert\n  * @param {object} options The number to convert\n  * @returns {string} The converted number.\n  */\n  toLocaleString(number, locale, options) {\n    if (typeof number !== 'number') {\n      return '';\n    }\n    return number.toLocaleString(locale || Locale.currentLocale.name, options || undefined);\n  },\n\n  /**\n   * Convert a number in arabic/chinese or hindi numerals to an \"english\" number.\n   * @param  {[type]} string The string number in arabic/chinese or hindi\n   * @returns {number} The english number.\n   */\n  convertNumberToEnglish(string) {\n    const arabic = ['', '', '', '', '', '', '', '', '', ''];\n    const devanagari = ['', '', '', '', '', '', '', '', '', '']; // Hindi\n    const chineseFinancialTraditional = ['', '', '', '', '', '', '', '', '', ''];\n    const chineseFinancialSimplified = ['', '', '', '', '', '', '', '', '', ''];\n    const chinese = ['', '', '', '', '', '', '', '', '', ''];\n\n    for (let i = 0; i <= 9; i++) {\n      string = string.replace(arabic[i], i);\n      string = string.replace('', '');\n      string = string.replace(',', '');\n      string = string.replace(devanagari[i], i);\n      string = string.replace(chineseFinancialTraditional[i], i);\n      string = string.replace(chineseFinancialSimplified[i], i);\n      string = string.replace(chinese[i], i);\n\n      if (i === 0) { // Second option for zero in chinese\n        string = string.replace('', i);\n      }\n    }\n    return parseFloat(string);\n  },\n\n  /**\n   * Check if the date is valid using the current locale to do so.\n   * @param {date} date  The date to show in the current locale.\n   * @returns {boolean} whether or not the date is valid.\n   */\n  isValidDate(date) {\n    if (Object.prototype.toString.call(date) === '[object Date]') {\n      // it is a date\n      if (isNaN(date.getTime())) { // d.valueOf() could also work\n        return false;\n      }\n      return true;\n    }\n    return false;\n  },\n\n  /**\n   * Takes a formatted date string and parses back it into a date object\n   * @param {string} dateString  The string to parse in the current format\n   * @param {string|object} options  The source format for example 'yyyy-MM-dd' or { dateFormat: 'yyyy-MM-dd', locale: 'nl-NL'}\n   * @param {boolean} isStrict  If true missing date parts will be considered invalid. If false the current month/day.\n   * @returns {date|array|undefined} A correct date object, if islamic calendar then an array is used or undefined if invalid.\n   */\n  parseDate(dateString, options, isStrict) {\n    if (!dateString) {\n      return undefined;\n    }\n\n    let dateFormat = options;\n    let locale = this.currentLocale.name;\n    const thisLocaleCalendar = this.calendar();\n    if (typeof options === 'object') {\n      locale = options.locale || locale;\n      dateFormat = options.dateFormat || this.calendar(locale).dateFormat[dateFormat.date];\n    }\n\n    if (typeof options === 'object' && options.pattern) {\n      dateFormat = options.dateFormat || options.pattern;\n    }\n\n    if (!dateFormat) {\n      dateFormat = this.calendar(locale).dateFormat.short;\n    }\n\n    const orgDatestring = dateString;\n    if (dateString === '0000' || dateString === '000000' || dateString === '00000000') {\n      // Means no date in some applications\n      return undefined;\n    }\n\n    if (dateFormat.pattern) {\n      dateFormat = dateFormat.pattern;\n    }\n\n    let formatParts;\n    let dateStringParts;\n    const dateObj = {};\n    const isDateTime = (dateFormat.toLowerCase().indexOf('h') > -1);\n    const isUTC = (dateString.toLowerCase().indexOf('z') > -1);\n    let i;\n    let l;\n\n    if (isDateTime) {\n      // Remove Timezone\n      const shortTimeZone = Locale.getTimeZone(new Date(), 'short');\n      const longTimeZone = Locale.getTimeZone(new Date(), 'long');\n      dateString = dateString.replace(` ${shortTimeZone}`, '');\n      dateString = dateString.replace(` ${longTimeZone}`, '');\n      dateFormat = dateFormat.replace(' zzzz', '').replace(' zz', '');\n\n      // Replace [space & colon & dot] with \"/\"\n      dateFormat = dateFormat.replace(/[T\\s:.-]/g, '/').replace(/z/i, '');\n      dateString = dateString.replace(/[T\\s:.-]/g, '/').replace(/z/i, '');\n    }\n\n    // Remove spanish de\n    dateFormat = dateFormat.replace(' de ', ' ');\n    dateString = dateString.replace(' de ', ' ');\n\n    if (dateFormat === 'Mdyyyy' || dateFormat === 'dMyyyy') {\n      dateString = `${dateString.substr(0, dateString.length - 4)}/${dateString.substr(dateString.length - 4, dateString.length)}`;\n      dateString = `${dateString.substr(0, dateString.indexOf('/') / 2)}/${dateString.substr(dateString.indexOf('/') / 2)}`;\n    }\n\n    if (dateFormat === 'Mdyyyy') {\n      dateFormat = 'M/d/yyyy';\n    }\n\n    if (dateFormat === 'dMyyyy') {\n      dateFormat = 'd/M/yyyy';\n    }\n\n    if (dateFormat.indexOf(' ') !== -1) {\n      dateFormat = dateFormat.replace(/[\\s:.]/g, '/');\n      dateString = dateString.replace(/[\\s:.]/g, '/');\n    }\n\n    // Extra Check incase month has spaces\n    if (dateFormat.indexOf('MMMM') > -1 && Locale.isRTL() && dateFormat) {\n      const lastIdx = dateString.lastIndexOf('/');\n      dateString = dateString.substr(0, lastIdx - 1).replace('/', ' ') + dateString.substr(lastIdx);\n    }\n\n    if (dateFormat.indexOf(' ') === -1 && dateFormat.indexOf('.') === -1 && dateFormat.indexOf('/') === -1 && dateFormat.indexOf('-') === -1) {\n      // Remove delimeter for the data string.\n      if (dateString.indexOf(' ') !== -1) {\n        dateString = dateString.split(' ').join('');\n      } else if (dateString.indexOf('.') !== -1) {\n        dateString = dateString.split('.').join('');\n      } else if (dateString.indexOf('/') !== -1) {\n        dateString = dateString.split('/').join('');\n      } else if (dateString.indexOf('-') !== -1) {\n        dateString = dateString.split('-').join('');\n      }\n\n      let lastChar = dateFormat[0];\n      let newFormat = '';\n      let newDateString = '';\n\n      for (i = 0, l = dateFormat.length; i < l; i++) {\n        newDateString += (dateFormat[i] !== lastChar ? `/${dateString[i]}` : dateString[i]);\n        newFormat += (dateFormat[i] !== lastChar ? `/${dateFormat[i]}` : dateFormat[i]);\n\n        if (i > 1) {\n          lastChar = dateFormat[i];\n        }\n      }\n\n      dateString = newDateString;\n      dateFormat = newFormat;\n    }\n\n    formatParts = dateFormat.split('/');\n    dateStringParts = dateString.split('/');\n\n    if (formatParts.length === 1) {\n      formatParts = dateFormat.split('.');\n    }\n\n    if (dateStringParts.length === 1) {\n      dateStringParts = dateString.split('.');\n    }\n\n    if (formatParts.length === 1) {\n      formatParts = dateFormat.split('-');\n    }\n\n    if (dateStringParts.length === 1) {\n      dateStringParts = dateString.split('-');\n    }\n\n    if (formatParts.length === 1) {\n      formatParts = dateFormat.split(' ');\n    }\n\n    if (dateStringParts.length === 1) {\n      dateStringParts = dateString.split(' ');\n    }\n\n    // Check the incoming date string's parts to make sure the values are\n    // valid against the localized Date pattern.\n    const month = this.getDatePart(formatParts, dateStringParts, 'M', 'MM', 'MMM', 'MMMM');\n    const year = this.getDatePart(formatParts, dateStringParts, 'yy', 'yyyy');\n    let hasDays = false;\n\n    for (i = 0, l = dateStringParts.length; i < l; i++) {\n      const pattern = `${formatParts[i]}`;\n      const value = dateStringParts[i];\n      const numberValue = parseInt(value, 10);\n\n      if (!hasDays) {\n        hasDays = pattern.toLowerCase().indexOf('d') > -1;\n      }\n\n      let lastDay;\n      let abrMonth;\n      let textMonths;\n\n      switch (pattern) {\n        case 'd':\n          lastDay = new Date(year, month, 0).getDate();\n\n          if (numberValue < 1 || numberValue > 31 || numberValue > lastDay) {\n            return undefined;\n          }\n          dateObj.day = value;\n          break;\n        case 'dd':\n          if ((numberValue < 1 || numberValue > 31) || (numberValue < 10 && value.substr(0, 1) !== '0')) {\n            return undefined;\n          }\n          dateObj.day = value;\n          break;\n        case 'M':\n          if (numberValue < 1 || numberValue > 12) {\n            return undefined;\n          }\n          dateObj.month = value - 1;\n          break;\n        case 'MM':\n          if ((numberValue < 1 || numberValue > 12) || (numberValue < 10 && value.substr(0, 1) !== '0')) {\n            return undefined;\n          }\n          dateObj.month = value - 1;\n          break;\n        case 'MMM':\n          abrMonth = this.calendar(locale).months.abbreviated;\n\n          for (let len = 0; len < abrMonth.length; len++) {\n            if (orgDatestring.indexOf(abrMonth[len]) > -1) {\n              dateObj.month = len;\n            }\n          }\n\n          break;\n        case 'MMMM':\n          textMonths = this.calendar(locale).months.wide;\n\n          for (let k = 0; k < textMonths.length; k++) {\n            if (orgDatestring.indexOf(textMonths[k]) > -1) {\n              dateObj.month = k;\n            }\n          }\n\n          break;\n        case 'yy':\n          dateObj.year = this.twoToFourDigitYear(value);\n          break;\n        case 'yyyy':\n          dateObj.year = (value.length === 2) ?\n            this.twoToFourDigitYear(value) : value;\n          break;\n        case 'h':\n          if (numberValue < 0 || numberValue > 12) {\n            return undefined;\n          }\n          dateObj.h = value;\n          break;\n        case 'hh':\n          if (numberValue < 0 || numberValue > 12) {\n            return undefined;\n          }\n          dateObj.h = value.length === 1 ? `0${value}` : value;\n          break;\n        case 'H':\n          if (numberValue < 0 || numberValue > 24) {\n            return undefined;\n          }\n          dateObj.h = value;\n          break;\n        case 'HH':\n          if (numberValue < 0 || numberValue > 24) {\n            return undefined;\n          }\n          dateObj.h = value.length === 1 ? `0${value}` : value;\n          break;\n\n        case 'ss':\n          if (numberValue < 0 || numberValue > 60) {\n            dateObj.ss = 0;\n            break;\n          }\n          dateObj.ss = value;\n          break;\n\n        case 'SSS':\n          dateObj.ms = value;\n          break;\n\n        case 'mm':\n          if (numberValue < 0 || numberValue > 60) {\n            dateObj.mm = 0;\n            break;\n          }\n          dateObj.mm = value;\n          break;\n\n        case 'a':\n          if ((value.toLowerCase() === thisLocaleCalendar.dayPeriods[0]) ||\n           (value.toUpperCase() === thisLocaleCalendar.dayPeriods[0])) {\n            dateObj.a = 'AM';\n\n            if (dateObj.h) {\n              if (dateObj.h === 12 || dateObj.h === '12') {\n                dateObj.h = 0;\n              }\n            }\n          }\n\n          if ((value.toLowerCase() === thisLocaleCalendar.dayPeriods[1]) ||\n           (value.toUpperCase() === thisLocaleCalendar.dayPeriods[1])) {\n            dateObj.a = 'PM';\n\n            if (dateObj.h) {\n              if (dateObj.h < 12) {\n                dateObj.h = parseInt(dateObj.h, 10) + 12;\n              }\n            }\n          }\n          break;\n        default:\n          break;\n      }\n    }\n\n    dateObj.return = undefined;\n    dateObj.leapYear = ((dateObj.year % 4 === 0) &&\n      (dateObj.year % 100 !== 0)) || (dateObj.year % 400 === 0);\n\n    if ((isDateTime && !dateObj.h && !dateObj.mm)) {\n      return undefined;\n    }\n\n    if (!dateObj.year && dateObj.year !== 0 && !isStrict) {\n      dateObj.isUndefindedYear = true;\n      for (i = 0, l = formatParts.length; i < l; i++) {\n        if (formatParts[i].indexOf('y') > -1 && dateStringParts[i] !== undefined) {\n          dateObj.isUndefindedYear = false;\n          break;\n        }\n      }\n      if (dateObj.isUndefindedYear) {\n        dateObj.year = (new Date()).getFullYear();\n      } else {\n        delete dateObj.year;\n      }\n    }\n\n    // Fix incomelete 2 and 3 digit years\n    if (dateObj.year && dateObj.year.length === 2) {\n      dateObj.year = `20${dateObj.year}`;\n    }\n\n    dateObj.year = $.trim(dateObj.year);\n    dateObj.day = $.trim(dateObj.day);\n\n    if (dateObj.year === '' || (dateObj.year && !((`${dateObj.year}`).length === 2 || (`${dateObj.year}`).length === 4))) {\n      delete dateObj.year;\n    }\n\n    if (!dateObj.month && dateObj.month !== 0 && !isStrict) {\n      dateObj.isUndefindedMonth = true;\n      for (i = 0, l = formatParts.length; i < l; i++) {\n        if (formatParts[i].indexOf('M') > -1 && dateStringParts[i] !== undefined) {\n          dateObj.isUndefindedMonth = false;\n          break;\n        }\n      }\n      if (dateObj.isUndefindedMonth) {\n        dateObj.month = (new Date()).getMonth();\n      }\n    }\n\n    if (!dateObj.day && dateObj.day !== 0 && (!isStrict || !hasDays)) {\n      dateObj.isUndefindedDay = true;\n      for (i = 0, l = formatParts.length; i < l; i++) {\n        if (formatParts[i].indexOf('d') > -1 && dateStringParts[i] !== undefined) {\n          dateObj.isUndefindedDay = false;\n          break;\n        }\n      }\n      if (dateObj.isUndefindedDay) {\n        dateObj.day = 1;\n      } else {\n        delete dateObj.day;\n      }\n    }\n\n    if (isDateTime) {\n      if (isUTC) {\n        if (dateObj.h !== undefined) {\n          dateObj.return = new Date(Date.UTC(dateObj.year, dateObj.month, dateObj.day, dateObj.h, dateObj.mm)); //eslint-disable-line\n        }\n        if (dateObj.ss !== undefined) {\n          dateObj.return = new Date(Date.UTC(dateObj.year, dateObj.month, dateObj.day, dateObj.h, dateObj.mm, dateObj.ss)); //eslint-disable-line\n        }\n        if (dateObj.ms !== undefined) {\n          dateObj.return = new Date(Date.UTC(dateObj.year, dateObj.month, dateObj.day, dateObj.h, dateObj.mm, dateObj.ss, dateObj.ms)); //eslint-disable-line\n        }\n      } else {\n        if (dateObj.h !== undefined) {\n          dateObj.return = new Date(dateObj.year, dateObj.month, dateObj.day, dateObj.h, dateObj.mm); //eslint-disable-line\n        }\n        if (dateObj.ss !== undefined) {\n          dateObj.return = new Date(dateObj.year, dateObj.month, dateObj.day, dateObj.h, dateObj.mm, dateObj.ss); //eslint-disable-line\n        }\n        if (dateObj.ms !== undefined) {\n          dateObj.return = new Date(dateObj.year, dateObj.month, dateObj.day, dateObj.h, dateObj.mm, dateObj.ss, dateObj.ms); //eslint-disable-line\n        }\n      }\n    } else {\n      dateObj.return = new Date(dateObj.year, dateObj.month, dateObj.day);\n    }\n\n    if (thisLocaleCalendar.name === 'islamic-umalqura') {\n      return [\n        parseInt(dateObj.year, 10),\n        parseInt(dateObj.month, 10),\n        parseInt(dateObj.day, 10),\n        parseInt(dateObj.h || 0, 10),\n        parseInt(dateObj.ss || 0, 10),\n        parseInt(dateObj.ms || 0, 10)\n      ];\n    }\n\n    return (this.isValidDate(dateObj.return) ? dateObj.return : undefined);\n  },\n\n  /**\n   * Convert the two digit year year to the correct four digit year.\n   * @private\n   * @param  {number} twoDigitYear The two digit year.\n   * @returns {number} Converted 3 digit year.\n   */\n  twoToFourDigitYear(twoDigitYear) {\n    return parseInt((twoDigitYear > 39 ? '19' : '20') + twoDigitYear, 10);\n  },\n\n  /**\n   * Format out the date into parts.\n   * @private\n   * @param  {array} formatParts An array of the format bits.\n   * @param  {array} dateStringParts An array of the date parts.\n   * @param  {string} filter1 The first option to filter.\n   * @param  {string} filter2 The second option to filter.\n   * @param  {string} filter3 The third option to filter.\n   * @param  {string} filter4 The fourth option to filter.\n   * @returns {string} The filtered out date part.\n   */\n  getDatePart(formatParts, dateStringParts, filter1, filter2, filter3, filter4) {\n    let ret = 0;\n\n    $.each(dateStringParts, (i) => {\n      if (filter1 === formatParts[i] ||\n        filter2 === formatParts[i] ||\n        filter3 === formatParts[i] ||\n        filter4 === formatParts[i]) {\n        ret = dateStringParts[i];\n      }\n    });\n\n    return ret;\n  },\n\n  /**\n   * Use the current locale data or the one passed in.\n   * @private\n   * @param  {object} options The options to parse.\n   * @returns {object} The locale data.\n   */\n  useLocale(options) {\n    let localeData = this.currentLocale.data;\n    if (options && options.locale && this.cultures[options.locale]) {\n      localeData = this.cultures[options.locale];\n    }\n    if (!localeData.numbers) {\n      localeData.numbers = this.numbers();\n    }\n    return localeData;\n  },\n\n  /**\n   * Use the current language data or the one passed in.\n   * @private\n   * @param  {object} options The options to parse.\n   * @returns {object} The language data.\n   */\n  useLanguage(options) {\n    let languageData = this.currentLanguage;\n    if (options && options.locale) {\n      const lang = options.locale.split('-')[0];\n      return this.languages[lang];\n    }\n    if (options && options.language && this.languages[options.language]) {\n      languageData = this.languages[options.language];\n    }\n    return languageData;\n  },\n\n  /**\n  * Formats a decimal with thousands and padding in the current locale or settings.\n  * @param {number} number The source number.\n  * @param {object} options additional options (see Number Format Patterns)\n  * @returns {string} the formatted number.\n  */\n  formatNumber(number, options) {\n    const localeData = this.useLocale(options);\n    let formattedNum;\n    let curFormat;\n    let percentFormat;\n    const decimal = options && options.decimal ? options.decimal : localeData.numbers.decimal;\n    let minimumFractionDigits = options && options.minimumFractionDigits !== undefined ? options.minimumFractionDigits : (options && options.style && options.style === 'currency' ? 2 : (options && options.style && options.style === 'percent') ? 0 : 2);\n    let maximumFractionDigits = options && options.maximumFractionDigits !== undefined ? options.maximumFractionDigits : (options && options.style && (options.style === 'currency' || options.style === 'percent') ? 2 : (options && options.minimumFractionDigits ? options.minimumFractionDigits : 3));\n\n    if (number === undefined || number === null || number === '') {\n      return undefined;\n    }\n\n    if (options && options.style === 'integer') {\n      maximumFractionDigits = 0;\n      minimumFractionDigits = 0;\n    }\n\n    if (options && options.style === 'currency') {\n      const sign = options && options.currencySign ? options.currencySign : localeData.currencySign;\n      let format = options && options.currencyFormat ? options.currencyFormat :\n        localeData.currencyFormat;\n\n      if (!format) {\n        format = '#,##0.00'; // default to en-us\n      }\n      curFormat = format.replace('', sign);\n    }\n\n    if (options && options.style === 'percent') {\n      const percentSign = !localeData.numbers ? '%' : localeData.numbers.percentSign;\n\n      percentFormat = !localeData.numbers ? '### %' : localeData.numbers.percentFormat;\n      percentFormat = percentFormat.replace('', percentSign);\n    }\n\n    if (typeof number === 'string') {\n      if (decimal !== '.') {\n        number = number.replace(decimal, '.');\n      }\n      number = Locale.parseNumber(number);\n    }\n\n    if (options && options.style === 'percent') {\n      // the toFixed for maximumFractionDigits + 1 means we won't loose any precision\n      number = (number * 100).toFixed(minimumFractionDigits);\n    }\n\n    const parts = this.truncateDecimals(number, minimumFractionDigits, maximumFractionDigits, options && options.round).split('.');\n    let groupSizes = [3, 3]; // In case there is no data\n    if (localeData && localeData.numbers && localeData.numbers.groupSizes) {\n      groupSizes = localeData.numbers.groupSizes;\n    }\n    if (options && options.groupSizes) {\n      groupSizes = options.groupSizes;\n    }\n\n    const sep = options && options.group !== undefined ? options.group : localeData.numbers.group;\n    const expandedNum = this.expandNumber(parts[0], groupSizes, sep);\n    parts[0] = expandedNum;\n    formattedNum = parts.join(decimal);\n\n    // Position the negative at the front - There is no CLDR info for this.\n    const minusSign = (localeData && localeData.numbers &&\n      localeData.numbers.minusSign) ? localeData.numbers.minusSign : '-';\n    const isNegative = (formattedNum.indexOf(minusSign) > -1);\n    formattedNum = formattedNum.replace(minusSign, '');\n\n    const escape = str => str.replace(/([.?*+^$[\\]\\\\(){}|-])/g, '\\\\$1');\n    let expr = '';\n\n    if (minimumFractionDigits === 0) { // Not default\n      expr = new RegExp(`(${escape(decimal)}[0-9]*?)0+$`);\n      formattedNum = formattedNum.replace(expr, '$1'); // remove trailing zeros\n    }\n\n    if (minimumFractionDigits > 0) {\n      expr = new RegExp(`(${escape(decimal)}.{${minimumFractionDigits}}[0-9]*?)0+$`);\n      formattedNum = formattedNum.replace(expr, '$1'); // remove trailing zeros\n    }\n\n    expr = new RegExp(`${escape(decimal)}$`);\n    formattedNum = formattedNum.replace(expr, ''); // remove trailing decimal\n\n    if (options && options.style === 'currency') {\n      formattedNum = curFormat.replace('###', formattedNum);\n    }\n\n    if (options && options.style === 'percent') {\n      formattedNum = percentFormat.replace('###', formattedNum);\n    }\n\n    if (isNegative) {\n      formattedNum = minusSign + formattedNum;\n    }\n    return formattedNum;\n  },\n\n  /**\n   * Return the number of decimal places in a number\n   * @private\n   * @param  {number} number The starting number.\n   * @returns {number} The number of decimal places.\n   */\n  decimalPlaces(number) {\n    if (Math.floor(number) === number) {\n      return 0;\n    }\n\n    if (number.toString().indexOf('.') === -1) {\n      return 0;\n    }\n    return number.toString().split('.')[1].length || 0;\n  },\n\n  /**\n   * Expand the number to the groupsize.\n   * @private\n   * @param  {string} numberString The number to expand\n   * @param  {array} groupSizes The groupSizes option.\n   * @param  {string} sep The thousands seperator option.\n   * @returns {string} The expanded number.\n   */\n  expandNumber(numberString, groupSizes, sep) {\n    let len = numberString.length;\n    let isNegative = false;\n\n    if (numberString.substr(0, 1) === '-') {\n      numberString = numberString.substr(1);\n      len = numberString.length;\n      isNegative = true;\n    }\n\n    if (len <= 3) {\n      return (isNegative ? '-' : '') + numberString;\n    }\n\n    if (groupSizes[0] === 0) {\n      return (isNegative ? '-' : '') + numberString;\n    }\n\n    const firstGroup = numberString.substr(numberString.length - groupSizes[0]);\n    const nthGroup = numberString.substr(0, numberString.length - groupSizes[0]);\n    if (groupSizes[1] === 0) {\n      return (isNegative ? '-' : '') + nthGroup + (nthGroup === '' ? '' : sep) + firstGroup;\n    }\n    const reversed = nthGroup.split('').reverse().join('');\n    const regex = new RegExp(`.{1,${groupSizes[1]}}`, 'g');\n    const reversedSplit = reversed.match(regex).join(sep);\n    return (isNegative ? '-' : '') + reversedSplit.split('').reverse().join('') + sep + firstGroup;\n  },\n\n  /**\n   * Truncate a number to a specific min and max digits.\n   * @private\n   * @param  {number} number The starting number.\n   * @param  {number} minDigits Minimum number of digits to show on the decimal portion.\n   * @param  {number} maxDigits Maximum number of digits to show on the decimal portion.\n   * @param  {boolean} round If true round, if false truncate.\n   * @returns {number} The updated number.\n   */\n  truncateDecimals(number, minDigits, maxDigits, round) {\n    let multiplier = Math.pow(10, maxDigits);\n    let adjustedNum = number * multiplier;\n    let truncatedNum;\n\n    // Round Decimals\n    const decimals = this.decimalPlaces(number);\n\n    // Handle larger numbers\n    if (number.toString().length - decimals - 1 >= 10 ||\n      (decimals === minDigits && decimals === maxDigits) || (decimals < maxDigits)) {\n      multiplier = Math.pow(100, maxDigits);\n      adjustedNum = number * multiplier;\n    }\n\n    truncatedNum = Math[adjustedNum < 0 ? 'ceil' : 'floor'](adjustedNum);\n\n    if (round && decimals >= maxDigits && adjustedNum > 0) {\n      truncatedNum = Math.round(adjustedNum);\n    }\n\n    if (round && decimals <= maxDigits && decimals > 0) {\n      truncatedNum = Math.round(adjustedNum);\n    }\n\n    if (decimals < maxDigits && decimals > 0) {\n      truncatedNum = Math.floor(adjustedNum);\n      maxDigits = Math.max(decimals, minDigits);\n    }\n\n    return (truncatedNum / multiplier).toFixed(maxDigits);\n  },\n\n  /**\n   * Takes a formatted number string and returns back real number object.\n   * @param {string} input  The source number (as a string).\n   * @param {object} options  Any special options to pass in such as the locale.\n   * @returns {number} the number as an actual Number type.\n   */\n  parseNumber(input, options) {\n    const localeData = this.useLocale(options);\n    const numSettings = localeData.numbers;\n    let numString;\n\n    numString = input;\n\n    if (!numString) {\n      return NaN;\n    }\n\n    if (typeof input === 'number') {\n      numString = numString.toString();\n    }\n\n    const group = numSettings ? numSettings.group : ',';\n    const decimal = numSettings ? numSettings.decimal : '.';\n    const percentSign = numSettings ? numSettings.percentSign : '%';\n    const currencySign = localeData.currencySign || '$';\n\n    numString = numString.replace(new RegExp(`\\\\${group}`, 'g'), '');\n    numString = numString.replace(decimal, '.');\n    numString = numString.replace(percentSign, '');\n    numString = numString.replace(currencySign, '');\n    numString = numString.replace('$', '');\n    numString = numString.replace(' ', '');\n\n    return parseFloat(numString);\n  },\n\n  /**\n   * Takes a translation key and returns the translation in the current locale.\n   * @param {string} key  The key to search for on the string.\n   * @param {object} [options] A list of options, supported are a non default locale and showAsUndefined which causes a translated phrase to be shown in square brackets\n   * instead of defaulting to the default locale's version of the string.\n   * @returns {string|undefined} a translated string, or nothing, depending on configuration\n   */\n  translate(key, options) {\n    const languageData = this.useLanguage(options);\n    let showAsUndefined = false;\n    if (typeof options === 'boolean') {\n      showAsUndefined = options;\n    }\n    if (typeof options === 'object') {\n      showAsUndefined = options.showAsUndefined;\n    }\n\n    if (languageData.messages === undefined) {\n      return showAsUndefined ? undefined : `[${key}]`;\n    }\n\n    if (languageData.messages[key] === undefined) {\n      const enLang = 'en';\n      // Substitue English Expression if missing\n      if (!this.languages || !this.languages[enLang] || !this.languages[enLang].messages\n          || this.languages[enLang].messages[key] === undefined) {\n        return showAsUndefined ? undefined : `[${key}]`;\n      }\n      return this.languages[enLang].messages[key].value;\n    }\n\n    return languageData.messages[key].value;\n  },\n\n  /**\n   * Add an object full of translations to the given locale.\n   * @param {string} lang The language to add them to.\n   * @param  {object} messages Strings in the form of\n   */\n  extendTranslations(lang, messages) {\n    if (!this.languages[lang]) {\n      return;\n    }\n    const base = this.languages[lang].messages;\n    this.languages[lang].messages = $.extend(false, base, messages);\n  },\n\n  /**\n   * Shortcut function to get 'first' calendar\n   * @private\n   * @param {string} locale The locale to use\n   * @param {string} name the name of the calendar (fx: \"gregorian\", \"islamic-umalqura\")\n   * @returns {object} containing calendar data.\n   */\n  calendar(locale, name) {\n    let calendars = [];\n    if (this.currentLocale.data.calendars && !locale) {\n      calendars = this.currentLocale.data.calendars;\n    }\n\n    if (locale && this.cultures[locale]) {\n      calendars = this.cultures[locale].calendars;\n    }\n\n    if (name && calendars) {\n      for (let i = 0; i < calendars.length; i++) {\n        const cal = calendars[i];\n        if (cal.name === name) {\n          return cal;\n        }\n      }\n    }\n\n    if (calendars[0]) {\n      return calendars[0];\n    }\n\n    // Defaults to en-US\n    return {\n      dateFormat: {\n        separator: '/',\n        timeSeparator: ':',\n        short: 'M/d/yyyy',\n        medium: 'MMM d, yyyy',\n        long: 'MMMM d, yyyy',\n        full: 'EEEE, MMMM d, y',\n        month: 'MMMM d',\n        year: 'MMMM yyyy',\n        timestamp: 'h:mm:ss a',\n        datetime: 'M/d/yyyy h:mm a'\n      },\n      timeFormat: 'HH:mm:ss',\n      dayPeriods: ['AM', 'PM']\n    };\n  },\n\n  /**\n   * Shortcut function to get numbers\n   * @private\n   * @returns {object} containing information for formatting numbers\n   */\n  numbers() {\n    return this.currentLocale.data.numbers ? this.currentLocale.data.numbers : {\n      percentSign: '%',\n      percentFormat: '### %',\n      minusSign: '-',\n      decimal: '.',\n      group: ','\n    };\n  },\n\n  /**\n   * Padd a number to the given width and decimals\n   * @private\n   * @param {string} n the number\n   * @param {number} width the decimal with\n   * @param {string} z the padding character\n   * @returns {string} the padded string\n   */\n  pad(n, width, z) {\n    z = z || '0';\n    n += '';\n    return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n  },\n\n  /**\n   * Describes whether or not this locale is one that is read in \"right-to-left\" fashion.\n   * @returns {boolean} whether or not this locale is \"right-to-left\".\n   */\n  isRTL() {\n    return this.currentLanguage.direction === 'right-to-left';\n  },\n\n  /**\n   * Takes a string and converts its contents to upper case, taking into account\n   * Locale-specific character conversions.  In most cases this method will simply\n   * pipe the string to `String.prototype.toUpperCase()`.\n   * @private\n   * @param {string} str the incoming string\n   * @returns {string} modified string\n   */\n  toUpperCase(str) {\n    if (typeof this.currentLocale.data.toUpperCase === 'function') {\n      return this.currentLocale.data.toUpperCase(str);\n    }\n\n    return str.toLocaleUpperCase();\n  },\n\n  /**\n   * Takes a string and converts its contents to lower case, taking into account\n   * Locale-specific character conversions. In most cases this method will simply\n   * pipe the string to `String.prototype.toLowerCase()`\n   * @private\n   * @param {string} str - the incoming string\n   * @returns {string} The localized string\n   */\n  toLowerCase(str) {\n    if (typeof this.currentLocale.data.toLowerCase === 'function') {\n      return this.currentLocale.data.toLowerCase(str);\n    }\n\n    return str.toString().toLocaleLowerCase();\n  },\n\n  /**\n   * Takes a string and capitalizes the first letter, taking into account Locale-specific\n   * character conversions. In most cases this method will simply use a simple algorithm\n   * for captializing the first letter of the string.\n   * @private\n   * @param {string} str the incoming string\n   * @returns {string} the modified string\n   */\n  capitalize(str) {\n    return this.toUpperCase(str.charAt(0)) + str.slice(1);\n  },\n\n  /**\n   * Takes a string and capitalizes the first letter of each word in a string, taking\n   * into account Locale-specific character conversions. In most cases this method\n   * will simply use a simple algorithm for captializing the first letter of the string.\n   * @private\n   * @param {string} str the incoming string\n   * @returns {string} the modified string\n   */\n  capitalizeWords(str) {\n    const words = str.split(' ');\n\n    for (let i = 0; i < words.length; i++) {\n      words[i] = this.capitalize(words[i]);\n    }\n\n    return words.join(' ');\n  },\n\n  /**\n   * Modifies a specified list of icons by flipping them horizontally to make them\n   * compatible for RTL-based locales.\n   * @private\n   * @returns {void}\n   */\n  flipIconsHorizontally() {\n    const icons = [\n      'attach',\n      'bottom-aligned',\n      'bullet-list',\n      'cancel',\n      'cart',\n      'collapse-app-tray',\n      'cut',\n      'document',\n      'drilldown',\n      'duplicate',\n      'expand-app-tray',\n      'export',\n      'first-page',\n      'folder',\n      'import',\n      'last-page',\n      'launch',\n      'left-align',\n      'left-text-align',\n      'left-arrow',\n      'new-document',\n      'next-page',\n      'number-list',\n      'paste',\n      'previous-page',\n      'quote',\n      'redo',\n      'refresh',\n      'right-align',\n      'right-arrow',\n      'right-text-align',\n      'save',\n      'search-folder',\n      'search-list',\n      'search',\n      'send',\n      'tack',\n      'tree-collapse',\n      'tree-expand',\n      'undo',\n      'unlocked',\n      'add-grid-record',\n      'add-grid-row',\n      'additional-help',\n      'bubble',\n      'bullet-steps',\n      'cascade',\n      'change-font',\n      'clear-screen',\n      'script',\n      'clockwise-90',\n      'close-cancel',\n      'close-save',\n      'contacts',\n      'copy-from',\n      'copy-mail',\n      'copy-url',\n      'counter-clockwise-90',\n      'create-report',\n      'delete-grid-record',\n      'delete-grid-row',\n      'display',\n      'employee-directory',\n      'export-2',\n      'export-to-pdf',\n      'generate-key',\n      'get-more-rows',\n      'group-selection',\n      'headphones',\n      'help',\n      'helper-list-select',\n      'history',\n      'invoice-released',\n      'language',\n      'logout',\n      'key',\n      'lasso',\n      'line-bar-chart',\n      'line-chart',\n      'new-expense-report',\n      'new-payment-request',\n      'new-time-sheet',\n      'new-travel-plan',\n      'no-attachment',\n      'no-comment',\n      'no-filter',\n      'overlay-line',\n      'pdf-file',\n      'phone',\n      'payment-request',\n      'pie-chart',\n      'queries',\n      'quick-access',\n      'refresh-current',\n      'restore-user',\n      'run-quick-access',\n      'save-close',\n      'save-new',\n      'search-results-history',\n      'select',\n      'send-submit',\n      'show-last-x-days',\n      'special-item',\n      'stacked',\n      'timesheet',\n      'unsubscribe',\n      'update-preview',\n      'zoom-100',\n      'zoom-in',\n      'zoom-out',\n      'caret-left',\n      'caret-right'\n    ];\n\n    $('svg').each(function () {\n      const iconName = $(this).getIconName();\n\n      if (iconName && $.inArray(iconName, icons) !== -1 && $(this).closest('.monthview').length === 0) {\n        $(this).addClass('icon-rtl-rotate');\n      }\n    });\n  }\n\n};\n\n// Has to delay in order to check if no culture in head since scripts load async\n$(() => {\n  setTimeout(() => {\n    if (Locale && !Locale.cultureInHead() && !Locale.currentLocale.name) {\n      Locale.set('en-US');\n    }\n  }, 50);\n});\n\nexport { Locale };\n","/**\n * Safely gets the name of a method\n * @param {function|string} method the method to be checked (or method name to be reported)\n * @returns {string} the name of the method\n */\nfunction methodName(method) {\n  if (typeof method !== 'function') {\n    if (typeof method === 'string') {\n      return method;\n    }\n    throw new Error(`${typeof method} was provided where a function was expected.`);\n  }\n\n  // ES6-friendly\n  if (typeof method.name === 'string') {\n    return `${method.name}()`;\n  }\n\n  // Regex for ES5 (IE11)\n  // See https://stackoverflow.com/a/17923727/4024149\n  const result = /^function\\s+([\\w$]+)\\s*\\(/.exec(method.toString());\n  return result ? `${result[1]}()` : '(anonymous function)';\n}\n\n/**\n * Warns about a deprecated property/method via a console warning\n * @param {function|string} newMethod the new method to call\n * @param {function|string} oldMethod the name of the old method\n * @returns {void}\n */\nfunction warnAboutDeprecation(newMethod, oldMethod) {\n  const newMethodName = methodName(newMethod);\n  const oldMethodName = methodName(oldMethod);\n\n  if (typeof console !== 'object') {\n    return;\n  }\n  console.warn(`IDS Enterprise: \"${oldMethodName}\" is deprecated. Please use \"${newMethodName}\" instead.`);\n}\n\n/**\n * Deprecates a method in the codebase\n * @param {function} newMethod the new method to call\n * @param {function} oldMethod the name of the old method\n * @param {...object} [args] arguments that will be passed to the new function\n * @returns {function} wrapper method\n */\nfunction deprecateMethod(newMethod, oldMethod) {\n  const wrapper = function deprecatedMethodWrapper(...args) {\n    warnAboutDeprecation(newMethod, oldMethod);\n    newMethod.apply(this, args);\n  };\n  wrapper.prototype = newMethod.prototype;\n\n  return wrapper;\n}\n\nexport { warnAboutDeprecation, deprecateMethod };\n","import { warnAboutDeprecation } from './deprecated';\n\n/**\n * Provides a global object that detects the existence of a Base Tag,\n * and provides some methods that can be used to get an accurate relative\n * URL using the base tag.\n * @class Base\n * @constructor\n * @param {HTMLElement} element the Base Tag Element\n * @returns {Base} component instance\n */\nfunction Base(element) {\n  this.element = $(element);\n  return this;\n}\n\nBase.prototype = {\n\n  /**\n   * @private\n   * @returns {string} current page URL\n   */\n  get url() {\n    return window.location.href\n      .replace(window.location.hash, '');\n  },\n\n  /**\n   * @private\n   * @returns {string} the base tag's `href` attribute\n   */\n  get href() {\n    return this.element[0].getAttribute('href');\n  },\n\n  /**\n   * This method is slated to be removed in a future v4.18.0 or v5.0.0.\n   * @deprecated as of v4.12.0. Please use the `url` property instead.\n   * @returns {string} current page URL\n   */\n  getCurrentURL() {\n    warnAboutDeprecation('url', 'getCurrentURL');\n    return this.url;\n  },\n\n  /**\n   * Gets a copy of a URL prepended with the contents of the Base Tag's hash.\n   * If there's no base tag present, this simply returns the hash provided.\n   * @param {string} hash the URL to be checked.\n   * @returns {string} the current URL prepended with the Base Tag's ref, if necessary\n   */\n  getBaseURL(hash) {\n    // If no valid base tag exists, just return the hash provided.\n    if (!this.element.length || (!this.href || this.href === '/')) {\n      if (!hash) {\n        return '';\n      }\n      return hash;\n    }\n\n    if (hash) {\n      if (hash.indexOf('/') === 0) {\n        return hash;\n      }\n\n      hash = (hash.indexOf('#') === -1 ? '#' : '') + hash;\n      return this.url + hash;\n    }\n\n    return this.url;\n  }\n};\n\n// Setup a Base Tag Component instance\nconst base = new Base($('base[href]'));\n\n/**\n * Setup a default function that just returns the contents of the hash,\n * if no base tag is present.\n * @param {string} hash the URL to be checked.\n * @returns {string} the current URL prepended with the Base Tag's ref, if necessary\n */\n$.getBaseURL = function (hash) {\n  return base.getBaseURL(hash);\n};\n\nexport { base };\n","import { utils } from './utils';\n\n// Default RenderLoop Settings\nconst RENDERLOOP_DEFAULTS = {\n  noAutoStart: false\n};\n\n// Only start the renderloop if it's not disabled by a Global config setting.\nlet instanceSettings = {};\nif (typeof window.SohoConfig === 'object' && typeof window.SohoConfig.renderLoop === 'object') {\n  instanceSettings = utils.extend({}, RENDERLOOP_DEFAULTS, window.SohoConfig.renderLoop);\n}\n\n/**\n * Gets an accurate timestamp from\n * @private\n * @returns {number} a current timestamp\n */\nfunction timestamp() {\n  return window.performance && window.performance.now ?\n    window.performance.now() :\n    new Date().getTime();\n}\n\n/**\n * RenderLoop Queue items\n * @param {object} opts options\n * @returns {this} RenderLoopItem\n */\nfunction RenderLoopItem(opts) {\n  // Either ID or a duration is required\n  this.id = opts.id;\n  this.duration = opts.duration || -1;\n  if (this.duration < 1 && (typeof this.id !== 'string' || !this.id.length)) {\n    throw new Error('cannot build a RenderLoopItem with no duration and no namespace');\n  }\n  this.updateDuration = opts.updateDuration || 1;\n\n  // functions\n  this.setFuncs(opts);\n\n  // internal state\n  this.paused = false;\n  this.elapsedTime = 0;\n  this.startTime = timestamp();\n\n  return this;\n}\n\nRenderLoopItem.prototype = {\n\n  /**\n   * @private\n   * @param {object} opts incoming settings\n   */\n  setFuncs(opts) {\n    if (typeof opts.updateCallback !== 'function' && typeof opts.timeoutCallback !== 'function') {\n      throw new Error('cannot register callback to RenderLoop because callback is not a function');\n    }\n\n    if (typeof opts.updateCallback === 'function') {\n      this.updateCallback = opts.updateCallback;\n    }\n\n    if (typeof opts.timeoutCallback === 'function') {\n      this.timeoutCallback = opts.timeoutCallback;\n    }\n  },\n\n  pause() {\n    this.paused = true;\n  },\n\n  resume() {\n    this.paused = false;\n  },\n\n  /**\n   * @param {boolean} noTimeout causes the item to be destroyed without triggering the `timeoutCallback` function\n   */\n  destroy(noTimeout) {\n    if (noTimeout) {\n      this.noTimeout = true;\n    }\n    this.doRemoveOnNextTick = true;\n  }\n};\n\n/**\n * Sets up a timed rendering loop that can be used for controlling animations\n * globally in an application that implements Soho.\n * @constructor\n * @param {object} [settings] incoming settings\n * @param {boolean} [settings.noAutoStart] if true, will not auto-start the renderLoop\n */\nfunction RenderLoop(settings) {\n  this.items = [];\n  this.element = $('body');\n  this.settings = utils.mergeSettings(null, settings, RENDERLOOP_DEFAULTS);\n\n  if (this.settings.noAutoStart !== true) {\n    this.start();\n  }\n\n  return this;\n}\n\nRenderLoop.prototype = {\n\n  /**\n   * Start the entire render loop\n   * @returns {void}\n   */\n  start() {\n    this.doLoop = true;\n    this.startTime = timestamp();\n\n    const self = this;\n    let last = timestamp();\n    let now;\n    let deltaTime;\n\n    function tick() {\n      // Don't continue if the loop is stopped externally\n      if (!self.doLoop) {\n        return;\n      }\n\n      now = timestamp();\n      deltaTime = (now - last) / 1000;\n\n      // Iterate through each item stored in the queue and \"update\" each one.\n      // In some cases, items will be removed from the queue automatically.\n      // In some cases, `update` events will be triggered on loop items, if they are\n      // ready to be externally updated.\n      self.items.forEach((loopItem) => {\n        // Remove if we've set the `doRemoveOnNextTick` flag.\n        if (loopItem.doRemoveOnNextTick) {\n          self.remove(loopItem);\n          return;\n        }\n\n        // Add to elapsedTime\n        if (!loopItem.paused) {\n          loopItem.elapsedTime++;\n        }\n\n        // Check duration\n        if (typeof loopItem.duration === 'number' && loopItem.duration > -1) {\n          if (!loopItem.startTime) {\n            loopItem.startTime = now;\n          }\n\n          if (loopItem.elapsedTime >= loopItem.duration) {\n            loopItem.destroy();\n            return;\n          }\n        }\n\n        // Call the updateCallback, if applicable.\n        let modifiedArgs;\n        if (typeof loopItem.updateCallback === 'function') {\n          // If this item doesn't update on each tick, simply count down.\n          // Otherwise, call the update function\n          if (loopItem.updateDuration && loopItem.updateDuration > 1) {\n            if (isNaN(loopItem.timeUntilNextUpdate)) {\n              loopItem.timeUntilNextUpdate = loopItem.updateDuration;\n            }\n\n            if (loopItem.timeUntilNextUpdate > 0) {\n              --loopItem.timeUntilNextUpdate;\n              return;\n            }\n          }\n\n          // Arguments produced for the updateCallback contain:\n          // [0] the current RenderLoopItem\n          // [1] overall timing values for the RenderLoop\n          modifiedArgs = [loopItem, {\n            last,\n            delta: deltaTime,\n            now\n          }];\n\n          loopItem.updateCallback.apply(null, modifiedArgs);\n        }\n      });\n\n      // Continue the loop\n      last = now;\n      requestAnimationFrame(tick);\n    }\n\n    tick();\n  },\n\n  /**\n   * Stops the entire render loop\n   * @returns {void}\n   */\n  stop() {\n    this.doLoop = false;\n  },\n\n  /**\n   * @returns {number} amount of time that has passed since the RenderLoop was started.\n   */\n  totalDuration() {\n    return timestamp() - this.startTime;\n  },\n\n  /**\n   * External method for getting the callback queue contents\n   * @returns {array} list of internal RenderLoopItems\n   */\n  queue() {\n    return this.items;\n  },\n\n  /**\n   * @private\n   * @param {function} updateCallback - (can also be the \"updateCallback\" function)\n   * @param {function} [timeoutCallback] callback function that gets fired at\n   *  the end of this item's lifecycle\n   * @param {number} [duration] the amount of time in frames that this item should exist\n   * @param {string} [namespace] the namespace for this item\n   * @returns {RenderLoopItem} the item that was registered\n   */\n  buildRenderLoopItem(updateCallback, timeoutCallback, duration, namespace) {\n    let noNamespace = typeof namespace !== 'string' || !namespace.length;\n\n    // valid for a callback not to have a duration, as long as it's\n    // namespaced for future manual removal\n    if (typeof duration === 'string') {\n      if (noNamespace) {\n        namespace = duration;\n        duration = -1;\n        noNamespace = false;\n      } else {\n        const numberDuration = Number(duration);\n        if (!isNaN(numberDuration)) {\n          duration = numberDuration;\n        }\n      }\n    } else if (typeof duration !== 'number') {\n      duration = -1;\n    }\n\n    if (typeof namespace !== 'string' || !namespace.length) {\n      namespace = ''; // TODO: make unique\n    }\n\n    const loopItem = new RenderLoopItem({\n      id: namespace,\n      updateCallback,\n      timeoutCallback,\n      duration\n    });\n\n    return loopItem;\n  },\n\n  /**\n   * @param {RenderLoopItem|function} loopItem - (can also be the \"updateCallback\" function)\n   * @param {function} [timeoutCallback] callback function that gets fired at\n   *  the end of this item's lifecycle\n   * @param {number} [duration] the amount of time in frames that this item should exist\n   * @param {string} [namespace] the namespace for this item\n   * @returns {RenderLoopItem} the item that was registered\n   */\n  register(loopItem, timeoutCallback, duration, namespace) {\n    // If we're not working with a RenderLoopItem off the bat, take arguments\n    // and convert to a RenderLoopItem.  Consider the first argument\n    // to be the \"updateCallback\" function\n    if (!(loopItem instanceof RenderLoopItem)) {\n      loopItem = this.buildRenderLoopItem(loopItem, timeoutCallback, duration, namespace);\n    }\n\n    this.items.push(loopItem);\n\n    return loopItem;\n  },\n\n  /**\n   * @param {function} callback callback function to be unregistered\n   * @param {string} [namespace] namespace to be unregistered\n   * @returns {RenderLoopItem} the item that was unregistered\n   */\n  unregister(callback, namespace) {\n    if (typeof callback !== 'function' && typeof callback !== 'string' && typeof namespace !== 'string') {\n      throw new Error('must provide either a callback function or a namespace string to remove an entry from the RenderLoop queue.');\n    }\n\n    // If callback is defined as a string, simply swap it for the namespace.\n    if (typeof callback === 'string') {\n      namespace = callback;\n      callback = undefined;\n    }\n\n    return this.remove({\n      cb: callback,\n      id: namespace\n    });\n  },\n\n  /**\n   * @private\n   * Uses a callback function, or a defined namespace, to grab a RenderLoop item from the queue.\n   * @param {function} updateCallback callback function to be retrieved\n   * @param {string} [namespace] namespace to be retrieved\n   * @returns {RenderLoopItem} the RenderLoopItem that represents the item that was paused.\n   */\n  getFromQueue(updateCallback, namespace) {\n    // If callback is defined as a string, simply swap it for the namespace.\n    if (typeof callback === 'string') {\n      namespace = updateCallback;\n      updateCallback = undefined;\n    }\n\n    let retreivedItem;\n\n    if (typeof callback === 'function') {\n      // Remove by callback method\n      this.items.forEach((item) => {\n        if (`${item.updateCallback}` !== `${updateCallback}`) {\n          return true;\n        }\n        retreivedItem = item;\n        return false;\n      });\n    } else if (typeof namespace === 'string') {\n      // Remove by namespace\n      this.items.forEach((item) => {\n        if (item.id !== namespace) {\n          return true;\n        }\n        retreivedItem = item;\n        return false;\n      });\n    }\n\n    return retreivedItem;\n  },\n\n  /**\n   * @private\n   * Actually does the removal of a registered callback from the queue\n   * Pulled out into its own function because it can be automatically called by\n   * the tick, or manually triggered from an external API call.\n   * @param {renderLoopItem|Object} obj the renderLoopItem\n   * @returns {RenderLoopItem} reference to the removed renderLoopItem\n   */\n  remove(obj) {\n    let removedItem;\n\n    if (obj instanceof RenderLoopItem) {\n      removedItem = obj;\n      this.items = this.items.filter(item => item !== obj);\n    } else if (typeof obj.updateCallback === 'function') {\n      // Remove by callback method\n      this.items = this.items.filter((item) => {\n        if (`${item.updateCallback}` !== `${obj.updateCallback}`) {\n          return true;\n        }\n        removedItem = item;\n        return false;\n      });\n    } else if (typeof obj.id === 'string') {\n      // Remove by namespace\n      this.items = this.items.filter((item) => {\n        if (item.id !== obj.id) {\n          return true;\n        }\n        removedItem = item;\n        return false;\n      });\n    }\n\n    if (typeof removedItem.timeoutCallback === 'function' && !removedItem.noTimeout) {\n      removedItem.timeoutCallback.apply(null, removedItem);\n    }\n\n    this.element.triggerHandler('remove.renderLoop', [removedItem]);\n\n    // If this is undefined, an item was NOT removed from the queue successfully.\n    return removedItem;\n  },\n\n  /**\n   * @param {function} callback callback function to be paused\n   * @param {string} [namespace] namespace to be paused\n   * @returns {RenderLoopItem} the RenderLoopItem that represents the item that was paused.\n   */\n  pause(callback, namespace) {\n    if (typeof callback !== 'function' && typeof callback !== 'string' && typeof namespace !== 'string') {\n      throw new Error('must provide either a callback function or a namespace string to pause an entry in the RenderLoop queue.');\n    }\n\n    const pausedItem = this.getFromQueue(callback, namespace);\n\n    pausedItem.pause();\n\n    return pausedItem;\n  },\n\n  /**\n   * @param {function} callback callback function to be resumed\n   * @param {string} [namespace] namespace to be resumed\n   * @returns {RenderLoopItem} the RenderLoopItem that represents the item that was resumed.\n   */\n  resume(callback, namespace) {\n    if (typeof callback !== 'function' && typeof callback !== 'string' && typeof namespace !== 'string') {\n      throw new Error('must provide either a callback function or a namespace string to pause an entry in the RenderLoop queue.');\n    }\n\n    const resumableItem = this.getFromQueue(callback, namespace);\n\n    resumableItem.resume();\n\n    return resumableItem;\n  },\n\n};\n\n// Setup a single instance of RenderLoop for export.\nconst renderLoop = new RenderLoop(instanceSettings);\n\nexport { RenderLoopItem, renderLoop };\n","import { color as lightColors } from './theme-soho-colors.json';\nimport { color as darkColors } from './theme-soho-dark-colors.json';\nimport { color as contrastColors } from './theme-soho-contrast-colors.json';\nimport { color as upliftColors } from './theme-uplift-colors.json';\nimport { Locale } from '../../components/locale/locale';\n\n/**\n* The Theme Component is a lightweight wrapper for theme information, which contains the colors\n* that are used on the theme.\n* @class Theme\n*/\nconst theme = {\n\n  /**\n   * Return a list of all the available themes.\n   * @returns {object} The id and name of the theme.\n   */\n  currentTheme: { id: 'light', name: Locale.translate('Light') },\n\n  /**\n   * Return a list of the colors across all themes.\n   * @returns {array} An array with an object for each theme.\n   */\n  allColors: [\n    { id: 'light', colors: lightColors },\n    { id: 'dark', colors: darkColors },\n    { id: 'high-contrast', colors: contrastColors },\n    { id: 'uplift', colors: upliftColors }\n  ],\n\n  /**\n   * Return a list of all the available themes.\n   * @returns {array} The list of themes.\n   */\n  themes: function themes() {\n    return [\n      { id: 'light', name: Locale.translate('LightTheme') },\n      { id: 'dark', name: Locale.translate('DarkTheme') },\n      { id: 'high-contrast', name: Locale.translate('HighContrastTheme') },\n      { id: 'uplift', name: Locale.translate('UpliftTheme') }\n    ];\n  },\n\n  /**\n   * Return the colors used in the current theme.\n   * @param {string} themeId The id of the theme.\n   * @returns {object} An object full of the colors 01-10\n   */\n  themeColors: function themeColors() {\n    const result = this.allColors.filter(color => color.id === this.currentTheme.id);\n    if (!result[0]) {\n      return { palette: { }, colors: { } };\n    }\n\n    return result[0].colors;\n  },\n\n  /**\n   * Return the colors used in the current theme that are reccomended for personalization.\n   * @returns {object} An object full of the colors with id, name abd hex value.\n   */\n  personalizationColors: function themeColors() {\n    const palette = this.themeColors().palette;\n    const personalize = {};\n    personalize.amber = { id: 'amber', name: Locale.translate('Amber'), backgroundColorClass: 'amber09', value: palette.amber['90'].value };\n    personalize.amethyst = { id: 'amethyst', name: Locale.translate('Amethyst'), backgroundColorClass: 'amethyst06', value: palette.amethyst['60'].value };\n    personalize.azure = { id: 'azure', name: Locale.translate('Azure'), backgroundColorClass: 'azure07', value: palette.azure['70'].value };\n    personalize.emerald = { id: 'emerald', name: Locale.translate('Emerald'), backgroundColorClass: 'emerald08', value: palette.emerald['80'].value };\n    personalize.graphite = { id: 'graphite', name: Locale.translate('Graphite'), backgroundColorClass: 'graphite06', value: palette.graphite['60'].value };\n    personalize.ruby = { id: 'ruby', name: Locale.translate('Ruby'), backgroundColorClass: 'amber09', value: palette.ruby['90'].value };\n    personalize.slate = { id: 'slate', name: Locale.translate('Slate'), backgroundColorClass: 'slate06', value: palette.slate['60'].value };\n    personalize.turquoise = { id: 'turquoise', name: Locale.translate('Turquoise'), backgroundColorClass: 'turquoise06', value: palette.turquoise['60'].value };\n\n    return personalize;\n  },\n\n  /**\n   * Set the current application theme.\n   * @param {string} themeId The id of the theme.\n   * @returns {[type]} [description]\n   */\n  setTheme: function setTheme(themeId) {\n    const result = this.themes().filter(themeObj => themeObj.id === themeId);\n    if (result.length === 0) {\n      return '';\n    }\n    this.currentTheme = result[0];\n    return result;\n  }\n};\n\nexport { theme };\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { theme } from '../theme/theme';\n\n// Component name as referenced by jQuery/event namespace/etc\nconst COMPONENT_NAME = 'personalize';\n\n// Component Defaults\nconst PERSONALIZE_DEFAULTS = {\n  colors: '',\n  theme: '',\n  font: '',\n  blockUI: true\n};\n\n/**\n * The personalization routines for setting custom company colors.\n *\n * @class Personalize\n * @param {HTMLElement|jQuery[]} element The base element\n * @param {object} [settings] Incoming settings\n * @param {string} [settings.colors]  The list of colors\n * @param {string} [settings.theme='light'] The theme name (light, dark or high-contrast)\n * @param {string} [settings.font='Helvetica'] Use the newer source sans font\n * @param {boolean} [settings.blockUI=true] Cover the UI and animate when changing theme.\n*/\nfunction Personalize(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, PERSONALIZE_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nPersonalize.prototype = {\n\n  /**\n   * Runs on each initialization\n   * @private\n   * @returns {this} component instance\n   */\n  init() {\n    // Set the default theme, or grab the theme from an external CSS stylesheet.\n    const cssTheme = this.getThemeFromStylesheet();\n    this.currentTheme = this.settings.theme || cssTheme;\n    this.setTheme(this.currentTheme);\n\n    if (this.settings.colors) {\n      this.setColors(this.settings.colors);\n    }\n\n    if (this.settings.font) {\n      $('html').addClass(`font-${this.settings.font}`);\n    }\n\n    this.handleEvents();\n\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this control and its sub-elements\n   * @private\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element\n      .off(`updated.${COMPONENT_NAME}`)\n      .on(`updated.${COMPONENT_NAME}`, () => {\n        self.updated();\n      })\n      .off(`changecolors.${COMPONENT_NAME}`)\n      .on(`changecolors.${COMPONENT_NAME}`, (e, newColor, noAnimate) => {\n        self.setColors(newColor, noAnimate);\n      })\n      .off(`changetheme.${COMPONENT_NAME}`)\n      .on(`changetheme.${COMPONENT_NAME}`, (e, thisTheme) => {\n        self.setTheme(thisTheme);\n      });\n\n    return this;\n  },\n\n  /**\n   * Validates a string containing a hexadecimal number\n   * @private\n   * @param {string} hex A hex color.\n   * @returns {string} a validated hexadecimal string.\n   */\n  validateHex(hex) {\n    hex = String(hex).replace(/[^0-9a-f]/gi, '');\n\n    if (hex.length < 6) {\n      hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n    }\n\n    return `#${hex}`;\n  },\n\n  /**\n   * Create new CSS rules in head and override any existing\n   * @private\n   * @param {object} cssRules The rules to append.\n   */\n  appendStyleSheet(cssRules) {\n    let sheet = document.getElementById('soho-personalization');\n    if (sheet) {\n      sheet.parentNode.removeChild(sheet);\n    }\n\n    // Create the <style> tag\n    sheet = document.createElement('style');\n    sheet.setAttribute('id', 'soho-personalization');\n    sheet.appendChild(document.createTextNode(cssRules));\n\n    // Add the <style> element to the page\n    document.head.appendChild(sheet);\n  },\n\n  /**\n   * Generate a style sheet to append in the page.\n   * @private\n   * @param {array} colors The rules to append.\n   * @returns {string} The string of css to append.\n   */\n  getColorStyleSheet(colors) {\n    if (!colors) {\n      colors = {};\n    }\n\n    // Use an incoming `colors` param defined as a string, as the desired\n    // \"header\" color (backwards compatibility)\n    if (typeof colors === 'string') {\n      colors = {\n        header: colors\n      };\n    }\n\n    if (!colors || colors === '') {\n      return this;\n    }\n\n    // Default Colors...\n    // (Color)07 for the main color (fx headers)\n    // (Color)06 for the secondary color (fx sub-headers)\n    // Light or Dark (fff or 000) for the contrast color\n\n    // (Color)06 for the vertical borders between module tabs - 133C59\n    // (Color)07 for the page header and active module tab - 2578A9 DEFAULT\n    // (Color)08 for the inactive module tab - 1d5f8a\n    // (Color)09 for the horizontal border - 134D71\n    // (Color)10 for the hover state on module tab - 133C59\n    const defaultColors = {\n      header: '2578A9',\n      subheader: '1d5f8a',\n      text: 'ffffff',\n      verticalBorder: '133C59',\n      horizontalBorder: '134D71',\n      inactive: '1d5f8a',\n      hover: '133C59',\n      btnColorHeader: '368AC0',\n      btnColorSubheader: '54a1d3'\n    };\n\n    // If an event sends a blank string through instead of a hex,\n    // reset any color values back to the theme defaults.  Otherwise, get a valid hex value.\n    colors.header = this.validateHex(colors.header || defaultColors.header);\n    colors.text = this.validateHex(colors.text || defaultColors.text);\n    colors.subheader = this.validateHex(colors.subheader ||\n      this.getLuminousColorShade(colors.header, 0.2));\n    colors.button = this.validateHex(colors.button ||\n      this.getLuminousColorShade(colors.text, -0.80));\n    colors.inactive = this.validateHex(colors.inactive ||\n      this.getLuminousColorShade(colors.header, -0.22));\n    colors.verticalBorder = this.validateHex(colors.verticalBorder ||\n      this.getLuminousColorShade(colors.header, 0.1));\n    colors.horizontalBorder = this.validateHex(colors.horizontalBorder ||\n      this.getLuminousColorShade(colors.header, -0.4));\n    colors.hover = this.validateHex(colors.hover ||\n      this.getLuminousColorShade(colors.header, -0.5));\n    colors.btnColorHeader = this.validateHex(colors.btnColorHeader ||\n      this.getLuminousColorShade(colors.subheader, -0.025));\n    colors.btnColorSubheader = this.validateHex(colors.btnColorSubheader ||\n      this.getLuminousColorShade(colors.header, -0.025));\n\n    // note that the sheet is appended in backwards\n    let cssRules = `.tab-container.module-tabs.is-personalizable { border-top: 1px solid ${colors.horizontalBorder} !important; border-bottom: 1px solid ${colors.horizontalBorder} !important}` +\n    ` .module-tabs.is-personalizable .tab:not(:first-child) { border-left: 1px solid ${colors.verticalBorder} !important}` +\n    ` .module-tabs.is-personalizable { background-color: ${colors.inactive} !important}` +\n    ` .module-tabs.is-personalizable .tab.is-selected { background-color: ${colors.header} !important}` +\n    ` .accordion.panel .accordion-header.is-selected { background-color: ${colors.subheader} !important; color: ${colors.text} !important}` +\n    ` .builder-header.is-personalizable{ background-color: ${colors.subheader}}` +\n    ` .header.is-personalizable { background-color: ${colors.header}}` +\n    ` .header.is-personalizable .title { color: ${colors.text}}` +\n    ` .header.is-personalizable h1 { color: ${colors.text}}` +\n    ` .header.is-personalizable button:not(:disabled), .header.is-personalizable button:not(:disabled) .icon, .header.is-personalizable button:not(:disabled) .app-header.icon > span { color: ${colors.text} !important; opacity: .8}` +\n    ` .header.is-personalizable .header.is-personalizable button:not(:disabled) .app-header.icon > span { background-color: ${colors.text} !important; opacity: .8}` +\n    ` .header.is-personalizable button:not(:disabled):hover, .header.is-personalizable button:not(:disabled):hover .icon, .header.is-personalizable button:not(:disabled):hover .app-header.icon > span, .header.is-personalizable .toolbar [class^='btn']:hover:not([disabled]) { color: ${colors.text} !important; opacity: 1}` +\n    ` .header.is-personalizable button:not(:disabled) .app-header.icon > span { background-color: ${colors.text} !important; opacity: 1}` +\n    ` .header.is-personalizable .go-button.is-personalizable { background-color: ${colors.btnColorHeader}; border-color:${colors.btnColorHeader};color: ${colors.text}}` +\n    ` .header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab.is-selected:not(.is-disabled) { color: ${colors.text} !important }` +\n    ` .header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab { color: ${colors.text} !important; opacity: .8 }` +\n    ` .header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab:hover:not(.is-disabled) { color: ${colors.text} !important; opacity: 1 }` +\n    ` .header.is-personalizable.has-tabs .tab-container.header-tabs > .tab-list-container .tab:hover:not(.is-disabled)::before { background-color: ${colors.text}}` +\n    ` .header.is-personalizable.has-tabs .animated-bar { background-color: ${colors.text}}` +\n    ` .header.is-personalizable.has-tabs .tab-list-container .tab.is-selected:not(.is-disabled):hover::before { background-color: ${colors.text} !important }` +\n    ` .subheader.is-personalizable .go-button.is-personalizable { background-color: ${colors.btnColorSubheader}; border-color:${colors.btnColorSubheader};color: ${colors.text}}` +\n    ` .module-tabs.is-personalizable .tab-more { border-left: ${colors.verticalBorder} !important}` +\n    ` .module-tabs.is-personalizable .tab-more:hover { background-color: ${colors.hover} !important}` +\n    ` .module-tabs.is-personalizable .tab-more.is-open { background-color: ${colors.hover} !important}` +\n    ` .module-tabs.is-personalizable .tab-more.is-selected { background-color: ${colors.header} !important}` +\n    ` .header .toolbar > .toolbar-searchfield-wrapper.active .searchfield { background-color: ${colors.hover} !important; border-bottom-color: ${colors.hover} !important}` +\n    ` .header .toolbar > .toolbar-searchfield-wrapper.active .searchfield-category-button { background-color: ${colors.hover} !important; border-bottom-color: ${colors.hover} !important}` +\n    ` .subheader.is-personalizable { background-color: ${colors.subheader} !important}` +\n    ` .builder .sidebar .header {border-right: 1px solid ${colors.hover} !important}` +\n    ` .module-tabs.is-personalizable .tab:hover { background-color: ${colors.hover} !important}` +\n    ` .module-tabs.has-toolbar.is-personalizable .tab-list-container + .toolbar { border-left: ${colors.verticalBorder} !important}` +\n    ` .module-tabs.is-personalizable [class^=\"btn\"] { background-color: ${colors.inactive} !important; color: ${colors.text} !important}` +\n    ` .module-tabs.is-personalizable .tab.is-disabled { background-color: ${colors.inactive} !important; color: ${colors.text} !important}` +\n    ` .module-tabs.is-personalizable .tab.is-disabled > svg { fill: ${colors.text} !important}` +\n    ` .module-tabs.is-personalizable .add-tab-button { border-left: ${colors.verticalBorder} !important}` +\n    ` .module-tabs.is-personalizable .add-tab-button:hover { background-color: ${colors.inactive} !important}` +\n    ` .module-tabs.is-personalizable .toolbar-searchfield-wrapper > .searchfield { color: ${colors.text} !important}` +\n    ` .module-tabs.is-personalizable .toolbar-searchfield-wrapper > svg { fill: ${colors.text} !important}` +\n    ` .is-personalizable .tab-container.header-tabs::before { background-image: linear-gradient(to right, ${colors.header}, rgba(37, 120, 169, 0)) }` +\n    ` .is-personalizable .tab-container.header-tabs::after { background-image: linear-gradient(to right, rgba(37, 120, 169, 0), ${colors.header}) }` +\n    ` .hero-widget.is-personalizable { background-color: ${colors.subheader} }` +\n    ` .hero-widget.is-personalizable .hero-bottom { background-color: ${colors.header} }` +\n    ` .hero-widget.is-personalizable .hero-footer .hero-footer-nav li::before { color: ${colors.verticalBorder} }` +\n    ` .hero-widget.is-personalizable .chart-container .arc { stroke: ${colors.subheader} }` +\n    ` .hero-widget.is-personalizable .chart-container .bar { stroke: ${colors.subheader} }` +\n    ` .hero-widget.is-personalizable .chart-container.line-chart .dot { stroke: ${colors.subheader} }` +\n    ` .application-menu.is-personalizable { border-right: ${colors.verticalBorder} }` +\n    ` .application-menu.is-personalizable .application-menu-header { background-color: ${colors.subheader}; border-bottom-color: ${colors.verticalBorder} }` +\n    ` .application-menu.is-personalizable .application-menu-footer { background-color: ${colors.subheader}; border-top-color: ${colors.verticalBorder} }` +\n    ` .application-menu.is-personalizable button .icon, .application-menu.is-personalizable button span, .application-menu.is-personalizable .hyperlink { color: ${colors.text}; opacity: 0.8 }` +\n    ` .application-menu.is-personalizable button:not(:disabled):hover .icon, .application-menu.is-personalizable button:not(:disabled):hover span, .application-menu.is-personalizable .hyperlink:hover  { color: ${colors.text}; opacity: 1 }` +\n    ` .application-menu.is-personalizable .accordion.panel { background-color: ${colors.header} }` +\n    ` .application-menu.is-personalizable .name-xl, .application-menu.is-personalizable .name, .application-menu.is-personalizable .accordion-heading { color: ${colors.text} }` +\n    ` .application-menu.is-personalizable .accordion.panel .accordion-header { background-color: ${colors.header}; border-bottom-color: transparent; color: ${colors.text}; opacity: .8; }` +\n    ` .application-menu.is-personalizable .accordion.panel .accordion-header .icon { color: ${colors.text} !important; }` +\n    ` .application-menu.is-personalizable .accordion.panel .accordion-header.is-selected > a, .application-menu.is-personalizable .accordion.panel .accordion-header.is-selected:hover > a, .application-menu.is-personalizable .accordion.panel .accordion-header.is-selected > a, .application-menu.is-personalizable .accordion.panel .accordion-header.is-selected .icon { color: ${colors.text} !important; }` +\n    ' .application-menu.is-personalizable .accordion.panel .accordion-header:hover { opacity: 1 }' +\n    ` .application-menu.is-personalizable .accordion.panel .accordion-header.is-focused:not(.hide-focus) { border-color: ${colors.text}; opacity: 1; box-shadow: 0 0 4px 3px rgba(0, 0, 0, 0.2); }` +\n    ` .accordion.panel.inverse .accordion-pane.is-expanded + .accordion-header:not(.is-focused):not(.is-selected), .accordion.panel.inverse .accordion-pane.is-expanded + .accordion-content { border-color: ${colors.verticalBorder};}` +\n    ` .application-menu.is-personalizable button:focus:not(.hide-focus), .application-menu.is-personalizable .hyperlink:focus:not(.hide-focus)::after { border-color: ${colors.text}; opacity: 1; box-shadow: 0 0 4px 3px rgba(0, 0, 0, 0.2) }` +\n    ` .application-menu.is-personalizable .application-menu-switcher-panel { border-top-color: ${colors.horizontalBorder} }` +\n    ` .application-menu.is-personalizable .application-menu-switcher-panel .accordion-heading { border-top-color: ${colors.horizontalBorder} }` +\n    ` .application-menu.is-personalizable .searchfield-wrapper { background-color: ${colors.header}; border-bottom: 1px solid ${colors.horizontalBorder} }` +\n    ` .application-menu.is-personalizable .searchfield-wrapper .searchfield { color: ${colors.text} !important }` +\n    ` .application-menu.is-personalizable .accordion-header.has-filtered-children > a, .application-menu.is-personalizable .accordion.panel .accordion-header.has-filtered-children.is-focused { color: ${colors.text} !important }` +\n    ` .application-menu.is-personalizable .searchfield-wrapper .searchfield::placeholder { color: ${colors.text}; opacity: .8 }` +\n    ` .application-menu.is-personalizable .searchfield-wrapper .icon { color: ${colors.text}; opacity: .8 }` +\n    ` .application-menu.is-personalizable .searchfield-wrapper.active .icon { color: ${colors.text}; opacity: 1 }` +\n    '';\n\n    // Add reusable classes that can be used on some elements\n    cssRules += `.is-personalizable .personalize-header { background-color: ${colors.header} }` +\n      `.is-personalizable .personalize-subheader { background-color: ${colors.subheader} }` +\n      `.is-personalizable .personalize-text { color: ${colors.text} }` +\n      `.is-personalizable .personalize-actionable { color: ${colors.text}; opacity: .8 }` +\n      `.is-personalizable .personalize-actionable:hover:not([disabled]) { color: ${colors.text}; opacity: 1 }` +\n      `.is-personalizable .personalize-actionable.is-focused:not(.hide-focus), .is-personalizable .personalize-actionable:focus:not(.hide-focus) { border-color: ${colors.text}; box-shadow: 0 0 4px 3px rgba(0, 0, 0, 0.2); }` +\n      `.is-personalizable .personalize-actionable.hyperlink:focus:not(.hide-focus)::after { border-color: ${colors.text}; opacity: 1; box-shadow: 0 0 4px 3px rgba(0, 0, 0, 0.2); }` +\n      `.is-personalizable .personalize-vertical-border { border-color: ${colors.verticalBorder}; }` +\n      `.is-personalizable .personalize-horizontal-bottom-border { border-bottom: 1px solid ${colors.horizontalBorder}; }` +\n      `.is-personalizable .personalize-horizontal-top-border { border-top: 1px solid: ${colors.horizontalBorder}; }` +\n      '.is-personalizable .personalize-actionable-disabled, .is-personalizable .personalize-actionable-disabled:hover { opacity: .4 !important; cursor: default; }' +\n    '';\n\n    return cssRules;\n  },\n\n  /**\n  * Sets the personalization color(s)\n  * @param {array} colors The original hex color as a string or an object with all the Colors\n  * @returns {this} component instance\n  */\n  setColors(colors) {\n    if (!colors) {\n      return this;\n    }\n\n    this.appendStyleSheet(this.getColorStyleSheet(colors));\n\n    // record state of colors in settings\n    this.settings.colors = colors;\n\n    /**\n    * Fires after the colors are changed.\n    * @event colorschanged\n    * @memberof Personalize\n    * @property {object} event - The jquery event object\n    * @property {object} args - The event args\n    * @property {string} args.colors - The color(s) changed to.\n    */\n    this.element.triggerHandler('colorschanged', { colors });\n    return this;\n  },\n\n  /**\n  * Takes a color and performs a change in luminosity of that color programatically.\n  * @private\n  * @param {string} hex  The original Hexadecimal base color.\n  * @param {string} lum  A percentage used to set luminosity\n  * change on the base color:  -0.1 would be 10% darker, 0.2 would be 20% brighter\n  * @returns {string} hexadecimal color.\n  */\n  getLuminousColorShade(hex, lum) {\n    // validate hex string\n    hex = this.validateHex(hex).substr(1);\n    lum = lum || 0;\n\n    // convert to decimal and change luminosity\n    let rgb = '#';\n    let c;\n    let i;\n\n    for (i = 0; i < 3; i++) {\n      c = parseInt(hex.substr(i * 2, 2), 16);\n      c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\n      rgb += (`00${c}`).substr(c.length);\n    }\n\n    return rgb;\n  },\n\n  /**\n   * Detect the current theme based on the style sheet.\n   * @private\n   * @returns {string} The current theme.\n   */\n  getThemeFromStylesheet() {\n    const css = $('#stylesheet, #sohoxi-stylesheet');\n    let thisTheme = '';\n\n    if (css.length > 0) {\n      const path = css.attr('href');\n      thisTheme = path.substring(path.lastIndexOf('/') + 1);\n      // trim query string off the end if it exists\n      // something like ?v=123 may be used for cache busting or build identifiers\n      const queryParamIndex = thisTheme.lastIndexOf('?');\n      if (queryParamIndex > -1) {\n        thisTheme = thisTheme.slice(0, queryParamIndex);\n      }\n      // trim the file extensions off the end and drop the -theme portion\n      thisTheme = thisTheme.replace('.min.css', '').replace('.css', '').replace('-theme', '');\n    }\n    return thisTheme;\n  },\n\n  /**\n  * Sets the current theme, blocking the ui during the change.\n  * @param {string} incomingTheme  Represents the file name of a color\n  * scheme (can be dark, light or high-contrast)\n  */\n  setTheme(incomingTheme) {\n    if (theme.currentTheme.id === incomingTheme) {\n      if (!$('html').hasClass(`${incomingTheme}-theme`)) {\n        $('html').addClass(`${incomingTheme}-theme`);\n      }\n      return;\n    }\n\n    // Validate theme is supported\n    const result = theme.themes().filter(themeObj => themeObj.id === incomingTheme);\n    if (result.length === 0) {\n      return;\n    }\n\n    $('html').removeClass('light-theme dark-theme high-contrast-theme').addClass(`${incomingTheme}-theme`);\n\n    this.blockUi();\n\n    const self = this;\n    const originalCss = $('#stylesheet, #sohoxi-stylesheet');\n    const newCss = $('<link rel=\"stylesheet\">');\n    const path = originalCss.attr('href');\n\n    newCss.on('load', () => {\n      originalCss.remove();\n      self.unBlockUi();\n    });\n\n    const themePath = path ? path.substring(0, path.lastIndexOf('/')) : '';\n    const isMin = path ? path.indexOf('.min') > -1 : false;\n\n    newCss.attr({\n      id: originalCss.attr('id'),\n      href: xssUtils.stripTags(`${themePath}/${incomingTheme}-theme${isMin ? '.min' : ''}.css`)\n    });\n    originalCss.removeAttr('id');\n\n    // Add new stylesheet before current stylesheet\n    // to give it time to parse/render before revealing it\n    originalCss.before(newCss);\n\n    // record state of theme in settings\n    this.settings.theme = incomingTheme;\n    theme.setTheme(incomingTheme);\n\n    /**\n    * Fires after the theme is changed\n    * @event themechanged\n    * @memberof Personalize\n    * @property {object} event - The jquery event object\n    * @property {object} args - The event args\n    * @property {string} args.theme - The theme id changed to.\n    */\n    this.element.triggerHandler('themechanged', { theme: incomingTheme });\n  },\n\n  /**\n   * Builds a temporary page overlay that prevents end users from experiencing FOUC\n   * @private\n   * @returns {void}\n   */\n  blockUi() {\n    const self = this;\n    if (!self.settings.blockUI) {\n      return;\n    }\n\n    let backgroundColor = '#bdbdbd';\n    switch (theme) {\n      case 'light':\n        backgroundColor = '#f0f0f0';\n        break;\n      case 'dark':\n        backgroundColor = '#313236';\n        break;\n      case 'high-contrast':\n        backgroundColor = '#d8d8d8';\n        break;\n      default:\n        backgroundColor = '#f0f0f0';\n    }\n\n    this.pageOverlay = this.pageOverlay || $('<div class=\"personalize-overlay\"></div>');\n    this.pageOverlay.css('background', backgroundColor);\n    $('body').append(this.pageOverlay);\n  },\n\n  /**\n   * Removes a temporary page overlay built by `blockUi()`\n   * @private\n   * @returns {void}\n   */\n  unBlockUi() {\n    const self = this;\n    if (!self.settings.blockUI) {\n      return;\n    }\n\n    self.pageOverlay.fadeOut(300, () => {\n      self.pageOverlay.remove();\n      self.pageOverlay = undefined;\n    });\n  },\n\n  /**\n   * Handle Updating Settings\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * Ideally this will do non-destructive things that make it possible to easily rebuild\n   * @private\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Personalize, COMPONENT_NAME };\n","import { Personalize, COMPONENT_NAME } from './personalize';\n\n/**\n * Setup a single instance of the Personalization system on the HTML tag.\n * Personalization is top-level.\n */\nconst personalization = new Personalize(document.documentElement, {\n  theme: 'light'\n});\n\nexport { personalization, COMPONENT_NAME };\n","import { personalization, COMPONENT_NAME } from './personalize.bootstrap';\n\n/**\n * jQuery Component Wrapper for Personalize\n * NOTE: One instance of the Personalzation system can exist at any time, and is applied\n * to the <body> tag. When an app developer calls this directly, it's assumed that the\n * personalization system has already been established (during bootstrapping) and simply\n * needs to be updated with current settings.\n * @param {object} [settings] incoming Settings\n * @returns {jQuery[]} elements to be acted on\n */\n$.fn.personalize = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (!instance) {\n      instance = $.data(this, COMPONENT_NAME, personalization);\n    }\n    instance.updated(settings);\n  });\n};\n","// ====================================================\n// Soho Form/Element Utilities\n// ====================================================\n\n// Note marked these private so the doc generator doesnt work on them.\n// These should be refactored into an ES6 FormUtils component.\n\n/*\n * Make elements in the jQuery selector disabled if they support the prop disabled.\n * Or has a disable method.\n * @private\n * @returns {jQuery[]} processed, jQuery-wrapped elements\n */\n$.fn.disable = function () {\n  $.each(this.data(), (index, value) => {\n    if (value instanceof jQuery) {\n      return;\n    }\n\n    if (value && value.disable) {\n      value.disable();\n    }\n  });\n  this.prop('disabled', true);\n  return this;\n};\n\n/*\n * Make elements in the jQuery selector enabled if they support the prop disabled.\n * Or has a enable method.\n * @private\n * @returns {jQuery[]} processed, jQuery-wrapped elements\n */\n$.fn.enable = function () {\n  $.each(this.data(), (index, value) => {\n    if (value instanceof jQuery) {\n      return;\n    }\n\n    if (value && value.enable) {\n      value.enable();\n    }\n  });\n  this.prop({ disabled: false, readonly: false });\n  return this;\n};\n\n/*\n * Make elements in the jQuery selector readonly if they support the prop readonly.\n * Or has a readonly method.\n * @private\n * @returns {jQuery[]} processed, jQuery-wrapped elements\n */\n$.fn.readonly = function () {\n  $.each(this.data(), (index, value) => {\n    if (value instanceof jQuery) {\n      return;\n    }\n\n    if (value && value.readonly) {\n      value.readonly();\n    }\n  });\n  this.prop('readonly', true);\n  return this;\n};\n\n// Fix: Labels without the \"for\" attribute\n$(() => {\n  let str;\n  let control;\n  const labelText = $('.label-text');\n  const labels = labelText.closest('label, .label');\n\n  labels.each(function () {\n    control = $('input, textarea, select', this);\n    str = control.attr('class');\n\n    $(this).addClass(() =>\n      // Add \"inline\" and \"inline-{control}\" class to label\n      // assuming control class is first thing in class string\n      `inline${str ? ` inline-${str.indexOf(' ') === -1 ? str : str.substr(0, str.indexOf(' '))}` : ''}`);\n  });\n});\n\n// Fix: Radio buttons was not selecting when click and than use arrow keys on Firefox\n$(() => {\n  $('input:radio').on('click.radios', function () {\n    this.focus();\n  });\n});\n\n// Add css classes to parent for apply special rules\n$(() => {\n  const addCssClassToParent = function (elemArray, cssClass) {\n    for (let i = 0, l = elemArray.length; i < l; i++) {\n      $(elemArray[i]).parent().addClass(cssClass);\n    }\n  };\n  addCssClassToParent($('.field > input:checkbox, .field > .inline-checkbox'), 'field-checkbox');\n  addCssClassToParent($('.field > input:radio, .field > .inline-radio'), 'field-radio');\n});\n\n$(() => {\n  // Add `*` to required labels\n  const selector = 'label.required .label-text, .label.required .label-text, label:not(.inline).required, .label:not(.inline).required';\n  const labels = [].slice.call(document.body.querySelectorAll(selector));\n  labels.forEach((label) => {\n    const asterisk = label.querySelector('.required-asterisk');\n    if (!asterisk) {\n      label.insertAdjacentHTML('beforeend', '<span class=\"required-asterisk\" aria-hidden=\"true\">*</span>');\n    }\n  });\n\n  // Add `aria-required` to required elements\n  let elements = [].slice.call(document.body.querySelectorAll('[data-validate]'));\n  elements.forEach((el) => {\n    const rules = el.getAttribute('data-validate');\n    if (rules && rules.indexOf('required') > -1) {\n      el.setAttribute('aria-required', true);\n    }\n  });\n\n  // Add `aria-hidden` to hidden elements label\n  elements = [].slice.call(document.body.querySelectorAll('input[type=\"hidden\"]'));\n  elements.forEach((el) => {\n    const id = el.getAttribute('id');\n    if (id) {\n      const label = document.body.querySelector(`label[for=\"${id}\"]`);\n      if (label) {\n        label.setAttribute('aria-hidden', true);\n      }\n    }\n  });\n});\n","// Text Highlight/Unhighlight Control\n// Originally called \"highlight v5\" by Johann Burkard\n// http://johannburkard.de/blog/programming/javascript/highlight-javascript-text-higlighting-jquery-plugin.html\n//\n// Modified for IDS Enterprise (TODO: bit.ly link to docs)\n\nfunction innerHighlight(node, pat) {\n  let skip = 0;\n  let pos;\n  let spannode;\n  let middlebit;\n  let middleclone;\n\n  if (node.nodeType === 3) {\n    pos = node.data.toUpperCase().indexOf(pat);\n    pos -= (node.data.substr(0, pos).toUpperCase().length - node.data.substr(0, pos).length);\n\n    if (pos >= 0) {\n      spannode = document.createElement('mark');\n      spannode.className = 'highlight';\n      middlebit = node.splitText(pos);\n      middlebit.splitText(pat.length);\n      middleclone = middlebit.cloneNode(true);\n      spannode.appendChild(middleclone);\n      middlebit.parentNode.replaceChild(spannode, middlebit);\n      skip = 1;\n    }\n  } else if (node.nodeType === 1 && node.childNodes && !/(script|style)/i.test(node.tagName)) {\n    for (let i = 0; i < node.childNodes.length; ++i) {\n      i += innerHighlight(node.childNodes[i], pat);\n    }\n  }\n\n  return skip;\n}\n\n/**\n * Highlight a portion of text inside an element\n * @param {string} pat portion of text that's being highlighted\n * @returns {this} this\n */\n$.fn.highlight = function (pat) {\n  if (this.length && pat && pat.length) {\n    return this.each(function () {\n      innerHighlight(this, pat.toUpperCase());\n    });\n  }\n  return this;\n};\n\n/**\n * Removes highlighting from portions of text inside an element\n * @returns {this} this\n */\n$.fn.unhighlight = function () {\n  return this.find('mark.highlight').each(function () {\n    const node = this.parentNode;\n    node.replaceChild(this.firstChild, this);\n    node.normalize();\n  }).end();\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\n\n// Component Name\nconst COMPONENT_NAME = 'arrange';\n\n/**\n* The Arrange Component allows touch and drag support to sort UI items.\n* @class Arrange\n* @constructor\n*\n* @param {jQuery[]|HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n* @param {string} [settings.handle] The CSS class name of the handle element to connect\n* @param {string} [settings.itemsSelector] The CSS selector to match all the sortable elements.\n* @param {string} [settings.connectWith] Optional CSS Selector to connect with when using two lists\n* @param {boolean} [settings.isVisualItems] Use only index of visual items to trigger\n* @param {string} [settings.placeholder] The html for the element that appears while dragging\n* @param {string} [settings.placeholderCssClass='arrange-placeholder'] The class to add to the ghost element that is being dragged.\n*/\nconst ARRANGE_DEFAULTS = {\n  handle: null, // The Class of the handle element\n  itemsSelector: null,\n  connectWith: false,\n  isVisualItems: false,\n  placeholder: null,\n  placeholderCssClass: 'arrange-placeholder'\n};\n\nfunction Arrange(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, ARRANGE_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Arrange Methods\nArrange.prototype = {\n\n  // example from: https://github.com/farhadi/html5arrangeable/blob/master/jquery.arrangeable.js\n  init() {\n    this.isTouch = env.features.touch;\n    this.isIe = env.browser.name === 'ie';\n    this.handleEvents();\n  },\n\n  /**\n   * Get Element By Touch In List\n   * @private\n   * @param {object} list element.\n   * @param {number} x value.\n   * @param {number} y value.\n   * @returns {object} item found in list\n   */\n  getElementByTouchInList(list, x, y) {\n    let returns = false;\n    const listJq = $(list);\n\n    for (let i = 0, l = listJq.length; i < l; i++) {\n      const item = $(listJq[i]);\n      const offset = item.offset();\n\n      if (!(x <= offset.left || x >= offset.left + item.outerWidth() ||\n            y <= offset.top || y >= offset.top + item.outerHeight())) {\n        returns = item;\n      }\n    }\n    return returns;\n  },\n\n  /**\n   * Dragg touch element\n   * @private\n   * @param {object} e as event.\n   * @param {object} elm as element.\n   * @returns {void}\n   */\n  dragTouchElement(e, elm) {\n    const orig = e.originalEvent.changedTouches[0];\n    elm[0].style.top = `${(orig.pageY - this.offset.y)}px`;\n    elm[0].style.left = `${(orig.pageX - this.offset.x)}px`;\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.items\n      .removeClass('draggable')\n      .removeAttr('draggable')\n      .off(`selectstart.arrange ${this.dragStart} ${this.dragEnd} ${this.dragWhileDragging}`);\n\n    $(this.handle, this.items)\n      .removeClass('draggable')\n      .off('mousedown.arrange mouseup.arrange touchstart.arrange touchend.arrange');\n\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, ARRANGE_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n  * Teardown process for this plugin\n  * @returns {void}\n  */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Find out the visual index to trigger\n   * @private\n   * @param {object} elem to get index number.\n   * @returns {number} the index\n   */\n  getVisualIndex(elem) {\n    const s = this.settings;\n    let idx = null;\n\n    if (s.isVisualItems) {\n      let items = this.element.children().not('[data-arrange-exclude=\"true\"]');\n      if (s.itemsSelector) {\n        items = $(s.itemsSelector, this.element).not('[data-arrange-exclude=\"true\"]');\n      }\n      idx = items.index(elem);\n    }\n\n    return idx;\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const s = this.settings;\n\n    let index;\n    let isHandle;\n    const status = {};\n    let items = this.element.children().not('[data-arrange-exclude=\"true\"]');\n    let placeholder = $(`<${(/^(ul|ol)$/i.test(this.element[0].tagName) ? 'li' : 'div')}>`);\n\n    if (s.itemsSelector) {\n      items = $(s.itemsSelector, this.element).not('[data-arrange-exclude=\"true\"]');\n      placeholder = $(`<${items.first()[0].tagName} />`);\n    }\n\n    if (s.placeholder) {\n      placeholder = $(s.placeholder);\n    }\n\n    this.dragStart = 'dragstart.arrange touchstart.arrange gesturestart.arrange';\n    this.dragEnd = 'dragend.arrange touchend.arrange touchcancel.arrange gestureend.arrange';\n    this.dragWhileDragging = 'dragover.arrange dragenter.arrange drop.arrange touchmove.arrange gesturechange.arrange';\n\n    this.handle = s.handle || this.element.attr('data-arrange-handle');\n    this.connectWith = this.element.attr('data-arrange-connectWith');\n    this.placeholders = placeholder;\n\n    if (!this.isTouch) {\n      this.placeholders.addClass(`${s.placeholderCssClass} draggable`);\n    }\n\n    // Use Handle if available\n    $(this.handle, items).addClass('draggable')\n      .on('mousedown.arrange touchstart.arrange', () => {\n        isHandle = true;\n      })\n      .on('mouseup.arrange touchend.arrange', () => {\n        isHandle = false;\n      });\n\n    // Add connect with\n    if (this.connectWith) {\n      items = items\n        .add($(this.connectWith).children().not('[data-arrange-exclude=\"true\"]'))\n        .data('connectWith', this.connectWith);\n    }\n\n    this.items = items;\n\n    // Draggable Items\n    this.items\n      .attr('draggable', true).addClass(this.handle ? '' : 'draggable')\n      .add([this, placeholder])\n      .not('a[href], img')\n      .on('selectstart.arrange', function () {\n        if (this.dragDrop) {\n          this.dragDrop();// ie9\n        }\n        return this.isIe;\n      })\n      .end()\n\n      .each(function () {\n        $(this)\n        // Drag start --------------------------------------------------------------------------\n          .on(self.dragStart, function (e) {\n            if (self.handle && !isHandle) {\n              if (self.isTouch) {\n                return;\n              }\n              return false;// eslint-disable-line\n            }\n            isHandle = false;\n            self.dragging = $(this);\n\n            index = self.dragging.addClass('arrange-dragging').index();\n            const idx = s.isVisualItems ?\n              self.getVisualIndex(self.dragging) : index;\n\n            $.extend(status, { start: self.dragging, startIndex: idx });\n\n            /**\n            * Fires before moving an element allowing you to access the ui to\n             customize the draggable item.\n            *\n            * @event beforearrange\n            * @memberof Arrange\n            * @property {object} event - The jquery event object\n            * @property {object} status - Status for this item\n            */\n            const result = self.element.triggerHandler('beforearrange', status);\n            if ((typeof result === 'boolean' && !result) || (typeof result === 'string' && result.toLowerCase() === 'false')) {\n              self.dragging = null;\n              return;\n            }\n\n            if (self.isTouch) {\n              const rect = self.dragging[0].getBoundingClientRect();\n              const touch = e.originalEvent.changedTouches[0];\n\n              // Save offset\n              self.offset = {\n                x: touch.pageX - rect.left,\n                y: touch.pageY - rect.top\n              };\n              self.placeholderTouch = self.dragging\n                .clone().addClass('is-touch').attr('id', 'arrange-placeholder-touch')\n                .insertBefore(self.dragging);\n\n              self.dragTouchElement(e, self.placeholderTouch);\n            } else {\n              const dt = e.originalEvent.dataTransfer;\n              dt.effectAllowed = 'move';\n              dt.setData('Text', 'dummy');\n            }\n          })\n\n          // Drag end ----------------------------------------------------------\n          .on(self.dragEnd, () => {\n            if (!self.dragging) {\n              return;\n            }\n\n            if (self.isTouch) {\n              self.dragging.css('opacity', 1);\n              self.placeholderTouch.remove();\n            }\n\n            self.placeholders.filter(':visible').after(self.dragging);\n            self.dragging.removeClass('arrange-dragging').show();\n            self.placeholders.detach();\n\n            if (index !== self.dragging.index()) {\n              const idx = s.isVisualItems ?\n                self.getVisualIndex(self.dragging) : self.dragging.index();\n              $.extend(status, { end: self.dragging, endIndex: idx });\n\n              /**\n              * Fires after moving an element allowing you do any follow up updating.\n              *\n              * @event arrangeupdate\n              * @memberof Arrange\n              * @property {object} event - The jquery event object\n              * @property {object} status - Status for this item\n              */\n              self.element.triggerHandler('arrangeupdate', status);\n            }\n            self.dragging = null;\n            self.placeholderTouch = null;\n          })\n\n          // While dragging ----------------------------------------------------\n          .on(self.dragWhileDragging, function (e) {\n            if (!self.dragging) {\n              return;\n            }\n            let overItem = this;\n            let overIndex;\n            e.preventDefault();\n\n            /**\n            * Fires after finishing an arrange action.\n            *\n            * @event dragend\n            * @memberof ApplicationMenu\n            * @param {object} event - The jquery event object\n            */\n            if (e.type === 'drop') {\n              e.stopPropagation();\n              self.dragging.trigger('dragend.arrange');\n              return false;// eslint-disable-line\n            }\n\n            if (self.isTouch) {\n              const touch = e.originalEvent.touches[0];\n              overItem = self.getElementByTouchInList(items, touch.pageX, touch.pageY) || overItem;\n            }\n            overItem = $(overItem);\n\n            if (!self.isTouch) {\n              e.originalEvent.dataTransfer.dropEffect = 'move';\n            }\n\n            if (items.is(overItem) && placeholder.index() !== overItem.index()) {\n              if (self.isTouch) {\n                self.dragging.css('opacity', 0);\n              } else {\n                self.dragging.hide();\n              }\n\n              let idx;\n              if (placeholder.index() < (overItem.index())) {\n                placeholder.insertAfter(overItem);\n                overIndex = overItem.index();\n                idx = s.isVisualItems ?\n                  self.getVisualIndex(overItem) : overIndex;\n              } else {\n                placeholder.insertBefore(overItem);\n                overIndex = placeholder.index();\n                idx = s.isVisualItems ?\n                  self.getVisualIndex(placeholder) : overIndex;\n              }\n\n              $.extend(status, { over: overItem, overIndex: idx });\n              self.element.triggerHandler('draggingarrange', status);\n\n              // Fix: IE-11 on windows-10 svg was disappering\n              utils.fixSVGIcons(overItem);\n\n              self.placeholders.not(placeholder).detach();\n            } else if (!self.placeholders.is(this)) {\n              self.placeholders.detach();\n              self.element.append(placeholder);\n            }\n\n            if (self.isTouch) {\n              self.dragTouchElement(e, self.placeholderTouch);\n              return;\n            }\n            return false;// eslint-disable-line\n          });//-----------------------------------------------------------------\n      });// end each items\n  }\n\n};\n\nexport { Arrange, COMPONENT_NAME };\n","import { Arrange, COMPONENT_NAME } from './arrange';\n\n/**\n * jQuery component wrapper for Arrange\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery-wrapped components being acted on\n */\n$.fn.arrange = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Arrange(this, settings));\n    }\n  });\n};\n","/* eslint-disable no-cond-assign */\n\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\n\n// TODO: Resize: http://stackoverflow.com/questions/8258232/resize-an-html-element-using-touches\n// Similar: https://github.com/desandro/draggabilly\n\n// The name of this plugin\nconst COMPONENT_NAME = 'drag';\n\n/**\n * Drag/Drop functions with touch support.\n * @class Drag\n * @constructor\n *\n * @param {jQuery[]|HTMLElement} element The component element.\n * @param {object} [settings] The component settings.\n * @param {string} [settings.axis]  Constrains dragging to either axis. Possible values: null, 'x', 'y'\n * @param {boolean} [settings.clone=false] Set to true to clone the object to drag. In many situations this is\n *  needed to break out of layout.\n * @param {string} [settings.cloneCssClass='is-clone'] Css class added to clone element (defaults is 'is-clone')\n * @param {boolean} [settings.clonePosIsFixed=false] If true cloned object will use css style \"position: fixed\"\n * @param {string} [settings.cloneAppendTo] Selector to append to for the clone\n * ['body'|'parent'|'jquery object'] default:'body'\n * @param {boolean} [settings.containment=false] Constrains dragging to within the bounds of the specified element\n *  or region. Possible values: \"parent\", \"document\", \"window\".\n * @param {string} [settings.obstacle] jQuery Selector of object(s) that you cannot drag into,\n * @param {boolean} [settings.underElements=false] If set to true will return list of elements that are\n * underneath the drag element\n * @param {object} [settings.containmentOffset={left: 0, top: 0}] How close to the containment object should we be allowed\n * to drag in position form. `{left: 0, top: 0}`\n*/\nconst DRAG_DEFAULTS = {\n  axis: null,\n  clone: false,\n  cloneCssClass: 'is-clone',\n  clonePosIsFixed: false,\n  cloneAppendTo: null,\n  containment: false,\n  obstacle: false,\n  underElements: false,\n  containmentOffset: { left: 0, top: 0 }\n};\n\nfunction Drag(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, DRAG_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nDrag.prototype = {\n\n  init() {\n    this.handleEvents();\n  },\n\n  /**\n  * Trigger events and remove clone\n  * @private\n  * @param {number} left Current left position\n  * @param {number} top Current top position\n  */\n  finish(left, top) {\n    const pos = { top, left };\n\n    this.element.off('mouseup.draggable');\n    $(document).off('mousemove.draggable mouseup.draggable');\n    if (this.settings.underElements) {\n      pos.underElements = this.getElementsFromPoint(pos.left, pos.top);\n    }\n\n    /**\n    * Fires after the drag is completed. Use this to remove / set drag feedback off.\n    * @event dragend\n    * @memberof Drag\n    * @property {object} event - The jquery event object.\n    * @property {object} ui - The dialog object\n    */\n    this.element.trigger('dragend', pos);\n    this.element.removeClass('is-dragging');\n\n    if (this.clone) {\n      if (this.settings.axis === 'x') {\n        delete pos.top;\n      }\n\n      if (this.settings.axis === 'y') {\n        delete pos.left;\n      }\n      // this.element.css(pos);\n      this.clone.remove();\n      this.clone = null;\n    }\n\n    // Clear Cached Sizes\n    if (this.obstacle) {\n      this.obstacle = null;\n    }\n    if (this.upperYLimit) {\n      this.upperYLimit = null;\n    }\n    if (this.upperXLimit) {\n      this.upperXLimit = null;\n    }\n    $('body').removeClass('disable-select');\n  },\n\n  // Move the object from the event coords\n  move(left, top) {\n    const self = this;\n\n    const css = {\n      left,\n      top\n    };\n\n    // X-Y Axis\n    if (this.settings.axis === 'x') {\n      delete css.top;\n    }\n\n    if (this.settings.axis === 'y') {\n      delete css.left;\n    }\n\n    if (this.settings.containment) {\n      if (this.settings.containment instanceof jQuery) {\n        this.container = this.settings.containment;\n      } else if (this.settings.containment === 'parent') {\n        this.container = this.element.parent();\n      } else if (this.settings.containment === 'window') {\n        this.container = $(window);\n      } else if (this.settings.containment === 'container') {\n        this.container = this.element.closest('.page-container');\n      } else {\n        this.container = $(document);\n      }\n\n      if (!this.upperXLimit) {\n        this.upperXLimit = (this.container.width() - this.element.outerWidth()) +\n          this.settings.containmentOffset.left;\n      }\n      if (!this.upperYLimit) {\n        this.upperYLimit = (this.container.height() - this.element.outerHeight()) +\n          this.settings.containmentOffset.top;\n      }\n      if (css.top > this.upperYLimit) {\n        css.top = this.upperYLimit;\n      }\n\n      if (css.left > this.upperXLimit) {\n        css.left = this.upperXLimit;\n      }\n\n      if (css.top < 0) {\n        css.top = 0;\n      }\n\n      if (css.left < 0) {\n        css.left = 0;\n      }\n\n      if (this.settings.containment === 'container' && css.left <= 1) {\n        css.left = 1;\n      }\n    }\n\n    if (this.settings.obstacle) {\n      const elemOffset = (this.clone ? this.clone.offset() : this.element.offset());\n      const elemWidth = (this.clone ? this.clone.outerWidth() : this.element.outerWidth());\n      const movingRight = css.left > elemOffset.left;\n\n      // Caching this so drag is not jaggie\n      if (!this.obstacle) {\n        this.obstacle = $(this.settings.obstacle).not(this.element);\n        const obstacleOffset = $(this.obstacle).offset();\n\n        this.constraints = {\n          top: obstacleOffset.top,\n          left: obstacleOffset.left,\n          bottom: obstacleOffset.top + this.obstacle.outerHeight(),\n          right: obstacleOffset.left + this.obstacle.outerWidth()\n        };\n      }\n\n      if (!movingRight && self.originalPos.left > this.constraints.left &&\n        css.left <= this.constraints.right) {\n        css.left = this.constraints.right;\n      }\n\n      if (movingRight && self.originalPos.left + elemWidth <= this.constraints.left &&\n        css.left + elemWidth >= this.constraints.left) {\n        css.left = (this.constraints.left - this.obstacle.outerWidth());\n      }\n\n      // TODO: Moving Down\n    }\n\n    const applyCssStyle = function (el, applyCss, prop) {\n      if (typeof applyCss[prop] !== 'undefined') {\n        el[0].style[prop] = `${applyCss[prop]}px`;\n      }\n    };\n\n    applyCssStyle((this.clone || this.element), css, 'top');\n    applyCssStyle((this.clone || this.element), css, 'left');\n\n    if (this.settings.underElements) {\n      css.underElements = this.getElementsFromPoint(css.left, css.top);\n    }\n\n    /**\n    * Fires (many times) while dragging is occuring. Use this for DOM feedback but\n    * be careful about what you do in here for performance.\n    * @event drag\n    * @memberof Drag\n    * @property {object} event - The jquery event object.\n    * @property {object} ui - The dialog object\n    */\n    this.element.trigger('drag', css);\n  },\n\n  /**\n  * Get elements from given point.\n  * @param {number} x The x-coordinate of the Point.\n  * @param {number} y The y-coordinate of the Point.\n  * @Returns {array} List of all elements at the given point.\n  */\n  getElementsFromPoint(x, y) {\n    let elements = [];\n\n    if (document.elementsFromPoint) {\n      elements = document.elementsFromPoint(x, y);\n    } else if (document.msElementsFromPoint) {\n      elements = document.msElementsFromPoint(x, y);\n    } else {\n      let i;\n      let l;\n      let d;\n      let current;\n      let max = 999;\n      const pointerEvents = [];\n\n      while ((current = document.elementFromPoint(x, y)) && elements.indexOf(current) === -1 &&\n        current !== null && max > -1) {\n        max--;\n\n        // push the element and its current style\n        elements.push(current);\n        pointerEvents.push({\n          value: current.style.getPropertyValue('pointer-events') || '',\n          priority: current.style.getPropertyPriority('pointer-events')\n        });\n        // add \"pointer-events: none\", to get to the underlying element\n        current.style.setProperty('pointer-events', 'none', 'important');\n      }\n      // restore the previous pointer-events values\n      for (i = 0, l = elements.length; i < l; i++) {\n        d = pointerEvents[i];\n        elements[i].style.setProperty('pointer-events', d.value, d.priority);\n      }\n    }\n    return elements;\n  },\n\n  /**\n   * Update the component and optionally apply new settings.\n   * @param  {object} settings the settings to update to.\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n  },\n\n  /**\n   * Detach all functionality and events.\n   */\n  destroy() {\n    $.removeData(this.element[0], COMPONENT_NAME);\n    this.element.off('touchstart.draggable MSPointerDown.draggable pointerdown.draggable touchmove.draggable touchend.draggable touchcancel.draggable mousedown.draggable');\n  },\n\n  handleEvents() {\n    const self = this;\n    self.offset = null;\n\n    // Touch and Drag Support\n    self.element.attr('draggable', false);\n\n    if ('onpointerdown' in window || 'onmspointerdown' in window) {\n      // TODO: Setup Pointer Events for 11 - pointerdown MSPointerDown, pointermove,\n      // MSPointerMove, pointerup MSPointerUp\n    } else {\n      // Touch-only Drag Support\n      self.element.on('touchstart.draggable gesturestart.draggable', function (e) {\n        const pos = $(this).position();\n        const orig = e.originalEvent;\n\n        self.offset = {\n          x: orig.changedTouches[0].pageX - pos.left,\n          y: orig.changedTouches[0].pageY - pos.top\n        };\n\n        self.originalPos = pos;\n        self.element.addClass('is-dragging');\n\n        /**\n        * When the dragging is initiated. Use this to customize/style\n        * the drag/drop objects in the DOM.\n        * @event dragstart\n        * @memberof Drag\n        * @property {object} event - The jquery event object.\n        * @property {object} ui - The dialog object\n        */\n        self.element.trigger('dragstart', pos);\n      })\n        // Move\n        .on('touchmove.draggable gesturechange.draggable', (e) => {\n          e.preventDefault();\n          const orig = e.originalEvent;\n\n          // do now allow two touch points to drag the same element\n          if (orig.targetTouches.length > 1) {\n            return;\n          }\n\n          const xpos = orig.changedTouches[0].pageX - self.offset.x;\n          const ypos = orig.changedTouches[0].pageY - self.offset.y;\n          self.move(xpos, ypos);\n        })\n        // Finish Touch Dragging\n        .on('touchend.draggable gestureend.draggable touchcancel.draggable', (e) => {\n          e.preventDefault();\n          const touch = e.originalEvent.changedTouches[0];\n          self.finish(touch.pageX - self.offset.x, touch.pageY - self.offset.y);\n        });\n    }\n\n    // Always bind mousedown in either scenario, in the event that a mouse is used\n    self.element.on('mousedown.draggable', (e) => {\n      e.preventDefault();\n\n      const pos = self.settings.clonePosIsFixed ?\n        self.element[0].getBoundingClientRect() : self.element.position();\n\n      // Save offset\n      self.offset = {\n        x: e.pageX - pos.left,\n        y: e.pageY - pos.top\n      };\n\n      self.originalPos = pos;\n\n      // Prevent Text Selection\n      $('body').addClass('disable-select');\n\n      // Handle Mouse Press over draggable element\n      $(document).on('mousemove.draggable', (mouseMoveEvent) => {\n        mouseMoveEvent.preventDefault();\n        self.move(mouseMoveEvent.pageX - self.offset.x, mouseMoveEvent.pageY - self.offset.y);\n      });\n\n      // Handle Mouse release over draggable element close out events and trigger\n      $(document).on('mouseup.draggable', (docMouseUpEvent) => {\n        docMouseUpEvent.preventDefault();\n        self.finish(e.pageX - self.offset.x, docMouseUpEvent.pageY - self.offset.y);\n      });\n\n      self.element.on('mouseup.draggable', (mouseUpEvent) => {\n        mouseUpEvent.preventDefault();\n        self.finish(mouseUpEvent.pageX - self.offset.x, mouseUpEvent.pageY - self.offset.y);\n      });\n\n      // Trigger dragging\n      // Clone\n      if (!self.clone && self.settings.clone) {\n        self.clone = self.element.clone(true);\n        if (self.settings.cloneAppendTo === 'parent') {\n          self.settings.cloneAppendTo = self.element.parent();\n        }\n        self.clone\n          .addClass(self.settings.cloneCssClass)\n          .appendTo(self.settings.cloneAppendTo || 'body');\n      }\n\n      self.element.addClass('is-dragging');\n      self.element.trigger('dragstart', [pos, self.clone]);\n    });\n  }\n};\n\nexport { Drag, COMPONENT_NAME };\n","import { Drag, COMPONENT_NAME } from './drag';\n\n/**\n * jQuery Component Wrapper for Drag\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.drag = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Drag(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\n\n// Component Name\nconst COMPONENT_NAME = 'place';\n\n// Default Component Options\nconst DEFAULT_PLACE_SETTINGS = {\n  bleedFromContainer: false,\n  callback: null,\n  container: null,\n  parent: null,\n  parentXAlignment: 'center',\n  parentYAlignment: 'center',\n  placement: 'bottom',\n  strategies: ['nudge']\n};\n\n// Constants used throughout\nconst PLACE_STRATEGIES = ['nudge', 'clockwise', 'flip', 'shrink', 'shrink-x', 'shrink-y'];\nconst PLACE_POSITIONS = ['top', 'left', 'right', 'bottom', 'center'];\nconst PLACE_X_ALIGNMENTS = ['left', 'center', 'right'];\nconst PLACE_Y_ALIGNMENTS = ['top', 'center', 'bottom'];\nconst PLACEMENT_OBJECT_SETTING_KEYS = [\n  'x', 'y',\n  'container', 'containerOffsetX', 'containerOffsetY',\n  'callback',\n  'parent', 'parentXAlignment', 'parentYAlignment',\n  'useParentWidth', 'useParentHeight',\n  'placement',\n  'strategies'\n];\n\n/**\n * Object that contains coordinates along with temporary, changeable properties.\n * This object gets passed around the Place Behavior and modified during each phase of positioning.\n * This object is also passed to all callbacks and event listeners for further modification.\n * @private\n * @param {object} [placementOptions] object containing settings for placement\n * @returns {void}\n */\nfunction PlacementObject(placementOptions) {\n  const self = this;\n\n  PLACEMENT_OBJECT_SETTING_KEYS.forEach((val) => {\n    if (placementOptions[val] === null) {\n      return;\n    }\n\n    if (val === 'x' || val === 'y') {\n      self.setCoordinate(val, placementOptions[val]);\n      self[`original${val}`] = placementOptions[val];\n      return;\n    }\n\n    self[val] = placementOptions[val];\n  });\n\n  this.modified = false;\n\n  return this.sanitize();\n}\n\nPlacementObject.prototype = {\n  isReasonableDefault(setting, limits) {\n    return $.inArray(setting, limits) > -1;\n  },\n\n  sanitize() {\n    const self = this;\n\n    this.bleedFromContainer = this.bleedFromContainer === true;\n    this.callback = (typeof this.callback === 'function') ? this.callback : DEFAULT_PLACE_SETTINGS.callback;\n    this.container = (this.container instanceof $ && this.container.length) ?\n      this.container : DEFAULT_PLACE_SETTINGS.container;\n    this.containerOffsetX = !isNaN(parseInt(this.containerOffsetX, 10)) ?\n      this.containerOffsetX : 0;\n    this.containerOffsetY = !isNaN(parseInt(this.containerOffsetY, 10)) ?\n      this.containerOffsetY : 0;\n    this.parent = (this.parent instanceof $ && this.parent.length) ?\n      this.parent : DEFAULT_PLACE_SETTINGS.parent;\n    this.parentXAlignment = this.isReasonableDefault(this.parentXAlignment, PLACE_X_ALIGNMENTS) ?\n      this.parentXAlignment : DEFAULT_PLACE_SETTINGS.parentXAlignment;\n    this.parentYAlignment = this.isReasonableDefault(this.parentYAlignment, PLACE_Y_ALIGNMENTS) ?\n      this.parentYAlignment : DEFAULT_PLACE_SETTINGS.parentYAlignment;\n    this.placement = this.isReasonableDefault(this.placement, PLACE_POSITIONS) ?\n      this.placement : DEFAULT_PLACE_SETTINGS.placement;\n    this.useParentHeight = this.useParentHeight === true;\n    this.useParentWidth = this.useParentWidth === true;\n\n    if (!$.isArray(this.strategies) || !this.strategies.length) {\n      this.strategies = ['nudge'];\n    }\n    this.strategies.forEach((strat, i) => {\n      self.strategies[i] = self.isReasonableDefault(strat, PLACE_STRATEGIES) ?\n        strat : self.strategies[i];\n    });\n  },\n\n  setCoordinate(coordinate, value) {\n    const coordinates = ['x', 'y'];\n    if (!this.isReasonableDefault(coordinate, coordinates)) {\n      return;\n    }\n\n    if (isNaN(value)) {\n      value = 0;\n    }\n\n    this[coordinate] = Math.round(value);\n  }\n};\n\n/**\n * The Place API which handles internal placement of popups, menus ect.\n * @class Place\n * @param {HTMLElement|jQuery[]} element the base element being placed\n * @param {object} [settings] incoming settings\n * @param {boolean} [settings.bleedFromContainer = false] If true, allows positioned content to bleed\n *  outside of a defined container.\n * @param {function} [settings.callback] If defined, provides extra placement adjustments\n *  after the main calculation is performed.\n * @param {HTMLElement} [settings.container] If defined, contains the placement of the\n *  element to the boundaries of a specific container element.\n * @param {HTMLElement} [settings.parent] If defined, will be used as the reference\n *  element for placement this element.\n * @param {string} [settings.parentXAlignment = 'center'] Only used for parent-based placement.\n *  Determines the X-coordinate alignment of the placed element against its parent.\n * @param {string} [settings.parentYAlignment = 'center'] Only used for parent-based placement.\n *  Determines the Y-coordinate alignment of the placed element against its parent.\n * @param {string} [settings.placement = 'bottom'] If defined, changes the direction in which\n *  placement of the element happens\n * @param {string[]} [settings.strategies = ['nudge']] Determines the \"strategy\" for alternatively\n *  placing the element if it doesn't fit in the defined boundaries.  Only matters\n *  when \"parent\" is a defined setting.  It's possible to define multiple strategies\n *  and execute them in order.\n */\nfunction Place(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, DEFAULT_PLACE_SETTINGS);\n  this.element = $(element);\n  this.init();\n}\n\nPlace.prototype = {\n\n  /**\n   * Do other init (change/normalize settings, load externals, etc)\n   * @private\n   * @returns {this} component instance\n   */\n  init() {\n    return this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n   * Add markup to the control\n   * @private\n   * @returns {this} component instance\n   */\n  build() {\n    if (!this.element.hasClass('placeable')) {\n      this.element.addClass('placeable');\n    }\n\n    // Setup a hash of original styles that will retain width/height whenever\n    // the placement for this element is recalculated.\n    this.originalStyles = {};\n    const h = this.element[0].style.height;\n    const w = this.element[0].style.width;\n\n    if (h) {\n      this.originalStyles.height = h;\n    }\n    if (w) {\n      this.originalStyles.width = w;\n    }\n\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this control and its sub-elements\n   * @private\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.on(`place.${COMPONENT_NAME}`, (e, x, y) => {\n      self.place(new PlacementObject({ x, y }));\n    }).on(`updated.${COMPONENT_NAME}`, () => {\n      self.updated();\n    });\n\n    return this;\n  },\n\n  /**\n   * Actually renders an element with coordinates inside the DOM\n   * @param {PlacementObject} placementObj settings for the placement routine\n   * @returns {void}\n   */\n  render(placementObj) {\n    const unitRegex = /(px|%)/i;\n\n    this.element.offset({\n      left: placementObj.x,\n      top: placementObj.y\n    });\n\n    if (placementObj.height) {\n      this.element[0].style.height = placementObj.height + (unitRegex.test(`${placementObj.height}`) ? '' : 'px');\n    }\n    if (placementObj.width) {\n      this.element[0].style.width = placementObj.width + (unitRegex.test(`${placementObj.width}`) ? '' : 'px');\n    }\n  },\n\n  /**\n   * Main placement API Method (external)\n   * Can either take a PlacementObject as a single argument, or can take 2 coordinates (x, y) and\n   * will use the pre-defined settings.\n   * @param {PlacementObject} placementObj settings for the placement routine\n   * @returns {void}\n   */\n  place(placementObj) {\n    const curr = [\n      this.element[0].style.left,\n      this.element[0].style.top,\n    ];\n\n    // Cancel placement with return:false; from a \"beforeplace\" event\n    const canBePlaced = this.element.trigger('beforeplace', [curr]);\n    if (!canBePlaced) {\n      return curr;\n    }\n\n    if (!(placementObj instanceof PlacementObject)) {\n      placementObj = new PlacementObject(placementObj);\n    }\n\n    // If no values are defined, simply return the current coordinates with a warning.\n    if (placementObj.x == null && placementObj.y == null) {\n      // TODO: Log a warning about not positioning stuff?\n      return curr;\n    }\n\n    // Remove any previous placement styles\n    this.clearOldStyles();\n\n    // Use different methods if placement against a parent, versus straight-up coordinate placement\n    if (placementObj.parent) {\n      return this.placeWithParent(placementObj);\n    }\n\n    return this.placeWithCoords(placementObj);\n  },\n\n  /**\n   * Placement Routine that expects a parent to be used as a base placement marking.\n   * In this case, \"x\" and \"y\" integers are \"relative\" adjustments to the original\n   * numbers generated by the parent. Can be modified by using a callback in the settings.\n   * @private\n   * @param {PlacementObject} placementObj settings for the placement routine\n   * @returns {PlacementObject} modified placementObject with updated settings\n   */\n  placeWithParent(placementObj) {\n    if (!placementObj.parent || !placementObj.parent.length) {\n      // can't simply return x and y here because if there is no parent element,\n      // these numbers are not coordinates, they are offsets.\n      return [undefined, undefined];\n    }\n\n    const self = this;\n    const parentRect = DOM.getDimensions(placementObj.parent[0]);\n    const elRect = DOM.getDimensions(this.element[0]);\n    const container = this.getContainer(placementObj);\n    const containerIsBody = container.length && container[0] === document.body;\n    // NOTE: Usage of $(window) instead of $('body') is deliberate here - http://stackoverflow.com/a/17776759/4024149.\n    // Firefox $('body').scrollTop() will always return zero.\n    const scrollX = containerIsBody ? $(window).scrollLeft() : container.scrollLeft();\n    const scrollY = containerIsBody ? $(window).scrollTop() : container.scrollTop();\n\n    if (placementObj.useParentWidth) {\n      placementObj.width = parentRect.width;\n    }\n    if (placementObj.useParentHeight) {\n      placementObj.height = parentRect.height;\n    }\n\n    function getCoordsFromPlacement(incomingPlacementObj) {\n      const p = incomingPlacementObj.placement;\n      const aX = incomingPlacementObj.parentXAlignment;\n      const aY = incomingPlacementObj.parentYAlignment;\n      let cX;\n      let cY;\n\n      // Set initial placements\n      switch (p) {\n        case 'top':\n          cY = parentRect.top - elRect.height - incomingPlacementObj.y +\n            (containerIsBody ? scrollY : 0);\n          break;\n        case 'left':\n          cX = parentRect.left - elRect.width - incomingPlacementObj.x +\n            (containerIsBody ? scrollX : 0);\n          break;\n        case 'right':\n          cX = parentRect.right + incomingPlacementObj.x + (containerIsBody ? scrollX : 0);\n          break;\n        default: // Bottom\n          cY = parentRect.bottom + incomingPlacementObj.y + (containerIsBody ? scrollY : 0);\n          break;\n      }\n\n      // Set X alignments on bottom/top placements\n      if (p === 'top' || p === 'bottom') {\n        const cW = containerIsBody ? document.body.offsetWidth : null;\n        switch (aX) {\n          case 'left':\n            if (containerIsBody && (cW < parentRect.left + elRect.width)) {\n              cX = (parentRect.right - elRect.width) + incomingPlacementObj.x + scrollX;\n            } else {\n              cX = parentRect.left - incomingPlacementObj.x + (containerIsBody ? scrollX : 0);\n            }\n            break;\n          case 'right':\n            if (containerIsBody && (parentRect.right - elRect.width) < 0) {\n              cX = parentRect.left - incomingPlacementObj.x + scrollX;\n            } else {\n              cX = (parentRect.right - elRect.width) +\n                incomingPlacementObj.x + (containerIsBody ? scrollX : 0);\n            }\n            break;\n          default: // center\n            cX = (parentRect.left + ((parentRect.width - elRect.width) / 2)) +\n              incomingPlacementObj.x + (containerIsBody ? scrollX : 0);\n            break;\n        }\n      }\n\n      // Set Y alignments on left/right placements\n      if (p === 'right' || p === 'left') {\n        switch (aY) {\n          case 'top':\n            cY = parentRect.top - incomingPlacementObj.y + (containerIsBody ? scrollY : 0);\n            break;\n          case 'bottom':\n            cY = (parentRect.bottom - elRect.height) +\n              incomingPlacementObj.y + (containerIsBody ? scrollY : 0);\n            break;\n          default: // center\n            cY = (parentRect.top + ((parentRect.height - elRect.height) / 2)) +\n              incomingPlacementObj.y + (containerIsBody ? scrollY : 0);\n            break;\n        }\n      }\n\n      return [cX, cY];\n    }\n\n    function doPlacementAgainstParent(incomingPlacementObj) {\n      const coords = getCoordsFromPlacement(incomingPlacementObj);\n      incomingPlacementObj.setCoordinate('x', coords[0]);\n      incomingPlacementObj.setCoordinate('y', coords[1]);\n      self.render(incomingPlacementObj);\n      incomingPlacementObj = self.handlePlacementCallback(incomingPlacementObj);\n      return incomingPlacementObj;\n    }\n\n    // Simple placement logic\n    placementObj = doPlacementAgainstParent(placementObj);\n\n    // Adjusts the placement coordinates based on a defined strategy\n    // Will only adjust the current strategy if bleeding outside the\n    // viewport/container are detected.\n    placementObj.strategies.forEach((strat) => {\n      placementObj = self.checkBleeds(placementObj);\n\n      if (placementObj.bleeds) {\n        placementObj = (function () {\n          switch (strat) {\n            case 'nudge':\n              return self.nudge(placementObj);\n            case 'clockwise':\n              return self.clockwise(placementObj);\n            case 'flip':\n              placementObj = self.flip(placementObj);\n              placementObj.setCoordinate('x', placementObj.originalx);\n              placementObj.setCoordinate('y', placementObj.originaly);\n              placementObj = doPlacementAgainstParent(placementObj);\n              return placementObj;\n            case 'shrink':\n              return self.shrink(placementObj);\n            case 'shrink-x':\n              return self.shrink(placementObj, 'x');\n            case 'shrink-y':\n              return self.shrink(placementObj, 'y');\n            default:\n              return placementObj;\n          }\n        }(self));\n\n        self.render(placementObj);\n      }\n    });\n\n    // Trigger an event to notify placement has ended\n    this.element.trigger('afterplace', [placementObj]);\n\n    return placementObj;\n  },\n\n  /**\n   * Basic Placement Routine that simply accepts X and Y coordinates.\n   * In this case, \"x\" and \"y\" integers are \"absolute\" and will be the base point for placement.\n   * Can be modified by using a callback in the settings.\n   * @private\n   * @param {PlacementObject} placementObj settings for the placement routine\n   * @returns {PlacementObject} modified placementObject with updated settings\n   */\n  placeWithCoords(placementObj) {\n    this.render(placementObj);\n\n    placementObj = this.handlePlacementCallback(placementObj);\n\n    this.render(placementObj);\n\n    // Coordinate placement can only be \"nudged\" (strategy is not used in this style of placement).\n    placementObj = this.checkBleeds(placementObj);\n    if (placementObj.bleeds) {\n      placementObj = this.nudge(placementObj);\n    }\n\n    // Place again\n    this.render(placementObj);\n\n    placementObj = this.checkBleeds(placementObj);\n    if (placementObj.bleeds) {\n      placementObj = this.shrink(placementObj);\n    }\n\n    this.render(placementObj);\n\n    this.element.trigger('afterplace', [\n      placementObj\n    ]);\n\n    return placementObj;\n  },\n\n  /**\n   * Perform callback, if it exists.\n   * Callback should return an array containing the modified coordinate values: [x, y];\n   * NOTE: These are actual coordinates in all cases.\n   * NOTE: They are not relative values - they are absolute.\n   * @private\n   * @param {PlacementObject} placementObj settings for the placement routine\n   * @returns {PlacementObject} modified placementObject with updated settings\n   */\n  handlePlacementCallback(placementObj) {\n    const cb = placementObj.callback || this.settings.callback;\n\n    if (cb && typeof cb === 'function') {\n      placementObj = cb(placementObj);\n    }\n\n    this.render(placementObj);\n    return placementObj;\n  },\n\n  /**\n   * Detects for elements with fixed positioning, or an absolutely-positioned containment.\n   * If either condition is true, this placement should not account for container scrolling.\n   * @private\n   * @param {PlacementObject} placementObj settings for the placement routine\n   * @returns {boolean} whether or not the values calculated should account for scrolling.\n   */\n  accountForScrolling(placementObj) {\n    let container = placementObj.container;\n    let pos = window.getComputedStyle(this.element[0]).position;\n\n    // fixed-positoned, placed elements don't account for scrolling\n    if (pos === 'fixed') {\n      return false;\n    }\n\n    // Check the container element.\n    // If we can't find a valid container element, do account for scrolling.\n    if (!container || !container.length) {\n      container = this.element.parents().filter(function () {\n        const containerPos = window.getComputedStyle(this).position;\n        return containerPos === 'absolute' || pos === 'fixed';\n      });\n    }\n    if (!container || !container.length) {\n      return true;\n    }\n\n    if (container[0] === document.body) {\n      return false;\n    }\n\n    const containerStyle = window.getComputedStyle(container[0]);\n    pos = containerStyle.position;\n    if (pos === 'fixed') {\n      return false;\n    }\n    if (pos === 'absolute' && containerStyle.overflow === 'hidden') {\n      return false;\n    }\n    return true;\n  },\n\n  /**\n   * Gets a parent container element.\n   * @param {PlacementObject} placementObj settings for the placement routine\n   * @returns {HTMLElement|jQuery[]} container element\n   */\n  getContainer(placementObj) {\n    if (placementObj.container instanceof $ && placementObj.container.length) {\n      return placementObj.container;\n    }\n\n    const modalParent = this.element.parents('.modal');\n    if (modalParent.length) {\n      return modalParent;\n    }\n\n    return $(document.body);\n  },\n\n  /**\n   * Re-adjust a previously-placed element to account for bleeding off the edges.\n   * Element must fit within the boundaries of the page or it's current scrollable pane.\n   * @param {PlacementObject} placementObj settings for the placement routine.\n   * @returns {PlacementObject} modified placementObject with updated settings.\n   */\n  checkBleeds(placementObj) {\n    const containerBleed = this.settings.bleedFromContainer;\n    const container = this.getContainer(placementObj);\n    const containerIsBody = container.length && container[0] === document.body;\n    const BoundingRect = this.element[0].getBoundingClientRect();\n    const rect = {};\n    const containerRect = container ? container[0].getBoundingClientRect() : {};\n    // NOTE: Usage of $(window) instead of $('body') is deliberate here - http://stackoverflow.com/a/17776759/4024149.\n    // Firefox $('body').scrollTop() will always return zero.\n    const scrollX = containerIsBody ? $(window).scrollLeft() : container.scrollLeft();\n    const scrollY = containerIsBody ? $(window).scrollTop() : container.scrollTop();\n    const windowH = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n    const windowW = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n    let d;\n\n    rect.width = BoundingRect.width;\n    rect.height = BoundingRect.height;\n    rect.top = BoundingRect.top;\n    rect.right = BoundingRect.right;\n    rect.bottom = BoundingRect.bottom;\n    rect.left = BoundingRect.left;\n\n    function getBoundary(edge) {\n      switch (edge) {\n        case 'top':\n          return (containerBleed ? 0 : containerRect.top) -\n            (!containerIsBody ? 0 : scrollY * -1); // 0 === top edge of viewport\n        case 'left':\n          return (containerBleed ? 0 : containerRect.left) -\n            (!containerIsBody ? 0 : scrollX * -1); // 0 === left edge of viewport\n        case 'right':\n          return (containerBleed ? windowW : containerRect.right) -\n            (!containerIsBody ? 0 : scrollX * -1);\n        default: // bottom\n          return (containerBleed ? windowH : containerRect.bottom) -\n            (!containerIsBody ? 0 : scrollY * -1);\n      }\n    }\n\n    // If element width is greater than window width, shrink to fit\n    const rightViewportEdge = getBoundary('right');\n    if (rect.width >= rightViewportEdge) {\n      d = rect.width - rightViewportEdge;\n      const newWidth = rect.width - d;\n      placementObj.width = newWidth;\n\n      this.element[0].style.width = `${newWidth}px`;\n      rect.width = newWidth; // reset the rect because the size changed\n    }\n\n    // If element height is greater than window height, shrink to fit\n    const bottomViewportEdge = getBoundary('bottom');\n    if (rect.height >= bottomViewportEdge) {\n      d = rect.height - bottomViewportEdge;\n      const newHeight = rect.height - d;\n      placementObj.height = newHeight;\n\n      this.element[0].style.height = `${newHeight}px`;\n      rect.height = newHeight; // reset the rect because the size changed\n    }\n\n    // build conditions\n    const offRightEdge = rect.right > getBoundary('right');\n    const offLeftEdge = rect.left < getBoundary('left');\n    const offTopEdge = rect.top < getBoundary('top');\n    const offBottomEdge = rect.bottom > getBoundary('bottom');\n\n    // Return if no bleeding is detected (no need to fix anything!)\n    if (!offRightEdge && !offLeftEdge && !offTopEdge && !offBottomEdge) {\n      placementObj.bleeds = undefined;\n      return placementObj;\n    }\n\n    // Keep a record of bleeds that need to be adjusted, and by what values\n    placementObj.bleeds = {};\n    placementObj.bleeds.right = offRightEdge ? (rect.right - getBoundary('right')) : null;\n    placementObj.bleeds.left = offLeftEdge ? -(rect.left - getBoundary('left')) : null;\n    placementObj.bleeds.top = offTopEdge ? -(rect.top - getBoundary('top')) : null;\n    placementObj.bleeds.bottom = offBottomEdge ? (rect.bottom - getBoundary('bottom')) : null;\n\n    return placementObj;\n  },\n\n  // Bumps the element around in each direction\n  nudge(placementObj) {\n    if (!placementObj.nudges) {\n      placementObj.nudges = { x: 0, y: 0 };\n    }\n\n    let d = 0;\n    if (placementObj.bleeds.right) {\n      d = Math.abs(placementObj.bleeds.right) + Math.abs(placementObj.containerOffsetX);\n      placementObj.setCoordinate('x', placementObj.x - d);\n      placementObj.nudges.x -= d;\n    }\n    if (placementObj.bleeds.left) {\n      d = Math.abs(placementObj.bleeds.left) + Math.abs(placementObj.containerOffsetX);\n      placementObj.setCoordinate('x', placementObj.x + d);\n      placementObj.nudges.x += d;\n    }\n    if (placementObj.bleeds.top) {\n      d = Math.abs(placementObj.bleeds.top) + Math.abs(placementObj.containerOffsetY);\n      placementObj.setCoordinate('y', placementObj.y + d);\n      placementObj.nudges.y += d;\n    }\n    if (placementObj.bleeds.bottom) {\n      d = Math.abs(placementObj.bleeds.bottom) + Math.abs(placementObj.containerOffsetY);\n      placementObj.setCoordinate('y', placementObj.y - d);\n      placementObj.nudges.y -= d;\n    }\n\n    placementObj.wasNudged = true;\n    placementObj.bleeds = undefined;\n\n    return placementObj;\n  },\n\n  flip(placementObj) {\n    // Don't attempt to flip if there was no bleeding on the edge we're attempting to leave from.\n    if (!placementObj.bleeds[placementObj.placement]) {\n      return placementObj;\n    }\n\n    if (!placementObj.attemptedFlips) {\n      placementObj.attemptedFlips = [];\n    }\n    placementObj.attemptedFlips.push(placementObj.placement);\n\n    // If we've tried flipping in all directions, give up and use the default placement.\n    if (placementObj.attemptedFlips.length > 3) {\n      placementObj = this.giveup(placementObj);\n      return placementObj;\n    }\n\n    const accountForScrolling = this.accountForScrolling(placementObj);\n    const isXCoord = ['left', 'right'].indexOf(placementObj.placement) > -1;\n    const containerBleed = this.settings.bleedFromContainer;\n    const container = this.getContainer(placementObj);\n    const containerIsBody = container.length && container[0] === document.body;\n    const containerRect = container ? container[0].getBoundingClientRect() : {};\n    const parentRect = placementObj.parent[0].getBoundingClientRect();\n    // NOTE: Usage of $(window) instead of $('body') is deliberate here - http://stackoverflow.com/a/17776759/4024149.\n    // Firefox $('body').scrollTop() will always return zero.\n    const scrollX = containerIsBody ? $(window).scrollLeft() : container.scrollLeft();\n    const scrollY = containerIsBody ? $(window).scrollTop() : container.scrollTop();\n    const windowH = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n    const windowW = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n\n    function getOppositeDir(dir) {\n      switch (dir) {\n        case 'left':\n          return 'right';\n        case 'right':\n          return 'left';\n        case 'top':\n          return 'bottom';\n        default: // bottom\n          return 'top';\n      }\n    }\n\n    // Gets the distance between an edge on the target element, and its opposing viewport border\n    function getDistance(dir) {\n      let d = 0;\n\n      switch (dir) {\n        case 'left':\n          d = (containerBleed ? 0 : containerRect.left) -\n            (accountForScrolling ? scrollX : 0) - parentRect.left + placementObj.containerOffsetX;\n          break;\n        case 'right':\n          d = ((containerBleed ? windowW : containerRect.right) -\n            (accountForScrolling ? scrollX : 0)) - parentRect.right - placementObj.containerOffsetX;\n          break;\n        case 'top':\n          d = (containerBleed ? 0 : containerRect.top) -\n            (accountForScrolling ? scrollY : 0) - parentRect.top + placementObj.containerOffsetY;\n          break;\n        default: // bottom\n          d = ((containerBleed ? windowH : containerRect.bottom) -\n            (accountForScrolling ? scrollY : 0)) - parentRect.bottom -\n            placementObj.containerOffsetY;\n          break;\n      }\n\n      return Math.abs(d);\n    }\n\n    function tried(placement) {\n      return $.inArray(placement, placementObj.attemptedFlips) > -1;\n    }\n\n    function performFlip(originalDir) {\n      const newDir = getOppositeDir(originalDir);\n      const perpendicularDir = isXCoord ? 'top' : 'left';\n      const oppPerpendicularDir = getOppositeDir(perpendicularDir);\n      const originalDistance = getDistance(originalDir);\n      const targetDistance = getDistance(newDir);\n\n      if (!tried(newDir)) {\n        if (originalDistance >= targetDistance) {\n          return originalDir;\n        }\n\n        placementObj.wasFlipped = true;\n        return newDir;\n      }\n\n      // switch the coordinate definitions\n      // since the axis for placement is flipped, our coordinate offsets should also flip\n      const tmp = placementObj.originalx;\n      placementObj.originalx = placementObj.originaly;\n      placementObj.originaly = tmp;\n\n      const perpendicularDistance = getDistance(perpendicularDir);\n      const oppPerpendicularDistance = getDistance(oppPerpendicularDir);\n\n      if (!tried(perpendicularDir)) {\n        if (perpendicularDistance >= oppPerpendicularDistance) {\n          return perpendicularDir;\n        }\n\n        if (!tried(oppPerpendicularDir)) {\n          return oppPerpendicularDir;\n        }\n      }\n\n      return originalDir;\n    }\n\n    placementObj.placement = performFlip(placementObj.placement);\n\n    return placementObj;\n  },\n\n  // TODO: Move Clockwise\n  clockwise(placementObj) {\n    return placementObj;\n  },\n\n  // If element height/width is greater than window height/width, shrink to fit\n  shrink(placementObj, dimension) {\n    const accountForScrolling = this.accountForScrolling(placementObj);\n    const containerBleed = this.settings.bleedFromContainer;\n    const container = this.getContainer(placementObj);\n    const containerRect = container ? container[0].getBoundingClientRect() : {};\n    const containerIsBody = container.length && container[0] === document.body;\n    const rect = this.element[0].getBoundingClientRect();\n    const useX = dimension === undefined || dimension === null || dimension === 'x';\n    const useY = dimension === undefined || dimension === null || dimension === 'y';\n    // NOTE: Usage of $(window) instead of $('body') is deliberate here - http://stackoverflow.com/a/17776759/4024149.\n    // Firefox $('body').scrollTop() will always return zero.\n    const scrollX = containerIsBody ? $(window).scrollLeft() : container.scrollLeft();\n    const scrollY = containerIsBody ? $(window).scrollTop() : container.scrollTop();\n    const windowH = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n    const windowW = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\n    const leftViewportEdge = (accountForScrolling ? scrollX : 0) +\n      (containerBleed ? 0 : containerRect.left) + placementObj.containerOffsetX;\n    const topViewportEdge = (accountForScrolling ? scrollY : 0) +\n      (containerBleed ? 0 : containerRect.top) + placementObj.containerOffsetY;\n    const rightViewportEdge = (accountForScrolling ? scrollX : 0) +\n      (containerBleed ? windowW : containerRect.right) - placementObj.containerOffsetX;\n    const bottomViewportEdge = (accountForScrolling ? scrollY : 0) +\n      (containerBleed ? windowH : containerRect.bottom) - placementObj.containerOffsetY;\n    let d;\n\n    // Shrink in each direction.\n    // The value of the \"containerOffsets\" is \"factored out\" of each calculation,\n    // if for some reason the element is larger than the viewport/container space allowed.\n    placementObj.nudges = placementObj.nudges || {};\n\n    if (useX) {\n      // Left\n      if (rect.left < leftViewportEdge) {\n        d = Math.abs(leftViewportEdge - rect.left);\n        if (rect.right >= rightViewportEdge) {\n          d -= placementObj.containerOffsetX;\n        }\n        placementObj.width = rect.width - d;\n        placementObj.setCoordinate('x', placementObj.x + d);\n        placementObj.nudges.x += d;\n      }\n\n      // Right\n      if (rect.right > rightViewportEdge) {\n        d = Math.abs(rect.right - rightViewportEdge);\n        if (rect.left <= leftViewportEdge) {\n          d -= placementObj.containerOffsetX;\n        }\n        placementObj.width = rect.width - d;\n      }\n    }\n\n    if (useY) {\n      // Top\n      if (rect.top < topViewportEdge) {\n        d = Math.abs(topViewportEdge - rect.top);\n        if (rect.bottom >= bottomViewportEdge) {\n          d -= placementObj.containerOffsetY;\n        }\n        placementObj.height = rect.height - d;\n        placementObj.setCoordinate('y', placementObj.y + d);\n        placementObj.nudges.y += d;\n      }\n\n      // Bottom\n      if (rect.bottom > bottomViewportEdge) {\n        d = Math.abs(rect.bottom - bottomViewportEdge);\n        if (rect.top <= topViewportEdge) {\n          d -= placementObj.containerOffsetY;\n        }\n        placementObj.height = rect.height - d;\n      }\n    }\n\n    return placementObj;\n  },\n\n  // Giving up causes all the placementObj settings to revert\n  giveup(placementObj) {\n    placementObj.giveup = true;\n    placementObj.strategy = this.settings.strategy;\n    placementObj.placement = this.settings.placement;\n    return placementObj;\n  },\n\n  // Clears the old styles that may be present\n  clearOldStyles() {\n    this.element[0].style.left = '';\n    this.element[0].style.top = '';\n    this.element[0].style.width = '';\n    this.element[0].style.height = '';\n\n    const os = this.originalStyles;\n    if (os) {\n      if (os.width) {\n        this.element[0].style.width = os.width;\n      }\n\n      if (os.height) {\n        this.element[0].style.height = os.height;\n      }\n    }\n\n    return this;\n  },\n\n  // Built-in method for handling positon of optional arrow elements.\n  // Used for tooltip/popovers/popupmenus\n  setArrowPosition(e, placementObj, element) {\n    let target = placementObj.parent;\n    const arrow = element.find('div.arrow');\n    const dir = placementObj.placement;\n    const isXCoord = ['left', 'right'].indexOf(dir) > -1;\n    let targetRect = {};\n    const elementRect = element[0].getBoundingClientRect();\n    let arrowRect = {};\n    let newArrowRect = {};\n    let hideArrow = false;\n\n    if (!target || !target.length || !arrow.length) {\n      return;\n    }\n\n    arrow[0].removeAttribute('style');\n\n    // if (placementObj.attemptedFlips) { TJM Removed for pager bug. Seems to work.\n    element.removeClass('top right bottom left').addClass(dir);\n    // }\n\n    // Flip the arrow if we're in RTL mode\n    if (this.isRTL && isXCoord) {\n      const opposite = dir === 'right' ? 'left' : 'right';\n      element.removeClass('right left').addClass(opposite);\n    }\n\n    // Custom target for some scenarios\n    if (target.is('.colorpicker')) {\n      target = target.next('.trigger');\n    }\n    if (target.is('.datepicker, .timepicker')) {\n      target = target.next('.icon');\n    }\n    if (target.is('.btn-split-menu, .btn-menu, .btn-actions, .btn-filter, .tab, .tab-more')) {\n      target = target.find('.icon').last();\n    }\n    if (target.is('.searchfield-category-button')) {\n      target = target.find('.icon.icon-dropdown');\n    }\n    if (target.is('.colorpicker-editor-button')) {\n      target = target.find('.trigger .icon');\n    }\n\n    // reset if we borked the target\n    if (!target.length) {\n      target = placementObj.parent;\n    }\n\n    targetRect = target.length ? target[0].getBoundingClientRect() : targetRect;\n    arrowRect = arrow.length ? arrow[0].getBoundingClientRect() : arrowRect;\n    newArrowRect = {};\n\n    function getMargin(placement) {\n      return (placement === 'right' || placement === 'left') ? 'margin-top' : 'margin-left';\n    }\n\n    function getDistance() {\n      let targetCenter = 0;\n      let currentArrowCenter = 0;\n      let d = 0;\n\n      if (dir === 'left' || dir === 'right') {\n        targetCenter = targetRect.top + (targetRect.height / 2);\n        currentArrowCenter = arrowRect.top + (arrowRect.height / 2);\n        d = targetCenter - currentArrowCenter;\n        newArrowRect.top = arrowRect.top + d;\n        newArrowRect.bottom = arrowRect.bottom + d;\n\n        if (newArrowRect.top <= elementRect.top || newArrowRect.bottom >= elementRect.bottom) {\n          hideArrow = true;\n        }\n      }\n      if (dir === 'top' || dir === 'bottom') {\n        targetCenter = targetRect.left + (targetRect.width / 2);\n        currentArrowCenter = arrowRect.left + (arrowRect.width / 2);\n        d = targetCenter - currentArrowCenter;\n        newArrowRect.left = arrowRect.left + d;\n        newArrowRect.right = arrowRect.right + d;\n\n        if (newArrowRect.left <= elementRect.left || newArrowRect.right >= elementRect.right) {\n          hideArrow = true;\n        }\n      }\n\n      return d;\n    }\n\n    // line the arrow up with the target element's \"dropdown icon\", if applicable\n    const positionOpts = {};\n    positionOpts[getMargin(dir)] = getDistance();\n    if (hideArrow) {\n      positionOpts.display = 'none';\n    }\n    arrow.css(positionOpts);\n  },\n\n  // Handle Updating Settings\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  // Simple Teardown - remove events & rebuildable markup.\n  teardown() {\n    this.clearOldStyles();\n    this.element.removeClass('placeable');\n\n    this.element.off(`updated.${COMPONENT_NAME} place.${COMPONENT_NAME}`);\n\n    this.element.trigger('afterteardown');\n    return this;\n  },\n\n  // Teardown - Remove added markup and events\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { PlacementObject, Place, COMPONENT_NAME };\n","import { Place, COMPONENT_NAME } from './place';\n\n/**\n * jQuery Component Wrapper for Place\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.place = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Place(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { base } from '../../utils/base';\nimport { utils } from '../../utils/utils';\n\n// component name\nconst COMPONENT_NAME = 'icon';\n\n// Default Options\nconst ICON_DEFAULTS = {\n  use: 'user-profile', // Match this to one of the IDS Enterprise icons, prefixed with an ID of '#icon-'\n  focusable: false\n};\n\n/**\n * Icon Control\n * Wraps SVG Icons with a Javascript control that can change the icon type, reference\n * relative or absolute URLs, and clean up after itself.  Works with the Base tag.\n * @constructor\n * @param {jQuery[]|HTMLElement} element the base element\n * @param {object} [settings] incoming settings\n * @param {string} [settings.use = 'user-profile'] the type of icon that will appear.\n *  (gets added to the `<use>` tag's `xlink:href` property)\n * @param {boolean} [settings.focusable = false] whether or not this icon gets a `tabIndex` and\n *  becomes a focusable element on the page.\n */\nfunction Icon(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, ICON_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nIcon.prototype = {\n\n  /**\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  init() {\n    this.getExistingUseTag();\n\n    // Do other init (change/normalize settings, load externals, etc)\n    return this\n      .render()\n      .handleEvents();\n  },\n\n  /**\n   * Add markup to the control\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  render() {\n    const self = this;\n    this.element.addClass('icon');\n\n    if (!this.element.is('svg')) {\n      // TODO: Possibly work with span-based icons here?\n      return this;\n    }\n\n    // Get a \"base-tag-proof\" version of the Use tag's definition.\n    // jQuery can't work with SVG elements, so we just modify it with regular DOM APIs\n    const use = this.element[0].getElementsByTagName('use')[0];\n    if (!use) {\n      return this;\n    }\n\n    if (use.getAttribute('xlink:href') !== self.getBasedUseTag()) {\n      use.setAttribute('xlink:href', self.getBasedUseTag());\n    }\n\n    return this;\n  },\n\n  /**\n   * Gets the currently used base tag.\n   * @returns {string} a version of this icon's definition prefixed with the current base tag's URL.\n   */\n  getBasedUseTag() {\n    return base.getBaseURL(`#icon-${this.settings.use}`);\n  },\n\n  /**\n   * Changes this icon instance's `use` setting to match an existing `<use> tag's\n   * `xlink:href` attribute. In the event that a <use> tag pre-exists on an icon,\n   * we want to retain it, and simply replace the settings.\n   * @chainable\n   * @returns {this} component instance\n   */\n  getExistingUseTag() {\n    if (!this.element.is('svg')) {\n      return this;\n    }\n\n    const useTag = this.element.children('use');\n    if (!useTag.length) {\n      return this;\n    }\n\n    const xlinkHref = useTag.attr('xlink:href');\n    this.settings.use = xlinkHref.replace('#icon-', '');\n\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this control and its sub-elements\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      self.updated();\n    });\n\n    return this;\n  },\n\n  /**\n   * Handle Updating Settings\n   * @chainable\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @chainable\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Icon, COMPONENT_NAME };\n","import { Icon, COMPONENT_NAME } from './icons';\n\n/**\n * jQuery component wrappers\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery-wrapped components being acted on.\n */\n$.fn.icon = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (!instance) {\n      instance = $.data(this, COMPONENT_NAME, new Icon(this, settings));\n    } else {\n      instance.updated(settings);\n    }\n  });\n};\n\n/**\n * Factory Function for instantly building icons.\n * Use this for building icons that don't exist yet.\n * Scoped Privately on purpose...\n */\n(function () {\n  function normalizeIconOptions(options) {\n    const defaults = {\n      icon: 'user-profile', // omit the \"icon-\" if you want; this code strips it out.\n      classes: ['icon']\n    };\n    options = options || $.extend({}, defaults);\n\n    if (typeof options === 'string') {\n      options = $.extend({}, defaults, {\n        icon: options.replace('icon-', '')\n      });\n    }\n\n    // reroute \"options.class\" if that exists\n    if (!options.classes && options.class) {\n      options.classes = options.class;\n      delete options.class;\n    }\n\n    if (!options.classes) {\n      options.classes = [].concat(defaults.classes);\n    }\n\n    if (typeof options.classes === 'string') {\n      options.classes = options.classes.split(' ');\n    }\n\n    if (options.classes.indexOf('icon') === -1) {\n      options.classes.push('icon');\n    }\n\n    return options;\n  }\n\n  // Returns the RAW HTML for creating a new icon in string form\n  $.createIcon = function createIcon(options) {\n    options = normalizeIconOptions(options);\n\n    return [\n      `<svg class=\"${options.classes.join(' ')}\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">` +\n        `<use xlink:href=\"#icon-${options.icon}\"></use>` +\n      '</svg>'\n    ].join('');\n  };\n\n  // Returns a jQuery-wrapped element containing a new icon\n  $.createIconElement = function createIconElement(options) {\n    return $($.createIcon(options));\n  };\n\n  // Returns just the path part\n  $.createIconPath = function createIconElement(options) {\n    options = normalizeIconOptions(options);\n    return $.getBaseURL(`#icon-${options.icon.replace('icon-', '')}`);\n  };\n\n  // Toggle the use or entire svg icon in the case of the polyfill\n  $.fn.changeIcon = function (icon) {\n    $(this).find('use').attr('xlink:href', $.createIconPath({ icon }));\n  };\n\n  $.fn.getIconName = function () {\n    const svg = $(this);\n    const use = svg.find('use');\n\n    if (use.length === 1) {\n      return use.attr('xlink:href').substr(use.attr('xlink:href').indexOf('#icon-') + 6);\n    }\n    return svg.attr('data-icon');\n  };\n}());\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\nimport { Locale } from '../locale/locale';\n\n// jQuery components\nimport '../icons/icons.jquery';\n\n// The name of this component.\nconst COMPONENT_NAME = 'button';\n\n/**\n * Soho Button Element\n * @class Button\n * @param {string} element The component element.\n * @param {string} [settings] The component settings.\n * @param {string} [settings.toggleOnIcon=null]  The icon to use for on state on toggle buttons\n * @param {string} [settings.toggleOffIcon=null]  The icon to use for off state on toggle buttons\n * @param {string} [settings.replaceText=false]  If true the selection will be used to replace the content\n */\nconst BUTTON_DEFAULTS = {\n  toggleOnIcon: null,\n  toggleOffIcon: null,\n  hideMenuArrow: null,\n  replaceText: false\n};\n\nfunction Button(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(element, settings, BUTTON_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nButton.prototype = {\n  init() {\n    const self = this;\n\n    this.isTouch = env.features.touch;\n    this.isSafari = $('html').is('.is-safari');\n    this.isFirefox = $('html').is('.is-firefox');\n\n    if (this.element.hasClass('no-ripple')) {\n      return;\n    }\n\n    if (this.element.hasClass('btn-menu') && !this.element.hasClass('btn-icon') && !this.element.hasClass('btn-actions')) {\n      let ddIcon = this.element.children('svg.icon');\n      const use = ddIcon.find('use');\n      let hasIcon = false;\n\n      if (ddIcon.length > 0 && use.length === 1) {\n        hasIcon = use.attr('xlink:href').indexOf('#icon-dropdown') > -1;\n      }\n\n      if (!hasIcon) {\n        ddIcon = $.createIconElement({ icon: 'dropdown', classes: ['icon-dropdown'] });\n        this.element.append(ddIcon);\n      }\n\n      if (!ddIcon.hasClass('icon-dropdown')) {\n        ddIcon.addClass('icon-dropdown');\n      }\n\n      if (this.settings.replaceText) {\n        this.element.on('selected.content', function (e, a) {\n          $(this).find('span').text(a.text());\n        });\n      }\n\n      if (this.settings.hideMenuArrow) {\n        ddIcon.remove();\n      }\n    }\n\n    if (this.element.hasClass('btn-toggle') || this.element.hasClass('icon-favorite')) {\n      this.element.on('click.favorite', function () {\n        const elem = $(this);\n        const svg = elem.find('svg:not(.ripple-effect)');\n        const isPressed = elem.attr('aria-pressed') === 'true';\n\n        elem.attr('aria-pressed', isPressed ? 'false' : 'true');\n        if (self.settings.toggleOffIcon && self.settings.toggleOnIcon) {\n          svg.changeIcon(isPressed ? self.settings.toggleOffIcon : self.settings.toggleOnIcon);\n        } else {\n          elem.toggleClass('is-pressed');\n        }\n\n        if (elem.hasClass('icon-favorite') && !elem.hasClass('btn-toggle') && svg.find('use').attr('xlink:href') === '#icon-star-filled') {\n          svg.changeIcon('star-outlined');\n        } else if (elem.hasClass('icon-favorite') && !elem.hasClass('btn-toggle')) {\n          svg.changeIcon('star-filled');\n        }\n      });\n\n      if (!this.element.attr('aria-pressed')) {\n        this.element.attr('aria-pressed', 'false');\n      }\n    }\n\n    // Standalone action buttons need a \"More Actions\" tooltip.\n    // This is handled internally on most components that implement an action button.\n    if (this.element.hasClass('btn-actions') && (!this.element.parents('.field').length && !this.element.parents('.toolbar').length)) {\n      if (!this.element.data('tooltip')) {\n        this.element.attr('title', Locale.translate('More')).tooltip({\n          content: Locale.translate('More')\n        });\n      }\n    }\n\n    this.element.hideFocus();\n\n    this.element\n      .on('touchstart.button click.button', function (e) {\n        if ((self.element.attr('disabled')) || self.element.is('.is-disabled') || (!self.isTouch && e.which !== 1) ||\n          ($('.ripple-effect', this).length) || (self.isTouch && e.type !== 'touchstart')) {\n          return;\n        }\n\n        const element = $(this);\n        const btnOffset = element.offset();\n        let xPos = e.pageX - btnOffset.left;\n        let yPos = e.pageY - btnOffset.top;\n        const ripple = $('<svg class=\"ripple-effect\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><circle r=\"0\" class=\"ripple-circle\"></circle></svg>');\n\n        if (self.isTouch) {\n          // Make sure the user is using only one finger and then get the touch position relative\n          // to the ripple wrapper\n          e = e.originalEvent;\n          if (e && e.touches && e.touches.length === 1) {\n            xPos = e.touches[0].pageX - btnOffset.left;\n            yPos = e.touches[0].pageY - btnOffset.top;\n          }\n        }\n\n        // Using keyboard to click\n        xPos = (xPos < 0) ? self.element.outerWidth() / 2 : xPos;\n        yPos = (yPos < 0) ? self.element.outerHeight() / 2 : yPos;\n\n        $('svg.ripple-effect', element).remove();\n        ripple[0].style.left = `${xPos}px`;\n        ripple[0].style.top = `${yPos}px`;\n        element.prepend(ripple);\n\n        // Start the JS Animation Loop if IE9\n        // Or Safari/Firefox has bug with combination like: animation, overflow, position,\n        // border-radius etc.)\n        if (!$.fn.cssPropSupport('animation') || self.isSafari && !env.features.touch || self.isFirefox) {\n          ripple.removeClass('is-animation');\n          self.animateWithJS(ripple);\n        } else {\n          const elem = $('svg.ripple-effect', element);\n          elem.addClass('is-animation');\n        }\n\n        setTimeout(() => {\n          ripple.remove();\n        }, 1000);\n      });\n  },\n\n  // Browsers that don't support CSS-based animation can still show the animation\n  animateWithJS(el) {\n    const scale = 200;\n    const elStyle = el[0].style;\n    const xPos = `${parseFloat(elStyle.left) - (scale / 2)}px`;\n    const yPos = `${parseFloat(elStyle.top) - (scale / 2)}px`;\n\n    el[0].style.opacity = '0.4';\n    el.animate({\n      opacity: 0,\n      left: xPos,\n      top: yPos,\n      width: scale,\n      height: scale\n    }, 1000);\n  },\n\n  /**\n   * Update the component with new settings.\n   * @param  {object} settings The settings you would like to modify.\n   * @returns {object} The api.\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.extend({}, this.settings, settings);\n    }\n    return this;\n  },\n\n  /**\n  * Teardown and remove any added markup and events.\n  * @returns {void}\n  */\n  destroy() {\n    this.element.off('click.button touchstart.button focusin.hide-focus focusout.hide-focus mousedown.hide-focus touchstart.hide-focus');\n\n    const moreTooltip = this.element.data('tooltip');\n    if (this.element.hasClass('btn-actions') && moreTooltip) {\n      moreTooltip.destroy();\n    }\n\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n  *  Fires when the button is clicked (if enabled).\n  *\n  * @event click\n  * @memberof Button\n  * @param {object} event - The jquery event object\n  */\n  /**\n  * Fires when the button is focused.\n  *\n  * @event focus\n  * @memberof Button\n  * @param {object} event - The jquery event object\n  */\n};\n\nexport { Button, COMPONENT_NAME };\n","import { Button, COMPONENT_NAME } from './button';\n\n/**\n * jQuery Component Wrapper for the Soho Button Element\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery-wrapped components being acted on\n */\n$.fn.button = function jQueryButton(settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Button(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { HideFocus } from '../../utils/behaviors';\n\nconst COMPONENT_NAME = 'hyperlink';\n\n/**\n * Soho component wrapper for Hyperlinks.\n * @class Hyperlink\n *\n * @param {HTMLElement} element the base Hyperlink element\n * @param {object} [settings] incoming settings\n * @returns {this} component instance\n */\n\nconst HYPERLINK_DEFAULTS = {};\n\nfunction Hyperlink(element, settings) {\n  return this.init(element, settings);\n}\n\nHyperlink.prototype = {\n  init(element, settings) {\n    if (!this.element && element instanceof HTMLElement) {\n      this.element = element;\n    }\n\n    if (typeof settings === 'object') {\n      const previousSettings = this.settings || HYPERLINK_DEFAULTS;\n      this.settings = utils.mergeSettings(this.element, settings, previousSettings);\n    }\n\n    if (!this.focusBehavior) {\n      this.focusBehavior = new HideFocus(this.element);\n    }\n\n    return this;\n  },\n\n  /**\n   * Attach Events used by the Hyperlinks\n   * @private\n   * @returns {this} The component api for chaining.\n   */\n  handleEvents() {\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Removes the events and pseudo-markup created by the hyperlinks\n   * @returns {this} component instance\n   */\n  teardown() {\n    return this;\n  }\n};\n\nexport { Hyperlink, COMPONENT_NAME };\n","import { Hyperlink, COMPONENT_NAME } from './hyperlinks';\n\n/**\n * jQuery Component Wrapper for Hyperlink\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery-wrapped components being acted on\n */\n$.fn.hyperlink = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Hyperlink(this, settings));\n      instance.destroy = function destroy() {\n        this.teardown();\n        $.removeData(this, COMPONENT_NAME);\n      };\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { stringUtils as str } from '../../utils/string';\nimport { Locale } from '../locale/locale';\n\n/**\n * Contains various Mask-related utilities, settings, masking functions, etc.\n * Available globally under `Soho.masks`.\n * @property {string} EMPTY_STRING just an empty string\n * @property {string} PLACEHOLDER_CHAR the default placeholder used in guides\n * @property {string} CARET_TRAP the string of characters representing a caret trap in mask arrays\n * @property {regexp} NON_DIGITS_REGEX regular expression that matches non-digit characters\n * @property {regexp} DIGITS_REGEX regular expression that matches digit characters\n * @property {regexp} ALPHAS_REGEX regular expression that matches alphabetic, non-special characters\n * @property {regexp} ANY_REGEX regular expression that matches any non-special characters\n * @property {object} LEGACY_DEFS mask definitions used by the old Soho Mask component.\n *  Will be translated to RegExp when a string-based pattern is convered to an array in the new Mask.\n * @property {object} DEFAULT_API_OPTIONS base options passed to a Mask API.\n * @property {object} DEFAULT_CONFORM_OPTIONS default set of options that get passed to `maskAPI.conformToMask()`\n */\nconst masks = {\n\n  EMPTY_STRING: '',\n\n  PLACEHOLDER_CHAR: '_',\n\n  CARET_TRAP: '[]',\n\n  NON_DIGITS_REGEX: /[^\\u0660-\\u06690-9\\u0966-\\u096F\\u2E80-\\u2FD5\\u3190-\\u319f\\u3400-\\u4DBF\\u4E00-\\u9FCC\\uF900-\\uFAAD]/g,\n\n  DIGITS_REGEX: /[\\u0660-\\u06690-9\\u0966-\\u096F\\u2E80-\\u2FD5\\u3190-\\u319f\\u3400-\\u4DBF\\u4E00-\\u9FCC\\uF900-\\uFAAD]/,\n\n  ALPHAS_REGEX: /[\\u00C0-\\u017Fa-zA-Z]/,\n\n  ANY_REGEX: /[\\u00C0-\\u017Fa-zA-Z0-9]/,\n\n  DEFAULT_API_OPTIONS: {\n    locale: 'en-US',\n    pattern: undefined,\n    pipe: undefined\n  }\n\n};\n\n// Legacy Mask pattern definitions.\n// The New Mask works based on an array of RegExps and Strings.\nmasks.LEGACY_DEFS = {\n  '#': masks.DIGITS_REGEX,\n  0: masks.DIGITS_REGEX,\n  x: masks.ALPHAS_REGEX,\n  '*': masks.ANY_REGEX,\n  '?': /./,\n  '~': /[-0-9]/,\n  a: /[APap]/,\n  m: /[Mm]/\n};\n\n// Default options that get passed for the _conformToMask()_ method.\nmasks.DEFAULT_CONFORM_OPTIONS = {\n  caretTrapIndexes: [],\n  guide: true,\n  previousMaskResult: masks.EMPTY_STRING,\n  placeholderChar: masks.PLACEHOLDER_CHAR,\n  placeholder: masks.EMPTY_STRING,\n  selection: {\n    start: 0\n  },\n  keepCharacterPositions: true\n};\n\n// Default Number Mask Options\nconst DEFAULT_NUMBER_MASK_OPTIONS = {\n  prefix: masks.EMPTY_STRING,\n  suffix: masks.EMPTY_STRING,\n  allowThousandsSeparator: true,\n  symbols: {\n    currency: '$',\n    decimal: '.',\n    negative: '-',\n    thousands: ','\n  },\n  allowDecimal: true,\n  decimalLimit: 2,\n  locale: '',\n  requireDecimal: false,\n  allowNegative: false,\n  allowLeadingZeroes: false,\n  integerLimit: null\n};\n\n// Converts a string representing a formatted number into a Number Mask.\n// @param {string} strNumber incoming string\n// @returns {array} contains strings representing character literals and regex patterns.\nfunction convertToMask(strNumber) {\n  return strNumber\n    .split(masks.EMPTY_STRING)\n    .map(char => (masks.DIGITS_REGEX.test(char) ? masks.DIGITS_REGEX : char));\n}\n\n// Adds thousands separators to the correct spot in a formatted number string.\n// @param {string} n - the string\n// @param {string} thousands - the thousands separator.\n// @param {string} [locale] - if defined, uses a custom locale string for formatting\n// @param {object} [options] - settings for `toLocaleString`\n// @returns {string} the incoming string formatted with a thousands separator.\n// http://stackoverflow.com/a/10899795/604296\nfunction addThousandsSeparator(n, thousands, locale, options) {\n  if (n === '' || isNaN(n)) {\n    return n;\n  }\n  return Locale.toLocaleString(Number(n), locale, options);\n}\n\n// Gets an array of Regex objects matching the number of digits present in a source string\n// @param {string} part string representing the mark part.\n// @param {string} type 'any', 'digits', or 'alphas'\n// @returns {array} regex representing the part that was passed in.\nfunction getRegexForPart(part, type) {\n  const types = {\n    any: masks.ANY_REGEX,\n    digits: masks.DIGITS_REGEX,\n    alphas: masks.ALPHAS_REGEX\n  };\n\n  if (!types[type]) {\n    type = 'any';\n  }\n\n  let size = part.toString().length;\n  const arr = [];\n\n  while (size > 0) {\n    arr.push(types[type]);\n    size -= 1;\n  }\n  return arr;\n}\n\n/**\n * Soho Number Mask Function\n * @param {string} rawValue the un-formatted value that will eventually be masked.\n * @param {object} options masking options\n * @returns {array} representing a mask that will match a formatted number.\n */\nmasks.numberMask = function sohoNumberMask(rawValue, options) {\n  options = utils.mergeSettings(undefined, options, DEFAULT_NUMBER_MASK_OPTIONS);\n  if (!options.locale || !options.locale.length) {\n    options.locale = Locale.currentLocale.name;\n  }\n\n  const PREFIX = options.prefix;\n  const SUFFIX = options.suffix;\n  const DECIMAL = options.symbols.decimal;\n  const THOUSANDS = options.symbols.thousands;\n  const prefixLength = PREFIX && PREFIX.length || 0;\n  const suffixLength = SUFFIX && SUFFIX.length || 0;\n  const thousandsSeparatorSymbolLength = THOUSANDS && THOUSANDS.length || 0;\n\n  function numberMask(thisRawValue) {\n    if (typeof thisRawValue !== 'string') {\n      thisRawValue = masks.EMPTY_STRING;\n    }\n\n    const rawValueLength = thisRawValue.length;\n\n    if (\n      thisRawValue === masks.EMPTY_STRING ||\n      (thisRawValue[0] === PREFIX[0] && rawValueLength === 1)\n    ) {\n      return PREFIX.split(masks.EMPTY_STRING).concat([masks.DIGITS_REGEX])\n        .concat(SUFFIX.split(masks.EMPTY_STRING));\n    } else if (\n      thisRawValue === DECIMAL && options.allowDecimal\n    ) {\n      return PREFIX.split(masks.EMPTY_STRING).concat(['0', DECIMAL, masks.DIGITS_REGEX])\n        .concat(SUFFIX.split(masks.EMPTY_STRING));\n    }\n\n    const indexOfLastDecimal = thisRawValue.lastIndexOf(DECIMAL);\n    const hasDecimal = indexOfLastDecimal !== -1;\n    const isNegative = (thisRawValue[0] === options.symbols.negative) && options.allowNegative;\n    let integer;\n    let fraction;\n    let mask;\n\n    // remove the suffix\n    if (thisRawValue.slice(suffixLength * -1) === SUFFIX) {\n      thisRawValue = thisRawValue.slice(0, suffixLength * -1);\n    }\n\n    if (hasDecimal) {\n      integer = thisRawValue.slice(thisRawValue.slice(0, prefixLength) === PREFIX ?\n        prefixLength : 0, indexOfLastDecimal);\n\n      fraction = thisRawValue.slice(indexOfLastDecimal + 1, rawValueLength);\n      fraction = convertToMask(fraction.replace(masks.NON_DIGITS_REGEX, masks.EMPTY_STRING));\n    } else if (thisRawValue.slice(0, prefixLength) === PREFIX) {\n      integer = thisRawValue.slice(prefixLength);\n    } else {\n      integer = thisRawValue;\n    }\n\n    if (options.integerLimit && typeof options.integerLimit === 'number') {\n      const thousandsSeparatorRegex = THOUSANDS === '.' ? '[.]' : `${THOUSANDS}`;\n      const numberOfThousandSeparators = (integer.match(new RegExp(thousandsSeparatorRegex, 'g')) || []).length;\n\n      integer = integer.slice(0, options.integerLimit + (isNegative ? 1 : 0) +\n        (numberOfThousandSeparators * thousandsSeparatorSymbolLength));\n    }\n\n    integer = integer.replace(masks.NON_DIGITS_REGEX, masks.EMPTY_STRING);\n\n    if (!options.allowLeadingZeroes) {\n      integer = integer.replace(/^0+(0$|[^0])/, '$1');\n    }\n\n    const localeOptions = {\n      maximumFractionDigits: options.decimalLimit,\n      style: 'decimal',\n      useGrouping: true\n    };\n    integer = (options.allowThousandsSeparator) ?\n      addThousandsSeparator(integer, THOUSANDS, options.locale, localeOptions) : integer;\n\n    mask = convertToMask(integer);\n\n    if ((hasDecimal && options.allowDecimal) || options.requireDecimal === true) {\n      if (thisRawValue[indexOfLastDecimal - 1] !== DECIMAL) {\n        mask.push(masks.CARET_TRAP);\n      }\n\n      mask.push(DECIMAL, masks.CARET_TRAP);\n\n      if (fraction) {\n        if (typeof options.decimalLimit === 'number') {\n          fraction = fraction.slice(0, options.decimalLimit);\n        }\n\n        mask = mask.concat(fraction);\n      }\n\n      if (options.requireDecimal === true && thisRawValue[indexOfLastDecimal - 1] === DECIMAL) {\n        mask.push(masks.DIGITS_REGEX);\n      }\n    }\n\n    if (prefixLength > 0) {\n      mask = PREFIX.split(masks.EMPTY_STRING).concat(mask);\n    }\n\n    if (isNegative) {\n      // If user is entering a negative number, add a mask placeholder spot to\n      // attract the caret to it.\n      // TODO: Allow the negative symbol as the suffix as well (SOHO-3259)\n      if (mask.length === prefixLength) {\n        mask.push(masks.DIGITS_REGEX);\n      }\n\n      mask = [/-/].concat(mask);\n    }\n\n    if (SUFFIX.length > 0) {\n      mask = mask.concat(SUFFIX.split(masks.EMPTY_STRING));\n    }\n\n    return mask;\n  }\n\n  numberMask.instanceOf = 'createNumberMask';\n\n  return numberMask(rawValue);\n};\n\n// Default Date Mask Options\nconst DEFAULT_DATETIME_MASK_OPTIONS = {\n  format: 'M/d/yyyy',\n  symbols: {\n    timeSeparator: ':',\n    dayPeriodSeparator: ' ',\n    dateSeparator: '/'\n  }\n};\n\n// Maximum Values for various section maps of date strings.\nconst DATE_MAX_VALUES = {\n  dd: 31,\n  d: 31,\n  MMM: undefined,\n  MM: 12,\n  M: 12,\n  yy: 99,\n  yyyy: 9999,\n  h: 12,\n  hh: 12,\n  H: 24,\n  HH: 24,\n  mm: 60,\n  ss: 60,\n  a: undefined\n};\n\n/**\n * Soho Date Mask Function\n * @param {string} rawValue the un-formatted value that will eventually be masked.\n * @param {object} options masking options\n * @returns {array} representing a mask that will match a formatted date.\n */\nmasks.dateMask = function dateMask(rawValue, options) {\n  options = utils.mergeSettings(undefined, options, DEFAULT_DATETIME_MASK_OPTIONS);\n\n  let mask = [];\n  const digitRegex = masks.DIGITS_REGEX;\n  const format = options.format;\n  const splitterStr = str.removeDuplicates(format.replace(/[dMyHhmsa]+/g, ''));\n  const splitterRegex = new RegExp(`[${splitterStr}]+`);\n  const formatArray = format.split(/[^dMyHhmsa]+/);\n  const rawValueArray = rawValue.split(splitterRegex);\n  const maxValue = DATE_MAX_VALUES;\n\n  formatArray.forEach((part, i) => {\n    const value = maxValue[part];\n    let size;\n\n    if (part === 'a') {\n      // Match the day period\n      mask.push(/[aApP]/, /[Mm]/);\n    } else if (!value) {\n      mask = mask.concat(getRegexForPart(part, 'alphas'));\n    } else if (rawValueArray[i]) {\n      // Detect based on the size of a pre-existing formatted value, if possible.\n      const rawValueStr = rawValueArray[i].toString();\n      const rawValueFirstDigit = parseInt(rawValueStr.substr(0, 1), 10);\n      const maxFirstDigit = parseInt(maxValue[part].toString().substr(0, 1), 10);\n\n      if (part.length === 1 && rawValueFirstDigit > maxFirstDigit) {\n        mask.push(digitRegex);\n      } else if (rawValueStr !== '0' && rawValueStr.length === 1 && rawValueFirstDigit <= maxFirstDigit && rawValueArray[i + 1] !== undefined && part.toUpperCase() !== 'HH') {\n        mask.push(digitRegex);\n      } else {\n        mask = mask.concat(getRegexForPart(value, 'digits'));\n      }\n    } else {\n      // If NOT possible, pass back the maximum digit length that can be entered here\n      size = value.toString().length;\n      while (size > 0) {\n        mask.push(digitRegex);\n        size -= 1;\n      }\n    }\n\n    // If this is not the last part, add whatever literals come after this part,\n    // but before the next part.\n    const nextPart = formatArray[i + 1];\n    if (nextPart !== undefined) {\n      const thisPartSize = part.toString().length;\n      const start = format.indexOf(part) + thisPartSize;\n      const end = format.indexOf(nextPart);\n      const literals = format.substring(start, end).split(masks.EMPTY_STRING);\n\n      mask = mask.concat(literals);\n    }\n  });\n\n  return mask;\n};\n\n/**\n * Soho Range Date Mask Function\n * @param {string} rawValue the un-formatted value that will eventually be masked.\n * @param {object} options masking options\n * @returns {array} representing a mask that will match a formatted date.\n */\nmasks.rangeDateMask = function (rawValue, options) {\n  const parts = rawValue.split(options.delimeter);\n  const delimiterArr = options.delimeter.split('');\n  const firstDate = masks.dateMask(parts[0], options);\n  let secondDate = [];\n\n  if (parts[1]) {\n    secondDate = masks.dateMask(parts[1], options);\n  }\n\n  return firstDate.concat(delimiterArr.concat(secondDate));\n};\n\n/**\n * Generates a pipe function that can be applied to a Mask API that will correct\n * shorthand numeric dates.\n * NOTE: DOES NOT WORK FOR DATES WITH ALPHABETIC CONTENT. Do not use this if your\n * dates contain \"MMM\" or the full month name.\n * @param {object} processResult the results object of a mask process\n * @param {object} options settings for the date pipe function\n * @returns {object} the result of the piping function's changes\n */\nmasks.autocorrectedDatePipe = function autoCorrectedDatePipe(processResult, options) {\n  if (!options.dateFormat) {\n    options.dateFormat = Locale.calendar().dateFormat.short;\n  }\n\n  const indexesOfPipedChars = [];\n  const dateFormatArray = options.dateFormat.split(/[^dMy]+/);\n  const maxValue = { d: 31, M: 12, yy: 99, yyyy: 9999 };\n  const minValue = { d: 1, M: 1, yy: 0, yyyy: 1 };\n  const conformedValueArr = processResult.conformedValue.split('');\n\n  // Check first digit\n  dateFormatArray.forEach((format) => {\n    const position = options.dateFormat.indexOf(format);\n    const maxFirstDigit = parseInt(maxValue[format].toString().substr(0, 1), 10);\n\n    if (parseInt(conformedValueArr[position], 10) > maxFirstDigit) {\n      conformedValueArr[position + 1] = conformedValueArr[position];\n      conformedValueArr[position] = 0;\n      indexesOfPipedChars.push(position);\n    }\n  });\n\n  const placeholderRegex = new RegExp(`[^${processResult.placeholderChar}]`);\n  const maskPieces = processResult.placeholder.split(placeholderRegex);\n  const conformedPieces = processResult.conformedValue.split(/\\D/g);\n\n  // Check for invalid date\n  const isInvalid = dateFormatArray.some((format, i) => {\n    const length = maskPieces[i].length > format.length ? maskPieces[i].length : format.length;\n    const textValue = conformedPieces[i] || '';\n    const value = parseInt(textValue, 10);\n\n    return value > maxValue[format] || (textValue.length === length && value < minValue[format]);\n  });\n\n  if (isInvalid) {\n    return false;\n  }\n\n  return {\n    value: conformedValueArr.join(''),\n    characterIndexes: indexesOfPipedChars\n  };\n};\n\nexport { masks };\n","/* eslint-disable no-continue, no-underscore-dangle, no-restricted-syntax, no-labels */\nimport { utils } from '../../utils/utils';\nimport { masks } from './masks';\n\n/**\n * @class MaskAPI\n * @constructor\n * @param {object} [settings] incoming settings\n */\nfunction MaskAPI(settings) {\n  this.configure(settings);\n  return this;\n}\n\nMaskAPI.prototype = {\n\n  /**\n   * Configure the API for an incoming mask request.\n   * Set up patterns, change locale, basically 'pre-render'\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  configure(settings) {\n    if (!this.settings) {\n      this.settings = {};\n    }\n\n    if (!settings) {\n      return this;\n    }\n\n    if (settings.locale) {\n      // TODO: store references to thousands sep, decimal, currency symbols,\n      // etc for the specified locale.\n      this.locale = settings.locale;\n    }\n\n    // Pre-define a stored Mask pattern.\n    // In cases where the mask is a string (Legacy Soho Mask), the string is automatically converted\n    // to an array containing regex patterns.\n    // In cases where the mask is a function, the function call is stored and called when the mask\n    // needs to be processed.\n    if (settings.pattern) {\n      if (Array.isArray(settings.pattern) || typeof settings.pattern === 'function') {\n        this.pattern = settings.pattern;\n      } else if (typeof settings.pattern === 'string') {\n        const defs = utils.mergeSettings(\n          undefined,\n          (settings.definitions || {}),\n          masks.LEGACY_DEFS\n        );\n        this.pattern = this._convertPatternFromString(settings.pattern, defs);\n      } else {\n        // TODO: fail somehow?\n      }\n    }\n\n    if (settings.patternOptions) {\n      this.patternOptions = settings.patternOptions;\n    }\n\n    return this;\n  },\n\n  /**\n   * Process a string against the masking algorithm\n   * @param {string} rawValue the original, unmasked value\n   * @param {object} [opts] process options\n   * @returns {object} containing the processed mask along with some meta-data\n   */\n  process(rawValue, opts) {\n    if (typeof rawValue !== 'string') {\n      throw new Error('No string provided');\n    }\n\n    let providedMask;\n    let processResult = {\n      originalValue: rawValue,\n      caretPos: opts.selection.start,\n      maskResult: false\n    };\n\n    // Setup the pattern if it's a function.\n    if (typeof this.pattern === 'function') {\n      if (!opts.patternOptions) {\n        opts.patternOptions = {};\n      }\n\n      // Merge incoming settings\n      const maskOpts = utils.extend({}, this.patternOptions, opts.patternOptions, {\n        caretPos: opts.selection.start,\n        previousMaskResult: opts.previousMaskResult\n      });\n\n      // Get a processed mask pattern from the function\n      providedMask = this.pattern(rawValue, maskOpts);\n\n      // mask functions can setup caret traps to have some control over how the caret\n      // moves. We need to process the mask for any caret traps. `processCaretTraps`\n      // will remove the caret traps from the mask and return the indexes of the caret traps.\n      const caretTrapInfo = this._processCaretTraps(providedMask);\n\n      // The processed mask is what we're interested in\n      providedMask = caretTrapInfo.maskWithoutCaretTraps;\n\n      // And we need to store these indexes because they're needed by `adjustCaretPosition`\n      opts.caretTrapIndexes = caretTrapInfo.indexes;\n    } else {\n      // Use a provided array\n      providedMask = this.pattern;\n    }\n\n    // As a convenience, setting the mask to false will cause it to return without processing.\n    if (providedMask === false) {\n      return processResult;\n    }\n\n    try {\n      processResult = this._conformToMask(rawValue, providedMask, opts);\n    } catch (e) {\n      // console.error('Couldn\\'t complete masking process: \"'+ e.message +'\"');\n      return processResult;\n    }\n\n    // Handle the optional \"pipe\" cleanup method, if applicable.\n    if (typeof opts.pipe === 'function') {\n      let pipeResult = {};\n\n      // `pipe` receives the entire `processResult` object and the configurations with which\n      // `conformToMask` was called.\n      try {\n        pipeResult = opts.pipe(processResult, opts);\n      } catch (e) {\n        // console.error('Couldn\\'t complete mask\\'s pipe function: \"'+ e.message +'\"');\n        pipeResult = false;\n      }\n\n      // `pipeResults` should be an object. But as a convenience, we allow the pipe\n      // author to just return `false` to indicate rejection. Or return just a string when there\n      // are no piped characters.\n      // If the `pipe` returns `false` or a string, the block below turns it into an\n      // object that the rest of the code can work with.\n      if (pipeResult === false) {\n        // If the `pipe` rejects `conformedValue`, we use the `previousConformedValue`,\n        // and set `rejected` to `true`.\n        processResult.pipeResult = false;\n        processResult.pipedValue = opts.previousMaskResult;\n      } else if (utils.isString(pipeResult)) {\n        processResult.pipeResult = true;\n        processResult.pipedValue = pipeResult;\n        processResult.pipedCharIndexes = [];\n      } else {\n        processResult = utils.extend({}, processResult, {\n          pipeResult: pipeResult.result,\n          pipedValue: pipeResult.value,\n          pipedCharIndexes: pipeResult.characterIndexes\n        });\n      }\n    }\n\n    return processResult;\n  },\n\n  /**\n   * Processes a raw string value against a masking algorithm and removes unfavorable chracters.\n   * @private\n   * @param {string} rawValue incoming full text string to process.\n   * @param {array} mask the mask to be used for modifying the raw value.\n   * @param {object} [settings] incoming settings for mask parsing.\n   * @returns {object} containing the conformation result and some meta-data\n   */\n  _conformToMask(rawValue, mask, settings) {\n    // Set default settings\n    settings = utils.mergeSettings(undefined, settings, masks.DEFAULT_CONFORM_OPTIONS);\n\n    // Setup the placeholder version of the mask\n    settings.placeholder = this._convertMaskToPlaceholder(mask, settings.placeholderChar);\n\n    // Setup booleans and numbers for various settings (speed)\n    let charactersRejected = false;\n    const suppressGuide = settings.guide === false && settings.previousMaskResult !== undefined;\n    const rawValueLength = rawValue.length;\n    const prevMaskResultLength = settings.previousMaskResult.length;\n    const maskLength = this.pattern.length;\n    const placeholderLength = settings.placeholder.length || 0;\n    const placeholderChar = settings.placeholderChar;\n    const caretPos = settings.selection.start;\n    let resultStr = masks.EMPTY_STRING;\n\n    const editDistance = rawValueLength - prevMaskResultLength;\n    const isAddition = editDistance > 0;\n    const indexOfFirstChange = caretPos + (isAddition ? -editDistance : 0);\n    const indexOfLastChange = indexOfFirstChange + Math.abs(editDistance);\n\n    // If `_conformToMask()` is configured to keep character positions, that is,\n    // for mask 111, previous value _2_ and raw value 3_2_, the new conformed value\n    // should be 32_, not 3_2 (default behavior). That's in the case of addition.\n    // And in the case of deletion, previous value _23, raw value _3, the new conformed\n    // string should be __3, not _3_ (default behavior)\n    //\n    // The next block of logic handles keeping character positions for the case\n    // of deletion. (Keeping character positions for the case of addition is further\n    // down since it is handled differently.)\n    // To do this, we want to compensate for all characters that were deleted\n    if (settings.keepCharacterPositions === true && !isAddition) {\n      // We will be storing the new placeholder characters in this variable.\n      let compensatingPlaceholderChars = masks.EMPTY_STRING;\n\n      // For every character that was deleted from a placeholder position, we add a placeholder char\n      for (let i = indexOfFirstChange; i < indexOfLastChange; i++) {\n        if (settings.placeholder[i] === placeholderChar) {\n          compensatingPlaceholderChars += placeholderChar;\n        }\n      }\n\n      // Now we trick our algorithm by modifying the raw value to make it contain\n      // additional placeholder characters. That way when the we start laying the\n      // characters again on the mask, it will keep the non-deleted characters\n      // in their positions.\n      rawValue = (\n        rawValue.slice(0, indexOfFirstChange) +\n        compensatingPlaceholderChars +\n        rawValue.slice(indexOfFirstChange, rawValueLength)\n      );\n    }\n\n    // Convert `rawValue` string to an array, and mark characters based on whether\n    // they are newly added or have existed in the previous conformed value. Identifying new\n    // and old characters is needed for `_conformToMask()` to work if it is configured\n    // to keep character positions.\n    function markAddedChars(char, j) {\n      return {\n        char,\n        isNew: j >= indexOfFirstChange && j < indexOfLastChange\n      };\n    }\n    const rawValueArr = rawValue.split(masks.EMPTY_STRING).map(markAddedChars);\n\n    // The loop below removes masking characters from user input. For example, for mask\n    // `00 (111)`, the placeholder would be `00 (___)`. If user input is `00 (234)`, the loop below\n    // would remove all characters but `234` from the `rawValueArr`. The rest of the algorithm\n    // then would lay `234` on top of the available placeholder positions in the mask.\n    for (let k = rawValueLength - 1; k >= 0; k--) {\n      const char = rawValueArr[k];\n\n      if (char !== settings.placeholderChar) {\n        const shouldOffset = k >= indexOfFirstChange && prevMaskResultLength === maskLength;\n\n        if (char === settings.placeholder[(shouldOffset) ? k - editDistance : k]) {\n          rawValueArr.splice(k, 1);\n        }\n      }\n    }\n\n    // Loop through the placeholder string to find characters that need to be filled.\n    placeholderLoop:\n    for (let l = 0; l < placeholderLength; l++) {\n      const charInPlaceholder = settings.placeholder[l];\n\n      // We see one. Let's find out what we can put in it.\n      if (charInPlaceholder === placeholderChar) {\n        // But before that, do we actually have any user characters that need a place?\n        if (rawValueArr.length > 0) {\n          // We will keep chipping away at user input until either we run out of characters\n          // or we find at least one character that we can map.\n          while (rawValueArr.length > 0) {\n            // Let's retrieve the first user character in the queue of characters we have left\n            const rawValueChar = rawValueArr.shift();\n\n            // If the character we got from the user input is a placeholder character (which happens\n            // regularly because user input could be something like (540) 90_-____, which includes\n            // a bunch of `_` which are placeholder characters) and we are not in *no guide* mode,\n            // then we map this placeholder character to the current spot in the placeholder\n            if (rawValueChar.char === placeholderChar && suppressGuide !== true) {\n              resultStr += placeholderChar;\n\n              // And we go to find the next placeholder character that needs filling\n              continue placeholderLoop;\n\n            // Else if, the character we got from the user input is not a placeholder, let's see\n            // if the current position in the mask can accept it.\n            } else if (mask[l].test(rawValueChar.char)) {\n              // we map the character differently based on whether we are keeping character\n              // positions or not. If any of the conditions below are met, we simply map the\n              // raw value character to the placeholder position.\n              if (\n                settings.keepCharacterPositions !== true ||\n                rawValueChar.isNew === false ||\n                settings.previousMaskResult === masks.EMPTY_STRING ||\n                settings.guide === false ||\n                !isAddition\n              ) {\n                resultStr += rawValueChar.char;\n              } else {\n                // We enter this block of code if we are trying to keep character positions and\n                // none of the conditions above is met. In this case, we need to see if there's\n                // an available spot for the raw value character to be mapped to. If we couldn't\n                // find a spot, we will discard the character.\n                //\n                // For example, for mask `1111`, previous conformed value `_2__`, raw value\n                // `942_2__`. We can map the `9`, to the first available placeholder position,\n                // but then, there are no more spots available for the `4` and `2`. So, we\n                // discard them and end up with a conformed value of `92__`.\n                const rawValueArrLength = rawValueArr.length;\n                let indexOfNextAvailablePlaceholderChar = null;\n\n                // Let's loop through the remaining raw value characters. We are looking for\n                // either a suitable spot, ie, a placeholder character or a non-suitable spot,\n                // ie, a non-placeholder character that is not new. If we see a suitable spot\n                // first, we store its position and exit the loop. If we see a non-suitable spot\n                // first, we exit the loop and our `indexOfNextAvailablePlaceholderChar`\n                // will stay as `null`.\n                for (let x = 0; x < rawValueArrLength; x++) {\n                  const charData = rawValueArr[x];\n\n                  if (charData.char !== placeholderChar && charData.isNew === false) {\n                    break;\n                  }\n\n                  if (charData.char === placeholderChar) {\n                    indexOfNextAvailablePlaceholderChar = x;\n                    break;\n                  }\n                }\n\n                // If `indexOfNextAvailablePlaceholderChar` is not `null`, that means the\n                // character is not blocked. We can map it. And to keep the character positions,\n                // we remove the placeholder character from the remaining characters\n                if (indexOfNextAvailablePlaceholderChar !== null) {\n                  resultStr += rawValueChar.char;\n                  rawValueArr.splice(indexOfNextAvailablePlaceholderChar, 1);\n\n                // If `indexOfNextAvailablePlaceholderChar` is `null`, that means the\n                // character is blocked. We have to discard it.\n                } else {\n                  l--;\n                }\n              }\n\n              // Since we've mapped this placeholder position. We move on to the next one.\n              continue placeholderLoop;\n            } else {\n              charactersRejected = true;\n            }\n          }\n        }\n\n        // We reach this point when we've mapped all the user input characters to placeholder\n        // positions in the mask. In *guide* mode, we append the left over characters in the\n        // placeholder to the `conformedString`, but in *no guide* mode, we don't wanna do that.\n        //\n        // That is, for mask `(111)` and user input `2`, we want to return `(2`, not `(2__)`.\n        if (suppressGuide === false) {\n          resultStr += settings.placeholder.substr(l, placeholderLength);\n        }\n\n        // And we break\n        break;\n\n      // Else, the charInPlaceholder is not a placeholderChar. That is, we cannot fill it\n      // with user input. So we just map it to the final output\n      } else {\n        resultStr += charInPlaceholder;\n      }\n    }\n\n    // The following logic is needed to deal with the case of deletion in *no guide* mode.\n    //\n    // Consider the silly mask `(111) /// 1`. What if user tries to delete the last placeholder\n    // position? Something like `(589) /// `. We want to conform that to `(589`. Not `(589) /// `.\n    // That's why the logic below finds the last filled placeholder character,\n    // and removes everything from that point on.\n    if (suppressGuide && isAddition === false) {\n      let indexOfLastFilledPlaceholderChar = null;\n\n      // Find the last filled placeholder position and substring from there\n      for (let m = 0; m < resultStr.length; m++) {\n        if (settings.placeholder[m] === placeholderChar) {\n          indexOfLastFilledPlaceholderChar = m;\n        }\n      }\n\n      if (indexOfLastFilledPlaceholderChar !== null) {\n        // We substring from the beginning until the position after the last filled\n        // placeholder char.\n        resultStr = resultStr.substr(0, indexOfLastFilledPlaceholderChar + 1);\n      } else {\n        // If we couldn't find `indexOfLastFilledPlaceholderChar` that means the user deleted\n        // the first character in the mask. So we return an empty string.\n        resultStr = masks.EMPTY_STRING;\n      }\n    }\n\n    return {\n      caretPos,\n      caretTrapIndexes: settings.caretTrapIndexes,\n      conformedValue: resultStr,\n      charactersRejected,\n      placeholder: settings.placeholder,\n      placeholderChar,\n      maskResult: true\n    };\n  },\n\n  /**\n   * Detects Caret Traps inside of a Mask Array and identifies them with a rich object\n   * @private\n   * @param {array} mask the mask being checked\n   * @returns {object} containing a modified Mask array without caret traps, and an array of\n   *  indices with locations of the caret traps.\n   */\n  _processCaretTraps(mask) {\n    const indexes = [];\n    let indexOfCaretTrap = mask.indexOf(masks.CARET_TRAP);\n\n    while (indexOfCaretTrap !== -1) {\n      indexes.push(indexOfCaretTrap);\n      mask.splice(indexOfCaretTrap, 1);\n      indexOfCaretTrap = mask.indexOf(masks.CARET_TRAP);\n    }\n\n    return {\n      maskWithoutCaretTraps: mask,\n      indexes\n    };\n  },\n\n  /**\n   * Converts an array-based mask into a placeholder string.\n   * @private\n   * @param {array} mask - contains string \"literal\" characters and Regex matchers.\n   * @param {string} placeholderChar - a character that will be used as the placeholder.\n   * @returns {string} representing the placeholder\n   */\n  _convertMaskToPlaceholder(mask, placeholderChar) {\n    if (!Array.isArray(mask)) {\n      mask = [];\n    }\n    if (!placeholderChar) {\n      placeholderChar = masks.PLACEHOLDER_CHAR;\n    }\n\n    if (mask.indexOf(placeholderChar) !== -1) {\n      throw new Error(`${'Placeholder character must not be used as part of the mask. Please specify a character ' +\n        'that is not present in your mask as your placeholder character.\\n\\n' +\n        'The placeholder character that was received is:'}${JSON.stringify(placeholderChar)}\\n\\n` +\n        `The mask that was received is: ${JSON.stringify(mask)}`);\n    }\n\n    const ret = mask.map(char => ((char instanceof RegExp) ?\n      placeholderChar : char)).join(masks.EMPTY_STRING);\n\n    return ret;\n  },\n\n  /**\n   * Takes an index representing a caret and changes it based on mask modifications\n   * @private\n   * @param {object} opts information about the caret placement.\n   * @returns {number} the index of the text caret.\n   */\n  adjustCaretPosition(opts) { //eslint-disable-line\n    if (opts.caretPos === 0) {\n      return 0;\n    }\n\n    function nonPlaceholderFilter(char) {\n      return char !== nonPlaceholderFilter;\n    }\n\n    // Store lengths for faster performance?\n    const rawValueLength = opts.rawValue.length;\n    const previousConformedValueLength = opts.previousMaskResult.length;\n    const placeholderLength = opts.placeholder ? opts.placeholder.length : 0;\n    const conformedValueLength = opts.conformedValue ? opts.conformedValue.length : 0;\n\n    // This tells us how long the edit is. If user modified input from `(2__)` to `(243__)`,\n    // we know the user in this instance pasted two characters\n    const editLength = rawValueLength - previousConformedValueLength;\n\n    // If the edit length is positive, that means the user is adding characters, not deleting.\n    const isAddition = editLength > 0;\n\n    // This is the first raw value the user entered that needs to be conformed to mask\n    const isFirstRawValue = previousConformedValueLength === 0;\n\n    // A partial multi-character edit happens when the user makes a partial selection in their\n    // input and edits that selection. That is going from `(123) 432-4348` to `() 432-4348` by\n    // selecting the first 3 digits and pressing backspace.\n    //\n    // Such cases can also happen when the user presses the backspace while holding down the ALT\n    // key.\n    const isPartialMultiCharEdit = editLength > 1 && !isAddition && !isFirstRawValue;\n\n    // This algorithm doesn't support all cases of multi-character edits, so we just return\n    // the current caret position.\n    //\n    // This works fine for most cases.\n    if (isPartialMultiCharEdit) {\n      return opts.caretPos;\n    }\n\n    // For a mask like (111), if the `previousConformedValue` is (1__) and user attempts to enter\n    // `f` so the `rawValue` becomes (1f__), the new `conformedValue` would be (1__), which is the\n    // same as the original `previousConformedValue`. We handle this case differently for caret\n    // positioning.\n    const possiblyHasRejectedChar = isAddition && (\n      opts.previousMaskResult === opts.conformedValue ||\n      opts.conformedValue === opts.placeholder\n    );\n\n    let startingSearchIndex = 0;\n    let trackRightCharacter;\n    let targetChar;\n\n    if (possiblyHasRejectedChar) {\n      startingSearchIndex = opts.caretPos - editLength;\n    } else {\n      // At this point in the algorithm, we want to know where the caret is right\n      // before the raw input has been conformed, and then see if we can find that\n      // same spot in the conformed input.\n      //\n      // We do that by seeing what character lies immediately before the caret,\n      // and then look for that same character in the conformed input and place\n      // the caret there.\n      //\n      // First, we need to normalize the inputs so that letter capitalization between raw input and\n      // conformed input wouldn't matter.\n      const normalizedConformedValue = opts.conformedValue.toLowerCase();\n      const normalizedRawValue = opts.rawValue.toLowerCase();\n\n      // Then we take all characters that come before where the caret currently is.\n      const leftHalfChars = normalizedRawValue.substr(0, opts.caretPos).split(masks.EMPTY_STRING);\n\n      // Now we find all the characters in the left half that exist in the conformed\n      // input. This step ensures that we don't look for a character that was filtered\n      // out or rejected by `conformToMask`.\n      const intersection = leftHalfChars.filter(char =>\n        normalizedConformedValue.indexOf(char) !== -1);\n\n      // The last character in the intersection is the character we want to\n      // look for in the conformed value and the one we want to adjust the caret close to\n      targetChar = intersection[intersection.length - 1];\n\n      // Calculate the number of mask characters in the previous placeholder\n      // from the start of the string up to the place where the caret is\n      const previousLeftMaskChars = opts.previousPlaceholder\n        .substr(0, intersection.length)\n        .split(masks.EMPTY_STRING)\n        .filter(nonPlaceholderFilter)\n        .length;\n\n      // Calculate the number of mask characters in the current placeholder\n      // from the start of the string up to the place where the caret is\n      const leftMaskChars = opts.placeholder\n        .substr(0, intersection.length)\n        .split(masks.EMPTY_STRING)\n        .filter(nonPlaceholderFilter)\n        .length;\n\n      // Has the number of mask characters up to the caret changed?\n      const masklengthChanged = leftMaskChars !== previousLeftMaskChars;\n\n      // Detect if `targetChar` is a mask character and has moved to the left\n      const targetIsMaskMovingLeft = (\n        opts.previousPlaceholder[intersection.length - 1] !== undefined &&\n        opts.placeholder[intersection.length - 2] !== undefined &&\n        opts.previousPlaceholder[intersection.length - 1] !== opts.placeholderChar &&\n        opts.previousPlaceholder[intersection.length - 1] !== opts.placeholder[intersection.length - 1] && //eslint-disable-line\n        opts.previousPlaceholder[intersection.length - 1] === opts.placeholder[intersection.length - 2] //eslint-disable-line\n      );\n\n      // If deleting and the `targetChar` `is a mask character and `masklengthChanged` is true\n      // or the mask is moving to the left, we can't use the selected `targetChar` any longer\n      // if we are not at the end of the string.\n      // In this case, change tracking strategy and track the character to the right of the caret.\n      if (\n        !isAddition &&\n        (masklengthChanged || targetIsMaskMovingLeft) &&\n        previousLeftMaskChars > 0 &&\n        opts.placeholder.indexOf(targetChar) > -1 &&\n        opts.rawValue[opts.caretPos] !== undefined\n      ) {\n        trackRightCharacter = true;\n        targetChar = opts.rawValue[opts.caretPos];\n      }\n\n      // It is possible that `targetChar` will appear multiple times in the conformed value.\n      // We need to know not to select a character that looks like our target character\n      // from the placeholder or the piped characters, so we inspect the piped characters\n      // and the placeholder to see if they contain characters that match our target character.\n\n      // If the `conformedValue` got piped, we need to know which characters were piped in so\n      // that when we look for our `targetChar`, we don't select a piped char by mistake.\n      let pipedChars = [];\n      if (opts.indexesOfPipedChars) {\n        pipedChars = opts.indexesOfPipedChars.map(index => normalizedConformedValue[index]);\n      }\n\n      // We need to know how many times the `targetChar` occurs in the piped characters.\n      const countTargetCharInPipedChars = pipedChars.filter(char => char === targetChar).length;\n\n      // We need to know how many times it occurs in the intersection\n      const countTargetCharInIntersection = intersection.filter(char => char === targetChar).length;\n\n      // We need to know if the placeholder contains characters that look like\n      // our `targetChar`, so we don't select one of those by mistake.\n      const countTargetCharInPlaceholder = opts.placeholder\n        .substr(0, opts.placeholder.indexOf(opts.placeholderChar))\n        .split(masks.EMPTY_STRING)\n        .filter((char, index) =>\n          // Check if `char` is the same as our `targetChar`, so we account for it\n          char === targetChar &&\n\n          // but also make sure that both the `rawValue` and placeholder don't have the same\n          // character at the same index because if they are equal, that means we are already\n          // counting those characters in `countTargetCharInIntersection`\n          opts.rawValue[index] !== char)\n        .length;\n\n      // The number of times we need to see occurrences of the `targetChar` before we\n      // know it is the one we're looking for is:\n      const requiredNumberOfMatches = (\n        countTargetCharInPlaceholder +\n        countTargetCharInIntersection +\n        countTargetCharInPipedChars +\n        // The character to the right of the caret isn't included in `intersection`\n        // so add one if we are tracking the character to the right\n        (trackRightCharacter ? 1 : 0)\n      );\n\n      // Now we start looking for the location of the `targetChar`.\n      // We keep looping forward and store the index in every iteration. Once we have encountered\n      // enough occurrences of the target character, we break out of the loop\n      // If are searching for the second `1` in `1214`, `startingSearchIndex` will point at `4`.\n      let numberOfEncounteredMatches = 0;\n      for (let i = 0; i < conformedValueLength; i++) {\n        const conformedValueChar = normalizedConformedValue[i];\n\n        startingSearchIndex = i + 1;\n\n        if (conformedValueChar === targetChar) {\n          numberOfEncounteredMatches++;\n        }\n\n        if (numberOfEncounteredMatches >= requiredNumberOfMatches) {\n          break;\n        }\n      }\n    }\n\n    // At this point, if we simply return `startingSearchIndex` as the adjusted caret position,\n    // most cases would be handled. However, we want to fast forward or rewind the caret to the\n    // closest placeholder character if it happens to be in a non-editable spot.\n    // That's what the next logic is for.\n    //\n    // In case of addition, we fast forward.\n    if (isAddition) {\n      // We want to remember the last placeholder character encountered so that if the mask\n      // contains more characters after the last placeholder character, we don't forward the caret\n      // that far to the right. Instead, we stop it at the last encountered placeholder character.\n      let lastPlaceholderChar = startingSearchIndex;\n\n      for (let j = startingSearchIndex; j <= placeholderLength; j++) {\n        if (!opts.placeholder) {\n          return lastPlaceholderChar;\n        }\n\n        if (opts.placeholder[j] === opts.placeholderChar) {\n          lastPlaceholderChar = j;\n        }\n\n        if (\n          // If we're adding, we can position the caret at the next placeholder character.\n          opts.placeholder[j] === opts.placeholderChar ||\n\n          // If a caret trap was set by a mask function, we need to stop at the trap.\n          opts.caretTrapIndexes.indexOf(j) !== -1 ||\n\n          // This is the end of the placeholder. We cannot move any further.\n          // Let's put the caret there.\n          j === placeholderLength\n        ) {\n          return lastPlaceholderChar;\n        }\n      }\n    } else {\n      // In case of deletion, we rewind.\n      if (trackRightCharacter) { //eslint-disable-line\n        // Searching for the character that was to the right of the caret\n        // We start at `startingSearchIndex` - 1 because it includes one character\n        // extra to the right\n        for (let k = startingSearchIndex - 1; k >= 0; k--) {\n          // If tracking the character to the right of the cursor, we move to the left until\n          // we found the character and then place the caret right before it\n\n          if (\n            // `targetChar` should be in `conformedValue`, since it was in `rawValue`, just\n            // to the right of the caret\n            opts.conformedValue[k] === targetChar ||\n\n            // If a caret trap was set by a mask function, we need to stop at the trap.\n            opts.caretTrapIndexes.indexOf(k) !== -1 ||\n\n            // This is the beginning of the placeholder. We cannot move any further.\n            // Let's put the caret there.\n            k === 0\n          ) {\n            return k;\n          }\n        }\n      } else {\n        // Searching for the first placeholder or caret trap to the left\n\n        for (let l = startingSearchIndex; l >= 0; l--) {\n          // If we're deleting, we stop the caret right before the placeholder character.\n          // For example, for mask `(111) 11`, current conformed input `(456) 86`. If user\n          // modifies input to `(456 86`. That is, they deleted the `)`, we place the caret\n          // right after the first `6`\n\n          if (\n            // If we're deleting, we can position the caret right before the placeholder character\n            opts.placeholder[l - 1] === opts.placeholderChar ||\n\n            // If a caret trap was set by a mask function, we need to stop at the trap.\n            opts.caretTrapIndexes.indexOf(l) !== -1 ||\n\n            // This is the beginning of the placeholder. We cannot move any further.\n            // Let's put the caret there.\n            l === 0\n          ) {\n            return l;\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Converts the legacy Soho Mask pattern format from a string into an array.\n   * If character is a defined pattern matcher, the corresponding item at the\n   * array index is converted to its regex form.\n   * @private\n   * @param {string} pattern a legacy Soho Mask Pattern\n   * @param {object} [defs] mask conversion definitions\n   * @returns {array} contains string \"literal\" characters and Regex matchers\n   */\n  _convertPatternFromString(pattern, defs) {\n    const arr = [];\n    const legacyKeys = Object.keys(defs);\n\n    function getRegex(char) {\n      const idx = legacyKeys.indexOf(char);\n\n      if (idx > -1) {\n        char = defs[legacyKeys[idx]];\n      }\n      return char;\n    }\n\n    for (let i = 0; i < pattern.length; i++) {\n      arr.push(getRegex(pattern[i]));\n    }\n\n    // TODO: Attach an object here that contains an analysis of the original mask\n    // that can be used to configure the new API accordingly.\n\n    return arr;\n  }\n\n};\n\nexport { MaskAPI };\n","/* eslint-disable no-underscore-dangle, new-cap */\nimport { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\nimport { Locale } from '../locale/locale';\nimport { masks } from './masks';\nimport { MaskAPI } from './mask-api';\n\n// The name of this component\nconst COMPONENT_NAME = 'mask';\n\n/**\n * Component Wrapper for input elements that gives them the ability to become \"masked\".\n * @class MaskInput\n * @constructor\n * @param {HTMLInputElement} element regular HTML Input Element (not wrapped with jQuery)\n * @param {MaskInputOptions} [settings] incoming settings\n *\n * @param {object} [settings.definitions=false] if defined, passes additional string-based pattern match \"types\".\n * @param {boolean} [settings.guide=false] if true, causes a guide to show inside the input field, represented by the placeholder,\n *  that demonstrates how the mask can be filled in.\n * @param {boolean} [settings.keepCharacterPositions=false] if defined alongside of `settings.guide`, will allow indiviual characters\n *  to be removed from the mask without moving the positions of other characters that have been written into the field.\n *  Works well with things like credit card or phone numbers, which have sections that are separate from each other.\n * @param {array|function|string} [settings.pattern] the pattern that is used by the mask for determining input to keep or throw out.\n *  Arrays of strings representing individual characters, and regex matching individual characters, is the perferred way of supplying a pattern.\n *  For some `settings.process` types (date/time/number), a function that dynamically generates a mask is automatically used.\n *  It's also possible to define a custom mask function and supply it here. The legacy string style is also supported.\n * @param {object} [settings.patternOptions={}] If using a function to define `settings.pattern`, any options that must be passed\n *  to the masking function can be supplied in this object.\n * @param {string} [settings.patternOptions.format] [date/time masks only] contains a basic date format string that will be used to properly display a date mask.\n * @param {string} [settings.patternOptions.prefix] [number masks only] will be automatically prepended to the beginning of the masked value, but will not be counted as part of the masked value.\n * @param {string} [settings.patternOptions.suffix] [number masks only] will be automatically appended to the end of the masked value, but will not be counted as part of the masked value.\n * @param {boolean} [settings.patternOptions.allowThousandsSeparator] [number masks only] If true, displays a localized thousands separator in the masked value\n * @param {string} [settings.patternOptions.locale] [number/date/time masks] will cause formatting to occur against a particular Locale culture.\n * @param {object} [settings.patternOptions.symbols] [number masks only] contains default, localized special characters used in numbers\n * @param {string} [settings.patternOptions.symbols.currency] [number masks only]\n * @param {string} [settings.patternOptions.symbols.decimal] [number masks only]\n * @param {string} [settings.patternOptions.symbols.negative] [number masks only]\n * @param {string} [settings.patternOptions.symbols.thousands] [number masks only]\n * @param {boolean} [settings.patternOptions.allowDecimal] [number masks only] allows the entry of a decimal point into a number mask with a decimal limit defined (negated when using `requireDecimal` to force its placement)\n * @param {boolean} [settings.patternOptions.requireDecimal] [number masks only] forces the placement of a decimal point in a number mask with a decimal limit defined.\n * @param {number} [settings.patternOptions.decimalLimit] [number masks only] defines the number of characters allowed after the decimal point.\n * @param {number} [settings.patternOptions.integerLimit] [number masks only] defines the number of characters allowed before the decimal point.\n * @param {boolean} [settings.patternOptions.allowNegative] [number masks only] allows a number to be negative (adds/retains a \"minus\" symbol at the beginning of the value)\n * @param {boolean} [settings.patternOptions.allowLeadingZeroes] [number masks only] allows a zero be placed before a decimal or other numbers.\n * @param {string} [settings.placeholderChar='_'] If using the `settings.guide`, will be used as the placeholder\n *  for characters that are not yet typed.\n * @param {function} [settings.pipe] provides a way of adjusting the masked content, caret position,\n *  etc after the input field has been processed by the mask API.\n * @param {string} [settings.process=undefined] can be defined as a quick way to create certain complex masks.  Defaults to the regular pattern mask,\n *  but can automatically configure the field for \"date\", \"time\", and \"number\"\n * @param {boolean} [settings.processOnBlur=true] if defined, causes the mask API to process this input field whenever it becomes blurred.\n * @param {boolean} [settings.processOnInitialize=true] if defined, causes the mask API to process this input field when the component is initialized.\n * @returns {MaskInput} component instance\n */\nconst DEFAULT_MASK_INPUT_OPTIONS = {\n  definitions: undefined,\n  guide: false,\n  keepCharacterPositions: false,\n  maskAPI: MaskAPI,\n  locale: '',\n  pattern: undefined,\n  patternOptions: {},\n  placeholderChar: '_',\n  pipe: undefined,\n  process: undefined,\n  processOnBlur: true,\n  processOnInitialize: true\n};\n\nfunction MaskInput(element, settings) {\n  this.element = element;\n  this.settings = utils.mergeSettings(this.element, settings, DEFAULT_MASK_INPUT_OPTIONS);\n\n  return this.init();\n}\n\nMaskInput.prototype = {\n\n  /**\n   * Initialization/things that need to be called on `updated()` in addition to initialization\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.setLocale();\n  },\n\n  build() {\n    // TODO: Deprecate legacy settings in v4.4.0, remove in v4.5.0\n    this._replaceLegacySettings();\n\n    const styleClasses = ['is-number-mask'];\n\n    // If the 'process' setting is defined, connect a pre-defined Soho Mask/Pattern\n    if (typeof this.settings.process === 'string') {\n      if (!this.settings.patternOptions.locale) {\n        this.settings.patternOptions.locale = this.settings.locale;\n      }\n\n      switch (this.settings.process) {\n        case 'number': {\n          this.settings.pattern = masks.numberMask;\n          this.element.classList.add('is-number-mask');\n          break;\n        }\n        case 'date': {\n          // Check for an instance of a Datepicker/Timepicker Component, and grab the date format\n          const datepicker = $(this.element).data('datepicker');\n          if ($.fn.datepicker && $(this.element).data('datepicker')) {\n            if (!this.settings.patternOptions && !this.settings.patternOptions.format) {\n              this.settings.patternOptions.format = datepicker.settings.dateFormat;\n            }\n          }\n          this.settings.pattern = masks.dateMask;\n          break;\n        }\n        case 'rangeDate': {\n          const datepicker = $(this.element).data('datepicker');\n          if ($.fn.datepicker && $(this.element).data('datepicker')) {\n            this.settings.patternOptions.format = datepicker.settings.dateFormat;\n          }\n          this.settings.pattern = masks.rangeDateMask;\n          break;\n        }\n        default: {\n          this.element.classList.remove(styleClasses.join(' '));\n          break;\n        }\n      }\n    }\n\n    this.mask = new this.settings.maskAPI(this.settings);\n    this.state = {\n      previousMaskResult: ''\n    };\n\n    this.handleEvents();\n\n    if (this.settings.processOnInitialize) {\n      this.process();\n    }\n\n    return this;\n  },\n\n  /**\n   * Set current locale to be used.\n   * @private\n   * @returns {void}\n   */\n  setLocale() {\n    this.locale = Locale.currentLocale;\n    if (this.settings.locale) {\n      Locale.getLocale(this.settings.locale).done((locale) => {\n        this.locale = Locale.cultures[locale];\n        this.build();\n      });\n    } else {\n      this.build();\n    }\n  },\n\n  /**\n   * Sets up events\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    // Store an initial value on focus\n    this.focusEventHandler = function () {\n      self.state.initialValue = self.element.value;\n    };\n    this.element.addEventListener('focus', this.focusEventHandler);\n\n    // Handle all masking on the `input` event\n    this.inputEventHandler = function () {\n      return self.process();\n    };\n    this.element.addEventListener('input', this.inputEventHandler);\n\n    // Remove an initial value from the state object on blur\n    this.blurEventHandler = function (e) {\n      // Handle mask processing on blur, if settings allow.  Otherwise, return out.\n      if (self.settings.processOnBlur) {\n        if (self.element.readOnly) {\n          e.preventDefault();\n          return false;\n        }\n\n        // in IE11 or Edge, change event doesn't fire for some unknown reason.\n        // Added this for backwards compatility with this OS/Browser combo.\n        // See http://jira.infor.com/browse/SOHO-6895\n        if (self._hasChangedValue() && self._isEdgeIE()) {\n          $(self.element).trigger('change');\n        }\n      }\n\n      delete self.state.initialValue;\n      return self.process();\n    };\n    this.element.addEventListener('blur', this.blurEventHandler);\n\n    return this;\n  },\n\n  /**\n   * Main Process for conforming a mask against the API.\n   * @returns {boolean} whether or not the mask process was successful\n   */\n  process() {\n    // If no pattern's defined, act as if no mask component is present.\n    if (!this.settings.pattern) {\n      return true;\n    }\n\n    // Get a reference to the desired Mask API (by default, the one setup\n    // during Soho initialization).\n    const api = this.mask;\n    if (!api.pattern) {\n      api.configure({\n        pattern: this.settings.pattern,\n        patternOptions: this.settings.patternOptions\n      });\n    }\n\n    // Get all necessary bits of data from the input field.\n    let rawValue = this.element.value;\n\n    // Don't continue if there was no change to the input field's value\n    if (rawValue === this.state.previousMaskResult) {\n      return false;\n    }\n\n    let posBegin = this.element.selectionStart;\n    let posEnd = this.element.selectionEnd;\n\n    // On Android, the first character inserted into a field is automatically\n    // selected when it shouldn't be. This snippet fixes that problem.\n    if (this._isAndroid() && this.state.previousMaskResult === '' && posBegin !== posEnd) {\n      utils.safeSetSelection(rawValue.length, rawValue.length);\n      posBegin = rawValue.length;\n      posEnd = rawValue.length;\n    }\n\n    // Attempt to make the raw value safe to use.  If it's not in a viable format\n    // this will throw an error.\n    rawValue = this._getSafeRawValue(rawValue);\n\n    const opts = {\n      guide: this.settings.guide,\n      keepCharacterPositions: this.settings.keepCharacterPositions,\n      patternOptions: this.settings.patternOptions,\n      placeholderChar: this.settings.placeholderChar,\n      previousMaskResult: this.state.previousMaskResult,\n      selection: {\n        start: posBegin,\n        end: posEnd\n      }\n    };\n\n    if (posBegin !== posEnd) {\n      opts.selection.contents = rawValue.substring(posBegin, posEnd);\n    }\n    if (typeof this.settings.pipe === 'function') {\n      opts.pipe = this.settings.pipe;\n    }\n\n    // Perform the mask processing.\n    const processed = api.process(rawValue, opts);\n    if (!processed.maskResult) {\n      // Error during masking.  Simply return out and don't mask this field.\n      return processed.maskResult;\n    }\n\n    // Use the piped value, if applicable.\n    let finalValue = processed.pipedValue ? processed.pipedValue : processed.conformedValue;\n    const patternOptions = this.settings.patternOptions;\n    if (finalValue !== '' && patternOptions && patternOptions.suffix && finalValue.indexOf(patternOptions.suffix) < 0) {\n      finalValue += this.settings.patternOptions.suffix;\n    }\n\n    // Setup values for getting corrected caret position\n    // TODO: Improve this by eliminating the need for an extra settings object.\n    const adjustCaretOpts = {\n      previousMaskResult: this.state.previousMaskResult || '',\n      previousPlaceholder: this.state.previousPlaceholder || '',\n      conformedValue: finalValue,\n      placeholder: processed.placeholder,\n      rawValue,\n      caretPos: processed.caretPos,\n      placeholderChar: this.settings.placeholderChar\n    };\n    if (processed.pipedCharIndexes) {\n      adjustCaretOpts.indexesOfPipedChars = processed.pipedCharIndexes;\n    }\n    if (processed.caretTrapIndexes) {\n      adjustCaretOpts.caretTrapIndexes = processed.caretTrapIndexes;\n    }\n\n    // Get a corrected caret position.\n    processed.caretPos = api.adjustCaretPosition(adjustCaretOpts);\n\n    const previousValue = this.state.previousMaskResult;\n\n    // Set the internal component state\n    this.state.previousMaskResult = finalValue;\n    this.state.previousPlaceholder = processed.placeholder;\n\n    // Set state of the input field\n    this.element.value = finalValue;\n    utils.safeSetSelection(this.element, processed.caretPos);\n\n    // Return out if there was no visible change in the conformed result\n    // (causes state not to change, events not to fire)\n    if (previousValue !== finalValue) {\n      return false;\n    }\n\n    /**\n     * Fire the 'write' event\n     * @event write\n     * @memberof MaskInput\n     * @param {jQuery.Event} e the event object\n     * @param {string} finalValue the final, masked value\n     */\n    $(this.element).trigger('write.mask', [finalValue]);\n\n    // return event handler true/false\n    return processed.maskResult;\n  },\n\n  /**\n   * Obfuscates the operating system/browser check from Soho.env into internal methods\n   * NOTE: Helps compartmentalize us from using calls to global \"Soho\" object until we can\n   * properly setup import/export for unit tests.\n   * TODO: deprecate eventually (v4.4.0?)\n   * @private\n   * @returns {boolean} whether or not the current device is running the Android OS.\n   */\n  _isAndroid() {\n    const os = env && env.os && env.os.name ? env.os.name : '';\n    return os === 'android';\n  },\n\n  /**\n   * Determine if browser is IE11 or Edge\n   * @private\n   * @returns {boolean} whether or not the current device is running Windows 7\n   *  using the IE11 browser.\n   */\n  _isEdgeIE() {\n    const browser = env && env.browser && env.browser.name ? env.browser.name : '';\n    return browser === 'ie' || browser === 'edge';\n  },\n\n  /**\n   * Checks the current value of this masked input against it's stored \"previousMaskResult\"\n   *  state to see if the value changed.\n   * @private\n   * @returns {boolean} whether or not the previous mask state matches the current one.\n   */\n  _hasChangedValue() {\n    if (!this.state || !this.state.previousMaskResult) {\n      return true;\n    }\n\n    return this.state.previousMaskResult !== this.state.initialValue;\n  },\n\n  /**\n   * Gets the safe raw value of an input field\n   * @private\n   * @param {?} inputValue the original value that came from an input field or other source\n   * @returns {string} the string-ified version of the original value\n   */\n  _getSafeRawValue: function getSafeRawValue(inputValue) {\n    if (utils.isString(inputValue)) {\n      return inputValue;\n    } else if (utils.isNumber(inputValue)) {\n      return String(inputValue);\n    } else if (inputValue === undefined || inputValue === null) {\n      return '';\n    }\n    throw new Error(`${'The \"value\" provided to the Masked Input needs to be a string or a number. The value ' +\n        'received was:\\n\\n'}${JSON.stringify(inputValue)}`);\n  },\n\n  /**\n   * Changes a bunch of \"legacy\" setting definitions into more apt names.  Additionally handles\n   * the old data-attribute system that is still occasionally used.\n   * @private\n   * @deprecated as of v4.4.0.\n   * @returns {void}\n   */\n  _replaceLegacySettings() {\n    const modes = ['group', 'number', 'date', 'time'];\n\n    // pre-set a bunch of objects if they don't already exist\n    this.settings.patternOptions = this.settings.patternOptions || {};\n    this.settings.patternOptions.symbols = this.settings.patternOptions.symbols || {};\n\n    //= =====================================\n    // Deprecated as of v4.3.2\n    //= =====================================\n    // Order of operations when choosing pattern strings:\n    // HTML5 'data-mask' attribute > Generic pattern string based on \"type\" attribute > nothing.\n    //\n    // if no pattern is provided in settings, use a pre-determined pattern based\n    // on element type, or grab the pattern from the element itself.\n    const html5DataMask = this.element.getAttribute('data-mask') || false;\n    if (typeof html5DataMask === 'string' && html5DataMask.length) {\n      this.settings.pattern = html5DataMask;\n    }\n\n    // If a \"mode\" is defined, special formatting rules may apply to this mask.\n    // Otherwise, the standard single-character pattern match will take place.\n    const html5DataMaskMode = this.element.getAttribute('data-mask-mode') || false;\n    if (html5DataMaskMode && modes.indexOf(html5DataMaskMode) > -1) {\n      this.settings.mode = html5DataMaskMode;\n    }\n\n    // map deprecated \"mode\" setting to \"process\".  Triggers additional settings in\n    // some cases.\n    if (this.settings.mode) {\n      if (modes.indexOf(this.settings.mode) === -1) {\n        delete this.settings.mode;\n      }\n\n      if (this.settings.mode === 'group') {\n        this.settings.process = undefined;\n      } else if (this.settings.mode === 'date') {\n        this.settings.process = 'date';\n      } else {\n        this.settings.process = this.settings.mode;\n      }\n\n      delete this.settings.mode;\n    }\n\n    if (this.settings.process === 'number') {\n      // map deprecated \"thousandsSeparator\" to \"patternOptions.allowThousandsSeparator\"\n      if (this.settings.thousandsSeparator) {\n        this.settings.patternOptions.allowThousandsSeparator = this.settings.thousandsSeparator;\n        delete this.settings.thousandsSeparator;\n      }\n\n      // If \"thousands\" is defined, the thousands separator for numbers (comma or decimal, based on\n      // localization) will be inserted wherever necessary during typing. Will automatically set to\n      // \"true\" if the localized thousands separator is detected inside the mask.\n      const html5DataThousands = this.element.getAttribute('data-thousands') || false;\n      if (html5DataThousands) {\n        this.settings.patternOptions.allowThousandsSeparator = (html5DataThousands === 'true');\n      }\n\n      if (typeof this.settings.pattern === 'string') {\n        // If \"negative\" is defined, you can type the negative symbol in front of the number.\n        // Will automatically set to \"true\" if a negative symbol is detected inside the mask.\n        const allowNegative = this.settings.pattern.indexOf('-') !== -1;\n        if (allowNegative) {\n          this.settings.patternOptions.allowNegative = allowNegative;\n          this.settings.patternOptions.symbols.negative = '-';\n        }\n\n        // Detect the thousands separator and see if we use it.\n        const group = Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.group : ',';\n        const thousandsSep = this.settings.patternOptions && this.settings.patternOptions.symbols &&\n          this.settings.patternOptions.symbols.thousands ?\n          this.settings.patternOptions.symbols.thousands :\n          group;\n\n        const hasThousandsInPattern = this.settings.pattern.indexOf(thousandsSep) !== -1;\n        this.settings.patternOptions.allowThousandsSeparator = hasThousandsInPattern;\n        if (hasThousandsInPattern) {\n          this.settings.patternOptions.symbols.thousands = thousandsSep;\n        }\n\n        // The new masking algorithm requires an \"integerLimit\" defined to function.\n        // This grabs the number of items currently inside this part of the mask, and sets it.\n        const decimal = typeof this.settings.patternOptions.symbols.decimal === 'string' ?\n          this.settings.patternOptions.symbols.decimal : '.';\n        const decimalParts = this.settings.pattern.split(decimal);\n\n        this.settings.patternOptions.integerLimit = decimalParts[0].replace(/[^#0]/g, '').length;\n\n        if (decimalParts[1]) {\n          this.settings.patternOptions.allowDecimal = true;\n          this.settings.patternOptions.decimalLimit = decimalParts[1].toString().replace(/[^#0]/g, '').length;\n          if (!this.settings.patternOptions.symbols.decimal) {\n            this.settings.patternOptions.symbols.decimal = decimal;\n          }\n        }\n      }\n    }\n\n    // If 'mustComplete' is defined, you MUST complete the full mask, or the mask\n    // will revert to empty once the field is blurred.\n    const html5DataMustComplete = this.element.getAttribute('data-must-complete') || false;\n    if (html5DataMustComplete) {\n      this.settings.mustComplete = html5DataMustComplete;\n    }\n\n    // Backwards compat with the old \"data-show-currency\"\n    const html5DataCurrency = this.element.getAttribute('data-show-currency');\n    if (html5DataCurrency) {\n      this.settings.showSymbol = 'currency';\n    }\n\n    // Handle the currency/percent symbols automatically\n    const symbolSetting = this.settings.showSymbol;\n    const symbolTypes = ['currency', 'percent'];\n    let symbol;\n\n    if (symbolTypes.indexOf(symbolSetting) > -1) {\n      symbol = (function (s) {\n        if (s === 'currency') {\n          return {\n            char: Locale.currentLocale.data.currencySign,\n            format: Locale.currentLocale.data.currencyFormat\n          };\n        }\n        if (s === 'percent') {\n          return {\n            char: Locale.currentLocale.data.numbers.percentSign,\n            format: Locale.currentLocale.data.numbers.percentFormat\n          };\n        }\n        return {};\n      }(this.settings.showSymbol));\n\n      // derive the location of the symbol\n      const detectableSymbol = (symbolSetting === 'currency' ? '' : symbol.char);\n      const symbolRegex = new RegExp(detectableSymbol, 'g');\n      const match = symbolRegex.exec(symbol.format);\n      let replacementRegex;\n      let symbolWithWhitespace;\n      let index = -1;\n      let placementType;\n\n      if (match && match.length) {\n        index = symbol.format.indexOf(match[0]);\n        if (index === 0) {\n          placementType = 'prefix';\n          replacementRegex = new RegExp(`[^${detectableSymbol}]\\\\S`, 'g');\n          symbolWithWhitespace = symbol.format.replace(replacementRegex, '');\n        } else if (index > 0) {\n          placementType = 'suffix';\n          replacementRegex = new RegExp(`\\\\S[^${detectableSymbol}]`, 'g');\n\n          while (/\\s/.test(symbol.format.charAt(index - 1))) {\n            --index;\n          }\n          symbolWithWhitespace = symbol.format.substr(index).replace(replacementRegex, '');\n        }\n\n        if (symbolSetting === 'currency') {\n          symbolWithWhitespace = symbolWithWhitespace.replace('', symbol.char);\n        }\n        this.settings.patternOptions[placementType] = symbolWithWhitespace;\n      }\n    }\n  },\n\n  /**\n   * Updates the component instance with new settings.\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Tears down the current component instance\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.element.removeEventListener('focus', this.focusEventHandler);\n    delete this.focusEventHandler;\n\n    this.element.removeEventListener('input', this.inputEventHandler);\n    delete this.inputEventHandler;\n\n    if (this.blurEventHandler) {\n      this.element.removeEventListener('blur', this.blurEventHandler);\n      delete this.blurEventHandler;\n    }\n\n    return this;\n  }\n};\n\nexport { MaskInput, COMPONENT_NAME };\n","import { MaskInput, COMPONENT_NAME } from './mask-input';\n\n/**\n * Wrap Mask as a jQuery component, and attach the factory function to $.fn\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements to be acted on.\n */\n$.fn.maskinput = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new MaskInput(this, settings));\n      instance.destroy = function () {\n        this.teardown();\n        $.removeData(this.element, COMPONENT_NAME);\n      };\n    }\n  });\n};\n\n/**\n * Backwards Compatibility with the old Mask\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements to be acted on.\n */\n$.fn.maskedinput = $.fn.maskinput;\n$.fn.mask = $.fn.maskinput;\n","import * as debug from '../../utils/debug';\nimport { Environment as env } from '../../utils/environment';\nimport { utils } from '../../utils/utils';\nimport { stringUtils } from '../../utils/string';\nimport { DOM } from '../../utils/dom';\nimport { PlacementObject, Place } from '../place/place';\n\n// jQuery Components\nimport '../place/place.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'popupmenu';\n\n/**\n * Responsive Popup Menu Control aka Context Menu when doing a right click action.\n * @class PopupMenu\n * @param {jquery[]|htmlelement} element The component element.\n * @param {object} [settings] The component settings.\n * @param {string} [settings.menu]  Menu's ID Selector, or a jQuery object representing a menu.\n * @param {string} [settings.trigger='click']  Action on which to trigger a menu can be: click, rightClick, immediate ect.\n * @param {boolean} [settings.autoFocus=true]  If false the focus will not focus the first list element. (At the cost of accessibility).\n * @param {boolean} [settings.mouseFocus=true]  If false the focus will not highlight the first list element. (At the cost of accessibility).\n * @param {boolean} [settings.attachToBody=false]  If true the menu will be moved out to the body. To be used in certin overflow situations.\n * @param {function} [settings.beforeOpen]  Callback that can be used for populating the contents of the menu.\n * @param {string} [settings.ariaListbox=false]   Switches aria to use listbox construct instead of menu construct (internal).\n * @param {string} [settings.eventObj]  Can pass in the event object so you can do a right click with immediate.\n * @param {string} [settings.triggerSelect]  If false select event will not be triggered.\n * @param {string} [settings.removeOnDestroy] Dispose of the menu from the DOM on destroy\n * @param {string} [settings.showArrow]  If true you can explicitly set an arrow on the menu.\n * @param {boolean|function} [settings.returnFocus]  If set to false, focus will not be\n  returned to the calling element. Can also be defined as a callback that can determine how\n  to return focus.  It usually should be for accessibility purposes.\n * @param {object} [settings.placementOpts=new PlacementObject({\n   containerOffsetX: 10,\n   containerOffsetY: 10,\n   strategies: ['flip', 'shrink']\n})] Gets passed to this control's Place behavior.\n * @param {object} [settings.offset={x: 0, y: 0}] Can tweak the menu position in the x and y direction. Takes an object of form: `{x: 0, y: 0}`.\n * @param {jQuery[]} [settings.predefined=$()] containing references to menu items that should be passed to the \"predefined\" hash.\n */\n\nconst POPUPMENU_DEFAULTS = {\n  menu: null,\n  trigger: 'click',\n  autoFocus: true,\n  mouseFocus: true,\n  attachToBody: false,\n  removeOnDestroy: false,\n  beforeOpen: null,\n  ariaListbox: false,\n  eventObj: undefined,\n  returnFocus: true,\n  showArrow: null,\n  triggerSelect: true,\n  placementOpts: new PlacementObject({\n    containerOffsetX: 10,\n    containerOffsetY: 10,\n    strategies: ['flip', 'shrink']\n  }),\n  offset: {\n    x: 0,\n    y: 0\n  },\n  predefined: $(),\n  duplicateMenu: null\n};\n\nfunction PopupMenu(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, POPUPMENU_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nPopupMenu.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.isFirefox = env.browser.name === 'firefox';\n    this.setup();\n    this.addMarkup();\n    this.handleEvents();\n    this.iconFilteringSetup();\n\n    // Allow for an external click event to be passed in from outside this code.\n    // This event can be used to pass clientX/clientY coordinates for mouse cursor positioning.\n    if (this.settings.trigger === 'immediate') {\n      this.open(this.settings.eventObj);\n    }\n\n    // Use some css rules on submenu parents\n    if (this.menu.find('.submenu').length) {\n      this.menu.addClass('has-submenu');\n    }\n  },\n\n  /**\n   * Checks whether or not Right-To-Left reading mode is active.\n   * @private\n   * @returns {boolean} whether or not the reading/writing direction is RTL\n   */\n  isRTL() {\n    return env.rtl;\n  },\n\n  /**\n   * @returns {boolean} whether or not the popupmenu is currently open\n   */\n  get isOpen() {\n    return DOM.hasClass(this.element[0], 'is-open');\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  setup() {\n    if (this.element.attr('data-popupmenu') && !this.settings.menu) {\n      this.settings.menu = this.element.attr('data-popupmenu').replace(/#/g, '');\n    }\n    // Backwards compatibility for \"menuId\" menu options coming from other controls\n    // that utilize the Popupmenu.\n    if (this.settings.menuId) {\n      this.settings.menu = this.settings.menuId;\n      this.settings.menuId = undefined;\n    }\n\n    // keep track of how many popupmenus there are with an ID.\n    // Used for managing events that are bound to $(document)\n    if (!this.id) {\n      this.id = (parseInt($('.popupmenu-wrapper').length, 10) + 1).toString();\n    }\n\n    // Set a reference collection for containing \"pre-defined\" menu items that should never\n    // be replaced during an AJAX call.\n    this.predefinedItems = $().add(this.settings.predefined);\n  },\n\n  /**\n   * Add markip including Aria\n   * @private\n   * @returns {void}\n   */\n  addMarkup() {\n    let id;\n    let duplicateMenu;\n    let triggerId;\n\n    switch (typeof this.settings.menu) {\n      case 'string': // ID Selector\n        id = this.settings.menu;\n        this.menu = $(`#${this.settings.menu}`);\n\n        // duplicate menu if shared by multiple triggers\n        if (this.settings.duplicateMenu && this.settings.attachToBody && this.menu.parent().not('body').length > 0) {\n          this.menu.data('trigger', this.element);\n          triggerId = this.menu.data('trigger')[0].id;\n          duplicateMenu = this.menu.clone();\n          duplicateMenu.detach().appendTo('body');\n\n          // add data-id attr to menus\n          duplicateMenu.attr('data-trigger', triggerId);\n          this.menu.attr('data-trigger', triggerId);\n        }\n        break;\n      case 'object': // jQuery Object\n        if (this.settings.menu === null) {\n          this.menu = this.element.next('.popupmenu, .popupmenu-wrapper');\n        } else {\n          this.menu = $(this.settings.menu);\n        }\n\n        id = this.menu.attr('id');\n        if (!id || id === '') {\n          this.menu.attr('id', `popupmenu-${this.id}`);\n          id = this.menu.attr('id');\n        }\n        break;\n      default:\n        break;\n    }\n\n    // If markup already exists for the wrapper, use that instead of rebuilding.\n    if (this.menu.is('.popupmenu-wrapper')) {\n      this.preExistingWrapper = true;\n      this.wrapper = this.menu;\n      this.menu = this.wrapper.children('.popupmenu').first();\n    }\n\n    // Similar check as above, assuming the menu wasn't a popupmenu wrapper.\n    if (this.menu.parent().is('.popupmenu-wrapper')) {\n      this.preExistingWrapper = true;\n      this.wrapper = this.menu.parent();\n    }\n\n    // If we still don't have a menu reference at this point, fail gracefully by returning out\n    // and simply acting like a button.\n    if (this.menu.length === 0) {\n      return;\n    }\n\n    // if the menu is deeply rooted inside the markup, detach it and append it to the <body> tag\n    // to prevent containment issues. (Now a Preference)\n    if (this.settings.attachToBody && this.menu.parent().not('body').length > 0) {\n      this.originalParent = this.menu.prev();\n      this.menu.detach().appendTo('body');\n      if (this.settings.duplicateMenu) {\n        this.menu.attr('id', `${this.settings.menu}-original`);\n      }\n    }\n\n    if (!this.menu.is('.popupmenu')) {\n      this.menu.addClass('popupmenu')\n        .attr('role', (this.settings.ariaListbox ? 'listbox' : 'menu'));\n    }\n\n    // Always store a reference to the trigger element under jQuery data.\n    this.menu.data('trigger', this.element);\n\n    this.wrapper = this.menu.parent('.popupmenu-wrapper');\n    if (!this.wrapper.length) {\n      this.wrapper = this.menu.wrap('<div class=\"popupmenu-wrapper\"></div>');\n    }\n\n    // Invoke all icons as icons\n    this.wrapper.find('svg').each(function () {\n      if (!$(this).data('icon')) {\n        $(this).icon();\n      }\n    });\n\n    // Use \"absolute\" positioning on the menu insead of \"fixed\", only when the\n    // menu lives <body> tag and we have a <body> element that is tall enough to\n    // scroll and is allowed to scroll.\n    function scrollableFilter() {\n      const c = this ? this.style.overflow : null;\n      return c !== 'auto' && c !== 'visible' && c !== 'scroll';\n    }\n    if (this.wrapper.parents().filter(scrollableFilter).length === 0) {\n      this.wrapper[0].style.position = 'absolute';\n    }\n\n    // Wrap submenu ULs in a 'wrapper' to help break it out of overflow.\n    this.menu.find('.popupmenu').each((i, elem) => {\n      const popup = $(elem);\n\n      if (!(popup.parent().hasClass('wrapper'))) {\n        popup.wrap('<div class=\"wrapper\"></div>');\n      }\n    });\n\n    // If the trigger element is a button with no border append arrow markup\n    const containerClass = this.element.parent().attr('class');\n    if ((this.element.hasClass('btn-menu') ||\n        this.element.hasClass('btn-actions') ||\n        this.element.hasClass('btn-icon') && this.element.find('use').attr('xlink:href') === '#icon-more' ||\n        this.settings.menu === 'colorpicker-menu' ||\n        this.element.closest('.toolbar').length > 0 ||\n        this.element.closest('.masthead').length > 0 ||\n        this.element.is('.searchfield-category-button') ||\n        (containerClass && containerClass.indexOf('more') >= 0) ||\n        containerClass && containerClass.indexOf('btn-group') >= 0) || this.settings.showArrow) {\n      const arrow = $('<div class=\"arrow\"></div>');\n      const wrapper = this.menu.parent('.popupmenu-wrapper');\n\n      wrapper.addClass('bottom').append(arrow);\n    }\n\n    // If inside of a \".field-short\" container, make smaller\n    const addFieldShort = this.element.closest('.field-short').length;\n    this.menu[addFieldShort ? 'addClass' : 'removeClass']('popupmenu-short');\n\n    // If button is part of a header/masthead or a container using the \"alternate\"\n    // UI color, add the \"alternate\" class.\n    if (containerClass !== undefined &&\n      (this.element.closest('.masthead').not('.search-results .masthead').length > 0)) {\n      this.menu.parent('.popupmenu-wrapper').addClass('inverse');\n    }\n\n    this.element.attr('aria-haspopup', true);\n    this.element.attr('aria-controls', id);\n\n    this.markupItems();\n\n    // Unhide the menu markup, if hidden\n    if (this.menu.is('.hidden')) {\n      this.menu.removeClass('hidden');\n    }\n  },\n\n  /**\n   * Renders a menu item in the UI.\n   * @private\n   * @param {object|object[]} settings JSON-friendly object that represents a popupmenu item, or array of items.\n   * @param {string} [settings.id] adds an ID to the item's anchor tag\n   * @param {boolean} [settings.separator=false] causes this menu item to be a separator (overrides everything else)\n   * @param {string} [settings.heading=\"\"] Produces a heading element after a separator with text content.\n   * @param {string} [settings.nextSectionSelect] can be null, \"single\", or \"multiple\"\n   * @param {string} settings.text contains the text that will be displayed.\n   * @param {string|null} [settings.icon=null] applies an icon to the menu item\n   * @param {string|null} [settings.selectable] can be null, \"single\", or \"multiple\"\n   * @param {boolean} [settings.disabled=false] causes the item to be disabled.\n   * @param {object[]} [settings.submenu] array of settings object contstructed just like this one, that represent submenu items.\n   * @param {boolean} [settings.noMenuWrap=false] if true, causes multiple top-level menu items not to be wrapped by a `<ul class=\"popupmenu\"></ul>`\n   * @returns {string} HTML representing a Popupmenu item with the settings passed.\n   */\n  renderItem(settings) {\n    if (settings === undefined) {\n      return '';\n    }\n\n    const self = this;\n    function wrapMenuItems(settingsArr) {\n      let items = '';\n      settingsArr.forEach((menuObj) => {\n        items += self.renderItem(menuObj);\n      });\n      return items;\n    }\n\n    // Top-level arrays run this method on each sub-item.\n    if (Array.isArray(settings)) {\n      const items = wrapMenuItems(settings);\n      const template = `<ul class=\"popupmenu\">${items}</ul>`;\n      return stringUtils.stripWhitespace(template);\n    }\n\n    let headingText = '';\n    let sectionSelectClass = '';\n\n    // separators get rendered out first\n    if (settings.separator !== undefined) {\n      if (settings.heading) {\n        headingText += `<li class=\"heading\">${settings.heading}</li>`;\n      }\n      if (settings.nextSectionSelect === 'single' || settings.nextSectionSelect === 'multiple') {\n        sectionSelectClass = ` ${settings.nextSectionSelect}`;\n      }\n\n      return stringUtils.stripWhitespace(`\n        <li class=\"separator${sectionSelectClass}\"></li>\n        ${headingText}\n      `);\n    }\n\n    // Top-level Menus can have settings.\n    // Handle an object-based settings with a `menu` definition here\n    if (settings.menu) {\n      let menuId = '';\n      if (settings.menuId) {\n        menuId = ` id=\"${settings.menuId}\"`;\n      }\n\n      let iconsClass = '';\n      if (settings.hasIcons) {\n        iconsClass += ' has-icons';\n      }\n\n      let items = '';\n      if (Array.isArray(settings.menu)) {\n        items = wrapMenuItems(settings.menu);\n      }\n\n      if (settings.noMenuWrap) {\n        return items;\n      }\n\n      return stringUtils.stripWhitespace(`\n        <ul${menuId} class=\"popupmenu${iconsClass}\">\n          ${items}\n        </ul>\n      `);\n    }\n\n    let disabledClass = '';\n    let hiddenClass = '';\n    let icon = '';\n    let id = '';\n    let selectableClass = '';\n    let submenuClass = '';\n    let submenu = '';\n    let ddicon = '';\n\n    if (settings.disabled) {\n      disabledClass += ' is-disabled';\n    }\n\n    if (settings.visible === false) {\n      hiddenClass += ' hidden';\n    }\n\n    if (settings.id) {\n      id = ` id=\"${settings.id}\"`;\n    }\n\n    if (settings.selectable === 'single') {\n      selectableClass += ' is-selectable';\n    }\n\n    if (settings.selectable === 'multiple') {\n      selectableClass += ' is-multiselectable';\n    }\n\n    if (settings.icon) {\n      icon = `<svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n        <use xlink:href=\"#icon-${settings.icon}\"></use>\n      </svg>`;\n    }\n\n    if (Array.isArray(settings.submenu)) {\n      submenuClass += ' submenu';\n      submenu += this.renderItem(settings.submenu);\n      ddicon += `<svg class=\"arrow icon-dropdown icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n        <use xlink:href=\"#icon-dropdown\"></use>\n      </svg>`;\n    }\n\n    return stringUtils.stripWhitespace(`<li${id} class=\"popupmenu-item${disabledClass}${hiddenClass}${selectableClass}${submenuClass}\">\n      <a${id} href=\"#\">${icon}<span>${settings.text}</span>\n        ${ddicon}\n      </a>\n      ${submenu}\n    </li>`);\n  },\n\n  /**\n   * Converts the contents of a popupmenu or submenu to a JSON-friendly object structure.\n   * @private\n   * @param {object} [settings={}] incoming conversion settings\n   * @param {jQuery[]|HTMLElement} [settings.contextElement] the top-most element that will\n   *  be modified (defaults to the top-level menu).\n   * @param {boolean} [settings.noMenuWrap] if true, will pass an array as the top-level data instead\n   *  of an object with a `menu` property.\n   * @returns {object|object[]} an object representation of this popupmenu's current state.\n   */\n  toData(settings) {\n    let data = {};\n    const menu = [];\n\n    settings = settings || {};\n\n    // Figure out Context Element\n    if (!settings.contextElement) {\n      settings.contextElement = this.menu;\n    }\n    if (settings.contextElement instanceof HTMLElement) {\n      settings.contextElement = $(settings.contextElement);\n    }\n    if (settings.contextElement.is('.popupmenu-wrapper')) {\n      settings.contextElement = settings.contextElement.children('ul');\n    }\n\n    const menuId = `${settings.contextElement.attr('id')}`;\n    if (menuId) {\n      data.menuId = menuId;\n    }\n\n    const hasIcons = settings.contextElement.hasClass('has-icons');\n    data.hasIcons = hasIcons;\n\n    if (settings.noMenuWrap) {\n      data = menu;\n    } else {\n      data.menu = menu;\n    }\n\n    function decodeListItem(item) {\n      const li = $(item);\n      const liData = {};\n\n      // Ignore headings, which are included as part of separators inside data\n      if (li.hasClass('heading')) {\n        return undefined;\n      }\n\n      // separators include different metadata\n      if (li.hasClass('separator')) {\n        liData.separator = true;\n\n        if (li.hasClass('single-selectable-section')) {\n          liData.nextSectionSelect = 'single';\n        }\n        if (li.hasClass('multi-selectable-section')) {\n          liData.nextSectionSelect = 'multiple';\n        }\n\n        const next = li.next();\n        if (next.hasClass('heading')) {\n          liData.heading = next.text().trim();\n        }\n\n        return liData;\n      }\n\n      const a = li.children('a');\n      const icon = a.children('.icon:not(.close):not(.icon-dropdown)');\n      const id = a.attr('id');\n\n      liData.text = a.text().trim();\n      liData.disabled = li.hasClass('is-disabled');\n      liData.visible = !li.hasClass('hidden');\n\n      if (typeof id === 'string' && id.length) {\n        liData.id = id;\n      }\n\n      if (icon.length && (icon[0] instanceof SVGElement)) {\n        liData.icon = icon[0].querySelector('use').getAttribute('xlink:href').replace('#icon-', '');\n      }\n\n      if (li.hasClass('is-selectable')) {\n        liData.selectable = 'single';\n      } else if (li.hasClass('is-multiselectable')) {\n        liData.selectable = 'multiple';\n      }\n\n      const submenu = li.find('.popupmenu');\n      if (submenu.length) {\n        liData.submenu = [];\n        submenu.first().children().each((i, submenuItem) => {\n          const submenuLiData = decodeListItem(submenuItem);\n          if (!submenuLiData) {\n            return;\n          }\n          liData.submenu.push(submenuLiData);\n        });\n      }\n\n      return liData;\n    }\n\n    const lis = settings.contextElement.children('li');\n    lis.each((i, item) => {\n      const liData = decodeListItem(item);\n      if (!liData) {\n        return;\n      }\n      menu.push(liData);\n    });\n\n    return data;\n  },\n\n  /**\n   * Marks up menu items in the UI\n   * @private\n   * @param {jQuery[]|HTMLElement} [contextElement] the top-most element that will\n   *  be modified (defaults to the top-level menu).\n   * @returns {void}\n   */\n  markupItems(contextElement) {\n    const self = this;\n\n    if (!contextElement) {\n      contextElement = this.menu;\n    } else if (contextElement instanceof HTMLElement) {\n      contextElement = $(contextElement);\n    }\n\n    const lis = contextElement.find('li:not(.heading):not(.separator)');\n    let hasIcons = false;\n    contextElement[0].setAttribute('role', 'menu');\n\n    lis.each((i, li) => {\n      const a = $(li).children('a')[0]; // TODO: do this better when we have the infrastructure\n      let span = $(a).children('span')[0];\n      let submenu = $(li).children('ul')[0];\n      const icon = $(li).find('.icon:not(.close):not(.icon-dropdown)');\n      const submenuWrapper = $(li).children('.wrapper')[0];\n\n      li.setAttribute('role', (self.settings.ariaListbox ? 'option' : 'menuitem'));\n\n      if (a) {\n        a.setAttribute('tabindex', '-1');\n\n        // disabled menu items, by prop and by className\n        const $a = $(a);\n        const $li = $(li);\n\n        if ($li.hasClass('is-disabled') || (a.getAttribute('disabled') === 'true' || a.getAttribute('disabled') === 'disabled')) {\n          $li.addClass('is-disabled');\n          a.setAttribute('aria-disabled', 'true');\n          a.setAttribute('disabled', true);\n        } else {\n          $li.removeClass('is-disabled');\n          $a.removeAttr('aria-disabled');\n          a.removeAttribute('disabled');\n        }\n\n        // menu items that contain submenus\n        if (submenu instanceof HTMLElement) {\n          submenu.classList.add('popupmenu');\n        }\n        if (submenuWrapper instanceof HTMLElement) {\n          li.className += `${DOM.classNameExists(li) ? ' ' : ''}submenu`;\n          submenu = $(submenuWrapper).children('ul')[0];\n          submenu.classList.add('popupmenu');\n        }\n        if (DOM.hasClass(li, 'submenu')) {\n          // Add a span\n          if (!span) {\n            a.innerHTML = `<span>${a.innerHTML}</span>`;\n            span = $a.children('span')[0];\n          }\n\n          if ($a.find('svg.arrow').length === 0) {\n            $a.append($.createIconElement({ classes: ['arrow', 'icon-dropdown'], icon: 'dropdown' }));\n          }\n          a.setAttribute('aria-haspopup', 'true');\n\n          // Check for existing menus, and if present, apply a `.popupmenu` class automatically.\n        }\n\n        // is-checked\n        if (DOM.hasClass(li, 'is-checked')) {\n          a.setAttribute('role', 'menuitemcheckbox');\n          a.setAttribute('aria-checked', true);\n        }\n\n        // is-not-checked\n        if (DOM.hasClass(li, 'is-not-checked')) {\n          li.className = li.className.replace('is-not-checked', '');\n          a.setAttribute('role', 'menuitemcheckbox');\n          a.removeAttribute('aria-checked');\n        }\n      }\n\n      if (icon && icon.length > 0) {\n        hasIcons = true;\n      }\n    });\n\n    if (hasIcons) {\n      contextElement.addClass('has-icons');\n    } else {\n      contextElement.removeClass('has-icons');\n    }\n  },\n\n  /**\n   * Takes a pre-existing menu item and refreshes its state.\n   * @private\n   * @param {HTMLElement} item the menu item to be refreshed\n   * @param {object} data representing a Popupmenu data structure, containing updated state information\n   * @param {function} [callback] runs on completion of the item refresh.  Can be used for adding additional\n   *  important flags/properties to the Menu Item for a specific implementation.\n   * @returns {void}\n   */\n  refreshMenuItem(item, data, callback) {\n    if (!item || !(item instanceof HTMLElement) || !data) {\n      return;\n    }\n\n    // Don't refresh the menu item if it doesn't belong to this menu\n    if (!$(this.menu)[0].contains(item)) {\n      return;\n    }\n\n    const itemA = item.querySelector('a');\n    const itemIcon = item.querySelector('.icon:not(.close):not(.icon-dropdown)');\n    let itemIconUse;\n\n    if (data.text) {\n      if (itemA.innerText.trim() !== data.text) {\n        itemA.innerText = `${data.text}`;\n      }\n    }\n\n    if (data.disabled === true) {\n      if (item.className.indexOf('hidden') === -1) {\n        item.classList.add('is-disabled');\n      }\n    } else if (item.className.indexOf('is-disabled') > -1) {\n      item.classList.remove('is-disabled');\n    }\n\n    if (data.visible === true) {\n      if (item.className.indexOf('hidden') > -1) {\n        item.classList.remove('hidden');\n      }\n    } else if (item.className.indexOf('hidden') === -1) {\n      item.classList.add('visible');\n    }\n\n    if (data.icon) {\n      // TODO: fragile?\n      if (itemIcon) {\n        itemIconUse = itemIcon.querySelector('use');\n        if (itemIconUse && itemIconUse.getAttribute('xlink:href').replace('#icon-', '') !== data.icon) {\n          itemIcon.remove();\n        }\n        itemIconUse.setAttribute('xlink:href', `#icon-${data.icon}`);\n      } else {\n        // TODO: Create icon element and append\n      }\n    } else if (itemIcon) {\n      itemIcon.remove();\n    }\n\n    // TODO: Submenus\n    // Build so the submenu data structure is used to rerun this method against each submenu item.\n    if (data.submenu) {\n      const submenuItems = item.querySelector('.popupmenu').children;\n      for (let i = 0; i < data.submenu.length; i++) {\n        data.submenu[i].isSubmenuItem = true;\n        this.refreshMenuItem(submenuItems.item(i), data.submenu[i], callback);\n      }\n    }\n\n    // Run callback to apply additional refresh changes, if applicable.\n    if (typeof callback === 'function') {\n      callback.apply(this, [item, data]);\n    }\n  },\n\n  /**\n   * Sets up the event listener structure for the popupmenu\n   * @private\n   * @listens dragstart\n   * @listens contextmenu\n   * @listens keydown\n   * @listens updated\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const leftClick = this.settings.trigger !== 'rightClick';\n    const immediate = this.settings.trigger === 'immediate';\n\n    function disableBrowserContextMenu(e) {\n      e.stopPropagation();\n      e.preventDefault();\n      return false;\n    }\n\n    function doOpen(e) {\n      if (self.element.hasClass('is-disabled')) {\n        e.stopPropagation();\n        e.preventDefault();\n        return;\n      }\n\n      const rightClick = self.settings.trigger === 'rightClick';\n\n      e.stopPropagation();\n      e.preventDefault();\n\n      if (rightClick && self.menu.hasClass('is-open')) {\n        self.close();\n        self.open(e);\n        return;\n      }\n\n      if (self.menu.hasClass('is-open')) {\n        self.close();\n      } else {\n        self.open(e);\n      }\n    }\n\n    function contextMenuHandler(e, isLeftClick) {\n      e.preventDefault();\n\n      if (self.keydownThenClick) {\n        delete self.keydownThenClick;\n        return;\n      }\n\n      const btn = isLeftClick === true ? 0 : 2;\n      if (e.button > btn || self.element.is(':disabled')) {\n        return;\n      }\n\n      const allowedOS = ['android', 'ios'];\n      if (allowedOS.indexOf(env.os.name) > -1) {\n        self.holdingDownClick = true;\n      }\n\n      doOpen(e);\n    }\n\n    if (!immediate) {\n      // Left-Click activation\n      if (leftClick) {\n        this.element\n          .on('click.popupmenu', (e) => {\n            contextMenuHandler(e, true);\n          });\n      }\n\n      // Right-Click activation\n      if (!leftClick) {\n        this.menu.parent().on('contextmenu.popupmenu', disableBrowserContextMenu);\n\n        const disallowedOS = ['android', 'ios'];\n        if (disallowedOS.indexOf(env.os.name) === -1) {\n          // Normal desktop operation\n          this.element\n            .on('contextmenu.popupmenu', (e) => {\n              disableBrowserContextMenu(e);\n              contextMenuHandler(e);\n            });\n        } else {\n          // Touch-based operation on a mobile device\n          this.element\n            .on('touchstart.popupmenu', (e) => {\n              // iOS needs this prevented to prevent its own longpress feature in Safari\n              if (env.os.name === 'ios') {\n                e.preventDefault();\n              }\n              $(e.target)\n                .addClass('longpress-target');\n            })\n            .on('touchend.popupmenu', (e) => {\n              $(e.target)\n                .removeClass('longpress-target');\n            })\n            .on('longpress.popupmenu', (e, originalE) => {\n              self.openedWithTouch = true;\n              contextMenuHandler(originalE);\n            });\n        }\n      }\n    }\n\n    // Disable dragging text to a new browser tab\n    this.menu.off('dragstart.popupmenu').on('dragstart.popupmenu', 'a', () => false);\n\n    // Setup these next events no matter what trigger type is\n    this.element.not('.autocomplete, ul')\n      .on('keydown.popupmenu', (e) => {\n        switch (e.which) {\n          case 13:\n          case 32:\n            if (self.settings.trigger === 'click') {\n              self.keydownThenClick = true;\n              self.open(e);\n            }\n            break;\n          case 121:\n            if (e.shiftKey) { // Shift F10\n              self.open(e);\n            }\n            break;\n          default:\n            break;\n        }\n      })\n      .on('updated.popupmenu', (e, settings) => {\n        e.stopPropagation();\n        self.updated(settings);\n      });\n  },\n\n  handleKeys() {\n    const self = this;\n    // http://access.aol.com/dhtml-style-guide-working-group/#popupmenu\n\n    // Handle Events in Anchors\n    this.menu.on('click.popupmenu', 'li', function (e) {\n      const a = $(this).find('a');\n      self.handleItemClick(e, a);\n    });\n\n    const excludes = 'li:not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled):not(.is-placeholder)';\n\n    // Select on Focus\n    if (this.settings.mouseFocus) {\n      this.menu.on('mouseenter.popupmenu', 'li', function () {\n        self.highlight($(this).children('a'));\n      });\n    }\n\n    setTimeout(function () {\n      $(document).off(`keydown.popupmenu.${this.id}`).on(`keydown.popupmenu.${this.id}`, (e) => {\n        const key = e.which;\n\n        // Close on escape\n        if (key === 27) {\n          e.stopPropagation();\n          e.stopImmediatePropagation();\n          self.close(true);\n          return false;\n        }\n\n        // Close on tab\n        if (key === 9) {\n          e.stopPropagation();\n          self.close(true);\n        }\n\n        // Select Checkboxes\n        if (key === 32) {\n          e.stopPropagation();\n\n          const target = $(e.target);\n          const checkbox = target.find('input:checkbox');\n\n          if (checkbox.length) {\n            checkbox.trigger('click');\n            return true;\n          }\n\n          let a = $();\n\n          // Return here and let Tabs control handle the spacebar\n          if (target.is('.tab') || target.parent().is('.tab') || target.is('.tab-more')) {\n            // Spacebar acts like Enter if there aren't any checkboxes (trigger links, etc)\n            e.preventDefault();\n            return true;\n          }\n\n          if (target.is('li')) {\n            a = target.children('a');\n          }\n\n          if (target.is('a')) {\n            a = target;\n          }\n\n          if (a.length) {\n            a.trigger('click');\n            return true;\n          }\n        }\n\n        let focus = self.menu.find(':focus');\n\n        // Sets focus for functional testing\n        if (!focus[0]) {\n          focus = $(self.menu[0].querySelector('.is-focused a'));\n        }\n\n        const isPicker = (self.settings.menu === 'colorpicker-menu');\n        const isAutocomplete = self.element.is('.autocomplete');\n\n        // Close Submenu\n        if (key === 37 && !isAutocomplete) {\n          e.stopPropagation();\n          e.preventDefault();\n\n          if (focus.closest('.popupmenu')[0] !== self.menu[0] && focus.closest('.popupmenu').length > 0) {\n            focus.closest('.popupmenu').removeClass('is-open').parent().parent()\n              .removeClass('is-submenu-open');\n            self.highlight(focus.closest('.popupmenu').parent().prev('a'));\n          }\n        }\n\n        let getPrev;\n        let getNext;\n        let getLast;\n        let getFirst;\n\n        getPrev = function (a) { //eslint-disable-line\n          const prevs = a.parent().prevAll(excludes);\n          let prev;\n\n          prevs.each(function () {\n            if (prev) {\n              return;\n            }\n\n            const li = $(this);\n            const targetA = li.children('a');\n\n            if (li.is('.is-disabled') || targetA.prop('disabled') === true) {\n              return;\n            }\n            prev = targetA;\n          });\n\n          if (!prev) {\n            return getFirst(a);\n          }\n\n          return prev;\n        };\n\n        getFirst = function (a) { //eslint-disable-line\n          const first = a.parent().prevAll(excludes).last();\n          const targetA = first.children('a');\n\n          if (first.is('.is-disabled') || targetA.prop('disabled') === true) {\n            return getNext(targetA);\n          }\n\n          return targetA;\n        };\n\n        getNext = function (a) {  //eslint-disable-line\n          const nexts = a.parent().nextAll(excludes);\n          let next;\n\n          nexts.each(function () {\n            if (next) {\n              return;\n            }\n\n            const li = $(this);\n            const targetA = li.children('a');\n\n            if (li.is('.is-disabled') || targetA.prop('disabled') === true) {\n              return;\n            }\n            next = targetA;\n          });\n\n          if (!next) {\n            return getFirst(a);\n          }\n\n          return next;\n        };\n\n        getLast = function (a) { //eslint-disable-line\n          const last = a.parent().nextAll(excludes).last();\n          const targetA = last.children('a');\n\n          if (last.is('.is-disabled') || targetA.prop('disabled') === true) {\n            return getPrev(targetA);\n          }\n\n          return targetA;\n        };\n\n        // Count number of rows in picker\n        let rowCount = 0;\n        const colors = self.menu.children(excludes);\n        const colorsLength = colors.length;\n        let currentOffsetTop = 0;\n\n        for (let i = 0; i < colorsLength; i++) {\n          const colorItem = colors[i];\n\n          if (currentOffsetTop === 0) {\n            currentOffsetTop = colorItem.offsetTop;\n          }\n\n          if (colorItem.offsetTop === currentOffsetTop) {\n            rowCount++;\n          } else {\n            break;\n          }\n        }\n\n        // Up on Up\n        if ((!isPicker && key === 38) || (isPicker && key === 37)) {\n          e.stopPropagation();\n          e.preventDefault();\n\n          // Go back to Top on the last one\n          if (focus.parent().prevAll(excludes).length === 0) {\n            if (focus.length === 0) {\n              self.highlight(self.menu.children(excludes).last().find('a'));\n            } else {\n              self.highlight(getLast(focus));\n            }\n            return undefined;\n          }\n          self.highlight(getPrev(focus));\n        }\n\n        // Up a square\n        if (isPicker && key === 38) {\n          e.stopPropagation();\n          e.preventDefault();\n\n          if (focus.parent().prevAll(excludes).length > 0) {\n            self.highlight($(focus.parent().prevAll(excludes)[rowCount - 1]).find('a'));\n          }\n        }\n\n        // Right Open Submenu\n        if (key === 39 && !isAutocomplete) {\n          e.stopPropagation();\n          e.preventDefault();\n\n          if (focus.parent().hasClass('submenu')) {\n            self.openSubmenu(focus.parent());\n            self.highlight(focus.parent().find('.popupmenu a:first'));\n          }\n        }\n\n        // Down\n        if ((!isPicker && key === 40) || (isPicker && key === 39 && !isAutocomplete)) {\n          e.stopPropagation();\n          e.preventDefault();\n\n          // Go back to Top on the last one\n          if (focus.parent().nextAll(excludes).length === 0) {\n            if (focus.length === 0) {\n              self.highlight(self.menu.children(excludes).first().find('a'));\n            } else {\n              self.highlight(getFirst(focus));\n            }\n            return undefined;\n          }\n          self.highlight(getNext(focus));\n        }\n\n        // Down a square\n        if ((isPicker && key === 40)) {\n          e.stopPropagation();\n          e.preventDefault();\n\n          if (focus.parent().nextAll(excludes).length > 0) {\n            self.highlight($(focus.parent().nextAll(excludes)[rowCount - 1]).find('a'));\n          }\n        }\n\n        // Fix - not sure why, but firefox have to manualy trigger\n        if (self.isFirefox && isAutocomplete && !(/37|39|38|40/.test(key))) {\n          self.element.triggerHandler(e);\n          self.element[0].focus();\n          const val = self.element[0].value;\n          self.element[0].value = '';\n          self.element[0].value = val;\n        }\n        return undefined;\n      });\n    }, 1);\n  },\n\n  /**\n   * Handles the action of clicking items in the popupmenu.\n   * @private\n   * @param {jQuery.Event} e jQuery `click` event\n   * @param {jQuery[]} anchor the anchor tag element that was clicked\n   * @returns {boolean} whether or not the click handler successfully passed.\n   */\n  handleItemClick(e, anchor) {\n    const href = anchor.attr('href');\n    let selectionResult = [anchor];\n\n    if (!e && !anchor) {\n      return false;\n    }\n\n    if (anchor.parent().is('.submenu, .hidden, .is-disabled') || anchor[0].disabled) {\n      // Do not close parent items of submenus on click\n      e.preventDefault();\n      return false;\n    }\n\n    if (anchor.find('input[checkbox]').length > 0) {\n      return false;\n    }\n\n    if (this.element.hasClass('btn-filter')) {\n      this.iconFilteringUpdate(anchor);\n      e.preventDefault();\n    }\n\n    if (this.isInSelectableSection(anchor) || this.menu.hasClass('is-selectable') || this.menu.hasClass('is-multiselectable')) {\n      selectionResult = this.select(anchor);\n    }\n\n    // Single toggle on off of checkbox class\n    if (anchor.parent().hasClass('is-toggleable')) {\n      anchor.parent().toggleClass('is-checked');\n    }\n\n    // Trigger a selected event containing the anchor that was selected\n    // If an event object is not passed to `handleItemClick()`, assume it was due to this\n    // event being triggered already, making it not necessary to re-trigger it.\n    if (e && this.settings.triggerSelect) {\n      if (selectionResult.length === 1) {\n        selectionResult.push(undefined);\n      }\n\n      selectionResult.push(true);\n      /**\n       * Fires on selected.\n       *\n       * @event selected\n       * @memberof PopupMenu\n       * @property {object} event - The jquery event object\n       * @property {object} selected anchor\n       */\n      this.element.triggerHandler('selected', selectionResult);\n    }\n\n    // MultiSelect Lists should act like other \"multiselect\" items and not\n    // close the menu when options are chosen.\n    if (this.menu.hasClass('is-multiselectable') || this.isInMultiselectSection(anchor)) {\n      return true;\n    }\n\n    this.close();\n\n    if (this.element.is('.autocomplete')) {\n      return true;\n    }\n\n    if (href && href.charAt(0) !== '#') {\n      if (anchor.attr('target') === '_blank') {\n        window.open(href, '_blank');\n      } else {\n        window.location.href = href;\n      }\n      return true;\n    }\n\n    if (e) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n\n    return true;\n  },\n\n  /**\n   * Filtering icon initial setup\n   * @private\n   * @param {jQuery[]} [alink] menu item to be targeted\n   * @returns {void}\n   */\n  iconFilteringSetup(alink) {\n    if (this.element.hasClass('btn-filter')) {\n      const svg = this.element.find('svg.icon-dropdown');\n      const link = alink || $('li.is-checked a', this.menu) || $('li:first a', this.menu);\n      const audibleText = link.find('span').text();\n\n      if (svg.length === 1) {\n        this.element.append($.createIconElement({ classes: 'icon-dropdown', icon: 'dropdown' }));\n      }\n\n      svg.first().changeIcon(link.find('svg').getIconName());\n      this.element.find('.audible').text(audibleText);\n    }\n  },\n\n  /**\n   * Filtering icon update\n   * @private\n   * @param {jQuery[]} [alink] menu item to be targeted\n   * @returns {void}\n   */\n  iconFilteringUpdate(alink) {\n    if (this.element.hasClass('btn-filter')) {\n      const link = alink || $('li.is-checked a', this.menu) || $('li:first a', this.menu);\n      const audibleText = link.find('span').text();\n\n      this.element.find('.audible').text(audibleText);\n      this.element.find('svg:not(.ripple-effect):first').changeIcon(link.find('svg').getIconName());\n    }\n  },\n\n  /**\n   * Get the event position, handling browser cases (IE,FF) as well as SVG\n   * @private\n   * @param {jQuery.Event} e the mouse event to be checked for pageX/pageY\n   * @returns {object} containing x/y coordinates\n   */\n  getPositionFromEvent(e) {\n    let x = 0;\n    let y = 0;\n\n    if (!e) {\n      e = window.event;\n    }\n\n    if (!e) {\n      return {};\n    }\n\n    if (e.changedTouches) {\n      const touch = e.changedTouches[0];\n      x = touch.pageX;\n      y = touch.pageY;\n    } else if (e.pageX || e.pageY) {\n      x = e.pageX;\n      y = e.pageY;\n    } else if (e.clientX || e.clientY) {\n      x = e.clientX + document.body.scrollLeft +\n        document.documentElement.scrollLeft;\n      y = e.clientY + document.body.scrollTop +\n        document.documentElement.scrollTop;\n    }\n\n    return {\n      x,\n      y\n    };\n  },\n\n  /**\n   * Sets the position of the context menu.\n   * @private\n   * @param {jQuery.Event} e jQuery Event that caused the menu to open (can be several types)\n   * @returns {void}\n   */\n  position(e) {\n    const self = this;\n    let target = this.element;\n    const isRTL = this.isRTL();\n    const wrapper = this.menu.parent('.popupmenu-wrapper');\n    const mouse = this.getPositionFromEvent(e);\n    const menuDimensions = {\n      width: this.menu[0].offsetWidth,\n      height: this.menu[0].offsetHeight\n    };\n\n    if (!wrapper.length) {\n      return;\n    }\n\n    // Make the field the same size\n    const elemWidth = this.element[0].offsetWidth;\n    if (this.settings.trigger === 'click' && elemWidth > menuDimensions.width) {\n      this.menu.width(elemWidth);\n    }\n\n    if (target.is('svg, .icon') && target.closest('.tab').length) {\n      target = target.closest('.tab');\n    }\n\n    function getCoordinates(thisE, axis) {\n      axis = ((axis === 'x' || axis === 'y') ? axis : 'x');\n      return mouse[axis]; // use mouseX/mouseY if this doesn't work\n    }\n\n    // Reset the arrow\n    wrapper.find('.arrow').removeAttr('style');\n\n    const opts = $.extend({}, this.settings.placementOpts);\n    const strategies = ['flip'];\n\n    /*\n    if (!target.is('.autocomplete, .searchfield')) {\n      strategies.push('nudge');\n    }\n    */\n    strategies.push('shrink-y');\n    opts.strategies = strategies;\n\n    // If right-click or immediate (with an incoming event object), use coordinates from the event\n    if ((this.settings.trigger === 'immediate' && this.settings.eventObj) || this.settings.trigger === 'rightClick') {\n      opts.x = getCoordinates(e, 'x') - (isRTL ? menuDimensions.width : 0) + ((isRTL ? -1 : 1) * this.settings.offset.x);\n      opts.y = getCoordinates(e, 'y') + this.settings.offset.y;\n\n      if (opts.x === 0 && opts.y === 0) {\n        opts.x = this.settings.offset.x || 0;\n        opts.y = this.settings.offset.y || 0;\n        opts.parent = this.element;\n        opts.placement = 'bottom';\n        opts.parentXAlignment = isRTL ? 'right' : 'left';\n      }\n    } else {\n      opts.x = this.settings.offset.x || 0;\n      opts.y = this.settings.offset.y || 0;\n      opts.parent = this.element;\n      opts.placement = 'bottom';\n      opts.strategies.push('nudge');\n    }\n\n    //= ======================================================\n    // BEGIN Temporary stuff until we sort out passing these settings\n    // from the controls that utilize them\n    //= ======================================================\n\n    const toolbarParent = target.parents('.toolbar');\n    const insideToolbar = toolbarParent.length > 0;\n    const insideToolbarTitle = target.parents('.title').length > 0;\n    const isNotFullToolbar = insideToolbar && toolbarParent.children('.buttonset, .title').length > 1;\n    const isPagerMenu = target.parents('.pager-pagesize').length > 0;\n\n    function alignLeft() {\n      opts.parentXAlignment = (isRTL ? 'right' : 'left');\n    }\n\n    function alignRight() {\n      opts.parentXAlignment = (isRTL ? 'left' : 'right');\n    }\n\n    function shiftDown() {\n      opts.y += 15;\n    }\n\n    // Change the alignment of the popupmenu based on certain conditions\n    (function doAlignment() {\n      if (target.is('.btn-menu')) {\n        if (isPagerMenu) {\n          return alignRight();\n        }\n\n        if (insideToolbar) {\n          if (!isNotFullToolbar) {\n            return alignLeft();\n          }\n          if (insideToolbarTitle) {\n            return alignLeft();\n          }\n          return alignRight();\n        }\n\n        return alignLeft();\n      }\n\n      if (target.is('.btn-actions')) {\n        return alignRight();\n      }\n\n      if (target.is('.tab-more')) {\n        return alignRight();\n      }\n\n      if ((target.is('.btn-split-menu, .tab, .searchfield-category-button') &&\n        !target.parent('.pager-pagesize').length)) {\n        return alignLeft();\n      }\n\n      return undefined;\n    }());\n\n    if (target.parents('.masthead').length > 0) {\n      shiftDown();\n    }\n\n    // If inside a \"page-container\" element, constrain the popupmenu to that element\n    // (fixes SOHO-6223)\n    const container = this.element.parents('.page-container:not(.tab-container)');\n    if (container.length) {\n      opts.container = container.first();\n    }\n\n    //= ======================================================\n    // END Temporary stuff until we sort out passing these settings\n    // from the controls that utilize them\n    //= ======================================================\n\n    wrapper.one('afterplace.popupmenu', (thisE, positionObj) => {\n      self.handleAfterPlace(thisE, positionObj);\n    });\n\n    this.wrapperPlace = new Place(wrapper, opts);\n    this.wrapperPlace.place(opts);\n  },\n\n  handleAfterPlace(e, placementObj) {\n    const wrapper = this.menu.parent('.popupmenu-wrapper');\n    this.wrapperPlace.setArrowPosition(e, placementObj, wrapper);\n\n    if (placementObj.height) {\n      wrapper[0].style.height = '';\n      this.menu[0].style.height = (placementObj.height) + (/(px|%)/i.test(`${placementObj.height}`) ? '' : 'px');\n    }\n    if (placementObj.width) {\n      wrapper[0].style.width = '';\n      this.menu[0].style.width = (placementObj.width) + (/(px|%)/i.test(`${placementObj.width}`) ? '' : 'px');\n    }\n\n    wrapper.triggerHandler('popupmenuafterplace', [placementObj]);\n    return placementObj;\n  },\n\n  /**\n   * Calls an external source.\n   * @private\n   * @param {jQuery.Event} [e] an event that triggered the Popupmenu to open\n   *  (could be several types)\n   * @param {boolean} [doOpen] causes the menu to re-open once the data has been reloaded.\n   * @param {jQuery[]|HTMLElement} [contextElement] if passed, represents a submenu\n   *  as the actionable, replaceable menu element instead of the main menu.\n   * @param {boolean} [isSubmenu] Note that the request is a submenu for the callback.\n  */\n  callSource(e, doOpen, contextElement, isSubmenu) {\n    if (typeof this.settings.beforeOpen !== 'function') {\n      return;\n    }\n\n    const self = this;\n    let targetMenu = this.menu;\n\n    // Use a different menu, if applicable\n    if (DOM.isElement(contextElement) && $(contextElement).is('.popupmenu, .submenu')) {\n      targetMenu = $(contextElement);\n      // Skip calling external source if submenu is already open\n      if (contextElement.hasClass('is-open')) {\n        return;\n      }\n    }\n\n    const response = function (content) {\n      const existingMenuItems = targetMenu.children();\n\n      existingMenuItems\n        .filter((i, item) => self.predefinedItems.index(item) === -1)\n        .off()\n        .remove();\n\n      if (content === false) {\n        return false;\n      }\n\n      const newContent = $(content);\n      targetMenu.append(newContent);\n\n      let wrapper = targetMenu.parent('.wrapper, .popupmenu-wrapper');\n      if (!wrapper.length) {\n        wrapper = targetMenu.wrap('<div class=\"wrapper\">').parent();\n      }\n      wrapper.removeAttr('style');\n      self.markupItems(targetMenu);\n\n      if (doOpen) {\n        if (!targetMenu.is(self.menu)) {\n          self.openSubmenu(wrapper.parent('li'), true);\n        } else {\n          self.open(e, true);\n        }\n      }\n      return true;\n    };\n\n    const callbackOpts = {};\n    if (!targetMenu.is(this.menu)) {\n      callbackOpts.contextElement = targetMenu;\n    }\n\n    callbackOpts.element = this.element;\n    callbackOpts.isSubmenu = isSubmenu;\n\n    if (typeof this.settings.beforeOpen === 'string') {\n      window[this.settings.beforeOpen](response, callbackOpts);\n      return;\n    }\n\n    this.settings.beforeOpen(response, callbackOpts);\n  },\n\n  /**\n   * Opens the popupmenu, including repopulating data and setting up visual delays, if necessary.\n   * @param {jQuery.Event} e the event that caused the menu to open\n   * @param {boolean} ajaxReturn set to true if the open routine should not include a source call\n   * @param {boolean} useDelay set to true if the menu should open on a delay (used in mobile environments where a software keybord is present)\n   * @returns {void}\n   */\n  open(e, ajaxReturn, useDelay) {\n    const self = this;\n    /**\n     * Fires before open.\n     *\n     * @event beforeopen\n     * @memberof PopupMenu\n     * @property {object} event - The jquery event object\n     * @property {object} this menu instance\n     */\n    let canOpen = true;\n    if (!this.element.hasClass('autocomplete')) {\n      canOpen = this.element.triggerHandler('beforeopen', [this.menu]);\n      if (canOpen === false) {\n        return;\n      }\n    }\n\n    // Check external AJAX source, if applicable\n    if (!ajaxReturn) {\n      canOpen = this.callSource(e, true);\n\n      if (this.settings.beforeOpen) {\n        return;\n      }\n    }\n\n    // If there's no explicit run of this method without this flag, setup a delay and re-run the open method\n    if (!useDelay) {\n      if (env.os.name === 'ios') {\n        setTimeout(() => {\n          self.open(e, ajaxReturn, true);\n        }, 400);\n        return;\n      }\n    }\n\n    const otherMenus = $('.popupmenu.is-open').filter(function () {\n      return $(this).parents('.popupmenu').length === 0;\n    }).not(this.menu); // close others.\n\n    otherMenus.each(function () {\n      const trigger = $(this).data('trigger');\n      if (!trigger || !trigger.length) {\n        return;\n      }\n\n      const api = $(this).data('trigger').data('popupmenu');\n      if (api && typeof api.close === 'function') {\n        api.close();\n      }\n    });\n\n    // Close open tooltips associated with this menu's trigger element\n    const tooltipAPI = this.element.data('tooltip');\n    if (tooltipAPI && tooltipAPI.visible) {\n      tooltipAPI.hide();\n    }\n\n    // Close open dropdowns\n    const openDropdown = $('.dropdown.is-open');\n    if (openDropdown.length > 0) {\n      const dropDownApi = openDropdown.parent().prev().data('dropdown');\n      if (dropDownApi) {\n        dropDownApi.closeList('cancel');\n      }\n    }\n\n    this.element.addClass('is-open');\n    this.menu.addClass('is-open').attr('aria-hidden', 'false');\n\n    if (this.element.hasClass('inverse')) {\n      this.menu.parent('.popupmenu-wrapper').addClass('inverse');\n    }\n\n    this.position(e);\n    utils.fixSVGIcons(this.menu);\n\n    if (this.element.closest('.header').length > 0) {\n      this.menu.parent()[0].style.zIndex = '9001';\n    }\n\n    // Check every anchor tag to see if it should be disabled.\n    // Use the CSS class on its parent to determine whether or not to disable.\n    this.menu.find('a').each(function () {\n      const a = $(this);\n      const li = a.parent();\n\n      if (li.hasClass('is-disabled')) {\n        li.addClass('is-disabled');\n        a.attr('aria-disabled', 'true');\n        a.attr('disabled', 'disabled');\n      } else {\n        li.removeClass('is-disabled');\n        a.removeAttr('aria-disabled');\n        a.removeAttr('disabled');\n      }\n    });\n\n    // Close on Document Click ect..\n    setTimeout(() => {\n      $(document).on(`touchend.popupmenu.${self.id} click.popupmenu.${self.id}`, (thisE) => {\n        const isPicker = (self.settings.menu === 'colorpicker-menu');\n\n        if (thisE.button === 2) {\n          return;\n        }\n\n        if (self.holdingDownClick) {\n          delete self.holdingDownClick;\n          return;\n        }\n\n        // Click functionality will toggle the menu - otherwise it closes and opens\n        if ($(thisE.target).is(self.element) && !isPicker) {\n          return;\n        }\n\n        if ($(thisE.target).closest('.popupmenu').length === 0) {\n          self.close(true, self.settings.trigger === 'rightClick');\n        }\n\n        if ($(thisE.target).hasClass('colorpicker')) {\n          self.close();\n        }\n      });\n\n      // in desktop environments, close the list on viewport resize\n      if (window.orientation === undefined) {\n        $('body').on('resize.popupmenu', () => {\n          self.handleCloseEvent();\n        });\n      }\n\n      $(window).on('scroll.popupmenu', () => {\n        self.close();\n      });\n\n      $('.scrollable, .modal.is-visible .modal-body-wrapper').on('scroll.popupmenu', () => {\n        self.close();\n      });\n\n      /**\n       * Fires on open.\n       *\n       * @event open\n       * @memberof PopupMenu\n       * @property {object} event - The jquery event object\n       * @property {object} this menu instance\n       */\n      self.element.triggerHandler('open', [self.menu]);\n    }, 300);\n\n    // Hide on iFrame Clicks - only works if on same domain\n    $('iframe').each(function () {\n      const frame = $(this);\n      frame.ready(() => {\n        try {\n          frame.contents().find('body').on('click.popupmenu', () => {\n            self.close();\n          });\n        } catch (thisE) {\n          // Ignore security errors on out of iframe\n        }\n      });\n    });\n\n    this.handleKeys();\n\n    // hide and decorate submenus - we use a variation on\n    let tracker = 0;\n    let startY;\n    let menuToClose;\n    let timeout;\n\n    self.menu.find('.popupmenu').removeClass('is-open');\n    self.menu.on('mouseenter.popupmenu touchstart.popupmenu', '.submenu', function (thisE) {\n      const menuitem = $(this);\n      startY = thisE.pageX;\n\n      clearTimeout(timeout);\n      timeout = setTimeout(() => {\n        self.openSubmenu(menuitem);\n      }, 300);\n\n      $(document).on(`mousemove.popupmenu.${this.id}`, (documentE) => {\n        tracker = documentE.pageX;\n      });\n    }).on('mouseleave.popupmenu', '.submenu', function () {\n      $(document).off(`mousemove.popupmenu.${this.id}`);\n\n      menuToClose = $(this).find('ul');\n\n      const hasWrapper = menuToClose.parent('.wrapper').length > 0;\n      const isLeft = (hasWrapper ? parseInt(menuToClose.parent('.wrapper')[0].style.left, 10) : 0) < 0;\n      let canClose = (tracker - startY) < 3.5;\n\n      if (isLeft) {\n        canClose = (tracker - startY) >= 0;\n      }\n\n      if (canClose) { // We are moving slopie to the menu\n        menuToClose.removeClass('is-open').removeAttr('style');\n        menuToClose.parent('.wrapper').removeAttr('style');\n        menuToClose.parent().parent().removeClass('is-submenu-open');\n        menuToClose = null;\n      }\n      clearTimeout(timeout);\n    });\n\n    if (self.settings.autoFocus) {\n      setTimeout(() => {\n        const excludes = ':not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)';\n        let selection = self.menu.children(excludes).find('.is-selected').children('a');\n\n        if (!selection.length) {\n          selection = self.menu.children(excludes).first().children('a');\n        }\n\n        self.highlight(selection);\n        /**\n         * Fires after open.\n         *\n         * @event afteropen\n         * @memberof PopupMenu\n         * @property {object} event - The jquery event object\n         * @property {object} this menu instance\n         */\n        self.element.triggerHandler('afteropen', [self.menu]);\n      }, 1);\n    }\n  },\n\n  /**\n   * Only allows a menu to close if a key is no longer being pressed\n   * @private\n   * @returns {void}\n   */\n  handleCloseEvent() {\n    if (this.holdingDownClick) {\n      return;\n    }\n\n    this.close();\n  },\n\n  /**\n   * Opens a top-level menu item's submenu, if applicable\n   * @private\n   * @param {jQuery[]} li the list item that needs to be opened.\n   * @param {boolean} [ajaxReturn] if defined, prevents an external source from\n   *  re-populating the menu before it opens.\n   * @returns {void}\n   */\n  openSubmenu(li, ajaxReturn) {\n    if (DOM.hasClass(li, 'is-disabled') || li[0].disabled) {\n      return;\n    }\n\n    let submenu = li.children('.wrapper, .popupmenu');\n    if (submenu.length && submenu.is('.wrapper')) {\n      submenu = submenu.children('.popupmenu');\n    }\n\n    let canOpen = this.element.triggerHandler('beforeopen', [submenu]);\n    if (canOpen === false) {\n      return;\n    }\n\n    // Check external AJAX source, if applicable\n    if (!ajaxReturn) {\n      canOpen = this.callSource(null, true, submenu, true);\n      if (this.settings.beforeOpen) {\n        return;\n      }\n    }\n\n    this.showSubmenu(li);\n  },\n\n  /**\n   * Opens a top-level menu item's submenu, if applicable\n   * @private\n   * @param {jQuery[]} li the list item that needs to be opened.\n   * @returns {void}\n   */\n  showSubmenu(li) {\n    // Trigger an event so other components can listen to this element as a popupmenu trigger.\n    this.element.triggerHandler('show-submenu', [li]);\n\n    let wrapper = li.children('.wrapper').filter(':first');\n    const isRTL = this.isRTL();\n    const rtlPadding = 30;\n\n    // Wrap if not wrapped (dynamic menu situation)\n    if (wrapper.length === 0) {\n      const ul = li.children('ul').filter(':first');\n      ul.wrap('<div class=\"wrapper\"></div>');\n      wrapper = ul.parent();\n    }\n\n    const menu = wrapper.children('.popupmenu');\n    let wrapperLeft = li.position().left + li.outerWidth();\n    let wrapperWidth = 0;\n\n    li.parent().find('.popupmenu').removeClass('is-open').removeAttr('style');\n\n    wrapper.children('.popupmenu').addClass('is-open');\n    wrapperWidth = wrapper.outerWidth();\n\n    if (isRTL) {\n      wrapperLeft = li.position().left - wrapperWidth;\n    }\n    wrapper[0].style.left = `${wrapperLeft}px`;\n    wrapper[0].style.top = `${parseInt(li.position().top, 10) - 5}px`;\n\n    // Handle Case where the menu is off to the right\n    let menuWidth = menu.outerWidth();\n    if ((wrapper.offset().left + menuWidth) > ($(window).width() + $(document).scrollLeft()) ||\n      (isRTL && wrapper.offset().left < 0)) {\n      wrapper[0].style.left = '-9999px';\n      menuWidth = menu.outerWidth();\n      wrapperLeft = li.position().left - menuWidth;\n\n      if (isRTL) {\n        const parentMenuWidth = wrapper.closest('.popupmenu').outerWidth();\n        wrapperLeft = parentMenuWidth - 4; // Move back across the parent menu\n      }\n      wrapper[0].style.left = `${wrapperLeft}px`;\n\n      // Did it fit?\n      if (wrapper.offset().left < 0 ||\n        (isRTL &&\n          (wrapper.offset().left + menuWidth) > ($(window).width() + $(document).scrollLeft())\n        )\n      ) {\n        // No. Push the menu's left offset onto the screen.\n        wrapperLeft = li.position().left - menuWidth + Math.abs(wrapper.offset().left) + 40;\n        if (isRTL) {\n          wrapperLeft = li.position().left - menuWidth - rtlPadding;\n        }\n        wrapper[0].style.left = `${wrapperLeft}px`;\n        menuWidth = menu.outerWidth();\n      }\n\n      // Do one more check to see if the right edge bleeds off the screen.\n      // If it does, shrink the menu's X size.\n      if ((wrapper.offset().left + menuWidth) >\n        ($(window).width() + $(document).scrollLeft()) || (isRTL && wrapper.offset().left < 0)) {\n        const differenceY = (wrapper.offset().left + menuWidth) -\n          ($(window).width() + $(document).scrollLeft());\n        menuWidth -= differenceY;\n        menu[0].style.width = `${menuWidth}px`;\n      }\n    }\n\n    // Handle Case where menu is off bottom\n    let menuHeight = menu.outerHeight();\n    if ((wrapper.offset().top + menuHeight) > ($(window).height() + $(document).scrollTop())) {\n      // First try bumping up the menu to sit just above the bottom edge of the window.\n      const bottomEdgeCoord = wrapper.offset().top + menuHeight;\n      const differenceFromBottomY = bottomEdgeCoord -\n        ($(window).height() + $(document).scrollTop());\n\n      wrapper[0].style.top = `${wrapper.position().top - differenceFromBottomY}px`;\n\n      // Does it fit?\n      if ((wrapper.offset().top + menuHeight) > ($(window).height() + $(document).scrollTop())) {\n        // No. Bump the menu up higher based on the menu's height and the extra\n        // space from the main wrapper.\n        const mainWrapperOffset = li.parents('.popupmenu-wrapper:first').offset().top;\n        wrapper[0].style.top = `${($(window).height() + $(document).scrollTop()) -\n          menuHeight - mainWrapperOffset}px`;\n      }\n\n      // Does it fit now?\n      if ((wrapper.offset().top - $(document).scrollTop()) < 0) {\n        // No. Push the menu down onto the screen from the top of the window edge.\n        wrapper[0].style.top = 0;\n        wrapper[0].style.top = `${wrapper.offset().top * -1}px`;\n        menuHeight = menu.outerHeight();\n      }\n\n      // Do one more check to see if the bottom edge bleeds off the screen.\n      // If it does, shrink the menu's Y size and make it scrollable.\n      if ((wrapper.offset().top + menuHeight) > ($(window).height() + $(document).scrollTop())) {\n        const differenceX = (wrapper.offset().top + menuHeight) -\n          ($(window).height() + $(document).scrollTop());\n        menuHeight = menuHeight - differenceX - 32;\n        menu[0].style.height = `${menuHeight}px`;\n      }\n    }\n\n    li.parent().find('.is-submenu-open').removeClass('is-submenu-open');\n    li.addClass('is-submenu-open');\n  },\n\n  /**\n   * Places a highlighted visual state on an item inside the menu\n   * @private\n   * @param {jQuery[]} anchor the anchor tag representing the menu item.\n   * @returns {void}\n   */\n  highlight(anchor) {\n    if (!anchor || !anchor.length) {\n      return;\n    }\n\n    const li = anchor.parent();\n\n    li.parent().children('li').removeClass('is-focused');\n    li.addClass('is-focused');\n\n    // Prevent chrome from scrolling - toolbar\n    if (anchor) {\n      anchor.focus();\n    }\n    li.closest('.header').scrollTop(0);\n  },\n\n  /**\n   * Adds/removes checkmarks that are in selectable groups inside the Popupmenu\n   * @param {jQuery[]} anchor the anchor tag representing the menu item.\n   * @returns {array} updated references to the anchor and its state.\n   */\n  select(anchor) {\n    const singleMenu = this.menu.is('.is-selectable');\n    const multipleMenu = this.menu.is('.is-multiselectable');\n    const singleSection = this.isInSingleSelectSection(anchor);\n    const multipleSection = this.isInMultiselectSection(anchor);\n    const parent = anchor.parent();\n    const returnObj = [anchor];\n\n    // If the entire menu is \"selectable\", place the checkmark where it's supposed to go.\n    if (singleMenu || singleSection) {\n      parent.prevUntil('.heading, .separator').add(parent.nextUntil('.heading, .separator')).removeClass('is-checked');\n      parent.addClass('is-checked');\n      returnObj.push('selected');\n      return returnObj;\n    }\n\n    if (multipleMenu || multipleSection) {\n      if (parent.hasClass('is-checked')) {\n        parent.removeClass('is-checked');\n        returnObj.push('deselected');\n        return returnObj;\n      }\n      parent.addClass('is-checked');\n      returnObj.push('selected');\n      return returnObj;\n    }\n\n    return returnObj;\n  },\n\n  /**\n   * Gets references to top-level menu items that are currently selected.\n   * @returns {jQuery[]} elements inside the top-level menu that are selected.\n   */\n  getSelected() {\n    if (!this.menu.is('.is-selectable, .is-multiselectable')) {\n      return $();\n    }\n\n    return this.menu.children('.is-checked').children('a');\n  },\n\n  /**\n   * Determines whether or not an anchor resides inside of a selectable Popupmenu section.\n   * @param {jQuery[]} anchor the anchor tag being checked.\n   * @returns {jQuery[]} elements inside the top-level menu that are selected.\n   */\n  isInSelectableSection(anchor) {\n    const separator = anchor.parent().prevAll().filter('.separator').first();\n    return (separator.hasClass('multi-selectable-section') || separator.hasClass('single-selectable-section'));\n  },\n\n  /**\n   * Determines whether or not an anchor resides inside of a single-selectable Popupmenu section.\n   * @param {jQuery[]} anchor the anchor tag being checked.\n   * @returns {jQuery[]} elements inside the top-level menu that are selected\n   *  within a single-selectable section.\n   */\n  isInSingleSelectSection(anchor) {\n    return anchor.parent().prevAll().filter('.separator').first()\n      .hasClass('single-selectable-section');\n  },\n\n  /**\n   * Determines whether or not an anchor resides inside of a multi-selectable Popupmenu section.\n   * @param {jQuery[]} anchor the anchor tag being checked.\n   * @returns {jQuery[]} elements inside the top-level menu that are selected\n   *  within a multi-selectable section.\n   */\n  isInMultiselectSection(anchor) {\n    return anchor.parent().prevAll().filter('.separator').first()\n      .hasClass('multi-selectable-section');\n  },\n\n  /**\n   * Removes event listeners from all popupmenu elements.\n   * @private\n   * @returns {void}\n   */\n  detach() {\n    $(document).off(`touchend.popupmenu.${this.id} click.popupmenu.${this.id} keydown.popupmenu`);\n    $(window).off('scroll.popupmenu orientationchange.popupmenu');\n    $('body').off('resize.popupmenu');\n    $('.scrollable').off('scroll.popupmenu');\n\n    this.menu.off('click.popupmenu touchend.popupmenu touchcancel.popupmenu');\n\n    $('iframe').each(function () {\n      const frame = $(this);\n      try {\n        frame.contents().find('body').off('click.popupmenu touchend.popupmenu touchcancel.popupmenu');\n      } catch (e) {\n        // Ignore security errors on out of iframe\n      }\n    });\n  },\n\n  /**\n   * Close the open menu\n   * @param {boolean} isCancelled Internally set option used if the operation is a cancel.\n   *  Wont matter for manual api call.\n   * @param {boolean} [noFocus] Do not return focus to the calling element (fx a button)\n   */\n  close(isCancelled, noFocus) {\n    if (!isCancelled || isCancelled === undefined) {\n      isCancelled = false;\n    }\n\n    if (!this.menu.hasClass('is-open')) {\n      return;\n    }\n\n    const wrapper = this.menu.parent('.popupmenu-wrapper');\n    const menu = this.menu.find('.popupmenu');\n\n    this.menu.removeClass('is-open').attr('aria-hidden', 'true');\n    if (this.menu[0]) {\n      this.menu[0].style.height = '';\n      this.menu[0].style.width = '';\n    }\n\n    if (wrapper[0]) {\n      wrapper[0].style.left = '-999px';\n      wrapper[0].style.height = '';\n      wrapper[0].style.width = '';\n    }\n\n    this.menu.find('.submenu')\n      .off([\n        'mouseenter.popupmenu',\n        'mouseleave.popupmenu'\n      ].join(' '))\n      .removeClass('is-submenu-open');\n\n    if (menu[0]) {\n      menu[0].style.left = '';\n      menu[0].style.top = '';\n      menu[0].style.height = '';\n      menu[0].style.width = '';\n    }\n\n    this.menu.find('.is-focused').removeClass('is-focused');\n\n    // Close all events\n    $(document).off([\n      `keydown.popupmenu.${this.id}`,\n      `click.popupmenu.${this.id}`,\n      `mousemove.popupmenu.${this.id}`,\n      `touchend.popupmenu.${self.id}`\n    ].join(' '));\n\n    this.menu.off([\n      'click.popupmenu',\n      'touchend.popupmenu',\n      'touchcancel.popupmenu',\n      'mouseenter.popupmenu',\n      'mouseleave.popupmenu'].join(' '));\n\n    // Get rid of internal flags that check for how the menu was opened\n    delete this.keydownThenClick;\n    delete this.holdingDownClick;\n\n    /**\n     * Fires when close.\n     *\n     * @event close\n     * @memberof PopupMenu\n     * @property {object} event - The jquery event object\n     * @property {object} close by cancelled\n     */\n    this.element.removeClass('is-open').triggerHandler('close', [isCancelled]);\n    this.detach();\n\n    if (this.settings.trigger === 'immediate') {\n      this.destroy();\n    }\n\n    // On text input targets, don't refocus the input if the opening event was called by a touch\n    if (this.element[0].tagName === 'INPUT' && this.openedWithTouch) {\n      this.element.removeClass('longpress-target');\n      delete this.openedWithTouch;\n      return;\n    }\n\n    delete this.openedWithTouch;\n\n    if (noFocus || !this.settings.returnFocus || env.features.touch) {\n      return;\n    }\n\n    if (typeof this.settings.returnFocus === 'function') {\n      this.settings.returnFocus(this, {\n        triggerElement: this.element[0],\n        menuElement: this.menu[0]\n      });\n      return;\n    }\n\n    if (document.activeElement && document.activeElement.tagName === 'INPUT') {\n      return;\n    }\n    if (this.element) {\n      this.element.focus();\n    }\n  },\n\n  /**\n   * Removes bound events and generated markup from this component\n   * @private\n   * @returns {void}\n   */\n  teardown() {\n    const self = this;\n    const wrapper = this.menu.parent('.popupmenu-wrapper');\n\n    if (this.ajaxContent) {\n      this.ajaxContent.off().remove();\n    }\n\n    this.predefinedItems = $();\n\n    this.menu.parent().off('contextmenu.popupmenu');\n    if (this.element.hasClass('btn-actions')) {\n      this.menu.parent().removeClass('bottom').find('.arrow').remove();\n    }\n\n    this.menu.off('dragstart.popupmenu');\n\n    // TODO: Fix when we have time - shouldn't be referencing other controls here\n    let insertTarget = this.element;\n    const searchfield = this.element.parent().children('.searchfield');\n\n    if (searchfield.length) {\n      insertTarget = searchfield.first();\n    }\n    if (this.settings.attachToBody && insertTarget) {\n      this.menu.unwrap();\n\n      if (this.settings.removeOnDestroy) {\n        this.menu.off().remove();\n      }\n    }\n    if (this.menu && insertTarget && !this.settings.attachToBody) {\n      this.menu.insertAfter(insertTarget);\n    }\n\n    this.menu.find('.submenu').children('a').each((i, item) => {\n      const spantext = $(item).find('span').text();\n      const text = spantext || $(item).text();\n      $(item).find('span, svg').remove();\n      $(item).text(text);\n    });\n    this.menu.find('.submenu').removeClass('submenu');\n\n    function unwrapPopup(menu) {\n      const thisWrapper = menu.parent();\n      if (thisWrapper.is('.popupmenu-wrapper, .wrapper')) {\n        menu.unwrap();\n      }\n    }\n\n    // Unwrap submenus\n    this.menu.find('.popupmenu').each(function () {\n      unwrapPopup($(this));\n    });\n\n    if (self.wrapperPlace) {\n      self.wrapperPlace.destroy();\n      delete self.wrapperPlace;\n    }\n    wrapper.off().remove();\n\n    if (this.menu[0]) {\n      $.removeData(this.menu[0], 'trigger');\n    }\n\n    this.detach();\n    this.element\n      .removeAttr('aria-controls')\n      .removeAttr('aria-haspopup')\n      .off('touchend.popupmenu touchcancel.popupmenu click.popupmenu keydown.popupmenu keypress.popupmenu contextmenu.popupmenu updated.popupmenu');\n\n    return this;\n  },\n\n  /**\n   * Updates this Popupmenu instance with new settings\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Teardown markup and detach all events.\n   * @returns {void}\n   */\n  destroy() {\n    this.close();\n    this.teardown();\n    this.menu.trigger('destroy');\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { PopupMenu, COMPONENT_NAME };\n","import { PopupMenu, COMPONENT_NAME } from './popupmenu';\n\n/**\n * jQuery Component Wrapper for Popupmenu\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.popupmenu = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new PopupMenu(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { Environment as env } from '../../utils/environment';\n\nconst COMPONENT_NAME = 'about';\n\n/**\n * The About Dialog Component is displays information regarding the application.\n * @class About\n * @param {object} element The component element.\n * @param {object} [settings] The component settings.\n * @param {string} [settings.appName='Infor Application Name'] The Main Application Name to display in the header.\n * @param {string} [settings.content] Additional text content to display at the top.\n * @param {string} [settings.copyrightYear=new Date().getFullYear()] The year displayed in the copyright, defaults to current year.\n * @param {boolean} [settings.deviceSpecs=true] Determines whether or not to display device information.\n * This information includes Browser, Platform, Locale and if Cookies are Enabled.\n * @param {string} [settings.productName] Additional product name information to display.\n * @param {boolean} [settings.useDefaultCopyright=true] Add the Legal Approved Infor Copyright Text.\n * @param {string} [settings.version] Semantic Version Number for example (4.0.0).\n */\nconst ABOUT_DEFAULTS = {\n  appName: 'Infor Application Name',\n  content: undefined,\n  copyrightYear: new Date().getFullYear(),\n  deviceSpecs: true,\n  productName: undefined,\n  useDefaultCopyright: true,\n  version: undefined,\n};\n\nfunction About(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, ABOUT_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nAbout.prototype = {\n\n  init() {\n    return this\n      .setup()\n      .build()\n      .handleEvents();\n  },\n\n  setup() {\n    const appName = this.element.attr('data-appname');\n\n    this.isBody = $(this.element).is('body');\n    this.settings.appName = appName !== undefined ? appName.toString() : this.settings.appName;\n\n    const content = this.element.attr('data-about-content');\n    this.settings.content = content !== undefined ? content.toString() : this.settings.content;\n\n    const copyrightYear = this.element.attr('data-copyright-year');\n    this.settings.copyrightYear = copyrightYear !== undefined ?\n      copyrightYear.toString() : this.settings.copyrightYear;\n\n    const deviceSpecs = this.element.attr('data-device-specs');\n    if (deviceSpecs) {\n      this.settings.deviceSpecs = deviceSpecs === 'true';\n    }\n\n    const productName = this.element.attr('data-product-name');\n    this.settings.productName = productName !== undefined ?\n      productName.toString() : this.settings.productName;\n\n    const useDefaultCopyright = this.element.attr('data-use-default');\n    if (useDefaultCopyright !== undefined) {\n      this.settings.useDefaultCopyright = useDefaultCopyright === 'true';\n    }\n\n    const version = this.element.attr('data-version');\n    this.settings.version = version !== undefined ?\n      version.toString() : this.settings.version;\n\n    // Get the default copyright text and cut in the current year\n    this.defaultCopyright = `${Locale.translate('AboutText')} <a class=\"hyperlink\" href=\"http://www.infor.com\" target=\"_blank\">www.infor.com</a>.`;\n    this.defaultCopyright = this.defaultCopyright.replace('{0}', this.settings.copyrightYear);\n\n    return this;\n  },\n\n  build() {\n    this.modal = $('<div class=\"modal about\" id=\"about-modal\"></div>');\n    $('<div class=\"modal-content\"></div>').appendTo(this.modal);\n\n    const header = $('<div class=\"modal-header\"></div>').appendTo(this.modal.find('.modal-content'));\n    $('<div class=\"close-container\"></div>')\n      .append($('<button name=\"close\" type=\"button\" class=\"btn-icon hide-focus\"></button>')\n        .append($.createIconElement({ icon: 'close', classes: 'icon-close' }))\n        .append(`<span>${Locale.translate('Close')}'</span>`))\n      .appendTo(header);\n\n    $.createIconElement({ icon: 'logo-trademark', classes: ['icon', 'about-logo'] }).attr({ viewBox: '0 0 44 44' }).appendTo(header);\n    this.title = $('<h1 class=\"title\"></h1>').text(this.settings.appName).appendTo(this.modal.find('.modal-header'));\n\n    const body = $('<div class=\"modal-body\"></div>').appendTo(this.modal.find('.modal-content'));\n\n    if (this.settings.version || this.settings.productName) {\n      const productAndVersion = this.settings.productName ? `${this.settings.productName} ${this.settings.version}`\n        : `${this.settings.version}`;\n\n      $('<p></p>').text(productAndVersion).appendTo(body);\n    }\n\n    if (this.settings.content) {\n      $('<div class=\"additional-content\"></div>').html(this.settings.content).appendTo(body);\n    }\n\n    if (this.settings.useDefaultCopyright || !this.settings.content) {\n      $('<p></p>').html(this.defaultCopyright).appendTo(body);\n    }\n\n    if (this.settings.deviceSpecs) {\n      const specs = this.getDeviceSpecs();\n      const text = `<span class=\"browser\">${Locale.translate('Browser')} : ${env.devicespecs.currentBrowser} ${env.devicespecs.browserMajorVersion} (${env.devicespecs.browserVersion})</span><br>\n        <span class=\"ds\">${Locale.translate('OperatingSystem')} : ${env.devicespecs.os} ${env.devicespecs.currentOSVersion}</span><br>\n        <span class=\"platform\">${Locale.translate('Platform')} : ${specs.os}</span><br>\n        <span class=\"ds\">${Locale.translate('Mobile')} : ${env.devicespecs.isMobile}</span><br>\n        <span class=\"locale\">${Locale.translate('Locale')} : ${specs.locale}</span><br>\n        <span class=\"cookiesEnabled\">${Locale.translate('CookiesEnabled')} : ${specs.cookiesEnabled}</span><br>\n        <span class=\"version\">${Locale.translate('Version')} : ${$('html').attr('data-sohoxi-version')}</span><br>`;\n\n      $('<p></p>').html(text).appendTo(body);\n    }\n\n    this.buttons = this.modal.find('button');\n\n    this.modal.find('.hide-focus').one('blur', function () {\n      $(this).removeClass('hide-focus');\n    });\n\n    this.element.attr('data-modal', 'about-modal');\n\n    $('.modal-body', this.modal)[0].tabIndex = 0;\n\n    this.modal.appendTo('body');\n    this.modal.modal({ trigger: this.isBody ? 'immediate' : 'click' });\n    return this;\n  },\n\n  /**\n   * Return the browser specs. Currently returns browse, os, cookiesEnabled and locale\n   * @returns {string} The specs of the browser.\n   */\n  getDeviceSpecs() {\n    const locale = navigator.appName === 'Microsoft Internet Explorer' ? navigator.userLanguage : navigator.language;\n    const browser = (function () {\n      const ua = navigator.userAgent;\n      let result = [];\n      let M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\n\n      if (/trident/i.test(M[1])) {\n        result = /\\brv[ :]+(\\d+)/g.exec(ua) || [];\n        return `IE '${result[1]}`;\n      }\n\n      if (M[1] === 'Chrome') {\n        result = ua.match(/\\b(OPR|Edge)\\/(\\d+)/);\n        if (result != null) {\n          return result.slice(1).join(' ').replace('OPR', 'Opera');\n        }\n      }\n\n      M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];\n      result = ua.match(/version\\/(\\d+)/i);\n      if (result !== null) {\n        M.splice(1, 1, result[1]);\n      }\n\n      return M.join(' ');\n    }());\n\n    return {\n      browser,\n      os: navigator.platform,\n      cookiesEnabled: navigator.cookieEnabled,\n      locale,\n    };\n  },\n\n  /**\n   * Update the component and optionally apply new settings.\n   *\n   * @param  {object} settings the settings to update to.\n   * @returns {object} The plugin api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    return this;\n  },\n\n  /**\n   * Progamatically close the About dialog.\n   * @returns {void}\n   */\n  close() {\n    const modalApi = this.modal.data('modal');\n\n    /**\n    * Fires when the dialog is closing.\n    * @event close\n    * @memberof About\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n    if (modalApi) {\n      modalApi.close();\n    }\n\n    /**\n    * Fires after the dialog is done closing and removed.\n    * @event afterclose\n    * @memberof About\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n\n    if (this.isBody) {\n      this.destroy();\n    }\n  },\n\n  /**\n   * Teardown and remove any added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    const modalApi = this.modal.data('modal');\n\n    if (modalApi) {\n      modalApi.element.off('beforeopen.about');\n      modalApi.destroy();\n    }\n\n    this.buttons.off();\n    this.element.off('open.about');\n\n    if (this.element.length > 0) {\n      $.removeData(this.element[0], COMPONENT_NAME);\n    }\n  },\n\n  /**\n   * Add component event handlers.\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    this.element.on('open.about', (e) => {\n      e.stopPropagation();\n      this.element.trigger('click');\n    });\n\n    this.buttons.filter('[name=\"done\"], [name=\"close\"]').on('click.about', () => {\n      this.close();\n    });\n\n    /**\n    * Fires when the about dialog is opening, allowing you to veto by returning false.\n    *\n    * @event beforeopen\n    * @memberof About\n    * @property {object} event The jquery event object.\n    * @property {object} ui The dialog object\n    */\n    this.modal.data('modal').element.on('beforeopen.about', () => {\n      this.modal.find('.modal-body').scrollTop(0);\n    });\n\n    $(document).on('keydown.about', (e) => {\n      // Close on Escape.\n      if (e.which === 0 || e.which === 27) {\n        this.close();\n      }\n    });\n\n    return this;\n  }\n};\n\nexport { About, COMPONENT_NAME };\n","import { About, COMPONENT_NAME } from './about';\n\n/**\n * jQuery Component Wrapper for About.\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} Elements being acted on.\n */\n$.fn.about = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new About(this, settings));\n    }\n  });\n};\n","import { utils } from './utils';\n\n// Height Animation Controls\n// Adapted from: http://n12v.com/css-transition-to-from-auto/\n// Contains a handful of animation helper methods that attempt\n// to DRY up CSS-powered sliding animations.\n\n/**\n * animateOpen default settings\n * @namespace\n * @property {string} direction horizontal or vertical\n * @property {string|number} distance in pixels that the animation covers. defaults to 'auto',\n *  or can pixel value size.\n * @property {number} timing delay in Miliseconds\n * @property {string} transition settings for the CSS Transition Timing Function\n */\nconst ANIMATE_OPEN_DEFAULTS = {\n  direction: 'vertical',\n  distance: 'auto',\n  timing: 300,\n  transition: 'cubic-bezier(.17, .04, .03, .94)'\n};\n\n// Use CSS Transitions to animate from \"0\" to \"auto\" widths\n$.fn.animateOpen = function (settings) {\n  const eventName = $.fn.transitionEndName();\n  settings = utils.mergeSettings(undefined, settings, ANIMATE_OPEN_DEFAULTS);\n\n  // Initialize the plugin (Once)\n  return this.each(function () {\n    const self = this;\n    const $self = $(this);\n    const dim = settings.direction === 'horizontal' ? 'width' : 'height';\n    const cDim = dim.charAt(0).toUpperCase() + dim.slice(1);\n    const distance = !isNaN(settings.distance) ? `${parseInt(settings.distance, 10)}px` : 'auto';\n    let timeout;\n\n    function transitionEndCallback() {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n\n      if ($self.data('ignore-animation-once')) {\n        $.removeData($self[0], 'ignore-animation-once');\n      }\n\n      if ($self.data('is-animating')) {\n        $.removeData($self[0], 'is-animating');\n      }\n\n      $self.off(`${eventName}.animateopen`);\n      self.style.transition = '';\n      self.style[dim] = distance;\n      $self.trigger('animateopencomplete');\n    }\n\n    // Clear any previous attempt at this animation when the animation starts new\n    $self.one('animateopenstart.animation', (e) => {\n      e.stopPropagation();\n      $self.off(`${eventName}.animateopen`);\n    });\n    $self.trigger('animateopenstart');\n\n    // Trigger the callback either by Timeout or by TransitionEnd\n    if (eventName) {\n      $self.one(`${eventName}.animateopen`, transitionEndCallback);\n    }\n\n    // Animate\n    $self.data('is-animating', true);\n    const prevVal = this.style[dim];\n    this.style[dim] = distance;\n    const endVal = getComputedStyle(this)[dim];\n    this.style[dim] = prevVal;\n    // next line forces a repaint\n    this[`offset${cDim}`]; // eslint-disable-line\n    this.style.transition = `${dim} ${settings.timing}ms ${settings.transition}`;\n\n    timeout = setTimeout(transitionEndCallback, settings.timing);\n    this.style[dim] = endVal;\n\n    // Trigger immediately if this element is invisible or has the 'no-transition' class\n    if ($self.is(':hidden') || $self.is('.no-transition') || $self.data('ignore-animation-once')) {\n      transitionEndCallback();\n    }\n  });\n};\n\n/**\n * Animate closed defaults\n * @namespace\n * @property {string} direction horizontal or vertical\n * @property {number} timing delay in Miliseconds\n * @property {string} transition settings for the CSS Transition Timing Function\n */\nconst ANIMATE_CLOSED_DEFAULTS = {\n  direction: 'vertical',\n  timing: 300,\n  transition: 'cubic-bezier(.17, .04, .03, .94)'\n};\n\n// Use CSS Transitions to animate from \"auto\" to \"0\" widths\n$.fn.animateClosed = function (settings) {\n  const eventName = $.fn.transitionEndName();\n  settings = utils.mergeSettings(undefined, settings, ANIMATE_CLOSED_DEFAULTS);\n\n  // Initialize the plugin (Once)\n  return this.each(function () {\n    const self = this;\n    const $self = $(this);\n    const dim = settings.direction === 'horizontal' ? 'width' : 'height';\n    const cDim = dim.charAt(0).toUpperCase() + dim.slice(1);\n    let timeout;\n\n    function transitionEndCallback() {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n\n      if ($self.data('ignore-animation-once')) {\n        $.removeData($self[0], 'ignore-animation-once');\n      }\n\n      if ($self.data('is-animating')) {\n        $.removeData($self[0], 'is-animating');\n      }\n\n      $self.off(`${eventName}.animatedclosed`);\n      self.style.transition = '';\n      self.style[dim] = '0px';\n      $self.trigger('animateclosedcomplete');\n    }\n\n    // Clear any previous attempt at this animation when the animation starts new\n    $self.one('animateclosedstart', (e) => {\n      e.stopPropagation();\n      $self.off(`${eventName}.animatedclosed`);\n    });\n    $self.trigger('animateclosedstart');\n\n    // Trigger the callback either by Timeout or by TransitionEnd\n    if (eventName) {\n      $self.one(`${eventName}.animatedclosed`, transitionEndCallback);\n    }\n\n    // Animate\n    $self.data('is-animating', true);\n    this.style[dim] = getComputedStyle(this)[dim];\n    // next line forces a repaint\n    this[`offset${cDim}`]; // eslint-disable-line\n    this.style.transition = `${dim} ${settings.timing}ms ${settings.transition}`;\n\n    timeout = setTimeout(transitionEndCallback, settings.timing);\n    this.style[dim] = '0px';\n\n    // Trigger immediately if this element is invisible or has the 'no-transition' class\n    if ($self.is(':hidden') || $self.is('.no-transition') || $self.data('ignore-animation-once')) {\n      transitionEndCallback();\n    }\n  });\n};\n\n// Chainable jQuery plugin that checks if an element is in the process of animating\n$.fn.isAnimating = function () {\n  return this.each(function () {\n    return $(this).data('is-animating') === true;\n  });\n};\n","/* eslint-disable consistent-return */\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { Locale } from '../locale/locale';\n\n// jQuery components\nimport '../icons/icons.jquery';\nimport '../../utils/animations';\nimport '../../utils/behaviors';\n\n// Component Name\nconst COMPONENT_NAME = 'accordion';\n\n/**\n * The Accordion is a grouped set of collapsible panels used to navigate sections of\n * related content. Each panel consists of two levels: the top level identifies the\n * category or section header, and the second level provides the associated options.\n *\n * @class Accordion\n * @param {object} element The component element.\n * @param {object} [settings] The component settings.\n * @param {string} [settings.allowOnePane=true] If set to true, allows only one pane of the Accordion to be open at a\n * time.  If an Accordion pane is open, and that pane contains sub-headers only one of the pane's sub-headers can be open at a time. (default true)\n * @param {string} [settings.displayChevron=true]  Displays a \"Chevron\" icon that sits off to the right-most\n * @param {boolean} [settings.enableTooltips=true] If false, does not run logic to apply tooltips to elements with truncated text.\n * side of a top-level accordion header. Used in place of an Expander (+/-) if enabled.\n * @param {string} [settings.rerouteOnLinkClick=true]  Can be set to false if routing is externally handled\n * @param {boolean} [settings.source=null]  A callback function that when implemented provided a call back for \"ajax loading\" of tab contents on open.\n */\nconst ACCORDION_DEFAULTS = {\n  allowOnePane: true,\n  displayChevron: true,\n  enableTooltips: true,\n  rerouteOnLinkClick: true,\n  source: null\n};\n\nfunction Accordion(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, ACCORDION_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nAccordion.prototype = {\n\n  /**\n  * Initialization kickoff point\n  * @private\n  * @param {jQuery[]} [headers] - if provided, only attempts to build the specified headers and\n  * their related anchors/panes\n  */\n  init(headers) {\n    this\n      .build(headers)\n      .handleEvents(headers)\n      .setupTooltips();\n  },\n\n  /**\n   * Takes a barebones Accordion markup definition and fleshes out any missing parts,\n   * as well as storing references to headers, anchors, and panes.\n   * @private\n   * @param {jQuery[]} [headers] if provided, only attempts to build the specified headers and\n   *  their related anchors/panes\n   * @param {boolean} [noFilterReset] if provided, will not reset the contents of the\n   * `currentlyFiltered` property.\n   * @returns {object} The component api for chaining.\n   */\n  build(headers, noFilterReset) {\n    let anchors;\n    let panes;\n    const self = this;\n    let isGlobalBuild = true;\n\n    if (!headers || !(headers instanceof jQuery)) {\n      this.headers = this.element.find('.accordion-header');\n      headers = this.element.find('.accordion-header');\n      this.anchors = headers.children('a');\n      anchors = headers.children('a');\n      this.panes = headers.next('.accordion-pane');\n      panes = headers.next('.accordion-pane');\n    } else {\n      anchors = headers.children('a');\n      panes = headers.next('.accordion-pane');\n      isGlobalBuild = false;\n\n      // update internal refs\n      this.headers = this.headers.add(headers);\n      this.anchors = this.anchors.add(anchors);\n      this.panes = this.panes.add(panes);\n    }\n\n    let headersHaveIcons = false;\n\n    // Accordion Headers that have an expandable pane need to have an\n    // expando-button added inside of them\n    headers.each(function addExpander() {\n      const header = $(this);\n      let hasIcons = false;\n      const containerPane = header.parent();\n      const isTopLevel = containerPane.is('.accordion');\n\n      function checkIfIcons() {\n        if (isTopLevel) {\n          return;\n        }\n\n        if (!hasIcons) {\n          header.addClass('no-icon');\n          return;\n        }\n\n        containerPane.addClass('has-icons');\n      }\n\n      header.hideFocus();\n\n      // For backwards compatibility:  If an icon is found inside an anchor, bring it up to the\n      // level of the header.\n      header.children('a').find('svg').detach().insertBefore(header.children('a'));\n\n      const outerIcon = header.children('.icon, svg');\n      outerIcon.addClass('icon').attr({ role: 'presentation', 'aria-hidden': 'true', focusable: 'false' });\n      if (isTopLevel && outerIcon.length) {\n        headersHaveIcons = true;\n      }\n\n      if (header.is('.list-item') || (!isTopLevel && header.find('button').length) || (!isTopLevel && header.find('svg').length)) {\n        hasIcons = true;\n      }\n\n      // Enable/Disable\n      if (header.hasClass('is-disabled')) {\n        header.children('a, button').attr('tabindex', '-1');\n      }\n\n      // Don't continue if there's no pane\n      if (!header.next('.accordion-pane').length) {\n        checkIfIcons();\n        return;\n      }\n\n      hasIcons = true;\n\n      let expander = header.children('.btn');\n      if (!expander.length) {\n        expander = $('<button class=\"btn\" type=\"button\"></button>');\n\n        let method = 'insertBefore';\n        if (self.settings.displayChevron && isTopLevel) {\n          header.addClass('has-chevron');\n          method = 'insertAfter';\n        }\n        expander[method](header.children('a'));\n        header.data('addedExpander', expander);\n      }\n\n      // Hide Focus functionality\n      expander.hideFocus();\n\n      // If Chevrons are turned off and an icon is present, it becomes the expander\n      if (outerIcon.length && !self.settings.displayChevron) {\n        outerIcon.appendTo(expander);\n      }\n\n      let expanderIcon = expander.children('.icon, .svg, .plus-minus');\n      if (!expanderIcon.length) {\n        if (self.settings.displayChevron && isTopLevel) {\n          expanderIcon = $.createIconElement({ icon: 'caret-down', classes: ['chevron'] });\n        } else {\n          const isActive = self.isExpanded(header) ? ' active' : '';\n          expanderIcon = $(`<span class=\"icon plus-minus${isActive}\" aria-hidden=\"true\" role=\"presentation\"></span>`);\n        }\n        expanderIcon.appendTo(expander);\n      }\n      const expanderIconOpts = {\n        role: 'presentation',\n        'aria-hidden': 'true'\n      };\n      if (!expanderIcon.is('span')) {\n        expanderIconOpts.focusable = 'false';\n      }\n      expanderIcon.attr(expanderIconOpts);\n\n      // Move around the Expander depending on whether or not it's a chevron\n      if (expanderIcon.is('.chevron')) {\n        header.addClass('has-chevron');\n        expander.insertAfter(header.children('a'));\n      } else {\n        header.removeClass('has-chevron');\n        expander.insertBefore(header.children('a'));\n      }\n\n      // Double check to see if we have left-aligned expanders or icons present,\n      // so we can add classes that do alignment\n      if (!self.settings.displayChevron && isTopLevel) {\n        headersHaveIcons = true;\n      }\n      checkIfIcons();\n\n      // Add an Audible Description to the button\n      let description = expander.children('.audible');\n      if (!description.length) {\n        description = $('<span class=\"audible\"></span>').appendTo(expander);\n      }\n      description.text(Locale.translate('Expand'));\n    });\n\n    if (headersHaveIcons) {\n      this.element.addClass('has-icons');\n    }\n\n    // Setup correct ARIA for accordion panes, and auto-collapse them\n    panes.each(function addPaneARIA() {\n      const pane = $(this);\n      const header = pane.prev('.accordion-header');\n\n      header.children('a').attr({ 'aria-haspopup': 'true', role: 'button' });\n\n      if (!self.isExpanded(header)) {\n        pane.data('ignore-animation-once', true);\n        self.collapse(header);\n      }\n    });\n\n    // Expand to the current accordion header if we find one that's selected\n    if (isGlobalBuild && !this.element.data('updating')) {\n      let targetsToExpand = headers.filter('.is-selected, .is-expanded');\n      targetsToExpand.next('.accordion-pane').addClass('no-transition');\n\n      if (this.settings.allowOnePane) {\n        targetsToExpand = targetsToExpand.first();\n        this.expand(targetsToExpand);\n      } else {\n        targetsToExpand.each((idx) => {\n          this.expand($(targetsToExpand[idx]));\n        });\n      }\n\n      this.select(targetsToExpand.last());\n      targetsToExpand.next('.accordion-pane').removeClass('no-transition');\n    }\n\n    // Retain an internal storage of available filtered accordion headers.\n    if (!noFilterReset) {\n      this.currentlyFiltered = $();\n    }\n\n    return this;\n  },\n\n  /**\n   * Header Click Handler\n   * @private\n   * @param {jQuery.Event} e The click event object\n   * @param {jQuery[]} header The header query object\n   * @returns {boolean} Returns false is the event should be ignored.\n   */\n  handleHeaderClick(e, header) {\n    if (!header || !header.length || this.isDisabled(header) || this.isFiltered(header) || header.data('is-animating')) {\n      e.preventDefault();\n      return;\n    }\n\n    // Check that we aren't clicking the expando button.  If we click that, this listener dies\n    if ($(e.target).is('[class^=\"btn\"]')) {\n      e.preventDefault();\n      return;\n    }\n\n    const anchor = header.children('a');\n    return this.handleAnchorClick(e, anchor);\n  },\n\n  /**\n   * Anchor Click Handler\n   * @private\n   * @param {object} e The click event object.\n   * @param {object} anchor The anchor jQuery object.\n   * @returns {boolean} Returns false is the event should be ignored.\n   */\n  handleAnchorClick(e, anchor) {\n    const self = this;\n    const header = anchor.parent('.accordion-header');\n    const pane = header.next('.accordion-pane');\n    const ngLink = anchor.attr('ng-reflect-href');\n\n    if (e && !ngLink) {\n      e.preventDefault();\n    }\n\n    if (!header.length || this.isDisabled(header) || this.isFiltered(header)) {\n      return false;\n    }\n\n    const canSelect = this.element.triggerHandler('beforeselect', [anchor]);\n    if (canSelect === false) {\n      return;\n    }\n\n    // Set the original element for DOM traversal by keyboard\n    this.originalSelection = anchor;\n\n    this.select(anchor);\n\n    function followLink() {\n      const href = anchor.attr('href');\n      if (href && href !== '' && href !== '#') {\n        if (!self.settings.rerouteOnLinkClick) {\n          return true;\n        }\n\n        window.location.href = href;\n        return true;\n      }\n      return false;\n    }\n\n    // Stop propagation here because we don't want to bubble up to the Header and\n    // potentially click the it twice\n    if (e) {\n      e.stopPropagation();\n    }\n\n    this.closePopups();\n\n    /**\n     * If the anchor is a real link, follow the link and die here.\n     * This indicates the link has been followed.\n     *\n     * @event followlink\n     * @memberof Accordion\n     * @param {array} anchor - The anchor in an array\n     */\n    if (followLink()) {\n      this.element.trigger('followlink', [anchor]);\n      return true;\n    }\n\n    // If it's not a real link, try and toggle an expansion pane.\n    if (pane.length) {\n      self.toggle(header);\n      return true;\n    }\n\n    // This flag is set by the List/Detail Pattern Wrapper.\n    // If this component is controlling a detail area, the anchor shouldn't focus,\n    // and it should trigger an event that will bubble to the pattern to give\n    // context to the detail area.\n    if (this.isControllingDetails) {\n      if (!pane.length) {\n        self.element.trigger('drilldown', [header[0]]);\n      }\n    } else {\n      anchor.focus();\n    }\n\n    /**\n    * Fires when an accordion header is truly selected.\n    *\n    * @event selected\n    * @memberof Accordion\n    * @param {object} event - The jquery event object\n    * @param {object} header - The header object\n    */\n    this.element.trigger('selected', header);\n\n    return true;\n  },\n\n  /**\n  * Close any open popup menus.\n  * @private\n  * @param {object} e The click event object.\n  */\n  closePopups(e) {\n    const openPopup = $('.popupmenu.is-open');\n    if (openPopup.length) {\n      const headers = this.element.find('.accordion-header[aria-haspopup=\"true\"]');\n      headers.each(function () {\n        const api = $(this).data('popupmenu');\n        api.close();\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n        return false;\n      });\n    }\n  },\n\n  /**\n  * Expander-Button Click Handler\n  * @private\n  * @param {object} e The click event object.\n  * @param {object} expander The jquery expander DOM element.\n  * @returns {boolean} Returns false in some cases if the event should stop propagating.\n  */\n  handleExpanderClick(e, expander) {\n    const header = expander.parent('.accordion-header');\n    if (!header.length || this.isDisabled(header) || this.isFiltered(header) || header.data('is-animating')) {\n      return;\n    }\n\n    // Set the original element for DOM traversal by keyboard\n    this.originalSelection = expander;\n\n    // Don't propagate when clicking the expander.  Propagating can cause the link to be clicked in\n    // cases where it shouldn't be clicked.\n    if (e) {\n      e.stopPropagation();\n    }\n\n    this.closePopups(e);\n\n    const pane = header.next('.accordion-pane');\n    if (pane.length) {\n      this.toggle(header);\n      this.select(header);\n      expander.focus();\n      return;\n    }\n\n    // If there's no accordion pane, attempt to simply follow the link.\n    return this.handleAnchorClick(e, header.children('a'));\n  },\n\n  /**\n  * Keypress Event Handler for expanders and anchors\n  * @private\n  * @param {jQuery.Event} e The click event object.\n  * @returns {boolean} Returns false in some cases if the event should stop propagating.\n  */\n  handleKeys(e) {\n    const self = this;\n    const key = e.which;\n    // will be either an anchor or expando button.  Should NEVER be the header itself.\n    const target = $(e.target);\n    const header = target.parent();\n    const expander = header.children('[class^=\"btn\"]').first();\n    const anchor = header.children('a');\n\n    function setInitialOriginalSelection(selection) {\n      if (!selection) {\n        selection = target;\n      }\n\n      if (!self.originalSelection) {\n        self.originalSelection = selection;\n      }\n    }\n\n    if (key === 9) { // Tab (also triggered by Shift + Tab)\n      this.headers.removeClass('is-selected');\n\n      if (target.is('a') && expander.length) {\n        setInitialOriginalSelection(expander);\n      } else {\n        setInitialOriginalSelection(anchor);\n      }\n    }\n\n    if (key === 32) { // Spacebar\n      e.preventDefault();\n\n      // Don't let this propagate and run against the header element, if it's a button\n      if (target.is('[class^=\"btn\"]')) {\n        e.stopPropagation();\n        e.stopImmediatePropagation();\n\n        // Firefox will attempt to run this twice, despite the fact that we're stopping propagation.\n        // Just cancel the whole thing if Firefox is running this method.\n        if ($('html').hasClass('is-firefox')) {\n          return;\n        }\n      }\n\n      if (expander.length) {\n        setInitialOriginalSelection(expander);\n        return this.handleExpanderClick(null, target);\n      }\n      setInitialOriginalSelection(anchor);\n      return this.handleAnchorClick(null, target);\n    }\n\n    if (key === 37 || key === 38) { // Left Arrow/Up Arrow\n      e.preventDefault();\n      setInitialOriginalSelection();\n      if (e.shiftKey) {\n        return this.ascend(header);\n      }\n      return this.prevHeader(header);\n    }\n\n    if (key === 39 || key === 40) { // Right Arrow/Down Arrow\n      e.preventDefault();\n      setInitialOriginalSelection();\n      if (e.shiftKey) {\n        return this.descend(header);\n      }\n      return this.nextHeader(header);\n    }\n  },\n\n  /**\n   * Translates all existing markup inside the accordion to a JSON-compatible object structure.\n   * @param {boolean} flatten If true, places all accordion headers in the root array.\n   * @param {boolean} addElementReference - if true, includes a reference to the original\n   * header element inside the structure (NOT valid JSON).\n   * @returns {object} The data the represents the accodion structure\n   */\n  toData(flatten, addElementReference) {\n    const data = [];\n    const topHeaders = this.element.children('.accordion-header');\n\n    function buildHeaderJSON(el, index, parentNesting, parentArr) {\n      const $el = $(el);\n      const pane = $(el).next('.accordion-pane');\n      const headerData = {\n        text: $(el).children('a, span').text().trim(),\n        index: `${parentNesting !== undefined ? `${parentNesting}.` : ''}${index}`\n      };\n\n      if (el.getAttribute('id')) {\n        headerData.id = el.getAttribute('id');\n      }\n\n      const icon = $el.children('.icon');\n      if (icon.length) {\n        headerData.icon = icon[0].tagName.toLowerCase() === 'svg' ?\n          icon[0].getElementsByTagName('use')[0].getAttribute('xlink:href') :\n          '';\n      }\n\n      if (addElementReference) {\n        headerData.element = el;\n      }\n\n      if ($el.hasClass('is-disabled')) {\n        headerData.disabled = true;\n      }\n\n      if (pane.length) {\n        const content = pane.children('.accordion-content');\n        const subheaders = pane.children('.accordion-header');\n        const subheaderData = [];\n\n        if (content.length) {\n          headerData.content = `${content.html()}`;\n        }\n\n        if (subheaders.length) {\n          // Normally this will nest.\n          // If \"flatten\" is true, don't nest and add straight to the parent array.\n          let targetArray = subheaderData;\n          if (flatten) {\n            targetArray = parentArr;\n          }\n\n          subheaders.each((j, subitem) => {\n            buildHeaderJSON(subitem, j, headerData.index, targetArray);\n          });\n\n          headerData.children = subheaderData;\n        }\n      }\n\n      parentArr.push(headerData);\n    }\n\n    // Start traversing the accordion\n    topHeaders.each((i, item) => {\n      buildHeaderJSON(item, i, undefined, data);\n    });\n\n    return data;\n  },\n\n  /**\n  * Makes a header \"selected\" if its expander button or anchor tag is focused.\n  * @param {object} element - a jQuery object containing either an expander button or an anchor tag.\n  * @returns {void}\n  */\n  select(element) {\n    if (!element || !element.length) {\n      return;\n    }\n\n    // Make sure we select the anchor\n    let anchor = element;\n    let header = anchor.parent();\n\n    if (element.is('.accordion-header')) {\n      header = element;\n      anchor = header.children('a');\n    }\n\n    if (anchor.is('[class^=\"btn\"]')) {\n      anchor = element.next('a');\n    }\n\n    if (this.isDisabled(header) || this.isFiltered(header)) {\n      return;\n    }\n\n    this.headers.removeClass('child-selected').removeClass('is-selected');\n\n    header.addClass('is-selected');\n\n    const items = header.parentsUntil(this.element, '.accordion-pane')\n      .prev('.accordion-header');\n\n    items.addClass('child-selected');\n  },\n\n  /**\n   * Gets the currently-selected Accordion Header, if applicable.\n   * @returns {jQuery[]} the currently selected Accoridon Header, or an empty jQuery selector\n   *  if there are currently no headers selected.\n   */\n  getSelected() {\n    return this.element.find('.is-selected');\n  },\n\n  /**\n  * Checks if a particular header is disabled, or if the entire accordion is disabled..\n  * @param {object} header The jquery header element\n  * @returns {boolean} Whether or not the element is enabled.\n  */\n  isDisabled(header) {\n    if (this.element.hasClass('is-disabled')) {\n      return true;\n    }\n\n    if (!header) {\n      return false;\n    }\n\n    return header.hasClass('is-disabled');\n  },\n\n  /**\n   * Checks if the header is filtered out or not\n   * @param {object} header  The jquery header element\n   * @returns {boolean} Whether or not the element is filtered.\n   */\n  isFiltered(header) {\n    if (!header || !header.length) {\n      return false;\n    }\n\n    const cl = header[0].classList;\n    return cl.contains('filtered') && !cl.contains('has-filtered-children');\n  },\n\n  /**\n  * Checks if an Accordion Section is currently expanded.\n  * @param {object} header The jquery header element\n  * @returns {boolean} Whether or not the element is expanded.\n  */\n  isExpanded(header) {\n    if (header && header instanceof Element) {\n      header = $(header);\n    }\n\n    if (!header || !header.length) {\n      return;\n    }\n\n    return header.children('a').attr('aria-expanded') === 'true';\n  },\n\n  /**\n  * Toggle the given Panel on the Accordion between expanded and collapsed.\n  * @param {object} header The jquery header element.\n  * @returns {void}\n  */\n  toggle(header) {\n    if (!header || !header.length || this.isDisabled(header) || this.isFiltered(header)\n     || this.isAnimating) {\n      return;\n    }\n\n    this.isAnimating = true;\n\n    setTimeout(() => {\n      this.isAnimating = false;\n    }, 500);\n\n    if (this.isExpanded(header)) {\n      this.collapse(header);\n      return;\n    }\n    this.expand(header);\n  },\n\n  /**\n  * Expand the given Panel on the Accordion.\n  * @param {object} header The jquery header element.\n  * @param {boolean} dontCollapseHeaders if defined, will not collapse any open accordion headers\n  *  (generally used while filtering)\n  * @returns {$.Deferred} resolved on the completion of an accoridon pane's\n  *  collapse animation (or immediately, if animation is disabled).\n  */\n  expand(header, dontCollapseHeaders) {\n    if (!header || !header.length) {\n      return;\n    }\n\n    const self = this;\n    const pane = header.next('.accordion-pane');\n    const a = header.children('a');\n    const dfd = $.Deferred();\n\n    const canExpand = this.element.triggerHandler('beforeexpand', [a]);\n    if (canExpand === false) {\n      return dfd.reject();\n    }\n\n    function continueExpand() {\n      // Change the expander button into \"collapse\" mode\n      const expander = header.children('.btn');\n      if (expander.length) {\n        expander.children('.plus-minus, .chevron').addClass('active');\n        expander.children('.audible').text(Locale.translate('Collapse'));\n      }\n\n      const headerParents = header.parentsUntil(self.element).filter('.accordion-pane').prev('.accordion-header').add(header);\n\n      // If we have the correct settings defined, close other accordion\n      // headers that are not parents of this one.\n      const collapseDfds = [];\n      if (self.settings.allowOnePane && !dontCollapseHeaders) {\n        self.headers.not(headerParents).each(function () {\n          const h = $(this);\n          if (self.isExpanded(h)) {\n            collapseDfds.push(self.collapse(h));\n          }\n        });\n      }\n\n      // Expand all headers that are parents of this one, if applicable\n      const expandDfds = [];\n      headerParents.not(header).each(function () {\n        const h = $(this);\n        if (!self.isExpanded(h)) {\n          expandDfds.push(self.expand(h));\n        }\n      });\n\n      pane.addClass('is-expanded');\n\n      /**\n      * Fires when expanding a pane is initiated.\n      *\n      * @event expand\n      * @memberof Accordion\n      * @param {object} event - The jquery event object\n      * @param {array} anchor - The anchor tag in an array.\n      */\n      self.element.trigger('expand', [a]);\n\n      /**\n       * Fires after a pane is expanded.\n       *\n       * @event afterexpand\n       * @memberof Accordion\n       * @param {jQuery.Event} [e] - The jquery event object\n       * @param {array} anchor - The anchor tag in an array.\n       */\n      function handleAfterExpand(e) {\n        if (e) {\n          e.stopPropagation();\n        }\n        header.children('a').attr('aria-expanded', 'true');\n        pane.triggerHandler('afterexpand', [a]);\n        self.element.trigger('afterexpand', [a]);\n        $.when(...expandDfds, ...collapseDfds).done(() => {\n          dfd.resolve();\n        });\n      }\n\n      if (pane.hasClass('no-transition')) {\n        for (let i = 0; i < pane.length; i++) {\n          pane[i].style.display = 'block';\n          pane[i].style.height = 'auto';\n        }\n        handleAfterExpand();\n      } else {\n        pane.one('animateopencomplete', handleAfterExpand).css('display', 'block').animateOpen();\n      }\n    }\n\n    // Load from an external source, if applicable\n    if (!this.callSource(a, continueExpand)) {\n      continueExpand.apply(this);\n    }\n\n    return dfd;\n  },\n\n  /**\n   * Expands all accordion headers, if possible.\n   * @returns {$.Deferred} resolved when all the accordion panes being expanded\n   *  complete their animations.\n   */\n  expandAll() {\n    if (this.settings.allowOnePane === true) {\n      return;\n    }\n\n    const self = this;\n    const dfd = $.Deferred();\n    const dfds = [];\n\n    this.headers.each(function () {\n      const h = $(this);\n      if (!self.isExpanded(h)) {\n        dfds.push(self.expand(h));\n      }\n    });\n\n    $.when(...dfds).always(() => {\n      dfd.resolve();\n    });\n\n    return dfd;\n  },\n\n  /**\n  * Collapse the given Panel on the Accordion.\n  * @param {object} header The jquery header element.\n  * @returns {$.Deferred} resolved on the completion of an accoridon pane's\n  *  collapse animation (or immediately, if animation is disabled).\n  */\n  collapse(header) {\n    if (!header || !header.length) {\n      return;\n    }\n\n    const self = this;\n    const pane = header.next('.accordion-pane');\n    const a = header.children('a');\n    const dfd = $.Deferred();\n\n    const canExpand = this.element.triggerHandler('beforecollapse', [a]);\n    if (canExpand === false) {\n      return dfd.reject();\n    }\n\n    // Change the expander button into \"expand\" mode\n    const expander = header.children('.btn');\n    if (expander.length) {\n      expander.children('.plus-minus, .chevron').removeClass('active');\n      expander.children('.audible').text(Locale.translate('Expand'));\n    }\n\n    pane.removeClass('is-expanded').closeChildren();\n    a.attr('aria-expanded', 'false');\n\n    /**\n    *  Fires when collapsed a pane is initiated.\n    *\n    * @event collapse\n    * @memberof Accordion\n    * @param {jQuery.Event} event - The jquery event object\n    * @param {array} anchor - The anchor tag in an array.\n    */\n    self.element.trigger('collapse', [a]);\n\n    /**\n     * Fires after a pane is collapsed.\n     *\n     * @event aftercollapse\n     * @memberof Accordion\n     * @param {jQuery.Event} [e] - The jquery event object\n     */\n    function handleAfterCollapse(e) {\n      if (e) {\n        e.stopPropagation();\n      }\n      pane[0].style.display = 'none';\n      pane[0].style.height = '0px';\n      pane.triggerHandler('aftercollapse', [a]);\n      self.element.trigger('aftercollapse', [a]);\n      dfd.resolve();\n    }\n\n    if (pane.hasClass('no-transition')) {\n      handleAfterCollapse();\n    } else {\n      pane.one('animateclosedcomplete', handleAfterCollapse).animateClosed();\n    }\n\n    return dfd;\n  },\n\n  /**\n  * Collapses all accordion headers.\n  * @returns {void}\n  * @returns {$.Deferred} resolved when all the accordion panes being collapsed\n  *  complete their animations.\n  */\n  collapseAll() {\n    const self = this;\n    const dfd = $.Deferred();\n    const dfds = [];\n\n    this.headers.each(function () {\n      const h = $(this);\n      if (self.isExpanded(h)) {\n        dfds.push(self.collapse(h));\n      }\n    });\n\n    $.when(...dfds).always(() => {\n      dfd.resolve();\n    });\n\n    return dfd;\n  },\n\n  /**\n   * Uses a function (this.settings.source()) to call out to an external API to fill the\n   * inside of an accordion pane.\n   * @param {jQuery[]} anchor The anchor element\n   * @param {Function} animationCallback The call back function\n   * @returns {Function} The call back function\n   */\n  callSource(anchor, animationCallback) {\n    if (!this.settings.source || typeof this.settings.source !== 'function') {\n      return false;\n    }\n\n    const self = this;\n    const header = anchor.parent();\n    const pane = header.next('.accordion-pane');\n    const ui = {\n      anchor,\n      header,\n      pane\n    };\n\n    function response() {\n      self.updated();\n      setTimeout(() => {\n        animationCallback.apply(self);\n      }, 1);\n    }\n\n    // Trigger the external method and wait for a response.\n    return this.settings.source(ui, response);\n  },\n\n  /**\n  * Prepares a handful of references for dealing with a specific accordion header\n  * @param {object} eventTarget The event we are working with.\n  * @returns {object} An object with the accordion dom elements in it.\n  */\n  getElements(eventTarget) {\n    const target = $(eventTarget);\n    let header;\n    let anchor;\n    let expander;\n    let pane = null;\n\n    if (target.is('.accordion-header')) {\n      header = target;\n      expander = target.children('[class^=\"btn\"]');\n      anchor = target.children('a');\n    }\n\n    if (target.is('.btn')) {\n      expander = target;\n      header = expander.parent();\n      anchor = header.children('a');\n    }\n\n    if (target.is('a')) {\n      anchor = target;\n      header = anchor.parent();\n      expander = header.children('.btn');\n    }\n\n    pane = header.next('.accordion-pane');\n\n    return {\n      header,\n      expander,\n      anchor,\n      pane\n    };\n  },\n\n  /**\n  * Selects an adjacent Accordion Header that sits directly before the currently selected\n  * Accordion Header.\n  * @param {object} element - a jQuery object containing either an expander button or an anchor tag.\n  * @param {boolean} noDescend - if it's normally possible to descend into a sub-accordion, prevent\n  * against descending.\n  * @returns {void}\n  */\n  prevHeader(element, noDescend) {\n    const elem = this.getElements(element);\n    const adjacentHeaders = elem.header.parent().children();\n    const currentIndex = adjacentHeaders.index(elem.header);\n    let target = $(adjacentHeaders.get(xssUtils.ensureAlphaNumeric(currentIndex) - 1));\n\n    if (!adjacentHeaders.length || currentIndex === 0) {\n      if (elem.header.parent('.accordion-pane').length) {\n        return this.ascend(elem.header);\n      }\n      target = adjacentHeaders.last();\n    }\n\n    while (target.is('.accordion-content') || this.isDisabled(target) || this.isFiltered(target)) {\n      if (target.is(':only-child') || target.is(':first-child')) {\n        return this.ascend(elem.header);\n      }\n      target = target.prev();\n    }\n\n    if (target.is('.accordion-pane')) {\n      const prevHeader = target.prev('.accordion-header');\n      if (this.isExpanded(prevHeader)) {\n        const descendantChildren = prevHeader.next('.accordion-pane').children(':not(.accordion-content)');\n        if (descendantChildren.length && !noDescend) {\n          return this.descend(prevHeader, -1);\n        }\n      }\n      target = prevHeader;\n\n      // if no target's available here, we've hit the end and need to wrap around\n      if (!target.length) {\n        if (elem.header.parent('.accordion-pane').length) {\n          return this.ascend(elem.header);\n        }\n\n        target = adjacentHeaders.last();\n        while (target.is('.accordion-content') || this.isDisabled(target) || this.isFiltered(target)) {\n          target = target.prev();\n        }\n      }\n    }\n\n    this.focusOriginalType(target);\n  },\n\n  /**\n  * Selects an adjacent Accordion Header that sits directly after the currently selected\n  * Accordion Header.\n  * @param {jQuery[]} element - a jQuery object containing either an expander button\n  * or an anchor tag.\n  * @param {boolean} noDescend - if it's normally possible to descend into a sub-accordion,\n  * prevent against descending.\n  * @returns {void}\n  */\n  nextHeader(element, noDescend) {\n    const elem = this.getElements(element);\n    const adjacentHeaders = elem.header.parent().children();\n    const currentIndex = adjacentHeaders.index(elem.header);\n    let target = $(adjacentHeaders.get(xssUtils.ensureAlphaNumeric(currentIndex) + 1));\n\n    if (!adjacentHeaders.length || currentIndex === adjacentHeaders.length - 1) {\n      if (elem.header.parent('.accordion-pane').length) {\n        return this.ascend(elem.header, -1);\n      }\n      target = adjacentHeaders.first();\n    }\n\n    while (target.is('.accordion-content') || this.isDisabled(target) || this.isFiltered(target)) {\n      if (target.is(':only-child') || target.is(':last-child')) {\n        return this.ascend(elem.header);\n      }\n      target = target.next();\n    }\n\n    if (target.is('.accordion-pane')) {\n      const prevHeader = target.prev('.accordion-header');\n      if (this.isExpanded(prevHeader)) {\n        const descendantChildren = prevHeader.next('.accordion-pane').children(':not(.accordion-content)');\n        if (descendantChildren.length && !noDescend) {\n          return this.descend(prevHeader);\n        }\n      }\n      target = $(adjacentHeaders.get(xssUtils.ensureAlphaNumeric(currentIndex) + 2));\n\n      // if no target's available here, we've hit the end and need to wrap around\n      if (!target.length) {\n        if (elem.header.parent('.accordion-pane').length) {\n          return this.ascend(elem.header, -1);\n        }\n\n        target = adjacentHeaders.first();\n        while (target.is('.accordion-content') || this.isDisabled(target) || this.isFiltered(target)) {\n          target = target.next();\n        }\n      }\n    }\n\n    this.focusOriginalType(target);\n  },\n\n  /**\n  * Selects the first Accordion Header in the parent container of the current Accordion Pane.\n  * If we're at the top level, jump out of the accordion to the last focusable element.\n  * @param {object} header A jQuery object containing an Accordion header.\n  * @param {number} direction If -1, sets the position to be at the end of this set of\n  * headers instead of at the beginning.\n  * @returns {void}\n  */\n  ascend(header, direction) {\n    if (!direction) {\n      direction = 0;\n    }\n\n    const pane = header.parent('.accordion-pane');\n    let target = pane.prev();\n\n    if (direction === -1) {\n      target = pane.next('.accordion-header');\n      if (!target.length) {\n        if (pane.parent('.accordion').length) {\n          return this.nextHeader(pane.prev().children('a'), true);\n        }\n\n        return this.ascend(pane.prev(), -1);\n      }\n    }\n\n    this.focusOriginalType(target);\n  },\n\n  /**\n  * Selects the first Accordion Header in the child container of the current Accordion Header.\n  * @param {jQuery[]} header - a jQuery object containing an Accordion header.\n  * @param {integer} direction - if -1, sets the position to be at the end of this set of\n  * headers instead of at the beginning.\n  * @returns {void}\n  */\n  descend(header, direction) {\n    if (!direction) {\n      direction = 0;\n    }\n\n    const pane = header.next('.accordion-pane');\n    let target = pane.children('.accordion-header').first();\n\n    if (direction === -1) {\n      target = pane.children('.accordion-header').last();\n    }\n\n    // No headers may be present.  In which case, it may be necessary to simply focus\n    // the header for the current pane.\n    if (!target.length) {\n      return this.focusOriginalType(header);\n    }\n\n    if (this.isExpanded(target)) {\n      return this.descend(target, -1);\n    }\n\n    this.focusOriginalType(target);\n  },\n\n  /**\n  * Selects an Accordion Header, then focuses either an expander button or an anchor.\n  * Governed by the property \"this.originalSelection\".\n  * @param {object} header - a jQuery object containing an Accordion header.\n  * @returns {void}\n  */\n  focusOriginalType(header) {\n    // this.select(header.children('a'));\n\n    if (this.originalSelection.is('.btn') && header.children('.btn').length) {\n      header.children('.btn').focus();\n    } else {\n      header.children('a').focus();\n    }\n  },\n\n  /**\n   * @param {jQuery[]} headers element references representing accordion headers.\n   * @param {boolean} [doReset] if defined, causes the filtering system to reset.\n   */\n  filter(headers, doReset) {\n    if (!headers || !headers.length) {\n      return;\n    }\n\n    const self = this;\n\n    if (doReset) {\n      const collapsePromise = this.collapseAll();\n      this.headers.removeClass('filtered has-filtered-children hide-focus');\n\n      $.when(collapsePromise).then(() => {\n        this.currentlyFiltered = $();\n        this.build(undefined, true);\n        this.filter(headers);\n      });\n      return;\n    }\n\n    // If headers are included in the currentlyFiltered storage, removes the ones that\n    // have previously been filtered\n    const toFilter = headers.not(this.currentlyFiltered);\n    let panes = toFilter.next('.accordion-pane');\n\n    // Store a list of all modified parent headers\n    let allParentHeaders = $();\n\n    // Perform filtering\n    this.headers.not(toFilter).addClass('filtered');\n    toFilter.each((i, header) => {\n      const parentPanes = $(header).parents('.accordion-pane');\n      if (parentPanes.length) {\n        panes = panes.add(parentPanes.filter((j, item) => panes.index(item) === -1));\n        // only add headers that weren't already in the collection\n        const parentHeaders = parentPanes.prev('.accordion-header').filter((j, item) => allParentHeaders.index(item) === -1);\n        allParentHeaders = allParentHeaders.add(parentHeaders);\n      }\n    });\n\n    allParentHeaders.addClass('has-filtered-children');\n    const expandPromise = this.expand(allParentHeaders.add(panes.prev('.accordion-header')), true);\n\n    $.when(expandPromise).done(() => {\n      this.currentlyFiltered = this.currentlyFiltered.add(toFilter);\n      self.build(undefined, true);\n    });\n  },\n\n  /**\n   * @param {jQuery[]} [headers] element references representing accordion headers.\n   *  If provided, will cause only specific items to become unfiltered.  If not\n   *  provided, removes all filtering from the accordion.\n   */\n  unfilter(headers) {\n    if (!this.currentlyFiltered.length) {\n      return;\n    }\n\n    if (!headers || !headers.length) {\n      headers = this.currentlyFiltered;\n    }\n\n    // Store a list of all modified parent headers\n    let allParentHeaders = $();\n\n    this.headers.removeClass('filtered');\n    headers.each((i, header) => {\n      const parentPanes = $(header).parents('.accordion-pane');\n      if (parentPanes.length) {\n        const parentHeaders = parentPanes.prev('.accordion-header').filter((j, item) => allParentHeaders.index(item) === -1);\n        allParentHeaders = allParentHeaders.add(parentHeaders);\n      }\n    });\n\n    allParentHeaders.removeClass('has-filtered-children');\n\n    const collapseDfds = [\n      this.collapse(headers),\n      this.collapse(allParentHeaders)\n    ];\n\n    $.when(collapseDfds).done(() => {\n      this.currentlyFiltered = this.currentlyFiltered.not(headers);\n      this.build(undefined, true);\n    });\n  },\n\n  /**\n  * Disable an accordion from events\n  * @returns {void}\n  */\n  disable() {\n    this.element\n      .addClass('is-disabled');\n\n    this.anchors.add(this.headers.children('[class^=\"btn\"]')).attr('tabindex', '-1');\n  },\n\n  /**\n  * Enable a disabled accordion.\n  * @returns {void}\n  */\n  enable() {\n    this.element\n      .removeClass('is-disabled');\n\n    this.anchors.add(this.headers.children('[class^=\"btn\"]')).removeAttr('tabindex');\n  },\n\n  /**\n     * Updates an entire accordion, or specific portion(s).\n     * @param {jQuery[]} [headers] Optional jQuery object containing accordion headers whose\n     * contents need to be torndown/rebound\n     * @param {object} settings The current settings.\n     * @returns {this} The api object\n     */\n  updated(headers, settings) {\n    this.element.data('updating', true);\n\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    let currentFocus = $(document.activeElement);\n    if (!$.contains(this.element[0], currentFocus[0])) {\n      currentFocus = undefined;\n    }\n\n    // If accordion headers are passed in, simply teardown/rebind events only for those sections.\n    // Otherwise, re-init the entire accordion.\n    if (headers && (headers instanceof jQuery)) {\n      this\n        .teardown(headers)\n        .init(headers);\n    } else {\n      this\n        .teardown()\n        .init();\n    }\n\n    if (currentFocus && currentFocus.length) {\n      currentFocus.focus();\n    }\n\n    $.removeData(this.element[0], 'updating');\n    return this;\n  },\n\n  /**\n  * Teardown process for accordion elements\n  * @param {jQuery} [headers] The header elements to tear down (optional).\n  * @returns {void}\n  */\n  teardown(headers) {\n    let globalEventTeardown = false;\n    let headerElems = headers;\n\n    if (this.currentlyFiltered) {\n      this.unfilter(this.currentlyFiltered);\n    }\n\n    if (!headers || !(headers instanceof jQuery)) {\n      headerElems = this.headers;\n      globalEventTeardown = true;\n    }\n    const anchors = headerElems.find('a');\n\n    headerElems\n      .off('touchend.accordion click.accordion focusin.accordion focusout.accordion keydown.accordion mousedown.accordion mouseup.accordion')\n      .each(function () {\n        const header = $(this);\n        const icon = header.children('.icon');\n\n        const hideFocus = header.data('hidefocus');\n        if (hideFocus) {\n          hideFocus.destroy();\n        }\n\n        if (icon.length) {\n          const iconAPI = icon.data('icon');\n          if (iconAPI) {\n            iconAPI.destroy();\n          }\n        }\n\n        const expander = header.data('addedExpander');\n        if (expander) {\n          expander.remove();\n          $.removeData(this, 'addedExpander');\n        }\n      });\n\n    anchors.off('touchend.accordion keydown.accordion click.accordion');\n\n    headerElems.children('[class^=\"btn\"]')\n      .off('touchend.accordion click.accordion keydown.accordion');\n\n    if (globalEventTeardown) {\n      this.element.off('updated.accordion selected.accordion');\n    }\n\n    return this;\n  },\n\n  /**\n  * Teardown and remove any added markup and events.\n  * @returns {void}\n  */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], 'accordion');\n  },\n\n  /**\n   * Teardown and remove any events.\n   * @private\n   * @param  {object} headers The headers to destroy\n   * @returns {void}\n   */\n  handleEvents(headers) {\n    const self = this;\n    let headerWhereMouseDown = null;\n    let headerElems = headers;\n    let globalEventSetup = false;\n\n    // If no header elements are passed in, simply default to ALL headers.\n    if (!headers || !(headers instanceof jQuery)) {\n      headerElems = this.headers;\n      globalEventSetup = true;\n    }\n    const anchors = headerElems.find('a');\n\n    // Returns \"Header\", \"Anchor\", or \"Expander\" based on the element's tag\n    function getElementType(element) {\n      let elementType = 'Header';\n      if (element.is('a')) {\n        elementType = 'Anchor';\n      }\n      if (element.is('button')) {\n        elementType = 'Expander';\n      }\n      return elementType;\n    }\n\n    // Intercepts a 'click' event in order to either prevent a link from being followed,\n    // or allows it to continue.\n    function clickInterceptor(e, element) {\n      const type = getElementType(element);\n\n      // Trigger a document click since we stop propgation, to close any open menus/popups.\n      $('body').children().not('.application-menu, .modal-page-container, .page-container').closeChildren();\n\n      return self[`handle${type}Click`](e, element);\n    }\n\n    headerElems.on('click.accordion', function (e) {\n      return clickInterceptor(e, $(this));\n    }).on('focusin.accordion', function (e) {\n      const target = $(e.target);\n\n      if (!self.originalSelection) {\n        self.originalSelection = target;\n      }\n\n      if (target.is(':not(.btn)')) {\n        $(this).addClass('is-focused').removeClass('hide-focus');\n      }\n    }).on('focusout.accordion', function () {\n      if (!$.contains(this, headerWhereMouseDown) || $(this).is($(headerWhereMouseDown))) {\n        $(this).removeClass('is-focused');\n      }\n    }).on('keydown.accordion', (e) => {\n      self.handleKeys(e);\n    })\n      .on('mousedown.accordion', function (e) {\n        $(this).addClass('is-focused').removeClass('hide-focus');\n        headerWhereMouseDown = e.target;\n      })\n      .on('mouseup.accordion', () => {\n        headerWhereMouseDown = null;\n      });\n\n    anchors.on('click.accordion', function (e) {\n      return clickInterceptor(e, $(this));\n    });\n\n    headerElems.children('[class^=\"btn\"]')\n      .on('click.accordion', function (e) {\n        return clickInterceptor(e, $(this));\n      }).on('keydown.accordion', (e) => {\n        self.handleKeys(e);\n      });\n\n    if (globalEventSetup) {\n      this.element.on('selected.accordion', (e) => {\n        // Don't propagate this event above the accordion element\n        e.stopPropagation();\n      }).on('updated.accordion', (e, settings) => {\n        // Don't propagate just in case this is contained by an Application Menu\n        e.stopPropagation();\n        self.updated(settings);\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * Hide the visible tooltip.\n   * @private\n   * @returns {void}\n   */\n  hideTooltip() {\n    const self = window;\n\n    if (self.tooltip) {\n      this.removeTooltipData(self.tooltip); // Remove flag as spantooltip\n      self.tooltip.classList.add('is-hidden');\n      self.tooltip.classList.remove('content-tooltip');\n    }\n\n    // Remove scroll events\n    $('body, .scrollable').off('scroll.spantooltip', () => {\n      this.hideTooltip();\n    });\n  },\n\n  /**\n   * Remove the tooltip data from given node\n   * @private\n   * @param {object} elem The DOM element to remove data\n   * @returns {void}\n   */\n  removeTooltipData(elem) {\n    elem = elem instanceof jQuery ? elem : $(elem);\n    if (elem.data('spantooltip')) {\n      $.removeData(elem[0], 'spantooltip');\n    }\n  },\n\n  /**\n   * Setup tooltips on truncated text elements.\n   * @private\n   * @returns {void}\n   */\n  setupTooltips() {\n    if (!this.settings.enableTooltips) {\n      return;\n    }\n\n    const self = this;\n    const selector = '.accordion-header a span';\n    const delay = 400;\n    let tooltipTimer;\n\n    // Handle tooltip to show\n    const handleShow = (elem) => {\n      if (elem.offsetWidth > (elem.parentElement.offsetWidth - parseInt($(elem).parent().css('padding-left'), 10))) {\n        tooltipTimer = setTimeout(() => {\n          $(elem).tooltip({\n            trigger: 'immediate',\n            content: `${elem.innerText}`,\n            extraClass: 'tooltip-accordion-style'\n          });\n        }, delay);\n      }\n    };\n\n    // Handle tooltip to hide\n    const handleHide = (elem) => {\n      if (elem.offsetWidth > (elem.parentElement.offsetWidth - parseInt($(elem).parent().css('padding-left'), 10))) {\n        self.hideTooltip();\n        clearTimeout(tooltipTimer);\n      }\n    };\n\n    // Bind events\n    this.element\n      .off('mouseenter.spantooltip', selector)\n      .on('mouseenter.spantooltip', selector, function () {\n        handleShow(this);\n      })\n      .off('mouseleave.spantooltip click.spantooltip', selector)\n      .on('mouseleave.spantooltip click.spantooltip', selector, function () {\n        handleHide(this);\n      });\n  }\n\n};\n\nexport { Accordion, COMPONENT_NAME };\n/* eslint-enable no-multi-assign */\n","import { Accordion, COMPONENT_NAME } from './accordion';\n\n/**\n * jQuery component wrapper for the Accordion\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.accordion = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Accordion(this, settings));\n    }\n  });\n};\n","// Lifecycle Methods for jQuery Controls\n// Recursive methods that \"globally\" call certain methods on large groups of controls\nconst EXCLUDED_FROM_CLOSE_CHILDREN = ['.expandable-area', '.accordion', ['soho-busyindicator'], '.busyindicator'];\nconst EXCLUDED_FROM_HANDLE_RESIZE = [];\n\n// Used by several of these plugins to detect whether or not the \"data\" property in question\n// is a valid IDS Enterprise Control.\nfunction canAccessAPI(prop) {\n  return prop && !(prop instanceof jQuery);\n}\n\n// Used by several of these plugins to detect whether or not there is a method on a \"data\" api\n// that can be called.\nfunction canCall(prop, method) {\n  const api = canAccessAPI(prop);\n  if (!api) {\n    return false;\n  }\n\n  return (prop[method] && typeof prop[method] === 'function');\n}\n\n// Actually triggers the method on the control if it's possible\nfunction triggerAPIMethod(prop, method) {\n  if (canCall(prop, method)) {\n    prop[method]();\n    return true;\n  }\n  return false;\n}\n\n// Tracks each element that attempts to trigger an API method.\n// If a trigger is successful, it stores it in an array that's used later.\nfunction findControlsOnElements(elems, method) {\n  const foundControls = [];\n\n  $.each(elems, (index, elem) => {\n    $.each($(elem).data(), (i, dataEntry) => {\n      if (triggerAPIMethod(dataEntry, method)) {\n        foundControls.push({ elem: $(elem), control: dataEntry });\n      }\n    });\n  });\n\n  return foundControls;\n}\n\n// Kicks it all off\nfunction siftFor(rootElem, method, filteredOutElements) {\n  if (!rootElem || !method) {\n    return undefined;\n  }\n\n  rootElem = $(rootElem);\n  let DOMelements = rootElem.find('*').add(rootElem);\n\n  if (filteredOutElements) {\n    DOMelements = DOMelements.not(filteredOutElements.join(', '));\n  }\n  const siftedControls = findControlsOnElements(DOMelements, method);\n\n  rootElem.trigger(`sift-${method}-complete`, [siftedControls]);\n  return rootElem;\n}\n\n// =========================================================\n// Actual Control Plugins\n// =========================================================\n\n$.fn.destroy = function () {\n  return siftFor($(this), 'destroy');\n};\n\n$.fn.closeChildren = function () {\n  return siftFor($(this), 'close', EXCLUDED_FROM_CLOSE_CHILDREN);\n};\n\n$.fn.handleResize = function () {\n  return siftFor($(this), 'handleResize', EXCLUDED_FROM_HANDLE_RESIZE);\n};\n","import promiseFinally from './finally';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\n/**\n * @constructor\n * @param {Function} fn\n */\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  /** @type {!number} */\n  this._state = 0;\n  /** @type {!boolean} */\n  this._handled = false;\n  /** @type {Promise|undefined} */\n  this._value = undefined;\n  /** @type {!Array<!Function>} */\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\n/**\n * @constructor\n */\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  // @ts-ignore\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = promiseFinally;\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nexport default Promise;\n","/**\n * @this {Promise}\n */\nfunction finallyConstructor(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n}\n\nexport default finallyConstructor;\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\n\n// The Name of this component.\nconst COMPONENT_NAME = 'ListFilter';\n\n// Possible Filter Modes\nconst filterModes = ['startsWith', 'contains'];\n\n/**\n * Abstracted search/filter for use in other controls\n * @class ListFilter\n * @constructor\n *\n * @param {object} [settings] incoming settings\n * @param {boolean} [settings.caseSensitive=false]  Set to true if searches ARE case sensitive\n * @param {string} [settings.filterMode='startsWith']  Type of search can current be either 'startsWith' or 'contains'\n * @param {function} [settings.searchableTextCallback] If defined, will take each\n  filterable item passed and return user-defined, searchable text content\n */\n\nconst LISTFILTER_DEFAULTS = {\n  caseSensitive: false,\n  filterMode: filterModes[0],\n  searchableTextCallback: undefined\n};\n\nfunction ListFilter(settings) {\n  this.settings = utils.mergeSettings(undefined, settings, LISTFILTER_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nListFilter.prototype = {\n\n  /**\n   * Sanitize Incoming Options\n   * @private\n   * @returns {this} component instance\n   */\n  init() {\n    function setReasonableDefaults(setting, limits, preset) {\n      if ($.inArray(setting, limits) === -1) {\n        setting = preset;\n      }\n    }\n\n    const checks = [\n      {\n        setting: this.settings.filterMode,\n        limits: filterModes,\n        preset: LISTFILTER_DEFAULTS.filterMode\n      }\n    ];\n\n    for (let i = 0; i < checks.length; i++) {\n      setReasonableDefaults(checks[i].setting, checks[i].limits, checks[i].preset);\n    }\n\n    return this;\n  },\n\n  /**\n   * Run the filter on the list for the given search term.\n   * @param {array} list The array to search.\n   * @param {string} term The term to look for.\n   * @returns {boolean|array|jquery[]} false if filtering failed,\n   *  or an array/jQuery of items that matched the filter.\n   */\n  filter(list, term) {\n    if (!list) {\n      return false;\n    }\n\n    // Check incoming list type\n    if (!$.isArray(list) && !(list instanceof jQuery)) {\n      return false;\n    }\n\n    // Search term must exist and must not be nothing\n    if (!term || typeof term !== 'string' || !term.length) {\n      return false;\n    }\n\n    const self = this;\n    let items = [];\n    let isJQuery = false;\n\n    // make search term lowercase if the search is not case-senstive\n    if (!this.settings.caseSensitive) {\n      term = term.toLowerCase();\n    }\n\n    // If it's not an array, build an array of the incoming object(s) for iterating through\n    if (!$.isArray(list)) {\n      if (list instanceof jQuery || typeof list === 'object') {\n        list = $.makeArray(list);\n        isJQuery = true;\n      }\n    }\n\n    // Gets the properties of an object and splices them into text\n    function getObjectPropsAsText(thisItem) {\n      let text = '';\n      const props = Object.keys(thisItem);\n      props.forEach((prop) => {\n        const pad = text.length ? ' ' : '';\n        text += `${pad}${thisItem[prop]}`;\n      });\n      return text;\n    }\n\n    // If a custom callback for getting searchable content is defined, return a\n    // string result from that callback. Otherwise, perform the standard method\n    // of grabbing text content.\n    function getSearchableContent(item) {\n      if (typeof self.settings.searchableTextCallback === 'function') {\n        return self.settings.searchableTextCallback(item);\n      }\n\n      let targetContent;\n      if (typeof item === 'string') {\n        targetContent = item;\n      } else if (item instanceof $) {\n        targetContent = $(item).text();\n      } else if (item instanceof HTMLElement) {\n        targetContent = item.innerText;\n      } else { // Object\n        targetContent = getObjectPropsAsText(item);\n      }\n\n      return xssUtils.sanitizeHTML(targetContent);\n    }\n\n    // Iterates through each list item and attempts to find the provided search term.\n    function searchItemIterator(item) {\n      let text = getSearchableContent(item);\n      if (!self.settings.caseSensitive) {\n        text = text.toLowerCase();\n      }\n\n      const parts = text.split(' ');\n      let match = false;\n\n      if (self.settings.filterMode === 'startsWith') {\n        for (let a = 0; a < parts.length; a++) {\n          if (parts[a].indexOf(term) === 0) {\n            match = true;\n            break;\n          }\n        }\n\n        // Direct Match\n        if (text.indexOf(term) === 0) {\n          match = true;\n        }\n\n        // Partial dual word match\n        if (term.indexOf(' ') > 0 && text.indexOf(term) > 0) {\n          match = true;\n        }\n      }\n\n      if (self.settings.filterMode === 'contains') {\n        if (text.indexOf(term) >= 0) {\n          match = true;\n        }\n      }\n\n      if (self.settings.filterMode === 'keyword') {\n        const keywords = term.split(' ');\n        for (let i = 0; i < keywords.length; i++) {\n          const keyword = keywords[i];\n          if (text.indexOf(keyword) >= 0) {\n            match = true;\n            break;\n          }\n        }\n      }\n\n      // assume filtered server side\n      if (self.settings.filterMode === null) {\n        match = true;\n      }\n\n      if (match) {\n        items.push(item);\n      }\n    }\n\n    // Run the iterator\n    list.forEach(searchItemIterator);\n\n    // If we originally took in a jQuery selector, rebuild that jQuery selector\n    // with the relevant results.\n    if (isJQuery) {\n      items = $(items);\n    }\n\n    // If we're not dealing with jQuery, an empty array shouldn't be returned.\n    if (!isJQuery && !items.length) {\n      return false;\n    }\n\n    return items;\n  },\n\n  /**\n   * Updates the ListFilter with new settings\n   * @param {object} [settings] incoming settings\n   * @returns {object} component instance\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(undefined, settings, this.settings);\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * @private\n   * @returns {object} component instance\n   */\n  teardown() {\n    return this;\n  },\n\n  /**\n   * @returns {object} component instance\n   */\n  destroy() {\n    return this.teardown();\n  }\n};\n\nexport { ListFilter, COMPONENT_NAME };\n","import { utils } from '../../utils/utils';\n\nconst Tmpl = {};\n\n/**\n * Recursive compile function for minimal mustache templates.\n * @param  {string} template The template string.\n * @param  {object} self The data / datacontext\n * @param  {object} parent When running recursively this is the parents data when nested.\n * @param  {boolean} invert An inverted expression.\n * @returns {string} The markup\n */\nTmpl.compile = function compile(template, self, parent, invert) {\n  const render = compile;\n  let output = '';\n  let i;\n\n  function get(ctx, path) {\n    path = path.pop ? path : path.split('.');\n    ctx = ctx[path.shift()] || '';\n    return (0 in path) ? get(ctx, path) : ctx;\n  }\n\n  self = Array.isArray(self) ? self : (self ? [self] : []); // eslint-disable-line\n  self = invert ? (0 in self) ? [] : [1] : self; // eslint-disable-line\n\n  for (i = 0; i < self.length; i++) {\n    let childCode = '';\n    let depth = 0;\n    let inverted;\n    let ctx = (typeof self[i] === 'object') ? self[i] : {};\n    ctx = utils.extend({}, parent, ctx); // Same as Object.assign({}, parent, ctx); but safe on IE\n    ctx[''] = { '': self[i] };\n\n    template.replace(\n      /([\\s\\S]*?)({{((\\/)|(\\^)|#)(.*?)}}|$)/g,\n      (match, code, y, z, close, invert, name) => { //eslint-disable-line\n        if (!depth) {\n          output += code.replace(\n            /{{{(.*?)}}}|{{(!?)(&?)(>?)(.*?)}}/g,\n            (match, raw, comment, isRaw, partial, name) => (raw ? get(ctx, raw) //eslint-disable-line\n              : isRaw ? get(ctx, name)  //eslint-disable-line\n                : partial ? render(get(ctx, name), ctx) //eslint-disable-line\n                  : !comment ? new Option(get(ctx, name)).innerHTML\n                    : '')\n          );\n          inverted = invert;\n        } else {\n          childCode += depth && !close || depth > 1 ? match : code;\n        }\n        if (close) {\n          if (!--depth) {\n            name = get(ctx, name);\n            if (/^f/.test(typeof name)) {\n              output += name.call(ctx, childCode, template => render(template, ctx)); //eslint-disable-line\n            } else {\n              output += render(childCode, name, ctx, inverted);\n            }\n            childCode = '';\n          }\n        } else {\n          ++depth;\n        }\n      }\n    );\n  }\n  return output;\n};\n\nexport { Tmpl };\n","/* eslint-disable no-nested-ternary, prefer-template */\n\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { ListFilter } from '../listfilter/listfilter';\nimport { Locale } from '../locale/locale';\nimport { Tmpl } from '../tmpl/tmpl';\nimport { xssUtils } from '../../utils/xss';\n\n// jQuery Components\nimport '../../utils/highlight';\nimport '../popupmenu/popupmenu.jquery';\n\n// The Name of this components\nconst COMPONENT_NAME = 'autocomplete';\n\n/*\n * Default Autocomplete Result Item Template.  This can be modified to add data points that\n * will be populated by adding properties to the object created\n * in `DEFAULT_AUTOCOMPLETE_RESULT_ITERATOR_CALLBACK`.\n */\nconst DEFAULT_AUTOCOMPLETE_TEMPLATE = `<li id=\"{{listItemId}}\" data-index=\"{{index}}\" {{#hasValue}}data-value=\"{{value}}\"{{/hasValue}} role=\"listitem\">\n <a href=\"#\" tabindex=\"-1\">\n   <span>{{{label}}}</span>\n </a>\n</li>`;\n\n/*\n* Autocomplete's method for obtaining the string that will be tested against a provided search\n* term for a match. This is configurable in the event that the component you attach this to\n* needs a specific part of it searched (instead of the whole thing).\n* @param {String|Object} item - text string, or an object containing a 'label'.\n* @returns {string} The item or item label.\n*/\nconst DEFAULT_AUTOCOMPLETE_SEARCHABLE_TEXT_CALLBACK = function (item) {\n  const isString = typeof item === 'string';\n  return (isString ? item : item.label);\n};\n\n/*\n* Autocomplete provides a method that will be run on every result that is passed back from the\n* filtering API. This method can be replaced, allowing developers to customize the output of the\n* returned dataset to add values that can also be displayed on each list item with a modified\n* `DEFAULT_AUTOCOMPLETE_TEMPLATE`.\n*/\nconst DEFAULT_AUTOCOMPLETE_RESULT_ITERATOR_CALLBACK = function resultIterator(item, index) {\n  // For standard autocompletes with a popupmenu, build the dataset that\n  // will be submitted to the template.\n  const isString = typeof item === 'string';\n  let dataset = {\n    highlightTarget: 'label',\n    index,\n    listItemId: `ac-list-option${index}`\n  };\n\n  if (!isString) {\n    dataset = utils.extend({}, dataset, item);\n  } else {\n    dataset.label = item;\n  }\n\n  dataset.hasValue = item.value !== undefined;\n  if (dataset.hasValue) {\n    dataset.value = item.value;\n  }\n\n  return dataset;\n};\n\nconst DEFAULT_AUTOCOMPLETE_HIGHLIGHT_CALLBACK = function highlightMatch(item, options) {\n  let targetProp = item;\n  let hasAlias = false;\n\n  // If this is an object and we need to replace text within a specific property,\n  // look for an \"alias\" property to use instead of the item itself.\n  if (typeof options.alias === 'string' && item[options.alias] !== undefined) {\n    hasAlias = true;\n    targetProp = item[options.alias];\n  }\n\n  // Easy match for 'contains'-style filterMode.\n  if (options.filterMode === 'contains') {\n    targetProp = targetProp.replace(new RegExp('(' + options.term + ')', 'ig'), '<i>$1</i>');\n  } else if (options.filterMode === 'keyword') {\n    // Handle \"keyword\" filterMode\n    const keywords = options.term.split(' ');\n    for (let i = 0; i < keywords.length; i++) {\n      const keyword = keywords[i];\n\n      if (keyword) {\n        targetProp = targetProp.replace(new RegExp('(' + keyword + ')', 'ig'), '<i>$1</i>');\n      }\n    }\n  } else {\n    // Handle \"startsWith\" filterMode highlighting a bit differently.\n    const originalItem = targetProp;\n    let testContent = `${originalItem}`;\n    if (!options.caseSensitive) {\n      testContent = Locale.toLowerCase(testContent);\n    }\n    const pos = testContent.indexOf(options.term);\n\n    if (pos > 0) {\n      targetProp = originalItem.substr(0, pos) + '<i>' + originalItem.substr(pos, options.term.length) + '</i>' + originalItem.substr(options.term.length + pos);\n    } else if (pos === 0) {\n      targetProp = '<i>' + originalItem.substr(0, options.term.length) + '</i>' + originalItem.substr(options.term.length);\n    }\n  }\n\n  // place result back\n  if (hasAlias) {\n    item[options.alias] = targetProp;\n  } else {\n    item = targetProp;\n  }\n\n  return item;\n};\n\n/**\n* The Autocomplete control provides an easier means of searching through a large amount of data by filtering\n* down the results based on keyboard input from the user.\n* @class Autocomplete\n* @param {object} element The component element.\n* @param {object} [settings] The component settings.\n* @param {string} [settings.source=[]] Defines the data to use, must be specified.\n* @param {string} [settings.sourceArguments={}] If a source method is defined, this flexible object can be passed\n* into the source method, and augmented with parameters specific to the implementation.\n* @param {boolean} [settings.template If defined, use this to draw the contents of each search result instead of the default draw routine.\n* @param {boolean} [settings.caseSensitive=false] if true, causes filter results that don't match case to be thrown out\n* @param {string} [settings.filterMode='startsWith'] The matching algorithm, startsWith, keyword and contains are supported - false will not filter client side\n* @param {boolean} [settings.delay=300] The delay between key strokes on the keypad before it thinks you stopped typing\n* @param {string} [settings.width=null] Width of the open auto complete menu\n* @param {string} [settings.offset=null] For the open menu, the left or top offset\n* @param {string} [settings.autoSelectFirstItem=false] Whether or not to select he first item in the list to be selected\n* @param {boolean} [settings.highlightMatchedText=true] The highlightMatchText property.\n* @param {function} [settings.highlightCallback] The highlightCallback property.\n* @param {function} [settings.resultIteratorCallback] The resultIteratorCallback property.\n* @param {function} [settings.clearResultsCallback] the clearResultsCallback property.\n* @param {function} [settings.displayResultsCallback] The displayResultsCallback property.\n* @param {function} [settings.searchableTextCallback] The searchableTextCallback property.\n*/\nconst AUTOCOMPLETE_DEFAULTS = {\n  source: [],\n  sourceArguments: {},\n  template: undefined,\n  filterMode: 'startsWith',\n  caseSensitive: false,\n  delay: 300,\n  width: null,\n  offset: null,\n  autoSelectFirstItem: false,\n  highlightMatchedText: true,\n  highlightCallback: DEFAULT_AUTOCOMPLETE_HIGHLIGHT_CALLBACK,\n  resultIteratorCallback: DEFAULT_AUTOCOMPLETE_RESULT_ITERATOR_CALLBACK,\n  clearResultsCallback: undefined,\n  displayResultsCallback: undefined,\n  searchableTextCallback: DEFAULT_AUTOCOMPLETE_SEARCHABLE_TEXT_CALLBACK\n};\n\nfunction Autocomplete(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, AUTOCOMPLETE_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Object\nAutocomplete.prototype = {\n\n  init() {\n    // data-autocomplete can be a url, 'source' or an array\n    const data = this.element.attr('data-autocomplete');\n    if (data && data !== 'source') {\n      this.settings.source = data;\n      this.element.removeAttr('data-autocomplete');\n    }\n\n    const listFilterSettings = {\n      filterMode: this.settings.filterMode,\n      caseSensitive: this.settings.caseSensitive,\n      highlightMatchedText: this.settings.highlightMatchedText,\n      searchableTextCallback: this.settings.searchableTextCallback\n    };\n    if (!this.listFilter) {\n      this.listFilter = new ListFilter(listFilterSettings);\n    } else {\n      this.listFilter.updated(listFilterSettings);\n    }\n\n    this.addMarkup();\n    this.handleEvents();\n  },\n\n  addMarkup() {\n    this.element.addClass('autocomplete').attr({\n      role: 'combobox',\n      autocomplete: 'off'\n    });\n  },\n\n  isLoading() {\n    return this.element.hasClass('is-loading') && this.element.hasClass('is-blocked');\n  },\n\n  openList(term, items) {\n    if (this.element.is('[disabled], [readonly]') || this.isLoading()) {\n      return;\n    }\n\n    if (!this.element.hasClass('searchfield')) {\n      const canOpen = this.element.triggerHandler('beforeopen.autocomplete', { elem: this.element, value: this.element.val() });\n      if (canOpen === false) {\n        return;\n      }\n    }\n\n    const self = this;\n    if (!this.settings.caseSensitive) {\n      term = Locale.toLowerCase(term);\n    }\n\n    // append the list\n    this.list = $('#autocomplete-list');\n    if (this.list.length === 0) {\n      this.list = $('<ul id=\"autocomplete-list\" aria-expanded=\"true\"></ul>').appendTo('body');\n    }\n\n    this.list[0].style.height = 'auto';\n    this.list[0].style.width = `${this.element.outerWidth()}px`;\n    this.list.addClass('autocomplete');\n    this.list.empty();\n\n    if (this.settings.width) {\n      this.list[0].style.width = this.settings.width + (/(px|%)/i.test(`${this.settings.width}`) ? '' : 'px');\n    }\n\n    // Pre-compile template.\n    // Try to get an element first, and use its contents.\n    // If the string provided isn't a selector, attempt to use it as a string, or fall back\n    // to the default template.\n    const templateAttr = $(this.element.attr('data-tmpl'));\n    this.tmpl = $(templateAttr).length ? $(templateAttr).text() :\n      typeof templateAttr === 'string' ? templateAttr :\n        $(this.settings.template).length ? $(this.settings.template).text() :\n          typeof this.settings.template === 'string' ? this.settings.template :\n            DEFAULT_AUTOCOMPLETE_TEMPLATE;\n\n    // Send full item list to the ListFilter for filtering.\n    const filterResult = this.listFilter.filter(items, term);\n    const modifiedFilterResults = [];\n\n    // Modify filtered results for a specific template with a `resultIteratorCallback`,\n    // if applicable. Each of these results is deep-copied.\n    if (filterResult !== false) {\n      filterResult.forEach((val, index) => {\n        if (typeof val === 'string') {\n          val = { label: val, value: val };\n        }\n\n        let result = utils.extend(true, {}, val);\n        result = self.settings.resultIteratorCallback(result, index);\n\n        if (self.settings.highlightMatchedText) {\n          const filterOpts = {\n            filterMode: self.settings.filterMode,\n            caseSensitive: self.settings.caseSensitive,\n            term\n          };\n          if (result.highlightTarget) {\n            filterOpts.alias = result.highlightTarget;\n          }\n          result = self.settings.highlightCallback(result, filterOpts);\n        }\n\n        modifiedFilterResults.push(result);\n      });\n    }\n\n    this.currentDataSet = modifiedFilterResults;\n\n    // If a \"resultsCallback\" method is defined, pipe the filtered items to that method and skip\n    // building a popupmenu.\n    if (typeof this.settings.displayResultsCallback === 'function') {\n      this.settings.displayResultsCallback(modifiedFilterResults, () => {\n        self.element.trigger('listopen', [modifiedFilterResults]);\n      });\n      return;\n    }\n\n    this.handleListResults(term, items, modifiedFilterResults);\n  },\n\n  handleListResults(term, items, filterResult) {\n    const self = this;\n\n    const afterPlaceCallback = function (placementObj) {\n      if (placementObj.wasFlipped === true) {\n        self.list.add(self.element).addClass('is-ontop');\n        placementObj.y += 1;\n      }\n      return placementObj;\n    };\n\n    const popupOpts = {\n      menuId: 'autocomplete-list',\n      ariaListbox: true,\n      mouseFocus: false,\n      trigger: 'immediate',\n      attachToBody: true,\n      autoFocus: false,\n      returnFocus: false,\n      triggerSelect: false,\n      placementOpts: {\n        parent: this.element,\n        callback: afterPlaceCallback\n      }\n    };\n\n    filterResult.forEach((dataset) => {\n      if (typeof Tmpl !== 'undefined') {\n        const renderedTmpl = Tmpl.compile(self.tmpl, dataset);\n        DOM.append(self.list, renderedTmpl, '*');\n      }\n    });\n\n    this.element.addClass('is-open')\n      .popupmenu(popupOpts)\n      .one('close.autocomplete', () => {\n        self.closeList(true);\n      });\n\n    // Adjust the widths of the LIs to the longest\n    const lis = self.list.find('li');\n    const width = $(lis[0]).find('span').outerWidth() + 20;\n    if (width > parseInt(this.element.outerWidth(), 10)) {\n      for (let i = 0; i < lis.length; i++) {\n        lis.width(width + 'px');\n      }\n      this.maxWidth = width;\n    }\n\n    // Optionally select the first item in the list\n    if (self.settings.autoSelectFirstItem) {\n      self.list.children().filter(':not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)').first()\n        .addClass('is-selected');\n    }\n\n    this.noSelect = true;\n    /**\n    * Fires after the menu is populated with its contents.\n    *\n    * @event populated\n    * @memberof Autocomplete\n    * @param {object} event - The jquery event object\n    * @param {object} filterResult - The results of the filtering\n    */\n    this.element.trigger('populated', [filterResult]).focus();\n\n    // Overrides the 'click' listener attached by the Popupmenu plugin\n    self.list\n      .on(`touchend.${COMPONENT_NAME} click.${COMPONENT_NAME}`, 'a', (e) => {\n        self.select(e);\n      })\n      .on(`focusout.${COMPONENT_NAME}`, () => {\n        self.checkActiveElement();\n      });\n\n    // Highlight anchors on focus\n    const all = self.list.find('a').on(`focus.${COMPONENT_NAME} touchend.${COMPONENT_NAME}`, function () {\n      self.highlight($(this), all);\n    });\n\n    if (this.settings.offset) {\n      const domListParent = this.list.parent()[0];\n\n      if (this.settings.offset.left) {\n        domListParent.style.left = `${parseInt(domListParent.style.left, 10) + this.settings.offset.left}px`;\n      }\n      if (this.settings.offset.top) {\n        domListParent.style.top = `${parseInt(domListParent.style.top, 10) + this.settings.offset.top}px`;\n      }\n    }\n\n    // As chars are typed into the edit field, nothing was announced to indicate\n    // that a value has been suggested, for the non-sighted user an offscreen span\n    // added and will remove soon popup close that includes aria-live=\"polite\"\n    // which have the first suggested item automatically announced when it\n    // appears without moving focus.\n    self.list.parent('.popupmenu-wrapper').append(`${'' +\n      '<span id=\"ac-is-arialive\" aria-live=\"polite\" class=\"audible\">'}${\n      $.trim(this.list.find('>li:first-child').text())\n    }</span>`);\n\n    this.noSelect = true;\n    this.element.trigger('listopen', [filterResult]);\n  },\n\n  closeList(dontClosePopup) {\n    // Remove events\n    this.list.off([\n      `click.${COMPONENT_NAME}`,\n      `touchend.${COMPONENT_NAME}`,\n      `focusout.${COMPONENT_NAME}`\n    ].join(' '));\n    this.list.find('a').off(`focus.${COMPONENT_NAME} touchend.${COMPONENT_NAME}`);\n\n    this.element.trigger('listclose');\n\n    if (typeof this.settings.clearResultsCallback === 'function') {\n      this.settings.clearResultsCallback();\n      return;\n    }\n\n    const popup = this.element.data('popupmenu');\n    if (!popup) {\n      return;\n    }\n    if (!dontClosePopup) {\n      popup.close();\n    }\n\n    $('#autocomplete-list').parent('.popupmenu-wrapper').remove();\n    $('#autocomplete-list').remove();\n    this.element.add(this.list).removeClass('is-open is-ontop');\n  },\n\n  listIsOpen() {\n    return this.list instanceof $ && this.list.length && this.list.is(':visible');\n  },\n\n  // Handles the Autocomplete's \"keydown\" event\n  handleAutocompleteKeydown(e) {\n    const self = this;\n\n    if (this.isLoading()) {\n      e.preventDefault();\n      return false;\n    }\n\n    if (!this.listIsOpen()) {\n      return null;\n    }\n\n    function getHighlighted(items) {\n      return items.filter('.is-selected');\n    }\n\n    function unhighlight(item) {\n      item.removeClass('is-selected is-focused');\n    }\n\n    function highlight(item) {\n      item.addClass('is-selected').find('a').focus();\n    }\n\n    const excludes = 'li:not(.separator):not(.hidden):not(.heading):not(.group):not(.is-disabled)';\n    const items = this.list.find(excludes);\n    const highlighted = getHighlighted(items);\n\n    // Down - select next\n    if (e.keyCode === 40 && this.listIsOpen()) {\n      if (highlighted.length) {\n        self.noSelect = true;\n        unhighlight(highlighted);\n        highlight(items.eq(items.index(highlighted) + 1));\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    }\n\n    // Up select prev\n    if (e.keyCode === 38 && this.listIsOpen()) {\n      if (highlighted.length) {\n        self.noSelect = true;\n        unhighlight(highlighted);\n        highlight(items.eq(items.index(highlighted) - 1));\n        e.preventDefault();\n        e.stopPropagation();\n      }\n    }\n\n    // Enter/Tab - apply selected item\n    if ((e.keyCode === 9 || e.keyCode === 13) && this.listIsOpen()) {\n      // Apply selection if an item is selected, otherwise close list and\n      // allow default tab/enter behavior to happen\n      if (highlighted.length) {\n        e.stopPropagation();\n        e.preventDefault();\n        self.noSelect = true;\n        self.select(highlighted);\n      } else {\n        self.closeList();\n      }\n    }\n\n    return null;\n  },\n\n  // Handles the Autocomplete's \"input\" event\n  handleAutocompleteInput(e) {\n    const self = this;\n\n    if (self.isLoading()) {\n      e.preventDefault();\n      return false;\n    }\n\n    // Makes a new AJAX call every time a key is pressed.\n    const waitForSource = this.getDataFromSource();\n    waitForSource.done((term, response) => {\n      self.currentDataSet = response;\n      self.openList(term, response);\n    });\n\n    return null;\n  },\n\n  /**\n   * Check to see whether or not the currently-focused element resides within\n   * the Autocomplete's field or list, and if not, fires a \"safe-blur\" event on the element.\n   *\n   * @private\n   * @param {object} e The event object passed in from the jQuery `.on()` listener.\n   * @returns {void}\n   */\n  checkActiveElement() {\n    const self = this;\n    setTimeout(() => {\n      const activeElem = document.activeElement;\n\n      if ((self.listIsOpen() && $.contains(self.list[0], activeElem)) ||\n        self.element.is(activeElem)) {\n        return;\n      }\n\n      /**\n      *  Fires after the input (and menu) both loose focus\n      *\n      * @event safe-blur\n      * @memberof Autocomplete\n      * @param {object} event The input event object\n      */\n      self.element.trigger('safe-blur');\n    }, 0);\n  },\n\n  getDataFromSource() {\n    const self = this;\n\n    // Don't attempt to load if we're already loading.\n    if (self.isLoading()) {\n      return false;\n    }\n\n    const field = this.element;\n    const dfd = $.Deferred();\n    let buffer;\n\n    clearTimeout(this.loadingTimeout);\n\n    function done(searchTerm, response, deferredStatus) {\n      self.element.triggerHandler('complete'); // For Busy Indicator\n\n      /**\n      *  Fires when the ajax request (source option) is completed\n      *\n      * @event requestend\n      * @memberof Autocomplete\n      * @param {object} event The input event object\n      * @param {array} An array containing the searchTerm and call back function\n      */\n      self.element.trigger('requestend', [searchTerm, response]);\n\n      if (deferredStatus === false) {\n        return dfd.reject(searchTerm);\n      }\n      return dfd.resolve(xssUtils.stripTags(searchTerm), response);\n    }\n\n    this.loadingTimeout = setTimeout(() => {\n      if (self.isLoading()) {\n        return;\n      }\n\n      buffer = field.val();\n\n      if (buffer === '') {\n        if (self.element.data('popupmenu')) {\n          self.element.data('popupmenu').close();\n        }\n        return;\n      }\n\n      const sourceType = typeof self.settings.source;\n      self.element.triggerHandler('start'); // For Busy Indicator\n\n      /**\n      * Fires when the ajax request (source option) is initiated\n      *\n      * @event requeststart\n      * @memberof Autocomplete\n      * @param {object} event The input event object\n      * @param {array} event An array with the buffer in it\n      */\n      self.element.trigger('requeststart', [buffer]);\n\n      if (sourceType === 'function') {\n        // Call the 'source' setting as a function with the done callback.\n        self.settings.source(buffer, done, self.settings.sourceArguments);\n      } else if (sourceType === 'object') {\n        // Use the 'source' setting as pre-existing data.\n        // Sanitize accordingly.\n        const sourceData = $.isArray(self.settings.source) ?\n          self.settings.source : [self.settings.source];\n        done(buffer, sourceData, true);\n      } else if (!self.settings.source) {\n        dfd.reject(buffer);\n      } else if (self.settings.filterMode === 'keyword') {\n        let keywordData = [];\n        const mergeData = function (data) {\n          if (keywordData.length === 0) {\n            keywordData = data;\n          } else {\n            // Check for duplicate entries\n            for (let i = 0; i < data.length; i++) {\n              const dataItem = data[i];\n\n              let isExists = false;\n\n              for (let ii = 0; ii < keywordData.length; ii++) {\n                const keywordItem = keywordData[ii];\n\n                for (let iii = 0; iii < Object.getOwnPropertyNames(keywordItem).length; iii++) {\n                  const dataPropVal = dataItem[Object.getOwnPropertyNames(dataItem)[iii]];\n                  const keywordPropVal = keywordItem[Object.getOwnPropertyNames(keywordItem)[iii]];\n\n                  if (dataPropVal === keywordPropVal) {\n                    isExists = true;\n                    break;\n                  }\n                }\n              }\n\n              if (!isExists) {\n                keywordData.push(dataItem);\n              }\n            }\n          }\n        };\n\n        const doneData = function (data) {\n          mergeData(data);\n\n          done(buffer, keywordData, true);\n        };\n\n        const keywords = buffer.split(' ');\n        if (keywords[keywords.length - 1] === '') {\n          keywords.splice(-1, 1);\n        }\n\n        for (let i = 0; i < keywords.length; i++) {\n          const keyword = keywords[i];\n\n          if (keyword.length > 0) {\n            const sourceURL = self.settings.source.toString();\n            const request = $.getJSON(sourceURL + keyword);\n\n            if (i < keywords.length - 1) {\n              request.done(mergeData).fail(mergeData);\n            } else {\n              request.done(doneData).fail(doneData);\n            }\n          }\n        }\n      } else {\n        // Attempt to resolve source as a URL string.  Do an AJAX get with the URL\n        const sourceURL = self.settings.source.toString();\n        const request = $.getJSON(sourceURL + buffer);\n\n        request.done((data) => {\n          done(buffer, data, true);\n        }).fail(() => {\n          done(buffer, [], false);\n        });\n      }\n    }, self.settings.delay);\n\n    return dfd;\n  },\n\n  /**\n  * Resets a filtered autocomplete back to its original state.\n  * @returns {void}\n  */\n  resetFilters() {\n    this.openList('', this.currentDataSet);\n  },\n\n  // Handles the Autocomplete's \"focus\" event\n  handleAutocompleteFocus() {\n    const self = this;\n    if (this.noSelect) {\n      this.noSelect = false;\n      return;\n    }\n\n    // select all text (after a delay since works better across browsers), but only if element is\n    // still focused to avoid flashing cursor focus trap (since select causes focus event to\n    // fire if no longer focused)\n    self.element.select();\n  },\n\n  /**\n   * Highlights (and focuses) an Autocomplete list option\n   * @param {jQuery} anchor the anchor to be highlighted\n   * @param {jQuery[]} [allAnchors=null] optional list of anchors to deselect when the new one becomes selected.\n   * @returns {void}\n   */\n  highlight(anchor, allAnchors) {\n    let text = anchor.text().trim();\n\n    if (anchor.find('.display-value').length > 0) {\n      text = anchor.find('.display-value').text().trim();\n    }\n\n    if (allAnchors && allAnchors.length) {\n      allAnchors.parent('li').removeClass('is-selected');\n    }\n    anchor.parent('li').addClass('is-selected');\n\n    this.noSelect = true;\n    this.element.val(text).focus();\n  },\n\n  /**\n   * Selects an Autocomplete result.\n   * @param {jQuery|jQuery.Event} anchorOrEvent either a reference to a jQuery-wrapped HTMLElement, or a jQuery Event object with a target.\n   * @param {object[]} [items=this.currentDataSet] an array of objects representing autocomplete options.\n   * @returns {object} contains information about the selected item.\n   */\n  select(anchorOrEvent, items) {\n    let a;\n    let li;\n    let ret = {};\n    let isEvent = false;\n\n    // Initial Values\n    if (anchorOrEvent instanceof $.Event) {\n      isEvent = true;\n      a = $(anchorOrEvent.currentTarget);\n    } else {\n      a = anchorOrEvent;\n    }\n\n    if (a.is('li')) {\n      li = a;\n      a = a.children('a');\n    }\n\n    li = a.parent('li');\n    const dataIndex = li.attr('data-index');\n    const dataValue = li.attr('data-value');\n\n    this.element.attr('aria-activedescendant', li.attr('id'));\n\n    if (!items || !items.length) {\n      items = this.currentDataSet;\n    }\n\n    // If the data-index attr is supplied, use it to get the item\n    // (since two items could have same value)\n    if (dataIndex) {\n      ret = items[parseInt(dataIndex, 10)];\n    } else if (dataValue) {\n      // Otherwise use data-value to get the item (a custom template may not supply data-index)\n      for (let i = 0, value; i < items.length; i++) {\n        if (typeof items[i] === 'object' && items[i].value !== undefined) {\n          value = items[i].value.toString();\n        } else {\n          value = items[i].toString();\n        }\n\n        if (value === dataValue) {\n          if (typeof items[i] === 'object') {\n            ret = items[i];\n          }\n          ret.value = value;\n        }\n      }\n    }\n\n    // Use the label as the value, if we're not working from a true dataset\n    if (!ret.value || !ret.value.length === 0) {\n      ret.value = a.text().trim();\n    }\n\n    this.highlight(a);\n\n    this.noSelect = true;\n\n    // Update the data for the event\n    ret.label = xssUtils.stripHTML(ret.label);\n\n    // Add these elements for key down vs click consistency\n    if (!ret.highlightTarget) {\n      ret.highlightTarget = 'label';\n      ret.index = parseInt(dataIndex, 10);\n      ret.listItemId = 'ac-list-option' + ret.index;\n      ret.hasValue = true;\n    }\n\n    /**\n    *  Fires when an element is selected from the list.\n    *\n    * @event selected\n    * @memberof Autocomplete\n    * @param {array} args An array containing the link and the return object.\n    */\n    this.element.trigger('selected', [a, ret]);\n\n    if (isEvent) {\n      anchorOrEvent.preventDefault();\n    }\n\n    this.closeList();\n    this.element.focus();\n\n    return ret;\n  },\n\n  /*\n  * Handle after list open.\n  */\n  handleAfterListOpen() {\n    // Fix one pixel off list by element\n    if (this.element.offset().left > this.list.offset().left) {\n      this.list.width(this.list.width() + 1);\n    }\n\n    return this;\n  },\n\n  /**\n   * Update the component with new settings.\n   * @param {object} settings The new settings object to use.\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    if (settings && settings.source) {\n      this.settings.source = settings.source;\n    }\n\n    this.teardown().init();\n    return this;\n  },\n\n  /**\n  * Enable the input from readonly or disabled state.\n  * @returns {void}\n  */\n  enable() {\n    this.element.prop('disabled', false);\n  },\n\n  /**\n  * Disable the input from editing\n  * @returns {void}\n  */\n  disable() {\n    this.element.prop('disabled', true);\n  },\n\n  teardown() {\n    const popup = this.element.data('popupmenu');\n    if (popup) {\n      popup.destroy();\n    }\n\n    this.element.off([\n      `focus.${COMPONENT_NAME}`,\n      `focusout.${COMPONENT_NAME}`,\n      `input.${COMPONENT_NAME}`,\n      `keydown.${COMPONENT_NAME}`,\n      `listopen.${COMPONENT_NAME}`,\n      `requestend.${COMPONENT_NAME}`,\n      `resetfilter.${COMPONENT_NAME}`,\n      `updated.${COMPONENT_NAME}`\n    ].join(' '));\n    return this;\n  },\n\n  /**\n  * Teardown and remove any added markup and events.\n  * @returns {void}\n  */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n  * Setup the event handlers.\n  * @private\n  * @returns {void}\n  */\n  handleEvents() {\n    // similar code as dropdown but close enough to be dry\n    const self = this;\n\n    this.element\n      .on(`updated.${COMPONENT_NAME}`, () => {\n        self.updated();\n      })\n      .on(`keydown.${COMPONENT_NAME}`, (e) => {\n        self.handleAutocompleteKeydown(e);\n      })\n      .on(`input.${COMPONENT_NAME}`, (e) => {\n        self.handleAutocompleteInput(e);\n      })\n      .on(`focus.${COMPONENT_NAME}`, () => {\n        self.handleAutocompleteFocus();\n      })\n      .on(`focusout.${COMPONENT_NAME}`, () => {\n        self.checkActiveElement();\n      })\n      /**\n      * Fires when the menu is opened.\n      * @event listopen\n      * @memberof Autocomplete\n      * @param {object} event - The jquery event object\n      * @param {object} ui - The dialog object\n      */\n      .on(`listopen.${COMPONENT_NAME}`, () => {\n        self.handleAfterListOpen();\n      })\n      /**\n      * Comes from Searchfields wrapping an autocomplete - resets\n      * a filtered autocomplete back to normal.\n      * @event listopen\n      * @memberof Autocomplete\n      * @param {object} event - The jquery event object\n      */\n      .on(`resetfilter.${COMPONENT_NAME}`, () => {\n        self.resetFilters();\n      });\n  }\n\n};\n\nexport { Autocomplete, COMPONENT_NAME };\n/* eslint-enable no-nested-ternary */\n","import { utils } from '../../utils/utils';\nimport { Autocomplete, COMPONENT_NAME } from './autocomplete';\n\n/**\n * jQuery Component Wrapper for Autocomplete\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery-wrapped components being acted on\n */\n$.fn.autocomplete = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n\n    // NOTE: This is modified due to a conflict between a legacy Soho attribute, `data-autocomplete`,\n    // having the same value as jQuery's `$.data('autocomplete')`.\n    if (typeof instance === 'string') {\n      const stringSource = `${instance}`;\n      const modifiedSettings = utils.extend({}, settings, {\n        source: stringSource || settings.source\n      });\n      instance = $.data(this, COMPONENT_NAME, new Autocomplete(this, modifiedSettings));\n    } else if (!instance) {\n      instance = $.data(this, COMPONENT_NAME, new Autocomplete(this, settings));\n    } else {\n      instance.updated(settings);\n    }\n  });\n};\n","import Promise from 'promise-polyfill';\n\nimport { Environment as env } from '../../utils/environment';\nimport * as debug from '../../utils/debug';\nimport { warnAboutDeprecation } from '../../utils/deprecated';\nimport { breakpoints } from '../../utils/breakpoints';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\n\nimport { renderLoop, RenderLoopItem } from '../../utils/renderloop';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../autocomplete/autocomplete.jquery';\nimport '../button/button.jquery';\nimport '../popupmenu/popupmenu.jquery';\n\n// Name of this component\nconst COMPONENT_NAME = 'searchfield';\n\n// Types of collapse modes\nconst SEARCHFIELD_COLLAPSE_MODES = [false, 'mobile', true];\n\n// Search Field Defaults\nconst SEARCHFIELD_DEFAULTS = {\n  resultsCallback: undefined,\n  allResultsCallback: undefined,\n  showAllResults: true,\n  showGoButton: false,\n  goButtonCopy: undefined,\n  goButtonAction: undefined,\n  categories: undefined,\n  categoryMultiselect: false,\n  showCategoryText: false,\n  source: undefined,\n  template: undefined,\n  clearable: false,\n  collapsible: SEARCHFIELD_COLLAPSE_MODES[0]\n};\n\n// Used throughout:\nconst TOOLBARSEARCHFIELD_EXPAND_SIZE = 280;\nconst MAX_TOOLBARSEARCHFIELD_EXPAND_SIZE = 450;\n\n/**\n * The search field component.\n * @class SearchField\n * @param {jQuery[]|HTMLElement} element the base searchfield element\n * @param {object} [settings] incoming settings\n * @param {function} [settings.resultsCallback] Callback function for getting typahead results on search.\n * @param {function} [settings.allResultsCallback] Callback function for getting \"all results\".\n * @param {boolean} [settings.showAllResults = true] If true the show all results link is showin in the list.\n * @param {boolean} [settings.showGoButton = false] If true a go button is associated.\n * @param {string} [settings.goButtonCopy] The text to use on the go button.\n * @param {function} [settings.goButtonAction] If defined as a function, will fire this callback on the Go Button \"click\"\n * @param {array} [settings.categories] If defined as an array, displays a dropdown containing categories that can be used to filter results.\n * @param {boolean} [settings.categoryMultiselect = false]  If true, creates a multiselectable categories list.\n * @param {boolean} [settings.showCategoryText = false]  If true, will show any available categories that are selected\n * to the left of the Dropdown field.\n * @param {function} [settings.source] Callback function for getting type ahead results.\n * @param {string} [settings.template] The html template to use for the search list\n * @param {boolean} [settings.clearable = true] If \"true\", provides an \"x\" button on the right edge that clears the field\n * @param {boolean} [settings.collapsible = true] If \"true\", allows the field to expand/collapse on larger breakpoints when\n * focused/blurred respectively\n * @param {boolean} [settings.collapsibleOnMobile = true] If true, overrides `collapsible` only on mobile settings.\n */\nfunction SearchField(element, settings) {\n  this.element = $(element);\n\n  // Backwards compatibility for old toolbars that had `collapsible` and `clearable` as the defaults\n  if (this.toolbarParent && !this.isContainedByFlexToolbar && settings !== undefined) {\n    if (settings.clearable === undefined) {\n      settings.clearable = true;\n    }\n    if (settings.collapsible === undefined) {\n      settings.collapsible = true;\n    }\n  }\n\n  this.settings = utils.mergeSettings(element, settings, SEARCHFIELD_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nSearchField.prototype = {\n\n  /**\n   * @returns {HTMLElement} a toolbar parent element, or `undefined`\n   */\n  get toolbarParent() {\n    const toolbarParents = this.element.parents('.toolbar');\n    const toolbarFlexParents = this.element.parents('.flex-toolbar');\n\n    if (toolbarParents.add(toolbarFlexParents).length < 1) {\n      return undefined;\n    }\n\n    if (toolbarFlexParents.length > 0) {\n      return toolbarFlexParents.first()[0];\n    }\n\n    return toolbarParents.first()[0];\n  },\n\n  /**\n   * @returns {HTMLElement} a buttonset element, or `undefined`\n   */\n  get buttonsetElem() {\n    if (!this.toolbarParent) {\n      return undefined;\n    }\n    return this.toolbarParent.querySelector('.buttonset');\n  },\n\n  /**\n   * @returns {HTMLElement} a toolbar `.title` area, if one is present.\n   */\n  get titleElem() {\n    if (!this.toolbarParent) {\n      return undefined;\n    }\n    return this.toolbarParent.querySelector('.title');\n  },\n\n  /**\n   * @returns {HTMLElement} a toolbar parent element, or `undefined`\n   */\n  get containmentParent() {\n    const moduleTabs = this.element.closest('.module-tabs');\n    if (moduleTabs.length) {\n      return moduleTabs.first()[0];\n    }\n    return this.toolbarParent;\n  },\n\n  /**\n   * @returns {HTMLElement} a reference to the input field\n   */\n  get input() {\n    return this.element[0];\n  },\n\n  /**\n    @returns {HTMLElement} a reference to an optional button with an attached Category selection menu\n   */\n  get categoryButton() {\n    return this.wrapper.find('.searchfield-category-button');\n  },\n\n  /**\n   * @returns {boolean} whether or not the searchfield can ever be collapsible.\n   */\n  get isCollapsible() {\n    return this.settings.collapsible !== false;\n  },\n\n  /**\n   * @returns {boolean} whether or not the searchfield is currently able to be collapsed.\n   */\n  get isCurrentlyCollapsible() {\n    return this.settings.collapsible === true || (this.settings.collapsible === 'mobile' && this.shouldBeFullWidth());\n  },\n\n  /**\n   * @private\n   * @returns {boolean} whether or not the parent toolbar is a Flex Toolbar\n   */\n  get isContainedByFlexToolbar() {\n    if (!this.containmentParent) {\n      return false;\n    }\n\n    return this.containmentParent.className.indexOf('flex-toolbar') > -1;\n  },\n\n  /**\n   * @private\n   * @returns {ToolbarFlexItem|undefined} if inside a Flex Toolbar, returns a reference to the corresponding Toolbar Flex Item API\n   */\n  get toolbarFlexItem() {\n    let item;\n    if (this.isContainedByFlexToolbar) {\n      item = $(this.element).data('toolbarflexitem');\n    }\n\n    return item;\n  },\n\n  /**\n   * @private\n   * @returns {Autocomplete|undefined} a reference to the Searchfield's optional Autocomplete API\n   */\n  get autocompleteAPI() {\n    return $(this.element).data('autocomplete');\n  },\n\n  /**\n   * @returns {boolean} whether or not this is a context searchfield.\n   */\n  get isContextSearch() {\n    return this.wrapper[0].className.indexOf('context') > -1;\n  },\n\n  /**\n   * Initialization Kickoff\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.coerceBooleanSettings();\n    this.build();\n    this.setupEvents();\n  },\n\n  /**\n   * Builds the markup for this component.\n   * @private\n   * @returns {this} component instance\n   */\n  build() {\n    // Used for managing events that are bound to $(document)\n    if (!this.id) {\n      this.id = utils.uniqueId(this.element, COMPONENT_NAME);\n    }\n\n    this.label = this.element.prev('label, .label');\n    this.inlineLabel = this.element.closest('label');\n    this.isInlineLabel = this.element.parent().is('.inline');\n\n    // Invoke Autocomplete and store references to that and the popupmenu created by autocomplete.\n    // Autocomplete settings are fed the same settings as Searchfield\n    // NOTE: The `source` setting can be modified due to a conflict between a legacy Soho attribute,\n    // `data-autocomplete`, having the same value as jQuery's `$.data('autocomplete')`.\n    const autocompleteDataAttr = this.element.attr('data-autocomplete');\n    if (autocompleteDataAttr && autocompleteDataAttr !== 'source') {\n      this.settings.source = autocompleteDataAttr;\n      this.element.removeAttr('data-autocomplete');\n      $.removeData(this.element, 'autocomplete');\n    }\n\n    if (this.settings.source) {\n      this.autocomplete = this.element.data('autocomplete');\n      if (!this.autocomplete) {\n        this.element.autocomplete(this.settings);\n        this.autocomplete = this.element.data('autocomplete');\n      } else {\n        this.autocomplete.updated(this.settings);\n      }\n    }\n\n    // Prevent browser typahead\n    this.element.attr('autocomplete', 'off');\n\n    // Setup ARIA\n    let label = this.element.attr('placeholder') || this.element.prev('label, .label').text().trim();\n    if (!label || label === '') {\n      label = Locale.translate('Keyword');\n    }\n    this.element.attr({\n      'aria-label': label,\n    });\n\n    // Build the wrapper\n    this.wrapper = this.element.parent('.searchfield-wrapper');\n    if (!this.wrapper || !this.wrapper.length) {\n      if (this.isInlineLabel) {\n        this.wrapper = this.inlineLabel.addClass('searchfield-wrapper');\n      } else {\n        this.wrapper = this.element.wrap('<span class=\"searchfield-wrapper\"></span>').parent();\n      }\n    }\n\n    this.checkContents();\n\n    // Label for toolbar-inlined searchfields needs to be inside the\n    // wrapper to help with positioning.\n    if (this.toolbarParent) {\n      this.label.prependTo(this.wrapper);\n    }\n\n    const customClasses = ['context', 'alternate'];\n    let c;\n\n    for (let i = 0; i < customClasses.length; i++) {\n      if (this.element.hasClass(customClasses[i])) {\n        c = customClasses[i];\n        this.wrapper.addClass(c);\n        this.element.removeClass(c);\n      }\n    }\n\n    // Backwards compatibility with collapsibleOnMobile\n    // TODO: Remove in v4.9.0\n    if (this.settings.collapsibleOnMobile === true) {\n      this.settings.collapsible = SEARCHFIELD_COLLAPSE_MODES[1];\n    }\n\n    // Add/remove the collapsible functionality\n    this.wrapper[0].classList[!this.settings.collapsible === true ? 'add' : 'remove']('non-collapsible');\n\n    // Add/remove `toolbar-searchfield-wrapper` class based on existence of Toolbar Parent\n    this.wrapper[0].classList[this.toolbarParent ? 'add' : 'remove']('toolbar-searchfield-wrapper');\n\n    // Initially disable animations on toolbar searchfields\n    // An event listener on Toolbar's `rendered` event removes these at the correct time\n    if (this.toolbarParent && !this.isContainedByFlexToolbar) {\n      this.element.add(this.wrapper).addClass('no-transition no-animation');\n    }\n\n    // Add Icon\n    let icon = this.wrapper.find('.icon:not(.icon-dropdown)');\n    if (!icon || !icon.length) {\n      icon = $.createIconElement('search');\n    }\n\n    // Swap icon position to in-front if we have \"context/has-categories\" CSS class.\n    const insertIconInFront = this.wrapper.hasClass('context') || this.wrapper.hasClass('has-categories');\n    icon[insertIconInFront ? 'insertBefore' : 'insertAfter'](this.element).icon();\n\n    // Change icon to a trigger button if we're dealing with categories\n    if (this.hasCategories()) {\n      this.wrapper.addClass('has-categories');\n\n      if (!this.categoryButton.length) {\n        $('<button type=\"button\" class=\"btn searchfield-category-button\"></button>').insertBefore(this.element);\n      }\n      icon.appendTo(this.categoryButton);\n      icon = this.categoryButton;\n\n      if (this.settings.showCategoryText) {\n        this.wrapper.addClass('show-category');\n      }\n\n      let ddIcon = icon.find('.icon-dropdown');\n      if (!ddIcon.length) {\n        ddIcon = $.createIconElement({ classes: 'icon-dropdown', icon: 'dropdown' }).icon();\n      }\n      ddIcon.appendTo(icon);\n\n      const popupAPI = this.categoryButton.data('popupmenu');\n      if (!popupAPI) {\n        this.list = this.wrapper.find('ul.popupmenu');\n        if (!this.list || !this.list.length) {\n          this.list = $('<ul class=\"popupmenu\"></ul>');\n        }\n\n        // Handle Single vs Multi-Selectable Lists\n        const categoryListType = this.settings.categoryMultiselect ? 'is-multiselectable' : 'is-selectable';\n        this.list.addClass(categoryListType);\n        let removeListType = 'is-selectable';\n        if (!this.settings.categoryMultiselect) {\n          removeListType = 'is-multiselectable';\n        }\n        this.list.removeClass(removeListType);\n\n        this.setCategories(this.settings.categories);\n\n        this.list.insertAfter(this.element);\n\n        const self = this;\n        this.categoryButton.popupmenu({\n          menu: this.list,\n          offset: {\n            y: 10\n          },\n          returnFocus() {\n            if (self.isFocused) {\n              self.element.focus();\n            }\n          }\n        });\n      } else {\n        this.setCategories(this.settings.categories);\n      }\n\n      this.setCategoryButtonText();\n    }\n\n    // Flex Toolbar Searchfields contain an extra button for use as a closing trigger\n    if (this.isContainedByFlexToolbar) {\n      if (!this.collapseButton || !this.collapseButton.length) {\n        this.collapseButton = $(`\n          <button class=\"btn-secondary collapse-button\" type=\"button\">\n            <svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n              <use xlink:href=\"#icon-exit-fullview\"></use>\n            </svg>\n            <span class=\"audible\">${Locale.translate('Collapse')}</span>\n          </button>\n        `);\n      }\n      this.wrapper[0].classList.add('has-collapse-button');\n      this.element.after(this.collapseButton);\n    } else {\n      this.wrapper[0].classList.remove('has-collapse-button');\n    }\n\n    // Pull a Go Button from markup, if applicable.\n    let goButton = this.wrapper.next('.go-button');\n    if (!goButton.length) {\n      goButton = this.wrapper.find('.go-button');\n    }\n\n    if (goButton.length) {\n      this.settings.showGoButton = true;\n      this.goButton = goButton;\n      this.element.after(this.goButton);\n    }\n\n    // Add a \"Go\" Button from scratch if we enable the setting\n    if (this.settings.showGoButton) {\n      if (!this.goButton || !this.goButton.length) {\n        this.goButton = $(`\n          <button class=\"btn-secondary go-button\">\n            <span>${this.settings.goButtonCopy || Locale.translate('Go')}</span>\n          </button>\n        `);\n      }\n      this.goButton.attr('id', utils.uniqueId(this.goButton, 'searchfield-go-button-'));\n      this.wrapper.addClass('has-go-button');\n      this.element.after(this.goButton);\n    } else {\n      this.wrapper.removeClass('has-go-button');\n    }\n\n    if (this.settings.clearable) {\n      this.element.clearable();\n      this.xButton = this.wrapper.children('.icon.close');\n    }\n\n    // Stagger a calculation for setting the size of the Searchfield element, if applicable\n    const self = this;\n    const resizeTimer = new RenderLoopItem({\n      duration: 1,\n      updateCallback() {}, // TODO: make this work without an empty function\n      timeoutCallback() {\n        self.calculateSearchfieldWidth();\n      }\n    });\n    renderLoop.register(resizeTimer);\n\n    if (this.settings.collapsible === false || (this.settings.collapsible === 'mobile' && breakpoints.isAbove('phone-to-tablet'))) {\n      this.expand(true);\n    }\n\n    return this;\n  },\n\n  /**\n   * Simpler version of `adjustOnBreakpoint` for non-collapsible Toolbar Flex searchfields\n   */\n  simpleAdjustOnBreakpoint() {\n    if (this.shouldBeFullWidth()) {\n      if (!this.isFocused) {\n        this.wrapper[0].classList.remove('is-open');\n      }\n      return;\n    }\n\n    this.wrapper[0].classList.add('is-open');\n  },\n\n  /**\n   * Makes necessary adjustments to the DOM surrounding the Searchfield element to accommodate\n   * breakpoint changes.\n   * @private\n   * @returns {void}\n   */\n  adjustOnBreakpoint() {\n    // On smaller form-factor (tablet/phone)\n    if (this.shouldBeFullWidth()) {\n      this.wrapper.removeAttr('style');\n      this.input.removeAttribute('style');\n\n      if (this.isFocused) {\n        this.appendToParent();\n\n        this.calculateOpenWidth();\n        this.setOpenWidth();\n\n        if (this.isExpanded) {\n          return;\n        }\n\n        this.expand(true);\n        return;\n      }\n\n      if (this.isCurrentlyCollapsible && this.isExpanded) {\n        this.collapse();\n      }\n\n      if (this.isContainedByFlexToolbar) {\n        this.wrapper[0].classList.remove('is-open');\n      }\n\n      return;\n    }\n\n    // On larger form-factor (desktop)\n    this.appendToButtonset();\n\n    if (this.isFocused || this.settings.collapsible === 'mobile') {\n      if (!this.isExpanded) {\n        this.expand(true);\n      }\n      return;\n    }\n\n    if (this.isExpanded) {\n      this.collapse();\n    }\n  },\n\n  /**\n   * If focused, we need to store a reference to the element with focus\n   * (for example: searchfield, internal buttons, etc) because once the element\n   * becomes removed from the DOM, focus is lost.\n   * @private\n   * @returns {void}\n   */\n  saveFocus() {\n    if (!this.isFocused) {\n      return;\n    }\n    this.focusElem = document.activeElement;\n  },\n\n  /**\n   * Restores focus to an element reference that was previously focused.\n   * @private\n   * @returns {void}\n   */\n  restoreFocus() {\n    if (!this.focusElem) {\n      return;\n    }\n\n    const self = this;\n\n    const focusTimer = new RenderLoopItem({\n      duration: 1,\n      updateCallback() {}, // TODO: make this work without an empty function\n      timeoutCallback() {\n        if (!self.focusElem) {\n          return;\n        }\n        self.focusElem.focus();\n        delete self.focusElem;\n      }\n    });\n    renderLoop.register(focusTimer);\n  },\n\n  /**\n   * Appends this searchfield to the `containmentParent` element\n   * Used when the small-form-factor searchfield needs to be established.\n   * @private\n   * @returns {void}\n   */\n  appendToParent() {\n    if (!this.containmentParent || this.wrapper.parent().is($(this.containmentParent))) {\n      return;\n    }\n\n    if (this.isContainedByFlexToolbar) {\n      return;\n    }\n\n    this.saveFocus();\n\n    this.elemBeforeWrapper = this.wrapper.prev();\n    $(this.containmentParent).find('.buttonset').prepend(this.wrapper);\n\n    utils.fixSVGIcons(this.wrapper);\n\n    this.restoreFocus();\n  },\n\n  /**\n   * Removes this searchfield from the `containmentParent` element,\n   * and places it back into the buttonset. Used when the small-form-factor\n   * searchfield needs to be established.\n   * @private\n   * @returns {void}\n   */\n  appendToButtonset() {\n    if (!this.containmentParent || !this.wrapper.parent().is($(this.containmentParent))) {\n      return;\n    }\n\n    if (this.isContainedByFlexToolbar) {\n      return;\n    }\n\n    this.saveFocus();\n\n    if (!(this.elemBeforeWrapper instanceof $) || !this.elemBeforeWrapper.length) {\n      this.wrapper.prependTo($(this.buttonsetElem));\n    } else {\n      this.wrapper.insertAfter(this.elemBeforeWrapper);\n      this.elemBeforeWrapper = null;\n    }\n\n    $(this.toolbarParent).triggerHandler('scrollup');\n    utils.fixSVGIcons(this.wrapper);\n\n    this.restoreFocus();\n  },\n\n  /**\n   * Determines whether or not, when the Searchfield is expanded, the Searchfield should be placed\n   *  over top of its sibling Toolbar elements, and take up 100% of its container's space.\n   * @private\n   * @returns {boolean} whether or not the Toolbar should be full width.\n   */\n  shouldBeFullWidth() {\n    const header = this.wrapper.closest('.header');\n    let headerCondition = false;\n\n    if (header.length) {\n      headerCondition = header.width() < breakpoints.phone;\n    }\n\n    return headerCondition || breakpoints.isBelow('phone-to-tablet');\n  },\n\n  /**\n   * Determines whether or not the Searchfields should expand on the Mobile breakpoint.\n   * @private\n   * @returns {boolean} whether or not the searchfield should expand on mobile.\n   */\n  shouldExpandOnMobile() {\n    if (this.settings.collapsible === true) {\n      return false;\n    }\n    if (this.settings.collapsible === 'mobile') {\n      return true;\n    }\n    return this.shouldBeFullWidth();\n  },\n\n  /**\n   * Set boolean value if strings\n   * @private\n   * @returns {void}\n   */\n  coerceBooleanSettings() {\n    const arr = [\n      'showAllResults',\n      'categoryMultiselect',\n      'showCategoryText',\n      'clearable'\n    ];\n    this.settings = utils.coerceSettingsToBoolean(this.settings, arr);\n  },\n\n  /**\n   * Reveals whether or not categories are active on this searchfield.\n   * @returns {boolean} whether or not categories are active on this searchfield.\n   */\n  hasCategories() {\n    return this.settings.categories && $.isArray(this.settings.categories) &&\n      this.settings.categories.length > 0;\n  },\n\n  /**\n   * Detects the existence of a \"Go\" button added to the main searchfield API\n   * @returns {boolean} whether or not a \"Go\" button is present\n   */\n  hasGoButton() {\n    return this.settings.showGoButton && this.goButton && this.goButton.length;\n  },\n\n  /**\n  * Fires when the searchfield is focused.\n  * @event focusin\n  * @memberof ToolbarSearchfield\n  * @property {object} event - The jquery event object\n  * /\n  /**\n  * Fires when a key is pressed inside of the searchfield.\n  * @event keydown\n  * @memberof ToolbarSearchfield\n  * @property {object} event - The jquery event object\n  */\n  /**\n  *  Fires when a `collapse` event is triggered externally on the searchfield.\n  * @event collapse\n  * @memberof ToolbarSearchfield\n  * @property {object} event - The jquery event object\n  */\n  /**\n  *  Fires when a `beforeopen` event is triggered on the searchfield's optional categories menubutton.\n  * @event beforeopen\n  * @memberof ToolbarSearchfield\n  * @property {object} event - The jquery event object\n  */\n  /**\n  * Fires when a `navigate` event is triggered on the searchfield's parent toolbar.\n  * @event navigate\n  * @memberof ToolbarSearchfield\n  * @property {object} event - The jquery event object\n  */\n  /**\n  * Fires when a `keydown` event is triggered at the `document` level.\n  * @event keydown\n  * @memberof ToolbarSearchfield\n  * @property {object} event - The jquery event object\n  */\n  /**\n   * Fires when a `resize` event is triggered at the `body` level.\n   * @event resize\n   * @memberof ToolbarSearchfield\n   * @property {object} event - The jquery event object\n   */\n\n  /**\n   * Sets up the event-listening structure for this component instance.\n   * @private\n   * @returns {this} component instance\n   */\n  setupEvents() {\n    const self = this;\n\n    self.element\n      .on(`updated.${this.id}`, (e, settings) => {\n        self.updated(settings);\n      })\n      .on(`focus.${this.id}`, (e) => {\n        self.handleFocus(e);\n      })\n      .on(`blur.${this.id}`, (e) => {\n        if (self.isContainedByFlexToolbar) {\n          self.handleSafeBlur(e);\n        }\n      })\n      .on(`click.${this.id}`, (e) => {\n        self.handleClick(e);\n      })\n      .on(`keydown.${this.id}`, (e) => {\n        self.handleKeydown(e);\n      })\n      .on(`beforeopen.${this.id}`, (e, menu) => { // propagates from Autocomplete's Popupmenu\n        self.handlePopupBeforeOpen(e, menu);\n      })\n      .on(`safe-blur.${this.id}`, () => { // Triggered by Autocomplete\n        self.handleSafeBlur();\n      })\n      .on(`listclose.${this.id}`, () => { // Triggered by Autocomplete\n        self.handleSafeBlur();\n      })\n      .on(`input.${this.id}`, () => {\n        self.checkContents();\n      });\n\n    self.wrapper.on(`mouseenter.${this.id}`, function () {\n      $(this).addClass('is-hovered');\n    }).on(`mouseleave.${this.id}`, function () {\n      $(this).removeClass('is-hovered');\n    });\n\n    if (this.hasCategories()) {\n      this.categoryButton\n        .on(`selected.${this.id}`, (e, anchor) => {\n          self.handleCategorySelected(e, anchor);\n        })\n        .on(`focus.${this.id}`, (e) => {\n          self.handleCategoryFocus(e);\n        })\n        .on(`blur.${this.id}`, () => {\n          self.handleSafeBlur();\n        })\n        .on(`close.${this.id}`, () => { // Popupmenu Close\n          self.handleSafeBlur();\n        })\n        .on(`beforeopen.${this.id}`, (e, menu) => { // Popupmenu beforeOpen\n          self.handlePopupBeforeOpen(e, menu);\n        });\n    }\n\n    if (self.hasGoButton()) {\n      self.goButton\n        .on(`click.${this.id}`, e => self.handleGoButtonClick(e))\n        .on(`click.${this.id}`, e => self.handleGoButtonFocus(e))\n        .on(`blur.${this.id}`, () => self.handleSafeBlur());\n    }\n\n    if (this.isCollapsible) {\n      this.wrapper.on(`focusin.${this.id}`, (e) => {\n        self.handleFocus(e);\n      }).on(`focusout.${this.id}`, (e) => {\n        self.handleBlur(e);\n      }).on(`keydown.${this.id}`, (e) => {\n        self.handleKeydown(e);\n      }).on(`collapse.${this.id}`, () => {\n        self.collapse();\n      });\n\n      $('body').on(`resize.${this.id}`, () => {\n        self.adjustOnBreakpoint();\n      });\n      self.adjustOnBreakpoint();\n    } else {\n      $('body').on(`resize.${this.id}`, () => {\n        self.simpleAdjustOnBreakpoint();\n      });\n      self.simpleAdjustOnBreakpoint();\n    }\n\n    if (this.collapseButton && this.collapseButton.length) {\n      this.collapseButton\n        .on(`keydown.${this.id}`, (e) => {\n          self.collapseResponsive(e);\n        })\n        .on(`click.${this.id}`, (e) => {\n          self.collapseResponsive(e);\n        })\n        .on(`blur.${this.id}`, () => self.handleSafeBlur());\n    }\n\n    if (this.toolbarParent) {\n      $(this.toolbarParent).on(`navigate.${this.id}`, () => {\n        if (self.isFocused || !self.isCurrentlyCollapsible) {\n          return;\n        }\n        self.collapse();\n      }).on(`rendered.${this.id}`, () => {\n        self.element.removeClass('no-transition no-animation');\n        self.wrapper.removeClass('no-transition no-animation');\n      });\n    }\n\n    // Insert the \"view more results\" link on the Autocomplete control's \"populated\" event\n    self.element.on(`populated.${this.id}`, (e, items) => {\n      if (items.length > 0) {\n        if (self.settings.showAllResults) {\n          self.addMoreLink();\n        }\n      } else {\n        self.addNoneLink();\n      }\n    });\n\n    // Setup a listener for the Clearable behavior, if applicable\n    if (self.settings.clearable) {\n      self.element.on(`cleared.${this.id}`, () => {\n        if (self.autocomplete) {\n          self.autocomplete.closeList();\n        }\n      });\n\n      self.xButton.on(`blur.${this.id}`, (e) => {\n        self.handleSafeBlur(e);\n      });\n    }\n\n    // Override the 'click' listener created by Autocomplete (which overrides the\n    // default Popupmenu method) to act differntly when the More Results link is activated.\n    self.element.on(`listopen.${this.id}`, () => {\n      const list = $('#autocomplete-list');\n\n      // Visual indicator class\n      self.wrapper.addClass('popup-is-open');\n\n      // Trigger the `allResultsCallback` if one is defined\n      self.element.on(`selected.${this.id}`, (thisE, a, ret) => {\n        const isMoreLink = a.hasClass('more-results');\n        if (!isMoreLink) {\n          return;\n        }\n\n        const callback = self.settings.allResultsCallback;\n        if (callback && typeof callback === 'function') {\n          callback(ret);\n        }\n      });\n\n      // Override the focus event created by the Autocomplete control to make the more link\n      // and no-results link blank out the text inside the input.\n      list.find('.more-results, .no-results').on(`focus.${this.id}`, function () {\n        const anchor = $(this);\n        list.find('li').removeClass('is-selected');\n        anchor.parent('li').addClass('is-selected');\n        self.element.val('');\n      });\n    }).on(`listclose.${this.id}`, () => {\n      const list = $('#autocomplete-list');\n\n      self.element.off(`selected.${this.id}`);\n      list.off(`focus.${this.id}`);\n    });\n\n    return this;\n  },\n\n  /**\n   * Activates a toolbar-based searchfield and keeps it \"open\".  Instead of closing\n   * it on blur, sets up an explicit, out-of-bounds click/tap that will serve to close\n   * it when the user acts.\n   * @private\n   * @param {boolean} force ignore any attempt to return out first\n   * @param {boolean} doFocus focus the searchfield element.\n   * @returns {void}\n   */\n  setAsActive(force, doFocus) {\n    if (!force && this.wrapper.hasClass('active')) {\n      return;\n    }\n\n    this.addDocumentDeactivationEvents();\n\n    const wrapperClasses = ['has-focus', 'active'];\n\n    if (this.isCurrentlyCollapsible || this.isContainedByFlexToolbar) {\n      this.expand(true);\n\n      if (this.isContainedByFlexToolbar) {\n        wrapperClasses.push('is-open');\n      }\n    }\n\n    // Activate\n    wrapperClasses.forEach((cssClass) => {\n      // IE11 compatibility doesn't allow for multiple arguments for `classList.add()`\n      this.wrapper[0].classList.add(cssClass);\n    });\n\n    if (this.toolbarParent) {\n      this.toolbarParent.classList.add('searchfield-active');\n    }\n\n    if (this.isExpanded) {\n      return;\n    }\n\n    if (doFocus === true) {\n      this.element.focus();\n    }\n  },\n\n  /**\n   * @returns {boolean} whether or not one of elements inside the Searchfield wrapper has focus.\n   */\n  get isFocused() {\n    const active = document.activeElement;\n    const wrapperElem = this.wrapper[0];\n\n    // If another element inside the Searchfield Wrapper is focused, the entire component\n    // is considered \"focused\".\n    if (wrapperElem.contains(active)) {\n      return true;\n    }\n\n    // Retain focus if the autocomplete menu is focused\n    if (this.autocomplete) {\n      const autocompleteListElem = this.autocomplete.list;\n      if (autocompleteListElem && autocompleteListElem[0].contains(active)) {\n        return true;\n      }\n    }\n\n    // Retain focus if a category is being selected from a category menu\n    if (this.categoryButton && this.categoryButton.length) {\n      const menu = this.categoryButton.data('popupmenu').menu;\n      if (menu.has(active).length) {\n        return true;\n      }\n    }\n\n    // Clearable button\n    if (this.xButton && this.xButton.length) {\n      if (this.xButton.has(active).length) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * Detects whether or not the Searchfield has focus.\n   * @deprecated in v4.8.0.  Please use the `isFocused` property instead.\n   * @returns {boolean} whether or not the Searchfield has focus.\n   */\n  hasFocus() {\n    warnAboutDeprecation('isFocused', 'hasFocus');\n    return this.isFocused;\n  },\n\n  /**\n   * Focus event handler\n   * @private\n   * @returns {void}\n   */\n  handleFocus() {\n    this.setAsActive(true);\n  },\n\n  /**\n   * Blur event handler\n   * @private\n   * @returns {void}\n   */\n  handleBlur() {\n    const self = this;\n\n    if (env.os.name === 'ios') {\n      $('head').triggerHandler('disable-zoom');\n    }\n\n    self.handleSafeBlur();\n  },\n\n  /**\n   * Custom event handler for Autocomplete's `safe-blur` and `listclose` events.\n   * Fired on the base element when any Autocomplete-related focusable element loses focus to\n   * something outside the Autocomplete's wrapper\n   * @private\n   * @returns {void}\n   */\n  handleSafeBlur() {\n    const self = this;\n    function safeBlurHandler() {\n      // Do a check for searchfield-specific elements\n      if (self.isFocused) {\n        return;\n      }\n\n      const wrapperElem = self.wrapper[0];\n      wrapperElem.classList.remove('has-focus', 'active');\n\n      self.removeDocumentDeactivationEvents();\n      self.clearResponsiveState();\n\n      if (self.isCurrentlyCollapsible) {\n        self.collapse();\n      } else if (self.isContainedByFlexToolbar) {\n        self.wrapper[0].classList.remove('is-open');\n      }\n    }\n\n    // Stagger the check for the activeElement on a timeout in order to accurately detect focus.\n    if (this.blurTimer) {\n      this.blurTimer.destroy(true);\n    }\n    this.blurTimer = new RenderLoopItem({\n      duration: 1,\n      updateCallback() {}, // TODO: make this work without an empty function\n      timeoutCallback: safeBlurHandler\n    });\n    renderLoop.register(this.blurTimer);\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  clearResponsiveState() {\n    if (!this.toolbarParent) {\n      return;\n    }\n    this.toolbarParent.classList.remove('searchfield-active');\n  },\n\n  /**\n   * Click event handler\n   * @private\n   * @returns {void}\n   */\n  handleClick() {\n    this.setAsActive();\n  },\n\n  /**\n   * Sets up event listeners that need to be handled at the global (document) level, since they deal\n   * with general keystrokes.\n   * @private\n   * @returns {void}\n   */\n  addDocumentDeactivationEvents() {\n    if (this.hasDeactivationEvents === true) {\n      return;\n    }\n\n    const self = this;\n    $(document)\n      .on(`click.${this.id}`, (e) => {\n        self.handleOutsideClick(e);\n      })\n      .on(`keydown.${this.id}`, (e) => {\n        self.handleOutsideKeydown(e);\n      });\n\n    this.hasDeactivationEvents = true;\n  },\n\n  /**\n   * Removes global (document) level event handlers.\n   * @private\n   * @returns {void}\n   */\n  removeDocumentDeactivationEvents() {\n    $(document).off(`click.${this.id} keydown.${this.id}`);\n    this.hasDeactivationEvents = false;\n  },\n\n  /**\n   * Event Handler for dealing with global (document) level clicks.\n   * @private\n   * @param {jQuery.Event} e `click` event\n   * @returns {void}\n   */\n  handleOutsideClick(e) {\n    const target = e.target;\n    if (this.isSearchfieldElement(target)) {\n      return;\n    }\n    this.handleSafeBlur();\n  },\n\n  /**\n   * Keydown event handler\n   * @private\n   * @param {jQuery.Event} e jQuery `keydown`\n   * @returns {void}\n   */\n  handleKeydown(e) {\n    const key = e.which;\n    const keyName = e.key;\n\n    if (key === 27 && env.browser.isIE11()) {\n      e.preventDefault();\n    }\n\n    if (e.ctrlKey && key === 8) {\n      this.element.val('');\n    }\n\n    if (key === 9) { // Tab\n      this.handleSafeBlur();\n    }\n\n    if (this.isContainedByFlexToolbar) {\n      const yKeys = ['ArrowUp', 'Up', 'ArrowDown', 'Down'];\n      if (yKeys.indexOf(keyName) > -1) {\n        this.collapse();\n      }\n    }\n  },\n\n  /**\n   * Handles global (document) level keydown events that are established to help\n   * collapse/de-highlight searchfields on a timer.\n   * @private\n   * @param {jQuery.Event} e jQuery-wrapped Keydown event\n   * @returns {void}\n   */\n  handleOutsideKeydown(e) {\n    const key = e.which;\n    const target = e.target;\n\n    if (key === 9 && !this.isSearchfieldElement(target)) {\n      this.handleSafeBlur();\n    }\n  },\n\n  /**\n   * Modifies the menu at $('#autocomplete-list') to propagate/remove style\n   *  classes on the Searchfield element.\n   * @private\n   * @param {jQuery.Event} e custom jQuery `beforeopen` event from the Popupmenu Component.\n   * @param {jQuery[]} menu element that represents the popupmenu that is being opened.\n   * @returns {boolean} the ability to cancel the menu's opening.\n   */\n  handlePopupBeforeOpen(e, menu) {\n    if ((this.isCollapsible && (this.isExpanding || !this.isExpanded)) || !menu) {\n      return false;\n    }\n\n    const contextClassMethod = this.wrapper.hasClass('context') ? 'addClass' : 'removeClass';\n    const altClassMethod = this.wrapper.hasClass('alternate') ? 'addClass' : 'removeClass';\n\n    menu[contextClassMethod]('context');\n    menu[altClassMethod]('alternate');\n\n    if (!this.isExpanded) {\n      this.categoryButton.focus();\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * @private\n   * @param {jQuery.Event} e jQuery `click` event\n   * @returns {void}\n   */\n  handleGoButtonClick(e) {\n    const action = this.settings.goButtonAction;\n    if (typeof action !== 'function') {\n      return undefined;\n    }\n\n    const searchfieldValue = this.element.val();\n    let categorySelection;\n\n    if (this.hasCategories()) {\n      categorySelection = this.getCategoryData();\n    }\n\n    // gives access to the current searchfield value, and category data if applicable.\n    return action(e, searchfieldValue, categorySelection);\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  handleGoButtonFocus() {\n    this.setAsActive(true);\n  },\n\n  /**\n   * Sets the text content on the category button.  Will either display a single category\n   * name, or a translated \"[x] Selected.\" string.\n   * @param {string} [textContent] Optional incoming text that will be subtituted for the\n   * selected element count.\n   * @returns {undefined}\n   */\n  setCategoryButtonText(textContent) {\n    if (!this.settings.showCategoryText || !this.categoryButton.length) {\n      return;\n    }\n\n    let text = '';\n    const button = this.wrapper.find('.btn');\n    let span = button.find('span');\n\n    if (!span || !span.length) {\n      span = $('<span class=\"category\"></span>').insertAfter(button.find('.icon').first());\n    }\n\n    span.empty();\n\n    // incoming text takes precedent\n    if (typeof textContent === 'string' && textContent.length) {\n      span.text(textContent.trim());\n      return;\n    }\n\n    // Otherwise, grab currently selected categories and set text\n    // (or clear, if no options are selected).\n    const item = this.getSelectedCategories();\n    if (!item.length) {\n      return;\n    }\n\n    if (item.length > 1) {\n      text = `${item.length} ${Locale.translate('Selected')}`;\n    } else {\n      text = item.text().trim();\n    }\n\n    span.text(text);\n  },\n\n  /**\n   * Detects whether or not an element is part of this instance of the Searchfield component\n   * @private\n   * @param {HTMLElement} element the element being checked.\n   * @returns {boolean} whether or not the element provided is part of this Searchfield component\n   */\n  isSearchfieldElement(element) {\n    if ($.contains(this.wrapper[0], element)) {\n      return true;\n    }\n\n    // Don't close if a category is being selected from a category menu\n    if (this.categoryButton && this.categoryButton.length) {\n      const menu = this.categoryButton.data('popupmenu').menu;\n      if (menu.has(element).length) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * Retrieves the distance between a left and right boundary.\n   * Used on controls like Lookup, Contextual Panel, etc. to fill the space remaining in a toolbar.\n   * @private\n   * @param {Number|jQuery[]} leftBoundary left boundary in pixels\n   * @param {Number|jQuery[]} rightBoundary right boundary in pixels\n   * @returns {number} the fill size area\n   */\n  getFillSize(leftBoundary, rightBoundary) {\n    let leftBoundaryNum = 0;\n    let rightBoundaryNum = 0;\n\n    function sanitize(boundary) {\n      if (!boundary) {\n        return 0;\n      }\n\n      // Return out if the boundary is just a number\n      if (!isNaN(parseInt(boundary, 10))) {\n        return parseInt(boundary, 10);\n      }\n\n      if (boundary instanceof jQuery) {\n        if (!boundary.length) {\n          return 0;\n        }\n\n        if (boundary.is('.title')) {\n          boundary = boundary.next('.buttonset');\n        }\n\n        boundary = boundary[0];\n      }\n\n      return boundary;\n    }\n\n    function getEdgeFromBoundary(boundary, edge) {\n      if (!isNaN(boundary)) {\n        return (boundary === null || boundary === undefined) ? 0 : boundary;\n      }\n\n      if (!edge || typeof edge !== 'string') {\n        edge = 'left';\n      }\n\n      const edges = ['left', 'right'];\n      if ($.inArray(edge, edges) === -1) {\n        edge = edges[0];\n      }\n\n      let rect;\n\n      if (boundary instanceof HTMLElement || boundary instanceof SVGElement) {\n        rect = boundary.getBoundingClientRect();\n      }\n\n      return rect[edge];\n    }\n\n    leftBoundary = sanitize(leftBoundary);\n    rightBoundary = sanitize(rightBoundary);\n\n    function whichEdge() {\n      let e = 'left';\n      if (leftBoundary === rightBoundary || ($(rightBoundary).length && $(rightBoundary).is('.buttonset'))) {\n        e = 'right';\n      }\n\n      return e;\n    }\n\n    leftBoundaryNum = getEdgeFromBoundary(leftBoundary);\n    rightBoundaryNum = getEdgeFromBoundary(rightBoundary, whichEdge());\n\n    if (!leftBoundaryNum && !rightBoundaryNum) {\n      return TOOLBARSEARCHFIELD_EXPAND_SIZE;\n    }\n\n    const distance = rightBoundaryNum - leftBoundaryNum;\n\n    // TODO: Remove this once we figure out how to definitively fix the searchfield sizing.\n    // Toolbar Searchfield needs a way to demand that the parent toolbar increase\n    // the size of its buttonset and decrease the size of its title under this condition\n    // -- currently there is no way.\n    if (distance <= TOOLBARSEARCHFIELD_EXPAND_SIZE) {\n      return TOOLBARSEARCHFIELD_EXPAND_SIZE;\n    }\n\n    if (distance >= MAX_TOOLBARSEARCHFIELD_EXPAND_SIZE) {\n      return MAX_TOOLBARSEARCHFIELD_EXPAND_SIZE;\n    }\n\n    return distance;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  setClosedWidth() {\n    let closedWidth = 0;\n\n    // If the searchfield category button exists, change the width of the\n    // input field on the inside to provide space for the (variable) size of the currently-selected\n    // category (or categories)\n    if ((this.categoryButton instanceof $) && this.categoryButton.length) {\n      const buttonStyle = window.getComputedStyle(this.categoryButton[0]);\n      const buttonWidth = this.categoryButton.width();\n      const buttonBorder = parseInt(buttonStyle.borderLeftWidth, 10) * 2;\n      const buttonPadding = parseInt(buttonStyle.paddingLeft, 10) +\n        parseInt(buttonStyle.paddingRight, 10);\n\n      closedWidth += (buttonWidth + buttonBorder + buttonPadding + 4);\n    }\n\n    if (this.wrapper[0]) {\n      this.wrapper[0].style.width = `${closedWidth}px`;\n    }\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  setOpenWidth() {\n    let subtractWidth = 0;\n\n    if (this.wrapper[0]) {\n      this.wrapper[0].style.width = this.openWidth;\n    }\n\n    // If the searchfield category button exists, change the width of the\n    // input field on the inside to provide space for the (variable) size of the currently-selected\n    // category (or categories)\n    if (this.hasCategories()) {\n      const categoryButtonStyle = window.getComputedStyle(this.categoryButton[0]);\n      const categoryButtonWidth = this.categoryButton.width();\n      const categoryButtonPadding = parseInt(categoryButtonStyle.paddingLeft, 10) +\n        parseInt(categoryButtonStyle.paddingRight, 10);\n      const categoryButtonBorder = (parseInt(categoryButtonStyle.borderLeftWidth, 10) * 2);\n\n      subtractWidth += (categoryButtonWidth + categoryButtonPadding + categoryButtonBorder);\n    }\n\n    if (this.hasGoButton()) {\n      const goButtonStyle = window.getComputedStyle(this.goButton[0]);\n      const goButtonWidth = this.goButton.width();\n      const goButtonPadding = parseInt(goButtonStyle.paddingLeft, 10) +\n        parseInt(goButtonStyle.paddingRight, 10);\n      const goButtonBorder = (parseInt(goButtonStyle.borderLeftWidth, 10) * 2);\n\n      subtractWidth += (goButtonWidth + goButtonPadding + goButtonBorder);\n    }\n\n    if (subtractWidth > 0) {\n      this.input.style.width = `calc(100% - ${subtractWidth}px)`;\n    }\n\n    delete this.openWidth;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  calculateOpenWidth() {\n    const buttonset = this.element.parents('.toolbar').children('.buttonset');\n    let nextElem = this.wrapper.next();\n    let width;\n\n    if (!buttonset.length) {\n      return;\n    }\n    // If small form factor, use the right edge\n    if (nextElem.is('.title')) {\n      nextElem = buttonset;\n    }\n\n    if (this.shouldBeFullWidth()) {\n      width = '100%';\n\n      if ($(this.toolbarParent).closest('.header').length) {\n        width = 'calc(100% - 40px)';\n      }\n      if ($(this.toolbarParent).closest('.tab-container.module-tabs').length) {\n        width = 'calc(100% - 1px)';\n      }\n\n      this.openWidth = width;\n      return;\n    }\n\n    // Figure out boundaries\n    // +10 on the left boundary reduces the likelyhood that the toolbar pushes other elements\n    // into the spillover menu whenever the searchfield opens.\n    const leftBoundary = buttonset.offset().left + 10;\n    let rightBoundary = nextElem;\n\n    // If the search input sits alone, just use the other side of the buttonset to measure\n    if (!rightBoundary.length) {\n      rightBoundary = buttonset.offset().left + 10 + buttonset.outerWidth(true);\n    }\n\n    width = this.getFillSize(leftBoundary, rightBoundary);\n    this.openWidth = `${width - 6}px`;\n  },\n\n  /**\n   * Ensures that the size of the Searchfield Wrapper does not change whenever a category\n   * is chosen from a category searchfield.\n   * NOTE: this method must be run AFTER changes to DOM elements (text/size changes) have been made.\n   * @private\n   */\n  calculateSearchfieldWidth() {\n    const inlineStyleProp = this.element[0].getAttribute('style');\n    let baseWidth = '100%';\n    let subtractWidth = 0;\n    let targetWidthProp;\n\n    if (inlineStyleProp) {\n      this.element[0].removeAttribute('style');\n    }\n\n    const computedStyle = window.getComputedStyle(this.element[0]);\n    if (computedStyle.width && !this.isContextSearch) {\n      baseWidth = computedStyle.width;\n    }\n\n    // Subtract width of extraneous buttons/elems\n    if (this.hasCategories()) {\n      subtractWidth += this.categoryButton.outerWidth(true);\n    }\n    if (this.hasGoButton()) {\n      subtractWidth += this.goButton.outerWidth(true);\n    }\n\n    // NOTE: final width can only be 100% if no value is subtracted for other elements\n    if (subtractWidth > 0) {\n      targetWidthProp = `calc(${baseWidth} - ${subtractWidth}px)`;\n    }\n    if (targetWidthProp) {\n      this.element[0].style.width = targetWidthProp;\n    }\n  },\n\n  /**\n   * Category Selection event handler\n   * @private\n   * @param  {object} e The event.\n   * @param  {object} anchor the link object\n   */\n  handleCategorySelected(e, anchor) {\n    this.element.trigger('selected', [anchor]);\n\n    // Only change the text and searchfield size if we can\n    if (!this.settings.showCategoryText) {\n      return;\n    }\n\n    this.setCategoryButtonText(e, anchor.text().trim());\n    this.calculateSearchfieldWidth();\n\n    if (!this.settings.categoryMultiselect) {\n      this.setAsActive(true, true);\n    }\n  },\n\n  /**\n   * Category Button Focus event handler\n   * @private\n   * @returns {undefined}\n   */\n  handleCategoryFocus() {\n    this.saveFocus();\n    this.setAsActive(true);\n  },\n\n  /**\n   * Gets a complete list of categories in jQuery-collection form.\n   * @returns {jQuery} categories\n   */\n  getCategories() {\n    return this.list.children('li:not(.separator)');\n  },\n\n  /**\n   * Gets the currently selected list of categories in jQuery-collection form.\n   * @returns {jQuery} selectedCategories\n   */\n  getSelectedCategories() {\n    return this.getCategories().filter('.is-checked');\n  },\n\n  /**\n   * Gets the currently selected categories as data.\n   * @param {boolean} [onlyReturnSelected=false] - If set to true, will only return\n   *  checked list items.\n   * @returns {Object[]} data -\n   * @returns {string} name - Category name\n   * @returns {string|number} id - Category element's ID (if applicable)\n   * @returns {string|number} value - Category element's value (if applicable)\n   * @returns {boolean} [checked=true] - Category's selection status\n   */\n  getCategoryData(onlyReturnSelected) {\n    const categories = this.getCategories();\n    const data = [];\n\n    categories.each(function () {\n      const classList = this.classList;\n      const checked = classList.contains('is-checked');\n\n      if (onlyReturnSelected === true && checked === false) {\n        return;\n      }\n\n      const category = {\n        name: this.innerText,\n        checked\n      };\n\n      if (this.id) {\n        category.id = this.id;\n      }\n\n      const value = this.getAttribute('data-value');\n      if (value !== undefined) {\n        category.value = value;\n      }\n\n      data.push(category);\n    });\n\n    return data;\n  },\n\n  /**\n   * Updates just the categories setting and rerenders the category list.\n   * @param {Object[]} categories - Array of category object definitions.\n   * @param {string} categories[].name - Category name.\n   * @param {string|number} [id] - Category element's ID (if applicable).\n   * @param {string|number} [value] - Category element's value (if applicable).\n   * @param {boolean} [checked=true] - Category's selection status\n   * @returns {undefined}\n   */\n  updateCategories(categories) {\n    this.settings.categories = categories;\n    this.setCategories(this.settings.categories);\n  },\n\n  /**\n   * Creates a new set of categories on the Searchfield and rerenders it.\n   * @param {Object[]} categories - Array of category object definitions.\n   * @param {string} categories[].name - Category name.\n   * @param {string|number} [id] - Category element's ID (if applicable).\n   * @param {string|number} [value] - Category element's value (if applicable).\n   * @param {boolean} [checked=true] - Category's selection status\n   * @returns {undefined}\n   */\n  setCategories(categories) {\n    this.list.empty();\n\n    const self = this;\n    const valueTypes = ['string', 'number'];\n    let previouslySelected = false;\n\n    categories.forEach((val) => {\n      // if passed a string, typecast to an object.\n      if (typeof val === 'string') {\n        val = {\n          name: val\n        };\n      }\n\n      // Object types get a bit more customization.\n      // Don't continue if there's no name present.\n      if (!val.name) {\n        return;\n      }\n\n      let id = '';\n      if (typeof val.id === 'string' && val.id.length) {\n        id = ` id=\"${val.id}\"`;\n      }\n\n      let value = '';\n      if (valueTypes.indexOf(typeof val.value) > -1) {\n        value = ` data-value=\"${val.value}\"`;\n      }\n\n      let selected = '';\n      if (val.checked === true && previouslySelected !== true) {\n        selected = ' class=\"is-checked\"';\n\n        if (!self.settings.categoryMultiselect) {\n          previouslySelected = true;\n        }\n      }\n\n      self.list.append(`<li${selected}${id}${value}><a href=\"#\">${val.name}</a></li>`);\n    });\n\n    const api = this.categoryButton.data('popupmenu');\n    if (api && typeof api.updated === 'function') {\n      api.updated();\n    }\n  },\n\n  /**\n   * Expands the Searchfield\n   * @param {boolean} [noFocus] If defined, causes the searchfield component not to become focused\n   *  at the end of the expand method. Its default functionality is that it will become focused.\n   * @returns {Promise} resolved when the expansion completes\n   */\n  expand(noFocus) {\n    const self = this;\n    const expandPromise = new Promise((resolve) => {\n      if (self.isExpanded || self.isExpanding || self.isCollapsing) {\n        resolve();\n        return;\n      }\n\n      const notFullWidth = !self.shouldBeFullWidth();\n\n      self.isExpanding = true;\n\n      // Places the input wrapper into the toolbar on smaller breakpoints\n      if (!notFullWidth) {\n        self.appendToParent();\n      }\n\n      // Re-adjust the size of the buttonset element if the expanded searchfield would be\n      // too large to fit.\n      let buttonsetWidth = 0;\n      if (self.buttonsetElem) {\n        buttonsetWidth = parseInt(window.getComputedStyle(self.buttonsetElem).width, 10);\n      }\n\n      const buttonsetElemWidth = buttonsetWidth + TOOLBARSEARCHFIELD_EXPAND_SIZE;\n      const containerSizeSetters = {\n        buttonset: buttonsetElemWidth\n      };\n\n      if (!this.isContainedByFlexToolbar || breakpoints.isAbove('phone-to-tablet')) {\n        this.wrapper[0].classList.add('is-open');\n      }\n      this.calculateOpenWidth();\n      this.setOpenWidth();\n\n      // Some situations require adjusting the focused element\n      if (!noFocus || env.os.name === 'ios' || (self.isFocused && document.activeElement !== self.input)) {\n        if (self.focusElem) {\n          self.focusElem = self.input;\n        }\n        self.input.focus();\n      }\n\n      // Recalculate the Toolbar Buttonset/Title sizes.\n      const eventArgs = [];\n      if (containerSizeSetters) {\n        eventArgs.push(containerSizeSetters);\n      }\n\n      self.element.trigger('beforeexpand');\n      $(self.toolbarParent).triggerHandler('recalculate-buttons', eventArgs);\n\n      const expandTimer = new RenderLoopItem({\n        duration: 10,\n        updateCallback() {}, // TODO: make this work without an empty function\n        timeoutCallback() {\n          $(self.toolbarParent).triggerHandler('recalculate-buttons', eventArgs);\n          self.element.trigger('expanded');\n          delete self.isExpanding;\n          self.isExpanded = true;\n\n          if (self.isCurrentlyCollapsible && !self.isFocused && !self.focusElem) {\n            self.handleSafeBlur();\n          }\n        }\n      });\n      renderLoop.register(expandTimer);\n    });\n\n    return expandPromise;\n  },\n\n  /**\n   * Collapses the Searchfield\n   * @returns {Promise} resolved once the collapse completes\n   */\n  collapse() {\n    const self = this;\n    const collapsePromise = new Promise((resolve) => {\n      if (!self.isExpanded && self.isExpanding && !self.isCollapsing) {\n        resolve();\n        return;\n      }\n\n      self.isCollapsing = true;\n\n      // Puts the input wrapper back where it should be if it's been moved due to small form factors.\n      self.appendToButtonset();\n\n      self.checkContents();\n\n      self.clearResponsiveState();\n\n      self.wrapper[0].classList.remove('active', 'is-open');\n      if (env.browser.isIE11) {\n        self.wrapper[0].classList.remove('is-open');\n      }\n      if (this.isContainedByFlexToolbar || !this.isFocused) {\n        self.wrapper[0].classList.remove('has-focus');\n      }\n\n      self.wrapper.removeAttr('style');\n      self.input.removeAttribute('style');\n\n      if (self.categoryButton && self.categoryButton.length) {\n        self.categoryButton.data('popupmenu').close(false, true);\n      }\n\n      self.element.trigger('beforecollapse');\n\n      if (env.os.name === 'ios') {\n        $('head').triggerHandler('enable-zoom');\n      }\n\n      delete self.isExpanded;\n      delete self.isExpanding;\n\n      const collapseTimer = new RenderLoopItem({\n        duration: 10,\n        updateCallback() {}, // TODO: make this work without an empty function\n        timeoutCallback() {\n          delete self.isCollapsing;\n          $(self.toolbarParent).triggerHandler('recalculate-buttons');\n          self.element.trigger('collapsed');\n          resolve();\n        }\n      });\n\n      renderLoop.register(collapseTimer);\n    });\n\n    return collapsePromise;\n  },\n\n  /**\n   * @private\n   * @param {jQuery.Event} e incoming click event (driven either by keyboard or actual click)\n   * @returns {void}\n   */\n  collapseResponsive(e) {\n    if (this.previouslyCollapsedByKey && e.type === 'click') {\n      delete this.previouslyCollapsedByKey;\n      return;\n    }\n\n    // Navigate forward unless the event has been driven by a keystroke\n    const self = this;\n    let dir = 1;\n    if (e && !e.key) {\n      dir = 0;\n      if (this.toolbarFlexItem && this.toolbarFlexItem.focused) {\n        dir = 1;\n      }\n    }\n\n    if (e.type === 'keydown') {\n      this.previouslyCollapsedByKey = true;\n    }\n\n    // Collapse followed by a special event trigger (gets picked up by Flex Toolbar)\n    this.collapse().then(() => {\n      self.wrapper.trigger('collapsed-responsive', [dir]);\n    });\n  },\n\n  /**\n   * Adds/removes a CSS class to the searchfield wrapper depending on whether or not the input field is empty.\n   * Needed for expand/collapse scenarios, for proper searchfield resizing.\n   * @private\n   * @returns {void}\n   */\n  checkContents() {\n    let textMethod = 'remove';\n    const value = !this.input.value ? '' : this.input.value.trim();\n    if (value !== '') {\n      textMethod = 'add';\n    }\n    this.wrapper[0].classList[textMethod]('has-text');\n  },\n\n  /**\n   * Adds a link at the bottom of a searchfield with more than (0) results that can be used to link out to a\n   * larger display of search results.\n   * @private\n   * @returns {void}\n   */\n  addMoreLink() {\n    const list = $('#autocomplete-list');\n    const val = this.element.val();\n\n    if ($('.more-results', list).length > 0) {\n      return;\n    }\n\n    const separator = $('<li class=\"separator\" role=\"presentation\"></li>').appendTo(list);\n    const more = $('<li role=\"presentation\"></li>').appendTo(list);\n    this.moreLink = $('<a href=\"#\" class=\"more-results\" tabindex=\"-1\" role=\"menuitem\"></a>')\n      .html(`<span>${Locale.translate('AllResults')} \"${xssUtils.ensureAlphaNumeric(val)}\"</span>`)\n      .appendTo(more);\n\n    if (this.autocomplete.maxWidth) {\n      separator.width(`${this.autocomplete.maxWidth}px`);\n    }\n  },\n\n  /**\n   * Adds a link at the bottom of a searchfield with no results that announces no search results.\n   * @private\n   * @returns {void}\n   */\n  addNoneLink() {\n    const list = $('#autocomplete-list');\n    if ($('.no-results', list).length > 0) {\n      return;\n    }\n\n    const none = $('<li role=\"presentation\" class=\"is-placeholder\"></li>').appendTo(list);\n\n    this.noneLink = $('<a href=\"#\" class=\"no-results\" disabled=\"disabled\" tabindex=\"-1\" role=\"menuitem\" aria-disabled=\"true\"></a>').html(`<span>${Locale.translate('NoResults')}</span>`).appendTo(none);\n  },\n\n  /**\n   * Tears down and rebuilds the Searchfield. Can be called directly, but is also\n   * triggered by calling the \"updated.searchfield\" event on the searchfield element.\n   * @param {object} [settings] incoming settings\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n    this.teardown().init();\n  },\n\n  /**\n   * Disables the Searchfield\n   * @returns {void}\n   */\n  disable() {\n    this.wrapper.addClass('is-disabled');\n    this.element.prop('disabled', true);\n  },\n\n  /**\n   * Enables the Searchfield\n   * @returns {void}\n   */\n  enable() {\n    this.wrapper.removeClass('is-disabled');\n    this.element.prop('disabled', false);\n  },\n\n  /**\n   * Unbinds events and removes unnecessary markup.\n   * @private\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.element.off([\n      `updated.${this.id}`,\n      `focus.${this.id}`,\n      `blur.${this.id}`,\n      `click.${this.id}`,\n      `keydown.${this.id}`,\n      `beforeopen.${this.id}`,\n      `input.${this.id}`,\n      `listopen.${this.id}`,\n      `listclose.${this.id}`,\n      `safe-blur.${this.id}`,\n      `selected.${this.id}`,\n      `populated.${this.id}`,\n      `cleared.${this.id}`].join(' '));\n\n    this.wrapper.off([\n      `mouseenter.${this.id}`,\n      `mouseleave.${this.id}`,\n      `focusin.${this.id}`,\n      `focusout.${this.id}`,\n      `keydown.${this.id}`,\n      `collapse.${this.id}`\n    ].join(' '));\n\n    if (this.toolbarParent) {\n      $(this.toolbarParent).off('navigate.toolbarsearchfield');\n    }\n\n    if (this.goButton && this.goButton.length) {\n      this.goButton.off(`click.${this.id} blur.${this.id}`).remove();\n      delete this.goButton;\n    }\n\n    if (this.categoryButton && this.categoryButton.length) {\n      this.categoryButton.off().remove();\n      delete this.categoryButton;\n    }\n\n    if (this.collapseButton && this.collapseButton.length) {\n      this.collapseButton.off().remove();\n      delete this.collapseButton;\n      delete this.previouslyCollapsedByKey;\n    }\n\n    // Used to determine if the \"Tab\" key was involved in switching focus to the searchfield.\n    this.removeDocumentDeactivationEvents();\n    $('body').off(`resize.${this.id}`);\n\n    if (this.autocomplete) {\n      this.autocomplete.destroy();\n    }\n\n    if (this.wrapper.hasClass('context')) {\n      this.element.addClass('context');\n    }\n\n    this.element.next('.icon').remove();\n    if (this.element.parent().hasClass('searchfield-wrapper')) {\n      this.element.parent().find('ul').remove();\n      this.element.parent().find('.icon').remove();\n    }\n\n    if (this.xButton && this.xButton.length) {\n      this.xButton.off(`blur.${this.id}`);\n      this.xButton.remove();\n    }\n\n    return this;\n  },\n\n  /**\n   * Destroys the Searchfield and removes all jQuery component instancing.\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { SearchField, COMPONENT_NAME };\n","import { SearchField, COMPONENT_NAME } from './searchfield';\n\n/**\n * jQuery Component Wrapper for SearchField\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.searchfield = function (settings) {\n  return this.each(function () {\n    // Normal invoke setup\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new SearchField(this, settings));\n    }\n  });\n};\n","/* eslint-disable no-underscore-dangle, prefer-arrow-callback */\nimport { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\nimport { breakpoints } from '../../utils/breakpoints';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../../utils/lifecycle';\nimport '../accordion/accordion.jquery';\nimport '../searchfield/searchfield.jquery';\n\n// Name of the component in this file.\nconst COMPONENT_NAME = 'applicationmenu';\n\n/**\n * The Application Menu provides access to all the functions, pages, and forms in an application.\n * @class ApplicationMenu\n * @param {object} element The element that gets the plugin established on it.\n * @param {object} [settings] The settings to use on this instance.\n * @param {string} [settings.breakpoint='phone-to-tablet'] Can be 'tablet' or 'phone-to-tablet' (+767),\n * 'phablet (+610)', 'desktop' +(1024) or 'tablet-to-desktop' (+1280). Default is 'phone-to-tablet' (767)\n * @param {boolean} [settings.dismissOnClickMobile=false] If true, causes a clicked menu option to dismiss on click when the responsive view is shown.\n * @param {boolean} [settings.filterable=false] If true a search / filter option will be added.\n * @param {boolean} [settings.openOnLarge=false]  If true, will automatically open the Application Menu when a large screen-width breakpoint is met.\n * @param {array} [settings.triggers=[]]  An Array of jQuery-wrapped elements that are able to open/close this nav menu.\n */\nconst APPLICATIONMENU_DEFAULTS = {\n  breakpoint: 'phone-to-tablet',\n  dismissOnClickMobile: false,\n  filterable: false,\n  openOnLarge: false,\n  triggers: ['.application-menu-trigger'],\n  onExpandSwitcher: null,\n  onCollapseSwitcher: null,\n};\n\nfunction ApplicationMenu(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, APPLICATIONMENU_DEFAULTS);\n\n  return this.init();\n}\n\n// Plugin Methods\nApplicationMenu.prototype = {\n\n  /**\n   * Initialize the plugin.\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this\n      .setup()\n      .handleEvents();\n  },\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  setup() {\n    this.hasTrigger = false;\n    this.isAnimating = false;\n\n    if (!this.hasTriggers()) {\n      this.triggers = $();\n    }\n\n    this.menu = this.element;\n\n    const openOnLarge = this.element.attr('data-open-on-large');\n    this.settings.openOnLarge = openOnLarge !== undefined ? openOnLarge === 'true' : this.settings.openOnLarge;\n\n    const dataBreakpoint = this.element.attr('data-breakpoint');\n    this.settings.breakpoint = breakpoints[dataBreakpoint] !== undefined ?\n      dataBreakpoint : this.settings.breakpoint;\n\n    // Pull in the list of Nav Menu trigger elements and store them internally.\n    this.modifyTriggers(this.settings.triggers, false, true);\n\n    this.scrollTarget = this.menu.parents('.header');\n    const masthead = this.menu.prevAll('.masthead');\n    const moduleTabs = this.menu.prevAll('.module-tabs');\n\n    if (masthead.length > 0) {\n      this.scrollTarget = masthead;\n      this.menu.addClass('short');\n    }\n    if (moduleTabs.length > 0) {\n      this.scrollTarget = moduleTabs;\n    }\n\n    this.element.find('.application-menu-switcher-panel .accordion').accordion();\n    this.accordion = this.menu.find('.accordion').last();\n    this.accordion.addClass('panel').addClass('inverse');\n\n    // Check to make sure that the internal Accordion Control is invoked\n    let accordion = this.accordion.data('accordion');\n    if (!accordion) {\n      this.accordion.accordion();\n      accordion = this.accordion.data('accordion');\n    }\n    this.accordionAPI = accordion;\n\n    // detect the presence of a searchfield\n    this.searchfield = this.element.find('.searchfield, .searchfield-wrapper');\n\n    // Setup filtering, if applicable.\n    if (this.settings.filterable && typeof $.fn.searchfield === 'function') {\n      if (this.searchfield.length) {\n        if (this.searchfield.is('.searchfield-wrapper')) {\n          this.searchfield = this.searchfield.children('.searchfield');\n        }\n      } else {\n        this.searchfield = $(`${'<div class=\"searchfield-wrapper\">' +\n          '<label for=\"application-menu-searchfield\">'}${Locale.translate('Search')}</label>` +\n          '<input id=\"application-menu-searchfield\" class=\"searchfield\" /></div>').prependTo(this.element);\n      }\n\n      this.element.addClass('has-searchfield');\n      const self = this;\n      this.searchfield.searchfield({\n        clearable: true,\n        source(term, done, args) {\n          done(term, self.accordion.data('accordion').toData(true, true), args);\n        },\n        searchableTextCallback(item) {\n          return item.text || '';\n        },\n        resultIteratorCallback(item) {\n          item.highlightTarget = 'text';\n          return item;\n        },\n        clearResultsCallback() {\n          self.accordionAPI.unfilter();\n        },\n        displayResultsCallback(results, done) {\n          return self.filterResultsCallback(results, done);\n        }\n      });\n    } else if (this.searchfield.length) {\n      this.searchfield.off();\n      this.searchfield.parent('.searchfield-wrapper').remove();\n      delete this.searchfield;\n    }\n\n    // Sync with application menus that have an 'is-open' CSS class.\n    // Otherwise, just adjust the height.\n    if (this.isOpen()) {\n      this.openMenu(false, false, true);\n    } else {\n      this.adjustHeight();\n    }\n\n    // Handle Role Switcher with events and classes\n    const switchTrigger = this.element.find('.application-menu-switcher-trigger');\n    if (switchTrigger.length > 0) {\n      this.switcherPanel = switchTrigger.next('.expandable-area');\n      this.switcherPanel.on('beforeexpand.applicationmenu', () => {\n        const height = this.element.height();\n\n        this.element.addClass('has-open-switcher');\n        this.switcherPanel.find('.content').height(height - 71); // The height of the visible header part\n\n        if (this.settings.onExpandSwitcher) {\n          this.settings.onExpandSwitcher(this, this.element, this.settings);\n        }\n      }).on('aftercollapse.applicationmenu', () => {\n        this.element.removeClass('has-open-switcher');\n        if (this.settings.onCollapseSwitcher) {\n          this.settings.onCollapseSwitcher(this, this.element, this.settings);\n        }\n      });\n    }\n    return this;\n  },\n\n  /**\n   * Gets a reference to this Application Menu's adjacent container element.\n   * @returns {jQuery[]} the adjacent container element\n   */\n  getAdjacentContainerElement() {\n    let container = this.element.next('.page-container');\n    if (!container.length) {\n      container = $('body');\n    }\n    return container;\n  },\n\n  /**\n   * Setup click events on this.element if it's not the menu itself.\n   * (this means that it's a trigger button).\n   * @returns {void}\n   */\n  handleTriggerEvents() {\n    const self = this;\n\n    function triggerClickHandler(e) {\n      // Don't allow hamburger buttons that have changed state to activate/deactivate the app menu.\n      if ($(e.currentTarget).find('.icon.app-header').hasClass('go-back')) {\n        return false;\n      }\n\n      if (self.isAnimating) {\n        return false;\n      }\n\n      const isOpen = self.menu.hasClass('is-open');\n      if (!isOpen) {\n        self.openMenu(undefined, true);\n      } else {\n        self.closeMenu(true);\n      }\n      return true;\n    }\n\n    if (this.triggers.length) {\n      this.triggers.off('click.applicationmenu').on('click.applicationmenu', triggerClickHandler);\n    }\n\n    $(document).on('keydown.applicationmenu', (e) => {\n      self.handleKeyDown(e);\n    });\n  },\n\n  /**\n   * Handles Keydown Events on the App Menu\n   * @param {jQuery.Event} e `keydown` events\n   * @returns {boolean} whether or not the keydown event was successful\n   */\n  handleKeyDown(e) {\n    const key = e.which;\n\n    if (key === 121 && !e.shiftKey) { // F10 - opens the menu\n      e.preventDefault();\n\n      if (this.isOpen()) {\n        this.closeMenu(true);\n        if (this.triggers.length) {\n          this.triggers.eq(0).focus();\n        }\n      } else {\n        this.openMenu();\n      }\n\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * Adds a visual badge-style notification to an Application Menu accordion header\n   * @param {jQuery[]} anchor the anchor to target\n   * @param {number} value the numeric value to attach\n   * @returns {jQuery[]|undefined} a reference to the new tag markup, if applicable\n   */\n  notify(anchor, value) {\n    if (!anchor || anchor === undefined) {\n      return undefined;\n    }\n    if (anchor instanceof HTMLElement) {\n      anchor = $(anchor);\n    }\n    if (!anchor.is('a')) {\n      return undefined;\n    }\n\n    let tag = anchor.find('.tag');\n\n    // Close the tag if an undefined or '0' value is passed\n    if (!value || value === undefined || parseInt(value, 10) === 0) {\n      if (tag.length) {\n        tag.remove();\n      }\n      return undefined;\n    }\n\n    if (!tag.length) {\n      tag = $('<span class=\"tag\"></span>').appendTo(anchor);\n    }\n\n    tag.text(value.toString());\n    return tag;\n  },\n\n  /**\n   * Adjusts the application menu's height to fit the page.\n   * @private\n   * @returns {void}\n   */\n  adjustHeight() {\n    const isSticky = this.scrollTarget.is('.is-sticky');\n    const totalHeight = this.scrollTarget.outerHeight(true);\n    let offset = totalHeight - (!isSticky ? $(window).scrollTop() : 0);\n\n    if (this.scrollTarget.prev().is('.masthead')) {\n      offset += this.scrollTarget.prev().outerHeight(true);\n    }\n\n    this.menu[0].style.height = offset > 0 ? (`calc(100% - ${offset}px)`) : '100%';\n  },\n\n  /**\n   * Checks the window size against the defined breakpoint.\n   * @private\n   * @returns {boolean} whether or not the window size is larger than the\n   *  settings-defined breakpoint\n   */\n  isLargerThanBreakpoint() {\n    return breakpoints.isAbove(this.settings.breakpoint);\n  },\n\n  /**\n   * Detects whether or not the application menu is open\n   * @returns {boolean} whether or not the application menu is open\n   */\n  isOpen() {\n    return this.menu[0].classList.contains('is-open');\n  },\n\n  /**\n   * Detects a change in breakpoint size that can cause the Application Menu's state to change.\n   * @returns {void}\n   */\n  testWidth() {\n    if (this.isOpen()) {\n      if (breakpoints.isAbove(this.settings.breakpoint)) {\n        this.element[0].classList.remove('show-shadow');\n        return;\n      }\n\n      this.element[0].classList.add('show-shadow');\n\n      if (this.isAnimating) {\n        return;\n      }\n\n      if (!this.userOpened) {\n        this.closeMenu();\n      }\n      return;\n    }\n\n    if (breakpoints.isBelow(this.settings.breakpoint)) {\n      return;\n    }\n\n    if (this.userClosed || !this.settings.openOnLarge || this.isAnimating) {\n      return;\n    }\n\n    this.openMenu(true);\n  },\n\n  /**\n   * Opens the Application Menu\n   * @param {boolean} noFocus If true, sets focus on the first item in the application menu.\n   * @param {boolean} [userOpened] If true, notifies the component that the menu was\n   *  manually opened by the user.\n   * @param {boolean} [openedByClass] If true, only adjusts bare-miniumum requirements\n   *  for the application menu to appear open (should be used in cases where the application\n   *  menu has the `is-open` CSS appended to it via markup).  This skips events, animation, etc.\n   */\n  openMenu(noFocus, userOpened, openedByClass) {\n    if (this.isAnimating === true) {\n      return;\n    }\n\n    const self = this;\n    const transitionEnd = $.fn.transitonEndName;\n\n    if (!openedByClass) {\n      this.isAnimating = true;\n    }\n    this.adjustHeight();\n\n    function isOpen() {\n      if (self.timeout !== null) {\n        clearTimeout(self.timeout);\n        self.timeout = null;\n      }\n\n      if (userOpened) {\n        self.userOpened = true;\n        self.userClosed = undefined;\n      }\n\n      /**\n      * Fires the menu is opened\n      *\n      * @event applicationmenuopen\n      * @memberof ApplicationMenu\n      * @param {object} event - The jquery event object\n      */\n      if (!openedByClass) {\n        self.isAnimating = false;\n        self.element.trigger('applicationmenuopen');\n        $('body').triggerHandler('resize');\n      }\n\n      self.menu.removeClass('no-transition');\n      $('.page-container').removeClass('no-transition');\n    }\n\n    this.triggers.each(function () {\n      const trig = $(this);\n      if (trig.parents('.header').length > 0 || trig.parents('.masthead').length > 0) {\n        const header = trig.parents('.header, .masthead');\n        if (header.parents('.page-container').length) {\n          return;\n        }\n\n        trig.find('.icon.app-header').removeClass('go-back').addClass('close');\n        trig.trigger('icon-change');\n      }\n    });\n\n    // Animate the application menu open.\n    // If opened by class, `is-open` is already applied to the app menu at this\n    // point in the render cycle, and should not be re-applied.\n    if (!openedByClass) {\n      this.menu.off(`${transitionEnd}.applicationmenu`);\n      this.menu[0].style.display = '';\n      // next line forces a repaint\n      // eslint-disable-next-line\n      this.menu[0].offsetHeight;\n      this.menu.addClass('is-open');\n    }\n\n    if (breakpoints.isBelow(this.settings.breakpoint)) {\n      this.menu.addClass('show-shadow');\n    }\n\n    if (!noFocus || noFocus !== true) {\n      this.menu.find('.is-selected > a').focus();\n    }\n\n    if (env.os.name === 'ios') {\n      const container = this.getAdjacentContainerElement();\n      container.addClass('ios-click-target');\n    }\n\n    if (!openedByClass) {\n      this.menu.one(`${transitionEnd}.applicationmenu`, isOpen);\n      this.timeout = setTimeout(isOpen, 300);\n    } else {\n      isOpen();\n    }\n\n    // Events that will close the nav menu\n    // On a timer to prevent conflicts with the Trigger button's click events\n    setTimeout(() => {\n      $(document).on('click.applicationmenu', (e) => {\n        if ($(e.target).parents('.application-menu').length < 1 && !self.isLargerThanBreakpoint()) {\n          self.closeMenu(true);\n        }\n      });\n    }, 0);\n  },\n\n  /**\n   * Closes the Application Menu\n   * @param {boolean} [userClosed] if true, sets a flag notifying the component\n   *  that the user was responsible for closing.\n   */\n  closeMenu(userClosed) {\n    if (this.isAnimating === true) {\n      return;\n    }\n\n    const self = this;\n    const transitionEnd = $.fn.transitionEndName();\n\n    this.isAnimating = true;\n\n    function close() {\n      if (self.timeout !== null) {\n        clearTimeout(self.timeout);\n        self.timeout = null;\n      }\n\n      self.menu.off(`${transitionEnd}.applicationmenu`);\n      self.menu[0].style.display = 'none';\n      self.isAnimating = false;\n\n      if (userClosed) {\n        self.userOpened = undefined;\n        self.userClosed = true;\n      }\n\n      /**\n      * Fires the menu is closed\n      *\n      * @event applicationmenuclose\n      * @memberof ApplicationMenu\n      * @param {object} event - The jquery event object\n      */\n      self.element.trigger('applicationmenuclose');\n      $('body').triggerHandler('resize');\n    }\n\n    this.triggers.each(function () {\n      const trig = $(this);\n      if (trig.parents('.header').length > 0 || trig.parents('.masthead').length > 0) {\n        trig.find('.icon.app-header').removeClass('close');\n        trig.trigger('icon-change');\n      }\n    });\n\n    if (env.os.name === 'ios') {\n      const container = this.getAdjacentContainerElement();\n      container.removeClass('ios-click-target');\n    }\n\n    this.menu.one(`${transitionEnd}.applicationmenu`, close);\n    this.timeout = setTimeout(close, 300);\n\n    this.menu.removeClass('is-open show-shadow').find('[tabindex]');\n    $(document).off('click.applicationmenu');\n  },\n\n  /**\n   * Detects whether or not the Application Menu has external trigger buttons setup to control it.\n   * @returns {boolean} whether or not external triggers have been defined.\n   */\n  hasTriggers() {\n    return (this.triggers !== undefined && this.triggers instanceof $ && this.triggers.length);\n  },\n\n  /**\n   * Externally Facing function that can be used to add/remove application nav menu triggers.\n   * @param {Array[]} triggers an array of HTMLElements or jQuery-wrapped elements that\n   *  will be used as triggers.\n   * @param {boolean} [remove] if defined, triggers that are defined will be removed\n   *  internally instead of added.\n   * @param {boolean} [norebuild] if defined, this control's events won't automatically\n   *  be rebound to include the new triggers.\n   */\n  modifyTriggers(triggers, remove, norebuild) {\n    if (!triggers || !triggers.length) {\n      return;\n    }\n    let changed = $();\n\n    $.each(triggers, (i, obj) => {\n      changed = changed.add($(obj));\n    });\n\n    this.triggers = this.triggers[!remove ? 'add' : 'not'](changed);\n    this.handleTriggerEvents();\n\n    if (norebuild && norebuild === true) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * @param {array} results list of items that passed the filtering process\n   * @param {function} done method to be called when the display of filtered items completes.\n   * @returns {void}\n   */\n  filterResultsCallback(results, done) {\n    if (!results || !results.length) {\n      this.accordionAPI.unfilter();\n      done();\n      return;\n    }\n\n    const headers = $(results.map(item => item.element));\n    this.accordionAPI.filter(headers, true);\n\n    this.element.triggerHandler('filtered', [results]);\n    done();\n  },\n\n  /**\n   * handles the Searchfield Input event\n   * @param {jQuery.Event} e jQuery `input` event\n   */\n  handleSearchfieldInputEvent() {\n    if (!this.searchfield || !this.searchfield.length) {\n      return;\n    }\n\n    const val = this.searchfield.val();\n\n    if (!val || val === '') {\n      const filteredParentHeaders = this.accordion.find('.has-filtered-children');\n      this.accordionAPI.headers.removeClass('filtered has-filtered-children');\n      this.accordionAPI.collapse(filteredParentHeaders);\n      this.accordionAPI.updated();\n      this.element.triggerHandler('filtered', [[]]);\n    }\n  },\n\n  /**\n   * @param {jQuery} anchor the anchor being checked\n   * @returns {void}\n   */\n  handleDismissOnClick(anchor) {\n    if (!this.settings.dismissOnClickMobile) {\n      return;\n    }\n\n    this.userOpened = false;\n    $(anchor).blur();\n    if (this.isLargerThanBreakpoint()) {\n      return;\n    }\n\n    this.closeMenu();\n  },\n\n  /**\n   * Unbinds event listeners and removes extraneous markup from the Application Menu.\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.menu\n      .off('animateopencomplete animateclosedcomplete')\n      .removeClass('short')\n      .removeAttr('style');\n\n    $(window).off('scroll.applicationmenu');\n    $('body').off('resize.applicationmenu');\n    $(document).off('click.applicationmenu open-applicationmenu close-applicationmenu keydown.applicationmenu');\n\n    this.accordion.off('blur.applicationmenu selected.applicationmenu followlink.applicationmenu');\n    if (this.accordionAPI && typeof this.accordionAPI.destroy === 'function') {\n      if (this.isFiltered) {\n        this.accordionAPI.collapse();\n      }\n      this.accordionAPI.destroy();\n    }\n\n    if (this.switcherPanel) {\n      this.switcherPanel.off('beforeexpand.applicationmenu aftercollapse.applicationmenu');\n    }\n\n    if (this.searchfield && this.searchfield.length) {\n      this.searchfield.off('input.applicationmenu');\n      const sfAPI = this.searchfield.data('searchfield');\n      if (sfAPI) {\n        sfAPI.destroy();\n      }\n    }\n\n    if (this.hasTriggers()) {\n      this.triggers.off('click.applicationmenu');\n    }\n\n    return this;\n  },\n\n  /**\n   * Triggers a UI Resync.\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Teardown - Remove added markup and events\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * This component fires the following events.\n   * @fires Applicationmenu#events\n   * @listens applicationmenuopen  Fires when the menu is opened.\n   * @listens applicationmenuclose  Fires as the menu is closed.\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    this.handleTriggerEvents();\n\n    // Setup notification change events\n    this.menu.on('notify.applicationmenu', (e, anchor, value) => {\n      self.notify(anchor, value);\n    }).on('updated.applicationmenu', () => {\n      self.updated();\n    });\n\n    this.accordion.on('blur.applicationmenu', () => {\n      self.closeMenu();\n    }).on('selected.applicationmenu', (e, header) => {\n      const a = $(header).children('a');\n      self.handleDismissOnClick(a);\n    }).on('followlink.applicationmenu', (e, anchor) => {\n      self.handleDismissOnClick(anchor);\n    });\n\n    $(document).on('open-applicationmenu', () => {\n      self.openMenu(undefined, true);\n    }).on('close-applicationmenu', () => {\n      self.closeMenu();\n    });\n\n    $(window).on('scroll.applicationmenu', () => {\n      self.adjustHeight();\n    });\n\n    $('body').on('resize.applicationmenu', () => {\n      self.testWidth();\n    });\n\n    if (this.settings.filterable === true && this.searchfield && this.searchfield.length) {\n      this.searchfield.on('input.applicationmenu', (e) => {\n        self.handleSearchfieldInputEvent(e);\n      });\n    }\n\n    if (this.settings.openOnLarge && this.isLargerThanBreakpoint()) {\n      this.menu.addClass('no-transition');\n      $('.page-container').addClass('no-transition');\n    }\n    this.testWidth();\n\n    // Remove after initial transition\n    setTimeout(() => {\n      self.menu.removeClass('no-transition');\n      $('.page-container').removeClass('no-transition');\n    }, 800);\n\n    return this;\n  }\n\n};\n\nexport { ApplicationMenu, COMPONENT_NAME };\n","import { ApplicationMenu, COMPONENT_NAME } from './applicationmenu';\n\n/**\n * jQuery component wrapper for the Application Menu\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.applicationmenu = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ApplicationMenu(this, settings));\n    }\n    return instance;\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { deprecateMethod } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Settings and Options\nconst COMPONENT_NAME = 'blockgrid';\n\n/**\n * Component Name - Does this and that.\n * @class Blockgrid\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings] The settings element.\n * @param {array} [settings.dataset=[]] An array of data objects\n * @param {string} [settings.selectable=false] Controls the selection mode this can be:\n * @param {boolean} paging Enable paging mode\n * @param {number} pagesize Number of rows per page\n * @param {array} pagesizes Array of page sizes to show in the page size dropdown.\n * false, 'single' or 'multiple' or 'mixed'\n */\nconst BLOCKGRID_DEFAULTS = {\n  dataset: [],\n  selectable: false, // false, 'single' or 'multiple' or mixed\n  paging: false,\n  pagesize: 25,\n  pagesizes: [10, 25, 50, 75]\n};\n\nfunction Blockgrid(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(element, settings, BLOCKGRID_DEFAULTS);\n  if (settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nBlockgrid.prototype = {\n\n  /**\n   * @returns {Pager|undefined} a pager API, if applicable\n   */\n  get pagerAPI() {\n    return this.element.data('pager');\n  },\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  init() {\n    this.selectedRows = [];\n    this.handlePaging();\n\n    return this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n   * Add any needed markup to the component.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  build() {\n    if (this.settings.paging) {\n      this.element.empty();\n    }\n\n    this.render();\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.on(`click.${COMPONENT_NAME}`, '.block', (e) => {\n      const activeBlock = $(e.currentTarget);\n      const target = $(e.target);\n      const isCheckbox = target.is('.checkbox-label') || target.is('.checkbox');\n\n      setTimeout(() => {\n        self.selectBlock(activeBlock, isCheckbox);\n      }, 0);\n\n      e.stopPropagation();\n      e.preventDefault();\n    });\n\n    this.element.on(`focus.${COMPONENT_NAME}`, '.checkbox', (e) => {\n      const block = $(e.currentTarget).parent();\n      block.addClass('has-focus');\n    });\n\n    this.element.on(`blur.${COMPONENT_NAME}`, '.checkbox', (e) => {\n      const block = $(e.currentTarget).parent();\n      block.removeClass('has-focus');\n    });\n\n    this.element.on(`keypress.${COMPONENT_NAME}`, '.block', (e) => {\n      if (e.which !== 32) {\n        return;\n      }\n\n      const activeBlock = $(e.target);\n      self.selectBlock(activeBlock, false);\n    });\n\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      self.updated();\n    });\n\n    if (this.pagerAPI) {\n      this.element.on(`page.${COMPONENT_NAME}`, () => {\n        this.previousFocusedElement = true;\n        this.build();\n      }).on(`pagesizechange.${COMPONENT_NAME}`, () => {\n        this.previousFocusedElement = true;\n        this.build();\n      });\n    }\n\n    return this;\n  },\n\n  handlePaging() {\n    if (!this.settings.paging) {\n      return;\n    }\n\n    this.element.addClass('paginated');\n    this.element.pager({\n      componentAPI: this,\n      dataset: this.settings.dataset,\n      pagesize: this.settings.pagesize,\n      pagesizes: this.settings.pagesizes\n    });\n  },\n\n  /**\n   * Run selection over a block item.\n   * This method is slated to be removed in a future v4.21.0 or v5.0.0.\n   * @deprecated as of v4.15.0. Please use `select()` instead.\n   * @param {jQuery[]} activeBlock the jQuery-wrapped DOM element that will be selected.\n   * @param {boolean} isCheckbox True if a checkbox, used for mixed mode.\n   * @returns {void}\n   */\n  selectBlock(activeBlock, isCheckbox) {\n    return deprecateMethod(this.select, this.selectBlock).apply(this, [activeBlock, isCheckbox]);\n  },\n\n  /**\n   * Run selection over a block item\n   * @param {jQuery[]} activeBlock the jQuery-wrapped DOM element that will be selected.\n   * @param {boolean} isCheckbox True if a checkbox, used for mixed mode.\n   */\n  select(activeBlock, isCheckbox) {\n    const allBlocks = this.element.find('.block');\n    const allChecks = this.element.find('.checkbox');\n    const activeCheckbox = activeBlock.find('.checkbox');\n    const isChecked = activeCheckbox.is(':checked');\n    let action = '';\n    const idx = Number(activeCheckbox.data('idx'));\n\n    if (this.settings.selectable === 'single') {\n      this.selectedRows = [];\n      allBlocks.removeClass('is-selected').removeAttr('aria-selected');\n      allChecks.prop('checked', false);\n    }\n\n    if ((this.settings.selectable === 'multiple' && isChecked) ||\n      (this.settings.selectable === 'mixed' && isCheckbox && isChecked)) {\n      activeBlock.removeClass('is-selected').removeAttr('aria-selected');\n      activeCheckbox.prop('checked', false);\n\n      for (let i = 0; i < this.selectedRows.length; i++) {\n        if (idx === this.selectedRows[i].idx) {\n          this.selectedRows.splice(i, 1);\n        }\n      }\n\n      this.element.triggerHandler('deselected', [{ selectedRows: this.selectedRows, action: 'deselect' }]);\n      return;\n    }\n\n    if (this.settings.selectable !== false && !(this.settings.selectable === 'mixed' && !isCheckbox)) {\n      if (!isChecked) {\n        activeBlock.addClass('is-selected').attr('aria-selected', 'true');\n        activeCheckbox.prop('checked', true);\n      }\n\n      this.selectedRows.push({ idx, data: this.settings.dataset[idx], elem: activeBlock });\n      action = isChecked ? 'deselected' : 'selected';\n    }\n\n    if (this.settings.selectable === 'mixed' && !isCheckbox) {\n      const isActivated = activeBlock.hasClass('is-activated');\n      allBlocks.removeClass('is-activated');\n\n      /**\n      * Fires when a block is deactivated\n      *\n      * @event deactivated\n      * @memberof Blockgrid\n      * @property {object} event - The jquery event object\n      * @property {object} ui - The dialog object\n      */\n      /**\n      * Fires when a block is activated\n      *\n      * @event activated\n      * @memberof Blockgrid\n      * @property {object} event - The jquery event object\n      * @property {object} ui - The dialog object\n      */\n      if (isActivated) {\n        activeBlock.removeClass('is-activated');\n        this.element.triggerHandler('deactivated', [{ row: idx, item: this.settings.dataset[idx] }]);\n      } else {\n        activeBlock.addClass('is-activated');\n        this.element.triggerHandler('activated', [{ row: idx, item: this.settings.dataset[idx] }]);\n      }\n      return;\n    }\n\n    /**\n    * Fires when a block is selected\n    *\n    * @event selected\n    * @memberof Blockgrid\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n    /**\n    * Fires when a block is unselected\n    *\n    * @event deselected\n    * @memberof Blockgrid\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n    this.element.triggerHandler(isChecked ? 'deselected' : 'selected', [{ selectedRows: this.selectedRows, action }]);\n  },\n\n  /**\n   * Renders the blockgrid page.\n   * @returns {void}\n   */\n  render() {\n    let blockelements = '';\n    let displayedDataset = this.settings.dataset;\n    const selectText = (Locale ? Locale.translate('Select') : 'Select');\n\n    if (this.pagerAPI) {\n      // If the paging information sets limits on the dataset, customize the\n      // displayed dataset to fit the conditions.\n      const pagerInfo = this.pagerAPI.state;\n      if (pagerInfo.pages > 1) {\n        const trueActivePage = pagerInfo.activePage > 0 ? pagerInfo.activePage - 1 : 0;\n        const firstRecordIdx = pagerInfo.pagesize * trueActivePage;\n        const lastRecordIdx = pagerInfo.pagesize * (trueActivePage + 1);\n        displayedDataset = displayedDataset.slice(firstRecordIdx, lastRecordIdx);\n\n        // If the dataset doesn't actually have IDs, set temporary ones for\n        // tracking selected/deselected\n        if (displayedDataset.length !== this.settings.dataset.length) {\n          for (let j = 0; j < (lastRecordIdx - firstRecordIdx) + 1; j++) {\n            if (displayedDataset[j].id) {\n              break;\n            }\n            displayedDataset[j].id = firstRecordIdx + j;\n          }\n        }\n      }\n    }\n\n    const checkedIdxs = [];\n    this.selectedRows.forEach((row) => {\n      checkedIdxs.push(row.idx);\n    });\n\n    for (let i = 0; i < displayedDataset.length; i++) {\n      const data = displayedDataset[i];\n      const tabindex = this.settings.selectable === 'mixed' ? '0' : '-1';\n      let selected = '';\n      let checked = '';\n\n      if (checkedIdxs.indexOf(data.id) > -1) {\n        selected = ' is-selected';\n        checked = ' checked';\n      }\n\n      blockelements += `<div class=\"block is-selectable${selected}\" role=\"listitem\" tabindex=\"0\">\n        <input type=\"checkbox\" aria-hidden=\"true\" role=\"presentation\" class=\"checkbox\" id=\"checkbox${i}\" tabindex=\"${tabindex}\" data-idx=\"${data.id}\"${checked}>\n        <label for=\"checkbox${i}\" class=\"checkbox-label\">\n          <span class=\"audible\">${selectText}</span>\n        </label>\n        <img alt=\"Placeholder Image\" src=\"${data.img || data.image}\" class=\"image-round\">\n        <p> ${data.maintxt || data.title} <br> ${data.subtxt || data.subtitle} </p>\n      </div>`;\n    }\n\n    this.element.attr('role', 'list').append(blockelements);\n\n    // If a Blockgrid element had focus before rendering, restore focus to the first new block\n    if (this.previousFocusedElement) {\n      setTimeout(() => {\n        this.element.find('.block').first().focus();\n        delete this.previousFocusedElement;\n      }, 0);\n    }\n  },\n\n  /**\n   * Render an individual block element.\n   * This method is slated to be removed in a future v4.21.0 or v5.0.0.\n   * @deprecated as of v4.15.0. Please use `render()` instead.\n   * @returns {void}\n   */\n  renderBlock() {\n    return deprecateMethod(this.render, this.renderBlock).apply(this);\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {settings} settings The new settings to use.\n   * @returns {void}\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n\n    this.teardown();\n    this.init();\n    return this;\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    this.element.off(`click.${COMPONENT_NAME}`);\n\n    this.element.empty();\n    this.selectedRows = [];\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Blockgrid, COMPONENT_NAME };\n","import { Blockgrid, COMPONENT_NAME } from './blockgrid';\n\n/**\n * jQuery component wrapper for the Accordion\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.blockgrid = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Blockgrid(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// The Name of this component.\nconst COMPONENT_NAME = 'busyindicator';\n\n/**\n * A Busy Indicator notifies the user that the system is processing a request, and that they must\n * wait for that request to be processed before continuing with the current task.\n * @class BusyIndicator\n * @param {object} element The plugin starting element.\n * @param {object} [settings] The settings to use.\n * @param {string} [settings.blockUI=true] makes the element that Busy Indicator is invoked on unusable while it's displayed.\n * @param {string} [settings.text=null] Custom Text To Show or Will Show Localized Loading....\n * @param {string} [settings.displayDelay=1000] Number in miliseconds to pass before the markup is displayed. If 0, displays immediately.\n * @param {boolean} [settings.timeToComplete=0] fires the 'complete' trigger at a certain timing interval. If 0, goes indefinitely.\n * @param {string} [settings.transparentOverlay=false] If true, allows the \"blockUI\" setting to display\n * an overlay that prevents interaction, but appears transparent instead of gray.\n * @param {string} [settings.overlayOnly=false] If true, the busy indicator will only be the overlay.\n */\nconst BUSYINDICATOR_DEFAULTS = {\n  blockUI: true,\n  text: null,\n  displayDelay: 1000,\n  timeToComplete: 0,\n  transparentOverlay: false,\n  overlayOnly: false\n};\n\nfunction BusyIndicator(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, BUSYINDICATOR_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nBusyIndicator.prototype = {\n\n  init() {\n    this.inlineLabel = this.element.closest('label');\n    this.inlineLabelText = this.inlineLabel.find('.label-text');\n    this.isInlineLabel = this.element.parent().is('.inline');\n\n    this\n      .setup()\n      .handleEvents();\n  },\n\n  // Sanitize incoming option values\n  setup() {\n    const blockUI = this.element.attr('data-block-ui');\n    const delay = this.element.attr('data-display-delay');\n    const completionTime = this.element.attr('data-completion-time');\n\n    this.blockUI = blockUI !== undefined ? blockUI : this.settings.blockUI;\n    if (!this.settings.overlayOnly) {\n      this.loadingText = this.settings.text ? this.settings.text : Locale.translate('Loading');\n\n      // Support updating the label while open\n      if (this.label) {\n        this.label.text(this.loadingText);\n      }\n    }\n\n    const isDelayDefined = delay !== undefined && !isNaN(delay) && parseInt(delay, 10) > 20;\n    const displayDelay = (!isNaN(this.settings.displayDelay) &&\n        this.settings.displayDelay >= 20) ? this.settings.displayDelay : 20;\n\n    this.delay = isDelayDefined ? delay : displayDelay;\n    this.completionTime = completionTime !== undefined && !isNaN(completionTime) ?\n      parseInt(completionTime, 10) : this.settings.timeToComplete;\n\n    return this;\n  },\n\n  /**\n  * Builds and starts the indicator\n  * @private\n  * @returns {void}\n  */\n  activate() {\n    const self = this;\n\n    if (self.isActive()) {\n      return; // safety, don't activate this code if already active\n    }\n\n    // If the markup already exists don't do anything but clear\n    if (this.container) {\n      if (self.closeTimeout) {\n        clearTimeout(self.closeTimeout);\n      }\n      this.label.remove();\n      if (!this.settings.overlayOnly) {\n        this.label = $(`<span>${this.loadingText}</span>`).appendTo(this.container);\n\n        if (this.element.is('input, .dropdown, .multiselect, .busy-xs, .busy-sm')) {\n          this.label.addClass('audible');\n        }\n      }\n\n      this.container\n        .removeClass('is-hidden')\n        .trigger('afterstart');\n\n      return;\n    }\n\n    // Build all the markup\n    this.container = $('<div class=\"busy-indicator-container is-hidden\"></div>').attr({\n      'aria-live': 'polite',\n      role: 'status'\n    });\n    this.loader = $('<div class=\"busy-indicator active\"></div>').appendTo(this.container);\n\n    if (!this.settings.overlayOnly) {\n      $('<div class=\"bar one\"></div>' +\n        '<div class=\"bar two\"></div>' +\n        '<div class=\"bar three\"></div>' +\n        '<div class=\"bar four\"></div>' +\n        '<div class=\"bar five\"></div>').appendTo(this.loader);\n\n      this.label = $(`<span>${this.loadingText}</span>`).appendTo(this.container);\n    }\n\n    let transparency = '';\n\n    if (this.blockUI) {\n      if (this.settings.transparentOverlay) {\n        transparency = ' transparent';\n      }\n\n      this.originalPositionProp = this.element[0].style.position;\n      this.element[0].style.position = 'relative';\n      this.overlay = $(`<div class=\"overlay busy is-hidden${transparency}\"></div>`).appendTo(this.element);\n      this.container.addClass('blocked-ui');\n    }\n\n    if (this.label && this.element.is('.busy-xs, .busy-sm')) {\n      this.label.addClass('audible');\n    }\n\n    // Append the markup to the page\n    // Use special positioning logic for compatibility with certain controls\n    if (this.element.is('input, .dropdown, .multiselect')) {\n      this.element.addClass('is-loading');\n      if (this.blockUI) {\n        this.element.addClass('is-blocked');\n      }\n      if (this.label) {\n        this.label.addClass('audible');\n      }\n\n      let target;\n\n      if (this.element.is('input')) {\n        target = this.element;\n        this.container.insertAfter(this.isInlineLabel ? this.inlineLabel : this.element);\n      } else {\n        const dd = this.element.data('dropdown');\n        target = dd.pseudoElem;\n        this.container.appendTo(target.parent());\n      }\n\n      if (this.overlay) {\n        this.overlay.insertAfter(this.container);\n      }\n\n      const rect = target.position();\n      const h = target.outerHeight();\n      const w = target.outerWidth();\n      const elements = this.container.add(this.overlay);\n      const setCssStyle = function (el, key, value) {\n        el.style[key] = `${value}px`;\n      };\n\n      for (let i = 0, l = elements.length; i < l; i++) {\n        setCssStyle(elements[i], 'left', rect.left);\n        setCssStyle(elements[i], 'top', rect.top);\n        setCssStyle(elements[i], 'bottom', rect.bottom);\n        setCssStyle(elements[i], 'right', rect.right);\n        setCssStyle(elements[i], 'height', h);\n        setCssStyle(elements[i], 'width', w);\n      }\n    } else {\n      // Normal Operations\n      this.container.appendTo(this.element);\n    }\n\n    // Fade in shortly after adding the markup to the page\n    // (prevents the indicator from abruptly showing)\n    setTimeout(() => {\n      if (self.container) {\n        self.container.removeClass('is-hidden');\n      }\n      if (self.overlay) {\n        self.overlay.removeClass('is-hidden');\n      }\n\n      // Add in view from scroll parent.\n      if (self.blockUI) {\n        self.addScrollParent();\n      }\n    }, self.delay);\n\n    // Lets external code know that we've successully kicked off.\n    this.element.trigger('afterstart');\n\n    // Start the JS Animation Loop if IE9\n    if (!$.fn.cssPropSupport('animation')) {\n      self.isAnimating = true;\n      self.animateWithJS();\n    }\n\n    // Triggers complete if the \"timeToComplete\" option is set.\n    if (this.completionTime > 0) {\n      setTimeout(() => {\n        self.element.trigger('complete');\n      }, self.completionTime);\n    }\n  },\n\n  /**\n   * Removes the appended markup and hides any trace of the indicator.\n   * @param {boolean} fromEvent Designates the close is coming from an event (internal)\n   * @returns {void}\n   */\n  close(fromEvent) {\n    const self = this;\n\n    if (!self.isActive()) {\n      return; // safety, don't try and close this if not already active\n    }\n\n    this.removeScrollParent();\n\n    // If closed from an event, fire the necessary event triggers\n    // and removes the 'is-loading' CSS class.\n    if (fromEvent) {\n      this.element.removeClass('is-loading');\n      this.element.removeClass('is-blocked');\n    }\n\n    if (this.container) {\n      this.container.addClass('is-hidden');\n    }\n\n    if (this.overlay) {\n      this.overlay.addClass('is-hidden');\n    }\n\n    // Give the indicator time to fade out before removing all of its components from view\n    self.closeTimeout = setTimeout(() => {\n      clearTimeout(self.closeTimeout);\n      if (self.container) {\n        self.container.remove();\n      }\n\n      self.container = undefined;\n      self.loader = undefined;\n      self.label = undefined;\n\n      if (self.overlay) {\n        self.overlay.remove();\n        self.element[0].style.position = self.originalPositionProp;\n        self.originalPositionProp = undefined;\n      }\n      self.overlay = undefined;\n      self.element.trigger('aftercomplete.busyindicator');\n      self.element.off('complete.busyindicator');\n    }, 600);\n  },\n\n  /**\n   * Browsers that don't support CSS-based animation can still show the animating Busy Indicator.\n   * @private\n   */\n  animateWithJS() {\n    const self = this;\n    const bar1 = this.container.find('.bar.one');\n    const bar2 = this.container.find('.bar.two');\n    const bar3 = this.container.find('.bar.three');\n    const bar4 = this.container.find('.bar.four');\n    const bar5 = this.container.find('.bar.five');\n    let t = 0;\n    const interval = null;\n\n    // Animation Loop\n    function animate() {\n      if (!self.isAnimating) {\n        clearInterval(interval);\n        return;\n      }\n\n      t += 1;\n\n      if (t === 1) {\n        bar1.addClass('half');\n      }\n      if (t === 13) {\n        bar1.removeClass('half').addClass('full');\n        bar2.addClass('half');\n      }\n      if (t === 26) {\n        bar1.removeClass('full').addClass('half');\n        bar2.removeClass('half').addClass('full');\n        bar3.addClass('half');\n      }\n      if (t === 39) {\n        bar1.removeClass('half');\n        bar2.removeClass('full').addClass('half');\n        bar3.removeClass('half').addClass('full');\n        bar4.addClass('half');\n      }\n      if (t === 51) {\n        bar2.removeClass('half');\n        bar3.removeClass('full').addClass('half');\n        bar4.removeClass('half').addClass('full');\n        bar5.addClass('half');\n      }\n      if (t === 64) {\n        bar3.removeClass('half');\n        bar4.removeClass('full').addClass('half');\n        bar5.removeClass('half').addClass('full');\n      }\n      if (t === 77) {\n        bar4.removeClass('half');\n        bar5.removeClass('full').addClass('half');\n      }\n      if (t === 90) {\n        bar5.removeClass('half');\n      }\n\n      if (t === 103) {\n        t = 0;\n      }\n    }\n\n    setInterval(animate, 10);\n  },\n\n  /**\n   * Adjust top position, if any of the parents is scrollable\n   * @private\n   * @returns {void}\n   */\n  addScrollParent() {\n    if (this.blockUI) {\n      this.scrollParent = $(this.getScrollParent(this.element[0]));\n      const scrollParentHeight = this.scrollParent.length ? this.scrollParent.outerHeight() : 0;\n      if (scrollParentHeight && (scrollParentHeight < this.element.outerHeight())) {\n        const locTop = (scrollParentHeight / 2) - 58;\n        this.container.css({ top: locTop });\n\n        this.scrollParent\n          .off('scroll.parent.busyindicator')\n          .on('scroll.parent.busyindicator', () => {\n            const offset = locTop + this.scrollParent.scrollTop();\n            this.container.css({ top: offset });\n          });\n      }\n    }\n  },\n\n  /**\n   * Remove scroll parent.\n   * @private\n   * @returns {void}\n   */\n  removeScrollParent() {\n    if (this.scrollParent) {\n      this.scrollParent.off('scroll.parent.busyindicator');\n      delete this.scrollParent;\n    }\n  },\n\n  /**\n   * Get if any of the parents is scrollable.\n   * @private\n   * @param {object} elem to get scroll parent.\n   * @returns {object} the scroll parent.\n   */\n  getScrollParent(elem) {\n    const properties = ['overflow', 'overflow-x', 'overflow-y'];\n    const style = (el, prop) => getComputedStyle(el, null).getPropertyValue(prop);\n    const styleMerged = el => properties.reduce((a, b) => a + style(el, b), 0);\n    const regex = /(auto|scroll)/;\n    const isScroll = el => regex.test(styleMerged(el));\n    const scrollParent = (el) => {\n      let found = false;\n      let parent = el.parentNode;\n      while (!found && parent && parent.tagName && parent.tagName.toLowerCase() !== 'body') {\n        if (isScroll(parent)) {\n          found = true;\n          break;\n        }\n        parent = parent.parentNode;\n      }\n      return found ? parent : null;\n    };\n    return scrollParent(elem);\n  },\n\n  /**\n   * Update the component and apply current settings.\n   * @param {object} settings the settings to update to.\n   * @returns {this} component instance.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    return this.setup();\n  },\n\n  /**\n   * Returns if the indicator is active or not.\n   * @returns {boolean} If the busy indicator is active.\n   */\n  isActive() {\n    if (this.container) {\n      return this.container.children('.busy-indicator').is('.active');\n    }\n    return false;\n  },\n\n  /**\n   * Teardown and remove any added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.removeScrollParent();\n    this.close(true);\n    this.element.off('start.busyindicator complete.busyindicator afterstart.busyindicator aftercomplete.busyindicator updated.busyindicator');\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  handleEvents() {\n    const self = this;\n\n    /**\n    *  Fires when the indicator starts / shows.\n    *\n    * @event start\n    * @memberof BusyIndicator\n    * @param {object} event - The jquery event object.\n    */\n    self.element.on('start.busyindicator', (e) => {\n      e.stopPropagation();\n      this.activate();\n    })\n      .on('afterstart.busyindicator', () => {\n        /**\n         * Fires when the indicator is \"started\"\n         *\n         * @event complete\n         * @memberof BusyIndicator\n         * @param {object} event - The jquery event object.\n         * @param {object} ui - The dialog object\n         */\n        this.element.on('complete.busyindicator', (e) => {\n          e.stopPropagation();\n          this.close(true);\n        });\n      })\n      /**\n      * Sync the UI/Settings. Fx chnaging the text in the DOM.\n      * @event updated\n      * @memberof BusyIndicator\n      * @param {object} event - The jquery event object.\n      */\n      .on('updated.busyindicator', () => {\n        this.close(true);\n        this.updated();\n      });\n\n    return this;\n  },\n\n};\n\nexport { BusyIndicator, COMPONENT_NAME };\n","import { BusyIndicator, COMPONENT_NAME } from './busyindicator';\n\n/**\n * jQuery Component Wrapper for the BusyIndicator\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery-wrapped components being acted on\n */\n$.fn.busyindicator = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new BusyIndicator(this, settings));\n    }\n  });\n};\n","import { Environment as env } from '../../utils/environment';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { DOM } from '../../utils/dom';\nimport { theme } from '../theme/theme';\n\nconst charts = {};\n\n// Reference to the tooltip\ncharts.tooltip = {};\ncharts.isIE = env.browser.name === 'ie';\ncharts.isIEEdge = env.browser.name === 'edge';\n\n/**\n * Get the current height and widthe of the tooltip.\n * @private\n * @param  {string} content The tooltip content.\n * @returns {object} Object with the height and width.\n */\ncharts.tooltipSize = function tooltipSize(content) {\n  DOM.html(this.tooltip.find('.tooltip-content'), content, '*');\n  return { height: this.tooltip.outerHeight(), width: this.tooltip.outerWidth() };\n};\n\n/**\n * Format the value based on settings.\n * @private\n * @param  {object} data The data object.\n * @param  {object} settings The sttings to use\n * @returns {string} the formatted string.\n */\ncharts.formatToSettings = function formatToSettings(data, settings) {\n  const d = data.data ? data.data : data;\n\n  if (settings.show === 'value') {\n    return settings.formatter ? d3.format(settings.formatter)(d.value) : d.value;\n  }\n\n  if (settings.show === 'label') {\n    return d.name;\n  }\n\n  if (settings.show === 'label (percent)') {\n    return `${d.name} (${isNaN(d.percentRound) ? 0 : d.percentRound}%)`;\n  }\n\n  if (settings.show === 'label (value)') {\n    return `${d.name} (${settings.formatter ? d3.format(settings.formatter)(d.value) : d.value})`;\n  }\n\n  if (settings.show === 'percent') {\n    return `${isNaN(d.percentRound) ? 0 : d.percentRound}%`;\n  }\n\n  if (typeof settings.show === 'function') {\n    return settings.show(d);\n  }\n\n  return d.value;\n};\n\n/**\n* Add Toolbar to the page.\n* @private\n* @param {string} extraClass class to add (needed for pie)\n* @returns {void}\n*/\ncharts.appendTooltip = function appendTooltip(extraClass) {\n  this.tooltip = $('#svg-tooltip');\n  if (this.tooltip.length === 0) {\n    this.tooltip = $(`<div id=\"svg-tooltip\" class=\"tooltip ${extraClass} right is-hidden\">\n      <div class=\"arrow\"></div>\n        <div class=\"tooltip-content\">\n          <p><b>32</b> Element</p>\n        </div>\n      </div>`).appendTo('body');\n\n    if (this.isTouch) {\n      this.tooltip[0].style.pointerEvents = 'auto';\n      this.tooltip.on('touchend.svgtooltip', () => {\n        this.hideTooltip();\n      });\n    }\n  }\n};\n\n/**\n * Hide the visible tooltip.\n * @private\n * @returns {void}\n */\ncharts.hideTooltip = function hideTooltip() {\n  d3.select('#svg-tooltip').classed('is-hidden', true).style('left', '-999px');\n\n  // Remove scroll events\n  $('body, .scrollable').off('scroll.chart-tooltip', () => {\n    this.hideTooltip();\n  });\n};\n\n/**\n * Remove the tooltip from the DOM\n * @private\n * @returns {void}\n */\ncharts.removeTooltip = function removeTooltip() {\n  if (this.tooltip && this.tooltip.remove) {\n    this.tooltip.remove();\n  }\n};\n\n/**\n * The color sequences to use across charts\n * @private\n * @type {array}\n */\nconst palette = theme.themeColors().palette;\ncharts.colorRange = [\n  palette.azure['70'].value,\n  palette.turquoise['30'].value,\n  palette.amethyst['30'].value,\n  palette.graphite['60'].value,\n  palette.amber['50'].value,\n  palette.emerald['60'].value,\n  palette.ruby['60'].value,\n  palette.azure['30'].value,\n  palette.amber['90'].value,\n  palette.turquoise['80'].value,\n  palette.ruby['20'].value,\n  palette.graphite['50'].value,\n  palette.emerald['50'].value,\n  palette.azure['50'].value,\n  palette.amethyst['80'].value,\n  palette.emerald['30'].value,\n  palette.turquoise['50'].value,\n  palette.amber['70'].value,\n  palette.graphite['20'].value,\n  palette.azure['20'].value,\n  palette.emerald['100'].value,\n  palette.amethyst['20'].value\n];\n\ncharts.colorNameRange = ['azure07', 'turquoise03', 'amethyst03', 'graphite06', 'amber05', 'emerald06', 'ruby06',\n  'azure03', 'amber09', 'turquoise08', 'ruby02', 'graphite05', 'emerald05', 'amethyst03',\n  'azure05', 'amethyst08', 'emerald03', 'turquoise06', 'amber07', 'graphite02'];\n\n/**\n * The colors as an array for placement\n * @private\n * @type {array}\n */\ncharts.colors = typeof d3 !== 'undefined' ? d3.scaleOrdinal().range(charts.colorRange) : [];\ncharts.colorNames = typeof d3 !== 'undefined' ? d3.scaleOrdinal().range(charts.colorNameRange) : [];\n\n/**\n * Calculate and return the correct color to use. Fx\n * error, alert, alertYellow, good, neutral or hex.\n * @private\n * @param  {number} i The line/bar object index.\n * @param  {string} chartType The type of chart.\n * @param  {object} data The data for this element.\n * @returns {string} The hex code\n */\ncharts.chartColor = function chartColor(i, chartType, data) {\n  const specifiedColor = (data && data.color ? data.color : null);\n\n  // Handle passed in colors.\n  if (specifiedColor) {\n    if (specifiedColor === 'error') {\n      return '#e84f4f';\n    }\n    if (specifiedColor === 'alert') {\n      return '#ff9426';\n    }\n    if (specifiedColor === 'alertYellow') {\n      return '#ffd726';\n    }\n    if (specifiedColor === 'good') {\n      return '#80ce4d';\n    }\n    if (specifiedColor === 'neutral') {\n      return '#bdbdbd';\n    }\n    if (specifiedColor && specifiedColor.indexOf('#') === 0) {\n      return data.color;\n    }\n  }\n\n  // Some configuration by specific chart types\n  if (/^(pie|donut)$/.test(chartType)) {\n    return this.colorRange[i];\n  }\n  if (/^(bar-single|column-single)$/.test(chartType)) {\n    return '#1D5F8A';\n  }\n  if (/^(bar|bar-stacked|bar-grouped|bar-normalized|line|scatterplot|column-stacked|column-grouped|column-positive-negative)$/.test(chartType)) {\n    return this.colors(i);\n  }\n\n  return '';\n};\n\ncharts.chartColorName = function chartColor(i, chartType, data) {\n  const specifiedColor = (data && data.color ? data.color : null);\n\n  // Handle passed in colors.\n  if (specifiedColor) {\n    if (specifiedColor === 'error') {\n      return 'alert01';\n    }\n    if (specifiedColor === 'alert') {\n      return 'alert02';\n    }\n    if (specifiedColor === 'alertYellow') {\n      return 'alert03';\n    }\n    if (specifiedColor === 'good') {\n      return 'alert04';\n    }\n    if (specifiedColor === 'neutral') {\n      return 'graphite03';\n    }\n    if (specifiedColor && specifiedColor.indexOf('#') === 0) {\n      return data.color;\n    }\n  }\n\n  // Some configuration by specific chart types\n  if (/^(pie|donut)$/.test(chartType)) {\n    return this.colorNameRange[i];\n  }\n  if (/^(bar-single|column-single)$/.test(chartType)) {\n    return 'azure08';\n  }\n  if (/^(bar|bar-stacked|bar-grouped|bar-normalized|line|scatterplot|column-stacked|column-grouped|column-positive-negative)$/.test(chartType)) {\n    return this.colorNames(i);\n  }\n\n  return '';\n};\n\n/**\n * Show Tooltip\n * @private\n * @param  {number} x The x position.\n * @param  {number} y The y position.\n * @param  {string} content The tooltip contents.\n * @param  {string} arrow The arrow direction.\n */\ncharts.showTooltip = function (x, y, content, arrow) {\n  // Simple Collision of left side\n  if (x < 0) {\n    x = 2;\n  }\n\n  this.tooltip[0].style.left = `${x}px`;\n  this.tooltip[0].style.top = `${y}px`;\n  DOM.html(this.tooltip.find('.tooltip-content'), content, '*');\n\n  this.tooltip.removeClass('bottom top left right').addClass(arrow);\n  this.tooltip.removeClass('is-hidden');\n\n  // Hide the tooltip when the page scrolls.\n  $('body').off('scroll.chart-tooltip').on('scroll.chart-tooltip', () => {\n    this.hideTooltip();\n  });\n\n  $('.scrollable').off('scroll.chart-tooltip').on('scroll.chart-tooltip', () => {\n    this.hideTooltip();\n  });\n};\n\n/**\n * Add the legend to the Chart Container.\n * @private\n * @param  {array} series The groups series object.\n * @param  {string} chartType The type of chart.\n * @param  {object} settings The chart setting\n * @param  {object} container The dom container.\n * @returns {void}\n */\ncharts.addLegend = function (series, chartType, settings, container) {\n  let i;\n  if (series.length === 0) {\n    return;\n  }\n\n  const isTwoColumn = series[0].display && series[0].display === 'twocolumn';\n  let legend = isTwoColumn ? $(`<div class=\"chart-legend ${\n    series[0].placement ? `is-${series[0].placement}` : 'is-bottom'}\"></div>`) :\n    $('<div class=\"chart-legend\"></div>');\n\n  if ((chartType === 'pie' || chartType === 'donut') && settings.showMobile) {\n    legend = $('<div class=\"chart-legend\"><div class=\"container\"></div></div>');\n  }\n\n  // Legend width\n  let width = 0;\n  let currentWidth;\n\n  for (i = 0; i < series.length; i++) {\n    currentWidth = series[i].name.length * 6;\n    width = (series[i].name && currentWidth > width) ? currentWidth : width;\n  }\n\n  width += 55;\n  const widthPercent = width / $(container).width() * 100;\n\n  for (i = 0; i < series.length; i++) {\n    if (!series[i].name) {\n      continue; // eslint-disable-line\n    }\n\n    let extraClass = '';\n    if (isTwoColumn || (series[i].display && series[i].display === 'block')) {\n      extraClass += ' lg';\n    }\n    if (settings.type === 'column-positive-negative' && series[i].option) {\n      extraClass += ` ${series[i].option}`;\n    }\n\n    let seriesLine = `<span class=\"chart-legend-item${extraClass}\" tabindex=\"0\"></span>`;\n    const hexColor = charts.chartColor(i, chartType || (series.length === 1 ? 'bar-single' : 'bar'), series[i]);\n    const colorName = charts.chartColorName(i, chartType || (series.length === 1 ? 'bar-single' : 'bar'), series[i]);\n\n    let color = '';\n    if (colorName.substr(0, 1) === '#') {\n      color = $('<span class=\"chart-legend-color\"></span>');\n      if (!series[i].pattern) {\n        color.css('background-color', hexColor);\n      }\n    } else {\n      color = $(`<span class=\"chart-legend-color ${series[i].pattern ? '' : colorName}\"></span>`);\n    }\n\n    if (chartType === 'scatterplot') {\n      color = $('<span class=\"chart-legend-color\"></span>');\n    }\n    const textBlock = $(`<span class=\"chart-legend-item-text\">${xssUtils.stripTags(series[i].name)}</span>`);\n\n    if (series[i].pattern) {\n      color.append(`<svg width=\"12\" height=\"12\"><rect height=\"12\" width=\"12\" mask=\"url(#${series[i].pattern})\"/></svg>`);\n      color.find('rect').css('fill', hexColor);\n    }\n\n    if (series[i].percent) {\n      const pct = $('<span class=\"chart-legend-percent\"></span>').text(series[i].percent);\n      textBlock.append(pct);\n    }\n\n    if (series[i].display && series[i].display === 'block') {\n      seriesLine = `<span class=\"chart-legend-item${extraClass}\" tabindex=\"0\"></span>`;\n    }\n\n    if (isTwoColumn) {\n      if (widthPercent > 45 && settings.legendPlacement !== 'right') {\n        seriesLine = `<span class=\"chart-legend-item${extraClass}\" tabindex=\"0\"></span>`;\n      } else {\n        seriesLine = `<span class=\"chart-legend-item${extraClass} is-two-column\" tabindex=\"0\" ></span>`;\n      }\n    }\n    seriesLine = $(seriesLine);\n    seriesLine.append(color, textBlock);\n\n    if ((chartType === 'pie' || chartType === 'donut') && settings.showMobile) {\n      legend.find('.container').append(seriesLine);\n    } else {\n      legend.append(seriesLine);\n    }\n\n    if ((series[i].display && series[i].display === 'block') || (isTwoColumn && widthPercent > 45 && settings.legendPlacement !== 'right')) {\n      seriesLine.css({\n        float: 'none',\n        display: 'block',\n        margin: '0 auto',\n        width: `${width}px`,\n      });\n    }\n\n    // Add shapes\n    if (chartType === 'scatterplot') {\n      self.svg = d3.select(color[0]).append('svg')\n        .attr('width', '24')\n        .attr('height', '24')\n        .append('path')\n        .attr('class', 'symbol')\n        .attr('transform', 'translate(10, 10)')\n        .attr('d', d3.symbol().size('80').type( () => { return d3.symbols[i]; })) //eslint-disable-line\n        .style('fill', hexColor);\n    }\n\n    // Change text of legend depends of the width\n    if (innerWidth <= 480 && series[i].data && series[i].data.legendAbbrName) {\n      textBlock.replaceWith(`<span class=\"chart-legend-item-text\">${series[i].data.legendAbbrName}</span>`);\n    }\n    if (innerWidth >= 481 && innerWidth <= 768 && series[i].data\n      && series[i].data.legendShortName) {\n      textBlock.replaceWith(`<span class=\"chart-legend-item-text\">${series[i].data.legendShortName}</span>`);\n    }\n  }\n\n  if (legend instanceof $) {\n    legend.on('click.chart', '.chart-legend-item', function () {\n      charts.handleElementClick(this, series, settings);\n    }).on('keypress.chart', '.chart-legend-item', function (e) {\n      if (e.which === 13 || e.which === 32) {\n        charts.handleElementClick(this, series, settings);\n      }\n    });\n\n    $(container).append(legend);\n  }\n};\n\n/**\n * Helper Function to Select from legend click\n * @private\n * @param {object} line The element that was clicked.\n * @param {array} series The data series.\n * @param {object} settings [description]\n */\ncharts.handleElementClick = function (line, series, settings) {\n  const idx = $(line).index();\n  const elem = series[idx];\n  let selector;\n\n  if (settings.type === 'radar') {\n    selector = d3.select(settings.svg.selectAll('.chart-radar-area').nodes()[idx]);\n  }\n\n  if (settings.type === 'pie' || settings.type === 'donut') {\n    selector = d3.select(settings.svg.selectAll('.slice').nodes()[idx]);\n  } else if (settings.type === 'column-positive-negative') {\n    if (!elem.option || (elem.option && elem.option === 'target')) {\n      selector = settings.svg.select('.target-bar');\n    } else {\n      selector = settings.svg.select(`.bar.${elem.option}`);\n    }\n  } else if (['column', 'bar', 'bar-stacked', 'bar-grouped', 'bar-normalized', 'column-grouped', 'column-stacked', 'column-positive-negative'].indexOf(settings.type) !== -1) {\n    // Grouped or singlular\n    if (settings.isGrouped || settings.isSingle) {\n      selector = settings.svg.select(`.series-${idx}`);\n    } else if (settings.isStacked && !settings.isSingle) {\n      // Stacked\n      const thisGroup = d3.select(settings.svg.selectAll(settings.type === 'bar' || settings.type === 'bar-stacked' || settings.type === 'bar-normalized' ? '.series-group' : '.g').nodes()[idx]); // eslint-disable-line\n      selector = thisGroup.select('.bar');\n    }\n  }\n\n  if (['radar', 'pie', 'donut', 'column', 'bar', 'bar-stacked', 'bar-grouped', 'bar-normalized',\n    'column-grouped', 'column-stacked', 'column-positive-negative'].indexOf(settings.type) !== -1) {\n    charts.clickedLegend = true;\n    selector.on('click').call(selector.node(), selector.datum(), idx, true);\n  }\n\n  if (elem.selectionObj) {\n    charts.selectElement(d3.select(elem.selectionObj.nodes()[idx]), elem.selectionInverse, elem.data); // eslint-disable-line\n  }\n};\n\n// The selected array for this instance.\ncharts.selected = [];\n\n/**\n * Select the element and fire the event, make the inverse selector opace.\n * @private\n * @param  {object} element The DOM element\n * @param  {object} inverse The opposite selection.\n * @param  {array} data  The data object\n * @param  {object} container  The DOM object\n */\ncharts.selectElement = function (element, inverse, data, container) {\n  const isSelected = element.node() && element.classed('is-selected');\n  const triggerData = [{ elem: element.nodes(), data: (!isSelected ? data : {}) }];\n\n  inverse.classed('is-selected', false)\n    .classed('is-not-selected', !isSelected);\n\n  element.classed('is-not-selected', false)\n    .classed('is-selected', !isSelected);\n\n  charts.selected = $.isEmptyObject(triggerData[0].data) ? [] : triggerData;\n\n  // Fire Events\n  $(container).triggerHandler('selected', [triggerData]);\n};\n\n/**\n * Style bars as selected or unselected\n * TODO: Refactor into individual components;\n * @private\n * @param  {object} o The object to handle.\n */\ncharts.setSelectedElement = function (o) {\n  let dataset = o.dataset;\n  const isPositiveNegative = o.type === 'column-positive-negative';\n  const isBar = /^(bar|bar-stacked|bar-grouped|bar-normalized)$/.test(o.type);\n  const isTypePie = o.type === 'pie' || o.type === 'donut';\n  const isTypeColumn = /^(column|column-grouped|column-stacked|column-positive-negative)$/.test(o.type);\n\n  const svg = o.svg;\n  const isSingle = o.isSingle;\n  const isGrouped = o.isGrouped;\n  const isStacked = o.isStacked;\n\n  const taskSelected = (o.task === 'selected');\n  const selector = d3.select(o.selector);\n  const isPositive = selector.classed('positive');\n  const ticksX = o.svg.selectAll('.axis.x .tick');\n  const ticksY = o.svg.selectAll('.axis.y .tick');\n  const pnPositiveText = o.svg.selectAll('.bartext.positive, .target-bartext.positive');\n  const pnNegativeText = o.svg.selectAll('.bartext.negative, .target-bartext.negative');\n  const pnTargetText = o.svg.selectAll('.target-bartext.positive, .target-bartext.negative');\n  const thisGroup = d3.select(o.selector.parentNode);\n  const thisGroupId = parseInt((thisGroup.node() ? thisGroup.attr('data-group-id') : 0), 10);\n  let triggerData = [];\n  const selectedBars = [];\n  let thisData;\n\n  if (isStacked || isTypePie) {\n    dataset = dataset || null;\n  } else {\n    dataset = (dataset && dataset[thisGroupId]) ?\n      (dataset[thisGroupId].data || dataset[thisGroupId]) : null;\n  }\n\n  ticksX.style('font-weight', 'normal');\n  ticksY.style('font-weight', 'normal');\n  pnPositiveText.style('font-weight', 'normal');\n  pnNegativeText.style('font-weight', 'normal');\n  svg.selectAll('.is-selected').classed('is-selected', false);\n\n  if (isTypePie) {\n    svg.selectAll('.is-not-selected').classed('is-not-selected', false);\n  }\n\n  // Task make selected\n  if (taskSelected) {\n    svg.selectAll('.bar, .target-bar').style('opacity', 0.6);\n\n    // By legends only\n    if (charts.clickedLegend && !isTypePie) {\n      if (isPositiveNegative) {\n        if (o.isTargetBar) {\n          o.svg.selectAll('.target-bar').classed('is-selected', true).style('opacity', 1);\n\n          pnTargetText.style('font-weight', 'bolder');\n        } else {\n          o.svg.selectAll(isPositive ?\n            '.bar.positive, .target-bar.positive' : '.bar.negative, .target-bar.negative')\n            .classed('is-selected', true).style('opacity', 1);\n\n          (isPositive ? pnPositiveText : pnNegativeText).style('font-weight', 'bolder');\n        }\n\n        svg.selectAll('.bar').each(function (d, i) {\n          const bar = d3.select(this);\n          if (bar.classed('is-selected')) {\n            selectedBars.push({ elem: bar.node(), data: (dataset ? dataset[i] : d) });\n          }\n        });\n        triggerData = selectedBars;\n      } else if (isTypeColumn || isBar) {\n        // Grouped and stacked only -NOT singular-\n\n        if (isGrouped || isSingle) {\n          o.svg.selectAll('.series-' + o.i).classed('is-selected', true).style('opacity', 1); //eslint-disable-line\n        } else {\n          thisGroup.classed('is-selected', true)\n            .selectAll('.bar').classed('is-selected', true).style('opacity', 1);\n        }\n\n        svg.selectAll('.bar.is-selected').each(function (d, i) {\n          const bar = d3.select(this);\n\n          thisData = o.dataset;\n          if (!thisData) {\n            thisData = d;\n          }\n\n          if (isBar) {\n            if (thisData[0][o.i]) {\n              thisData = thisData[0][o.i];\n            }\n\n            if (thisData[o.i] && thisData[o.i][i]) {\n              thisData = thisData[o.i][i];\n            }\n\n            if (thisData[i] && thisData[i][o.i]) {\n              thisData = thisData[i][o.i];\n            }\n          } else {\n            if (thisData[0].data[o.i]) {\n              thisData = thisData[0].data[o.i];\n            }\n\n            if (thisData[o.i] && thisData[o.i].data[i]) {\n              thisData = thisData[o.i].data[i];\n            }\n\n            if (thisData[i] && thisData[i].data[o.i]) {\n              thisData = thisData[i].data[o.i];\n            }\n          }\n\n          selectedBars.push({ elem: bar.node(), data: thisData });\n        });\n        triggerData = selectedBars;\n      }\n    } else if (isSingle && isStacked && isTypeColumn) {\n      // Single and stacked only -NOT grouped-\n      thisData = dataset[0] && dataset[0].data ? dataset[0].data : o.d;\n      selector.classed('is-selected', true).style('opacity', 1);\n      triggerData.push({ elem: selector.nodes(), data: thisData[o.i] });\n    } else if ((isSingle || isGrouped) && !isStacked && (isTypeColumn || isBar)) {\n      // Single or groups only -NOT stacked-\n      svg.selectAll(`${isTypeColumn ? '.axis.x' : '.axis.y'} .tick:nth-child(${(isGrouped ? thisGroupId : o.i) + 2})`)\n        .style('font-weight', 'bolder');\n\n      selector.classed('is-selected', true).style('opacity', 1);\n\n      if (isPositiveNegative) {\n        const thisIndex = o.isTargetBar ? o.i : o.i - o.dataset[0].data.length;\n        svg.select(`.target-bar.series-${thisIndex}`).classed('is-selected', true).style('opacity', 1);\n        svg.select(`.bar.series-${thisIndex}`).classed('is-selected', true).style('opacity', 1);\n\n        d3.select(svg.selectAll('.bartext').nodes()[thisIndex]).style('font-weight', 'bolder');\n        d3.select(svg.selectAll('.target-bartext').nodes()[thisIndex]).style('font-weight', 'bolder');\n      }\n\n      if (isGrouped || isPositiveNegative || isTypeColumn) {\n        if (!isPositiveNegative && !isTypeColumn || (isTypeColumn && isGrouped)) {\n          thisGroup.classed('is-selected', true)\n            .selectAll('.bar').classed('is-selected', true).style('opacity', 1);\n        }\n\n        thisGroup.selectAll('.bar').each(function (d, i) {\n          const bar = d3.select(this);\n          if (bar.classed('is-selected')) {\n            selectedBars.push({ elem: bar.node(), data: (dataset ? dataset[i] : d) });\n          }\n        });\n        if (isGrouped) {\n          triggerData.push({\n            groupIndex: thisGroupId,\n            groupElem: thisGroup.nodes()[0],//eslint-disable-line\n            groupItems: selectedBars\n          });\n        } else {\n          triggerData = selectedBars;\n        }\n      }\n    } else if (isTypeColumn || isBar) {\n      // Stacked Only\n      svg.selectAll(`${isTypeColumn ? '.axis.x' : '.axis.y'} .tick:nth-child(${o.i + 2})`)\n        .style('font-weight', 'bolder');\n\n      svg.selectAll(`.bar:nth-child(${o.i + 1})`)\n        .classed('is-selected', true).style('opacity', 1);\n\n      svg.selectAll('.bar.is-selected').each(function (d, i) {\n        const bar = d3.select(this);\n        let data = d;\n        if (dataset) {\n          data = isBar && isStacked ? dataset[i][o.i] : dataset[i].data[o.i];\n        }\n        selectedBars.push({ elem: bar.node(), data });\n      });\n      triggerData = selectedBars;\n    } else if (isTypePie) { // Pie\n      // Unselect selected ones\n      svg.selectAll('.slice')\n        .classed('is-selected', false)\n        .classed('is-not-selected', true)\n        .attr('transform', '');\n\n      const thisArcData = dataset && dataset[0] && dataset[0].data ?  //eslint-disable-line\n        dataset[0].data[o.i] : (o.d ? o.d.data : o.d);  //eslint-disable-line\n\n      selector.classed('is-selected', true)\n        .classed('is-not-selected', false)\n        .attr('transform', 'scale(1.025, 1.025)');\n      triggerData.push({ elem: selector.nodes(), data: thisArcData, index: o.i });\n    }\n  } else {\n    // Task make unselected\n    svg.selectAll('.bar, .target-bar').style('opacity', 1);\n    pnPositiveText.style('font-weight', 'bolder');\n    pnNegativeText.style('font-weight', 'bolder');\n\n    if (isTypePie) {\n      selector.classed('is-selected', false)\n        .style('stroke', '#fff')\n        .style('stroke-width', '1px')\n        .attr('transform', '');\n    }\n  }\n\n  if (charts.clickedLegend) {\n    charts.clickedLegend = false;\n  }\n\n  charts.selected = triggerData;\n\n  if (o.isTrigger) {\n    $(o.container).triggerHandler((taskSelected ? 'selected' : 'unselected'), [triggerData]);\n  }\n};\n\n/**\n * Set the select element based on provided options and fire the events.\n * @private\n * @param {object} o An object with various\n * @param {boolean} isToggle If the select is a toggle of the state\n * @param {object} internals An object passing in chart internals\n*/\ncharts.setSelected = function (o, isToggle, internals) {\n  if (!o) {\n    return;\n  }\n\n  let selected = 0;\n  const equals = utils.equals;\n  const legendsNode = internals.isPie ? internals.svg.node().nextSibling :\n    internals.svg.node().parentNode.nextSibling;\n  const legends = d3.select(legendsNode);\n  const isLegends = legends.node() && legends.classed('chart-legend');\n  let barIndex;\n  let selector;\n  let isStackedGroup;\n  let xGroup;\n\n  const setSelectedBar = function (g) {\n    const isGroup = !!g;\n    g = isGroup ? d3.select(g) : internals.svg;\n    g.selectAll('.bar').each(function (d, i) {\n      if (!d) {\n        return;\n      }\n      if (selected < 1) {\n        if ((typeof o.fieldName !== 'undefined' &&\n              typeof o.fieldValue !== 'undefined' &&\n                o.fieldValue === d[o.fieldName]) ||\n            (typeof o.index !== 'undefined' && o.index === i) ||\n            (o.data && equals(o.data, internals.chartData[d.index].data[i])) ||\n            (o.elem && $(this).is(o.elem))) {\n          selected++;\n          selector = d3.select(this);\n          barIndex = i;\n          if (isGroup && !internals.isStacked) {\n            isStackedGroup = true;\n          }\n        }\n      }\n    });\n  };\n\n  const setSelectedGroup = function () {\n    const groups = internals.svg.selectAll('.series-group');\n\n    if (groups.nodes().length) {\n      groups.each(function () {\n        setSelectedBar(this);\n      });\n    }\n  };\n\n  if (internals.isGrouped || (internals.isStacked && !internals.isSingle)) {\n    internals.chartData.forEach(function(d, i) {  //eslint-disable-line\n      if (selected < 1) {\n        xGroup = $(internals.svg.select('[data-group-id=\"' + i + '\"]').node()); //eslint-disable-line\n        if ((typeof o.groupName !== 'undefined' &&\n              typeof o.groupValue !== 'undefined' &&\n                o.groupValue === d[o.groupName]) ||\n            (typeof o.groupIndex !== 'undefined' && o.groupIndex === i) ||\n            (o.data && equals(o.data, d)) ||\n            (o.elem && (xGroup.is(o.elem)))) {\n          if (typeof o.fieldName === 'undefined' &&\n                typeof o.fieldValue === 'undefined' &&\n                  typeof o.index === 'undefined') {\n            selected++;\n            selector = internals.svg.select('[data-group-id=\"' + i + '\"]').select('.bar'); //eslint-disable-line\n            barIndex = i;\n\n            if (internals.isStacked && !internals.isGrouped) {\n              isStackedGroup = true;\n            }\n          }\n        }\n      }\n    });\n    if (selected < 1) {\n      setSelectedGroup();\n    }\n  } else {\n    setSelectedBar();\n  }\n\n  if (selected > 0 && (isToggle || !selector.classed('is-selected'))) {\n    if (isStackedGroup) {\n      if (isLegends) {\n        $(legends.selectAll('.chart-legend-item').nodes()[barIndex]).trigger('click.chart');\n      }\n    } else {\n      selector.on('click').call(selector.node(), selector.datum(), barIndex);\n    }\n  }\n};\n\n/**\n * Check if the labels collide.\n * @private\n * @param {object} svg The svg dom element.\n * @returns {boolean} True if the labels collide.\n*/\ncharts.labelsColide = function (svg) {\n  const ticks = svg.selectAll('.x text');\n  let collides = false;\n\n  ticks.each(function (d1, i) {\n    const rect1 = this.getBoundingClientRect();\n    let rect2;\n\n    ticks.each(function (d2, j) {\n      if (i !== j) {\n        rect2 = this.getBoundingClientRect();\n\n        const overlaps = !(rect1.right < rect2.left ||\n          rect1.left > rect2.right ||\n          rect1.bottom < rect2.top ||\n          rect1.top > rect2.bottom);\n\n        if (overlaps) {\n          collides = true;\n        }\n      }\n    });\n  });\n\n  return collides;\n};\n\n/**\n * Apply a different length label\n * @private\n * @param  {object}  svg  The svg element.\n * @param  {array}  dataArray The data.\n * @param  {object}  elem The dom element\n * @param  {object}  selector The d3 selection\n * @param  {boolean} isNoEclipse True if its an eclipse.\n */\ncharts.applyAltLabels = function (svg, dataArray, elem, selector, isNoEclipse) {\n  const ticks = selector ? svg.selectAll(selector) : svg.selectAll('.x text');\n\n  ticks.each(function (d1, i) {\n    let text = dataArray[i] ? dataArray[i][elem] : '';\n\n    text = text || (isNoEclipse ?\n      ((d3.select(this).text().substring(0, 1))) :\n      (`${d3.select(this).text().substring(0, 6)}...`));\n\n    d3.select(this).text(text);\n  });\n};\n\n/**\n * Trigger the right click event.\n * @private\n * @param  {object} container  The svg container.\n * @param  {object} elem The element that was right clicked.\n * @param  {object} d The data object\n */\ncharts.triggerContextMenu = function (container, elem, d) {\n  d3.event.preventDefault();\n  d3.event.stopPropagation();\n  d3.event.stopImmediatePropagation();\n\n  const e = $.Event('contextmenu');\n  e.target = elem;\n  e.pageX = d3.event.pageX;\n  e.pageY = d3.event.pageY;\n  $(container).trigger(e, [elem, d]);\n};\n\n/**\n * Wraps SVG text http://bl.ocks.org/mbostock/7555321\n * @private\n * @param {object} node  The svg element.\n * @param {number}  width The width at which to wrap\n * @param {object} labelFactor The dom element\n */\ncharts.wrap = function (node, width, labelFactor) {\n  if (!labelFactor) {\n    labelFactor = 1.27;\n  }\n\n  if (!width) {\n    labelFactor = 60;\n  }\n\n  node.each(function () {\n    const text = d3.select(this);\n    const words = text.text().split(/\\s+/).reverse();\n    let word = '';\n    let line = [];\n    let lineNumber = 0;\n\n    if (words.length <= 1) {\n      return;\n    }\n\n    const lineHeight = labelFactor; // ems\n    const y = text.attr('y');\n    const x = text.attr('x');\n    const dy = parseFloat(text.attr('dy'));\n    let tspan = text.text(null).append('tspan')\n      .attr('x', x)\n      .attr('y', y)\n      .attr('dy', `${dy}em`);\n\n    while (word = words.pop()) {    //eslint-disable-line\n      line.push(word);\n      tspan.text(line.join(' '));\n\n      if (tspan.node().getComputedTextLength() > width) {\n        line.pop();\n        tspan.text(line.join(' '));\n        line = [word];\n        tspan = text.append('tspan')\n          .attr('x', x)\n          .attr('y', y)\n          .attr('dy', `${++lineNumber * lineHeight + dy}em`)\n          .text(word);\n      }\n    }\n  });\n};\n\nexport { charts };\n","/* eslint-disable no-loop-func */\n\n// Other Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { charts } from '../charts/charts';\n\n// Settings and Options\nconst COMPONENT_NAME = 'bullet';\n\n/**\n * A bullet graph is a variation of a bar graph developed by Stephen Few.\n * Seemingly inspired by the traditional thermometer charts and progress bars found in many\n * dashboards, the bullet graph serves as a replacement for dashboard gauges and meters.\n * @class Bullet\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings] The settings element.\n * @param {array} [settings.dataset.data] The data to use in the chart.\n * @param {array} [settings.dataset.data.tooltip] Tooltip contents for each point.\n * @param {boolean|string} [settings.animate=true] true|false - will do or not do the animation, 'initial' will do only first time the animation.\n * @param {boolean} [settings.redrawOnResize=true] If true, the component will not resize when resizing the page.\n */\nconst BULLET_DEFAULTS = {\n  dataset: [],\n  animate: true,\n  redrawOnResize: true\n};\n\nfunction Bullet(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, BULLET_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nBullet.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The bullet chart prototype for chaining.\n   */\n  init() {\n    this.width = 0;\n\n    // Do initialization. Build or Events ect\n    this\n      .build()\n      .handleEvents();\n\n    // Handle initial option\n    if (this.settings.animate === 'initial') {\n      this.settings.animate = false;\n    }\n\n    return this;\n  },\n\n  /**\n   * Build the Bullet Chart.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  build() {\n    const chartData = this.settings.dataset[0];\n    this.element.addClass('bullet-chart');\n\n    let tooltipInterval = 0;\n    const tooltipDataCache = [];\n    let tooltipData = chartData.data[0] ? chartData.data[0].tooltip : [];\n\n    // Append the SVG into its parent area.\n    let noMarkers = false;\n    const parent = this.element.parent();\n    const margin = { top: 30, right: 35, bottom: 35, left: 40 };\n    const width = parent.width() - margin.left - margin.right;\n    let height = parent.height() - margin.top - margin.bottom - 30; // 30 for legend\n\n    height = height < 0 ? 50 : height; // default minimum height\n\n    const svg = d3.select(this.element[0]).append('svg')\n      .attr('width', width + margin.left + margin.right)\n      .attr('height', height + margin.top + margin.bottom)\n      .append('g')\n      .attr('transform', `translate(${margin.left},${margin.top})`);\n\n    function bulletWidth(x) {\n      const x0 = x(0);\n      return function (d) {\n        return Math.abs(x(d) - x0);\n      };\n    }\n\n    for (let i = 0; i < chartData.data.length; i++) {\n      const duration = this.settings.animate ? 600 : 0;\n      const barHeight = 20;\n      const self = this;\n      const rowData = chartData.data[i];\n      const ranges = rowData.ranges.slice().sort(d3.descending);\n      let markers = (rowData.markers ? rowData.markers.slice().sort(d3.descending) : []);\n      const measures = (rowData.measures ? rowData.measures.slice().sort(d3.descending) : []);\n      const rangesAsc = rowData.ranges.slice().sort(d3.ascending);\n      let markersAsc = (rowData.markers ? rowData.markers.slice().sort(d3.ascending) : []);\n      const measuresAsc = (rowData.measures ? rowData.measures.slice().sort(d3.ascending) : []);\n\n      if (markers.length === 0) {\n        markers = measures;\n        markersAsc = measuresAsc;\n        noMarkers = true;\n      }\n\n      const g = svg.append('g')\n        .attr('class', 'bullet')\n        .attr('transform', `translate(0, ${i * (barHeight * 3.5)})`);\n\n      // Add Title and Subtitle\n      const title = g.append('g');\n\n      const text = title.append('text')\n        .attr('class', 'title')\n        .attr('dy', '-10px')\n        .text(() => rowData.title);\n\n      text.append('tspan')\n        .attr('class', 'subtitle')\n        .attr('dx', '15px')\n        .text(() => rowData.subtitle);\n\n      const maxAll = Math.max(ranges[0], markers[0], measures[0]);\n      let minAll = Math.min(rangesAsc[0], markersAsc[0], measuresAsc[0]);\n\n      minAll = minAll < 0 ? minAll : 0;\n\n      // Compute the new x-scale.\n      const x1 = d3.scaleLinear()\n        .domain([minAll, maxAll])\n        .range([0, width])\n        .nice();\n\n      // Derive width-scales from the x-scales.\n      const w1 = bulletWidth(x1);\n\n      // Update the range rects.\n      const range = g.selectAll('rect.range')\n        .data(ranges);\n\n      range.enter().append('rect')\n        .attr('class', (d, a) => `range s${a}`)\n        .attr('data-idx', i)\n        .attr('width', 0)\n        .attr('x', d => x1(d < 0 ? d : 0))\n        .style('fill', (d, b) => {\n          if (chartData.barColors) {\n            return chartData.barColors[b];\n          }\n          return '';\n        })\n        .attr('height', barHeight)\n        .on('click', function () {\n          const bar = d3.select(this);\n          self.element.trigger('selected', [bar, chartData.data[bar.attr('data-idx')]]);\n        })\n        .on('mouseenter', function (d, mouseEnterIdx) {\n          const bar = d3.select(this);\n          const data = chartData.data[bar.attr('data-idx')];\n          const rect = this.getBoundingClientRect();\n          let content = `<p>${d}</p>`;\n\n          const show = function () {\n            const size = charts.tooltipSize(content);\n            const x = rect.left + rect.width - (size.width / 2);\n            const y = rect.top - size.height + $(window).scrollTop() - 5;\n\n            if (content !== '') {\n              charts.showTooltip(x, y, content, 'top');\n            }\n          };\n\n          if (data.tooltip && data.tooltip[mouseEnterIdx]) {\n            content = data.tooltip[data.tooltip.length - mouseEnterIdx - 1];\n          }\n\n          if (tooltipData && typeof tooltipData === 'function' && !tooltipDataCache[mouseEnterIdx]) {\n            content = '';\n            let runInterval = true;\n            tooltipInterval = setInterval(() => {\n              if (runInterval) {\n                runInterval = false;\n                tooltipData((da) => {\n                  content = da;\n                  tooltipDataCache[i] = da;\n                });\n              }\n              if (content !== '') {\n                clearInterval(tooltipInterval);\n                show();\n              }\n            }, 10);\n          } else {\n            tooltipData = typeof tooltipData === 'object' ? '' : tooltipData;\n            content = tooltipDataCache[i] || tooltipData || content || '';\n            show();\n          }\n        })\n        .on('mouseleave', () => {\n          clearInterval(tooltipInterval);\n          charts.hideTooltip();\n        })\n        .merge(range)\n        .transition()\n        .duration(duration)\n        .attr('width', w1);\n\n      // Update the measure rects.\n      const measure = g.selectAll('rect.measure')\n        .data(measures);\n\n      measure.enter().append('rect')\n        .attr('class', (d, k) => `measure s${k}`)\n        .attr('width', 0)\n        .attr('height', 3)\n        .attr('x', d => x1(d < 0 ? d : 0))\n        .style('fill', (d, j) => {\n          if (chartData.lineColors) {\n            return chartData.lineColors[j];\n          }\n          return '';\n        })\n        .attr('y', 8.5)\n        .merge(measure)\n        .transition()\n        .duration(duration)\n        .attr('width', w1);\n\n      // Update the marker lines.\n      const marker = g.selectAll('line.marker')\n        .data(markers);\n\n      marker.enter().append('line')\n        .attr('class', (noMarkers ? 'hidden' : 'marker'))\n        .attr('x1', 0)\n        .attr('x2', 0)\n        .style('stroke', (d, l) => {\n          if (chartData.markerColors) {\n            return chartData.markerColors[l];\n          }\n          return '';\n        })\n        .attr('y1', barHeight / 6)\n        .attr('y2', barHeight * 5 / 6)\n        .merge(marker)\n        .transition()\n        .duration(duration)\n        .attr('x1', x1)\n        .attr('x2', x1)\n        .attr('y1', barHeight / 6)\n        .attr('y2', barHeight * 5 / 6);\n\n      // Difference\n      const diff = (markers[0] > measures[0] ? '-' : '+') + Math.abs(markers[0] - measures[0]);\n\n      if (Math.abs(markers[0] - measures[0]) !== 0) {\n        marker.enter().append('text')\n          .attr('class', 'inverse')\n          .attr('text-anchor', 'middle')\n          .attr('y', barHeight / 2 + 4)\n          .attr('dx', charts.isRTL ? '-20px' : '20px')\n          .attr('x', 0)\n          .text(diff)\n          .merge(marker)\n          .transition()\n          .duration(duration)\n          .attr('x', () => {\n            let total = 0;\n\n            g.selectAll('.measure').each((d) => {\n              const w = w1(d);\n              const x = x1(d);\n\n              if (w > total) {\n                total = w;\n              }\n\n              if (x > total) {\n                total = x;\n              }\n            });\n\n            return charts.isRTL ? -total : total;\n          })\n          .style('opacity', 1);\n      }\n\n      // Update the tick groups.\n      const tick = g.selectAll('g.tick')\n        .data(x1.ticks(8));\n\n      // Initialize the ticks with the old scale, x0.\n      const tickEnter = tick.enter().append('g')\n        .attr('class', 'tick')\n        .attr('transform', 'translate(0,0)')\n        .style('opacity', 0);\n\n      tickEnter.append('line')\n        .attr('y1', barHeight)\n        .attr('y2', Math.round((barHeight * 7) / 4.7));\n\n      tickEnter.append('text')\n        .attr('text-anchor', 'middle')\n        .attr('dy', '1.1em')\n        .attr('y', Math.round((barHeight * 7) / 4.7))\n        .attr('class', d => (d < 0 ? 'negative-value' : 'positive-value'))\n        .text(d => d);\n\n      // Transition the entering ticks to the new scale, x1\n      tickEnter.transition()\n        .duration(duration)\n        .attr('transform', d => `translate(${x1(d)},0)`)\n        .style('opacity', 1);\n\n      if (charts.isRTL && charts.isIE) {\n        svg.selectAll('text').attr('transform', 'scale(-1, 1)');\n      }\n    }\n\n    charts.appendTooltip();\n    this.element.trigger('rendered');\n\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    if (this.settings.redrawOnResize) {\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n\n      this.element.on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n    }\n\n    return this;\n  },\n\n  /*\n   * Handles resizing a chart.\n   * @private\n   * @returns {void}\n   */\n  handleResize() {\n    if (this.width === this.element.width()) {\n      return;\n    }\n\n    this.width = this.element.width();\n\n    if (!this.element.is(':visible')) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n    this.element.empty();\n\n    return this\n      .build();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME} resize.${COMPONENT_NAME}`);\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('bullet-chart');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'chart');\n  }\n};\n\nexport { Bullet, COMPONENT_NAME };\n","// Other Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\n\n// Settings and Options\nconst COMPONENT_NAME = 'completion-chart';\n\n/**\n* A completion chart shows completion over a target value. Usually used to show progress as a percentage.\n* @class CompletionChart\n* @param {string} element The plugin element for the constuctor\n* @param {string} [settings] The settings element.\n*\n* @param {array} [settings.dataset.data] The data to use in the chart (See examples)\n* @param {string} [settings.dataset.data.name] - Required object with the title text `{text: 'Available Credit'}`\n* @param {number} [settings.dataset.data.completed] - Required data for the complete section `{text: 'Spent', value: 50000, format: '$,.0f'}`\n* @param {array} [settings.dataset.data.remaining] - Required data for the remaining section `{text: 'Pending', value: 10000, format: '$,.0f'}`\n* @param {array} [settings.dataset.data.total] - Optional data for the total section `{value: 95000, format: '$,.0f'}`\n*/\n\nconst COMPLETION_CHART_DEFAULTS = {\n  dataset: []\n};\n\nfunction CompletionChart(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, COMPLETION_CHART_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nCompletionChart.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The completion chart prototype for chaining.\n   */\n  init() {\n    // Do initialization. Build or Events ect\n    this\n      .build()\n      .handleEvents();\n\n    return this;\n  },\n\n  /**\n   * Build the Completion Chart.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  build() {\n    let chartData = this.settings.dataset[0];\n\n    // Handle Empty Data Set\n    if (this.settings.dataset.length === 0) {\n      chartData = {};\n      chartData.data = [{\n        name: { text: Locale ? Locale.translate('NoData') : 'No Data Available' },\n        completed: { value: 0 },\n      }];\n    }\n\n    const dataset = chartData.data[0];\n    const isTarget = this.settings.type === 'completion-target';\n    const isAchievment = this.settings.type === 'targeted-achievement';\n\n    $(this.element).addClass(`completion-chart${\n      this.settings.type === 'targeted-achievement' ? ' chart-targeted-achievement' : ''}`);\n\n    // Set total defaults\n    dataset.total = $.extend({}, { value: 100 }, dataset.total);\n\n    // Basic functions\n    const isUndefined = function (value) {\n      return typeof value === 'undefined';\n    };\n\n    const fixUndefined = function (value, isNumber) {\n      const defaultValue = (isNumber ? 0 : '');\n      return !isUndefined(value) ? value : defaultValue;\n    };\n\n    const toValue = function (percent, ds) {\n      ds = ds || dataset;\n      return percent / 100 * fixUndefined(ds.total.value, true);\n    };\n\n    const toPercent = function (value, ds) {\n      ds = ds || dataset;\n      return Math.round(100 * (value / fixUndefined(ds.total.value, true)));\n    };\n\n    const localePercent = function (value) {\n      return Locale.formatNumber(value / 100, { style: 'percent', maximumFractionDigits: 0 });\n    };\n\n    const format = function (value, formatterString, ds) {\n      if (formatterString === '.0%') {\n        return localePercent(toPercent(value, ds));\n      }\n      return d3.format(formatterString || '')(value);\n    };\n\n    const fixPercent = function (value, ds) {\n      const s = value.toString();\n      if (s.indexOf('%') !== -1) {\n        return toValue(s.replace(/%/g, ''), ds);\n      }\n      return value;\n    };\n\n    const updateWidth = function (elem, value, ds) {\n      let percent = toPercent(value, ds);\n      percent = (percent < 0 ? 0 : percent);\n      const w = percent > 100 ? 100 : percent;\n      elem[0].style.width = `${w}%`;\n\n      if (w === 0) {\n        elem[0].className += 'is-empty';\n      }\n    };\n\n    const updateTargetline = function (elem, value) {\n      const min = (value < 0 ? 0 : value);\n      const w = value > 100 ? 100 : min;\n      elem[0].style.left = `${w}%`;\n    };\n\n    const setFormat = function (obj, ds, isPrivate) {\n      const value = isPrivate ? obj._value : obj.value; //eslint-disable-line\n      return (obj && !isUndefined(value) && obj.format) ? //eslint-disable-line\n        format(fixPercent(value, ds), obj.format, ds) : //eslint-disable-line\n        (obj ? fixPercent(value, ds) : 0);\n    };\n\n    const self = this;\n\n    const setOverlap = function () {\n      if (isTarget && !isAchievment) {\n        setTimeout(() => {\n          const remaining = $('.remaining', self.element);\n          const total = $('.total', self.element);\n          const rect1 = $('.completed .value', self.element)[0].getBoundingClientRect();\n          const rect2 = remaining.find('.value')[0].getBoundingClientRect();\n\n          remaining.add(total)[(rect1.right > rect2.left - 20) ? 'addClass' : 'removeClass']('overlap');\n        }, 500);\n      }\n    };\n\n    const getSpecColor = function (ds) {\n      const specColor = {};\n      ds = ds || dataset;\n\n      if (ds.info && !isUndefined(ds.info.color)) {\n        if (dataset.info.color.indexOf('#') === 0) {\n          specColor.info = true;\n        }\n      }\n      if (ds.completed && !isUndefined(ds.completed.color)) {\n        if (ds.completed.color.indexOf('#') === 0) {\n          specColor.completed = true;\n        }\n      }\n      if (ds.remaining && !isUndefined(ds.remaining.color)) {\n        if (ds.remaining.color.indexOf('#') === 0) {\n          specColor.remaining = true;\n        }\n      }\n      if (ds.targetline && !isUndefined(ds.targetline.color)) {\n        if (ds.targetline.color.indexOf('#') === 0) {\n          specColor.targetline = true;\n        }\n      }\n      return specColor;\n    };\n\n    const getTotalText = function (ds) {\n      let totalText = '';\n      const difference = {};\n\n      ds = ds || dataset;\n\n      if (ds.total.difference) {\n        difference.value = (ds.total.value - ds.completed.value);\n        difference.format = dataset.total.format;\n      }\n\n      totalText = (!ds.total.textOnly ? setFormat(ds.total.difference ? difference : ds.total) : '') + (ds.total.text || '');\n\n      totalText = isAchievment && ds.remaining ?\n        (!ds.remaining.textOnly ? setFormat(ds.remaining) : '') + (ds.remaining.text || '') : totalText;\n\n      return totalText;\n    };\n\n    const percentTextDefault = { show: false, color1: '', color2: 'inverse' };\n    const percentText = $.extend({}, percentTextDefault, dataset.percentText);\n    const setPercentText = function (ds) {\n      ds = ds || dataset;\n      percentText._value = ds.completed ? ds.completed.value : 0; //eslint-disable-line\n      percentText.percent = toPercent(fixUndefined(percentText._value, true), ds); //eslint-disable-line\n      percentText.format = '.0%';\n      percentText._text = (typeof percentText.text !== 'undefined' ? //eslint-disable-line\n        percentText.text : (typeof percentText.value !== 'undefined' ? //eslint-disable-line\n          localePercent(percentText.value) : setFormat(percentText, ds, true)));\n      percentText.color = percentText[percentText.percent > 55 ? 'color2' : 'color1'];\n    };\n\n    let c; // Cache will after created\n\n    const cacheElements = () => {\n      c = {\n        name: $('.name', this.element),\n        info: {\n          value: $('.info .value', this.element),\n          text: $('.info .text', this.element)\n        },\n        completed: {\n          bar: $('.completed.bar', this.element),\n          value: $('.completed .value', this.element),\n          text: $('.completed .text, .completed-label .text', this.element)\n        },\n        remaining: {\n          bar: $('.remaining.bar', this.element),\n          value: $('.remaining .value', this.element),\n          text: $('.remaining .text', this.element)\n        },\n        targetline: {\n          bar: $('.targetline', this.element),\n          value: $('.targetline .value', this.element),\n          text: $('.targetline .text', this.element)\n        },\n        total: {\n          bar: $('.total.bar', this.element),\n          value: $('.total.value', this.element),\n        },\n        percentText: $('.chart-percent-text', this.element)\n      };\n    };\n\n    const setJsonData = function (ds) {\n      ds = ds || dataset;\n      c.name.data('jsonData', { name: ds.name });\n      c.info.value.add(c.info.text).data('jsonData', { info: ds.info });\n      c.completed.bar.add(c.completed.value).add(c.completed.text)\n        .data('jsonData', { completed: ds.completed });\n      c.remaining.bar.add(c.remaining.value).add(c.remaining.text)\n        .data('jsonData', { remaining: ds.remaining });\n      c.targetline.bar.add(c.targetline.value).add(c.targetline.text)\n        .data('jsonData', { targetline: ds.targetline });\n      c.total.bar.add(c.total.value).data('jsonData', { total: ds.total });\n      c.percentText.data('jsonData', { percentText: ds.percentText });\n    };\n\n    const updateBars = function (ds) {\n      let w;\n      ds = ds || dataset;\n      // Update completed bar width\n      if (ds.completed) {\n        w = fixPercent(ds.completed.value, ds);\n        updateWidth(c.completed.bar, w, ds);\n      }\n\n      // Update remaining bar width\n      if (ds.remaining) {\n        w = fixPercent(ds.completed.value, ds) + fixPercent(ds.remaining.value, ds);\n        updateWidth(c.remaining.bar, w, ds);\n        setOverlap();\n      }\n\n      // Update target line bar position\n      if (ds.targetline) {\n        w = fixPercent(ds.targetline.value, ds);\n        updateTargetline(c.targetline.bar, w, ds);\n      }\n    };\n\n    if (!isUndefined(percentText.color) && percentText.color1 === '') {\n      percentText.color1 = percentText.color;\n    }\n\n    // Render\n    const html = { body: $('<div class=\"total bar\" />') };\n    const specColor = getSpecColor();\n\n    if (isTarget || isAchievment) {\n      const totalText = getTotalText();\n\n      html.body.addClass(`chart-completion-target${isAchievment ? ' chart-targeted-achievement' : ''}`);\n\n      html.label = `<span class=\"label\">\n        <span class=\"name\">\n          ${dataset.completed.color && dataset.completed.color === 'error' ? $.createIcon({ icon: 'error', classes: 'icon-error' }) : ''}\n          ${fixUndefined(dataset.name.text)}</span>\n        <span class=\"l-pull-right total value\">${totalText}</span>\n      </span>`;\n    } else {\n      html.body.addClass('chart-completion');\n      const name = fixUndefined(dataset.name.text);\n      const completedColor = fixUndefined(dataset.completed.color);\n      const infoColor = fixUndefined(dataset.info.color);\n      let bColor = dataset.info.color && !specColor.info ? infoColor : '';\n      const infoText = fixUndefined(dataset.info.text);\n\n      if (!specColor.completed) {\n        bColor = completedColor;\n      }\n\n      let styleColor = '';\n      if (dataset.info.color && specColor.info) {\n        styleColor = infoColor;\n      }\n\n      if (specColor.completed) {\n        styleColor = completedColor;\n      }\n\n      const styleValue = (dataset.info && !isUndefined(dataset.info.value) ?\n        fixUndefined(dataset.info.value) :\n        setFormat(dataset.completed));\n\n      html.label = `<b class=\"label name\">${name}</b>\n      <b class=\"label info ${bColor} colored\">\n      <span class=\"value ${bColor}\" ${styleColor ? `style=\"color:${styleColor}` : ''}\">${styleValue}</span>\n      <span class=\"text ${bColor}\" ${styleColor ? `style=\"color:${styleColor}` : ''}\">${infoText}</span>\n      </b>`;\n    }\n\n    if (dataset.remaining) {\n      html.remaining = `${'' +\n      '<div class=\"target remaining bar'}${!specColor.remaining ? ` ${fixUndefined(dataset.remaining.color)}` : ''}\"${specColor.remaining ? (` style=\"color:${dataset.remaining.color};background-color:${dataset.remaining.color};\"`) : ''}\">${\n        isAchievment ? '' : `<span aria-hidden=\"true\"${!isTarget && !isAchievment ? ' class=\"audible\"' : ''}>` +\n          `<span class=\"value${!specColor.remaining ? ` ${fixUndefined(dataset.remaining.color)}` : ''}\"${specColor.remaining ? (` style=\"color:${dataset.remaining.color};\"`) : ''}\">${\n            setFormat(dataset.remaining)\n          }</span><br />` +\n          `<span class=\"text${!specColor.remaining ? ` ${fixUndefined(dataset.remaining.color)}` : ''}\"${specColor.remaining ? (` style=\"color:${dataset.remaining.color};\"`) : ''}\">${\n            fixUndefined(dataset.remaining.text)\n          }</span>` +\n        '</span>'\n      }</div>`;\n    } else {\n      html.remaining = '<div class=\"target remaining bar\" style=\"opacity: 0\"></div>';\n    }\n\n    if (dataset.completed && isAchievment) {\n      setPercentText();\n      specColor.percentText = percentText.color.indexOf('#') === 0;\n\n      html.completed = `${'' +\n      '<div class=\"completed bar'}${!specColor.completed ? ` ${fixUndefined(dataset.completed.color)}` : ''}\"${specColor.completed ? (` style=\"color:${dataset.completed.color};background-color:${dataset.completed.color};\"`) : ''}\"></div>${\n        percentText.show ? `<div class=\"chart-percent-text${!specColor.percentText && percentText.color !== '' ? ` ${percentText.color}` : ''}\"${specColor.percentText ? (` style=\"color:${percentText.color};\"`) : ''}>${percentText._text}</div>` : '' //eslint-disable-line\n      }<span class=\"completed-label\" aria-hidden=\"true\"${!isTarget && !isAchievment ? ' class=\"audible\"' : ''}>` +\n          `<span class=\"text\">${\n            fixUndefined(dataset.completed.text)\n          }</span>` +\n        '</span>';\n    }\n\n    if (dataset.completed && !isAchievment) {\n      html.completed = `${'' +\n      '<div class=\"completed bar'}${!specColor.completed ? ` ${fixUndefined(dataset.completed.color)}` : ''}\"${specColor.completed ? (` style=\"color:${dataset.completed.color};background-color:${dataset.completed.color};\"`) : ''}>` +\n        `<span aria-hidden=\"true\"${!isTarget && !isAchievment ? ' class=\"audible\"' : ''}>` +\n          `<span class=\"value${!specColor.completed ? ` ${fixUndefined(dataset.completed.color)}` : ''}\"${specColor.completed ? (` style=\"color:${dataset.completed.color};\"`) : ''}\">${setFormat(dataset.completed)}</span><br />` +\n          `<span class=\"text${!specColor.completed ? ` ${fixUndefined(dataset.completed.color)}` : ''}\"${specColor.completed ? (` style=\"color:${dataset.completed.color};\"`) : ''}\">${\n            fixUndefined(dataset.completed.text)\n          }</span>` +\n        '</span></div>';\n    }\n\n    if (dataset.targetline) {\n      html.targetline = `${'' +\n      '<div class=\"target-line targetline bar'}${!specColor.targetline ? ` ${fixUndefined(dataset.targetline.color)}` : ''}\"${specColor.targetline ? (` style=\"color:${dataset.targetline.color};background-color:${dataset.targetline.color};\"`) : ''}\">` +\n        `<span aria-hidden=\"true\"${!isTarget && !isAchievment ? ' class=\"audible\"' : ''}>` +\n          `<span class=\"value${!specColor.targetline ? ` ${fixUndefined(dataset.targetline.color)}` : ''}\"${specColor.targetline ? (` style=\"color:${dataset.targetline.color};\"`) : ''}\">${\n            setFormat(dataset.targetline)\n          }</span><br />` +\n            `<span class=\"text${!specColor.targetline ? ` ${fixUndefined(dataset.targetline.color)}` : ''}\"${specColor.targetline ? (` style=\"color:${dataset.targetline.color};\"`) : ''}\">${\n              fixUndefined(dataset.targetline.text)\n            }</span>` +\n        '</span>' +\n      '</div>';\n    }\n\n    DOM.append(html.body, (html.remaining || '') + (html.completed || '') + (html.targetline || ''), '<div><span><br>');\n    DOM.append(this.element, html.label + html.body.prop('outerHTML'), '<div><span><br>');\n\n    cacheElements();\n    setJsonData();\n    updateBars();\n\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    return this;\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings object\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    const type = settings.type || this.settings.type;\n    this.settings = settings;\n    this.settings.type = type;\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n    this.element.empty();\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('completion-chart');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'chart');\n  }\n};\n\nexport { CompletionChart, COMPONENT_NAME };\n","/* eslint-disable no-nested-ternary, prefer-arrow-callback */\n\n// Other Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\n\n// Settings and Options\nconst COMPONENT_NAME = 'sparkline';\n\n// The Component Defaults\nconst SPARKLINE_DEFAULTS = {\n  dataset: [],\n  colors: ['#1D5F8A', '#999999', '#bdbdbd', '#d8d8d8'],\n  isDots: false,\n  isPeakDot: false,\n  isMinMax: false,\n  isMedianRange: false\n};\n\n/**\n * Sparklines are a compact way to show trends.\n * @class Sparkline\n * @param {string} element The plugin element for the constuctor\n * @param {string} settings The settings element.\n * @param {array} [settings.dataset] The data to use in the sparklines.\n * @param {array} [settings.colors = ['#1D5F8A', '#999999', '#bdbdbd', '#d8d8d8']] An array of color sequences in hex format fx #1D5F8A,\n * defaulting to the correct standard colors.\n * @param {boolean} [settings.isDots = false] Shows dots on the data points.\n * @param {boolean} [settings.isPeakDot = false] Highlights the top value as peak with a special dot.\n * @param {boolean} [settings.isMinMax  = false] Shows a continuous shading to highlight the min and max values.\n * @param {boolean} [settings.isMedianRange  = false] Adds a median range display.\n */\nfunction Sparkline(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, SPARKLINE_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nSparkline.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The sparkline prototype for chaining.\n   */\n  init() {\n    this.sparklineColors = d3.scaleOrdinal().range(this.settings.colors);\n\n    return this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n   * Build the Sparkline Chart.\n   * @private\n   * @returns {object} The sparkline prototype for chaining.\n   */\n  build() {\n    // chartData, options\n    // Sparkline Chart\n    const self = this;\n    let tooltipIntervalMedianRange;\n    let tooltipIntervalDots;\n    const tooltipDataCacheMedianRange = [];\n    const tooltipDataCacheDots = [];\n    let tooltipData = self.settings.tooltip;\n\n    // calculate max and min values in the NLWest data\n    let max = 0;\n    let min = 0;\n    let len = 0;\n    let i;\n    const dimensions = this.calculateAspectRatioFit({\n      srcWidth: 385,\n      srcHeight: 65,\n      maxWidth: this.element.width(),\n      maxHeight: 600 // container min-height\n    });\n    const dotsize = dimensions.width > 300 ? 4 : 3;\n\n    const chartData = self.settings.dataset;\n    for (i = 0; i < chartData.length; i++) {\n      min = d3.min([d3.min(chartData[i].data), min]);\n      max = d3.max([d3.max(chartData[i].data), max]);\n      len = d3.max([chartData[i].data.length, len]);\n    }\n\n    // Make the lines based on the range of values and width\n    const p = 10;\n    const w = dimensions.width;\n    const h = dimensions.height;\n    const x = d3.scaleLinear().domain([0, len]).range([p, w - p]);\n    const y = d3.scaleLinear().domain([min, max]).range([h - p, p]);\n    const line = d3.line()\n      .x((d, j) => x(j))\n      .y(d => y(d));\n\n    // Add the tooltip dom element\n    charts.appendTooltip();\n\n    // Append to the main dom element\n    const svg = d3.select(this.element[0])\n      .append('svg')\n      .attr('height', h)\n      .attr('width', w);\n\n    // Add Median Range\n    // https://www.purplemath.com/modules/meanmode.htm\n    if (self.settings.isMedianRange) {\n      max = d3.max(chartData[0].data);\n      min = d3.min(chartData[0].data);\n\n      const minWidth = 10;\n      const maxWidth = w - 45;\n      const median = d3.median(chartData[0].data);\n      const range = max - min;\n      const scaleMedianRange = d3.scaleLinear().domain([min, max]).range([0, h]);\n      const top = h - scaleMedianRange(median > range ? median : range);\n      const bot = h - scaleMedianRange(median < range ? median : range);\n\n      svg.append('g')\n        .attr('class', 'medianrange')\n        .attr('transform', () => `translate(${minWidth},${top})`)\n        .append('rect')\n        .attr('width', maxWidth)\n        .attr('height', bot)\n        .style('fill', '#d8d8d8')\n        .on('mouseenter', function () {\n          const rect = this.getBoundingClientRect();\n          let content = '<p class=\"sparkline-tooltip\">' + // eslint-disable-line\n            Locale.translate('Median') + '<b>' + median + '</b><br>' +\n            Locale.translate('Range') + '<b>' + range + '</b>' +\n            (self.settings.isPeakDot ? '<br>' + Locale.translate('Peak') +'<b>'+ max +'</b>' : '') + '</p>'; // eslint-disable-line\n\n          const show = function () {\n            const size = charts.tooltipSize(content);\n            const posX = rect.left + ((rect.width - size.width) / 2);\n            const posY = rect.top - size.height - 5; // 5 is extra padding\n\n            if (content !== '') {\n              charts.showTooltip(posX, posY, content, 'top');\n            }\n          };\n\n          if (tooltipData && typeof tooltipData === 'function' && !tooltipDataCacheMedianRange[i]) {\n            content = '';\n            let runInterval = true;\n            tooltipIntervalMedianRange = setInterval(() => {\n              if (runInterval) {\n                runInterval = false;\n                tooltipData((data) => {\n                  content = data;\n                  tooltipDataCacheMedianRange[i] = data;\n                });\n              }\n              if (content !== '') {\n                clearInterval(tooltipIntervalMedianRange);\n                show();\n              }\n            }, 10);\n          } else {\n            tooltipData = typeof tooltipData === 'object' ? '' : tooltipData;\n            content = tooltipDataCacheMedianRange[i] || tooltipData || chartData[0].tooltip || content || '';\n            show();\n          }\n        })\n        .on('mouseleave', () => {\n          clearInterval(tooltipIntervalMedianRange);\n          charts.hideTooltip();\n        });\n    }\n\n    for (i = 0; i < chartData.length; i++) {\n      const set = chartData[i];\n      const g = svg.append('g');\n\n      g.append('path')\n        .attr('d', line(set.data))\n        .attr('stroke', self.settings.isMinMax ? '#999999' : this.sparklineColors(i))\n        .attr('class', 'team connected-line');\n    }\n\n    // Add Dots (Dots/Peak/MinMAx)\n    min = d3.min(chartData[0].data);\n    svg.selectAll('.point')\n      .data(chartData[0].data)\n      .enter()\n      .append('circle')\n      .attr('r', function (d) {\n        return (self.settings.isMinMax && max === d || self.settings.isMinMax && min === d) ?\n          (dotsize + 1) :\n          (self.settings.isDots || (self.settings.isPeakDot && max === d)) ? dotsize : 0;\n      })\n      .attr('class', function (d) {\n        return (self.settings.isPeakDot && max === d && !self.settings.isMinMax) ? 'point peak' :\n          (self.settings.isMinMax && max === d) ? 'point max' :\n            (self.settings.isMinMax && min === d) ? 'point min' : 'point';\n      })\n      .style('fill', function (d) {\n        return (self.settings.isPeakDot && max === d && !self.settings.isMinMax) ? '#ffffff' :\n          (self.settings.isMinMax && max === d) ? '#56932E' :\n            (self.settings.isMinMax && min === d) ? '#941E1E' : self.sparklineColors(0);\n      })\n      .style('stroke', function (d) {\n        return (self.settings.isPeakDot && max === d && !self.settings.isMinMax) ?\n          self.sparklineColors(0) :\n          (self.settings.isMinMax && max === d) ? 'none' :\n            (self.settings.isMinMax && min === d) ? 'none' : '#ffffff';\n      })\n      .style('cursor', 'pointer')\n      .attr('cx', (d, m) => x(m))\n      .attr('cy', d => y(d))\n      .on('mouseenter', function (d) {\n        const rect = this.getBoundingClientRect();\n        let content = `<p>${chartData[0].name ? `${chartData[0].name}<br> ${\n          (self.settings.isMinMax && max === d) ? `${Locale.translate('Highest')}: ` :\n            (self.settings.isMinMax && min === d) ? `${Locale.translate('Lowest')}: ` :\n              (self.settings.isPeakDot && max === d) ? `${Locale.translate('Peak')}: ` : ''}` : ''}<b>${d}</b></p>`;\n\n        const show = function () {\n          const size = charts.tooltipSize(content);\n          const posX = rect.left - (size.width / 2) + 6;\n          const posY = rect.top - size.height - 8;\n\n          if (content !== '') {\n            charts.showTooltip(posX, posY, content, 'top');\n          }\n        };\n\n        if (tooltipData && typeof tooltipData === 'function' && !tooltipDataCacheDots[i]) {\n          content = '';\n          let runInterval = true;\n          tooltipIntervalDots = setInterval(() => {\n            if (runInterval) {\n              runInterval = false;\n              tooltipData((data) => {\n                content = data;\n                tooltipDataCacheDots[i] = data;\n              });\n            }\n            if (content !== '') {\n              clearInterval(tooltipIntervalDots);\n              show();\n            }\n          }, 10);\n        } else {\n          tooltipData = typeof tooltipData === 'object' ? '' : tooltipData;\n          content = tooltipDataCacheDots[i] || tooltipData || chartData[0].tooltip || content || '';\n          show();\n        }\n\n        d3.select(this).attr('r', (self.settings.isMinMax && max === d ||\n            self.settings.isMinMax && min === d) ? (dotsize + 2) : (dotsize + 1));\n      })\n      .on('mouseleave', function (d) {\n        clearInterval(tooltipIntervalDots);\n        charts.hideTooltip();\n        d3.select(this).attr('r', (self.settings.isMinMax && max === d ||\n            self.settings.isMinMax && min === d) ? (dotsize + 1) : dotsize);\n      });\n\n    /**\n    * Fires when the sparkline is fully renders.\n    *\n    * @event close\n    * @memberof About\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The svg element.\n    */\n    this.element.trigger('rendered', svg);\n    return this;\n  },\n\n  /**\n   * Conserve aspect ratio of the orignal region. Useful when shrinking/enlarging\n   * @private\n   * @param  {object} d the data element with the properties\n   * @returns {object} Object with the calulated width and height\n   */\n  calculateAspectRatioFit(d) {\n    const ratio = Math.min(d.maxWidth / d.srcWidth, d.maxHeight / d.srcHeight);\n    return { width: d.srcWidth * ratio, height: d.srcHeight * ratio };\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    return this;\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings object\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    const type = settings.type || this.settings.type;\n    this.settings = settings;\n    this.settings.type = type;\n    this.element.empty();\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'chart');\n  }\n};\n\nexport { Sparkline, COMPONENT_NAME };\n","/* eslint-disable consistent-return */\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// The name of this component\nconst COMPONENT_NAME = 'emptymessage';\n\n/**\n* The Empty Message is a message with an icon that can be used when no data is present.\n* @class EmptyMessage\n* @param {object} element The component element.\n* @param {object} [settings] The component settings.\n* @param {string} [settings.title = null] The Main text to show.\n* @param {string} [settings.info = null] Longer paragraph text to show\n* @param {string} [settings.icon = null] The name of the icon to use. See {@link https://design.infor.com/code/ids-enterprise/latest/demo/icons/example-empty-widgets?font=source-sans} for options.\n* @param {boolean} [settings.button = null] The botton text and click event to add.\n* @param {string} [settings.color = 'graphite']  Defaults to 'graphite' but can also be azure. Later may be expanded to all personalization colors.\n*/\nconst EMPTYMESSAGE_DEFAULTS = {\n  title: null,\n  info: null,\n  icon: null,\n  button: null,\n  color: 'graphite' // or azure for now until personalization works\n};\n\nfunction EmptyMessage(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, EMPTYMESSAGE_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Component Methods\nEmptyMessage.prototype = {\n\n  init() {\n    this\n      .setup()\n      .build();\n  },\n\n  setup() {\n    this.element.addClass('empty-message');\n    return this;\n  },\n\n  build() {\n    const opts = this.settings;\n\n    if (opts.icon) {\n      $(`<div class=\"empty-icon\">\n          <svg class=\"icon-empty-state is-${this.settings.color}\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n            <use xlink:href=\"#${opts.icon}\"></use>\n          </svg></div>`).appendTo(this.element);\n    }\n\n    if (opts.title) {\n      // Re-evaluate the text\n      if (opts.title === '[NoData]') {\n        opts.title = Locale ? Locale.translate('NoData') : 'No Data Available';\n      }\n\n      $(`<div class=\"empty-title\">${opts.title}</div>`).appendTo(this.element);\n    }\n\n    if (opts.info) {\n      $(`<div class=\"empty-info\">${opts.info}</div>`).appendTo(this.element);\n    }\n\n    if (opts.button) {\n      $(`${'<div class=\"empty-actions\">' +\n          '<button type=\"button\" class=\"btn-secondary hide-focus '}${opts.button.cssClass}\" id=\"${opts.button.id}\">` +\n            `<span>${opts.button.text}</span>` +\n          '</button>' +\n        '</div>').appendTo(this.element);\n\n      if (opts.button.click) {\n        this.element.on('click', opts.button.click);\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * Update the component and optionally apply new settings.\n   *\n   * @param  {object} settings the settings to update to.\n   * @returns {void}\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    this.element.empty();\n    this.build();\n  },\n\n  /**\n   * Teardown - Remove added markup and events\n   * @returns {void}\n   */\n  destroy() {\n    $.removeData(this.element[0], COMPONENT_NAME);\n    this.element.empty();\n  }\n};\n\nexport { EmptyMessage, COMPONENT_NAME };\n","import { EmptyMessage, COMPONENT_NAME } from './emptymessage';\n\n// Empty Message jQuery wrapper\n$.fn.emptymessage = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new EmptyMessage(this, settings));\n    }\n  });\n};\n","/* eslint-disable no-nested-ternary, prefer-arrow-callback */\n\n// Other Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\n\nimport '../emptymessage/emptymessage.jquery';\n\n// Settings and Options\nconst COMPONENT_NAME = 'line';\n\n/**\n * A line chart or line graph is a type of chart which displays information as a series of data\n * points called 'markers' connected by straight line segments.\n * @class Line\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings] The settings element.\n *\n * @param {array} [settings.dataset=[]] The data to use in the line/area/bubble.\n * @param {function|string} [settings.tooltip] A custom tooltip or tooltip renderer function\n * for the whole chart.\n * @param {string} [settings.isArea] Render as an area chart.\n * @param {string} [settings.isBubble=false] Render as a bubble chart.\n * @param {string} [settings.isScatterPlot=false] Render as a Scatter Plot Chart.\n* @param {string} [settings.showLegend=true] If false the label will not be shown.\n * @param {object} [settings.xAxis] A series of options for the xAxis\n * @param {number} [settings.xAxis.rotate] Rotate the elements on the x axis.\n * Recommend -65 deg but this can be tweaked depending on look.\n * @param {object} [settings.yAxis] A series of options for the yAxis\n * @param {object} [settings.xAxis.ticks] Data to control the number of ticks and y axis format.\n * For example `{number: 5, format: ',.1s'}` would show only 5 yaxis points and format the\n * data to show 1K, 1M, 1G ect.. This uses the d3 formatter.\n * @param {function} [settings.xAxis.formatText] A function that passes the text element and a counter.\n * You can return a formatted svg markup element to replace the current element.\n * For example you could use tspans to wrap the strings or color them.\n * @param {object} [settings.yAxis] A series of options for the yAxis\n * @param {function} [settings.yAxis.formatter] A d3 formatter for the yAxis points.\n * @param {boolean} [settings.hideDots=false] If true no dots are shown\n * @param {array} [settings.axisLabels]  Option to a label to one of the four sides. For Example\n * `{left: 'Left axis label', top: 'Top axis label',\n * right: 'Right axis label', bottom: 'Bottom axis label'}`\n * @param {boolean|string} [settings.animate] true|false - will do or not do the animation.\n * 'initial' will do only first time the animation.\n * @param {boolean} [settings.redrawOnResize=true] If true, the component will not resize when resizing the page.\n * @param {object} [settings.dots] Option to customize the dot behavior. You can set the dot size (radius),\n * the size on hover and stroke or even add a custom class.\n * Example `dots: { radius: 3, radiusOnHover: 4, strokeWidth: 0, class: 'custom-dots'}`\n * @param {string} [settings.formatterString] Use d3 format some examples can be found on http://bit.ly/1IKVhHh\n * @param {object} [settings.emptyMessage] An empty message will be displayed when there is no chart data.\n * This accepts an object of the form emptyMessage:\n * `{title: 'No Data Available',\n *  info: 'Make a selection on the list above to see results', icon: 'icon-empty-no-data',\n *  button: {text: 'xxx', click: <function>}\n *  }`\n *  Set this to null for no message or will default to 'No Data Found with an icon.'\n */\nconst LINE_DEFAULTS = {\n  dataset: [],\n  isArea: false,\n  isBubble: false,\n  isScatterPlot: false,\n  showLegend: true,\n  hideDots: false,\n  animate: true,\n  redrawOnResize: true,\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' }\n};\n\nfunction Line(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, LINE_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nLine.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The component prototype for chaining.\n   */\n  init() {\n    this\n      .build()\n      .handleEvents();\n\n    // Handle initial option\n    if (this.settings.animate === 'initial') {\n      this.settings.animate = false;\n    }\n\n    /**\n    * Fires when the chart is complete done rendering, for customization.\n    * @event rendered\n    * @memberof Line\n    * @param {object} event - The jquery event object\n    * @param {array} svg - The svg object.\n    */\n    this.element.trigger('rendered', [this.svg]);\n\n    return this;\n  },\n\n  /**\n   * Build the Component.\n   * @returns {object} The component prototype for chaining.\n   * @private\n   */\n  build() {\n    const self = this;\n    const isFormatter = !!this.settings.formatterString;\n    const format = function (value) {\n      return isFormatter ? d3.format(self.settings.formatterString)(value) : value;\n    };\n\n    this.element.addClass(`line-chart${self.settings.isBubble ? ' bubble' : ''}`);\n    this.element.addClass(`line-chart${self.settings.isScatterPlot ? ' scatterplot' : ''}`);\n\n    // Handle Empty Data Set\n    if (self.settings.dataset.length === 0) {\n      self.element.emptymessage(self.settings.emptyMessage);\n      return this;\n    }\n\n    const dots = {\n      radius: 5,\n      radiusOnHover: 7,\n      strokeWidth: 2,\n      class: 'dot'\n    };\n\n    // Set to zero for animation\n    if (self.settings.isBubble) {\n      dots.radius = 0;\n      dots.radiusOnHover = 0;\n      dots.strokeWidth = 0;\n    }\n\n    if (self.settings.isScatterPlot) {\n      dots.radius = 0;\n      dots.strokeWidth = 50;\n    }\n    $.extend(true, dots, this.settings.dots);\n\n    const isRTL = Locale.isRTL();\n\n    let tooltipInterval;\n    const tooltipDataCache = [];\n    let tooltipData = self.settings.tooltip;\n\n    // Config axis labels\n    let i;\n    let l;\n    const axisLabels = {};\n    const isAxisLabels = { atLeastOne: false };\n    const axisArray = ['left', 'top', 'right', 'bottom'];\n\n    if (self.settings.axisLabels) {\n      $.extend(true, axisLabels, self.settings.axisLabels);\n    }\n\n    if (!$.isEmptyObject(axisLabels)) {\n      for (i = 0, l = axisArray.length; i < l; i++) {\n        const thisAxis = axisLabels[axisArray[i]];\n        if (thisAxis && typeof thisAxis === 'string' && $.trim(thisAxis) !== '') {\n          isAxisLabels[axisArray[i]] = true;\n          isAxisLabels.atLeastOne = true;\n        }\n      }\n    }\n\n    // Append the SVG in the parent area.\n    let longestLabel = '';\n    let longestLabelLength = 0;\n    const dataset = this.settings.dataset;\n\n    const isAxisXRotate = (self.settings.xAxis && self.settings.xAxis.rotate !== undefined); // TODO\n    const getMaxes = function (d, option) {\n      return d3.max(d.data, function (maxData) {\n        return option ? maxData.value[option] : maxData.value;\n      });\n    };\n\n    if (isAxisXRotate) {\n      // get the longeset label\n      dataset[0].data.map(function (d) {  //eslint-disable-line\n        if (d.name.length > longestLabel.length) {\n          longestLabel = d.name;\n        }\n      });\n      longestLabelLength = longestLabel.length;\n    }\n\n    const hideDots = (this.settings.hideDots);\n    const parent = this.element.parent();\n    const isCardAction = !!$('.widget-chart-action', parent).length;\n    const isViewSmall = parent.width() < 450;\n    const margin = {\n      top: (isAxisLabels.top ? (isCardAction ? 15 : 40) : (isCardAction ? 5 : 30)),\n      right: (isAxisLabels.right ? (isViewSmall ? 45 : 65) : (isViewSmall ? 45 : 55)),\n      bottom: (isAxisLabels.bottom ? (isAxisXRotate ? 60 : 50) :\n        (isAxisXRotate ? (longestLabelLength * 5) + 35 : 35)),\n      left: (isAxisLabels.right ? (isViewSmall ? 55 : 75) : (isViewSmall ? 45 : 65))\n    };\n    const width = parent.width() - margin.left - margin.right;\n    let height = parent.height() - margin.top - margin.bottom - 30; // legend\n\n    if (isCardAction) {\n      height -= 40;\n    }\n\n    self.svg = d3.select(this.element[0]).append('svg')\n      .attr('width', width + margin.left + margin.right)\n      .attr('height', height + margin.top + margin.bottom)\n      .append('g')\n      .attr('transform', `translate(${margin.left},${margin.top})`);\n\n    const names = dataset[0].data.map(function (d) {\n      return d.name;\n    });\n\n    const valueFormatterString = {};\n\n    if (dataset[0] && dataset[0].valueFormatterString) {\n      $.extend(true, valueFormatterString, dataset[0].valueFormatterString);\n    }\n\n    const formatValue = function (s, value) {\n      return !$.isEmptyObject(valueFormatterString) && !!s ?\n        (d3.format(s)(s === '0.0%' ? value / 100 : value)) : value;\n    };\n\n    const labels = {\n      name: 'Name',\n      value: {\n        x: 'Value.x',\n        y: 'Value.y',\n        z: 'Value.z'\n      }\n    };\n\n    if (dataset[0] && dataset[0].labels) {\n      $.extend(true, labels, dataset[0].labels);\n    }\n\n    // Calculate the Domain X and Y Ranges\n    let maxes;\n    const x = ((!!self.settings.xAxis && !!self.settings.xAxis.scale) ?\n      (self.settings.xAxis.scale) : (d3.scaleLinear())).range([0, width]);\n\n    const y = d3.scaleLinear().range([height, 0]);\n    const z = d3.scaleLinear().range([1, 25]);\n\n    if (self.settings.isBubble) {\n      maxes = {\n        x: dataset.map(function (d) { return getMaxes(d, 'x'); }),\n        y: dataset.map(function (d) { return getMaxes(d, 'y'); }),\n        z: dataset.map(function (d) { return getMaxes(d, 'z'); })\n      };\n    } else if (self.settings.isScatterPlot) {\n      maxes = {\n        x: dataset.map(function (d) { return getMaxes(d, 'x'); }),\n        y: dataset.map(function (d) { return getMaxes(d, 'y'); })\n      };\n    } else {\n      maxes = dataset.map(function (d) { return getMaxes(d); });\n    }\n\n    let entries;\n    if (d3.max(dataset.map(function (d) { return d.data.length; })) <= 1) {\n      entries = d3.max(dataset.map(function (d) { return d.data.length; }));\n    } else {\n      entries = d3.max(dataset.map(function (d) { return d.data.length; })) - 1;\n    }\n\n    const xScale = x.domain(!!self.settings.xAxis && !!self.settings.xAxis.domain ?\n      (self.settings.xAxis.domain) :\n      ([0, self.settings.isBubble || self.settings.isScatterPlot ? d3.max(maxes.x) : entries]));\n\n    const yScale = y.domain([0, d3.max(self.settings.isBubble ||\n      self.settings.isScatterPlot ? maxes.y : maxes)]).nice();\n    const zScale = z.domain([0, d3.max(self.settings.isBubble ? maxes.z : maxes)]).nice();\n    let numTicks = entries;\n    if (self.settings.xAxis && self.settings.xAxis.ticks) {\n      numTicks = self.settings.xAxis.ticks === 'auto' ? Math.max(width / 85, 2) : self.settings.xAxis.ticks;\n      if (self.settings.isBubble || self.settings.isScatterPlot && isViewSmall) {\n        numTicks = Math.round(entries / 2);\n      }\n    }\n\n    const xAxis = d3.axisBottom(xScale)\n      .ticks(numTicks)\n      .tickPadding(10)\n      .tickSize(self.settings.isBubble || self.settings.isScatterPlot ? -(height + 10) : 0)\n      .tickFormat(function (d, j) {\n        if (self.settings.xAxis) {\n          if (self.settings.xAxis.formatter) {\n            return self.settings.xAxis.formatter(d, j);\n          }\n          if (self.settings.xAxis.ticks === 'auto') {\n            return names[d];\n          }\n        }\n        return self.settings.isBubble || self.settings.isScatterPlot ? d : names[j];\n      });\n\n    const yAxis = d3.axisLeft(yScale)\n      .ticks(8)\n      .tickSize(-(width + 20))\n      .tickPadding(isRTL ? -18 : 20);\n\n    if (self.settings.yAxis && self.settings.yAxis.formatter) {\n      yAxis.tickFormat(function (d, k) {\n        if (typeof self.settings.yAxis.formatter === 'function') {\n          return self.settings.yAxis.formatter(d, k);\n        }\n        return d;\n      });\n    }\n\n    if (self.settings.yAxis && self.settings.yAxis.ticks) {\n      yAxis.ticks(self.settings.yAxis.ticks.number, self.settings.yAxis.ticks.format);\n    }\n\n    // Append The Axis Labels\n    if (isAxisLabels.atLeastOne) {\n      const axisLabelsGroup = self.svg.append('g').attr('class', 'axis-labels');\n      const place = {\n        top: `translate(${width / 2},${-10})`,\n        right: `translate(${width + 28},${height / 2})rotate(90)`,\n        bottom: `translate(${width / 2},${height + 40})`,\n        left: `translate(${-40},${height / 2})rotate(-90)`\n      };\n\n      const placeStyle = {\n        top: `rotate(0deg) scaleX(-1) translate(-${width / 2}px, ${-10}px)`,\n        right: `rotate(90deg) scaleX(-1) translate(-${(height / 2) + 5}px, -${width + 28}px)`,\n        bottom: `rotate(0deg) scaleX(-1) translate(-${width / 2}px, ${height + 40}px)`,\n        left: `rotate(90deg) scaleX(-1) translate(-${(height / 2 - 5)}px, ${55}px)`\n      };\n\n      const addAxis = function (pos) {\n        if (isAxisLabels[pos]) {\n          axisLabelsGroup.append('text')\n            .attr('class', `axis-label-${pos}`)\n            .attr('text-anchor', 'middle')\n            .attr('transform', isRTL ? '' : place[pos])\n            .style('font-size', '1.25em')\n            .style('transform', isRTL ? placeStyle[pos] : '')\n            .text(axisLabels[pos]);\n        }\n      };\n\n      for (i = 0, l = axisArray.length; i < l; i++) {\n        addAxis(axisArray[i]);\n      }\n    }\n\n    // Append The Axis to the svg\n    self.svg.append('g')\n      .attr('class', 'x axis')\n      .attr('transform', `translate(0,${height})`)\n      .call(xAxis);\n\n    self.svg.append('g')\n      .attr('class', 'y axis')\n      .call(yAxis);\n\n    // Offset the tick inside, uses the fact that the yAxis has 20 added.\n    self.svg.selectAll('.tick line').attr('x1', '-10');\n\n    if (self.settings.isBubble || self.settings.isScatterPlot) {\n      self.svg.selectAll('.x.axis .tick line, .y.axis .tick line').style('opacity', 0);\n      self.svg.select('.x.axis .tick line').attr('x2', '-10').style('opacity', 1);\n      self.svg.select('.y.axis .tick line').style('opacity', 1);\n    }\n\n    if (isRTL) {\n      self.svg.selectAll('text').attr('transform', 'scale(-1, 1)');\n      self.svg.selectAll('.y.axis text').style('text-anchor', 'end');\n    }\n\n    if (isAxisXRotate) {\n      self.svg.selectAll('.x.axis .tick text') // select all the text for the xaxis\n        .attr('y', 0)\n        .attr('x', function () {\n          return -(this.getBBox().width + 10);\n        })\n        .attr('dy', '1em')\n        .attr('transform', `rotate(${self.settings.xAxis.rotate})`)\n        .style('text-anchor', 'start');\n    }\n\n    if (self.settings.xAxis && self.settings.xAxis.formatText) {\n      self.svg.selectAll('.x.axis .tick text').each(function (m) {\n        const elem = d3.select(this);\n        const text = d3.select(this).text();\n        const markup = self.settings.xAxis.formatText(text, m);\n        DOM.html(elem.node(), markup, '<tspan><text><glyph>');\n      });\n    }\n\n    // Create the line generator\n    const line = d3.line()\n      .x(function (d, n) {\n        if (!!self.settings.xAxis && !!self.settings.xAxis.parser) {\n          return xScale(self.settings.xAxis.parser(d, n));\n        }\n        return xScale(self.settings.isBubble || self.settings.isScatterPlot ? d.value.x : n);\n      })\n      .y(function (d) {\n        return yScale(self.settings.isBubble || self.settings.isScatterPlot ? d.value.y : d.value);\n      });\n\n    // Append the lines\n    dataset.forEach(function (d, lineIdx) {\n      const lineGroups = self.svg.append('g')\n        .attr('data-group-id', lineIdx)\n        .attr('class', 'line-group');\n\n      if (self.settings.isArea) {\n        const area = d3.area()\n          .x(function (dc, p) {\n            return xScale(p);\n          })\n          .y0(height)\n          .y1(function (db) {\n            return yScale(self.settings.isBubble ||\n              self.settings.isScatterPlot ? db.value.y : db.value);\n          });\n\n        lineGroups.append('path')\n          .datum(d.data)\n          .attr('fill', function () { return charts.chartColor(lineIdx, 'line', d); })\n          .style('opacity', '.2')\n          .attr('class', 'area')\n          .attr('d', area);\n      }\n\n      const path = lineGroups.append('path')\n        .datum(d.data)\n        .attr('d', line(d.data))\n        .attr('stroke', function () {\n          return self.settings.isBubble || self.settings.isScatterPlot ? '' : charts.chartColor(lineIdx, 'line', d);\n        })\n        .attr('stroke-width', 2)\n        .attr('fill', 'none')\n        .attr('class', 'line')\n        .on('click.chart', function () {\n          charts.selectElement(d3.select(this.parentNode), self.svg.selectAll('.line-group'), d, self.element);\n        });\n\n      // Add animation\n      const totalLength = path.node().getTotalLength();\n      path\n        .attr('stroke-dasharray', `${totalLength} ${totalLength}`)\n        .attr('stroke-dashoffset', totalLength)\n        .transition()\n        .duration(self.settings.animate ? 600 : 0)\n        .ease(d3.easeCubic)\n        .attr('stroke-dashoffset', 0);\n\n      const handleMouseEnter = function (elem, mouseEnterData) {\n        const rect = elem.getBoundingClientRect();\n        let content = `<p><b>${mouseEnterData.name} </b> ${format(mouseEnterData.value)}</p>`;\n\n        const show = function () {\n          const size = charts.tooltipSize(content);\n          let posX = rect.left - (size.width / 2) + 6;\n          const posY = rect.top - size.height - 18;\n\n          posX = self.settings.isBubble || self.settings.isScatterPlot ?\n            ((rect.left + (rect.width / 2)) - (size.width / 2)) : posX;\n\n          if (content !== '') {\n            charts.showTooltip(posX, posY, content, 'top');\n          }\n        };\n\n        if (self.settings.isBubble || self.settings.isScatterPlot) {\n          content = `<div class=\"chart-swatch line\"><div class=\"swatch-caption\"><span class=\"indicator-box\"></span>\n            <b>${mouseEnterData.name}</b></div>`;\n\n          for (const key in mouseEnterData) {  //eslint-disable-line\n            if (mouseEnterData.hasOwnProperty(key)) {  //eslint-disable-line\n              if (typeof mouseEnterData[key] !== 'object') {\n                content += `${'' +\n                    '<div class=\"swatch-row\">' +\n                      '<span>'}${labels[key]}</span>` +\n                      `<b>${d.name}</b>` +\n                    '</div>';\n              } else {\n                const obj2 = mouseEnterData[key];\n                for (const key2 in obj2) {  //eslint-disable-line\n                  if (obj2.hasOwnProperty(key2)) {  //eslint-disable-line\n                    content += `${'' +\n                        '<div class=\"swatch-row\">' +\n                          '<span class=\"text-capitalize\">'}${labels[key][key2]}</span>` +\n                          `<b>${formatValue(valueFormatterString[key2], obj2[key2])}</b>` +\n                        '</div>';\n                  }\n                }\n              }\n            }\n          }\n          content += '</div>';\n        }\n\n        if (tooltipData && typeof tooltipData === 'function' && !tooltipDataCache[i]) {\n          content = '';\n          let runInterval = true;\n          tooltipInterval = setInterval(function () {\n            if (runInterval) {\n              runInterval = false;\n              tooltipData(function (data) {\n                content = data;\n                tooltipDataCache[i] = data;\n              });\n            }\n            if (content !== '') {\n              clearInterval(tooltipInterval);\n              show();\n            }\n          }, 10);\n        } else {\n          tooltipData = typeof tooltipData === 'object' ? '' : tooltipData;\n          content = tooltipDataCache[i] || tooltipData || mouseEnterData.tooltip || d.tooltip || content || '';\n          show();\n\n          // Set the colors\n          const spans = document.querySelectorAll('#svg-tooltip .swatch-caption span');\n          for (let k = 0; k < spans.length; k++) {\n            spans[k].style.backgroundColor = charts.chartColor(k, 'line', mouseEnterData);\n          }\n        }\n\n        // Circle associated with hovered point\n        d3.select(this).attr('r', function (df) {\n          return self.settings.isBubble ? (2 + zScale(df.value.z)) : dots.radiusOnHover;\n        });\n      };\n\n      if (!hideDots) {\n        if (!self.settings.isScatterPlot) {\n          lineGroups.selectAll('circle')\n            .data(d.data)\n            .enter()\n            .append('circle')\n            .attr('class', dots.class)\n            .attr('cx', function (dd, p) {\n              if (!!self.settings.xAxis && !!self.settings.xAxis.parser) {\n                return xScale(self.settings.xAxis.parser(dd, p));\n              }\n              return xScale(self.settings.isBubble || self.settings.isScatterPlot ? dd.value.x : p);\n            })\n            .attr('cy', function (de) { return yScale(self.settings.isBubble || self.settings.isScatterPlot ? 0 : de.value); })\n            .attr('r', dots.radius)\n            .style('stroke-width', dots.strokeWidth)\n            .style('fill', function () { return charts.chartColor(lineIdx, 'line', d); })\n            .style('opacity', (self.settings.isBubble || self.settings.isScatterPlot ? '.7' : '1'))\n            .on('mouseenter.chart', function (mouseEnterData) {\n              handleMouseEnter(this, mouseEnterData);\n            })\n            .on('mouseleave.chart', function () {\n              clearInterval(tooltipInterval);\n              charts.hideTooltip();\n              d3.select(this).attr('r', function (dg) {\n                return self.settings.isBubble ? zScale(dg.value.z) : dots.radius;\n              });\n            })\n            .on('click.chart', function (dh) {\n              charts.selectElement(d3.select(this.parentNode), self.svg.selectAll('.line-group'), dh, self.element);\n            });\n        }\n\n        if (self.settings.isScatterPlot) {\n          lineGroups.selectAll('.symbol')\n            .data(d.data)\n            .enter()\n            .append('path')\n            .attr('class', 'symbol')\n            .attr('transform', function (ds) {\n              return `translate(${xScale(ds.value.x)},${yScale(ds.value.y)})`;\n            })\n            .attr('d', d3.symbol().size(dots.strokeWidth).type(function () { return d3.symbols[lineIdx]; }))\n            .style('opacity', 0)\n            .style('fill', function () { return charts.chartColor(lineIdx, 'line', d); })\n            .on('mouseenter.chart', function (mouseEnterData) {\n              handleMouseEnter(this, mouseEnterData);\n            })\n            .on('mouseleave.chart', function () {\n              clearInterval(tooltipInterval);\n              charts.hideTooltip();\n              d3.select(this).attr('r', function () {\n                return dots.radius;\n              });\n            })\n            .on('click.chart', function (dh) {\n              charts.selectElement(d3.select(this.parentNode), self.svg.selectAll('.line-group'), dh, self.element);\n            });\n        }\n        if (self.settings.isBubble) {\n          // Add animation\n          lineGroups.selectAll('circle')\n            .attr('cy', function (di) { return yScale(di.value.y); })\n            .transition().duration(self.settings.animate ? 750 : 0)\n            .ease(d3.easeCubic)\n            .attr('r', function (dj) { return zScale(dj.value.z); });\n        }\n\n        if (self.settings.isScatterPlot) {\n          // Add animation\n          lineGroups.selectAll('.symbol')\n            .transition().duration(self.settings.animate ? 750 : 0)\n            .ease(d3.easeCubic)\n            .style('opacity', 1);\n        }\n      }\n    });\n\n    // Set y-axix tick css class\n    self.svg.selectAll('.y.axis .tick').attr('class', function (di) {\n      return `tick${di === 0 ? ' tick0' : ''}`;\n    });\n\n    const series = dataset.map(function (d) {\n      return { color: d.color, name: d.name, selectionObj: self.svg.selectAll('.line-group'), selectionInverse: self.svg.selectAll('.line-group'), data: d };\n    });\n\n    if (this.settings.showLegend) {\n      charts.addLegend(series, self.settings.isScatterPlot ? 'scatterplot' : 'line', this.settings, this.element);\n    }\n    charts.appendTooltip();\n\n    charts.setSelected = function (o, isToggle) {\n      let selected = 0;\n      const equals = utils.equals;\n      let selector;\n      let selectorData;\n      let elem;\n\n      const setSelected = function (d, i1, d2, i2) {\n        if (d2) {\n          elem = self.svg.select(`[data-group-id=\"${i1}\"]`)\n            .select(`.dot:nth-child(${i2 + 2})`);\n          if ((typeof o.groupIndex === 'number' &&\n                typeof o.fieldName !== 'undefined' &&\n                  typeof o.fieldValue !== 'undefined' &&\n                    o.groupIndex === i1 &&\n                      o.fieldValue === d2[o.fieldName]) ||\n              (typeof o.index !== 'undefined' &&\n                typeof o.groupIndex === 'number' &&\n                  o.groupIndex === i1 && o.index === i2) ||\n              (o.elem && $(elem.node()).is(o.elem)) ||\n              (o.data && equals(o.data, d2))) {\n            selected++;\n            selectorData = d2;\n            selector = self.svg.select(`[data-group-id=\"${i1}\"]`);\n          }\n        } else {\n          elem = self.svg.select(`[data-group-id=\"${i1}\"]`);\n          if ((typeof o.groupName !== 'undefined' &&\n                typeof o.groupValue !== 'undefined' &&\n                  o.groupValue === d[o.groupName]) ||\n              (typeof o.groupIndex !== 'undefined' &&\n                o.groupIndex === i1) ||\n              (o.elem && $(elem.node()).is(o.elem)) ||\n              (o.data && equals(o.data, d))) {\n            selected++;\n            selectorData = d;\n            selector = elem;\n          }\n        }\n      };\n\n      dataset.forEach(function (d, i3) {\n        if (selected < 1 && d && d.data) {\n          d.data.forEach(function (d2, i2) {\n            if (selected < 1 && d2) {\n              setSelected(d, i3, d2, i2);\n            }\n          });\n          if (selected < 1) {\n            setSelected(d, i3);\n          }\n        }\n      });\n\n      if (selected > 0 && (isToggle || !selector.classed('is-selected'))) {\n        charts.selectElement(selector, self.svg.selectAll('.line-group'), selectorData, self.element);\n      }\n    };\n\n    this.setInitialSelected();\n    this.element.trigger('rendered');\n    return this;\n  },\n\n  /**\n   * Set the initially selected elements\n   * @private\n   */\n  setInitialSelected() {\n    const self = this;\n    let selected = 0;\n    let selector;\n    let selectorData;\n\n    const setInitialSelected = function (node, d, selectedIdx) {\n      if (node.selected && selected < 1) {\n        selected++;\n        selector = d3.select(self.svg.selectAll('.line-group').nodes()[selectedIdx]);\n        selectorData = d;\n      }\n    };\n\n    this.settings.dataset.forEach(function (d, setIdx) {\n      if (d) {\n        setInitialSelected(d, d, setIdx);\n      }\n    });\n\n    this.settings.dataset.forEach(function (d, setIdx) {\n      if (d || d.data) {\n        d.data.forEach(function (d2) {\n          setInitialSelected(d2, d, setIdx);\n        });\n      }\n    });\n\n    if (selected > 0) {\n      charts.selectElement(selector, self.svg.selectAll('.line-group'), selectorData, self.element);\n    }\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    if (this.settings.redrawOnResize) {\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n\n      this.element.on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n    }\n\n    return this;\n  },\n\n  width: 0,\n\n  /*\n   * Get info on the currently selected lines.\n   * @returns {object} An object with the matching data and reference to the triggering element.\n   */\n  getSelected() {\n    return charts.selected;\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   */\n  setSelected(options, isToggle) {\n    const internals = {\n      svg: this.svg,\n      chartData: this.settings.dataset,\n      isStacked: false,\n      isGrouped: false,\n      isSingle: false\n    };\n    charts.setSelected(options, isToggle, internals);\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   */\n  toggleSelected(options) {\n    this.setSelected(options, true);\n  },\n\n  /*\n   * Handles resizing a chart.\n   * @private\n   * @returns {void}\n   */\n  handleResize() {\n    if (this.width === this.element.width()) {\n      return;\n    }\n\n    this.width = this.element.width();\n\n    if (!this.element.is(':visible')) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    this.element.empty();\n\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n    return this\n      .build();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('line-chart');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'chart');\n  }\n};\n\nexport { Line, COMPONENT_NAME };\n","/* eslint-disable no-nested-ternary, prefer-arrow-callback */\n\n// Other Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\n\nimport '../emptymessage/emptymessage.jquery';\n\n// Settings and Options\nconst COMPONENT_NAME = 'column';\n\n/**\n* A column chart displays a series as a set of vertical bars that are grouped by category.\n* Column charts are useful for showing data changes over a period of time or for illustrating\n* comparisons among items.\n* @class Column\n* @param {string} element The plugin element for the constuctor\n* @param {string} [settings] The settings element.\n*\n* @param {array} [settings.dataset = []] The data to use in the line/area/bubble.\n* @param {boolean} [settings.isStacked = false] Set to true if its a stacked column chart\n* @param {boolean} [settings.showLegend = true] If false the legend will not be shown.\n* @param {boolean|string} [settings.animate = true] true|false - will do or not do the animation. 'initial' will do only first time the animation.\n* @param {boolean} [settings.redrawOnResize = true] If true, the component will not resize when resizing the page.\n* @param {string} [settings.format = null] The d3 axis format\n* @param {string} [settings.formatterString] Use d3 format some examples can be found on http://bit.ly/1IKVhHh\n* @param {number} [settings.ticks = 9] The number of ticks to show.\n* @param {function} [settings.xAxis.formatText] A function that passes the text element and a counter.\n* You can return a formatted svg markup element to replace the current element.\n* For example you could use tspans to wrap the strings or color them.\n* @param {object} [settings.emptyMessage = { title: 'No Data', info: , icon: 'icon-empty-no-data' }]\n* An empty message will be displayed when there is no chart data. This accepts an object of the form\n* `emptyMessage: {\n*   title: 'No Data Available',\n*   info: 'Make a selection on the list above to see results',\n*   icon: 'icon-empty-no-data',\n*   button: {text: 'xxx', click: <function>\n*   }`\n* Set this to null for no message or will default to 'No Data Found with an icon.'\n*/\n\nconst COLUMN_DEFAULTS = {\n  dataset: [],\n  isStacked: false,\n  showLegend: true,\n  animate: true,\n  format: null,\n  redrawOnResize: true,\n  ticks: 9,\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' }\n};\n\nfunction Column(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, COLUMN_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nColumn.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The component prototype for chaining.\n   */\n  init() {\n    this.width = 0;\n\n    this\n      .build()\n      .handleEvents();\n\n    // Handle initial option\n    if (this.settings.animate === 'initial') {\n      this.settings.animate = false;\n    }\n\n    return this;\n  },\n\n  /**\n   * Build the Component.\n   * @returns {object} The component prototype for chaining.\n   * @private\n   */\n  build() {\n    const self = this;\n    const isFormatter = !!this.settings.formatterString;\n    const format = function (value) {\n      return isFormatter ? d3.format(self.settings.formatterString)(value) : value;\n    };\n\n    let datasetStacked;\n    const dataset = this.settings.dataset;\n    this.dataset = dataset;\n\n    // Handle Empty Data Set\n    if (dataset.length === 0) {\n      self.element.emptymessage(self.settings.emptyMessage);\n      return this;\n    }\n\n    const parent = this.element.parent();\n    const isRTL = Locale.isRTL();\n    const isPositiveNegative = (this.settings.type === 'column-positive-negative'\n       || this.settings.type === 'positive-negative');\n    const isSingle = (dataset.length === 1);\n    this.isSingle = isSingle;\n    const isGrouped = !(isSingle || !isSingle && self.settings.isStacked);\n    this.isGrouped = isGrouped;\n\n    const margin = {\n      top: 40,\n      right: 40,\n      bottom: (isSingle && dataset[0].name === undefined ?\n        (self.settings.isStacked ? 20 : 50) : 35),\n      left: 45\n    };\n    const legendHeight = 40;\n    const width = parent.width() - margin.left - margin.right - 10;\n    const height = parent.height() - margin.top - margin.bottom -\n        (isSingle && dataset[0].name === undefined ?\n          (self.settings.isStacked || isPositiveNegative ? (legendHeight - 10) : 0) : legendHeight);\n    let yMinTarget;\n    let yMaxTarget;\n    let series;\n    let seriesStacked;\n    let pnColors;\n    let pnPatterns;\n    let pnLegends;\n    let pnSeries;\n\n    let yMin = d3.min(dataset, function (group) {\n      return d3.min(group.data, function (d) {\n        return d.value;\n      });\n    });\n\n    let yMax = d3.max(dataset, function (group) { //eslint-disable-line\n      return d3.max(group.data, function (d) {\n        return d.value;\n      });\n    });\n\n    if (isPositiveNegative) {\n      yMinTarget = d3.min(dataset, function (group) {\n        return d3.min(group.data, function (d) {\n          return d.target;\n        });\n      });\n\n      yMaxTarget = d3.max(dataset, function (group) {\n        return d3.max(group.data, function (d) {\n          return d.target;\n        });\n      });\n\n      yMin = d3.min([yMin, yMinTarget]);\n      yMax = d3.max([yMax, yMaxTarget]);\n\n      pnLegends = { target: 'Target', positive: 'Positive', negative: 'Negative' };\n      pnColors = { target: 'neutral', positive: 'good', negative: 'error' };\n      pnPatterns = {};\n\n      if (dataset[0]) {\n        if (dataset[0].colors) {\n          $.extend(true, pnColors, dataset[0].colors);\n        }\n        if (dataset[0].legends) {\n          $.extend(true, pnLegends, dataset[0].legends);\n        }\n        if (dataset[0].patterns) {\n          $.extend(true, pnPatterns, dataset[0].patterns);\n        }\n      }\n      // Converting object into array\n      pnSeries = [];\n      $.each(pnLegends, function (key, val) {\n        pnSeries.push({\n          name: val,\n          color: pnColors[key],\n          pattern: pnPatterns[key],\n          option: key\n        });\n      });\n    }\n\n    this.element.addClass('column-chart');\n\n    let tooltipInterval;\n    const tooltipDataCache = [];\n    const tooltipData = self.settings.tooltip;\n\n    const x0 = d3.scaleBand()\n      .range([0, width])\n      .round(true)\n      .padding(0.1);\n\n    const x1 = d3.scaleBand();\n\n    const y = d3.scaleLinear()\n      .range([height, 0]);\n\n    let xScale = null;\n    let yScale = null;\n\n    if (self.settings.isStacked) {\n      // Map the Data Sets and Stack them.\n      const yStack = { y1: [], y2: [] };\n      if (isSingle) {\n        datasetStacked = dataset[0].data.map(function (d, i) {\n          let y0 = 0;\n          if (i === 0) {\n            yStack.y1.push(d.value);\n            yStack.y2.push(0);\n          } else {\n            y0 = yStack.y1[0] + yStack.y2[0];\n            yStack.y1[0] = d.value;\n            yStack.y2[0] = y0;\n          }\n          return [$.extend({}, d, {\n            y0,\n            y: d.value,\n            x: d.name,\n            color: d.color,\n            pattern: d.pattern,\n            parentName: d.name,\n            tooltip: d.tooltip\n          })];\n        });\n      } else {\n        datasetStacked = dataset.map(function (d, i) {\n          return d.data.map(function (o, i2) {\n            let y0 = 0;\n            if (i === 0) {\n              yStack.y1.push(o.value);\n              yStack.y2.push(0);\n            } else {\n              y0 = yStack.y1[i2] + yStack.y2[i2];\n              yStack.y1[i2] = o.value;\n              yStack.y2[i2] = y0;\n            }\n            return $.extend({}, o, {\n              y0,\n              y: o.value,\n              x: o.name,\n              color: o.color,\n              pattern: o.pattern,\n              parentName: d.name,\n              tooltip: d.tooltip\n            });\n          });\n        });\n      }\n\n      const stack = d3.stack();\n      stack(datasetStacked);\n\n      xScale = d3.scaleBand()\n        .domain(d3.range(datasetStacked[0].length))\n        .rangeRound([0, width], 0.05);\n\n      if (isSingle && self.settings.isStacked) {\n        xScale.paddingInner(0.095);\n      }\n\n      yScale = d3.scaleLinear()\n        .domain([0,\n          d3.max(datasetStacked, function (d) {\n            return d3.max(d, function (d1) {\n              return d1.y0 + d1.y;\n            });\n          })\n        ])\n        .range([0, height]);\n    }\n\n    // List the values along the x axis\n    const xAxisValues = dataset[0].data.map(function (d) { return d.name; });\n\n    const xAxis = d3.axisBottom(x0)\n      .tickSize(0)\n      .tickPadding(12);\n\n    const yAxis = d3.axisLeft(y)\n      .tickSize(-width)\n      .tickPadding(isRTL ? -12 : 12)\n      .ticks(self.settings.ticks || 9, d3.format(self.settings.format || 's'));\n\n    if (self.settings.yAxis) {\n      if (self.settings.yAxis.formatter) {\n        yAxis.tickFormat(function (d, k) {\n          if (typeof self.settings.yAxis.formatter === 'function') {\n            return self.settings.yAxis.formatter(d, k);\n          }\n          return d;\n        });\n      }\n\n      if (self.settings.yAxis.ticks &&\n          self.settings.yAxis.ticks.number > 1 && self.settings.yAxis.ticks.format) {\n        yAxis.ticks(self.settings.yAxis.ticks.number, self.settings.yAxis.ticks.format);\n      }\n    }\n\n    const svg = d3.select(this.element[0])\n      .append('svg')\n      .attr('width', width + margin.left + margin.right)\n      .attr('height', height + margin.top + margin.bottom)\n      .append('g')\n      .attr('transform', `translate(${margin.left},${margin.top})`);\n\n    this.svg = svg;\n\n    // Get the Different Names\n    let names = dataset.map(function (d) {\n      return d.name;\n    });\n\n    // Get the Maxes of each series\n    let maxesStacked;\n    const maxes = dataset.map(function (d) {\n      return d3.max(d.data, function (maxD) {\n        return isPositiveNegative ? maxD.target : maxD.value;\n      });\n    });\n\n    if (self.settings.isStacked) {\n      maxesStacked = datasetStacked.map(function (maxesD) {\n        return d3.max(maxesD, function (d) { return d.y + d.y0; });\n      });\n    }\n\n    if (isSingle) {\n      names = dataset[0].data.map(function (d) {\n        return d.name;\n      });\n    }\n\n    // Extra ticks\n    if (isPositiveNegative) {\n      yMin += yMin / y.ticks().length;\n      maxes[0] += maxes[0] / (y.ticks().length / 2);\n    }\n\n    // Set series\n    (function () {\n      if (self.settings.isStacked && isSingle) {\n        series = dataset[0].data;\n      } else {\n        let lm;\n        // Loop backwards to catch and override with found first custom info from top\n        for (let i = dataset.length - 1, l = -1; i > l; i--) {\n          lm = dataset[i].data.map(function (d) {\n            return d;\n          });\n          $.extend(true, series, lm);\n          // Convert back to array from object\n          series = $.map(series, function (d) {\n            return d;\n          });\n        }\n      }\n    }());\n\n    if (self.settings.isStacked && !isSingle) {\n      seriesStacked = names.map(function (d, i) {\n        return dataset[i];\n      });\n    }\n\n    x0.domain(self.settings.isStacked ? xAxisValues : names);\n    x1.domain(xAxisValues)\n      .rangeRound([0, (isSingle || self.settings.isStacked) ? width : x0.bandwidth()]);\n    y.domain([(yMin < 0 ? yMin : (self.settings.minValue || 0)), d3.max(self.settings.isStacked ?\n      maxesStacked : maxes)]).nice();\n\n    if (!isSingle || (isSingle && !self.settings.isStacked)) {\n      svg.append('g')\n        .attr('class', 'x axis')\n        .attr('transform', `translate(0,${height + (isPositiveNegative ? 10 : 0)})`)\n        .call(xAxis);\n    }\n\n    svg.append('g')\n      .attr('class', 'y axis')\n      .call(yAxis);\n\n    // Adjust extra(x) space for negative values for RTL\n    if (isRTL && yMin < 0) {\n      let yMaxLength = 0;\n      let tempLength;\n\n      svg.selectAll('.axis.y text')\n        .attr('class', function (d) {\n          tempLength = d3.select(this).text().length;\n          yMaxLength = (tempLength > yMaxLength) ? tempLength : yMaxLength;\n          return d < 0 ? 'negative-value' : 'positive-value';\n        })\n        .attr('x', function (d) {\n          return (yMaxLength * (d < 0 ? 9 : 5));\n        });\n    }\n\n    // Make an Array of objects with name + array of all values\n    let dataArray = [];\n    dataset.forEach(function (d) {\n      dataArray.push($.extend({}, d, { values: d.data }));\n    });\n\n    if (isSingle) {\n      dataArray = [];\n      names = dataset[0].data.forEach(function (d) {\n        dataArray.push(d);\n      });\n    }\n\n    let targetBars;\n    let pnBars;\n    const barMaxWidth = 35;\n    const barsInGroup = dataArray[0] && dataArray[0].values ? dataArray[0].values.length : 0;\n    const isGroupSmaller = ((width / dataArray.length) > (barMaxWidth * (barsInGroup + 1)));\n    const color = function (colorStr) {\n      return charts.chartColor(0, '', { color: colorStr });\n    };\n    const onEndAllTransition = function (transition, callback) {\n      let n;\n      if (transition.empty()) {\n        callback();\n      } else {\n        n = transition.size();\n        transition.on('end', function () {\n          n--;\n          if (n === 0) {\n            callback();\n          }\n        });\n      }\n    };\n\n    const drawBars = function (isTargetBars) {\n      let bars; //eslint-disable-line\n      isTargetBars = isPositiveNegative && isTargetBars;\n\n      // Add the bars - done different depending on if grouped or singlular\n      if (isSingle || isPositiveNegative) {\n        bars = self.svg.selectAll(`rect${isTargetBars ? '.target-bar' : '.bar'}`)\n          .data(self.settings.isStacked ? datasetStacked : dataArray)\n          .enter()\n          .append('rect')\n          .attr('class', function (d, i) {\n            let classStr = `bar series-${i}`;\n\n            if (isPositiveNegative) {\n              classStr = (isTargetBars ? (`target-bar series-${i}`) : classStr) +\n                (d.value > 0 ? ' positive' : ' negative');\n            }\n            return classStr;\n          })\n          .attr('width', Math.min.apply(null, [x1.bandwidth() - 2, barMaxWidth]))\n          .attr('x', function (d) {\n            return self.settings.isStacked ? xScale(0) :\n              (x1(d.name) + (x1.bandwidth() - barMaxWidth) / 2);\n          })\n          .attr('y', function () {\n            return y(0) > height ? height : y(0);\n          })\n          .attr('height', function () {\n            return 0;\n          })\n          .attr('mask', function (d) {\n            return !isPositiveNegative ? null :\n              (isTargetBars ? (pnPatterns.target ? `url(#${pnPatterns.target})` : null) :\n                (d.value < 0 ? (pnPatterns.negative ? `url(#${pnPatterns.negative})` : null) :\n                  (pnPatterns.positive ? `url(#${pnPatterns.positive})` : null))\n              );\n          })\n          .style('fill', function (d) {\n            return !isPositiveNegative ? null :\n              color(isTargetBars ? pnColors.target :\n                (d.value < 0 ? pnColors.negative : pnColors.positive));\n          });\n\n        if (isPositiveNegative) {\n          const yTextPadding = 12;\n          svg.selectAll(isTargetBars ? '.target-bartext' : '.bartext')\n            .data(dataArray)\n            .enter()\n            .append('text')\n            .attr('class', function (d) {\n              return (isTargetBars ? 'target-bartext' : 'bartext') +\n                (d.value > 0 ? ' positive' : ' negative');\n            })\n            .attr('text-anchor', 'middle')\n            .attr('x', function (d) {\n              return (x1(d.name) + (x1.bandwidth()) / 2) * (isRTL ? -1 : 1);\n            })\n            .attr('y', function (d) {\n              return isTargetBars ?\n                (y(d.target) - (yTextPadding / 2)) : (y(d.value > 0 ? 0 : d.value) + yTextPadding);\n            })\n            .style('opacity', 0)\n            .style('fill', function (d) {\n              return isTargetBars ? '' /* color(pnColors.target) */ :\n                (d.value < 0 ? color(pnColors.negative) : color(pnColors.positive));\n            })\n            .style('font-weight', 'bold')\n            .text(function (d) {\n              return format(isTargetBars ? d.target : d.value);\n            });\n        }\n\n        bars.transition().duration(self.settings.animate ? 1000 : 0)\n          .call(onEndAllTransition, function () {\n            svg.selectAll('.target-bartext, .bartext')\n              .transition().duration(self.settings.animate ? 300 : 0).style('opacity', 1);\n          })\n          .attr('y', function (d) {\n            const r = self.settings.isStacked ? (height - yScale(d[0].y) - yScale(d[0].y0)) :\n              (d.value < 0 ? y(0) : y(d.value));\n            return (isTargetBars ? y(d.target) :\n              (d.value < 0 ? r : (r > (height - 3) ? height - 2 : r)));\n          })\n          .attr('height', function (d) {\n            let r;\n            if (self.settings.isStacked) {\n              r = yScale(d[0].y);\n            } else if (d.value < 0) {\n              r = (height - y(0)) - (height - y(d.value));\n            } else {\n              r = (height - y(d.value)) - (height - y(0));\n            }\n            r = d.value < 0 ? r : (r < 3 ? 2 : (r > height ? (height - y(d.value)) : r));\n            return isTargetBars ? (height - y(d.target)) - (height - y(0)) : r;\n          });\n      } else {\n        const xValues = svg.selectAll('.x-value')\n          .data(self.settings.isStacked ? datasetStacked : dataArray)\n          .enter()\n          .append('g')\n          .attr('class', 'series-group g')\n          .attr('data-group-id', function (d, i) {\n            return i;\n          })\n          .attr('transform', function (d) {\n            let x = x0(self.settings.isStacked ? xAxisValues[0] : d.name);\n            const bandwidth = x0.bandwidth();\n            if (!self.settings.isStacked && isGroupSmaller &&\n              bandwidth > ((barMaxWidth * dataArray.length) * 2)) {\n              x += (((x0.bandwidth() / 2) / dataArray.length) / 2);\n            }\n            return `translate(${x},0)`;\n          });\n\n        bars = xValues.selectAll('rect')\n          .data(function (d) { return self.settings.isStacked ? d : d.values; })\n          .enter()\n          .append('rect')\n          .attr('class', function (d, i) {\n            return `series-${i} bar`;\n          })\n          .attr('width', Math.min.apply(null, [x1.bandwidth() - 2, barMaxWidth]))\n          .attr('x', function (d, i) {\n            const width = Math.min.apply(null, [x1.bandwidth() - 2, barMaxWidth]);  //eslint-disable-line\n            return self.settings.isStacked ? xScale(i) :\n              (x1.bandwidth() / 2 + ((width + 2) * i) - (dataArray[0].values.length === 1 ||\n                dataArray[0].values.length === 5 || dataArray[0].values.length === 4 ?\n                (width / 2) : 0));\n          })\n          .attr('y', function () { return y(0) > height ? height : y(0); })\n          .attr('height', function () { return 0; });\n\n        bars\n          .transition().duration(self.settings.animate ? 600 : 0)\n          .attr('y', function (d) {\n            const r = self.settings.isStacked ?\n              (height - yScale(d.y) - yScale(d.y0)) : (d.value < 0 ? y(0) : y(d.value));\n            return d.value < 0 ? r : (r > (height - 3) ? height - 2 : r);\n          })\n          .attr('height', function (d) {\n            let r;\n            if (self.settings.isStacked) {\n              r = yScale(d.y);\n            } else if (d.value < 0) {\n              r = (height - y(0)) - (height - y(d.value));\n            } else {\n              r = (height - y(d.value)) - (height - y(0));\n            }\n            return d.value < 0 ? r : (r < 3 ? 2 : (r > height ? (height - y(d.value)) : r));\n          });\n      }\n      return bars;\n    };\n\n    if (isPositiveNegative) {\n      targetBars = drawBars(true); // Draw target bars\n    }\n    const bars = drawBars();\n\n    if (isPositiveNegative) {\n      pnBars = d3.selectAll([...targetBars.nodes(), ...bars.nodes()]);\n    }\n\n    if (!isPositiveNegative) {\n      // Style the bars and add interactivity\n      if (!self.settings.isStacked) {\n        bars\n          .style('fill', function (d, i) {\n            return isSingle ?\n              charts.chartColor(i, 'column-single', dataset[0].data[i]) :\n              charts.chartColor(i, 'bar', series[i]);\n          })\n          .attr('mask', function (d, i) {\n            return isSingle ?\n              (dataset[0].data[i].pattern ? `url(#${dataset[0].data[i].pattern})` : null) :\n              (series[i].pattern ? `url(#${series[i].pattern})` : null);\n          });\n      } else if (self.settings.isStacked && !isSingle) {\n        bars\n          .style('fill', function () {\n            const thisGroup = d3.select(this.parentNode).attr('data-group-id');\n            return charts.chartColor(thisGroup, 'bar', dataset[thisGroup]);\n          })\n          .attr('mask', function () {\n            const thisGroup = d3.select(this.parentNode).attr('data-group-id');\n            return (dataset[thisGroup].pattern ? `url(#${dataset[thisGroup].pattern})` : null);\n          });\n      } else if (self.settings.isStacked && isSingle) {\n        bars\n          .style('fill', function (d, i) {\n            return charts.chartColor(i, 'bar', d[0]);\n          })\n          .attr('mask', function (d) {\n            return (d[0].pattern ? `url(#${d[0].pattern})` : null);\n          });\n      }\n    }\n\n    $.extend(charts.settings, {\n      svg,\n      chartType: 'Column',\n      isSingle,\n      isGrouped,\n      isStacked: self.settings.isStacked\n    });\n\n    (isPositiveNegative ? pnBars : bars)\n      .on('mouseenter', function (d, i) {\n        let x;\n        let y;  //eslint-disable-line\n        let j;\n        let l;\n        let hexColor;\n        let size;\n        let isTooltipBottom;\n        const maxBarsForTopTooltip = 6;\n        const thisShape = this;\n        const shape = $(this);\n        let content = '';\n        const ePageY = d3.event.pageY;\n\n        const setPattern = function (pattern, hexColor) { //eslint-disable-line\n          return !pattern || !hexColor ? '' :\n            `${'<svg width=\"12\" height=\"12\">' +\n              '<rect style=\"fill: '}${hexColor}\" mask=\"url(#${pattern})\" height=\"12\" width=\"12\" />` +\n            '</svg>';\n        };\n\n        const show = function (isTooltipBottom) { //eslint-disable-line\n          size = charts.tooltipSize(content);\n          x = shape[0].getBoundingClientRect().left - (size.width / 2) + (shape.attr('width') / 2);\n\n          if (self.settings.isStacked) {\n            y = shape[0].getBoundingClientRect().top - size.height - 10;\n          } else {\n            y = ePageY - charts.tooltip.outerHeight() - 25;\n            if (dataset.length > 1) {\n              x = thisShape.parentNode.getBoundingClientRect().left - (size.width / 2) +\n                (thisShape.parentNode.getBoundingClientRect().width / 2);\n              if (isTooltipBottom) {\n                y += charts.tooltip.outerHeight() + 50;\n                if (y > (thisShape.parentNode.getBoundingClientRect().bottom + 10)) {\n                  y = thisShape.parentNode.getBoundingClientRect().bottom + 10;\n                }\n              } else {\n                y = thisShape.parentNode.getBoundingClientRect().top -\n                charts.tooltip.outerHeight() + 25;\n              }\n            }\n          }\n\n          if (content !== '') {\n            charts.showTooltip(x, y, content, isTooltipBottom ? 'bottom' : 'top');\n          }\n        };\n\n        // Stacked\n        if (self.settings.isStacked) {\n          if (isSingle) {\n            content = `<p><b>${format(d[0].value)}</b> ${d[0].name}</p>`;\n          } else {\n            content = `${'' +\n              '<div class=\"chart-swatch\">' +\n                '<div class=\"swatch-caption\"><b>'}${datasetStacked[0][i].name}</b></div>`;\n            for (j = datasetStacked.length - 1, l = 0; j >= l; j--) {\n              hexColor = charts.chartColor(j, 'bar', dataset[j]);\n              content += `${'' +\n                '<div class=\"swatch-row\">' +\n                  '<div style=\"background-color:'}${dataset[j].pattern ? 'transparent' : hexColor};\">${\n                setPattern(dataset[j].pattern, hexColor)\n              }</div>` +\n                  `<span>${datasetStacked[j][i].parentName}</span><b>${format(datasetStacked[j][i].value)}</b>` +\n                '</div>';\n            }\n            content += '</div>';\n          }\n          size = charts.tooltipSize(content);\n          x = shape[0].getBoundingClientRect().left - (size.width / 2) + (shape.attr('width') / 2);\n          y = shape[0].getBoundingClientRect().top - size.height - 10;\n        } else { // Not Stacked\n          if (isPositiveNegative) {\n            content = `${'' +\n              '<div class=\"chart-swatch\">' +\n                '<div class=\"swatch-caption\"><b>'}${d.name}</b></div>` +\n                '<div class=\"swatch-row\">' +\n                  `<div style=\"background-color:${pnPatterns.target ? 'transparent' : color(pnColors.target)};\">${\n                    setPattern(pnPatterns.target, color(pnColors.target))\n                  }</div>` +\n                  `<span>${pnLegends.target}</span><b>${format(d.target)}</b>` +\n                '</div>' +\n                '<div class=\"swatch-row\">' +\n                  `<div style=\"background-color:${d.value < 0 ?\n                    (pnPatterns.negative ? 'transparent' : color(pnColors.negative)) :\n                    (pnPatterns.positive ? 'transparent' : color(pnColors.positive))\n                  };\">${\n                    d.value < 0 ?\n                      setPattern(pnPatterns.negative, color(pnColors.negative)) :\n                      setPattern(pnPatterns.positive, color(pnColors.positive))\n                  }</div>` +\n                  `<span>${pnLegends[d.value < 0 ? 'negative' : 'positive']}</span><b>${format(d.value)}</b>` +\n                '</div>' +\n              '</div>';\n          } else if (dataset.length === 1) {\n            content = `<p><b>${format(d.value)}</b> ${d.name}</p>`;\n          } else {\n            const data = d3.select(this.parentNode).datum().values;\n\n            content = '<div class=\"chart-swatch\">';\n            for (j = 0, l = data.length; j < l; j++) {\n              hexColor = charts.chartColor(j, 'bar', series[j]);\n              content += `${'' +\n                '<div class=\"swatch-row\">' +\n                  '<div style=\"background-color:'}${series[j].pattern ? 'transparent' : hexColor};\">${\n                setPattern(series[j].pattern, hexColor)\n              }</div>` +\n                  `<span>${data[j].name}</span><b>${format(data[j].value)}</b>` +\n                '</div>';\n            }\n            content += '</div>';\n            isTooltipBottom = data.length > maxBarsForTopTooltip;\n          }\n\n          size = charts.tooltipSize(content);\n          x = shape[0].getBoundingClientRect().left - (size.width / 2) + (shape.attr('width') / 2);\n          y = ePageY - charts.tooltip.outerHeight() - 25;\n          if (dataset.length > 1) {\n            x = this.parentNode.getBoundingClientRect().left - (size.width / 2) +\n              (this.parentNode.getBoundingClientRect().width / 2);\n            y = this.parentNode.getBoundingClientRect().top - charts.tooltip.outerHeight() + 25;\n          }\n        }\n\n        if (tooltipData && typeof tooltipData === 'function' && !tooltipDataCache[i]) {\n          content = '';\n          let runInterval = true;\n          tooltipInterval = setInterval(function () {\n            if (runInterval) {\n              runInterval = false;\n              tooltipData(function (data) {\n                content = data;\n                tooltipDataCache[i] = data;\n              });\n            }\n\n            if (content !== '') {\n              clearInterval(tooltipInterval);\n              show();\n            }\n          }, 10);\n        } else {\n          content = tooltipDataCache[i] || tooltipData || content || '';\n          if (d.tooltip) {\n            const val = d.tooltip.replace('{{value}}', format(d.value));\n            content = `<p>${val}</p>`;\n          }\n          show(isTooltipBottom);\n        }\n      })\n\n      // Mouseleave\n      .on('mouseleave', function () {\n        clearInterval(tooltipInterval);\n        charts.hideTooltip();\n      })\n\n      // Click\n      .on('click', function (d, i, clickedLegend) {\n        const isTargetBar = this && d3.select(this).classed('target-bar');\n        let isSelected = this && d3.select(this).classed('is-selected');\n        const thisGroupId = parseInt(d3.select(this.parentNode).attr('data-group-id'), 10);\n\n        // Set isSelected to false if even 1 bar is selected\n        if (isTargetBar) {\n          const allBars = d3.selectAll('.bar').nodes();\n          const len = allBars.length;\n\n          for (let j = 0; j < len; j++) {\n            const bar = allBars[j];\n\n            if (d3.select(bar).classed('is-selected')) {\n              isSelected = false;\n              break;\n            }\n          }\n        }\n\n        charts.setSelectedElement({\n          task: (isSelected ? 'unselected' : 'selected'),\n          container: self.element,\n          selector: this,\n          isTrigger: !isSelected,\n          isTargetBar,\n          triggerGroup: isGrouped,\n          d,\n          i,\n          type: self.settings.type,\n          dataset: self.dataset,\n          isSingle: self.isSingle,\n          isGrouped: self.isGrouped,\n          isStacked: self.settings.isStacked,\n          svg: self.svg,\n          clickedLegend: (clickedLegend === true)\n        });\n\n        if (isSelected) {\n          self.element.triggerHandler('selected', [d3.select(this).nodes(), {}, (isGrouped ? thisGroupId : i)]);\n        }\n      })\n\n      // Contextmenu\n      .on('contextmenu', function (d) {\n        charts.triggerContextMenu(self.element, d3.select(this).nodes()[0], d);\n      });\n\n    // Add Legend\n    self.settings.isGrouped = isGrouped;\n    self.settings.isSingle = isSingle;\n    self.settings.svg = this.svg;\n\n    if (self.settings.showLegend) {\n      if (isSingle && dataset[0].name) {\n        charts.addLegend(dataset, 'column-single', self.settings, self.element);\n      } else if (isPositiveNegative) {\n        charts.addLegend(pnSeries, self.settings.type, self.settings, self.element);\n      } else if (self.settings.isStacked && isSingle) {\n        charts.addLegend(series, self.settings.type, self.settings, self.element);\n      } else if (!isSingle) {\n        charts.addLegend(self.settings.isStacked ? seriesStacked :\n          series, self.settings.type, self.settings, self.element);\n      }\n    }\n\n    if (self.settings.xAxis && self.settings.xAxis.formatText) {\n      self.svg.selectAll('.x.axis .tick text').each(function (m) {\n        const elem = d3.select(this);\n        const text = d3.select(this).text();\n        const markup = self.settings.xAxis.formatText(text, m);\n\n        DOM.html(elem.node(), markup, '<tspan>');\n      });\n    }\n\n    if (charts.isRTL && charts.isIE) {\n      svg.selectAll('text').attr('transform', 'scale(-1, 1)');\n      svg.selectAll('.y.axis text').style('text-anchor', 'start');\n\n      if (isPositiveNegative) {\n        svg.selectAll('.negative-value').style('text-anchor', 'end');\n      }\n    }\n\n    // Set y-axix tick css class\n    svg.selectAll('.y.axis .tick').attr('class', function (d) {\n      return `tick${d === 0 ? ' tick0' : ''}`;\n    });\n\n    // Add Tooltips and legend\n    charts.appendTooltip();\n\n    // See if any labels overlap and use shorter */\n    // [applyAltLabels] - function(svg, dataArray, elem, selector, isNoEclipse)\n    if (charts.labelsColide(svg)) {\n      charts.applyAltLabels(svg, dataArray, 'shortName');\n    }\n\n    if (charts.labelsColide(svg)) {\n      charts.applyAltLabels(svg, dataArray, 'abbrName');\n    }\n\n    if (charts.labelsColide(svg)) {\n      charts.applyAltLabels(svg, dataArray, null, null, true);\n\n      // Adjust extra(x) space with short name for RTL\n      if (isPositiveNegative) {\n        svg.selectAll('.target-bartext, .bartext').attr('x', function () {\n          return +d3.select(this).attr('x') - (isRTL ? -6 : 6);\n        });\n      }\n    }\n\n    charts.setSelected = function (o, isToggle) {\n      let selected = 0;\n      const equals = utils.equals;\n      const legendsNode = svg.node().parentNode.nextSibling;\n      const legends = d3.select(legendsNode);\n      const isLegends = legends.node() && legends.classed('chart-legend');\n      let barIndex;\n      let selector;\n      let isStackedGroup;\n      let xGroup;\n\n      const setSelectedBar = function (g, gIdx) {\n        const isGroup = !!g;\n        g = isGroup ? d3.select(g) : svg;\n        gIdx = typeof gIdx !== 'undefined' ? gIdx : 0;\n        g.selectAll('.bar').each(function (d, i) {\n          if (!d) {\n            return;\n          }\n          if (selected < 1) {\n            if ((typeof o.fieldName !== 'undefined' &&\n                  typeof o.fieldValue !== 'undefined' &&\n                    o.fieldValue === (isSingle && self.settings.isStacked ? d[0][o.fieldName] :\n                      d[o.fieldName])) || //eslint-disable-line\n                (typeof o.index !== 'undefined' && o.index === i) ||\n                (o.data && equals(o.data, dataset[gIdx].data[i])) ||\n                (o.elem && $(this).is(o.elem))) {\n              selected++;\n              selector = d3.select(this);\n              barIndex = i;\n              if (isGroup && !self.settings.isStacked) {\n                isStackedGroup = true;\n              }\n            }\n          }\n        });\n      };\n\n      const setSelectedGroup = function () {\n        const groups = svg.selectAll('.series-group');\n        if (groups.nodes().length) {\n          groups.each(function (d, i) {\n            setSelectedBar(this, i);\n          });\n        }\n      };\n\n      if (isGrouped || (self.settings.isStacked && !isSingle && !isGrouped)) {\n        dataset.forEach(function (d, i) {\n          if (selected < 1) {\n            xGroup = $(svg.select(`[data-group-id=\"${i}\"]`).node());\n            if ((typeof o.groupName !== 'undefined' &&\n                  typeof o.groupValue !== 'undefined' &&\n                    o.groupValue === d[o.groupName]) ||\n                (typeof o.groupIndex !== 'undefined' && o.groupIndex === i) ||\n                (o.data && equals(o.data, d)) ||\n                (o.elem && (xGroup.is(o.elem)))) {\n              if (typeof o.fieldName === 'undefined' &&\n                    typeof o.fieldValue === 'undefined' &&\n                      typeof o.index === 'undefined') {\n                selected++;\n                selector = svg.select(`[data-group-id=\"${i}\"]`).select('.bar');\n                barIndex = i;\n                if (self.settings.isStacked && !isGrouped) {\n                  isStackedGroup = true;\n                }\n              }\n            }\n          }\n        });\n        if (selected < 1) {\n          setSelectedGroup();\n        }\n      } else {\n        setSelectedBar();\n      }\n\n      if (selected > 0 && (isToggle || !selector.classed('is-selected'))) {\n        if (isStackedGroup) {\n          if (isLegends) {\n            $(legends.selectAll('.chart-legend-item')[0][barIndex]).trigger('click.chart');\n          }\n        } else {\n          selector.on('click').call(selector.node(), selector.datum(), barIndex);\n        }\n      }\n    };\n\n    this.setInitialSelected();\n    this.element.trigger('rendered');\n    return this;\n  },\n\n  /**\n   * Set the initially selected elements\n   * @private\n   */\n  setInitialSelected() {\n    let selected = 0;\n    const self = this;\n    const legendsNode = self.svg.node().parentNode.nextSibling;\n    const legends = d3.select(legendsNode);\n    const isLegends = legends.node() && legends.classed('chart-legend');\n    let barIndex;\n    let selector;\n    let isStackedGroup;\n\n    const setSelectedBar = function (g) {\n      g = g ? d3.select(g) : self.svg;\n      g.selectAll('.bar').each(function (d, i) {\n        if (!d) {\n          return;\n        }\n        if ((self.isSingle && self.settings.isStacked ?\n          d[0].selected : d.selected) && selected < 1) {\n          selected++;\n          selector = d3.select(this);\n          barIndex = i;\n        }\n      });\n    };\n\n    const setSelectedGroup = function () {\n      const groups = self.svg.selectAll('.series-group');\n      if (groups.nodes().length) {\n        groups.each(function () {\n          setSelectedBar(this);\n        });\n      }\n    };\n\n    if (self.isGrouped || (self.settings.isStacked && !self.isSingle && !self.isGrouped)) {\n      self.dataset.forEach(function (d, i) {\n        if (d.selected && selected < 1) {\n          selected++;\n          selector = self.svg.select(`[data-group-id=\"${i}\"]`).select('.bar');\n          barIndex = i;\n          if (self.settings.isStacked && !self.isSingle && !self.isGrouped) {\n            isStackedGroup = true;\n          }\n        }\n      });\n      if (selected < 1) {\n        setSelectedGroup();\n      }\n    } else {\n      setSelectedBar();\n    }\n\n    if (selected > 0) {\n      if (isStackedGroup) {\n        if (isLegends) {\n          $(legends.selectAll('.chart-legend-item')[0][barIndex]).trigger('click.chart');\n        }\n      } else {\n        selector.on('click').call(selector.node(), selector.datum(), barIndex);\n      }\n    }\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    if (this.settings.redrawOnResize) {\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n\n      this.element.on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n    }\n\n    return this;\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   * @returns {object} An object with the matching data and reference to the triggering element.\n   */\n  getSelected() {\n    return charts.selected;\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   */\n  setSelected(options, isToggle) {\n    const internals = {\n      svg: this.svg,\n      chartData: this.settings.dataset,\n      isStacked: false,\n      isGrouped: false,\n      isSingle: false\n    };\n    charts.setSelected(options, isToggle, internals);\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   */\n  toggleSelected(options) {\n    this.setSelected(options, true);\n  },\n\n  /*\n   * Handles resizing a chart.\n   * @private\n   * @returns {void}\n   */\n  handleResize() {\n    if (this.width === this.element.width()) {\n      return;\n    }\n\n    this.width = this.element.width();\n\n    if (!this.element.is(':visible')) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n    this.element.empty();\n\n    return this\n      .build();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('column-chart');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'chart');\n  }\n};\n\nexport { Column, COMPONENT_NAME };\n","// Other Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils, math } from '../../utils/utils';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\n\nimport '../emptymessage/emptymessage.jquery';\n\n// Settings and Options\nconst COMPONENT_NAME = 'bar';\n\n/**\n * A bar chart or bar graph is a chart or graph that presents categorical data with rectangular bars\n * with heights or lengths proportional to the values that they represent. This is adapated from\n * http://jsfiddle.net/datashaman/rBfy5/2/\n * @class Bar\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings] The settings element.\n * @param {array} [settings.dataset=[]] The data to use in the line/area/bubble.\n * @param {boolean} [settings.isStacked=true] Default is a single or stacked chart.\n * @param {boolean} [settings.isNormalized=false] If true its a 100% bar chart\n * @param {boolean} [settings.isGrouped=false] If true its a grouped bar chart\n * @param {boolean} [settings.showLegend=true] If false the legend will not be shown.\n * @param {boolean|string} [settings.animate=true] true|false - will do or not do the animation, 'initial' will do only first time the animation.\n * @param {boolean} [settings.redrawOnResize=true] If true, the component will not resize when resizing the page.\n * @param {string} [settings.formatterString] Use d3 format some examples can be found on http://bit.ly/1IKVhHh\n * @param {string} [settings.format=true] The d3 axis format\n * @param {string} [settings.tooltip=null] A tooltip for the whole chart\n * @param {boolean} [settings.useLogScale=false] If true log scale is enabled.\n * @param {object} [settings.ticks=null] Settings for the chart ticks. Can set ticks: {format: d3Format, number: n}\n * @param {boolean} [settings.showLines=true] Show the in the axis lines or not.\n * @param {number} [settings.labelFactor=1.27] How far out than the outer circle should the labels be placed, this\n * may be useful to adjust for some labels.\n * @param {number} [settings.wrapWidth=60] The number of pixels after which a label needs to be given a new line.\n * You may want to change this based on label data.\n * @param {object} [settings.emptyMessage={\n *  title: (Locale ? Locale.translate('NoData') : 'No Data Available'),\n *   info: '',\n *  icon: 'icon-empty-no-data' }]\n * An empty message will be displayed when there is no chart data. This accepts an object of the form emptyMessage:\n * `{title: 'No Data Available',\n *  info: 'Make a selection on the list above to see results'\n *  icon: 'icon-empty-no-data',\n *  button: {text: 'xxx', click: <function>}  }`\n * Set this to null for no message or will default to 'No Data Found with an icon.'\n */\nconst BAR_DEFAULTS = {\n  dataset: [],\n  isStacked: true,\n  isNormalized: false,\n  isGrouped: false,\n  showLegend: true,\n  animate: true,\n  longText: false,\n  format: null,\n  redrawOnResize: true,\n  tooltip: null,\n  useLogScale: false,\n  ticks: null,\n  showLines: true,\n  labelFactor: 1.27,\n  wrapWidth: 60,\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' }\n};\n\nfunction Bar(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, BAR_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nBar.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The component prototype for chaining.\n   */\n  init() {\n    this.width = 0;\n    this\n      .build()\n      .handleEvents();\n\n    // Handle initial option\n    if (this.settings.animate === 'initial') {\n      this.settings.animate = false;\n    }\n\n    /**\n    * Fires when the chart is complete done rendering, for customization.\n    * @event rendered\n    * @memberof Bar\n    * @param {object} event - The jquery event object\n    * @param {array} svg - The svg object.\n    */\n    this.element.trigger('rendered', [this.svg]);\n    return this;\n  },\n\n  /**\n   * Build the Component.\n   * @returns {object} The component prototype for chaining.\n   * @private\n   */\n  build() {\n    const self = this;\n    const isRTL = Locale.isRTL();\n    const isFormatter = !!this.settings.formatterString;\n    const format = function (value) {\n      return isFormatter ? d3.format(self.settings.formatterString)(value) : value;\n    };\n\n    let maxTextWidth;\n    let yMap;\n    let isGrouped;\n    let legendMap;\n    let gindex;\n    let totalBarsInGroup;\n    let totalGroupArea;\n    let totalHeight;\n    let gap;\n    let barHeight;\n\n    let tooltipInterval;\n    const tooltipDataCache = [];\n    const tooltipData = self.settings.tooltip;\n\n    let maxBarHeight = 30;\n    const legendHeight = 30;\n    const gapBetweenGroups = 0.6; // Makes it one bar in height (barHeight * 0.5)\n    const isViewSmall = this.element.parent().width() < 450;\n    const smallViewport = innerWidth <= 480;\n    const mediumViewport = innerWidth >= 481 && innerWidth <= 992;\n    const largeViewport = innerWidth > 992;\n    let dataset = this.settings.dataset;\n\n    const margins = {\n      top: 20,\n      left: 30,\n      right: 30,\n      bottom: dataset.length === 1 ? 5 : 30\n    };\n\n    this.element.addClass('bar-chart');\n    if (this.settings.isGrouped) {\n      this.element.addClass('bar-chart-grouped');\n    }\n\n    if (this.settings.isStacked) {\n      this.element.addClass('bar-chart-stacked');\n    }\n\n    // Handle Empty Data Set\n    if (dataset.length === 0) {\n      self.element.emptymessage(self.settings.emptyMessage);\n      return this;\n    }\n\n    // const width = parseInt(this.element.parent().width(), 10) - margins.left - margins.right;\n    const height = parseInt(this.element.parent().height(), 10) - margins.top - margins.bottom -\n      legendHeight; // influences the bar width\n\n    // Get the Legend Series'\n    const series = dataset.map(function (d) { //eslint-disable-line\n      return { name: d.name, color: d.color, pattern: d.pattern };\n    });\n\n    // Map the Data Sets and Stack them.\n    const yStack = { y1: [], y2: [] };\n    dataset = dataset.map(function (d, i) {  //eslint-disable-line\n      return d.data.map(function (o, i2) { //eslint-disable-line\n        let y0 = 0;\n        if (i === 0) {\n          yStack.y1.push(o.value);\n          yStack.y2.push(0);\n        } else {\n          y0 = yStack.y1[i2] + yStack.y2[i2];\n          yStack.y1[i2] = o.value;\n          yStack.y2[i2] = y0;\n        }\n        return $.extend({}, o, {  //eslint-disable-line\n          y0,\n          y: o.value,\n          x: o.name,\n          color: o.color,\n          pattern: o.pattern\n        });\n      });\n    });\n\n    // Calculate max text width\n    maxTextWidth = 0;\n    dataset = dataset.map(function (group, i) { // eslint-disable-line\n      if (!self.settings.isStacked) {\n        if (series[i]) {\n          maxTextWidth = (series[i].name.length > maxTextWidth ?\n            series[i].name.length : maxTextWidth);\n        }\n      }\n      return group.map(function (d) { // eslint-disable-line\n        if (self.settings.isStacked) {\n          maxTextWidth = (d.x.length > maxTextWidth ? d.x.length : maxTextWidth);\n        }\n\n        // Invert the x and y values, and y0 becomes x0\n        return $.extend({}, d, {\n          x: d.y,\n          y: d.x,\n          x0: d.y0,\n          color: d.color,\n          pattern: d.pattern\n        });\n      });\n    });\n\n    const isLongText = this.settings.longText;\n    const h = parseInt(this.element.parent().height(), 10) - margins.bottom -\n      (self.settings.isStacked ? 0 : (legendHeight / 2));\n    const w = parseInt(this.element.parent().width(), 10) - margins.left;\n    let textWidth;\n\n    if (smallViewport) {\n      textWidth = margins.left + maxTextWidth * 1;\n    } else if (mediumViewport) {\n      textWidth = margins.left + maxTextWidth * 4;\n    } else if (largeViewport) {\n      textWidth = margins.left + maxTextWidth * 6;\n    }\n\n    if (!isLongText) {\n      textWidth = margins.left + maxTextWidth * 6;\n    }\n\n    self.svg = d3.select(this.element[0])\n      .append('svg')\n      .attr('width', w)\n      .attr('height', h)\n      .append('g')\n      .attr('class', 'group')\n      .attr('transform', `translate(${textWidth},${margins.top})`);\n\n    let xMin = d3.min(dataset, function (group) { //eslint-disable-line\n      return d3.min(group, function (d) { //eslint-disable-line\n        return self.settings.isStacked ? (d.x + d.x0) : d.x;\n      });\n    });\n\n    let xMax = d3.max(dataset, function (group) { //eslint-disable-line\n      return d3.max(group, function (d) { //eslint-disable-line\n        return self.settings.isStacked ? (d.x + d.x0) : d.x;\n      });\n    });\n\n    if (self.settings.isStacked && self.settings.isNormalized) {\n      const gMax = [];\n      // get the max for each array group\n      dataset.forEach(function (d) {  //eslint-disable-line\n        d.forEach(function (d, i) {  //eslint-disable-line\n          gMax[i] = (gMax[i] === undefined ? 0 : gMax[i]) + d.x;\n        });\n      });\n\n      // Normalize Each Group\n      dataset.forEach(function (d) {   //eslint-disable-line\n        d.forEach(function (d, i) {  //eslint-disable-line\n          const xDif = gMax[i] / 100;\n          d.x /= xDif;\n          d.x0 /= xDif;\n        });\n      });\n      xMax = 100;\n    }\n\n    // Width of the bar minus the margin\n    const barWith = w - textWidth - margins.left;\n    let xScale;\n\n    if (self.settings.useLogScale) {\n      xScale = d3.scaleLog()\n        .domain([(xMin > 0 ? xMin : 1), xMax])\n        .range([1, barWith])\n        .nice();\n    } else {\n      xScale = d3.scaleLinear()\n        .domain([(xMin < 0 ? xMin : 0), xMax])\n        .range([0, barWith])\n        .nice();\n    }\n\n    if (self.settings.isStacked) {\n      yMap = dataset[0].map(d => d.y);\n\n      barHeight = 0.32;\n    } else {\n      yMap = series.map(d => d.name);\n\n      (function () {\n        let i;\n        let l;\n        let lm;\n        // Loop backwards to catch and override with found first custom info from top\n        for (i = dataset.length - 1, l = -1; i > l; i--) {\n          lm = dataset[i].map(d => d);\n          $.extend(true, legendMap, lm);\n          // Convert back to array from object\n          legendMap = $.map(legendMap, d => d);\n        }\n      }());\n\n      gindex = 0;\n      totalBarsInGroup = legendMap.length;\n      totalGroupArea = height / yMap.length;\n      barHeight = totalGroupArea / totalBarsInGroup;\n      totalHeight = totalBarsInGroup > 1 ?\n        totalGroupArea - (barHeight * gapBetweenGroups) : maxBarHeight;\n      gap = totalGroupArea - totalHeight;\n      maxBarHeight = totalHeight / totalBarsInGroup;\n      barHeight = 0;\n    }\n\n    const yScale = d3.scaleBand()\n      .domain(yMap)\n      .rangeRound([0, height])\n      .padding(barHeight, barHeight); // TODO\n\n    const xAxis = d3.axisBottom()\n      .scale(xScale)\n      .tickSize(-height); //  .orient('middle') ??\n\n    if (isViewSmall) {\n      xAxis.ticks(textWidth < 100 ? 5 : 3);\n    }\n\n    if (self.settings.isStacked && self.settings.isNormalized) {\n      xAxis.tickFormat(d => `${d}%`);\n    }\n\n    if (self.settings.useLogScale) {\n      xAxis.ticks(10, ',.1s');\n\n      if (self.settings.showLines === false) {\n        xAxis.tickSize(0);\n      }\n    }\n\n    if (self.settings.ticks && !self.settings.useLogScale) {\n      if (smallViewport) {\n        xAxis.ticks(self.settings.ticks.smallNumber, self.settings.ticks.format);\n      } else if (mediumViewport) {\n        xAxis.ticks(self.settings.ticks.mediumNumber, self.settings.ticks.format);\n      } else if (largeViewport) {\n        xAxis.ticks(self.settings.ticks.largeNumber, self.settings.ticks.format);\n      }\n    }\n\n    const yAxis = d3.axisLeft()\n      .scale(yScale)\n      .tickPadding(15)\n      .tickSize(0);\n\n    self.svg.append('g')\n      .attr('class', 'axis x')\n      .attr('transform', `translate(0,${height})`)\n      .call(xAxis);\n\n    self.svg.append('g')\n      .attr('class', 'axis y')\n      .call(yAxis);\n\n    const groups = self.svg.selectAll('g.group')\n      .data(dataset)\n      .enter()\n      .append('g')\n      .attr('class', 'series-group')\n      .attr('data-group-id', (d, i) => i);\n\n    self.settings.isGrouped = (self.svg.selectAll('.series-group').nodes().length > 1 && !self.settings.isStacked);\n    self.settings.isSingle = (self.svg.selectAll('.series-group').nodes().length === 1 && self.settings.isStacked);\n\n    groups.selectAll('rect')\n      .data((d, i) => {\n        d.forEach((d3) => {\n          d3.index = i;\n\n          if (!self.settings.isStacked) {\n            d3.gindex = gindex++;\n          }\n        });\n        return d;\n      })\n      .enter()\n      .append('rect')\n      .attr('class', (d, i) => `bar series-${i}`)\n      .style('fill', (d, i) => (self.settings.isStacked ? // eslint-disable-line\n        (series.length === 1 ? (charts.chartColor(i, 'bar-single', d)) :  // eslint-disable-line\n          (charts.chartColor(d.index, 'bar', series[d.index]))) : // eslint-disable-line\n        (charts.chartColor(i, 'bar', legendMap[i])))) // eslint-disable-line\n      .attr('mask', (d, i) => {\n        if (dataset.length === 1 && dataset[0][i].pattern) {\n          return `url(#${dataset[0][i].pattern})`;\n        } else if (self.settings.isStacked && series[d.index].pattern) {\n          return `url(#${series[d.index].pattern})`;\n        } else if (!self.settings.isStacked && legendMap[i].pattern) {\n          return `url(#${legendMap[i].pattern})`;\n        }\n        return '';\n      })\n      .attr('x', (d) => {\n        if (self.settings.useLogScale) {\n          return 0;\n        }\n        return (self.settings.isStacked && !self.settings.isSingle) ? xScale(d.x0) : xScale(0);\n      })\n      .attr('y', d => (self.settings.isStacked ? yScale(d.y) :\n        ((((totalGroupArea - totalHeight) / 2) + (d.gindex * maxBarHeight)) + (d.index * gap))))\n      .attr('height', () => (self.settings.isStacked ? (yScale.bandwidth()) : maxBarHeight))\n      .attr('width', 0) // Animated in later\n      .on('mouseenter', function (d, i) {\n        let j;\n        let l;\n        let hexColor;\n        let total = 0;\n        const totals = [];\n        let content = '';\n        const data = d3.select(this.parentNode).datum();\n        const mid = Math.round(data.length / 2);\n        let shape = d3.select(this);\n        const setPattern = function (pattern, hexColor2) {\n          return !pattern || !hexColor2 ? '' :\n            `<svg width=\"12\" height=\"12\"><rect mask=\"url(#${pattern})\" height=\"12\" width=\"12\" /></svg>`;\n        };\n\n        const show = function (xPosS, yPosS, isTooltipBottom) {\n          const size = charts.tooltipSize(content);\n          const x = xPosS + (parseFloat(shape.attr('width')) / 2) - (size.width / 2);\n          const y = isTooltipBottom ? yPosS : (yPosS - size.height - 13);\n\n          if (content !== '') {\n            charts.showTooltip(x, y, content, isTooltipBottom ? 'bottom' : 'top');\n          }\n        };\n\n        if (dataset.length === 1) {\n          content = `<p><b>${d.y} </b>${d.x}</p>`;\n        } else {\n          content = '<div class=\"chart-swatch\">';\n\n          if (self.settings.isStacked) {\n            for (j = 0, l = dataset.length; j < l; j++) {\n              total = 0;\n              hexColor = charts.chartColor(j, 'bar', series[j]);\n              for (let k = 0, kl = dataset.length; k < kl; k++) {\n                total += dataset[k][i].x;\n                totals[k] = dataset[k][i].x;\n              }\n              content += `<div class=\"swatch-row\">\n                  <div class=\"swatch-color\">${setPattern(series[j].pattern, hexColor)}</div>\n                  <span>${series[j].name}</span>\n                  <b> ${isFormatter ? format(totals[j]) : (`${Math.round((totals[j] / total) * 100)}%`)} </b>\n                </div>`;\n            }\n          } else {\n            if (mid > 1) {\n              shape = d3.select(this.parentNode).select(`.series-${mid}`);\n            }\n            for (j = 0, l = data.length; j < l; j++) {\n              hexColor = charts.chartColor(j, 'bar', legendMap[j]);\n              content += `<div class=\"swatch-row\">\n                    <div class=\"swatch-color\">${setPattern(legendMap[j].pattern, hexColor)}</div>\n                  <span>${data[j].name}</span><b>${format(data[j].value)}</b>\n                </div>`;\n            }\n          }\n          content += '</div>';\n        }\n\n        if (total > 0) {\n          content = `<span class=\"chart-tooltip-total\"><b>${total}</b> ${Locale.translate('Total')}</span>${content}`;\n        }\n\n        const yPosS = shape.nodes()[0].getBoundingClientRect().top + $(window).scrollTop();\n        const xPosS = shape.nodes()[0].getBoundingClientRect().left + $(window).scrollLeft();\n\n        const maxBarsForTopTooltip = 6;\n        const isTooltipBottom = (!self.settings.isStacked && (data.length > maxBarsForTopTooltip));\n\n        if (tooltipData && typeof tooltipData === 'function' && !tooltipDataCache[i]) {\n          content = '';\n          let runInterval = true;\n          tooltipInterval = setInterval(() => {\n            if (runInterval) {\n              runInterval = false;\n              tooltipData((data2) => {\n                content = data2;\n                tooltipDataCache[i] = data2;\n              });\n            }\n            if (content !== '') {\n              clearInterval(tooltipInterval);\n              show(xPosS, yPosS, isTooltipBottom);\n            }\n          }, 10);\n        } else {\n          content = tooltipDataCache[i] || tooltipData || d.tooltip || content || '';\n          show(xPosS, yPosS, isTooltipBottom);\n\n          // set inline colors\n          if (self.settings.isStacked) {\n            for (j = 0, l = dataset.length; j < l; j++) {\n              hexColor = charts.chartColor(j, 'bar', series[j]);\n\n              const row = $('#svg-tooltip').find('.swatch-row').eq(j);\n              if (!series[j].pattern) {\n                row.find('div').css('background-color', hexColor);\n              }\n              row.find('rect').css('fill', hexColor);\n            }\n          } else {\n            for (j = 0, l = data.length; j < l; j++) {\n              hexColor = charts.chartColor(j, 'bar', legendMap[j]);\n\n              const row = $('#svg-tooltip').find('.swatch-row').eq(j);\n              if (!legendMap[j].pattern) {\n                row.find('div').css('background-color', hexColor);\n              }\n              row.find('rect').css('fill', hexColor);\n            }\n          }\n        }\n      })\n      .on('mouseleave', () => {\n        clearInterval(tooltipInterval);\n        charts.hideTooltip();\n      })\n      .on('click', function (d, i) {\n        const isSelected = this && d3.select(this).classed('is-selected');\n        const thisGroupId = parseInt(d3.select(this.parentNode).attr('data-group-id'), 10);\n\n        charts.setSelectedElement({\n          task: (isSelected ? 'unselected' : 'selected'),\n          container: self.element,\n          selector: this,\n          isTrigger: !isSelected,\n          triggerGroup: self.settings.isGrouped,\n          d,\n          i,\n          type: self.settings.type,\n          dataset,\n          isSingle: self.isSingular,\n          isGrouped: self.settings.isGrouped,\n          isStacked: self.settings.isStacked,\n          svg: self.svg,\n          clickedLegend: self.settings.clickedLegend\n        });\n\n        if (isSelected) {\n          self.element.triggerHandler('selected', [d3.select(this).nodes(), {}, (isGrouped ? thisGroupId : i)]);\n        }\n      });\n\n    // Adjust the labels\n    self.svg.selectAll('.axis.y text').attr('x', () => (isRTL ? 15 : -15));\n    self.svg.selectAll('.axis.x text').attr('class', d => (d < 0 ? 'negative-value' : 'positive-value'));\n\n    if (isRTL && (charts.isIE || charts.isIEEdge)) {\n      self.svg.selectAll('text').attr('transform', 'scale(-1, 1)');\n      self.svg.selectAll('.y.axis text').style('text-anchor', 'start');\n    }\n\n    if (isViewSmall && self.settings.useLogScale) {\n      const ticks = d3.selectAll('.x .tick text');\n      let foundMid = false;\n\n      // At small breakpoint hide the last ones\n      ticks.attr('class', function (d, i) {\n        let middleTick = Math.round(ticks.size() / 2);\n\n        if (i >= middleTick && !foundMid && d.toString().startsWith('1')) {\n          foundMid = true;\n          middleTick = d;\n        }\n\n        if (i !== 0 && i !== ticks.size() - 1 &&\n          (self.settings.useLogScale ? d !== middleTick : i !== middleTick)) {\n          d3.select(this).remove();\n        }\n      });\n    }\n\n    // Set x-axix tick css class\n    self.svg.selectAll('.x.axis .tick').attr('class', d => `tick${d === 0 ? ' tick0' : ''}`);\n\n    // Animate the Bars In\n    self.svg.selectAll('.bar')\n      .transition().duration(self.settings.animate ? 600 : 0)\n      .attr('width', (d) => {\n        let scale = xScale(d.x);\n        let scale0 = xScale(0);\n\n        if (isNaN(scale) || !math.isFinite(scale)) {\n          scale = 0;\n        }\n\n        if (isNaN(scale0) || !math.isFinite(scale0)) {\n          scale0 = 0;\n        }\n\n        return Math.abs(scale - scale0);\n      })\n      .attr('x', (d) => {\n        if (self.settings.useLogScale) {\n          return 0;\n        }\n        return (self.settings.isStacked && !self.settings.isSingle) ? xScale(d.x0) :  //eslint-disable-line\n          (d.x < 0 ? xScale(d.x) : xScale(0));\n      });\n\n    self.settings.svg = self.svg;\n\n    // Add Legends\n    if (self.settings.showLegend) {\n      charts.addLegend(\n        (self.settings.isStacked ? series : legendMap),\n        self.settings.type,\n        self.settings,\n        this.element\n      );\n      // charts.addLegend(self.settings.isStacked ? series : legendMap);\n    }\n    charts.appendTooltip();\n\n    this.setInitialSelected();\n    this.setTextValues();\n    this.element.trigger('rendered');\n    return this;\n  },\n\n  /**\n   * Set the text value in three viewport of bar chart\n   * @private\n   */\n  setTextValues() {\n    if (this.settings.isGrouped) {\n      // These are TODO, as you need a different structure since its using the group name\n      return;\n    }\n\n    const elems = document.querySelectorAll('.bar-chart .axis.y .tick text');\n    const dataset = this.settings.dataset;\n    for (let i = 0; i < dataset.length; i++) {\n      const values = Object.keys(dataset[i]).map(e => dataset[i][e]);\n      values.forEach((key) => {\n        if (key && key.constructor === Array) {\n          for (let j = 0; j < key.length; j++) {\n            if (innerWidth <= 480) {\n              elems[j].textContent = key[j].shortName || key[j].name;\n            } else if (innerWidth >= 481 && innerWidth <= 992) {\n              elems[j].textContent = key[j].abbrName || key[j].name;\n            } else if (innerWidth > 992) {\n              elems[j].textContent = key[j].name;\n            }\n          }\n        }\n      });\n    }\n  },\n\n  /**\n   * Set the initially selected elements\n   * @private\n   */\n  setInitialSelected() {\n    let selected = 0;\n    const self = this;\n    const legendsNode = self.svg.node().parentNode.nextSibling;\n    const legends = d3.select(legendsNode);\n    const isLegends = legends.node() && legends.classed('chart-legend');\n    let barIndex;\n    let selector;\n    let isStackedGroup;\n\n    const setSelectedBar = function (g) {\n      g = g ? d3.select(g) : self.svg;\n      g.selectAll('.bar').each(function (d, i) {\n        if (!d) {\n          return;\n        }\n        if (d.selected && selected < 1) {\n          selected++;\n          selector = d3.select(this);\n          barIndex = i;\n        }\n      });\n    };\n\n    const setSelectedGroup = function () {\n      const groups = self.svg.selectAll('.series-group');\n      if (groups.nodes().length) { // eslint-disable-line\n        groups.each(function () {\n          setSelectedBar(this);\n        });\n      }\n    };\n\n    if (self.settings.isGrouped || (self.settings.isStacked && !self.settings.isSingle)) {\n      self.settings.dataset.forEach((d, i) => {\n        if (d.selected && selected < 1) {\n          selected++;\n          selector = self.svg.select(`[data-group-id=\"${i}\"]`).select('.bar');\n          barIndex = i;\n          if (self.settings.isStacked && !self.settings.isGrouped) {\n            isStackedGroup = true;\n          }\n        }\n      });\n      if (selected < 1) {\n        setSelectedGroup();\n      }\n    } else {\n      setSelectedBar();\n    }\n\n    if (selected > 0) {\n      if (isStackedGroup) {\n        if (isLegends) {\n          $(legends.selectAll('.chart-legend-item')[0][barIndex]).trigger('click.chart');\n        }\n      } else {\n        selector.on('click').call(selector.node(), selector.datum(), barIndex);\n      }\n    }\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    if (this.settings.redrawOnResize) {\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n\n      this.element.on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n    }\n\n    return this;\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   * @returns {object} An object with the matching data and reference to the triggering element.\n   */\n  getSelected() {\n    return charts.selected;\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   */\n  setSelected(options, isToggle) {\n    const internals = {\n      svg: this.svg,\n      chartData: this.settings.dataset,\n      isStacked: this.settingsisStacked,\n      isGrouped: this.settings.isGrouped,\n      isSingle: this.settings.isSingle\n    };\n    charts.setSelected(options, isToggle, internals);\n  },\n\n  /*\n   * Get info on the currently selected lines.\n   */\n  toggleSelected(options) {\n    this.setSelected(options, true);\n  },\n\n  /*\n   * Handles resizing a chart.\n   * @private\n   * @returns {void}\n   */\n  handleResize() {\n    if (this.width === this.element.width()) {\n      return;\n    }\n\n    this.width = this.element.width();\n\n    if (!this.element.is(':visible')) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n    this.element.empty();\n\n    return this\n      .build()\n      .element.trigger('rendered', [this.svg]);\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('bar-chart');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'chart');\n  }\n};\n\nexport { Bar, COMPONENT_NAME };\n","/* eslint-disable no-nested-ternary, prefer-arrow-callback */\n// Other Shared Imports\nimport * as debug from '../../utils/debug';\nimport { Environment as env } from '../../utils/environment';\nimport { utils } from '../../utils/utils';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\n\nimport '../emptymessage/emptymessage.jquery';\n\n// Settings and Options\nconst COMPONENT_NAME = 'pie';\n\n/**\n * A pie chart (or a circle chart) is a circular statistical graphic which is divided\n  into slices to illustrate numerical proportion. In a pie chart, the arc length of each slice is proportional to the quantity it represents.\n * @class Pie\n * @constructor\n *\n * @param {jquery[]|htmlelement} element The plugin element for the constuctor\n * @param {object} [settings] The component settings.\n * @param {array} [settings.dataset] The data to use in the line/area/bubble.\n * @param {boolean} [settings.isDonut=false] If true it renders as a donut chart.\n * @param {boolean} [settings.redrawOnResize=true] If true, the component will not resize when resizing the page. There is tooltip values provided.\n  It will not be shown. If you still want lines at the lower breakpoint you can set this to true\n * @param {boolean} [settings.hideCenterLabel=false] If false the center label will not be shown.\n * @param {boolean} [settings.showLines=true] If false connector lines wont be shown\n * @param {boolean} [settings.showLinesMobile=false] This defaults to false, when false and under 450px the lines\n * @param {object} [settings.lines] A setting that controls the line values and format.\n * @param {string} [settings.line.show='value'] Controls the line value, this can be value, label or percent or custom function.\n * @param {string} [settings.line.formatter='.0f'] The d3.formatter string.\n * @param {boolean} [settings.showLegend=true] If false the legend will not be shown.\n * @param {boolean} [settings.showMobile=false] If true the chart is better formed to fit in a single widget.\n * @param {string} [settings.legendPlacement='right'] Where to locate the legend. This can be bottom or right at the moment.\n * @param {object} [settings.legend] A setting that controls the legend values and format.\n * @param {string} [settings.legend.show='label (percent)'] Controls what is visible\n  in the legend, this can be value, value (percent), label or percent or your own custom function.\n * @param {string} [settings.legend.formatter='.0f'] The d3.formatter string.\n * @param {boolean} [settings.showTooltips=true] If false now tooltips will be shown\n * @param {object} [settings.tooltip] A setting that controls the tooltip values and format.\n * @param {string} [settings.tooltip.show='label (value)'] Controls what is visible in\n  the tooltip, this can be value, label or percent or custom function.\n * @param {string} [settings.tooltip.formatter='.0f'] The d3.formatter string.\n * @param {object} [settings.emptyMessage] An empty message will be displayed when there is no chart data.\n * This accepts an object of the form emptyMessage:\n * `{title: 'No Data Available',\n *  info: 'Make a selection on the list above to see results', icon: 'icon-empty-no-data',\n *  button: {text: 'xxx', click: <function>}\n *  }`\n *  Set this to null for no message or will default to 'No Data Found with an icon.'\n */\n\nconst PIE_DEFAULTS = {\n  dataset: [],\n  isDonut: false,\n  redrawOnResize: true,\n  hideCenterLabel: false,\n  showLines: true,\n  showLinesMobile: false,\n  lines: {\n    show: 'value', // value, label or percent or custom function\n    formatter: '.0f'\n  },\n  showLegend: true,\n  legendPlacement: 'right', // Can be bottom or right\n  legend: {\n    show: 'label (percent)', // value, label, label (percent) or percent or custom function\n    formatter: '.0f'\n  },\n  showTooltips: true,\n  tooltip: {\n    show: 'label (value)', // value, label, label (value) or percent or custom function\n    formatter: '.0f'\n  },\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' }\n};\n\nfunction Pie(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, PIE_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nPie.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The component prototype for chaining.\n   */\n  init() {\n    this.width = 0;\n    this.isFirefox = env.browser.name === 'firefox';\n\n    // Handle Empty Data Set\n    if (this.settings.dataset.length === 0) {\n      this.element.emptymessage(this.settings.emptyMessage);\n      return this;\n    }\n\n    this\n      .build()\n      .handleEvents();\n\n    /**\n     * Fires when the chart is complete done rendering, for customization.\n     * @event rendered\n     * @memberof Pie\n     * @property {object} event - The jquery event object\n     * @property {object} svg - The svg object.\n     */\n    this.element.trigger('rendered', [this.svg]);\n\n    return this;\n  },\n\n  /**\n   * Build the Component.\n   * @private\n   * @returns {object} The component prototype for chaining.\n   */\n  build() {\n    const self = this;\n\n    self.svg = d3.select(this.element[0])\n      .append('svg');\n\n    self.mainGroup = self.svg.append('g');\n\n    self.mainGroup.append('g').attr('class', 'slices');\n    self.mainGroup.append('g').attr('class', 'labels');\n    self.mainGroup.append('g').attr('class', 'lines');\n    this.element.addClass('chart-pie');\n\n    if (this.settings.showMobile) {\n      this.settings.legendPlacement = 'bottom';\n    }\n\n    if (self.settings.legendPlacement) {\n      this.element.addClass(`has-${self.settings.legendPlacement}-legend`);\n    }\n\n    const w = parseInt(this.element.width(), 10);\n    const h = parseInt(this.element.height(), 10);\n\n    const dims = {\n      height: h,\n      width: w\n    };\n\n    if (self.settings.legendPlacement === 'right') {\n      dims.width = w * 0.75;\n    }\n\n    if (this.settings.showMobile) {\n      dims.height = h * 0.80; // make some more room for the legend\n      this.element.addClass('is-mobile');\n    }\n\n    dims.radius = Math.min(dims.width, dims.height) / 2;\n    self.dims = dims;\n\n    self.pie = d3.pie()\n      .sort(null)\n      .value(function (d) {\n        return d.value;\n      });\n\n    self.arc = d3.arc()\n      .outerRadius(dims.radius * 0.75)\n      .innerRadius(self.settings.isDonut ? dims.radius * 0.5 : 0);\n\n    // Influences the label position\n    self.outerArc = d3.arc()\n      .innerRadius(dims.radius * 0.75)\n      .outerRadius((dims.radius * 0.75 + 20));\n\n    self.svg\n      .attr('width', self.settings.legendPlacement === 'right' ? '75%' : '100%')\n      .attr('height', self.settings.showMobile ? '80%' : '100%');\n\n    self.mainGroup\n      .attr('transform', `translate(${dims.width / 2},${dims.height / 2})`);\n\n    // move the origin of the group's coordinate space to the center of the SVG element\n    dims.center = { x: (dims.width / 2), y: dims.height / 2 };\n\n    self.key = function (d) { return d.data.name; };\n    const isEmpty = !self.settings.dataset || self.settings.dataset.length === 0;\n    this.chartData = !isEmpty ? self.settings.dataset[0].data : [];\n    this.sum = d3.sum(this.chartData, function (d) { return d.value; });\n\n    // Calculate the percentages\n    const values = this.chartData.map(function (d) { return d.value / self.sum * 100; });\n    const rounded = this.roundLargestRemainer(values);\n\n    this.chartData = this.chartData.map(function (d, i) {\n      d.percent = d.value / self.sum;\n      d.percentRound = rounded[i];\n      return d;\n    });\n\n    let sum = 0;\n    this.chartData.map(function (d) { // eslint-disable-line\n      sum += d.percentRound;\n    });\n\n    // Handle zero sum or empty pies\n    if (isEmpty || sum === 0 || isNaN(sum)) {\n      this.chartData.push({ data: {}, color: '#BDBDBD', name: 'Empty-Pie', value: 100, percent: 1, percentRound: 100 });\n    }\n\n    self.updateData(self.chartData);\n    if (self.settings.showTooltips) {\n      charts.appendTooltip('is-pie');\n    }\n\n    if (this.settings.showLegend) {\n      const series = self.chartData.map(function (d) {\n        let name = charts.formatToSettings(d, self.settings.legend);\n\n        if (self.settings.legendFormatter) {\n          name = `${d.name} (${d3.format(self.settings.legendFormatter)(d.value)})`;\n        }\n\n        if (d.name === 'Empty-Pie') {\n          name = '';\n        }\n        return { name, display: 'twocolumn', placement: self.settings.legendPlacement, color: d.color };\n      });\n\n      this.settings.svg = self.svg;\n      charts.addLegend(series, 'pie', this.settings, this.element);\n    }\n\n    this.setInitialSelected();\n    this.addCenterLabel();\n    this.element.trigger('rendered');\n    return this;\n  },\n\n  /**\n   * Randomize the data for testing.\n   * @private\n   * @param  {boolean} toZero Set them all to zero value.\n   * @returns {void}\n   */\n  randomize(toZero) {\n    const self = this;\n    this.chartData = this.chartData.map(function (d) {\n      d.value = toZero ? 0 : Math.random();\n      return d;\n    });\n\n    this.sum = d3.sum(this.chartData, function (d) { return d.value; });\n    const values = this.chartData.map(function (d) { return d.value / self.sum * 100; });\n    const rounded = this.roundLargestRemainer(values);\n\n    this.chartData = this.chartData.map(function (d, i) {\n      d.percent = d.value / self.sum;\n      d.percentRound = rounded[i];\n      return d;\n    });\n\n    return this.chartData;\n  },\n\n  /**\n   * Add the center label for donut chart.\n   * @private\n   * @returns {void}\n   */\n  addCenterLabel() {\n    const self = this;\n\n    if (self.settings.isDonut && !self.settings.hideCenterLabel) {\n      const centerLabel = self.settings.dataset[0].centerLabel;\n      const arcs = self.svg.selectAll('.slices');\n\n      arcs\n        .append('text')\n        .attr('dy', '.35em')\n        .style('text-anchor', 'middle')\n        .attr('class', 'chart-donut-text')\n        .html(centerLabel);\n\n      // FIX: IE does not render .html\n      // http://stackoverflow.com/questions/13962294/dynamic-styling-of-svg-text\n      if (charts.isIE && !charts.isIEEdge) {\n        if (utils.isHTML(centerLabel)) {\n          const text = arcs.select('.chart-donut-text');\n          const tmp = document.createElement('text');\n\n          tmp.innerHTML = centerLabel;\n\n          const nodes = Array.prototype.slice.call(tmp.childNodes);\n          nodes.forEach(function (node) {\n            text.append('tspan')\n              .attr('style', node.getAttribute && node.getAttribute('style'))\n              .attr('x', node.getAttribute && node.getAttribute('x'))\n              .attr('dy', node.getAttribute && node.getAttribute('dy'))\n              .text(node.textContent);\n          });\n        } else {\n          arcs.select('.chart-donut-text').text(centerLabel);\n        }\n      }\n    }\n  },\n\n  /**\n   * Update the chart with a new dataset\n   * @param  {object} data The data to use.\n   * @returns {void}\n   */\n  updateData(data) {\n    // Pie Slices\n    const self = this;\n    let tooltipInterval;\n    const isEmpty = !self.settings.dataset || self.settings.dataset.length === 0;\n    const slice = self.svg.select('.slices').selectAll('path.slice')\n      .data(self.pie(data), self.key);\n\n    const getOffset = (node) => {\n      const body = document.body;\n      let rect;\n\n      // Fix: With firefox `getBoundingClientRect` not working if node is hidden\n      if (self.isFirefox && self.settings.dotSize === 0) {\n        const dot = d3.select(node);\n        dot.attr('r', 2);\n        rect = node.getBoundingClientRect();\n        dot.attr('r', self.settings.dotSize);\n      } else {\n        rect = node.getBoundingClientRect();\n      }\n      return {\n        top: rect.top + body.scrollTop,\n        left: rect.left + body.scrollLeft\n      };\n    };\n\n    self.isRTL = Locale.isRTL();\n\n    slice.enter()\n      .insert('path')\n      .style('fill', function (d, i) {\n        return charts.chartColor(i, 'pie', d.data);\n      })\n      .attr('class', 'slice')\n      .on('contextmenu', function (d) {\n        // Handle Right Click Menu\n        charts.triggerContextMenu(self.element, d3.select(this).select('path').nodes()[0], d);\n      })\n      .on('click', function (d, i) {\n        clearTimeout(tooltipInterval);\n        // Handle Click to select\n        const isSelected = this && d3.select(this).classed('is-selected');\n\n        // Make unselected\n        charts.setSelectedElement({\n          task: isSelected ? 'unselected' : 'selected',\n          container: self.element,\n          selector: isSelected ? '.chart-container .is-selected' : this,\n          isTrigger: !isSelected,\n          d: d.data,\n          i,\n          type: self.settings.type,\n          dataset: self.settings.dataset,\n          svg: self.svg\n        });\n\n        if (isSelected) {\n          /**\n           * Fires when arc/slice is selected.\n           * @event selected\n           * @memberof Pie\n           * @property {object} event - The jquery event object\n           * @property {object} selected arc/slice.\n           * @property {object} data of selected arc/slice.\n           * @property {number} index of selected arc/slice.\n           */\n          self.element.triggerHandler('selected', [d3.select(this).nodes(), {}, i]);\n        }\n      })\n      .on('mouseenter', function (d, i) {\n        if (!self.settings.showTooltips) {\n          return;\n        }\n        // See where to position\n        const dot = self.svg.selectAll('circle').nodes()[i];\n        const offset = getOffset(dot);\n\n        // See where we want the arrow\n        const rads = self.midAngle(d);\n\n        // https://www.wyzant.com/resources/lessons/math/trigonometry/unit-circle\n        const isTop = (rads <= (Math.PI / 4) && rads >= 0) || rads > (7 * Math.PI / 4);\n        const isRight = rads <= (3 * Math.PI / 4) && rads >= (Math.PI / 4);\n        const isBottom = rads <= (5 * Math.PI / 4) && rads >= (3 * Math.PI / 4);\n        const isLeft = rads <= (7 * Math.PI / 4) && rads >= (5 * Math.PI / 4);\n\n        // Build the content\n        let content = '';\n        const show = function () {\n          if (content === '') {\n            return;\n          }\n\n          const size = charts.tooltipSize(content);\n          let x = offset.left;\n          let y = offset.top;\n          const padding = 5;\n\n          if (isTop) {\n            x -= size.width / 2;\n            y -= size.height - padding;\n            charts.showTooltip(x, y, content, 'top');\n          }\n          if (isRight) {\n            y -= size.height / 2;\n            charts.showTooltip(x, y, content, 'right');\n          }\n          if (isBottom) {\n            x -= size.width / 2;\n            // y -= padding;\n            charts.showTooltip(x, y, content, 'bottom');\n          }\n          if (isLeft) {\n            x -= size.width - padding;\n            y -= size.height / 2;\n            charts.showTooltip(x, y, content, 'left');\n          }\n        };\n\n        const value = charts.formatToSettings(d, self.settings.tooltip);\n        content = d.data.tooltip || value;\n        content = content.replace('{{percent}}', `${d.data.percentRound}%`);\n        content = content.replace('{{value}}', d.value);\n        content = content.replace('%percent%', `${d.data.percentRound}%`);\n        content = content.replace('%value%', d.value);\n\n        if (content.indexOf('<b>') === -1) {\n          content = content.replace('(', '<b>');\n          content = content.replace(')', '</b>');\n        }\n\n        // Debounce it a bit\n        if (tooltipInterval != null) {\n          clearTimeout(tooltipInterval);\n        }\n\n        tooltipInterval = setTimeout(function () {\n          show();\n        }, 300);\n      })\n      .on('mouseleave', function () {\n        clearTimeout(tooltipInterval);\n        charts.hideTooltip();\n      })\n      .merge(slice)\n      .transition()\n      .duration(self.settings.animationSpeed)\n      .attrTween('d', function (d) {\n        this.current = this.current || d;\n        const interpolate = d3.interpolate(this.current, d);\n        this.current = interpolate(0);\n        return function (t) {\n          return self.arc(interpolate(t));\n        };\n      });\n\n    slice.exit()\n      .remove();\n\n    if (isEmpty) {\n      return;\n    }\n\n    const isMobile = self.element.parent().width() < 520;\n    let shouldShow = self.settings.showLines;\n\n    if (!self.settings.showLinesMobile && shouldShow) {\n      shouldShow = !isMobile;\n    }\n\n    self.settings.dotSize = shouldShow ? 2 : 0;\n\n    // Text Labels\n    if (shouldShow) {\n      const padding = 20;\n      const text = self.svg.select('.labels').selectAll('text')\n        .data(self.pie(data), self.key);\n\n      text.enter()\n        .append('text')\n        .attr('dy', '.35em')\n        .text(function (d) {\n          return charts.formatToSettings(d, self.settings.lines);\n        })\n        .merge(text)\n        .transition()\n        .duration(self.settings.animationSpeed)\n        .attrTween('transform', function (d) {\n          this.current = this.current || d;\n          const interpolate = d3.interpolate(this.current, d);\n          this.current = interpolate(0);\n          return function (t) {\n            const d2 = interpolate(t);\n            const pos = self.outerArc.centroid(d2);\n            pos[0] = self.dims.radius * (self.midAngle(d2) < Math.PI ? 1 : -1);\n            pos[0] -= (self.midAngle(d2) < Math.PI ? padding : -padding);\n            return `translate(${pos})`;\n          };\n        })\n        .styleTween('text-anchor', function (d) {\n          this.current = this.current || d;\n          const interpolate = d3.interpolate(this.current, d);\n          this.current = interpolate(0);\n          return function (t) {\n            const d2 = interpolate(t);\n\n            if (self.isRTL) {\n              return self.midAngle(d2) > Math.PI ? 'start' : 'end';\n            }\n\n            return self.midAngle(d2) < Math.PI ? 'start' : 'end';\n          };\n        });\n\n      text.exit()\n        .remove();\n\n      // Slice to text poly lines\n      const polyline = self.svg.select('.lines').selectAll('polyline')\n        .data(self.pie(data), self.key);\n\n      polyline.enter()\n        .append('polyline')\n        .merge(polyline)\n        .transition()\n        .duration(self.settings.animationSpeed)\n        .attrTween('points', function (d) {\n          this.current = this.current || d;\n          const interpolate = d3.interpolate(this.current, d);\n          this.current = interpolate(0);\n          return function (t) {\n            const d2 = interpolate(t);\n            const pos = self.outerArc.centroid(d2);\n            pos[0] = self.dims.radius * 0.85 * (self.midAngle(d2) < Math.PI ? 1 : -1);\n            return [self.outerArc.centroid(d2), self.outerArc.centroid(d2), pos];\n          };\n        });\n\n      polyline.exit()\n        .remove();\n    }\n\n    const dots = self.svg.select('.lines').selectAll('circle')\n      .data(self.pie(data), self.key);\n\n    dots.enter()\n      .append('circle')\n      .attr('class', 'circles')\n      .attr('r', self.settings.dotSize)\n      .merge(dots)\n      .transition()\n      .duration(self.settings.animationSpeed)\n      .attrTween('transform', function (d) {\n        this.current = this.current || d;\n        const interpolate = d3.interpolate(this.current, d);\n        this.current = interpolate(0);\n        return function (t) {\n          const d2 = interpolate(t);\n          return `translate(${self.outerArc.centroid(d2)} )`;\n        };\n      });\n\n    dots.exit()\n      .remove();\n  },\n\n  /**\n   * Set the initially selected elements\n   * @private\n   * @returns {void}\n   */\n  setInitialSelected() {\n    let selected = 0;\n    let selector;\n\n    this.svg.selectAll('.slice').each(function (d, i) {\n      if (!d || !d.data) {\n        return;\n      }\n\n      if (d.data.selected && selected < 1) {\n        selected++;\n        selector = d3.select(this);\n        selector.on('click').call(selector.node(), selector.datum(), i);\n      }\n    });\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    if (this.settings.redrawOnResize) {\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n\n      this.element.on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * Get info on the currently selected lines.\n   * @private\n   * @returns {object} An object with the matching data and reference to the triggering element.\n   */\n  getSelected() {\n    return charts.selected;\n  },\n\n  /**\n   * Get info on the currently selected lines.\n   * @private\n   * @param {object} o The selection data object\n   * @param {boolean} isToggle If true toggle the current state.\n   */\n  setSelected(o, isToggle) {\n    const self = this;\n    let selector;\n    let arcIndex;\n    let selected = 0;\n    const equals = utils.equals;\n\n    this.svg.selectAll('.slice').each(function (d, i) {\n      if (!d || !d.data) {\n        return;\n      }\n\n      if (selected < 1) {\n        if ((typeof o.fieldName !== 'undefined' &&\n              typeof o.fieldValue !== 'undefined' &&\n                o.fieldValue === d.data[o.fieldName]) ||\n            (typeof o.index !== 'undefined' && o.index === i) ||\n            (o.data && equals(o.data, self.chartData[i].data)) ||\n            (o.elem && $(this).is(o.elem))) {\n          selected++;\n          selector = d3.select(this);\n          arcIndex = i;\n        }\n      }\n    });\n\n    if (selected > 0 && (isToggle || !selector.classed('is-selected'))) {\n      selector.on('click').call(selector.node(), selector.datum(), arcIndex);\n    }\n  },\n\n  /**\n   * Get info on the currently selected lines.\n   * @param {object} options The selected info object.\n   * @returns {void}\n   */\n  toggleSelected(options) {\n    this.setSelected(options, true);\n  },\n\n  /**\n   * Handles resizing a chart.\n   * @private\n   * @returns {void}\n   */\n  handleResize() {\n    if (this.width === this.element.width()) {\n      return;\n    }\n\n    this.width = this.element.width();\n\n    if (!this.element.is(':visible')) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n\n    this.element.empty();\n\n    return this\n      .build()\n      .element.trigger('rendered', [this.svg]);\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @private\n   * @param  {array} values A list of values\n   * @returns {array} The values rounded to 100\n   */\n  roundLargestRemainer(values) {\n    let sum = 0;\n    let count = 0;\n    let dVala = 0;\n    let dValb = 0;\n    const order = [];\n\n    // Round everything down\n    for (let i = 0; i < values.length; i++) {\n      sum += parseInt(values[i], 10);\n      order[i] = i;\n    }\n\n    // Getting the difference in sum and 100\n    const diff = 100 - sum;\n\n    // Distributing the difference by adding 1 to items in decreasing order of their decimal parts\n    order.sort(function (a, b) {\n      dVala = values[a] - parseInt(values[a], 10);\n      dValb = values[b] - parseInt(values[b], 10);\n      return dValb - dVala;\n    });\n\n    values.sort(function (a, b) {\n      dVala = a - parseInt(a, 10);\n      dValb = b - parseInt(b, 10);\n      return dValb - dVala;\n    });\n\n    for (let j = 0; j < values.length; j++) {\n      count = j;\n      if (count < diff) {\n        values[j] = parseInt(values[j], 10) + 1;\n      } else {\n        values[j] = parseInt(values[j], 10);\n      }\n    }\n\n    // Set back the order\n    const unsorted = [];\n    for (let i = 0; i < values.length; i++) {\n      unsorted[order[i]] = values[i];\n    }\n    return unsorted;\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Calculate the middle angle.\n   * @private\n   * @param  {object} d The d3 data.\n   * @returns {boolean} The mid angule\n   */\n  midAngle(d) {\n    return d.startAngle + (d.endAngle - d.startAngle) / 2;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('pie-chart');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'chart');\n  }\n};\n\nexport { Pie, COMPONENT_NAME };\n","// Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\n\nimport '../emptymessage/emptymessage.jquery';\n\n// Settings and Options\nconst COMPONENT_NAME = 'radar';\n\n// Default Radar Options\nconst RADAR_DEFAULTS = {\n  dataset: [],\n  redrawOnResize: true,\n  margin: { top: 50, right: 0, bottom: 50, left: 0 },\n  levels: 4,\n  maxValue: 0,\n  labelFactor: 1.27,\n  wrapWidth: 60,\n  opacityArea: 0.2,\n  dotRadius: 3,\n  opacityCircles: 0,\n  strokeWidth: 1,\n  roundStrokes: true,\n  showCrosslines: true,\n  showAxisLabels: true,\n  colors: charts.colorRange,\n  showTooltips: true,\n  tooltip: {\n    show: 'value', // value, label, label (value) or percent or custom function\n    formatter: '.0%' // or .0% ?\n  },\n  axisFormatter: '.0%',\n  showLegend: true,\n  legendPlacement: 'right',\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' }\n};\n\n/**\n * A radar chart is a graphical method of displaying multivariate data in the form of a\n * two-dimensional chart of three or more quantitative variables represented on axes starting\n * from the same poin\n * @class Radar\n * @param {string} element The plugin element for the constuctor\n * @param {string} settings The settings element.\n * @param {array} settings.dataset The data to use in the radar\n * @param {boolean} [settings.redrawOnResize = true] If false, the component will not resize when resizing the page.\n * @param {object} [settings.margin] The margins of the SVG, you may want to adjust\n * depending on text location.\n * @param {number} [settings.levels = 4] How many levels or inner circles should there be drawn.\n * @param {number} [settings.maxValue = 0] What is the value that the biggest circle will represent\n * @param {number} [settings.labelFactor = 1.27] How far out than the outer circle should the labels be placed,\n * this may be useful to adjust for some charts.\n * @param {number} [settings.wrapWidth = 60] The number of pixels after which a label needs to be\n * given a new line. You may want to change this based on label data.\n * @param {boolean} [settings.showCrosslines = true] Set to false to hide the cross line axes.\n * @param {boolean} [settings.showAxisLabels = true] Set to false to hide percent labels.\n * @param {number} [settings.opacityArea = 0.2] The opacity value of the blobs. This is set to the correct Infor Style.\n * @param {number} [settings.dotRadius = 3] The size of the colored circles of each blog. Set to zero to remove dots.\n * @param {number} [settings.opacityCircles  = 0]The opacity of the circles of each blob 0 or .1 are good values.\n * This is set to the correct Infor Style.\n * @param {number} [settings.strokeWidth = 1] The width of the stroke around each blob.\n * This is set to the correct Infor Style.\n * @param {boolean} [settings.roundStrokes = true] If true the area and stroke will follow a\n * round path (cardinal-closed).\n * @param {boolean} [settings.showCrosslines = true]  If false the axis lines will not be shown in the diagonals.\n * @param {boolean} [settings.showAxisLabels = true]  If false the axis labels will not be shown.\n * @param {string} [settings.axisFormatter = '.0%'] D3 formatter to use on the axis labels\n * @param {array} [settings.colors] An array of colors to use.\n * @param {boolean} [settings.showTooltips = true] If false no tooltips will be shown.\n * @param {object} [settings.tooltip] A setting that controls the tooltip values and format.\n * @param {string} [settings.tooltip.show = 'value'] Controls what is visible in the tooltip, this can be value, label\n * or percent or custom function.\n * @param {object} [settings.tooltip.formatter = '.0%'] The d3.formatter string.\n * @param {boolean} [settings.showLegend = true] If false the legend will not be shown.\n * @param {string} [settings.legendPlacement = 'right'] Where to locate the legend. This can be bottom or right at\n * the moment.\n * @param {object} [settings.emptyMessage] An empty message will be displayed when there is no chart data.\n * This accepts an object of the form emptyMessage:\n * `{title: 'No Data Available',\n *  info: 'Make a selection on the list above to see results', icon: 'icon-empty-no-data',\n *  button: {text: 'xxx', click: <function>}\n *  }`\n *  Set this to null for no message or will default to 'No Data Found with an icon.'\n */\nfunction Radar(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, RADAR_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nRadar.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The component prototype for chaining.\n   */\n  init() {\n    this.width = 0;\n\n    this\n      .build()\n      .handleEvents();\n\n    /**\n    * Fires when the chart is complete done rendering, for customization.\n    * @event rendered\n    * @memberof Radar\n    * @property {object} event - The jquery event object\n    * @property {array} svg - The svg object.\n    */\n    this.element.trigger('rendered', [this.svg]);\n\n    return this;\n  },\n\n  /**\n   * Build the Component.\n   * @returns {object} The component prototype for chaining.\n   * @private\n   */\n  build() {\n    this.updateData(this.settings.dataset);\n    this.setInitialSelected();\n    return this;\n  },\n\n  /**\n   * Update the chart with a new dataset\n   * @param  {object} data The data to use.\n   */\n  updateData(data) {\n    const self = this;\n    const settings = self.settings;\n    const dims = {\n      // Width of the circle\n      w: parseInt(this.element.parent().width(), 10),\n      // Height of the circle && 60px on top and bottom for labels\n      h: parseInt(this.element.parent().height() - 115, 10),\n    };\n\n    if (settings.legendPlacement === 'right') {\n      dims.w *= 0.75;\n    }\n    this.element.addClass('chart-radar');\n\n    // Handle Empty Data Set\n    if (data.length === 0) {\n      self.element.emptymessage(self.settings.emptyMessage);\n      return;\n    }\n\n    // Get the name text from given data\n    const getNameText = (d) => {\n      const size = { min: 328, max: 469 };\n      let text = '';\n      if (dims.w <= size.min) {\n        text = d.shortName || d.abbrName || d.name || '';\n      } else if (dims.w >= (size.min + 1) && dims.w <= size.max) {\n        text = d.abbrName || d.name || '';\n      } else if (dims.w > size.max) {\n        text = d.name || '';\n      }\n      return text;\n    };\n\n    let tooltipInterval;\n    const colors = d3.scaleOrdinal(self.settings.colors);\n\n    // If the supplied maxValue is smaller than the actual one, replace by the max in the data\n    const maxValue = Math.max(settings.maxValue, d3.max(data, i => d3.max(i.data.map(o => o.value))));  //eslint-disable-line\n\n    const allAxes = data[0].data.map(d => getNameText(d)); // Map the names to the axes\n    const total = allAxes.length; // The number of different axes\n    let radius = Math.min(dims.w / 2, dims.h / 2); // Radius of the outermost circle\n    const angleSlice = Math.PI * 2 / total; // The width in radians of each 'slice'\n\n    if (dims.w <= 328) {\n      const extra = dims.w < 225 ? 75 : 50; // Reduce the size of the radar\n      radius = Math.min((dims.w - extra) / 2, (dims.h - extra) / 2);\n    }\n\n    // Create the Scale for the radius\n    const rScale = d3.scaleLinear()\n      .range([0, radius])\n      .domain([0, maxValue]);\n\n    // Create the container SVG and parent g\n    // Remove whatever chart with the same id/class was present before\n    const elem = this.element[0];\n    d3.select(elem).select('svg').remove();\n\n    // Initiate the radar chart SVG\n    const svg = d3.select(elem).append('svg')\n      .attr('width', dims.w + settings.margin.left + settings.margin.right)\n      .attr('height', dims.h + settings.margin.top + settings.margin.bottom)\n      .attr('class', 'chart-radar');\n\n    this.svg = svg; // Pointer for selection states\n\n    // Append a g element\n    const g = svg.append('g')\n      .attr('transform', `translate(${dims.w / 2 + settings.margin.left},${dims.h / 2 + settings.margin.top})`);\n\n    // Filter for the outside glow effect\n    if (settings.opacityCircles > 0) {\n      const filter = g.append('defs').append('filter').attr('id', 'glow');\n      filter.append('feGaussianBlur').attr('stdDeviation', '2.5').attr('result', 'coloredBlur');\n      const feMerge = filter.append('feMerge');\n      feMerge.append('feMergeNode').attr('in', 'coloredBlur');\n      feMerge.append('feMergeNode').attr('in', 'SourceGraphic');\n    }\n\n    // Draw the Circular grid\n\n    // Wrapper for the grid & axes\n    const axisGrid = g.append('g').attr('class', 'chart-radar-axis-wrapper');\n\n    // Draw the background circles\n    axisGrid.selectAll('.levels')\n      .data(d3.range(1, (settings.levels + 1)).reverse())\n      .enter()\n      .append('circle')\n      .attr('class', 'chart-radar-grid-circle')\n      .attr('r', d => radius / settings.levels * d)\n      .style('fill-opacity', settings.opacityCircles)\n      .style('filter', settings.opacityCircles > 0 ? 'url(#glow)' : '');\n\n    // Text indicating at what % each level is\n    if (this.settings.showAxisLabels) {\n      axisGrid.selectAll('.axis-label')\n        .data(d3.range(1, (settings.levels + 1)).reverse())\n        .enter().append('text')\n        .attr('class', 'axis-label')\n        .attr('x', 4)\n        .attr('y', d => -d * radius / settings.levels)\n        .attr('dy', '0.4em')\n        .style('font-size', '10px')\n        .attr('fill', '#737373')\n        .text((d) => {\n          let text = '';\n          const roundedVal = Math.round(maxValue * 10) / 10;\n\n          if (settings.axisFormatter.indexOf('%') > -1) {\n            text = d3.format(settings.axisFormatter)(roundedVal * d / settings.levels);\n          } else {\n            text = d3.format(settings.axisFormatter)(d / settings.levels);\n          }\n\n          return text;\n        });\n    }\n\n    // Draw the axes\n\n    // Create the straight lines radiating outward from the center\n    const axis = axisGrid.selectAll('.axis')\n      .data(allAxes)\n      .enter()\n      .append('g')\n      .attr('class', 'axis');\n\n    // Append the cross lines\n    if (this.settings.showCrosslines) {\n      axis.append('line')\n        .attr('x1', 0)\n        .attr('y1', 0)\n        .attr('x2', (d, i) => rScale(maxValue * 1.05) * Math.cos(angleSlice * i - Math.PI / 2))\n        .attr('y2', (d, i) => rScale(maxValue * 1.05) * Math.sin(angleSlice * i - Math.PI / 2))\n        .attr('class', 'chart-radar-crossline')\n        .style('stroke-width', '1px');\n    }\n\n    // Append the labels at each axis\n    axis.append('text')\n      .attr('class', 'legend')\n      .style('font-size', '12px')\n      .attr('text-anchor', 'middle')\n      .attr('dy', '0.35em')\n      .attr('x', (d, i) => rScale(maxValue * settings.labelFactor) * Math.cos(angleSlice * i - Math.PI / 2))\n      .attr('y', (d, i) => rScale(maxValue * settings.labelFactor) * Math.sin(angleSlice * i - Math.PI / 2))\n      .text(d => d);\n\n    this.element[dims.w < 420 ? 'addClass' : 'removeClass']('is-small');\n\n    if (dims.w > 456) {\n      svg.selectAll('.chart-radar-axis-wrapper .axis .legend').each(function () {\n        charts.wrap(d3.select(this), settings.wrapWidth, settings.labelFactor);\n      });\n    }\n\n    // Draw the radar chart blobs\n\n    // The radial line function\n    const radarLine = d3.lineRadial().curve(d3.curveBasisClosed)\n      .radius(d => rScale(d.value))\n      .angle((d, i) => i * angleSlice);\n\n    if (settings.roundStrokes) {\n      radarLine.curve(d3.curveCardinalClosed);\n    }\n\n    // Create a wrapper for the blobs\n    const blobWrapper = g.selectAll('.radarWrapper')\n      .data(data.map(i => i.data))\n      .enter().append('g')\n      .attr('class', 'chart-radar-wrapper');\n\n    // Append the backgrounds\n    blobWrapper\n      .append('path')\n      .attr('class', 'chart-radar-area')\n      .attr('d', d => radarLine(d))\n      .style('fill', (d, i) => colors(i))\n      .style('fill-opacity', settings.opacityArea)\n      .on('click', function (d, i) {\n        // Handle Click to select\n        clearTimeout(tooltipInterval);\n\n        const selectElem = d3.select(this);\n        const isSelected = selectElem.classed('is-selected');\n        svg.selectAll('.is-selected').classed('is-selected', false);\n        svg.selectAll('.is-not-selected').classed('is-not-selected', false);\n\n        if (!isSelected) {\n          svg.selectAll('.chart-radar-area').classed('is-not-selected', true);\n          selectElem.classed('is-selected', true).classed('is-not-selected', false);\n          selectElem.style('fill-opacity', self.settings.opacityArea);\n        }\n\n        const triggerData = {\n          elem: selectElem.nodes(),\n          data: d,\n          index: i\n        };\n\n        /**\n        * Fires when the chart is complete done rendering, for customization.\n        * @event selected\n        * @memberof Radar\n        * @property {object} data - The data element attached\n        * @property {HTMLElement} elem - The dom element\n        * @property {number} index - The index for this blob.\n        */\n\n        /**\n        * Fires when the chart is complete done rendering, for customization.\n        * @event deselected\n        * @memberof Radar\n        * @property {object} data - The data element attached\n        * @property {HTMLElement} elem - The dom element\n        * @property {number} index - The index for this blob.\n        */\n        self.element.triggerHandler((isSelected ? 'deselected' : 'selected'), triggerData);\n\n        charts.selected = !isSelected ? triggerData : [];\n      });\n\n    // Create the outlines\n    blobWrapper.append('path')\n      .attr('class', 'chart-radar-stroke')\n      .attr('d', d => radarLine(d))\n      .style('stroke-width', `${settings.strokeWidth}px`)\n      .style('stroke', (d, i) => colors(i))\n      .style('fill', 'none')\n      .style('filter', settings.opacityCircles > 0 ? 'url(#glow)' : '');\n\n    // Append the circles\n    blobWrapper.selectAll('.chart-radar-circle')\n      .data(d => d)\n      .enter().append('circle')\n      .attr('class', 'chart-radar-circle')\n      .attr('r', settings.dotRadius)\n      .attr('cx', (d, i) => rScale(d.value) * Math.cos(angleSlice * i - Math.PI / 2))\n      .attr('cy', (d, i) => rScale(d.value) * Math.sin(angleSlice * i - Math.PI / 2))\n      .style('fill', function () {\n        return colors($(this.parentNode).index() - 1);\n      })\n      .style('fill-opacity', 0.6);\n\n    // Wrapper for the invisible circles on top\n    const blobCircleWrapper = g.selectAll('.radar-circle-wrapper')\n      .data(data.map(i => i.data))\n      .enter().append('g')\n      .attr('class', 'radar-circle-wrapper');\n\n    // Append a set of invisible circles on top for the mouseover pop-up\n    blobCircleWrapper.selectAll('.radar-invisible-circle')\n      .data(d => d)\n      .enter().append('circle')\n      .attr('class', 'radar-invisible-circle')\n      .attr('r', settings.dotRadius * 1.5)\n      .attr('cx', (d, i) => rScale(d.value) * Math.cos(angleSlice * i - Math.PI / 2))\n      .attr('cy', (d, i) => rScale(d.value) * Math.sin(angleSlice * i - Math.PI / 2))\n      .style('fill', 'none')\n      .style('pointer-events', 'all')\n      .on('mouseenter', function (d) {\n        if (!settings.showTooltips) {\n          return;\n        }\n\n        const offset = $(this).offset();\n        let content = charts.formatToSettings(d, self.settings.tooltip);\n\n        if (content.indexOf('<b>') === -1) {\n          content = content.replace('(', '<b>');\n          content = content.replace(')', '</b>');\n        }\n\n        const size = charts.tooltipSize(content);\n        let x = offset.left;\n        let y = offset.top;\n        const padding = 6;\n        x -= (size.width / 2) - padding;\n        y -= size.height + padding;\n\n        // Debounce it a bit\n        if (tooltipInterval != null) {\n          clearTimeout(tooltipInterval);\n        }\n\n        tooltipInterval = setTimeout(() => {\n          charts.showTooltip(x, y, content, 'top');\n        }, 300);\n      })\n      .on('mouseleave', () => {\n        clearTimeout(tooltipInterval);\n        charts.hideTooltip();\n      });\n\n    // Add tooltip object\n    if (settings.showTooltips) {\n      charts.appendTooltip('is-pie');\n    }\n\n    if (settings.showLegend) {\n      if (settings.legendPlacement) {\n        this.element.addClass(`has-${settings.legendPlacement}-legend`);\n      }\n\n      const series = self.settings.dataset.map((d, i) => ({\n        name: d.name,\n        display: 'twocolumn',\n        placement: self.settings.legendPlacement,\n        color: colors(i)\n      }));\n\n      this.settings.svg = self.svg;\n      charts.addLegend(series, 'pie', this.settings, this.element);\n    }\n  },\n\n  /**\n   * Set the initially selected elements\n   * @private\n   */\n  setInitialSelected() {\n\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    if (this.settings.redrawOnResize) {\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n\n      this.element.on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * Get info on the currently selected lines.\n   * @returns {object} An object with the matching data and reference to the triggering element.\n   */\n  getSelected() {\n    return charts.selected;\n  },\n\n  /**\n   * Get info on the currently selected lines.\n   * @param {object} o The selection data object\n   * @param {boolean} isToggle If true toggle the current state.\n   */\n  setSelected(o, isToggle) {\n    let selector;\n    let arcIndex;\n    let selected = 0;\n    const self = this;\n\n    this.svg.selectAll('.chart-radar-area').each(function (d, i) {\n      const set = self.settings.dataset[i];\n      if (!set || !set.data) {\n        return;\n      }\n\n      if (selected < 1) {\n        if ((typeof o.fieldName !== 'undefined' &&\n              typeof o.fieldValue !== 'undefined' &&\n                o.fieldValue === set[o.fieldName]) ||\n            (typeof o.index !== 'undefined' && o.index === i) ||\n            (o.elem && $(this).is(o.elem))) {\n          selected++;\n          selector = d3.select(this);\n          arcIndex = i;\n        }\n      }\n    });\n\n    if (selected > 0 && (isToggle || !selector.classed('is-selected'))) {\n      selector.on('click').call(selector.node(), selector.datum(), arcIndex);\n    }\n  },\n\n  /**\n   * Get info on the currently selected lines.\n   * @param {object} options The selected info object.\n   */\n  toggleSelected(options) {\n    this.setSelected(options, true);\n  },\n\n  /**\n   * Handles resizing a chart.\n   * @private\n   * @returns {void}\n   */\n  handleResize() {\n    if (this.width === this.element.width()) {\n      return;\n    }\n\n    this.width = this.element.width();\n\n    if (!this.element.is(':visible')) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n\n    if (settings && settings.dataset) {\n      this.element.find('.chart-legend').remove();\n      this.settings.dataset = settings.dataset;\n      this.updateData(this.settings.dataset);\n      return this;\n    }\n\n    this.element.empty();\n    return this\n      .build();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('radar-chart');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    $.removeData(this.element[0], 'radar');\n  }\n};\n\nexport { Radar, COMPONENT_NAME };\n","import { Bullet, COMPONENT_NAME as BULLET_NAME } from '../bullet/bullet';\nimport { CompletionChart, COMPONENT_NAME as COMPLETION_CHART_NAME } from '../completion-chart/completion-chart';\nimport { Sparkline, COMPONENT_NAME as SPARKLINE_NAME } from '../sparkline/sparkline';\nimport { Line, COMPONENT_NAME as LINE_NAME } from '../line/line';\nimport { Column, COMPONENT_NAME as COLUMN_NAME } from '../column/column';\nimport { Bar, COMPONENT_NAME as BAR_NAME } from '../bar/bar';\nimport { Pie, COMPONENT_NAME as PIE_NAME } from '../pie/pie';\nimport { Radar, COMPONENT_NAME as RADAR_NAME } from '../radar/radar';\n\n/*\n* jQuery Component Wrapper for Charts. It maps the singlular components\n* to the previous versions single jquery wrapper.\n* @param  {object} settings The settings to apply.\n* @returns {object} The jquery object for chaining.\n*/\n$.fn.chart = function (settings) {\n  let instance = null;\n  this.empty(); // allow changing chart type\n\n  switch (settings.type) {\n    case 'targeted-achievement':\n    case 'completion':\n    case 'completion-target': {\n      instance = this.data(settings.type);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new CompletionChart(this, settings);\n      this.data(COMPLETION_CHART_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      this.data(settings.type, chartComponent); // Compatibility\n      break;\n    }\n    case 'bullet': {\n      instance = this.data(BULLET_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Bullet(this, settings);\n      this.data(BULLET_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'radar': {\n      instance = this.data(RADAR_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Radar(this, settings);\n      this.data(RADAR_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'sparkline': {\n      instance = this.data(SPARKLINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Sparkline(this, settings);\n      this.data(SPARKLINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'sparkline-dots': {\n      settings.isDots = true;\n      instance = this.data(SPARKLINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Sparkline(this, settings);\n      this.data(SPARKLINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'sparkline-peak': {\n      settings.isPeakDot = true;\n      instance = this.data(SPARKLINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Sparkline(this, settings);\n      this.data(SPARKLINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'sparkline-dots-n-peak': {\n      settings.isPeakDot = true;\n      settings.isDots = true;\n      instance = this.data(SPARKLINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Sparkline(this, settings);\n      this.data(SPARKLINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'sparkline-minmax': {\n      settings.isMinMax = true;\n      instance = this.data(SPARKLINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Sparkline(this, settings);\n      this.data(SPARKLINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'sparkline-medianrange': {\n      settings.isMedianRange = true;\n      instance = this.data(SPARKLINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Sparkline(this, settings);\n      this.data(SPARKLINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'sparkline-medianrange-n-peak': {\n      settings.isMedianRange = true;\n      settings.isPeakDot = true;\n      instance = this.data(SPARKLINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Sparkline(this, settings);\n      this.data(SPARKLINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'line': {\n      instance = this.data(LINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Line(this, settings);\n      this.data(LINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'area': {\n      settings.isArea = true;\n      instance = this.data(LINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Line(this, settings);\n      this.data(LINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'bubble': {\n      settings.isBubble = true;\n      instance = this.data(LINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Line(this, settings);\n      this.data(LINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'scatterplot': {\n      settings.isScatterPlot = true;\n      instance = this.data(LINE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Line(this, settings);\n      this.data(LINE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'column':\n    case 'column-grouped':\n    case 'positive-negative':\n    case 'column-positive-negative': {\n      instance = this.data(COLUMN_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Column(this, settings);\n      this.data(COLUMN_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'column-stacked': {\n      settings.isStacked = true;\n      instance = this.data(COLUMN_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Column(this, settings);\n      this.data(COLUMN_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'bar': {\n      settings.isStacked = true;\n      instance = this.data(BAR_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Bar(this, settings);\n      this.data(BAR_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'bar-stacked': {\n      settings.isStacked = true;\n      instance = this.data(BAR_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Bar(this, settings);\n      this.data(BAR_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'bar-normalized': {\n      settings.isNormalized = true;\n      instance = this.data(BAR_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Bar(this, settings);\n      this.data(BAR_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'bar-grouped': {\n      settings.isStacked = false;\n      settings.isGrouped = true;\n      instance = this.data(BAR_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Bar(this, settings);\n      this.data(BAR_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'pie': {\n      instance = this.data(PIE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Pie(this, settings);\n      this.data(PIE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    case 'donut': {\n      settings.isDonut = true;\n      instance = this.data(PIE_NAME);\n      if (instance) {\n        instance.updated(settings);\n        return this;\n      }\n      const chartComponent = new Pie(this, settings);\n      this.data(PIE_NAME, chartComponent);\n      this.data('chart', chartComponent); // Compatibility\n      break;\n    }\n    default:\n      instance = null;\n  }\n\n  return this;\n};\n","import { utils } from '../../utils/utils';\nimport { stringUtils } from '../../utils/string';\nimport { Locale } from '../locale/locale';\nimport { xssUtils } from '../../utils/xss';\n\n// Settings and Options\nconst COMPONENT_NAME = 'monthview';\n\nconst COMPONENT_NAME_DEFAULTS = {\n  locale: null,\n  month: new Date().getMonth(),\n  year: new Date().getFullYear(),\n  activeDate: null,\n  activeDateIslamic: null,\n  isPopup: false,\n  headerStyle: 'full',\n  firstDayOfWeek: null,\n  disable: {\n    dates: [],\n    minDate: '',\n    maxDate: '',\n    dayOfWeek: [],\n    isEnable: false,\n    restrictMonths: false\n  },\n  legend: [\n    { name: 'Public Holiday', color: '#76B051', dates: [] },\n    { name: 'Weekends', color: '#EFA836', dayOfWeek: [] }\n  ],\n  hideDays: false,\n  showMonthYearPicker: false,\n  advanceMonths: 5,\n  range: {\n    useRange: false, // true - if datepicker using range dates\n    start: '', // Start date '03/05/2018'\n    end: '', // End date '03/21/2018'\n    separator: ' - ', // separator string between two dates\n    minDays: 0, // Minimum days\n    maxDays: 0, // Maximum days\n    selectForward: false, // Only in forward direction\n    selectBackward: false, // Only in backward direction\n    includeDisabled: false // if true range will include disable dates in it\n  },\n  selectable: true,\n  onSelected: null\n};\n\n/**\n * MonthView - Renders a Month calendar\n * @class MonthView\n * @param {string} element The plugin element for the constuctor\n * @param {object} [settings] The settings element.\n * @param {string} [settings.locale] The name of the locale to use for this instance. If not set the current locale will be used.\n * @param {number} [settings.month] The month to show.\n * @param {number} [settings.year] The year to show.\n * @param {number} [settings.activeDate] The date to highlight as selected/today.\n * @param {number} [settings.activeDateIslamic] The date to highlight as selected/today (as an array for islamic)\n * @param {number} [settings.isPopup] Is it in a popup (datepicker using it)\n * @param {number} [settings.headerStyle] Configure the header, this can be 'simple' or 'full'. Full adds a picker and today link.\n * @param {number} [settings.firstDayOfWeek=null] Set first day of the week. '1' would be Monday.\n * @param {object} [settings.disable] Disable dates in various ways.\n * For example `{minDate: 'M/d/yyyy', maxDate: 'M/d/yyyy'}`. Dates should be in format M/d/yyyy\n * or be a Date() object or string that can be converted to a date with new Date().\n * @param {array} [settings.disable.dates] Disable specific dates.\n * Example `{dates: ['12/31/2018', '01/01/2019'}`.\n * @param {string|date} [settings.disable.minDate] Disable up to a minimum date.\n * Example `{minDate: '12/31/2016'}`.\n * @param {string|date} [settings.disable.maxDate] Disable up to a maximum date.\n * Example `{minDate: '12/31/2019'}`.\n * @param {array} [settings.disable.dayOfWeek] Disable a specific of days of the week 0-6.\n * Example `{dayOfWeek: [0,6]}`.\n * @param {boolean} [settings.disable.isEnable=false] Inverse the disable settings.\n * If true all the disable settings will be enabled and the rest will be disabled.\n * So you can inverse the settings.\n * @param {boolean} [settings.disable.retrictMonths=false] Restrict month selections on datepicker.\n * It requires minDate and maxDate for the feature to activate.\n * For example if you have more non specific dates to disable then enable ect.\n * @param {object} [settings.range] Range between two dates with various options.\n * @param {boolean} [settings.range.useRange=false] Use range of two dates options.\n * @param {string|date} [settings.range.start] Start date in range.\n * @param {string|date} [settings.range.end] End date in range.\n * @param {string} [settings.range.separator=' - '] Visual separator between two dates.\n * @param {number} [settings.range.minDays=0] Minimum days to be in range.\n * @param {number} [settings.range.maxDays=0] Maximum days to be in range.\n * @param {boolean} [settings.range.selectForward=false] Range only in forward direction.\n * @param {boolean} [settings.range.selectBackward=false] Range only in backward direction.\n * @param {boolean} [settings.range.includeDisabled=false] Include disable dates in range of dates.\n * @param {boolean} [settings.hideDays=false] If true the days portion of the calendar will be hidden. Usefull for Month/Year only formats.\n * @param {boolean} [settings.showMonthYearPicker=false] If true the month and year will render as dropdowns.\n * @param {number} [settings.advanceMonths=5] The number of months in each direction to show in\n *  the dropdown for months (when initially opening)\n * @param {array} [settings.legend]  Legend Build up\n * for example `[{name: 'Public Holiday', color: '#76B051', dates: []},\n * {name: 'Weekends', color: '#EFA836', dayOfWeek: []}]`\n * @param {boolean} [settings.selectable=false] If true the month days can be clicked to select\n * @param {boolean} [settings.onSelected=false] Call back that fires when a month day is clicked.\n */\nfunction MonthView(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, COMPONENT_NAME_DEFAULTS);\n  this.element = $(element);\n  this.init();\n}\n\n// Plugin Methods\nMonthView.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  init() {\n    // Do initialization. Build or Events ect\n    return this.build();\n  },\n\n  /**\n   * Set current locale to be used\n   * @private\n   * @returns {void}\n   */\n  setLocale() {\n    if (this.settings.locale && (!this.locale || this.locale.name !== this.settings.locale)) {\n      Locale.getLocale(this.settings.locale).done((locale) => {\n        this.locale = Locale.cultures[locale];\n        this.setCurrentCalendar();\n        this.build().handleEvents();\n      });\n    } else if (!this.settings.locale) {\n      this.locale = Locale.currentLocale;\n    }\n  },\n\n  /**\n   * Add any needed markup to the component.\n   * @private\n   * @returns {object} The Calendar prototype, useful for chaining.\n   */\n  build() {\n    this.setLocale();\n    if (this.rendered ||\n      (this.settings.locale && (!this.locale || this.locale.name !== this.settings.locale))) {\n      // Defer loading\n      this.rendered = false;\n      return this;\n    }\n\n    this.rendered = true;\n    this.setCurrentCalendar();\n\n    // Calendar Html in Popups\n    this.prevButton = '' +\n      `<button type=\"button\" class=\"btn-icon prev\">\n        ${$.createIcon('caret-left')}\n        <span>${Locale.translate('PreviousMonth', { locale: this.locale.name })}</span>\n      </button>`;\n    this.nextButton = '' +\n      `<button type=\"button\" class=\"btn-icon next\">\n        ${$.createIcon('caret-right')}\n        <span>${Locale.translate('NextMonth', { locale: this.locale.name })}</span>\n      </button>`;\n\n    this.header = $('' +\n      `<div class=\"monthview-header\">\n        <span class=\"month\">november</span>\n        <span class=\"year\">2015</span>\n        ${(this.isRTL ? this.nextButton + this.prevButton : this.prevButton + this.nextButton)}\n      </div>`);\n    this.table = $(`<table class=\"monthview-table\" aria-label=\"${Locale.translate('Calendar', { locale: this.locale.name })}\" role=\"application\"></table>`);\n    this.dayNames = $('' +\n      `<thead>\n        <tr>\n          <th>SU</th>\n          <th>MO</th>\n          <th>TU</th>\n          <th>WE</th>\n          <th>TH</th>\n          <th>FR</th>\n          <th>SA</th>\n        </tr>\n      </thead>`).appendTo(this.table);\n    this.days = $('' +\n      `<tbody>\n        <tr>\n          <td class=\"alternate\">26</td>\n          <td class=\"alternate\">27</td>\n          <td class=\"alternate\">28</td>\n          <td class=\"alternate\">29</td>\n          <td class=\"alternate\" >30</td>\n          <td class=\"alternate\">31</td>\n          <td>1</td>\n        </tr><tr>\n          <td>2</td>\n          <td>3</td>\n          <td>4</td>\n          <td>5</td>\n          <td>6</td>\n          <td>7</td>\n          <td>8</td>\n        </tr><tr>\n          <td>9</td>\n          <td>10</td>\n          <td>11</td>\n          <td>12</td>\n          <td>13</td>\n          <td>14</td>\n          <td>15</td>\n        </tr><tr>\n          <td>16</td>\n          <td>17</td>\n          <td>18</td>\n          <td>19</td>\n          <td class=\"is-today\">20</td>\n          <td>21</td>\n          <td>22</td>\n        </tr><tr>\n          <td>23</td>\n          <td>24</td>\n          <td>25</td>\n          <td>26</td>\n          <td>27</td>\n          <td>28</td>\n          <td class=\"alternate\">1</td>\n        </tr><tr>\n          <td class=\"alternate\">2</td>\n          <td class=\"alternate\">3</td>\n          <td class=\"alternate\">4</td>\n          <td class=\"alternate\">5</td>\n          <td class=\"alternate\">6</td>\n          <td class=\"alternate\">7</td>\n          <td class=\"alternate\">8</td>\n        </tr>\n      </tbody>`).appendTo(this.table);\n\n    if (this.settings.hideDays) {\n      this.table = '';\n    }\n\n    // Reconfigure the header\n    if (this.settings.headerStyle === 'full') {\n      this.header = $('' +\n        `<div class=\"monthview-header full\">\n          ${(this.isRTL ? this.nextButton + this.prevButton : this.prevButton + this.nextButton)}\n          <span class=\"monthview-datepicker\">\n            <input aria-label=\"${Locale.translate('Today', { locale: this.locale.name })}\" id=\"monthview-datepicker-field\" readonly data-init=\"false\" class=\"datepicker\" name=\"monthview-datepicker-field\" type=\"text\"/>\n          </span>\n          <a class=\"hyperlink today\" href=\"#\">${Locale.translate('Today', { locale: this.locale.name })}</a>\n        </div>`);\n      this.monthPicker = this.header.find('#monthview-datepicker-field');\n      this.todayLink = this.header.find('.hyperlink.today');\n    }\n\n    this.showMonth(this.settings.month, this.settings.year);\n    this.calendar = this.element.addClass('monthview').append(this.header, this.table);\n\n    if (!this.settings.isPopup) {\n      this.element.addClass('is-fullsize');\n    }\n\n    // Add Legend\n    this.addLegend();\n\n    if (this.settings.headerStyle === 'full') {\n      this.monthPicker.datepicker({\n        autoSize: true,\n        dateFormat: Locale.calendar(this.locale.name).dateFormat.year,\n        locale: this.settings.locale,\n        showMonthYearPicker: true,\n        hideButtons: true,\n        onOpenCalendar: () => this.currentDate\n      });\n      this.header.find('button, a').hideFocus();\n    }\n\n    this.handleEvents();\n    return this;\n  },\n\n  /**\n   * Set current calendar\n   * @private\n   * @returns {void}\n   */\n  setCurrentCalendar() {\n    this.currentCalendar = Locale.calendar(this.locale.name, this.settings.calendarName);\n    this.isIslamic = this.currentCalendar.name === 'islamic-umalqura';\n    this.isRTL = this.locale.direction === 'right-to-left';\n    this.conversions = this.currentCalendar.conversions;\n  },\n\n  /**\n   * Update the calendar to show the given month and year\n   * @param {number} month The zero based month to display\n   * @param {number} year The year to display\n   * @returns {void}\n   */\n  showMonth(month, year) {\n    const self = this;\n    const now = new Date();\n\n    now.setHours(0);\n    now.setMinutes(0);\n    now.setSeconds(0);\n\n    let elementDate = (this.settings.activeDate && this.settings.activeDate.getDate()) ?\n      this.settings.activeDate : now;\n\n    this.setCurrentCalendar();\n\n    if (this.isIslamic) {\n      if (!this.settings.activeDateIslamic) {\n        const gregorianDate = new Date();\n        this.todayDateIslamic = this.conversions.fromGregorian(gregorianDate);\n        this.settings.activeDateIslamic = [];\n        this.settings.activeDateIslamic[0] = this.todayDateIslamic[0];\n        this.settings.activeDateIslamic[1] = this.todayDateIslamic[1];\n        this.settings.activeDateIslamic[2] = this.todayDateIslamic[2];\n        year = this.settings.activeDateIslamic[0];\n        month = this.settings.activeDateIslamic[1];\n        elementDate = this.conversions.fromGregorian(now);\n      } else {\n        elementDate = this.settings.activeDateIslamic;\n      }\n    }\n\n    if (year.toString().length < 4) {\n      year = new Date().getFullYear();\n    }\n\n    if (month === 12) {\n      year++;\n      month = 0;\n      this.currentMonth = month;\n      this.currentYear = year;\n    }\n\n    if (month < 0) {\n      year--;\n      month = 11;\n      this.currentMonth = month;\n      this.currentYear = year;\n    }\n\n    this.currentDay = now.getDate();\n\n    let days = this.currentCalendar.days.narrow;\n    days = days || this.currentCalendar.days.abbreviated;\n\n    if (!this.settings.isPopup) {\n      days = this.currentCalendar.days.abbreviated;\n    }\n    const monthName = this.currentCalendar.months.wide[month];\n\n    this.currentMonth = month;\n    this.currentYear = year;\n\n    // Set the Days of the week\n    let firstDayofWeek = (this.currentCalendar.firstDayofWeek || 0);\n\n    if (this.settings.firstDayOfWeek) {\n      firstDayofWeek = this.settings.firstDayOfWeek;\n    }\n\n    this.dayNames.find('th').each(function (i) {\n      $(this).text(days[(i + firstDayofWeek) % 7]);\n    });\n\n    // Localize Month Name\n    this.yearFirst = this.currentCalendar.dateFormat.year && this.currentCalendar.dateFormat.year.substr(1, 1) === 'y';\n    this.header.find('.month').attr('data-month', month).text(`${xssUtils.stripTags(monthName)} `);\n    this.header.find('.year').text(` ${year}`);\n\n    if (this.yearFirst && !this.isIslamic && !this.isRTL) {\n      elementDate.setFullYear(year);\n      const translation = Locale.formatDate(elementDate, { date: 'year', locale: this.locale.name });\n      const justYear = translation.split(' ')[0];\n\n      this.header.find('.year').text(`${justYear} `);\n      this.header.find('.year').insertBefore(this.header.find('.month'));\n    }\n\n    if (this.settings.headerStyle === 'full' && this.monthPicker) {\n      this.monthPicker.val(Locale.formatDate(new Date(year, month, 1), { date: 'year', locale: this.locale.name }));\n      if (this.monthPicker.data('datepicker')) {\n        this.monthPicker.data('datepicker').setSize();\n      }\n    }\n\n    this.appendMonthYearPicker(month, year);\n\n    // Adjust days of the week\n    // lead days\n    const firstDayOfMonth = this.firstDayOfMonth(year, month);\n    const leadDays = ((firstDayOfMonth - firstDayofWeek) + 7) % 7;\n    const lastMonthDays = this.daysInMonth(year, month + (this.isIslamic ? 1 : 0));\n    const thisMonthDays = this.daysInMonth(year, month + (this.isIslamic ? 0 : 1));\n    let nextMonthDayCnt = 1;\n    let dayCnt = 1;\n    let exYear;\n    let exMonth;\n    let exDay;\n\n    const s = this.settings;\n    this.dayMap = [];\n    this.days.find('td').each(function (i) {\n      const th = $(this).removeClass('alternate prev-month next-month is-selected range is-today');\n      th.removeAttr('aria-selected');\n\n      if (i < leadDays) {\n        exDay = (lastMonthDays - leadDays) + 1 + i;\n        exMonth = (month === 0) ? 11 : month - 1;\n        exYear = (month === 0) ? year - 1 : year;\n\n        self.setDisabled(th, exYear, exMonth, exDay);\n        self.setLegendColor(th, exYear, exMonth, exDay);\n        self.dayMap.push({ key: stringUtils.padDate(exYear, exMonth, exDay), elem: th });\n        th.addClass('alternate prev-month').html(`<span class=\"day-container\"><span aria-hidden=\"true\" class=\"day-text\">${xssUtils.stripTags(exDay)}</span></span>`);\n        th.attr('data-key', stringUtils.padDate(exYear, exMonth, exDay));\n      }\n\n      if (i >= leadDays && dayCnt <= thisMonthDays) {\n        self.dayMap.push({ key: stringUtils.padDate(year, month, dayCnt), elem: th });\n        th.html(`<span class=\"day-container\"><span aria-hidden=\"true\" class=\"day-text\">${xssUtils.stripTags(dayCnt)}</span></span>`);\n        th.attr('data-key', stringUtils.padDate(year, month, dayCnt));\n\n        // Add Selected Class to Selected Date\n        if (self.isIslamic) {\n          if (year === elementDate[0] && month === elementDate[1] && dayCnt === elementDate[2]) {\n            th.addClass(`is-selected${(s.range.useRange ? ' range' : '')}`).attr('aria-selected', 'true').attr('tabindex', '0');\n          }\n        } else {\n          const tHours = elementDate.getHours();\n          const tMinutes = elementDate.getMinutes();\n          const tSeconds = self.isSeconds ? elementDate.getSeconds() : 0;\n\n          const newDate = (new Date(year, month, dayCnt)).setHours(tHours, tMinutes, tSeconds, 0);\n\n          if (newDate === elementDate.setHours(tHours, tMinutes, tSeconds, 0)) {\n            th\n              .addClass(`is-selected${(s.range.useRange ? ' range' : '')}`)\n              .attr('aria-selected', 'true').attr('tabindex', '0');\n          }\n        }\n\n        if (dayCnt === self.todayDay\n            && self.currentMonth === self.todayMonth\n            && self.currentYear === self.todayYear\n        ) {\n          th.addClass('is-today');\n        }\n\n        th.attr('aria-label', Locale.formatDate(new Date(self.currentYear, self.currentMonth, dayCnt), {\n          date: 'full',\n          locale: self.locale.name\n        }));\n        const startKey = stringUtils.padDate(\n          self.currentYear,\n          self.currentMonth,\n          dayCnt\n        );\n        th.attr('data-key', startKey);\n\n        self.setDisabled(th, year, month, dayCnt);\n        self.setLegendColor(th, year, month, dayCnt);\n\n        th.attr('role', 'link');\n        dayCnt++;\n        return;\n      }\n\n      if (dayCnt >= thisMonthDays + 1) {\n        exDay = nextMonthDayCnt;\n        exMonth = (month === 11) ? 0 : month + 1;\n        exYear = (month === 11) ? year + 1 : year;\n\n        self.dayMap.push({ key: stringUtils.padDate(exYear, exMonth, exDay), elem: th });\n        self.setDisabled(th, exYear, exMonth, exDay);\n        self.setLegendColor(th, exYear, exMonth, exDay);\n\n        th.addClass('alternate next-month').html(`<span class=\"day-container\"><span aria-hidden=\"true\" class=\"day-text\">${nextMonthDayCnt}</span></span>`);\n        th.attr('data-key', stringUtils.padDate(exYear, exMonth, exDay));\n        nextMonthDayCnt++;\n      }\n    });\n\n    // Hide 6th Row if all disabled\n    const row = this.days.find('tr').eq(5);\n    if (row.find('td.alternate').length === 7) {\n      row.hide();\n    } else {\n      row.show();\n    }\n\n    if (!this.currentDate) {\n      if (this.isIslamic) {\n        this.currentIslamicDate = [self.currentYear, self.currentMonth, self.currentDay];\n        this.currentDate = this.conversions.toGregorian(\n          self.currentYear,\n          self.currentMonth,\n          self.currentDay\n        );\n      } else {\n        this.currentDate = new Date(self.currentYear, self.currentMonth, self.currentDay);\n      }\n    }\n\n    this.setRangeSelection();\n    this.validatePrevNext();\n\n    /**\n    * Fires as the calendar popup is opened.\n    * @event monthrendered\n    * @memberof MonthView\n    * @property {object} event - The jquery event object\n    * @property {object} args - The event arguments\n    * @property {number} args.year - The rendered year\n    * @property {object} args.elem - The DOM object\n    * @property {object} args.api - The MonthView api\n    */\n    this.element.trigger('monthrendered', { year, month, elem: this.element, api: this });\n  },\n\n  /**\n   * Set range selection\n   * @private\n   * @returns {void}\n   */\n  setRangeSelection() {\n    if (this.settings.range.useRange) {\n      const range = {};\n      range.date = new Date(this.currentYear, this.currentMonth, 1);\n      range.date.setDate(range.date.getDate() - (this.days.find('.prev-month:visible').length + 1));\n      range.formatedDate = Locale.formatDate(range.date, { date: 'full', locale: this.locale.name });\n      range.cell = this.days.find(`[aria-label=\"${range.formatedDate}\"]`);\n      this.setRangeOnCell(this.settings.range.second ? false : range.cell);\n    }\n  },\n\n  /**\n   * Append month year picker\n   * @private\n   * @param {number} month The month to show in the picker\n   * @param {number} year The year to show in the picker\n   * @returns {void}\n   */\n  appendMonthYearPicker(month, year) {\n    const self = this;\n\n    if (!this.settings.showMonthYearPicker) {\n      return;\n    }\n\n    this.header.addClass('is-monthyear');\n\n    let monthDropdown = '' +\n      `<label for=\"month-dropdown\" class=\"audible\">\n        ${Locale.translate('Month', { locale: this.locale.name })}\n      </label>\n      <select id=\"month-dropdown\" class=\"dropdown\">`;\n\n    const wideMonths = this.currentCalendar.months.wide;\n    // eslint-disable-next-line\n    wideMonths.map(function (monthMap, i) {\n      monthDropdown += `<option ${(i === month ? ' selected ' : '')} value=\"${i}\">${monthMap}</option>`;\n    });\n    monthDropdown += '</select>';\n\n    const monthSpan = this.header.find('.month').empty().append(monthDropdown);\n    monthSpan.find('select.dropdown').dropdown().off('change.monthview')\n      .on('change.monthview', function () {\n        const elem = $(this);\n        self.currentMonth = parseInt(elem.val(), 10);\n        self.showMonth(self.currentMonth, self.currentYear);\n      });\n\n    let yearDropdown = '' +\n      `<label for=\"year-dropdown\" class=\"audible\">\n        ${Locale.translate('Year', { locale: this.locale.name })}\n      </label>\n      <select id=\"year-dropdown\" class=\"dropdown year\">`;\n\n    const years = [];\n\n    for (let i = this.settings.advanceMonths; i >= 1; i--) {\n      years.push(parseInt(year, 10) - i);\n    }\n    years.push(year);\n    for (let j = 1; j <= this.settings.advanceMonths; j++) {\n      years.push(parseInt(year, 10) + j);\n    }\n\n    // eslint-disable-next-line\n    years.map(function (yearMap) {\n      yearDropdown += `<option ${(year === yearMap ? ' selected ' : '')} value=\"${yearMap}\">${yearMap}</option>`;\n    });\n    yearDropdown += '</select>';\n\n    const yearSpan = this.header.find('.year').empty().append(yearDropdown);\n    yearSpan.find('select.dropdown').dropdown().off('change.datepicker')\n      .on('change.datepicker', function () {\n        const elem = $(this);\n        self.currentYear = parseInt(elem.val(), 10);\n        self.showMonth(self.currentMonth, self.currentYear, true);\n      });\n\n    if (this.yearFirst) {\n      yearSpan.find('.dropdown-wrapper').css('left', '0');\n      monthSpan.find('.dropdown-wrapper').css('left', '10px');\n    }\n  },\n\n  /**\n   * Find first day of the week for a given month\n   * @private\n   * @param {number} year The year to use with the month\n   * @param {number} month The month to find the first day for\n   * @returns {number} day\n   */\n  firstDayOfMonth(year, month) {\n    if (this.isIslamic) {\n      const firstDay = this.conversions.toGregorian(year, month, 1);\n      return (firstDay === null ? 1 : firstDay.getDay());\n    }\n    return (new Date(year, month, 1)).getDay();\n  },\n\n  /**\n   * Find the date of the Month (29, 30, 31 ect)\n   * @private\n   * @param {number} year The year to use with the month\n   * @param {number} month The month to find the days in month for\n   * @returns {number} date\n   */\n  daysInMonth(year, month) {\n    if (this.isIslamic) {\n      let monthLengthBitmap = this.conversions.yearInfo[this.islamicYearIndex(year)][0];\n      let monthDayCount = 0;\n      for (let M = 0; M <= month; M++) {\n        // eslint-disable-next-line\n        monthDayCount = 29 + (monthLengthBitmap & 1);\n        if (M === month) {\n          return monthDayCount;\n        }\n        // eslint-disable-next-line\n        monthLengthBitmap = (monthLengthBitmap >> 1);\n      }\n      return 0;\n    }\n    return (new Date(year, month, 0)).getDate();\n  },\n\n  /**\n   * Get the islamic year index\n   * @private\n   * @param {number} islamicYear Year to test.\n   * @returns {number} index\n   */\n  islamicYearIndex(islamicYear) {\n    const yearIdx = islamicYear - 1318;\n    if (yearIdx < 0 || yearIdx >= this.conversions.yearInfo.length) {\n      return 0; // for an out-of-range year, simply returns 0\n    }\n    return yearIdx;\n  },\n\n  /**\n   * Set disable Date\n   * @private\n   * @param {object} elem Node element to set.\n   * @param {string} year to check.\n   * @param {string} month to check.\n   * @param {string} date to check.\n   * @returns {void}\n   */\n  setDisabled(elem, year, month, date) {\n    const s = this.settings;\n    const dateIsDisabled = this.isDateDisabled(year, month, date);\n    elem.removeClass('is-disabled').removeAttr('aria-disabled');\n\n    if ((dateIsDisabled && !s.disable.isEnable) || (!dateIsDisabled && s.disable.isEnable)) {\n      elem\n        .addClass('is-disabled').attr('aria-disabled', 'true')\n        .removeClass('is-selected range').removeAttr('aria-selected');\n    }\n  },\n\n  /**\n   * Check through the options to see if the date is disabled\n   * @private\n   * @param {string} year to check.\n   * @param {string} month to check.\n   * @param {string} date to check.\n   * @returns {boolean} true if the date is disabled\n   */\n  isDateDisabled(year, month, date) {\n    const s = this.settings;\n    const min = (new Date(s.disable.minDate)).setHours(0, 0, 0, 0);\n    const max = (new Date(s.disable.maxDate)).setHours(0, 0, 0, 0);\n    let d2 = new Date(year, month, date);\n\n    // dayOfWeek\n    if (s.disable.dayOfWeek.indexOf(d2.getDay()) !== -1) {\n      return true;\n    }\n\n    d2 = d2.setHours(0, 0, 0, 0);\n\n    // min and max\n    if ((d2 <= min) || (d2 >= max)) {\n      return true;\n    }\n\n    // dates\n    if (s.disable.dates.length && typeof s.disable.dates === 'string') {\n      s.disable.dates = [s.disable.dates];\n    }\n\n    for (let i = 0, l = s.disable.dates.length; i < l; i++) {\n      const d = new Date(s.disable.dates[i]);\n      if (d2 === d.setHours(0, 0, 0, 0)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * Get array of dates between two dates\n   * @private\n   * @param {object} startDate .\n   * @param {object} endDate .\n   * @param {boolean} includeDisabled .\n   * @returns {array} dates between two dates\n   */\n  getDateRange(startDate, endDate, includeDisabled) {\n    const dates = [];\n    const current = new Date(startDate);\n\n    includeDisabled = typeof includeDisabled !== 'undefined' ? includeDisabled : this.settings.range.includeDisabled;\n\n    while (endDate.getTime() >= current.getTime()) {\n      if (includeDisabled || (!includeDisabled &&\n        !this.isDateDisabled(current.getFullYear(), current.getMonth(), current.getDate()))) {\n        dates.push(new Date(current));\n      }\n      current.setDate(current.getDate() + 1);\n    }\n    return dates;\n  },\n\n  /**\n   * Set Color for the Legend settings\n   * @private\n   * @param {object} elem to set.\n   * @param {string} year to check.\n   * @param {string} month to check.\n   * @param {string} date to check.\n   * @returns {void}\n   */\n  setLegendColor(elem, year, month, date) {\n    if (!this.settings.showLegend || !elem[0]) {\n      return;\n    }\n\n    const hex = this.getLegendColor(year, month, date);\n    const self = this;\n\n    elem[0].style.backgroundColor = '';\n    elem.off('mouseenter.legend mouseleave.legend');\n\n    if (hex) {\n      // set color on elem at .3 of provided color as per design\n      elem.addClass('is-colored');\n      elem[0].style.backgroundColor = this.hexToRgba(hex, 0.3);\n\n      const normalColor = self.hexToRgba(hex, 0.3);\n      const hoverColor = self.hexToRgba(hex, 0.7);\n\n      // handle hover states\n      elem.on('mouseenter.legend', function () {\n        const thisElem = $(this);\n        thisElem[0].style.backgroundColor = hoverColor;\n        thisElem.find('span')[0].style.backgroundColor = 'transparent';\n      }).on('mouseleave.legend', function () {\n        const thisElem = $(this);\n        thisElem[0].style.backgroundColor = normalColor;\n        thisElem.find('span')[0].style.backgroundColor = '';\n      });\n    }\n  },\n\n  /**\n   * Process Color Options to get the date color\n   * @private\n   * @param {string} year .\n   * @param {string} month .\n   * @param {string} date .\n   * @returns {string} date color\n   */\n  /* eslint-disable consistent-return */\n  getLegendColor(year, month, date) {\n    const s = this.settings;\n    if (!s.showLegend) {\n      return;\n    }\n\n    const checkDate = new Date(year, month, date);\n    const checkHours = checkDate.setHours(0, 0, 0, 0);\n\n    for (let i = 0; i < s.legend.length; i++) {\n      const series = s.legend[i];\n\n      // Check Day of week\n      if (series.dayOfWeek && series.dayOfWeek.indexOf(checkDate.getDay()) !== -1) {\n        return series.color;\n      }\n\n      // Check for dates that match\n      if (series.dates) {\n        for (let j = 0; j < series.dates.length; j++) {\n          const d = new Date(series.dates[j]);\n          if (checkHours === d.setHours(0, 0, 0, 0)) {\n            return series.color;\n          }\n        }\n      }\n    }\n\n    return '';\n  },\n  /* eslint-enable consistent-return */\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Calendar prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.off(`updated.${COMPONENT_NAME}`).on(`updated.${COMPONENT_NAME}`, () => {\n      self.updated();\n    });\n\n    // Change Month Events\n    this.header.off('click.monthview').on('click.monthview', 'button', function () {\n      const isNext = $(this).is('.next');\n      const range = {};\n\n      if (self.settings.range.useRange) {\n        if (isNext) {\n          range.date = new Date(self.currentYear, (self.currentMonth + 1), (self.element.find('.next-month:visible').length + 1));\n        } else {\n          range.date = new Date(self.currentYear, self.currentMonth, 1);\n          range.date.setDate(range.date.getDate() - (self.days.find('.prev-month:visible').length + 1));\n        }\n      }\n\n      self.showMonth(self.currentMonth + (isNext ? 1 : -1), self.currentYear);\n\n      if (self.settings.range.useRange) {\n        range.formatedDate = Locale.formatDate(range.date, { date: 'full', locale: this.locale.name });\n        range.cell = self.days.find(`[aria-label=\"${range.formatedDate}\"]`);\n        self.setRangeOnCell(self.settings.range.second ? false : range.cell);\n      }\n    });\n\n    if (self.settings.range.useRange) {\n      this.header\n        .off('mouseover.datepicker')\n        .on('mouseover.datepicker', 'button', function () {\n          if (self.settings.range.extra) {\n            self.setRangeOnCell($(this).is('.next') ? self.settings.range.extra.maxCell : self.settings.range.extra.minCell);\n          }\n        })\n        .off('focus.datepicker')\n        .on('focus.datepicker', 'button:not(.hide-focus)', function () {\n          if (self.settings.range.extra) {\n            self.setRangeOnCell($(this).is('.next') ? self.settings.range.extra.maxCell : self.settings.range.extra.minCell);\n          }\n        });\n\n      this.days\n        .off('mouseover.datepicker')\n        .on('mouseover.datepicker', 'td', function () {\n          self.setRangeOnCell(this);\n        });\n    }\n\n    if (self.settings.headerStyle === 'full' && this.monthPicker) {\n      this.monthPicker.off('change.monthview').on('change.monthview', function () {\n        const picker = $(this).data('datepicker');\n        self.selectDay(picker.currentDate);\n      });\n\n      this.todayLink.off('click.monthview').on('click.monthview', () => {\n        self.selectToday();\n      });\n    }\n\n    // Allow dates to be selected\n    if (self.settings.selectable) {\n      self.element.addClass('is-selectable').off('click.monthview-day').on('click.monthview-day', 'td', (e) => {\n        const key = e.currentTarget.getAttribute('data-key');\n        self.lastClickedKey = key;\n\n        if (e.currentTarget.classList.contains('is-disabled')) {\n          return;\n        }\n        self.selectDay(key);\n      });\n    }\n\n    this.handleKeys();\n    return this;\n  },\n\n  /**\n   * Select a specific date visually.\n   * @param {date | string} date specific date or a date key (hash string of the date)\n   * @param {boolean} closePopup Send a flag to close the popup\n  */\n  selectDay(date, closePopup) {\n    if (this.isIslamic && typeof date !== 'string') {\n      this.currentIslamicDate = this.currentCalendar.conversions.fromGregorian(date);\n      date = stringUtils.padDate(\n        this.currentIslamicDate[0],\n        this.currentIslamicDate[1],\n        this.currentIslamicDate[2]\n      );\n    }\n\n    if (!this.isIslamic && typeof date !== 'string') {\n      date = stringUtils.padDate(\n        date.getFullYear(),\n        date.getMonth(),\n        date.getDate()\n      );\n    }\n\n    let dayObj = this.dayMap.filter(dayFilter => dayFilter.key === date);\n    const year = parseInt(date.substr(0, 4), 10);\n    const month = parseInt(date.substr(4, 2), 10) - 1;\n    const day = parseInt(date.substr(6, 2), 10);\n\n    if (this.isIslamic) {\n      this.currentIslamicDate = date;\n      this.currentDate = this.conversions.toGregorian(year, month, day);\n    } else {\n      this.currentDate = new Date(year, month, day);\n    }\n\n    if (dayObj.length === 0 || dayObj[0].elem.hasClass('alternate')) {\n      // Show month\n      this.showMonth(month, year);\n      dayObj = this.dayMap.filter(dayFilter => dayFilter.key === date);\n    }\n\n    // Error - date not found\n    if (!dayObj.lenth === 0) {\n      return;\n    }\n\n    const node = dayObj[0].elem[0];\n\n    const args = {\n      node,\n      key: date,\n      day,\n      month,\n      year,\n      close: closePopup\n    };\n\n    delete this.isKeyClick;\n    this.element.find('td.is-selected').removeClass('is-selected').removeAttr('tabindex');\n    $(node).addClass('is-selected').attr('tabindex', '0').focus();\n\n    if (this.settings.onSelected) {\n      this.settings.onSelected(node, args);\n    }\n    this.element.trigger('selected', args);\n  },\n\n  /**\n   * Select todays date visually.\n   */\n  selectToday() {\n    this.selectDay(new Date());\n  },\n\n  /**\n   * Attach keyboard events for the calendar.\n   * @private\n   */\n  handleKeys() {\n    const s = this.settings;\n\n    this.element.off('keydown.monthview').on('keydown.monthview', '.monthview-table', (e) => {\n      const key = e.keyCode || e.charCode || 0;\n      const cell = $(e.target);\n      const allCell = this.days.find('td:visible');\n      const allCellLength = allCell.length;\n      let idx = null;\n      let selector = null;\n      let handled = false;\n      const minDate = new Date(s.disable.minDate);\n      const maxDate = new Date(s.disable.maxDate);\n\n      // Arrow Down: select same day of the week in the next week\n      if (key === 40) {\n        handled = true;\n        if (this.settings.range.useRange) {\n          idx = allCell.index(e.target) + 7;\n          selector = allCell.eq(idx);\n          if (idx < allCellLength) {\n            this.setRangeOnCell(selector.is('.is-selected') ? null : selector);\n            this.activeTabindex(selector, true);\n          }\n        } else if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (this.currentDate.getMonth() < maxDate.getMonth()) {\n            this.currentDate.setDate(this.currentDate.getDate() + 7);\n          } else if (maxDate.getDate() - 1 >= this.currentDate.getDate() + 7) {\n            this.currentDate.setDate(this.currentDate.getDate() + 7);\n          }\n          this.selectDay(this.currentDate);\n        } else {\n          this.currentDate.setDate(this.currentDate.getDate() + 7);\n          this.selectDay(this.currentDate);\n        }\n      }\n\n      // Arrow Up: select same day of the week in the previous week\n      if (key === 38) {\n        handled = true;\n        if (s.range.useRange) {\n          idx = allCell.index(e.target) - 7;\n          selector = allCell.eq(idx);\n          if (idx > -1) {\n            this.setRangeOnCell(selector.is('.is-selected') ? null : selector);\n            this.activeTabindex(selector, true);\n          }\n        } else if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (this.currentDate.getMonth() > minDate.getMonth()) {\n            this.currentDate.setDate(this.currentDate.getDate() - 7);\n          } else if (minDate.getDate() + 1 <= this.currentDate.getDate() - 7) {\n            this.currentDate.setDate(this.currentDate.getDate() - 7);\n          }\n          this.selectDay(this.currentDate);\n        } else {\n          this.currentDate.setDate(this.currentDate.getDate() - 7);\n          this.selectDay(this.currentDate);\n        }\n      }\n\n      // Arrow Left\n      if (key === 37) {\n        handled = true;\n        if (s.range.useRange) {\n          idx = allCell.index(e.target) - 1;\n          selector = allCell.eq(idx);\n          if (idx > -1) {\n            this.setRangeOnCell(selector.is('.is-selected') ? null : selector);\n            this.activeTabindex(selector, true);\n          }\n        } else if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (this.currentDate.getMonth() > minDate.getMonth()) {\n            this.currentDate.setDate(this.currentDate.getDate() - 1);\n          } else if (minDate.getDate() + 1 !== this.currentDate.getDate()) {\n            this.currentDate.setDate(this.currentDate.getDate() - 1);\n          }\n          this.selectDay(this.currentDate);\n        } else {\n          this.currentDate.setDate(this.currentDate.getDate() - 1);\n          this.selectDay(this.currentDate);\n        }\n      }\n\n      // Arrow Right\n      if (key === 39) {\n        handled = true;\n        if (s.range.useRange) {\n          idx = allCell.index(e.target) + 1;\n          selector = allCell.eq(idx);\n          if (idx < allCellLength) {\n            this.setRangeOnCell(selector.is('.is-selected') ? null : selector);\n            this.activeTabindex(selector, true);\n          }\n        } else if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (this.currentDate.getMonth() < maxDate.getMonth()) {\n            this.currentDate.setDate(this.currentDate.getDate() + 1);\n          } else if (maxDate.getDate() - 1 !== this.currentDate.getDate()) {\n            this.currentDate.setDate(this.currentDate.getDate() + 1);\n          }\n          this.selectDay(this.currentDate);\n        } else {\n          this.currentDate.setDate(this.currentDate.getDate() + 1);\n          this.selectDay(this.currentDate);\n        }\n      }\n\n      // Page Up Selects Same Day Prev Month\n      if (key === 33 && !e.altKey) {\n        handled = true;\n        if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (minDate.getMonth() !== this.currentDate.getMonth()) {\n            this.currentDate.setMonth(this.currentDate.getMonth() - 1);\n            this.selectDay(this.currentDate);\n          }\n        } else {\n          this.currentDate.setMonth(this.currentDate.getMonth() - 1);\n          this.selectDay(this.currentDate);\n        }\n      }\n\n      // Page Down Selects Same Day Next Month\n      if (key === 34 && !e.altKey) {\n        handled = true;\n        if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (this.currentDate.getMonth() !== maxDate.getMonth()) {\n            this.currentDate.setMonth(this.currentDate.getMonth() + 1);\n            this.selectDay(this.currentDate);\n          }\n        } else {\n          this.currentDate.setMonth(this.currentDate.getMonth() + 1);\n          this.selectDay(this.currentDate);\n        }\n      }\n\n      // ctrl + Page Up Selects Same Day previous Year\n      if (key === 33 && e.ctrlKey) {\n        handled = true;\n        this.currentDate.setFullYear(this.currentDate.getFullYear() - 1);\n        this.selectDay(this.currentDate);\n      }\n\n      // ctrl + Page Down Selects Same Day next Year\n      if (key === 34 && e.ctrlKey) {\n        handled = true;\n        this.currentDate.setFullYear(this.currentDate.getFullYear() + 1);\n        this.selectDay(this.currentDate);\n      }\n\n      // Home Moves to Start of the month\n      if (key === 36) {\n        handled = true;\n        const d = this.currentDate;\n        let firstDay;\n\n        if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (minDate.getMonth() !== this.currentDate.getMonth()) {\n            firstDay = new Date(d.getFullYear(), d.getMonth(), 1);\n          } else {\n            firstDay = new Date(minDate.getFullYear(), minDate.getMonth(), minDate.getDate());\n            firstDay.setDate(firstDay.getDate() + 1);\n          }\n        } else {\n          firstDay = new Date(d.getFullYear(), d.getMonth(), 1);\n        }\n\n        this.currentDate = firstDay;\n        if (this.isIslamic) {\n          this.currentIslamicDate = this.conversions.fromGregorian(this.currentDate);\n        }\n        this.selectDay(this.currentDate);\n      }\n\n      // End Moves to End of the month\n      if (key === 35) {\n        handled = true;\n        const d = this.currentDate;\n        let lastDay;\n        if (s.disable.restrictMonths && s.disable.minDate && s.disable.maxDate) {\n          if (this.currentDate.getMonth() !== maxDate.getMonth()) {\n            lastDay = new Date(d.getFullYear(), d.getMonth() + 1, 0);\n          } else {\n            lastDay = new Date(maxDate.getFullYear(), maxDate.getMonth(), maxDate.getDate());\n            lastDay.setDate(lastDay.getDate() - 1);\n          }\n        } else {\n          lastDay = new Date(d.getFullYear(), d.getMonth() + 1, 0);\n        }\n\n        this.currentDate = lastDay;\n        if (this.isIslamic) {\n          this.currentIslamicDate = this.conversions.fromGregorian(this.currentDate);\n        }\n        this.selectDay(this.currentDate);\n      }\n\n      // 't' selects today\n      if (key === 84) {\n        this.selectToday();\n        handled = true;\n      }\n\n      // Space or Enter closes Date Picker, selecting the Date\n      if (key === 32 || key === 13) {\n        handled = true;\n        if (s.range.useRange) {\n          if (!s.range.first || (s.range.first && !s.range.first.date)) {\n            allCell.removeClass('is-selected');\n          }\n          cell.focus().trigger('click');\n          return false;\n        }\n        const d = this.getCellDate(cell);\n\n        if (this.isIslamic) {\n          this.currentIslamicDate = [d.year, d.month, d.day];\n          this.currentDate = this.conversions.toGregorian(\n            this.currentIslamicDate[0],\n            this.currentIslamicDate[1],\n            this.currentIslamicDate[2]\n          );\n        } else {\n          this.currentDate = new Date(d.year, d.month, d.day);\n        }\n\n        this.selectDay(this.currentDate, true);\n      }\n\n      if (handled) {\n        e.stopPropagation();\n        e.preventDefault();\n        return false;\n      }\n      return true;\n    });\n  },\n\n  /**\n   * Validate the Previous and Next Button availability.\n   * @private\n   */\n  validatePrevNext() {\n    if (!this.settings.disable.restrictMonths\n      || !this.settings.disable.minDate || !this.settings.disable.maxDate) {\n      return;\n    }\n    const minDate = new Date(this.settings.disable.minDate);\n    const maxDate = new Date(this.settings.disable.maxDate);\n\n    this.element.find('.prev').prop('disabled', false);\n    this.element.find('.next').prop('disabled', false);\n\n    // Wierd edge case, the user probably should use validation.\n    if (minDate.getFullYear() > this.currentYear || this.currentYear > maxDate.getFullYear()) {\n      this.element.find('.prev').prop('disabled', true);\n      this.element.find('.next').prop('disabled', true);\n      return;\n    }\n\n    if (this.currentMonth - 1 < minDate.getMonth()) {\n      this.element.find('.prev').prop('disabled', true);\n    }\n\n    if (this.currentMonth + 1 > maxDate.getMonth()) {\n      this.element.find('.next').prop('disabled', true);\n    }\n  },\n\n  /**\n   * Add a Legend below the table\n   * @private\n   * @returns {void}\n   */\n  addLegend() {\n    const s = this.settings;\n    if (!s.showLegend) {\n      return;\n    }\n\n    // Remove Legend\n    if (this.legend && this.legend.length) {\n      this.legend.remove();\n    }\n\n    this.legend = $('<div class=\"monthview-legend\"></div>');\n\n    for (let i = 0; i < s.legend.length; i++) {\n      const series = s.legend[i];\n      const item = '' +\n        `<div class=\"monthview-legend-item\">\n          <span class=\"monthview-legend-swatch\" style=\"background-color: ${this.hexToRgba(series.color, 0.3)}\"></span>\n          <span class=\"monthview-legend-text\">${series.name}</span>\n        </div>`;\n\n      this.legend.append(item);\n    }\n    this.table.after(this.legend);\n  },\n\n  /**\n   * Convert the provided hex to an RGBA for states\n   * This may be later moved into a colors file along with getLuminousColorShade\n   * @private\n   * @param {string} hex to set.\n   * @param {string} opacity to check.\n   * @returns {string} converted rgba\n   */\n  hexToRgba(hex, opacity) {\n    let c;\n    if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {\n      c = hex.substring(1).split('');\n\n      if (c.length === 3) {\n        c = [c[0], c[0], c[1], c[1], c[2], c[2]];\n      }\n\n      c = `0x${c.join('')}`;\n      // eslint-disable-next-line\n      return `rgba(${[(c >> 16) & 255, (c >> 8) & 255, c & 255].join(',')},${opacity.toString()})`;\n    }\n    return '';\n  },\n\n  /**\n   * Set range on given cell -or- current month/year.\n   * @private\n   * @param {object} cell to set range.\n   * @returns {void}\n   */\n  setRangeOnCell(cell) {\n    const self = this;\n    const s = this.settings;\n\n    if (s.range.useRange && s.range.first && !s.range.second) {\n      const first = s.range.first;\n      const extra = s.range.extra;\n      const len = extra.cellLength - 1;\n      const firstCell = first.rowIdx + first.cellIdx + (len * first.rowIdx);\n      cell = $(cell);// First date selected cell element\n\n      if (cell.length && !cell.is('.is-disabled, .is-selected')) {\n        const row = cell.closest('tr');\n        const cellIdx = cell.index();\n        const rowIdx = row.index();\n        const thisCell = rowIdx + cellIdx + (len * rowIdx);\n        const d = self.getCellDate(cell);\n        const cellDate = new Date(d.year, d.month, d.day);\n        const max = this.getDifferenceToDate(s.range.first.date, s.range.maxDays);\n\n        self.days.find('td:visible').each(function (i) {\n          const thisTd = $(this);\n          if (cellDate > s.range.first.date && !s.range.selectBackward &&\n            (!s.range.maxDays || (s.range.maxDays > 0 && cellDate.getTime() <= max.aftertime)) &&\n            ((i > firstCell && i <= thisCell) || (cellDate > extra.max && i <= thisCell))) {\n            thisTd.addClass('range-next');\n          } else if (cellDate < s.range.first.date && !s.range.selectForward &&\n            (!s.range.maxDays || (s.range.maxDays > 0 && cellDate.getTime() >= max.beforetime)) &&\n            ((i < firstCell && i >= thisCell) || (cellDate < extra.min && i >= thisCell))) {\n            thisTd.addClass('range-prev');\n          } else {\n            thisTd.removeClass('range-next range-prev');\n          }\n        });\n      } else if (!cell.length) {\n        self.days.find('td').removeClass('range-next range-prev');\n      }\n    }\n    if (!cell && s.range.second) {\n      self.setRangeSelected();\n    }\n  },\n\n  /**\n   * Get difference to given date\n   * @private\n   * @param {object} date .\n   * @param {number} days .\n   * @param {boolean} includeDisabled .\n   * @returns {object} before/after difference to given date\n   */\n  getDifferenceToDate(date, days, includeDisabled) {\n    const difference = {};\n    const move = (d, daystomove, isNext) => {\n      d = new Date(d);\n      while (daystomove > 0) {\n        d.setDate(d.getDate() + (isNext ? 1 : -1));\n        if (includeDisabled || (!includeDisabled &&\n          !this.isDateDisabled(d.getFullYear(), d.getMonth(), d.getDate()))) {\n          daystomove--;\n          difference[isNext ? 'after' : 'before'] = new Date(d);\n        }\n      }\n      if (isNext && difference.after) {\n        difference.aftertime = difference.after.getTime();\n      } else if (difference.before) {\n        difference.beforetime = difference.before.getTime();\n      }\n    };\n    includeDisabled = typeof includeDisabled !== 'undefined' ? includeDisabled : this.settings.range.includeDisabled;\n    move(date, days); // previous\n    move(date, days, true); // next\n    return difference;\n  },\n\n  /**\n   * Set range selected value\n   * @private\n   * @returns {void}\n   */\n  setRangeSelected() {\n    const self = this;\n    const s = this.settings;\n    const dateObj = d => new Date(d.year, d.month, d.day);\n\n    if (s.range.useRange && s.range.second && s.range.second.date &&\n      this.days && this.days.length) {\n      this.days.find('td').removeClass('range range-next range-prev range-selection end-date is-selected');\n      this.days.find('td:visible').each(function () {\n        const cell = $(this);\n        const isDisabled = cell.is('.is-disabled') && !s.range.includeDisabled;\n        const includeDisabled = cell.is('.is-disabled') && s.range.includeDisabled;\n        const includeDisableClass = includeDisabled ? ' include-disabled' : '';\n        const getTime = (d) => {\n          d = new Date(d);\n          d.setHours(0, 0, 0);\n          return d.getTime();\n        };\n        const date = getTime(dateObj(self.getCellDate(cell)));\n        const d1 = getTime(s.range.first.date);\n        const d2 = getTime(s.range.second.date);\n\n        if ((date === d1 || date === d2) && !isDisabled) {\n          cell.addClass(`is-selected${includeDisableClass}${d1 !== d2 ? ` range-selection${date === d2 ? ' end-date' : ''}` : ''}`);\n        } else if ((date > d1 && date < d2) && !isDisabled) {\n          cell.addClass(`range-selection${includeDisableClass}`);\n        }\n      });\n    }\n  },\n\n  /**\n   * Get date from given cell.\n   * @private\n   * @param {object} cell to get date.\n   * @returns {object} as: year, month, day\n   */\n  getCellDate(cell) {\n    const s = this.settings;\n    const day = parseInt(cell.text(), 10);\n    let month = parseInt(this.header.find('.month').attr('data-month'), 10);\n    let year = parseInt(this.header.find('.year').text(), 10);\n\n    if (s.showMonthYearPicker) {\n      year = parseInt(this.header.find('.year select').val(), 10);\n      month = parseInt(this.header.find('.month select').val(), 10);\n    }\n\n    if (cell.hasClass('prev-month')) {\n      if (month === 0) {\n        month = 11;\n        year--;\n      } else {\n        month--;\n      }\n    } else if (cell.hasClass('next-month')) {\n      if (month === 11) {\n        month = 0;\n        year++;\n      } else {\n        month++;\n      }\n    }\n\n    return { year, month, day };\n  },\n\n  /**\n   * Check if file type allowed\n   * @private\n   * @param {object} elem to set fouus\n   * @param {boolean} isFocus true if need to set foucs\n   * @returns {object} element passed in\n   */\n  activeTabindex(elem, isFocus) {\n    $('td', this.element).removeAttr('tabindex');\n    elem.attr('tabindex', 0);\n\n    if (isFocus) {\n      elem.focus();\n    }\n    return elem;\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @returns {object} [description]\n   */\n  updated() {\n    return this\n      .destroy()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.header.off();\n    this.days.off();\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @private\n   * @returns {object} The prototype.\n   */\n  destroy() {\n    this.teardown();\n    this.element.empty();\n    this.element.off('keydown.monthview');\n    $.removeData(this.element[0], COMPONENT_NAME);\n    return this;\n  }\n};\n\nexport { MonthView, COMPONENT_NAME };\n","/* eslint-disable no-nested-ternary */\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { stringUtils } from '../../utils/string';\nimport { MonthView } from '../monthview/monthview';\nimport { Locale } from '../locale/locale';\nimport { Tmpl } from '../tmpl/tmpl';\n\n// Settings and Options\nconst COMPONENT_NAME = 'calendar';\n\nconst COMPONENT_NAME_DEFAULTS = {\n  eventTypes: [\n    { id: 'example', label: 'Example', color: 'emerald07', checked: true, click: () => {} },\n  ],\n  events: [],\n  locale: null,\n  month: new Date().getMonth(),\n  year: new Date().getFullYear(),\n  showViewChanger: true,\n  onRenderMonth: null,\n  template: null,\n  upcomingEventDays: 14,\n  modalTemplate: null,\n  menuId: null,\n  menuSelected: null,\n  newEventDefaults: {\n    title: 'NewEvent',\n    subject: '',\n    isAllDay: true,\n    comments: ''\n  }\n};\n\n/**\n * Calendar - Full eventing calendar.\n * @class Calendar\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings] The settings element.\n * @param {array} [settings.eventTypes] An array of objects with data for the event types.\n * @param {array} [settings.events] An array of objects with data for the events.\n * @param {string} [settings.locale] The name of the locale to use for this instance. If not set the current locale will be used.\n * @param {array} [settings.month] Initial month to show.\n * @param {array} [settings.year] Initial year to show.\n * @param {array} [settings.upcomingEventDays=14] How many days in advance should we show in the upcoming events pane.\n * @param {boolean} [settings.showViewChanger] If false the dropdown to change views will not be shown.\n * @param {function} [settings.onRenderMonth] Fires when a month is rendered, allowing you to pass back events or event types to show.\n * @param {function} [settings.onSelected] Fires when a month day is clicked. Allowing you to do something.\n * @param {string} [settings.template] The ID of the template used for the events.\n * @param {string} [settings.modalTemplate] The ID of the template used for the modal dialog on events.\n * @param {string} [settings.menuId=null] ID of the menu to use for an event right click context menu\n * @param {string} [settings.menuSelected=null] Callback for the  right click context menu\n * @param {string} [settings.newEventDefaults] Initial event properties for the new events dialog.\n */\nfunction Calendar(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, COMPONENT_NAME_DEFAULTS);\n  this.element = $(element);\n  this.init();\n}\n\n// Plugin Methods\nCalendar.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  init() {\n    return this\n      .build();\n  },\n\n  /**\n   * Add any needed markup to the component.\n   * @returns {object} The Calendar prototype, useful for chaining.\n   * @private\n   */\n  build() {\n    this.setLocale();\n    if (this.rendered ||\n      (this.settings.locale && (!this.locale || this.locale.name !== this.settings.locale))) {\n      this.rendered = false;\n      return this;\n    }\n\n    this.rendered = true;\n    this\n      .setCurrentCalendar()\n      .renderEventTypes()\n      .renderMonth()\n      .renderViewChanger()\n      .handleEvents();\n\n    return this;\n  },\n\n  /**\n   * Set current locale to be used.\n   * @private\n   * @returns {void}\n   */\n  setLocale() {\n    if (this.settings.locale && (!this.locale || this.locale.name !== this.settings.locale)) {\n      Locale.getLocale(this.settings.locale).done((locale) => {\n        this.locale = Locale.cultures[locale];\n        this.setCurrentCalendar();\n        this.build();\n      });\n    } else if (!this.settings.locale) {\n      this.locale = Locale.currentLocale;\n    }\n    return this;\n  },\n\n  /**\n   * Set current calendar data to to be used.\n   * @private\n   * @returns {void}\n   */\n  setCurrentCalendar() {\n    this.isRTL = this.locale.direction === 'right-to-left';\n    return this;\n  },\n\n  /**\n   * Render the eventType Section\n   * @returns {object} The Calendar prototype, useful for chaining.\n   * @private\n   */\n  renderEventTypes() {\n    this.eventTypeContainer = document.querySelector('.calendar-event-types');\n    if (!this.eventTypeContainer) {\n      return false;\n    }\n\n    let eventTypeMarkup = '';\n    for (let i = 0; i < this.settings.eventTypes.length; i++) {\n      const eventType = this.settings.eventTypes[i];\n      eventTypeMarkup += `<input type=\"checkbox\" class=\"checkbox ${eventType.color}07\" name=\"${eventType.id}\" id=\"${eventType.id}\" checked=\"${eventType.checked ? 'true' : 'false'}\" ${eventType.disabled ? 'disabled=\"true\"' : ''} />\n        <label for=\"${eventType.id}\" class=\"checkbox-label\">${eventType.translationKey ? Locale.translate(eventType.translationKey, { locale: this.locale.name }) : eventType.label}</label><br/>`;\n    }\n    this.eventTypeContainer.innerHTML = eventTypeMarkup;\n    this.element.initialize();\n    return this;\n  },\n\n  /**\n   * Render the monthview calendar\n   * @returns {object} The Calendar prototype, useful for chaining.\n   * @private\n   */\n  renderMonth() {\n    this.monthViewContainer = document.querySelector('.calendar .calendar-monthview');\n\n    this.monthView = new MonthView(this.monthViewContainer, {\n      onRenderMonth: this.settings.onRenderMonth,\n      onSelected: this.settings.onSelected,\n      selectable: true,\n      locale: this.settings.locale,\n      month: this.settings.month,\n      year: this.settings.year\n    });\n    this.monthViewHeader = document.querySelector('.calendar .monthview-header');\n    this.renderAllEvents();\n    return this;\n  },\n\n  /**\n   * Render the upcoming events view\n   * @param {object} event The Calendar event to show.\n   * @private\n   */\n  appendUpcomingEvent(event) {\n    this.upcomingEventsContainer = document.querySelector('.calendar-upcoming-events');\n    if (!this.upcomingEventsContainer || event.daysUntil > 0) {\n      return;\n    }\n\n    const daysUntil = Math.abs(event.daysUntil);\n    if (daysUntil < 0 || daysUntil > this.settings.upcomingEventDays) {\n      return;\n    }\n\n    const upcomingEvent = document.createElement('a');\n    upcomingEvent.setAttribute('href', '#');\n    upcomingEvent.setAttribute('data-key', event.startKey);\n    DOM.addClass(upcomingEvent, 'calendar-upcoming-event');\n\n    let upcomingEventsMarkup = '';\n    const startDay = Locale.formatDate(event.starts, { pattern: 'd', locale: this.locale.name });\n    const endDay = Locale.formatDate(event.ends, { pattern: 'd', locale: this.locale.name });\n    let dateRange = `${Locale.formatDate(event.starts, { pattern: 'MMMM', locale: this.locale.name })} ${startDay === endDay ? startDay : `${startDay}-${endDay}`}, ${Locale.formatDate(event.starts, { pattern: 'yyyy', locale: this.locale.name })}`;\n\n    if (parseInt(endDay, 10) < parseInt(startDay, 10)) {\n      const nextMonth = new Date(event.starts);\n      nextMonth.setDate(1);\n      nextMonth.setMonth(nextMonth.getMonth() + 1);\n      const endYear = nextMonth.getFullYear();\n      dateRange = `${Locale.formatDate(event.starts, { pattern: 'MMMM', locale: this.locale.name })} ${startDay} - ${Locale.formatDate(nextMonth, { pattern: 'MMMM', locale: this.locale.name })} ${endDay}, ${endYear}`;\n    }\n\n    upcomingEventsMarkup += `\n      <span class=\"calendar-upcoming-date\">${dateRange}</span>\n      <span class=\"calendar-upcoming-event-color ${event.color || ''}\">${event.color || ''}</span>\n      <span class=\"calendar-upcoming-description\">${event.subject || ''}</span>\n      <span class=\"calendar-upcoming-status-text\">${event.status || ''}</span>\n      <span class=\"calendar-upcoming-duration\">${event.isDays ? event.duration : event.durationHours} ${event.durationUnits || ''}</span>`;\n    upcomingEvent.innerHTML = upcomingEventsMarkup;\n    this.upcomingEventsContainer.appendChild(upcomingEvent);\n  },\n\n  /**\n   * Render the dropdown to change views.\n   * @returns {object} The Calendar prototype, useful for chaining.\n   * @private\n   */\n  renderViewChanger() {\n    if (!this.settings.showViewChanger) {\n      return this;\n    }\n    const viewChangerHtml = `<label for=\"calendar-view-changer\" class=\"label audible\">${Locale.translate('ChangeView', { locale: this.locale.name })}</label>\n      <select id=\"calendar-view-changer\" name=\"calendar-view-changer\" class=\"dropdown\">\n        <option value=\"month\" selected>${Locale.translate('Month', { locale: this.locale.name })}</option>\n        <option value=\"week\" disabled>${Locale.translate('Week', { locale: this.locale.name })}</option>\n        <option value=\"day\" disabled>${Locale.translate('Day', { locale: this.locale.name })}</option>\n        <option value=\"schedule\" disabled>${Locale.translate('Schedule', { locale: this.locale.name })}</option>\n      </select>\n    </div>`;\n    $(this.monthViewHeader).append(viewChangerHtml);\n    this.viewChangerHtml = $('#calendar-view-changer');\n    this.viewChangerHtml.dropdown();\n    return this;\n  },\n\n  /**\n   * Render or re-render the events details section, using on the readonly or default eventTemplate\n   * @param {string} eventId The event id\n   * @param {number} count The event count\n   * @private\n   */\n  renderEventDetails(eventId, count) {\n    if (!this.settings.events) {\n      return;\n    }\n\n    // Find the event data\n    const eventData = this.settings.events.filter(event => event.id === eventId);\n    if (!eventData || eventData.length === 0) {\n      return;\n    }\n\n    this.eventDetailsContainer = document.querySelector('.calendar-event-details');\n    this.renderTmpl(eventData[0], this.settings.template, this.eventDetailsContainer, count > 1);\n\n    const api = $(this.eventDetailsContainer).data('accordion');\n    if (api) {\n      api.destroy();\n    }\n    $(this.eventDetailsContainer).accordion();\n\n    if (DOM.hasClass(this.eventDetailsContainer, 'has-only-one')) {\n      $(this.eventDetailsContainer).find('.accordion-header, .accordion-header a').off('click');\n    }\n  },\n\n  /**\n   * Render each of the events for the currently selected node\n   * @private\n   */\n  renderSelectedEventDetails() {\n    const dayObj = this.getDayEvents();\n    this.clearEventDetails();\n    if (!dayObj.events || dayObj.events.length === 0) {\n      return;\n    }\n\n    for (let i = 0; i < dayObj.events.length; i++) {\n      this.renderEventDetails(dayObj.events[i].id, dayObj.events.length);\n    }\n  },\n\n  /**\n   * Clear all contents from the event details area.\n   * @private\n   */\n  clearEventDetails() {\n    this.eventDetailsContainer = document.querySelector('.calendar-event-details');\n    if (this.eventDetailsContainer) {\n      this.eventDetailsContainer.innerHTML = '';\n    }\n  },\n\n  /**\n   * Clear all contents from the upcoming events area.\n   * @private\n   */\n  clearUpcomingEvents() {\n    if (this.upcomingEventsContainer) {\n      this.upcomingEventsContainer.innerHTML = '';\n    }\n  },\n\n  /**\n   * Get the currently unchecked filter types\n   * @returns {array} The active types.\n   * @private\n   */\n  filterEventTypes() {\n    const checkboxes = this.eventTypeContainer.querySelectorAll('.checkbox');\n    const types = [];\n\n    for (let i = 0; i < checkboxes.length; i++) {\n      const input = checkboxes[i];\n      if (!input.checked) {\n        types.push(input.getAttribute('id'));\n      }\n    }\n    return types;\n  },\n\n  /**\n   * Get the difference between two dates.\n   * @private\n   * @param {date} first The first date.\n   * @param {date} second The second date.\n   * @param {boolean} useHours The different in hours if true, otherways days.\n   * @param {boolean} isFullDay Add an hour to include the full day to match the calendar.\n   * @returns {number} The difference between the two dates.\n   */\n  dateDiff(first, second, useHours, isFullDay) {\n    // Take the difference between the dates and divide by milliseconds per day.\n    // Round to nearest whole number to deal with DST.\n    let diff = Math.round((second - first) / (1000 * 60 * 60 * (useHours ? 1 : 24)));\n    if (isFullDay) {\n      diff += 1;\n    }\n    return diff;\n  },\n\n  /**\n   * Render/ReRender the events attached to the settings.\n   * @param {boolean} isCallback Will be set to true when a callback occurs\n   * @returns {object} The Calendar prototype, useful for chaining.\n   */\n  renderAllEvents(isCallback) {\n    if (this.settings.onRenderMonth && !isCallback) {\n      this.callOnRenderMonth();\n      return this;\n    }\n\n    const self = this;\n    const filters = this.filterEventTypes();\n\n    // Cleanup from previous renders\n    this.removeAllEvents();\n    this.clearUpcomingEvents();\n    this.clearEventDetails();\n\n    // Clone and sort the array.\n    const eventsSorted = this.settings.events.slice(0);\n    eventsSorted.sort((a, b) => (a.starts < b.starts ? -1 : (a.starts > b.starts ? 1 : 0)));\n\n    for (let i = 0; i < eventsSorted.length; i++) {\n      const event = eventsSorted[i];\n      if (filters.indexOf(event.type) > -1) {\n        continue;\n      }\n      self.renderEvent(event);\n    }\n\n    this.renderSelectedEventDetails();\n    return this;\n  },\n\n  /**\n   * Render a single event on the ui, use in the loop and other functions.\n   * @param  {object} event The event object.\n   */\n  renderEvent(event) {\n    const self = this;\n\n    // Check for events starting on this day , or only on this day.\n    const startDate = new Date(event.starts);\n    const startKey = stringUtils.padDate(\n      startDate.getFullYear(),\n      startDate.getMonth(),\n      startDate.getDate(),\n    );\n\n    // Check for events extending onto this day\n    const endDate = new Date(event.ends);\n    const endKey = stringUtils.padDate(\n      endDate.getFullYear(),\n      endDate.getMonth(),\n      endDate.getDate()\n    );\n\n    const days = self.monthView.dayMap.filter(day => day.key >= startKey && day.key <= endKey);\n    event.endKey = endKey;\n    event.startKey = startKey;\n    event = this.addCalculatedFields(event);\n    // const idx = self.monthView.dayMap.findIndex(day => day.key >= startKey && day.key <= endKey);\n    let idx = -1;\n    for (let i = 0; i < self.monthView.dayMap.length; ++i) {\n      if (self.monthView.dayMap[i].key >= startKey && self.monthView.dayMap[i].key <= endKey) {\n        idx = i;\n        break;\n      }\n    }\n\n    // Event is only on this day\n    if (days.length === 1) {\n      self.appendEvent(days[0].elem[0], event, 'event-day-start-end', idx);\n    }\n\n    // Event extends multiple days\n    if (days.length > 1) {\n      for (let l = 0; l < days.length; l++) {\n        let cssClass = l === 0 ? 'event-day-start' : 'event-day-span';\n\n        if (days.length - 1 === l) {\n          cssClass = 'event-day-end';\n        }\n        self.appendEvent(days[l].elem[0], event, cssClass, idx + l);\n      }\n    }\n\n    // Event extends multiple days\n    this.appendUpcomingEvent(event, days, idx);\n  },\n\n  /**\n   * Remove all events from the month.\n   */\n  removeAllEvents() {\n    const moreEvents = this.monthViewContainer.querySelectorAll('.calendar-event-more');\n    for (let i = 0; i < moreEvents.length; i++) {\n      moreEvents[i].parentNode.removeChild(moreEvents[i]);\n    }\n\n    const calendarEvents = this.monthViewContainer.querySelectorAll('.calendar-event');\n    for (let i = 0; i < calendarEvents.length; i++) {\n      calendarEvents[i].parentNode.removeChild(calendarEvents[i]);\n    }\n\n    for (let i = 0; i < this.monthView.dayMap.length; i++) {\n      this.monthView.dayMap[i].events = [];\n    }\n  },\n\n  /**\n   * Add calculated fields to the event object.\n   * @private\n   * @param {object} event The starting event object\n   * @returns {object} The event object with stuff added.\n   */\n  addCalculatedFields(event) {\n    event.color = this.getEventTypeColor(event.type);\n    event.duration = Math.abs(this.dateDiff(\n      new Date(event.ends),\n      new Date(event.starts),\n      false,\n      event.isFullDay\n    ));\n    event.durationUnits = event.duration > 1 ? Locale.translate('Days', { locale: this.locale.name }) : Locale.translate('Day', { locale: this.locale.name });\n    event.daysUntil = event.starts ? this.dateDiff(new Date(event.starts), new Date()) : 0;\n    event.durationHours = this.dateDiff(new Date(event.starts), new Date(event.ends), true);\n    event.isDays = true;\n    if (event.isAllDay === undefined) {\n      event.isAllDay = true;\n    }\n\n    if (event.durationHours < 24) {\n      event.isDays = false;\n      event.isAllDay = false;\n      delete event.duration;\n      event.durationUnits = event.durationHours > 1 ? Locale.translate('Hours', { locale: this.locale.name }) : Locale.translate('Hour', { locale: this.locale.name });\n    }\n    if (event.isAllDay.toString() === 'true') {\n      event.isDays = true;\n      delete event.durationHours;\n      event.durationUnits = event.duration > 1 ? Locale.translate('Days', { locale: this.locale.name }) : Locale.translate('Day', { locale: this.locale.name });\n      event.duration = this.dateDiff(new Date(event.starts), new Date(event.ends));\n    }\n    if (event.duration === 0 && event.isAllDay.toString() === 'true') {\n      event.isDays = true;\n      event.duration = 1;\n      event.durationUnits = Locale.translate('Day', { locale: this.locale.name });\n    }\n    if (event.starts) {\n      const startsLocale = Locale.parseDate(event.starts, { pattern: 'yyyy-MM-ddTHH:mm:ss.SSS', locale: this.locale.name });\n      event.startsLocale = Locale.formatDate(startsLocale, { locale: this.locale.name });\n    }\n    if (event.ends) {\n      const endsLocale = Locale.parseDate(event.ends, { pattern: 'yyyy-MM-ddTHH:mm:ss.SSS', locale: this.locale.name });\n      event.endsLocale = Locale.formatDate(endsLocale, { locale: this.locale.name });\n    }\n    event.eventTypes = this.settings.eventTypes;\n    event.isAllDay = event.isAllDay.toString();\n    if (event.isAllDay.toString() === 'false') {\n      delete event.isAllDay;\n    }\n    return event;\n  },\n\n  /**\n   * Add the ui event to the container.\n   * @private\n   * @param {object} container The container to append to\n   * @param {object} event The event data object.\n   * @param {string} type Type of event, can be event-day-start, event-day-start-end, event-day-span, event-day-end\n   * @param {number} idx The dayMap index\n   * @returns {object} The Calendar prototype, useful for chaining.\n   */\n  appendEvent(container, event, type, idx) {\n    let node;\n    const eventCnt = container.querySelectorAll('.calendar-event').length;\n\n    if (idx > -1) {\n      if (!this.monthView.dayMap[idx].events) {\n        this.monthView.dayMap[idx].events = [];\n      }\n      this.monthView.dayMap[idx].events.push(event);\n    }\n\n    if (eventCnt >= 2) {\n      const moreSpan = container.querySelector('.calendar-event-more');\n      const moreText = Locale.translate('More', { locale: this.locale.name }).replace('...', '');\n      if (!moreSpan) {\n        node = document.createElement('span');\n        DOM.addClass(node, 'calendar-event-more');\n        node.innerHTML = `+ 1 ${moreText}`;\n        node.setAttribute('data-count', 1);\n        container.querySelector('.day-container').appendChild(node);\n      } else {\n        let cnt = moreSpan.getAttribute('data-count');\n        cnt++;\n        moreSpan.setAttribute('data-count', cnt);\n        moreSpan.innerHTML = `+ ${cnt} ${moreText}`;\n      }\n\n      return this;\n    }\n\n    node = document.createElement('a');\n    DOM.addClass(node, 'calendar-event', event.color, type);\n    node.setAttribute('data-id', event.id);\n    node.setAttribute('data-key', event.startKey);\n\n    node.innerHTML = `<div class=\"calendar-event-content\">\n      ${event.icon ? `<span class=\"calendar-event-icon\"><svg class=\"icon ${event.icon}\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\" data-status=\"${event.status}\"><use xlink:href=\"#${event.icon}\"></use></svg></span>` : ''}\n      <span class=\"calendar-event-title\">${event.shortSubject || event.subject}</span>\n    </div>`;\n    container.querySelector('.day-container').appendChild(node);\n\n    // Show the full text if cut off\n    if (!event.shortSubject) {\n      node.setAttribute('title', event.subject);\n      $(node).tooltip({\n        beforeShow: (response, ui) => {\n          const title = ui[0].querySelector('.calendar-event-title');\n          const icon = ui[0].querySelector('.calendar-event-icon');\n          const iconStatus = icon ? icon.querySelector('.icon').getAttribute('data-status') : '';\n\n          if (title.offsetWidth > ui[0].scrollWidth - (icon ? icon.offsetWidth : 0)) {\n            response(`${title.innerText}${iconStatus ? ` (${Locale.translate(iconStatus, { locale: this.locale.name }, false)})` : ''}`);\n            return;\n          }\n          response(false);\n        }\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * Find the matching type and get the color.\n   * @param {object} id The eventType id to find.\n   * @param {object} event The event data object.\n   * @returns {object} The Calendar prototype, useful for chaining.\n   */\n  getEventTypeColor(id) {\n    let color = 'azure';\n    if (!id) {\n      return color;\n    }\n\n    const eventInfo = this.settings.eventTypes.filter(eventType => eventType.id === id);\n    if (eventInfo.length === 1) {\n      color = eventInfo[0].color || 'azure';\n    }\n    return color;\n  },\n\n  /**\n   * Find the matching type and get the color.\n   * @param {object} id The eventType id to find.\n   * @param {object} event The event data object.\n   * @returns {object} The Calendar prototype, useful for chaining.\n   */\n  getEventTypeLabel(id) {\n    let type = '';\n    if (!id) {\n      return type;\n    }\n\n    const eventInfo = this.settings.eventTypes.filter(eventType => eventType.id === id);\n    if (eventInfo.length === 1) {\n      type = eventInfo[0].label;\n    }\n    return type;\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @returns {object} The Calendar prototype, useful for chaining.\n   * @private\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.off(`updated.${COMPONENT_NAME}`).on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    this.isSwitchingMonth = false;\n    this.element.off(`monthrendered.${COMPONENT_NAME}`).on(`monthrendered.${COMPONENT_NAME}`, () => {\n      this.isSwitchingMonth = true;\n      if (this.modalVisible()) {\n        this.removeModal();\n      }\n      this.renderAllEvents();\n\n      setTimeout(() => {\n        this.isSwitchingMonth = false;\n      }, 500);\n    });\n\n    this.element.off(`change.${COMPONENT_NAME}`).on(`change.${COMPONENT_NAME}`, '.checkbox', () => {\n      this.renderAllEvents(true);\n    });\n\n    $(this.monthViewContainer).off(`selected.${COMPONENT_NAME}`).on(`selected.${COMPONENT_NAME}`, () => {\n      this.renderSelectedEventDetails();\n    });\n\n    this.element.off(`click.${COMPONENT_NAME}`).on(`click.${COMPONENT_NAME}`, '.calendar-upcoming-event', (e) => {\n      const key = e.currentTarget.getAttribute('data-key');\n      this.monthView.selectDay(key);\n    });\n\n    if (this.settings.menuId) {\n      this.element.off(`contextmenu.${COMPONENT_NAME}`).on(`contextmenu.${COMPONENT_NAME}`, '.calendar-event', (e) => {\n        e.preventDefault();\n        const event = $(e.currentTarget);\n        event.popupmenu({ attachToBody: true, menuId: this.settings.menuId, trigger: 'immediate', offset: { y: 5 } });\n\n        event.off('selected.calendar').on('selected.calendar', function (evt, elem) {\n          const eventId = this.getAttribute('data-id');\n          if (self.settings.menuSelected) {\n            self.settings.menuSelected(evt, elem, eventId);\n          }\n\n          if (elem.attr('data-action') === 'delete-event') {\n            self.deleteEvent({ id: eventId });\n          }\n          if (elem.attr('data-action') === 'show-event') {\n            const key = this.getAttribute('data-key');\n            self.monthView.selectDay(key);\n          }\n        });\n      });\n    }\n\n    const showModalWithCallback = (eventData, isAdd) => {\n      this.showEventModal(eventData, (elem, event) => {\n        // Collect the data and popuplate the event object\n        const inputs = elem.querySelectorAll('input, textarea, select');\n        for (let i = 0; i < inputs.length; i++) {\n          event[inputs[i].id] = inputs[i].getAttribute('type') === 'checkbox' ? inputs[i].checked : inputs[i].value;\n        }\n\n        if (isAdd) {\n          this.addEvent(event);\n        } else {\n          this.updateEvent(event);\n        }\n      });\n    };\n\n    this.element.off(`click.${COMPONENT_NAME}`).on(`click.${COMPONENT_NAME}`, '.calendar-event', (e) => {\n      const eventId = e.currentTarget.getAttribute('data-id');\n      const eventData = this.settings.events.filter(event => event.id === eventId);\n      if (!eventData || eventData.length === 0) {\n        return;\n      }\n      showModalWithCallback(eventData[0], false);\n    });\n\n    this.element.off(`dblclick.${COMPONENT_NAME}`).on(`dblclick.${COMPONENT_NAME}`, 'td', (e) => {\n      // throw this case out or you can click the wrong day\n      if (this.isSwitchingMonth || this.modalVisible()) {\n        return;\n      }\n      const key = e.currentTarget.getAttribute('data-key');\n      const day = new Date(key.substr(0, 4), key.substr(4, 2) - 1, key.substr(6, 2));\n\n      const eventData = utils.extend({ }, this.settings.newEventDefaults);\n      eventData.startKey = key;\n      eventData.endKey = key;\n      eventData.starts = day;\n      eventData.ends = day;\n\n      this.cleanEventData(eventData, false);\n      showModalWithCallback(eventData, true);\n    });\n    return this;\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @private\n   */\n  callOnRenderMonth() {\n    const self = this;\n\n    function response(events, eventTypes) {\n      if (eventTypes && eventTypes.length > 0) {\n        self.settings.eventTypes = eventTypes;\n        self.renderEventTypes();\n      }\n      if (events && events.length > 0) {\n        self.settings.events = events;\n        self.renderAllEvents(true);\n      }\n    }\n    this.settings.onRenderMonth(this.element, response);\n  },\n\n  /**\n   * Get the current selected date on the calendar.\n   * @returns {date} the currently selected date on the control.\n   */\n  currentDate() {\n    return this.isRTL ? this.monthView.currentIslamicDate : this.monthView.currentDate;\n  },\n\n  /**\n   * Get the events and date for the currently selected calendar day.\n   * @param {date} date The date to find the events for.\n   * @returns {object} dayEvents An object with all the events and the event date.\n   */\n  getDayEvents(date) {\n    if (!date) {\n      date = this.currentDate();\n    }\n\n    if (typeof date !== 'string' && !this.isRTL) {\n      date = stringUtils.padDate(\n        date.getFullYear(),\n        date.getMonth(),\n        date.getDate(),\n      );\n    }\n\n    if (this.isRTL) {\n      date = stringUtils.padDate(\n        date[0],\n        date[1],\n        date[2],\n      );\n    }\n\n    const dayObj = this.monthView.dayMap.filter(dayFilter => dayFilter.key === date);\n\n    const dayEvents = {\n      date: this.monthView.currentDate,\n      events: []\n    };\n\n    if (dayObj.length === 0) {\n      return [];\n    }\n\n    dayEvents.events = dayObj[0].events;\n    dayEvents.elem = dayObj[0].elem;\n    return dayEvents;\n  },\n\n  /**\n   * Render the template into the container.\n   * @param {object} event The event object with common event properties.\n   * @param {object} template The template id.\n   * @param {object} container The container to put it in.\n   * @param {boolean} append If true we append the template into the container.\n  */\n  renderTmpl(event, template, container, append) {\n    if (typeof Tmpl !== 'object' || !template) {\n      return;\n    }\n\n    // create a copy of the template\n    if (template instanceof $) {\n      template = `${template.html()}`;\n    } else if (typeof template === 'string') {\n      // If a string doesn't contain HTML elments,\n      // assume it's an element ID string and attempt to select with jQuery\n      if (!stringUtils.containsHTML(template)) {\n        template = $(`#${template}`).html();\n      }\n    }\n\n    event.color = this.getEventTypeColor(event.type);\n    event.startsLong = Locale.formatDate(event.starts, { date: 'long', locale: this.locale.name });\n    event.endsLong = Locale.formatDate(event.ends, { date: 'long', locale: this.locale.name });\n    event.typeLabel = this.getEventTypeLabel(event.type);\n\n    const renderedTmpl = Tmpl.compile(template, { event });\n    container.classList.remove('has-only-one');\n\n    if (append) {\n      DOM.append(container, renderedTmpl, '*');\n      return;\n    }\n    container.innerHTML = renderedTmpl;\n    container.classList.add('has-only-one');\n  },\n\n  /**\n   * Add a new event via the event object and show it if it should be visible in the calendar.\n   * @param {object} event The event object with common event properties.\n   */\n  addEvent(event) {\n    this.cleanEventData(event, true);\n    this.settings.events.push(event);\n    this.renderEvent(event);\n    this.renderSelectedEventDetails();\n  },\n\n  /**\n   * Update an event via the event object and show it if it should be visible in the calendar.\n   * It uses the event id to do this.\n   * @param {object} event The event object with common event properties.\n   */\n  updateEvent(event) {\n    const eventId = event.id;\n    for (let i = this.settings.events.length - 1; i >= 0; i--) {\n      if (this.settings.events[i].id === eventId) {\n        this.settings.events[i] = utils.extend(true, this.settings.events[i], event);\n        this.cleanEventData(this.settings.events[i], true);\n      }\n    }\n\n    this.renderAllEvents();\n  },\n\n  /**\n   * Remove an event from the dataset and page. It uses the id property.\n   * @param {object} event The event object with common event properties.\n   */\n  deleteEvent(event) {\n    const eventId = event.id;\n\n    for (let i = this.settings.events.length - 1; i >= 0; i--) {\n      if (this.settings.events[i].id === eventId) {\n        this.settings.events.splice(i, 1);\n      }\n    }\n    this.renderAllEvents();\n  },\n\n  /**\n   * Fix missing / incomlete event data\n   * @param {object} event The event object with common event properties.\n   * @param {boolean} addPlaceholder If true placeholder text will be added for some empty fields.\n   * @private\n   */\n  cleanEventData(event, addPlaceholder) {\n    const isAllDay = event.isAllDay === 'on' || event.isAllDay === 'true' || event.isAllDay;\n    let startDate = new Date(event.starts);\n    let endDate = new Date(event.ends);\n\n    if (!Locale.isValidDate(startDate)) {\n      startDate = this.currentDate();\n    }\n    if (!Locale.isValidDate(endDate)) {\n      endDate = this.currentDate();\n    }\n\n    if (isAllDay) {\n      startDate.setHours(0, 0, 0, 0);\n      event.starts = Locale.formatDate(new Date(startDate), { pattern: 'yyyy-MM-ddTHH:mm:ss.SSS', locale: this.locale.name });\n      endDate.setHours(23, 59, 59, 999);\n      event.ends = Locale.formatDate(new Date(endDate), { pattern: 'yyyy-MM-ddTHH:mm:ss.SSS', locale: this.locale.name });\n      event.duration = event.starts === event.ends ? 1 : null;\n      event.isAllDay = true;\n    } else {\n      if (startDate === endDate) {\n        endDate.setHours(endDate.getHours() + parseInt(event.durationHours, 10));\n        event.ends = Locale.formatDate(endDate.toISOString(), { pattern: 'yyyy-MM-ddTHH:mm:ss.SSS', locale: this.locale.name });\n        event.duration = null;\n      } else {\n        event.ends = Locale.formatDate(new Date(endDate), { pattern: 'yyyy-MM-ddTHH:mm:ss.SSS', locale: this.locale.name });\n      }\n      event.starts = Locale.formatDate(new Date(startDate), { pattern: 'yyyy-MM-ddTHH:mm:ss.SSS', locale: this.locale.name });\n      event.isAllDay = false;\n    }\n\n    if (event.comments === undefined && addPlaceholder) {\n      event.comments = Locale.translate('NoCommentsEntered', { locale: this.locale.name });\n      event.noComments = true;\n    }\n\n    if (!event.subject && addPlaceholder) {\n      event.subject = Locale.translate('NoTitle', { locale: this.locale.name });\n    }\n\n    if (!event.type) {\n      // Default to the first one\n      event.type = this.settings.eventTypes[0].id;\n    }\n\n    if (event.id === undefined && addPlaceholder) {\n      const lastId = this.settings.events.length === 0\n        ? 0\n        : parseInt(this.settings.events[this.settings.events.length - 1].id, 10);\n      event.id = (lastId + 1).toString();\n    }\n\n    if (event.title === 'NewEvent') {\n      event.title = Locale.translate('NewEvent', { locale: this.locale.name });\n    }\n  },\n\n  /**\n   * Show a modal used to add/edit events. This uses the modalTemplate setting for the modal contents.\n   * @param {object} event The event object with common event properties for defaulting fields in the template.\n   * @param {function} done The callback for when the modal closes.\n   */\n  showEventModal(event, done) {\n    if (!this.settings.modalTemplate) {\n      return;\n    }\n\n    if (this.modalVisible()) {\n      this.removeModal();\n    }\n\n    this.modalContents = document.createElement('div');\n    DOM.addClass(this.modalContents, 'calendar-event-modal', 'hidden');\n    document.getElementsByTagName('body')[0].appendChild(this.modalContents);\n\n    event = this.addCalculatedFields(event);\n    this.renderTmpl(event || {}, this.settings.modalTemplate, this.modalContents);\n    const dayObj = this.getDayEvents();\n    const modalOptions = this.settings.modalOptions || {\n      content: $(this.modalContents),\n      closebutton: true,\n      // Placement logic wasnt working, flip left most cell\n      placement: dayObj.elem.index() === 6 ? 'left' : 'right',\n      popover: true,\n      offset: {\n        y: 10\n      },\n      title: event.title || event.subject,\n      trigger: 'immediate',\n      keepOpen: true,\n      extraClass: 'calendar-popup',\n      tooltipElement: '#calendar-popup',\n      headerClass: event.color\n    };\n\n    let isCancel = true;\n    dayObj.elem\n      .off('hide.calendar')\n      .on('hide.calendar', () => {\n        if (isCancel) {\n          this.removeModal();\n          return;\n        }\n\n        done(this.modalContents, event);\n        this.element.trigger('hidemodal', { elem: this.modalContents, event });\n        this.removeModal();\n        isCancel = true;\n      })\n      .popover(modalOptions)\n      .off('show.calendar')\n      .on('show.calendar', (evt, elem) => {\n        this.element.trigger('showmodal', { elem: this.modalContents, event });\n\n        // Wire the click on isAllDay to disable spinbox.\n        elem.find('#isAllDay').off().on('click.calendar', (e) => {\n          const isDisabled = $(e.currentTarget).prop('checked');\n          if (isDisabled) {\n            elem.find('#durationHours').data('spinbox').disable();\n          } else {\n            elem.find('#durationHours').data('spinbox').enable();\n          }\n        });\n\n        // Wire the correct type selector\n        elem.find('#type').val(event.type).trigger('updated');\n\n        // Wire the correct comments\n        elem.find('#comments').val(event.comments);\n        elem.find('#subject').focus();\n\n        // Wire the buttons\n        elem.find('button').on('click', (e) => {\n          const popupApi = dayObj.elem.data('tooltip');\n          const action = e.currentTarget.getAttribute('data-action');\n          isCancel = action !== 'submit';\n          if (popupApi) {\n            popupApi.hide(true);\n          }\n        });\n      });\n\n    this.activeElem = dayObj.elem;\n  },\n\n  /**\n   * @returns {boolean} whether or not this Modal is currently being displayed\n   */\n  modalVisible() {\n    return (document.querySelector('.calendar-event-modal') !== null);\n  },\n\n  /**\n   * Remove and destroy the modal.\n   * @private\n   */\n  removeModal() {\n    this.modalContents = null;\n    if (this.activeElem) {\n      this.activeElem.off();\n      this.activeElem.data('tooltip').destroy();\n    }\n    DOM.remove(document.getElementById('calendar-popup'));\n    DOM.remove(document.querySelector('.calendar-event-modal'));\n  },\n\n  /**\n   * Remove all events from the calendar\n   */\n  clearEvents() {\n    this.settings.events = [];\n    this.renderAllEvents();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @returns {object} [description]\n   */\n  updated() {\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @returns {object} The Component prototype, useful for chaining.\n   * @private\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    this.element.off(`monthrendered.${COMPONENT_NAME}`);\n    this.element.off(`change.${COMPONENT_NAME}`);\n    this.element.on(`click.${COMPONENT_NAME}`);\n    $(this.monthViewContainer).off();\n\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @private\n   */\n  destroy() {\n    if (this.eventTypeContainer) {\n      this.eventTypeContainer.innerHTML = '';\n    }\n    if (this.monthViewContainer) {\n      this.monthViewContainer.innerHTML = '';\n    }\n    if (this.upcomingEventsContainer) {\n      this.upcomingEventsContainer.innerHTML = '';\n    }\n    if (this.eventDetailsContainer) {\n      this.eventDetailsContainer.innerHTML = '';\n    }\n    this.removeModal();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Calendar, COMPONENT_NAME };\n","import { Calendar, COMPONENT_NAME } from './calendar';\n\n/**\n * jQuery Component Wrapper for Calendar\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.calendar = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Calendar(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Default Settings\nconst COMPONENT_NAME = 'circlepager';\n\n/**\n * The Circle Pager Displays content in a sliding carousel and has paging buttons.\n * @class CirclePager\n * @constructor\n *\n * @param {jQuery[]|HTMLElement} element The component element.\n * @param {object} [settings] The component settings.\n * @param {Integer} [settings.slidesToShow=1] The number of slides to show in one view / pane\n * @param {Integer} [settings.startingSlide] First showing slide/group, an 0-based integer\n * @param {boolean} [settings.loop=false] Setting loop: true will loop back after next/previous reached to end\n */\nconst CIRCLEPAGER_DEFAULTS = {\n  slidesToShow: 1,\n  startingSlide: null,\n  loop: false\n};\n\nfunction CirclePager(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, CIRCLEPAGER_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// CirclePager Methods\nCirclePager.prototype = {\n\n  init() {\n    this.setElements();\n\n    if (this.slides.length) {\n      this.createControls();\n      this.handleEvents();\n      this.initActiveSlide();\n      this.showCollapsedView();\n    }\n  },\n\n  /**\n   * Set elements\n   * @private\n   * @returns {void}\n   */\n  setElements() {\n    const s = this.settings;\n\n    this.container = $('.slides', this.element);\n    this.slidesJQ = $('.slide', this.element);\n    this.slidesToShow = s.slidesToShow;\n    this.slides = [];\n    this.isVisible = true;\n\n    for (let i = 0, l = this.slidesJQ.length; i < l; i++) {\n      this.slides.push({ node: $(this.slidesJQ[i]) });\n    }\n\n    this.activeIndex = s.startingSlide !== null &&\n      s.startingSlide > -1 && s.startingSlide < this.slides.length ?\n      s.startingSlide : 0;\n  },\n\n  /**\n   * Create controls\n   * @private\n   * @returns {void}\n   */\n  createControls() {\n    const len = this.slides.length;\n    let html = '<div class=\"controls\">';\n    let htmlContent = '';\n    let numOfButtons = 0;\n    let slide;\n    let temp;\n    let href;\n    let text;\n    let buttonText;\n    let last;\n    let lastIndex;\n    let isSingle;\n    let isDisabled;\n\n    for (let i = 0, l = len; i < l; i += this.slidesToShow) {\n      temp = '';\n      numOfButtons++;\n      isSingle = (this.slidesToShow === 1) || (len - i === 1);\n      text = Locale.translate(isSingle ? 'SlideOf' : 'SlidesOf');\n      // Keep href in english language only\n      href = isSingle ? '#slide {0} of {1}' : '#slides {0} and {1} of {2}';\n\n      // Collect as much bullets need to present\n      for (let g = 0; g < this.slidesToShow && (i + g) < len; g++) {\n        temp += `${(i + g + 1)}, `;\n      }\n      text = text.replace(isSingle ? '{1}' : '{2}', len);\n      href = href.replace(isSingle ? '{1}' : '{2}', len);\n      temp = temp.slice(0, -2);\n      lastIndex = temp.lastIndexOf(',');\n      last = temp.substr(lastIndex + 2);\n\n      // Controls for single slide in view\n      if (isSingle) {\n        isDisabled = '';\n        slide = this.slides[i].node;\n\n        // Set disabled\n        if (slide.is('.is-disabled, [disabled]') && !slide.is('[disabled=\"false\"]')) {\n          isDisabled = ' disabled tabindex=\"-1\"';\n          this.slides[i].isDisabled = true;\n        }\n\n        // Set default starting slide\n        if (slide.is('.active') && this.settings.startingSlide === null && isDisabled === '') {\n          this.activeIndex = i;\n        }\n\n        // Use custom text if supplied\n        buttonText = slide.attr('data-button-text');\n        text = (buttonText && buttonText.length) ?\n          buttonText : text.replace('{0}', temp);\n\n        href = href.replace('{0}', temp);\n      } else {\n        // Controls for multiple slides in view\n        temp = temp.substr(0, lastIndex);\n        text = text.replace('{1}', last).replace('{0}', temp);\n        href = href.replace('{1}', last).replace('{0}', temp);\n      }\n\n      href = href.toLowerCase().replace(/[\\s,--]+/g, '-');\n\n      htmlContent += `<a href=\"${href}\" class=\"control-button hyperlink hide-focus\"${isDisabled}><span class=\"audible\">${text}</span></a>`;\n    }\n\n    html += `${htmlContent}</div>`;\n\n    // Previous/Next buttons\n    this.isBulletsNav = this.element.width() > numOfButtons * 29;\n    const previousButton = $('.btn-previous', this.element);\n    const nextButton = $('.btn-next', this.element);\n    if (!this.isBulletsNav) {\n      if (!previousButton.length) {\n        html += '' +\n          `<button class=\"btn-previous\" type=\"button\">\n            ${$.createIcon('left-arrow')}\n            <span class=\"audible\"> ${Locale.translate('Previous')}</span>\n          </button>`;\n      }\n      if (!nextButton.length) {\n        html += '' +\n          `<button class=\"btn-next\" type=\"button\">\n            ${$.createIcon('right-arrow')}\n            <span class=\"audible\">${Locale.translate('Next')}</span>\n          </button>`;\n      }\n    } else {\n      previousButton.add(nextButton).remove();\n    }\n\n    if (this.activeIndex > 0 && this.activeIndex > (numOfButtons - 1)) {\n      this.activeIndex = numOfButtons - 1;\n    }\n\n    if (numOfButtons > 1) {\n      this.element.append(html);\n    }\n  },\n\n  /**\n   * Check if given element is visible in container\n   * @private\n   * @param {object} element to check.\n   * @returns {boolean} -1 if not in container\n   */\n  isVisibleInContainer(element) {\n    if (element && element[0]) {\n      const eRect = element[0].getBoundingClientRect();\n      const cRect = this.element[0].getBoundingClientRect();\n\n      return (eRect.left > cRect.left && eRect.left < (cRect.left + cRect.width) &&\n        eRect.top > cRect.top && eRect.top < (cRect.top + cRect.height));\n    }\n    return -1;\n  },\n\n  /**\n   * Update number of slides to show in view\n   * @private\n   * @param {object} numOfSlides to show.\n   * @returns {object} this api\n   */\n  updateSlidesToShow(numOfSlides) {\n    if (!this.isActive) {\n      return;\n    }\n    this.settings.slidesToShow = numOfSlides || 1;\n    this.updated();\n    return this; // eslint-disable-line\n  },\n\n  /**\n   * Make sure max number of slides to show in view\n   * @private\n   * @param {object} numOfSlides to show.\n   * @returns {void}\n   */\n  responsiveSlidesToShow(numOfSlides) {\n    if (!this.isActive) {\n      return;\n    }\n\n    this.slidesToShow = numOfSlides || this.settings.slidesToShow;\n    this.unbind().slidesJQ.css('width', '');\n    if (this.slides.length) {\n      setTimeout(() => {\n        this.createControls();\n        this.handleEvents();\n        this.initActiveSlide();\n        this.showCollapsedView();\n      }, 0);\n    }\n  },\n\n  /**\n   * Show a slide to First Slide\n   * @private\n   * @param {string} index  The index of the slide to show (0 based)\n   * @returns {void}\n   */\n  show(index) {\n    if (!this.isActive) {\n      return;\n    }\n    index = typeof index !== 'undefined' ? index : this.activeIndex;\n    this.activeIndex = index;\n\n    const left = index > 0 ? (`${(Locale.isRTL() ? '' : '-') + (index * 100)}%`) : 0;\n    this.controlButtons.removeClass('is-active').eq(index).addClass('is-active');\n    this.container[0].style.left = left;\n\n    // Make sure bullets navigation do not overflow\n    if (!this.isBulletsNav) {\n      this.element.addClass('is-bullets-nav-hidden');\n      this.controlButtons.find('span').addClass('audible').end()\n        .eq(index)\n        .find('span')\n        .removeClass('audible');\n    } else {\n      this.element.removeClass('is-bullets-nav-hidden');\n      this.controlButtons.find('span').addClass('audible');\n    }\n\n    // Set focus\n    if (this.isFocus && this.isBulletsNav) {\n      this.isFocus = false;\n      this.controlButtons.eq(index).focus();\n    }\n  },\n\n  /**\n   * Move to First Slide\n   * @private\n   * @returns {void}\n   */\n  first() {\n    this.show(0);\n  },\n\n  /**\n   * Move to Last Slide\n   * @private\n   * @returns {void}\n   */\n  last() {\n    this.show(Math.round(this.slides.length / this.slidesToShow) - 1);\n  },\n\n  /**\n   * Move to Previous Slide\n   * @private\n   * @returns {void}\n   */\n  prev() {// eslint-disable-line\n    let prev;\n\n    if (this.activeIndex > 0) {\n      prev = this.activeIndex - 1;\n    } else {\n      prev = this.settings.loop ? Math.round(this.slides.length / this.slidesToShow) - 1 : 0;\n    }\n\n    if (this.slides[prev].isDisabled) {\n      setTimeout(() => {\n        this.prev();\n      }, 0);\n      this.activeIndex = prev;\n      return false;\n    }\n    this.show(prev);\n  },\n\n  /**\n  * Move to Next Slide\n  * @private\n  * @returns {void}\n  */\n  next() {// eslint-disable-line\n    let next;\n    if (this.activeIndex >= Math.round(this.slides.length / this.slidesToShow) - 1) {\n      next = this.settings.loop ? 0 : this.activeIndex;\n    } else {\n      next = this.activeIndex + 1;\n    }\n\n    if (this.slides[next].isDisabled) {\n      setTimeout(() => {\n        this.next();\n      }, 0);\n      this.activeIndex = next;\n      return false;\n    }\n    this.show(next);\n  },\n\n  /**\n  * Make active\n  * @private\n  * @returns {void}\n  */\n  showCollapsedView() {\n    this.isActive = true;\n    this.element.addClass('is-active');\n    this.container[0].style.width = `${(100 * this.slides.length)}%`;\n    if (this.settings.slidesToShow > 1 &&\n       (this.slidesJQ.eq(0).width() * this.slidesToShow > this.element.width())) {\n      this.responsiveSlidesToShow(this.slidesToShow - 1);\n      return;\n    }\n    for (let i = 0, l = this.slidesJQ.length; i < l; i++) {\n      this.slidesJQ[i].style.width = `${((100 / this.slidesToShow) / this.slides.length)}%`;\n    }\n    this.show();\n  },\n\n  /**\n  * Make un-active\n  * @private\n  * @returns {void}\n  */\n  showExpandedView() {\n    this.isActive = false;\n    this.element.removeClass('is-active');\n    if (this.element && this.element[0]) {\n      this.element[0].style.width = '';\n    }\n    if (this.container && this.container[0]) {\n      this.container[0].style.width = '';\n      this.container[0].style.left = '';\n    }\n  },\n\n  /**\n  * Initialize active slide\n  * @private\n  * @returns {void}\n  */\n  initActiveSlide() {// eslint-disable-line\n    if (this.slides[this.activeIndex].isDisabled) {\n      this.next();\n      return false;\n    }\n    this.show();\n    this.slidesJQ.addClass('is-visible');\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    $('body').off('resize.circlepager');\n    this.element.off('focus.circlepager keydown.circlepager', '*');\n    if (this.controlButtons) {\n      this.controlButtons.off('click.circlepager keydown.circlepager');\n    }\n    $('.btn-previous, .btn-next', this.element).off('click.circlepager');\n    $('.controls', this.element).remove();\n    this.showExpandedView();\n\n    const possibleTab = this.element.closest('.tab-panel-container').prev('.tab-container');\n    possibleTab.off('activated.circlepager');\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, CIRCLEPAGER_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n\n    // Previous button\n    $('.btn-previous', this.element)\n      .on('click.circlepager', (e) => {\n        this.prev();\n        e.stopImmediatePropagation();\n      });\n\n    // Next button\n    $('.btn-next', this.element)\n      .on('click.circlepager', (e) => {\n        this.next();\n        e.stopImmediatePropagation();\n      });\n\n    this.controlButtons = $('.control-button', this.element);\n\n    for (let i = 0, l = this.controlButtons.length; i < l; i++) {\n      const btn = $(this.controlButtons[i]);\n      btn.hideFocus();\n\n      // Handle clicks for bottom bullet links\n      btn.on('click.circlepager', (e) => {\n        e.preventDefault();\n        if (this.slides[i].isDisabled) {\n          return;\n        }\n        this.show(i);\n      });\n    }\n\n    // Handle keyboard events\n\n    // Prevent hidden slide's content to be get focused\n    // on focusable elements in slides content\n    this.element.on('focus.circlepager', '*', function(e) {// eslint-disable-line\n      let handled = false;\n      if (!self.isVisibleInContainer($(this))) {\n        const canfocus = self.element.find(':focusable');\n        for (let i = 0, l = canfocus.length; i < l; i++) {\n          if (self.isVisibleInContainer(canfocus.eq(i))) {\n            canfocus.eq(i).focus();\n            handled = true;\n            break;\n          }\n        }\n      }\n      e.stopPropagation();\n      if (handled) {\n        return false;\n      }\n    });\n    // Keydown on focusable elements in slides content to\n    // prevent hidden slide's content to be get focused\n    this.element.on('keydown.circlepager', '*', function(e) {// eslint-disable-line\n      let handled = false;\n      const key = e.which || e.keyCode || e.charCode || 0;\n      const canfocus = $(':focusable');\n      const index = canfocus.index(this);\n\n      if (key === 9) { // tab\n        // Using shift key with tab (going backwards)\n        if (e.shiftKey) {\n          for (let i = index - 1; i >= 0; i--) {\n            if ((self.element.has(canfocus.eq(i)).length < 1) ||\n                (self.isVisibleInContainer(canfocus.eq(i)))) {\n              canfocus.eq(i).focus();\n              handled = true;\n              break;\n            }\n          }\n        } else if (!self.isVisibleInContainer(canfocus.eq(index + 1))) {\n          // Using only tab key (going forward)\n          self.controlButtons.first().focus();\n          handled = true;\n        }\n      }\n      e.stopPropagation();\n      if (handled) {\n        return false;\n      }\n    });\n\n    // Control buttons\n    this.controlButtons.on('keydown.circlepager', (e) => {// eslint-disable-line\n      let handled = false;\n      const key = e.which || e.keyCode || e.charCode || 0;\n      const isRTL = Locale.isRTL();\n\n      // Left and Right arrow keys\n      if ([37, 39].indexOf(key) !== -1) {\n        self.isFocus = true; // Move focus\n        if (e.altKey) {\n          // [Alt + Left/Right arrow] to move to the first or last\n          if ((key === 37 && !isRTL) || (key === 39 && isRTL)) {\n            self.first();\n          } else {\n            self.last();\n          }\n        } else {\n          // Left and Right arrow keys to navigate\n          if ((!isRTL && key === 37) || (isRTL && key === 39)) {\n            self.prev();\n          } else {\n            self.next();\n          }\n          handled = true;\n        }\n      }\n\n      if (handled) {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      }\n    });\n\n    // Set max number of slides can view on resize\n    $('body').on('resize.circlepager', () => {\n      self.responsiveSlidesToShow();\n    });\n\n    const possibleTab = self.element.closest('.tab-panel-container').prev('.tab-container');\n    possibleTab.off('activated.circlepager').on('activated.circlepager', () => {\n      self.responsiveSlidesToShow();\n    });\n  }\n\n};\n\nexport { CirclePager, COMPONENT_NAME };\n","import { CirclePager, COMPONENT_NAME } from './circlepager';\n\n/**\n * jQuery Component Wrapper for CirclePager\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.circlepager = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new CirclePager(this, settings));\n    }\n  });\n};\n","import { Environment as env } from '../../utils/environment';\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { personalization } from '../personalize/personalize.bootstrap';\n\n// Default Settings\nconst COMPONENT_NAME = 'colorpicker';\n\n/**\n * The ColorPicker Component is a trigger field with a listing colors that can be selected.\n * @class ColorPicker\n * @param {jQuery[]|HTMLElement} element The plugin element for the constuctor\n * @param {object} [settings] The settings element.\n * @param {object} [settings.themes={}] Themes available for ColorPicker\n * @param {array} [settings.colors=[]] An array of objects of the form. {label: 'Azure', number: '01', value: 'CBEBF4'}\n * that can be used to populate the color grid.\n * @param {boolean} [settings.showLabel=false]  Show the label if true vs the hex value if false.\n * @param {boolean} [settings.editable=true]  If false, the field is readonly and transparent. I.E. The value\n * cannot be typed only editable by selecting.\n * @param {boolean} [settings.uppercase=true] If false, lower case hex is allowed. If true upper case hex is allowed.\n * If showLabel is true this setting is ignored.\n * @param {boolean} [settings.colorOnly=false] If true the field will be shrunk to only show the color portion.\n * @param {boolean} [settings.clearable=true] If true will add clearable option.\n * @param {string} [settings.clearableText] The text to show in tooltip.\n */\nconst COLORPICKER_DEFAULTS = {\n  // Theme key: MUST match with theme file name (ie: [filename: 'light-theme.css' -> 'light-theme'])\n\n  // BORDERS\n  // Use (,) commas to separate themes or single entry for border as:\n  // colors[{label: 'Slate', number: '01', value: 'F0F0F0',\n  // border: 'light-theme, high-contrast-theme'}]\n  // and assign which swatch theborder should apply ['all' or 'matched-only']\n  // themes: { 'high-contrast-theme': {'border': 'all'} }\n\n  // CHECKMARKS\n  // checkmark: {'one': [1, 2], 'two': [3, 10]}\n  // will add class as \"checkmark-{key}\", where current colors number is in range\n  // [{value[0]} to {value[1]}]\n  // will add class \"checkmark-one\", where current colors number is in range [1 to 3]\n  // and will add class \"checkmark-two\", where current colors number is in range [3 to 10]\n  themes: {\n    light: { border: 'matched-only', checkmark: { one: [1, 2], two: [3, 10] } },\n    dark: { border: 'matched-only', checkmark: { one: [1, 2], two: [3, 10] } },\n    'high-contrast': { border: 'all', checkmark: { one: [1, 3], two: [4, 10] } }\n  },\n  customColors: false,\n  colors: [\n    { label: 'Slate', number: '10', value: '1a1a1a' },\n    { label: 'Slate', number: '09', value: '292929' },\n    { label: 'Slate', number: '08', value: '383838', border: 'dark' },\n    { label: 'Slate', number: '07', value: '454545', border: 'dark' },\n    { label: 'Slate', number: '06', value: '5C5C5C' },\n    { label: 'Slate', number: '05', value: '737373' },\n    { label: 'Slate', number: '04', value: '999999' },\n    { label: 'Slate', number: '03', value: 'BDBDBD' },\n    { label: 'Slate', number: '02', value: 'D8D8D8' },\n    { label: 'Slate', number: '01', value: 'F0F0F0', border: 'light, high-contrast' },\n    { label: 'Amber', number: '10', value: 'D66221' },\n    { label: 'Amber', number: '09', value: 'DE7223' },\n    { label: 'Amber', number: '08', value: 'E68425' },\n    { label: 'Amber', number: '07', value: 'EB9728' },\n    { label: 'Amber', number: '06', value: 'EFAA30' },\n    { label: 'Amber', number: '05', value: 'F2BC41' },\n    { label: 'Amber', number: '04', value: 'F4C951' },\n    { label: 'Amber', number: '03', value: 'F7D475' },\n    { label: 'Amber', number: '02', value: 'F8E09C' },\n    { label: 'Amber', number: '01', value: 'FBE9BF' },\n    { label: 'Ruby', number: '10', value: '880E0E' },\n    { label: 'Ruby', number: '09', value: '941E1E' },\n    { label: 'Ruby', number: '08', value: 'A13030' },\n    { label: 'Ruby', number: '07', value: 'AD4242' },\n    { label: 'Ruby', number: '06', value: 'B94E4E' },\n    { label: 'Ruby', number: '05', value: 'C65F5F' },\n    { label: 'Ruby', number: '04', value: 'D26D6D' },\n    { label: 'Ruby', number: '03', value: 'DE8181' },\n    { label: 'Ruby', number: '02', value: 'EB9D9D' },\n    { label: 'Ruby', number: '01', value: 'F4BCBC' },\n    { label: 'Turquoise', number: '10', value: '0E5B52' },\n    { label: 'Turquoise', number: '09', value: '206B62' },\n    { label: 'Turquoise', number: '08', value: '317C73' },\n    { label: 'Turquoise', number: '07', value: '448D83' },\n    { label: 'Turquoise', number: '06', value: '579E95' },\n    { label: 'Turquoise', number: '05', value: '69ADA3' },\n    { label: 'Turquoise', number: '04', value: '7BBFB5' },\n    { label: 'Turquoise', number: '03', value: '8ED1C6' },\n    { label: 'Turquoise', number: '02', value: 'A9E1D6' },\n    { label: 'Turquoise', number: '01', value: 'C0EDE3' },\n    { label: 'Emerald', number: '10', value: '397514' },\n    { label: 'Emerald', number: '09', value: '44831F' },\n    { label: 'Emerald', number: '08', value: '56932E' },\n    { label: 'Emerald', number: '07', value: '66A140' },\n    { label: 'Emerald', number: '06', value: '76B051' },\n    { label: 'Emerald', number: '05', value: '89BF65' },\n    { label: 'Emerald', number: '04', value: '9CCE7C' },\n    { label: 'Emerald', number: '03', value: 'AFDC91' },\n    { label: 'Emerald', number: '02', value: 'C3E8AC' },\n    { label: 'Emerald', number: '01', value: 'D5F6C0' },\n    { label: 'Amethyst', number: '10', value: '4B2A5E' },\n    { label: 'Amethyst', number: '09', value: '5A3A6F' },\n    { label: 'Amethyst', number: '08', value: '6C4B81' },\n    { label: 'Amethyst', number: '07', value: '7D5F92' },\n    { label: 'Amethyst', number: '06', value: '8E72A4' },\n    { label: 'Amethyst', number: '05', value: 'A189B8' },\n    { label: 'Amethyst', number: '04', value: 'B59ECA' },\n    { label: 'Amethyst', number: '03', value: 'C7B4DB' },\n    { label: 'Amethyst', number: '02', value: 'DACCEC' },\n    { label: 'Amethyst', number: '01', value: 'EDE3FC' },\n    { label: 'Azure', number: '10', value: '133C59' },\n    { label: 'Azure', number: '09', value: '134D71' },\n    { label: 'Azure', number: '08', value: '1D5F8A' },\n    { label: 'Azure', number: '07', value: '2876A8' },\n    { label: 'Azure', number: '06', value: '368AC0' },\n    { label: 'Azure', number: '05', value: '4EA0D1' },\n    { label: 'Azure', number: '04', value: '69B5DD' },\n    { label: 'Azure', number: '03', value: '8DC9E6' },\n    { label: 'Azure', number: '02', value: 'ADD8EB' },\n    { label: 'Azure', number: '01', value: 'C8E9F4' }\n  ],\n  placeIn: null, // null|'editor'\n  showLabel: false,\n  editable: true,\n  disabled: false,\n  uppercase: true,\n  colorOnly: false,\n  clearable: true,\n  clearableText: null,\n};\n\nfunction ColorPicker(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, COLORPICKER_DEFAULTS);\n\n  // Merge Settings does deep copy we want to replace here\n  if (settings && settings.colors) {\n    this.settings.colors = settings.colors;\n  }\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nColorPicker.prototype = {\n\n  init() {\n    this.isIe = env.browser.name === 'ie';\n    this.isIeEdge = env.browser.name === 'edge';\n    this.isIe11 = this.isIe && env.browser.version === '11';\n    this.inlineLabel = this.element.closest('label');\n    this.inlineLabelText = this.inlineLabel.find('.label-text');\n    this.isInlineLabel = this.element.parent().is('.inline');\n\n    // Set default clearable text\n    if (!this.settings.clearableText) {\n      this.settings.clearableText = Locale ? Locale.translate('None') : 'None';\n    }\n\n    this.build();\n    this.handleEvents();\n    this.setCustomWidth();\n  },\n\n  // Add the extra markup\n  build() {\n    this.isEditor = this.settings.placeIn === 'editor';\n    const colorpicker = this.element;\n    const initialValue = this.isEditor ? this.element.attr('data-value') : this.element.val();\n    const classList = `swatch${(!initialValue || $.trim(initialValue) === '') ? ' is-empty' : ''}`;\n\n    if (!this.isEditor) {\n      // Add Button\n      if (this.isInlineLabel) {\n        this.inlineLabel.addClass('colorpicker-container');\n      } else {\n        this.container = $('<span class=\"colorpicker-container\"></span>');\n        colorpicker.wrap(this.container);\n      }\n\n      this.container = colorpicker.parent();\n      this.swatch = $(`<span class=\"${classList}\"></span>`).prependTo(this.container);\n\n      // Add Masking to show the #.\n      // Remove the mask if using the \"showLabel\" setting\n      if (!this.settings.showLabel) {\n        const pattern = ['#', /[0-9a-fA-F]/, /[0-9a-fA-F]/, /[0-9a-fA-F]/, /[0-9a-fA-F]/, /[0-9a-fA-F]/, /[0-9a-fA-F]/];\n\n        colorpicker.mask({ pattern });\n      } else {\n        const maskAPI = colorpicker.data('mask');\n        if (maskAPI && typeof maskAPI.destroy === 'function') {\n          maskAPI.destroy();\n        }\n      }\n    }\n\n    let trigger = this.element.children('.trigger');\n    if (this.container && this.container.length) {\n      trigger = this.container.children('.trigger');\n    }\n\n    if (!trigger || !trigger.length || !trigger.children('.icon').length) {\n      this.icon = $.createIconElement('dropdown')\n        .appendTo(this.isEditor ? this.element : this.container);\n      this.icon.wrap('<span class=\"trigger\"></span>');\n    }\n\n    // Handle initial values\n    if (initialValue) {\n      this.setColor(initialValue);\n    }\n\n    if (this.element.is(':disabled') || this.settings.disabled) {\n      this.disable();\n    }\n\n    if (this.element.prop('readonly')) {\n      this.readonly();\n    }\n\n    if (!this.settings.editable && !this.settings.disabled) {\n      this.readonly();\n    }\n\n    if (this.settings.colorOnly) {\n      this.element.parent().addClass('color-only');\n    }\n\n    this.addAria();\n  },\n\n  /**\n  * Get the hex value based on a label. Does not handle duplicates.\n  * @param {string} label  The label to search for in the color labels.\n  * @returns {void}\n  */\n  getHexFromLabel(label) {\n    for (let i = 0; i < this.settings.colors.length; i++) {\n      const data = this.settings.colors[i];\n      const translated = Locale.translate(data.label, true);\n\n      if (label === data.label + data.number || label === translated + data.number) {\n        let hex = data.value;\n        if (hex.substr(0, 1) !== '#') {\n          hex = `#${hex}`;\n        }\n\n        return hex;\n      }\n    }\n    return '';\n  },\n\n  /**\n  * Get the label value based on a hex. Does not handle duplicates.\n  * Can pass with or without the #\n  *\n  * @param {string} hex The hex to search for in the color set.\n  * @returns {void}\n  */\n  getLabelFromHex(hex) {\n    if (!hex) {\n      return '';\n    }\n\n    for (let i = 0; i < this.settings.colors.length; i++) {\n      const data = this.settings.colors[i];\n\n      if (hex.replace('#', '') === data.value.replace('#', '')) {\n        return this.translateColorLabel(data.label) + data.number;\n      }\n    }\n\n    return '';\n  },\n\n  /**\n  * Set custom width.\n  * @private\n  * @returns {void}\n  */\n  setCustomWidth() {\n    if (this.element[0].style && this.element[0].style.width) {\n      const w = parseInt(this.element[0].style.width, 10);\n      this.container.css({ width: w });\n      this.element.css({ width: ((w - 2) - this.swatch.width()) });\n    }\n  },\n  /**\n  * Get the currently set hex value.\n  * @returns {string} A string containing the hex\n  */\n  getHexValue() {\n    return this.element.attr('value');\n  },\n\n  /**\n  * Get the currently set label value.\n  * @returns {string} A string containing the hex\n  */\n  getLabelValue() {\n    return this.settings.showLabel ? this.element.val() : this.getLabelFromHex(this.element.val());\n  },\n\n  /**\n  * Add the necessary aria for accessibility.\n  * @private\n  * @returns {void}\n  */\n  addAria() {\n    this.element.attr({\n      role: 'combobox',\n      'aria-autocomplete': 'list'\n    });\n\n    $(`label[for=\"${this.element.attr('id')}\"]`)\n      .append(`<span class=\"audible\">${Locale.translate('UseArrow')}</span>`);\n  },\n\n  /**\n  * Toggle / Open the List of Colors\n  * @returns {void}\n  */\n  toggleList() {\n    let menu = $('#colorpicker-menu');\n\n    if (this.element.is(':disabled') || (this.element.prop('readonly') && this.settings.editable)) {\n      return;\n    }\n\n    if (menu.length && this.isPickerOpen) {\n      return;\n    }\n\n    // Append Color Menu\n    menu = this.updateColorMenu();\n\n    const popupmenuOpts = {\n      ariaListbox: true,\n      menuId: 'colorpicker-menu',\n      trigger: 'immediate',\n      attachToBody: true,\n      placementOpts: {\n        containerOffsetX: 10,\n        containerOffsetY: 10,\n        parentXAlignment: (Locale.isRTL() ? 'right' : 'left'),\n        strategies: ['flip', 'nudge', 'shrink']\n      },\n      offset: {\n        x: 0,\n        y: 10\n      }\n    };\n\n    // Show Menu\n    this.element\n      .popupmenu(popupmenuOpts)\n      .on('open.colorpicker', () => {\n        this.element.parent().addClass('is-open');\n        this.isPickerOpen = true;\n      })\n      .on('close.colorpicker', () => {\n        const links = [].slice.call(this.menu[0].querySelectorAll('a'));\n        links.forEach((link) => {\n          const tooltipApi = $(link).data('tooltip');\n          if (tooltipApi) {\n            tooltipApi.hide();\n          }\n        });\n        menu.on('destroy.colorpicker', () => {\n          this.element.off('open.colorpicker selected.colorpicker close.colorpicker');\n          this.menu.off('destroy.colorpicker').remove();\n        });\n\n        this.element.parent().removeClass('is-open');\n        this.isPickerOpen = false;\n\n        this.element.trigger('listclosed', 'select');\n      })\n      .on('selected.colorpicker', (e, item) => {\n        if (!this.isEditor) {\n          this.setColor(item.data('value'), item.data('label'));\n        }\n        this.element.focus();\n        this.element.trigger('change');\n      });\n\n    // Append Buttons\n    this.menu = $('#colorpicker-menu');\n\n    setTimeout(() => {\n      this.menu.find('.is-selected').focus();\n    }, 1);\n  },\n\n  /**\n  * Set the visible color in the field\n  * @param {string} hex The hex value to use (can have the # or not).\n  * @param {string} label The text to display\n  * @returns {void}\n  */\n  setColor(hex, label) {\n    hex = hex || '';\n    const s = this.settings;\n    let colorHex = hex;\n    let colorLabel = label;\n\n    // Make sure there is always a hash\n    if (hex.substr(0, 1) !== '#' && hex !== '') {\n      colorHex = `#${colorHex}`;\n    }\n\n    const isValidHex = /(^#[0-9a-fA-F]{6}$)|(^#[0-9a-fA-F]{3}$)/i.test(colorHex);\n\n    // Simply return out if hex isn't valid\n    if (s.showLabel && label === s.clearableText) {\n      this.setValueOnField({ hex: colorHex, label: s.clearableText, isEmpty: true });\n      return;\n    } else if (!isValidHex) {\n      if (!s.showLabel) {\n        colorHex = colorHex !== '#' ? colorHex : '';\n        this.setValueOnField({ hex: colorHex, invalid: true });\n        return;\n      }\n      colorLabel = hex.replace('#', '');\n      colorHex = this.getHexFromLabel(colorLabel);\n    }\n\n    if (!colorLabel) {\n      colorLabel = this.getLabelFromHex(colorHex);\n    }\n\n    this.setValueOnField({ hex: colorHex, label: colorLabel });\n  },\n\n  /**\n   * Set the value on the field\n   * @private\n   * @param {object} [o] Options\n   * @param {string} [o.hex] The hex value to use\n   * @param {string} [o.label] The text to display\n   * @param {boolean} [o.isEmpty] if true will set empty value for all\n   * @param {boolean} [o.invalid] if true will set empty value for swatch only\n   * @returns {void}\n   */\n  setValueOnField(o) {\n    const s = this.settings;\n    const targetAttr = this.isEditor ? 'data-value' : 'value';\n    let hex = '';\n\n    if (!o.isEmpty && typeof o.hex === 'string') {\n      hex = s.uppercase ? o.hex.toUpperCase() : o.hex.toLowerCase();\n    }\n\n    if (this.swatch) {\n      if (o.isEmpty || o.invalid) {\n        this.swatch.addClass(o.isEmpty ? 'is-empty' : 'is-invalid');\n        this.swatch[0].style.backgroundColor = '';\n      } else {\n        this.swatch.removeClass('is-empty is-invalid');\n        this.swatch[0].style.backgroundColor = hex;\n      }\n    }\n\n    this.element[0].value = s.showLabel ? o.label : hex;\n    this.element[0].setAttribute(targetAttr, hex);\n    this.element[0].setAttribute('aria-describedby', o.label || '');\n  },\n\n  /**\n   * @private\n   * @param {string} colorText the original text color\n   * @returns {string} the translated text color\n   */\n  translateColorLabel(colorText) {\n    if (!colorText) {\n      return '';\n    }\n    const translatedText = Locale.translate(colorText, true);\n    return typeof translatedText === 'string' ?\n      Locale.translate(colorText, true) : colorText;\n  },\n\n  /**\n   * Refresh and Append the Color Menu\n   * @private\n   * @returns {jQuery} the menu to be appended\n   */\n  updateColorMenu() {\n    const s = this.settings;\n    const isMenu = !!($('#colorpicker-menu').length);\n    const menu = $('<ul id=\"colorpicker-menu\" class=\"popupmenu colorpicker\"></ul>');\n    const activeTheme = personalization.currentTheme;\n    const isBorderAll = (s.themes[activeTheme].border === 'all');\n    const checkThemes = s.themes[activeTheme].checkmark;\n    let checkmarkClass = '';\n\n    for (let i = 0, l = s.colors.length; i < l; i++) {\n      const li = $('<li></li>');\n      const a = $('<a href=\"#\"><span class=\"swatch\"></span></a>').appendTo(li);\n      const colorText = (this.translateColorLabel(s.colors[i].label) || s.colors[i].label) + (s.colors[i].number || '');\n      const colorNum = parseInt(s.colors[i].number, 10);\n      const regexp = new RegExp(`\\\\b${activeTheme}\\\\b`);\n      let colorValue = s.colors[i].value;\n      let isBorder = false;\n      let elemValue = this.isEditor ? this.element.attr('data-value') : this.element.val();\n\n      if (s.showLabel && !this.isEditor) {\n        elemValue = this.getHexFromLabel(elemValue);\n      }\n\n      // Set border to this swatch\n      if (isBorderAll || regexp.test(s.colors[i].border)) {\n        isBorder = true;\n      }\n\n      if (elemValue && (`${elemValue}`).toLowerCase().replace('#', '') === (`${colorValue}`).toLowerCase()) {\n        // Set checkmark color class\n        if (checkThemes) {\n          /* eslint-disable no-loop-func */\n          $.each(checkThemes, (k, v) => {\n            // checkmark: {'one': [1, 2], 'two': [3, 10]}\n            // will add class \"checkmark-one\", where current colors number is in range [1 to 3]\n            // and will add class \"checkmark-two\", where current colors number is in range [3 to 10]\n            if ((colorNum >= v[0]) && (colorNum <= v[1])) {\n              checkmarkClass = ` checkmark-${k}`;\n            }\n          });\n          /* eslint-disable no-loop-func */\n        }\n        a.addClass(`is-selected${checkmarkClass}`);\n      }\n\n      colorValue = s.uppercase ? colorValue.toUpperCase() : colorValue.toLowerCase();\n      const swatch = a.find('.swatch');\n      if (swatch[0]) {\n        swatch[0].style.backgroundColor = `#${colorValue}`;\n      }\n      swatch.addClass(isBorder ? 'is-border' : '');\n      a.data('label', colorText)\n        .data('value', colorValue)\n        .attr('title', `${colorText} #${colorValue}`)\n        .tooltip();\n\n      if (!isMenu) {\n        menu.append(li);\n      }\n    }\n\n    if (!isMenu) {\n      // Add clearable swatch to popupmenu\n      if (s.clearable) {\n        const li = $('<li></li>');\n        const a = $(`<a href=\"#\" title=\"${s.clearableText}\"><span class=\"swatch is-empty${isBorderAll ? ' is-border' : ''}\"></span></a>`).appendTo(li);\n        a.data('label', s.clearableText).data('value', '').tooltip();\n        menu.append(li);\n      }\n\n      $('body').append(menu);\n    }\n\n    return menu;\n  },\n\n  /**\n  * Change the color picker from enabled to disabled.\n  * @returns {void}\n  */\n  enable() {\n    this.element.prop('disabled', false);\n    this.element.prop('readonly', false);\n    this.element.parent().removeClass('is-disabled is-readonly');\n  },\n\n  /**\n  * Make the color picker disabled\n  * @returns {void}\n  */\n  disable() {\n    this.element.prop('disabled', true);\n    this.element.parent().addClass('is-disabled');\n  },\n\n  /**\n  * Make the color picker readonly\n  * @returns {void}\n  */\n  readonly() {\n    this.enable();\n    this.element.prop('readonly', true);\n    this.element.parent().addClass('is-readonly');\n\n    if (!this.settings.editable) {\n      this.element.parent().addClass('is-not-editable');\n    }\n  },\n\n  /**\n  * Returns true if the color picker is disabled.\n  * @returns {void}\n  */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n  * Gets the decimal as a rgb value so it can be shown in the editor\n  * @private\n  * @param {string} n Decimal value to convert to rgb.\n  * @returns {void}\n  */\n  decimal2rgb(n) {\n    if (typeof n !== 'number') {\n      return n;\n    }\n\n    /* eslint-disable no-bitwise */\n    return `rgb(${n & 0xFF}, ${(n & 0xFF00) >> 8}, ${(n & 0xFF0000) >> 16})`;\n  },\n\n  rgb2hex(rgb) {\n    if (!rgb || rgb.search('rgb') === -1) {\n      return rgb;\n    } else if (rgb === 'rgba(0, 0, 0, 0)') {\n      return 'transparent';\n    }\n\n    const hex = function (x) {\n      return (`0${parseInt(x, 10).toString(16)}`).slice(-2);\n    };\n\n    const newRgb = rgb.match(/^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+))?\\)$/);\n    return `#${hex(newRgb[1])}${hex(newRgb[2])}${hex(newRgb[3])}`;\n  },\n\n  /**\n  * Update the component and optionally apply new settings.\n  *\n  * @param  {object} settings the settings to update to.\n  * @returns {object} The plugin api for chaining.\n  */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.teardown();\n    return this.init();\n  },\n\n  teardown() {\n    this.element.off([\n      `keypress.${COMPONENT_NAME}`,\n      `keyup.${COMPONENT_NAME}`,\n      `blur.${COMPONENT_NAME}`,\n      `openlist.${COMPONENT_NAME}`,\n      `change.${COMPONENT_NAME}`,\n      `paste.${COMPONENT_NAME}`\n    ].join(' '));\n\n    if (this.swatch && this.swatch.length) {\n      this.swatch.off(`click.${COMPONENT_NAME}`);\n      this.swatch.remove();\n      delete this.swatch;\n    }\n\n    const maskAPI = this.element.data('mask');\n    if (maskAPI) {\n      maskAPI.destroy();\n    }\n\n    if (this.icon && this.icon.length) {\n      const trigger = this.icon.parent('.trigger');\n      this.icon.off().remove();\n      trigger.off().remove();\n      delete this.icon;\n    }\n\n    if (this.container && this.container.length) {\n      this.container.find('.trigger').remove();\n      this.element.unwrap();\n      delete this.container;\n    }\n  },\n\n  /**\n  * Detach events and restore DOM to default.\n  * @returns {object} The plugin api (this).\n  */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n    return this;\n  },\n\n  /**\n  * Detach events and restore DOM to default.\n  * @private\n  * @returns {void}\n  */\n  handleEvents() {\n    const elem = this.element;\n    const elemParent = elem.parent();\n    let originalVal;\n\n    this.icon.parent().on('click.colorpicker', () => {\n      this.toggleList();\n    });\n\n    elem\n      .on('focus.colorpicker', () => {\n        originalVal = elem.val();\n        elemParent.addClass('is-focused');\n      })\n      .on('blur.colorpicker', () => {\n        elemParent.removeClass('is-focused');\n\n        // Fix: Force to change event\n        // IE-Edge not firing `change event` after updated input-s values\n        if (this.isIeEdge && !elem.is('.is-open') && originalVal !== elem.val()) {\n          elem.triggerHandler('change');\n        }\n      })\n      .on('openlist.colorpicker', () => {\n        this.toggleList();\n      });\n\n    let eventStr = 'blur.colorpicker paste.colorpicker change.colorpicker';\n    eventStr += this.isIe11 ? 'keypress.colorpicker' : 'keyup.colorpicker';\n    elem.on(eventStr, () => {\n      const val = this.isEditor ? elem.attr('data-value') : elem.val();\n      if (this.settings.showLabel) {\n        this.setColor(elem.attr('value'), val);\n        return;\n      }\n      this.setColor(val);\n    });\n\n    // Handle Key Down to open\n    elem.on('keydown.colorpicker', (e) => {\n      if (e.keyCode === 38 || e.keyCode === 40) {\n        this.toggleList();\n      }\n      if (e.keyCode === 13) {\n        this.setColor(elem.val());\n      }\n    });\n  }\n\n};\n\nexport { ColorPicker, COMPONENT_NAME };\n","import { ColorPicker, COMPONENT_NAME } from './colorpicker';\n\n/**\n * jQuery Component Wrapper for Colorpicker\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.colorpicker = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ColorPicker(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Jquery Imports\nimport '../../utils/animations';\n\nconst COMPONENT_NAME = 'expandablearea';\n\n/**\n* An expandable pane / area.\n* @class ExpandableArea\n* @param {string} element The component element.\n* @param {string} [settings] The component settings.\n* @param {string} [settings.trigger = null]  Id of some other button to use as a trigger\n* @param {string} [settings.bottomBorder = false]  Change the border to bottom vs top (for some cases)\n*/\nconst EXPANDABLEAREA_DEFAULTS = {\n  trigger: null,\n  bottomBorder: false\n};\n\nfunction ExpandableArea(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, EXPANDABLEAREA_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Expandable Area API\nExpandableArea.prototype = {\n\n  /**\n  * Initialize the Expandable area\n  * @private\n  */\n  init() {\n    this\n      .setup()\n      .build()\n      .handleEvents();\n  },\n\n  /**\n  * Setup internal variables.\n  * @private\n  * @returns {object} The Api for chaining.\n  */\n  setup() {\n    this.id = this.element.attr('id');\n    if (!this.id || this.id === undefined) {\n      this.id = `expandable-area-${$('body').find('.expandable-area').index(this.element)}`;\n    }\n\n    if (this.element.prev('.expandable-area-trigger').length > 0) {\n      this.expander = this.element.prev('.expandable-area-trigger');\n      this.settings.trigger = this.expander.attr('id') || `expandable-area-trigger-${$('body').find('.expandable-area').index(this.element)}`;\n    }\n\n    this.header = this.settings.trigger ? this.element : this.element.children('.expandable-header');\n    this.footer = this.element.children('.expandable-footer');\n    this.content = this.element.children('.expandable-pane');\n\n    this.isCard = this.element.is('.card, .widget');\n    return this;\n  },\n\n  /**\n  * Add markup to build up the component.\n  * @private\n  * @returns {object} The Api for chaining.\n  */\n  build() {\n    const expanded = this.element.hasClass('is-expanded');\n\n    this.header.attr({\n      'aria-expanded': `${expanded}`,\n      'aria-controls': `${this.id}-content`,\n      id: `${this.id}-header`\n    });\n    this.content.attr({\n      id: `${this.id}-content`\n    });\n\n    // Add the link and footer if not there already.\n    // If we're using an expandable card,\n    if (!this.isCard && !this.footer.length && !this.settings.trigger) {\n      this.footer = $('<div class=\"expandable-footer\"></div>').appendTo(this.element);\n    }\n\n    function getExpander(instance, useHeaderExpander) {\n      let expander;\n\n      if (useHeaderExpander === true) {\n        // Use icon-based expander in the header\n        expander = instance.header.find('expandable-expander');\n        if (!expander.length) {\n          expander = $(`${'<a href=\"#\" target=\"_self\" class=\"btn-expander\">' +\n            '<svg class=\"chevron icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presenation\">' +\n              '<use xlink:href=\"#icon-caret-down\"></use>' +\n            '</svg>' +\n            '<span class=\"audible\">'}${Locale.translate('ShowMore')}</span>` +\n          '</a>').appendTo(instance.header);\n        }\n\n        return expander;\n      }\n\n      // Use the text-based expander button in the footer\n      expander = instance.footer.find('.expandable-expander');\n      if (!expander.length) {\n        expander = $(`${'<a href=\"#\" target=\"_self\" class=\"expandable-expander hyperlink\">' +\n          '<span data-translated=\"true\">'}${Locale.translate('ShowMore')}</span>` +\n        '</a>').prependTo(instance.footer);\n      }\n      return expander;\n    }\n\n    this.expander = getExpander(this, this.isCard);\n    this.expander.attr('href', '#').hideFocus();\n\n    if (this.expander.length === 0) {\n      this.expander = $(`#${this.settings.trigger}`);\n    }\n\n    // Change the borer to the bottom vs top\n    if (this.settings.bottomBorder) {\n      this.element.addClass('has-bottom-border');\n    }\n\n    // Initialized in expanded mode.\n    if (expanded) {\n      this.content.addClass('no-transition');\n      this.element.one('afterexpand.expandable-area', () => {\n        this.content.removeClass('no-transition');\n      });\n      this.open();\n    }\n\n    if (!expanded) {\n      this.content.addClass('no-transition');\n      this.element.one('aftercollapse.expandable-area', () => {\n        this.content.removeClass('no-transition');\n      });\n      this.close();\n    }\n\n    this.resize();\n\n    return this;\n  },\n\n  /**\n  * Return if the expandable area is current disable or not.\n  * @returns {boolean} True or False depending on the disabled status.\n  */\n  isDisabled() {\n    return this.element.hasClass('is-disabled');\n  },\n\n  /**\n  * Add Keyboard Support.\n  * @private\n  * @param  {object} e The event we are handling.\n  * @returns {void}\n  */\n  handleKeys(e) {\n    if (this.isDisabled()) {\n      return null;\n    }\n\n    const key = e.which;\n\n    if (key === 13 || key === 32) { // Enter/Spacebar\n      e.preventDefault();\n      this.toggleExpanded();\n      return false;\n    }\n\n    return null;\n  },\n\n  /**\n  * Toggle focus classes on focus.\n  * @private\n  * @returns {void}\n  */\n  handleFocus() {\n    if (this.isDisabled()) {\n      return;\n    }\n\n    this.header.addClass('is-focused');\n  },\n\n  /**\n  * Toggle blur classes on blur.\n  * @private\n  * @returns {void}\n  */\n  handleBlur() {\n    if (this.isDisabled()) {\n      return;\n    }\n\n    this.header.removeClass('is-focused');\n  },\n\n  /**\n  * Returns expanded status about the current expandable area\n  * @returns {boolean} True of alse depending on current expanded status.\n  */\n  isExpanded() {\n    return this.element.is('.is-expanded');\n  },\n\n  /**\n  * Toggle current expansion state.\n  */\n  toggleExpanded() {\n    // if (this.header.attr('aria-expanded') === 'true') {\n    if (this.isExpanded()) {\n      this.close();\n    } else {\n      this.open();\n    }\n  },\n\n  /**\n  * Open the pane if closed.\n  */\n  open() {\n    /**\n     * Fires after a row is added via the api.\n    * @event beforeexpand\n    * @memberof ExpandableArea\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} args.row The Html Element.\n    */\n    const canExpand = this.element.triggerHandler('beforeexpand', [this.element]);\n\n    if (canExpand === false) {\n      return;\n    }\n\n    this.element.addClass('is-expanded');\n    this.header.attr('aria-expanded', 'true');\n    this.expander.addClass('active');\n\n    /**\n     * Fires after a row is added via the api.\n    * @event expand\n    * @memberof ExpandableArea\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} args.row The Html Element.\n    */\n    this.element.triggerHandler('expand', [this.element]);\n\n    this.expander.find('span[data-translated=\"true\"]').text(Locale.translate('ShowLess') ? Locale.translate('ShowLess') : 'Show Less');\n\n    if (this.isCard) {\n      this.expander.find('.icon').addClass('active');\n    }\n\n    if (this.content[0]) {\n      this.content[0].style.display = 'block';\n    }\n\n    /**\n     * Fires after a row is added via the api.\n    * @event afterexpand\n    * @memberof ExpandableArea\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} args.row The Html Element.\n    */\n    this.content.one('animateopencomplete', () => {\n      this.element.triggerHandler('afterexpand', [this.element]);\n    }).animateOpen();\n\n    this.applyIE11Fix();\n  },\n\n  /**\n  * Close the pane if open.\n  */\n  close() {\n    /**\n    * Fires after a row is added via the api.\n    * @event beforecollapse\n    * @memberof ExpandableArea\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} args.row The Html Element.\n    */\n    const canCollapse = this.element.triggerHandler('beforecollapse', [this.element]);\n\n    if (canCollapse === false) {\n      return;\n    }\n\n    this.expander.removeClass('active');\n    /**\n    * Fires after a row is added via the api.\n    * @event collapse\n    * @memberof ExpandableArea\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} args.row The Html Element.\n    */\n    this.element.triggerHandler('collapse', [this.element]);\n    this.expander.find('span[data-translated=\"true\"]').text(Locale.translate('ShowMore') ? Locale.translate('ShowMore') : 'Show More');\n\n    if (this.isCard) {\n      this.expander.find('.icon').removeClass('active');\n    }\n\n    /**\n    * Fires after a row is added via the api.\n    * @event aftercollapse\n    * @memberof ExpandableArea\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} args.row The Html Element.\n    */\n    this.content.one('animateclosedcomplete', () => {\n      this.element.removeClass('is-expanded');\n      this.header.attr('aria-expanded', 'false');\n      this.element.triggerHandler('aftercollapse', [this.element]);\n      this.content[0].style.display = 'none';\n    }).animateClosed();\n\n    this.applyIE11Fix();\n  },\n\n  /**\n  * Determines if the browser is IE11 and applies a min-height fix for the overflow.\n  * @private\n  * @returns {void}\n  */\n  applyIE11Fix() {\n    const self = this;\n    const isIE11 = $('html').hasClass('ie11');\n    setTimeout(() => {\n      if (isIE11 && self.element.hasClass('is-expanded')) {\n        self.element.css('min-height', self.element.children('.expandable-pane').outerHeight(true) + self.element.children('.expandable-footer').outerHeight(true));\n      } else if (isIE11 && !self.element.hasClass('is-expanded')) {\n        self.element.css('min-height', 'auto');\n      }\n    }, 300); // equal to transition time\n  },\n\n  /**\n  * Determines if the the body has resized and fires the applyIE11Fix.\n  * @private\n  * @returns {void}\n  */\n  resize() {\n    const self = this;\n    $('body').on('resize.expandablearea', () => {\n      self.applyIE11Fix();\n    });\n  },\n\n  /**\n  * Disable the expandable area from being closable.\n  * @returns {void}\n  */\n  disable() {\n    this.element.addClass('is-disabled');\n  },\n\n  /**\n  * Enable the expandable area to allow close.\n  * @returns {void}\n  */\n  enable() {\n    this.element.removeClass('is-disabled');\n  },\n\n  /**\n  * Destroy by removing markup and canceling events.\n  * @returns {void}\n  */\n  destroy() {\n    this.header.children('a').off();\n    this.header.off();\n    this.header\n      .removeAttr('aria-controls')\n      .removeAttr('aria-expanded')\n      .removeAttr('id');\n    this.content.removeAttr('id').removeClass('no-transition');\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Update the component and optionally apply new settings.\n   * @param  {object} settings the settings to update to.\n   * @returns {object} The plugin api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    return this;\n  },\n\n  /**\n  * Attach event handlers.\n  * @private\n  * @returns {object} The Api for chaining.\n  */\n  handleEvents() {\n    const self = this;\n    this.expander.on('click.expandablearea', (e) => {\n      if (!self.isDisabled()) {\n        e.preventDefault();\n        self.toggleExpanded();\n      }\n    });\n\n    this.header.on('keydown.expandablearea', (e) => {\n      self.handleKeys(e);\n    }).on('focus.expandablearea', (e) => {\n      self.handleFocus(e);\n    }).on('blur.expandablearea', (e) => {\n      self.handleBlur(e);\n    });\n\n    return this;\n  }\n\n};\n\nexport { ExpandableArea, COMPONENT_NAME };\n","import { ExpandableArea, COMPONENT_NAME } from './expandablearea';\n\n$.fn.expandablearea = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ExpandableArea(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { breakpoints } from '../../utils/breakpoints';\n\n// jQuery Components\nimport '../expandablearea/expandablearea.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'compositeform';\n\n/**\n* CompositeForm is a specialized responsive form component.\n* @class CompositeForm\n* @constructor\n* @param {jQuery[]|HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n* @param {string} [settings.breakpoint = 'phone-to-tablet'] Defines the breakpoint at which the composite form will change into its responsive mode\n* @param {string} [settings.trigger = null] Expandable area trigger selector. Passed to expandable area.\n* @param {string} [settings.expandedText = Locale.translate('ShowLess')] Text to use for the expand button (Default localized)\n* @param {string} [settings.collapsedText = Locale.translate('ShowMore')] Text to use for the collapse button (Default localized)\n*/\nconst COMPOSITEFORM_DEFAULTS = {\n  breakpoint: 'phone-to-tablet',\n  trigger: null,\n  expandedText: Locale.translate('ShowLess'),\n  collapsedText: Locale.translate('ShowMore'),\n};\n\nfunction CompositeForm(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, COMPOSITEFORM_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Component API\nCompositeForm.prototype = {\n\n  /**\n  * Initialize the component\n  * @private\n  * @returns {object} The component api for chaining.\n  */\n  init() {\n    return this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n  * Adds markup to the control and stores references to some sub-elements\n  * @private\n  * @returns {object} The component api for chaining.\n  */\n  build() {\n    const componentClassList = this.element[0].classList;\n    if (!componentClassList.contains('composite-form')) {\n      componentClassList.add('composite-form');\n    }\n\n    // Get expandable area reference, if applicable\n    const expandableArea = this.element.find('.expandable-area');\n    if (expandableArea.length) {\n      this.hasSummary = true;\n      this.expandableArea = expandableArea;\n      this.expandableAreaAPI = this.expandableArea.data('expandablearea');\n      if (!this.expandableAreaAPI) {\n        this.expandableArea.expandablearea({ trigger: this.settings.trigger });\n        this.expandableAreaAPI = this.expandableArea.data('expandablearea');\n      }\n\n      // Get expandable trigger\n      this.expander = this.expandableAreaAPI.expander;\n      this.setExpanderText(this.settings.expandedText);\n    } else {\n      this.hasSummary = false;\n    }\n\n    // Check size and append class, if necessary\n    this.checkResponsive();\n\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this control and its sub-elements\n   * @param {string} expanderText - the text content\n   * @returns {undefined}\n   */\n  handleEvents() {\n    const self = this;\n\n    $('body').off(`resize.${COMPONENT_NAME}`).on(`resize.${COMPONENT_NAME}`, (e) => {\n      self.checkResponsive(e);\n    });\n\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      self.updated();\n    });\n\n    function changeExpanderText() {\n      const isExpanded = self.expandableAreaAPI.isExpanded();\n      self.setExpanderText(self.settings[isExpanded ? 'expandedText' : 'collapsedText']);\n    }\n\n    if (this.hasSummary) {\n      this.expandableArea\n        .on(`expand.${COMPONENT_NAME}`, changeExpanderText)\n        .on(`collapse.${COMPONENT_NAME}`, changeExpanderText);\n    }\n\n    return this;\n  },\n\n  /**\n   * Checks if we've passed the breakpoint for switching into Responsive mode.\n   * @returns {undefined}\n   */\n  checkResponsive() {\n    const cl = this.element[0].classList;\n\n    if (breakpoints.isBelow(this.settings.breakpoint)) {\n      cl.add('is-in-responsive-mode');\n    } else {\n      cl.remove('is-in-responsive-mode');\n      if (this.isSideOriented() && !this.expandableAreaAPI.isExpanded()) {\n        this.expandableAreaAPI.open();\n      }\n    }\n  },\n\n  /**\n   * Sets the text content of the Composite Form's Expandable Area Expander.\n   * @param {string} expanderText - the text content\n   * @returns {undefined}\n   */\n  setExpanderText(expanderText) {\n    if (!this.hasSummary) {\n      return;\n    }\n\n    if (!(expanderText instanceof String) || !expanderText.length) {\n      return;\n    }\n\n    let textSpan = this.expander.find('span');\n    if (!textSpan) {\n      textSpan = this.expander;\n    }\n    textSpan.text(expanderText);\n  },\n\n  /**\n   * Determines if this component is configured for \"on-side\" orientation of the Summary area.\n   * @returns {boolean} If the component is currently side oriented.\n   */\n  isSideOriented() {\n    return this.element[0].classList.contains('on-side');\n  },\n\n  /**\n   * Re-invokes the Composite Form\n   * @returns {object} The component API for chaining.\n   */\n  updated() {\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @private\n   * @returns {object} The component API for chaining.\n   */\n  teardown() {\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    this.element.off(`updated.${COMPONENT_NAME}`);\n\n    if (this.hasSummary) {\n      this.expandableArea.off(`expand.${COMPONENT_NAME} collapse.${COMPONENT_NAME}`);\n    }\n\n    return this;\n  },\n\n  /**\n   * Destroys the component instance by removing it from its associated element.\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { CompositeForm, COMPONENT_NAME };\n","import { CompositeForm, COMPONENT_NAME } from './compositeform';\n\n/**\n * jQuery Component Wrapper for Composite Form\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.compositeform = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new CompositeForm(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\n\nconst COMPONENT_NAME = 'contextualactionpanel';\n\n/**\n* A more complex modal for complex in page interactions.\n* @class ContextualActionPanel\n* @param {string} element The component element.\n* @param {string} settings The component settings.\n* @param {string} [settings.id = `contextual-action-modal-cnt`]\n* The id to use for the CAP, or defaults to generated.\n* @param {array} [settings.buttons = null] A list of buttons that will sit in the toolbar's Buttonset area.\n* @param {string} [settings.title = 'Contextual Action Panel'] String that sits in the toolbar's title field.\n* @param {content} [settings.content = null] Pass content through to CAP.\n* @param {boolean} [settings.initializeContent = true] Initialize content before opening with defaults.\n* @param {string} [settings.trigger = 'click'] Can be 'click' or 'immediate'.\n* @param {boolean} [settings.centerTitle = false] If true the title will be centered.\n* @param {boolean} [settings.useFlexToolbar] If true the new flex toolbar will be used (For CAP)\n*/\nconst CONTEXTUALACTIONPANEL_DEFAULTS = {\n  id: `contextual-action-modal-${parseInt($('.modal').length, 10) + 1}`,\n  buttons: null,\n  title: 'Contextual Action Panel', //\n  content: null, //\n  initializeContent: true, // initialize content before opening\n  trigger: 'click',\n  showCloseButton: false,\n  centerTitle: false\n};\n\nfunction ContextualActionPanel(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, CONTEXTUALACTIONPANEL_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nContextualActionPanel.prototype = {\n\n  /**\n   * @returns {Modal|undefined} instance of an IDS modal, or undefined if one doesn't exist\n   */\n  get modalAPI() {\n    let api;\n    if (this.panel && this.panel.length) {\n      api = this.panel.data('modal');\n    }\n    return api;\n  },\n\n  /**\n  * Initialize the CAP.\n  * @private\n  */\n  init() {\n    this\n      .setup()\n      .build()\n      .handleEvents();\n  },\n\n  /**\n  * Setup internal variables.\n  * NOTE: Does not do any building.\n  * @private\n  * @returns {object} The Api for chaining.\n  */\n  setup() {\n    this.panel = this.element.next('.contextual-action-panel');\n\n    const dataModal = this.element.data('modal');\n    const setPanel = (id) => {\n      const panelFromID = $(`#${id}`);\n      if (panelFromID.length) {\n        this.panel = panelFromID;\n      }\n    };\n    if (typeof dataModal === 'string') {\n      setPanel(dataModal);\n    } else if (typeof dataModal === 'object') {\n      setPanel(this.element.attr('data-modal'));\n    }\n\n    // Handle case with popup triggered from a menu\n    if (this.element.closest('.popupmenu').length === 1) {\n      this.panel = this.element.closest('.popupmenu').next('.contextual-action-panel');\n    }\n\n    if (this.panel[0]) {\n      this.panel[0].style.display = 'none';\n    }\n    this.panel.addClass('is-animating');\n\n    return this;\n  },\n\n  /**\n  * Add markup to build up the component.\n  * @private\n  * @returns {object} The Api for chaining.\n  */\n  build() {\n    const self = this;\n\n    // Build the Content if it's not present\n    if (this.panel.length === 0) {\n      if (this.settings.content instanceof jQuery) {\n        if (this.settings.content.is('.contextual-action-panel')) {\n          this.panel = this.settings.content;\n        } else {\n          this.settings.content.wrap('<div class=\"contextual-action-panel\"></div>');\n          this.panel = this.settings.content.parent();\n        }\n\n        this.panel.addClass('modal').appendTo('body');\n\n        if (this.settings.content.is('iframe')) {\n          this.settings.content.ready(() => {\n            self.completeBuild();\n            self.settings.content.show();\n          });\n          return self;\n        }\n        this.settings.content.show();\n      } else {\n        this.panel = $(`<div class=\"contextual-action-panel\">${this.settings.content}</div>`).appendTo('body');\n        this.panel.addClass('modal').attr('id', this.settings.id);\n      }\n    }\n\n    this.completeBuild();\n    return this;\n  },\n\n  /**\n  * Finalize build up/\n  * @private\n  * @returns {object} The Api for chaining.\n  */\n  completeBuild() {\n    let children;\n    let isIframe = false;\n    let contents;\n    let hasSearchfield = false;\n    let predefined = true;\n\n    // Invoke Icons\n    this.panel.find('svg').icon();\n\n    // Get a reference to `.modal-content`\n    const modalContent = this.panel.find('.modal-content');\n    if (modalContent.length === 0) {\n      children = this.panel.children();\n      if (children.is('iframe')) {\n        contents = children.contents();\n        this.toolbar = contents.find('.toolbar, .flex-toolbar');\n        isIframe = true;\n      }\n\n      if (!isIframe) {\n        children.wrapAll('<div class=\"modal-content\"></div>').wrapAll('<div class=\"modal-body\"></div>');\n        this.panel.addClass('modal');\n      }\n    }\n\n    // Build/reference the header\n    let modalHeader = this.panel.find('.modal-header');\n    if (modalHeader.length === 0) {\n      modalHeader = $('<div class=\"modal-header\"></div>');\n      modalHeader.insertBefore(this.panel.find('.modal-body'));\n    }\n    this.header = modalHeader;\n\n    // Detect existence of buttonset for later\n    let buttonset = this.panel.find('.toolbar .buttonset, .flex-toolbar .buttonset');\n\n    // Build/reference the CAP header toolbar\n    if (!this.toolbar) {\n      this.toolbar = this.panel.find('.toolbar, .flex-toolbar');\n    }\n    if (!this.toolbar.length) {\n      predefined = false;\n      if (this.settings.buttons) {\n        this.settings.buttons.forEach((button) => {\n          if (button.type === 'input') {\n            hasSearchfield = true;\n          }\n        });\n      }\n\n      if (this.settings.title && this.settings.centerTitle) {\n        const toolbarSearchfieldSection = hasSearchfield ? '<div class=\"toolbar-section search\"></div>' : '';\n        const toolbarHTML = `<div class=\"flex-toolbar\">\n          <div class=\"toolbar-section static\"></div>\n          <div class=\"toolbar-section title center-text\">\n            <h2>${this.settings.title}</h2>\n          </div>\n          ${toolbarSearchfieldSection}\n          <div class=\"toolbar-section buttonset static\"></div>\n        </div>`;\n\n        this.toolbar = $(toolbarHTML);\n      } else if (!buttonset.length) {\n        const toolbarCSSClass = this.settings.useFlexToolbar ? 'flex-toolbar' : 'toolbar';\n        const toolbarTitleSection = this.settings.useFlexToolbar ? `<div class=\"toolbar-section title\"><h2>${this.settings.title}</h2></div>` : '';\n        const toolbarButtonsetCSSClass = this.settings.useFlexToolbar ? 'toolbar-section buttonset' : 'buttonset';\n        const toolbarButtonsetSection = `<div class=\"${toolbarButtonsetCSSClass}\"></div>`;\n        const toolbarSearchfieldSection = this.settings.useFlexToolbar && hasSearchfield ? '<div class=\"toolbar-section search\"></div>' : '';\n        const toolbarHTML = `<div class=\"${toolbarCSSClass}\">\n          ${toolbarTitleSection}\n          ${toolbarSearchfieldSection}\n          ${toolbarButtonsetSection}\n        </div>`;\n\n        const toolbar = $(toolbarHTML);\n        toolbar.appendTo(this.panel.find('.modal-header'));\n        this.toolbar = toolbar;\n        buttonset = toolbar.children('.buttonset');\n      }\n    }\n    this.toolbar.appendTo(this.header);\n\n    // Only add certain elements if a Toolbar was generated with JS-options\n    // and not by HTML markup.\n    if (!predefined) {\n      if (!buttonset || !buttonset.length && !this.settings.centerTitle) {\n        buttonset = $('<div class=\"toolbar-section buttonset\"></div>');\n        buttonset.appendTo(this.toolbar);\n      }\n\n      let toolbarTitle = this.toolbar.find('.title');\n      if (!toolbarTitle.length) {\n        const centerTextCSS = this.settings.centerTitle ? ' center-text' : '';\n        toolbarTitle = $(`\n          <div class=\"toolbar-section title${centerTextCSS}\">\n            <h2>${this.settings.title}</h2>\n          </div>\n        `);\n\n        if (buttonset) {\n          toolbarTitle.insertBefore(buttonset);\n        } else {\n          this.toolbar.prepend(toolbarTitle);\n        }\n      }\n\n      if (!toolbarTitle.length) {\n        toolbarTitle = $(`\n          <div class=\"title\">\n            ${this.settings.title}\n          </div>\n        `);\n        this.toolbar.prepend(toolbarTitle);\n      }\n    }\n\n    // Move to the body element to break stacking context issues.\n    if (!isIframe) {\n      this.panel.detach().appendTo('body');\n    }\n\n    this.element.attr('data-modal', this.settings.id);\n    if (!this.panel.attr('id')) {\n      this.panel.attr('id', this.settings.id);\n    }\n\n    this.panel.modal({\n      buttons: this.settings.buttons,\n      centerTitle: this.settings.centerTitle,\n      useFlexToolbar: this.settings.useFlexToolbar,\n      trigger: (this.settings.trigger ? this.settings.trigger : 'click')\n    });\n\n    this.buttons = this.panel.find('.buttonset').children('button');\n\n    this.closeButton = this.panel.find('.modal-header').find('.btn-close, [name=\"close\"], button.close-button');\n    if (!predefined && this.settings.showCloseButton && !this.closeButton.length) {\n      this.closeButton = $(`\n        <button class=\"btn-close\" type=\"button\">\n          <svg class=\"icon icon-close\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n            <use xlink:href=\"#icon-close\"></use>\n          </svg>\n          <span>Close</span>\n        </button>\n      `);\n\n      if (!this.settings.useFlexToolbar) {\n        const CAPToolbarButton = $('<div class=\"close-button\"></div>').append(this.closeButton);\n        this.header.append(CAPToolbarButton);\n      } else {\n        const standaloneSection = $('<div class=\"toolbar-section static\"></div>').append(this.closeButton);\n        const more = this.toolbar.find('.toolbar-section.more');\n        standaloneSection.after(more.length ? more : buttonset);\n      }\n    }\n\n    if (this.closeButton.length) {\n      this.toolbar.addClass('has-close-button');\n    }\n\n    if (this.toolbar.is('.toolbar')) {\n      this.toolbar.toolbar();\n    }\n    if (this.toolbar.is('.flex-toolbar')) {\n      this.toolbar.toolbarflex();\n    }\n\n    utils.fixSVGIcons(this.element);\n    return this;\n  },\n\n  /**\n  * Attach event handlers.\n  * @private\n  * @returns {object} The Api for chaining.\n  */\n  handleEvents() {\n    const self = this;\n\n    // Convenience method that takes an event from the Modal control's panel element,\n    // and triggers any listeners that may be looking at the Contextual Action Panel's\n    // trigger instead.\n    function passEvent(e) {\n      self.element.triggerHandler(e.type);\n    }\n\n    this.panel.addClass('is-animating')\n      .off('open.contextualactionpanel')\n      .on('open.contextualactionpanel', (e) => {\n        passEvent(e);\n        self.panel.removeClass('is-animating');\n      })\n      .off('beforeclose.contextualactionpanel')\n      .on('beforeclose.contextualactionpanel', () => {\n        self.panel.addClass('is-animating');\n      })\n      .off('close.contextualactionpanel')\n      .on('close.contextualactionpanel', (e) => {\n        passEvent(e);\n      })\n      .off('beforeopen.contextualactionpanel')\n      .on('beforeopen.contextualactionpanel', function (e) {\n        if (self.settings.initializeContent) {\n          $(this).initialize();\n        }\n        passEvent(e);\n      })\n      .off('afteropen.contextualactionpanel')\n      .on('afteropen.contextualactionpanel', () => {\n        if (self.toolbar) {\n          self.toolbar.trigger('recalculate-buttons');\n        }\n\n        // Select the proper element on the toolbar\n        if (self.toolbar.length) {\n          let selected = self.toolbar.find('.buttonset > .is-selected');\n          if (!selected.length) {\n            selected = self.toolbar.find('.buttonset > *:first-child');\n            if (selected.is('.searchfield-wrapper')) {\n              selected = selected.children('.searchfield');\n            }\n          }\n          if (!selected.length && self.toolbar.is('.flex-toolbar')) {\n            selected = self.toolbar.find('button').first();\n            selected.focus();\n            return;\n          }\n          const toolbarData = self.toolbar.data('toolbar');\n          if (toolbarData) {\n            toolbarData.setActiveButton(selected, true);\n          }\n        }\n\n        // Focus the first focusable element inside the Contextual Panel's Body\n        self.panel.find('.modal-body-wrapper').find(':focusable').first().focus();\n        utils.fixSVGIcons(self.panel);\n      });\n\n    if (self.closeButton && self.closeButton.length) {\n      self.closeButton.on('click.contextualactionpanel', () => {\n        self.handleToolbarSelected();\n      });\n    }\n\n    return this;\n  },\n\n  /**\n  * Toolbar select event handler.\n  * @private\n  * @returns {void}\n  */\n  handleToolbarSelected() {\n    this.close();\n  },\n\n  /**\n  * Detach events and restore markup.\n  * @private\n  * @returns {void}\n  */\n  teardown() {\n    const self = this;\n    const buttonset = self.toolbar.children('.buttonset');\n\n    this.panel.off('open.contextualactionpanel close.contextualactionpanel ' +\n      'beforeopen.contextualactionpanel afterclose.contextualactionpanel');\n\n    buttonset.children('*:not(.searchfield)')\n      .off('click.contextualactionpanel');\n\n    const menuButtons = buttonset.children('.btn-menu');\n    menuButtons.each(function () {\n      const popup = $(this).data('popupmenu');\n      if (popup) {\n        popup.destroy();\n      }\n    });\n\n    if (self.header) {\n      self.header.remove();\n    }\n\n    const children = self.panel.find('.modal-body').children();\n    children.first().unwrap().unwrap();\n\n    self.element.removeAttr('data-modal');\n\n    if (self.closeButton && self.closeButton.length) {\n      self.closeButton.off('click.contextualactionpanel');\n      delete self.closeButton;\n    }\n\n    // Trigger an afterclose event on the Contextual Action Panel's trigger element\n    // (different from the panel, which is already removed).\n    self.element.trigger('afterteardown');\n  },\n\n  /**\n  * Close the Contextual Action Panel if open and call destroy.\n  * @returns {void}\n  */\n  close() {\n    let destroy;\n    if (this.settings.trigger === 'immediate') {\n      destroy = true;\n    }\n\n    if (this.modalAPI) {\n      this.modalAPI.close(destroy);\n    }\n  },\n\n  /**\n  * Add a disabled attribute to the main component element.\n  * @returns {void}\n  */\n  disable() {\n    this.element.prop('disabled', true);\n    if (this.panel.hasClass('is-visible')) {\n      this.close();\n    }\n  },\n\n  /**\n  * Remove disabled attribute from the main component element.\n  * @returns {void}\n  */\n  enable() {\n    this.element.prop('disabled', false);\n  },\n\n  /**\n   * Update the component and optionally apply new settings.\n   *\n   * @param  {object} settings the settings to update to.\n   * @returns {object} The plugin api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    this.setup();\n\n    if (this.modalAPI) {\n      this.modalAPI.updated(settings);\n    }\n    return this;\n  },\n\n  /**\n  * Destroy and remove added markup and events\n  * @returns {void}\n  */\n  destroy() {\n    // ModalAPI calls `capAPI.teardown()` at the correct timing\n    if (this.modalAPI && this.modalAPI.isOpen) {\n      this.modalAPI.close(true);\n    }\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { ContextualActionPanel, COMPONENT_NAME };\n","import { ContextualActionPanel, COMPONENT_NAME } from './contextualactionpanel';\n\n/**\n * jQuery Component Wrapper for Contextual Action Panel\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.contextualactionpanel = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ContextualActionPanel(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { Environment as env } from '../../utils/environment';\nimport { Locale } from '../locale/locale';\nimport { xssUtils } from '../../utils/xss';\n\n// jQuery components\nimport '../place/place.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'tooltip';\n\n/**\n * Tooltip and Popover Control\n * @class Tooltip\n * @constructor\n *\n * @param {htmlelement|jquery[]} element The component element.\n * @param {object} [settings] The component settings.\n * @param {string|function} [settings.content] Takes title attribute or feed content. Can be a string or jQuery markup.\n * @param {object} [settings.offset={top: 10, left: 10}] How much room to leave.\n * @param {string} [settings.placement='top'] Supports 'top'|'bottom'|'right'|'offset'.\n * @param {string} [settings.trigger='hover'] Supports click and immediate and hover (and maybe in future focus).\n * @param {string} [settings.title] Title for Infor Tips.\n * @param {string} [settings.beforeShow] Call back for ajax tooltip.\n * @param {string} [settings.popover] force it to be a popover (no content).\n * @param {string} [settings.closebutton] Show X close button next to title in popover.\n * @param {boolean} [settings.isError=false] Add error classes.\n * @param {boolean} [settings.isErrorColor=false] Add error color only not description.\n * @param {string} [settings.tooltipElement] ID selector for an alternate element to use to contain the tooltip classes.\n * @param {object} [settings.parentElement] jQuery-wrapped element that gets.\n  passed to the 'place' behavior as the element to place the tooltip against.\n * @param {boolean} [settings.keepOpen=false] Forces the tooltip to stay open in situations where it would normally close.\n * @param {string} [settings.extraClass] Extra css class.\n * @param {object} [settings.placementOpt] Placement options.\n * @param {string} [settings.maxWidth] Toolip max width.\n * @param {boolean} [settings.initializeContent] Init the content in the tooltip.\n * @param {string} [settings.headerClass] If set this color will be used on the header (if a popover).\n */\n\nconst TOOLTIP_DEFAULTS = {\n  content: null,\n  offset: { top: 10, left: 10 },\n  placement: 'top',\n  trigger: 'hover',\n  title: null,\n  beforeShow: null,\n  popover: null,\n  closebutton: null,\n  isError: false,\n  isErrorColor: false,\n  tooltipElement: null,\n  parentElement: null,\n  keepOpen: false,\n  extraClass: null,\n  placementOpts: {},\n  maxWidth: null,\n  initializeContent: true,\n  headerClass: null\n};\n\nfunction Tooltip(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, TOOLTIP_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nTooltip.prototype = {\n\n  /**\n   * @returns {boolean} whether or not the tooltip/popover is currently showing\n   */\n  get visible() {\n    return DOM.hasClass(this.element[0], 'is-hidden') === false;\n  },\n\n  /**\n   * @returns {Popupmenu|undefined} if a Popupmenu API exists on the trigger element\n   */\n  get popupmenuAPI() {\n    return this.element.data('popupmenu');\n  },\n\n  /**\n   * Initializes the component\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.uniqueId = utils.uniqueId(this.element, 'tooltip');\n    this.isTouch = env.features.touch;\n    this.setup();\n    this.appendTooltip();\n\n    // Initial Content Setting.\n    // Don't do this if we're using an \"immediate\" trigger because _setContent()_ is handled at\n    // display time in that case.\n    const shouldRender = this.settings.trigger !== 'immediate';\n    if (shouldRender) {\n      this.setContent(this.settings.content, true);\n    }\n\n    this.handleEvents();\n  },\n\n  /**\n   * Builds internal references\n   * @private\n   * @returns {void}\n   */\n  setup() {\n    // \"this.activeElement\" is the target element that the Tooltip will display itself against\n    this.activeElement = this.settings.parentElement instanceof $ &&\n      this.settings.parentElement.length ? this.settings.parentElement : this.element;\n\n    this.descriptionId = $('.tooltip-description').length + 1;\n    this.description = this.element.parent().find('.tooltip-description');\n    if (!this.description.length && this.settings.isError) {\n      this.description = $(`<span id=\"tooltip-description-${this.descriptionId}\" class=\"tooltip-description audible\"></span>`).insertAfter(this.element);\n    }\n\n    if (this.element.is('.dropdown, .multiselect')) {\n      this.activeElement = this.element.nextAll('.dropdown-wrapper:first').find('>.dropdown');\n    }\n\n    const titleAttr = this.element.attr('title');\n    if (\n      (!this.settings.popover && titleAttr && titleAttr.length) ||\n      (!this.settings.popover && this.settings.title)\n    ) {\n      this.settings.content = this.settings.title ? this.settings.title : titleAttr;\n      this.element.removeAttr('title');\n    }\n\n    if (this.settings.trigger === 'hover' && this.isTouch) {\n      this.element.addClass('longpress-target');\n    }\n\n    this.isPopover = (this.settings.content !== null && typeof this.settings.content === 'object') || this.settings.popover === true;\n\n    this.settings.closebutton = !!((this.settings.closebutton || this.element.data('closebutton')));\n\n    if (this.element.data('extraClass') && this.element.data('extraClass').length) {\n      this.settings.extraClass = this.element.data('extraClass');\n    }\n\n    this.isRTL = Locale.isRTL();\n  },\n\n  /**\n   * Adds ARIA attributes on some elements for better accessiblity.\n   * @private\n   * @returns {void}\n   */\n  addAria() {\n    if (!this.content) {\n      return;\n    }\n\n    this.description.text(this.content);\n    this.content = this.addClassToLinks(this.content, 'links-clickable');\n\n    if (!this.isPopover) {\n      this.element.removeAttr('title').attr('aria-describedby', this.description.attr('id'));\n    }\n\n    if (this.isPopover && this.settings.trigger === 'click') {\n      this.element.attr('aria-haspopup', true);\n    }\n  },\n\n  /**\n   * @param {jquery[]|string} content HTML or String-based content.\n   * @param {string} [thisClass] optional, additional CSS class that gets appeneded to any anchor tags inside of the content.\n   * @returns {string} the appended content\n   */\n  addClassToLinks(content, thisClass) {\n    const isjQuery = (content instanceof $ && content.length > 0);\n    if (isjQuery) {\n      return content;\n    }\n\n    const d = $('<div/>').html(content);\n    $('a', d).addClass(thisClass);\n    return d.html();\n  },\n\n  /**\n   * Gets a reference to the element being used for the tooltip and positions it in the correct spot on the page.\n   * @private\n   * @returns {void}\n   */\n  appendTooltip() {\n    this.tooltip = this.settings.tooltipElement ? $(this.settings.tooltipElement) : $('#tooltip');\n    if (!this.tooltip.length) {\n      const name = (this.settings.tooltipElement ? this.settings.tooltipElement.substring(1, this.settings.tooltipElement.length) : 'tooltip');\n      this.tooltip = $(`<div class=\"${this.isPopover ? 'popover' : 'tooltip'} bottom is-hidden\" role=\"tooltip\" id=\"${name}\"><div class=\"arrow\"></div><div class=\"tooltip-content\"></div></div>`);\n    }\n\n    this.tooltip.place({\n      container: this.scrollparent,\n      parent: this.activeElement,\n      placement: this.settings.placement,\n      strategy: 'flip'\n    });\n\n    this.setTargetContainer();\n  },\n\n  /**\n   * Sets up all event listeners for this component\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const delay = 400;\n    let timer;\n\n    function showOnTimer() {\n      clearTimeout(timer);\n      timer = setTimeout(() => {\n        if (self.element.is(':visible')) {\n          self.show();\n        }\n      }, delay);\n    }\n\n    function hideOnTimer() {\n      clearTimeout(timer);\n      timer = setTimeout(() => {\n        self.hide();\n      }, delay);\n    }\n\n    function showImmediately() {\n      clearTimeout(timer);\n      self.show();\n    }\n\n    function hideImmediately() {\n      clearTimeout(timer);\n      self.hide();\n    }\n\n    if (this.settings.trigger === 'hover' && !this.settings.isError) {\n      ((this.element.is('.dropdown, .multiselect, span.longpress-target')) ? this.activeElement : this.element)\n        .on(`mouseenter.${COMPONENT_NAME}`, () => {\n          if (self.isTouch) {\n            return;\n          }\n          showOnTimer();\n        })\n        .on(`mouseleave.${COMPONENT_NAME}`, () => {\n          hideOnTimer();\n        })\n        .on(`click.${COMPONENT_NAME}`, () => {\n          if (self.isTouch) {\n            return;\n          }\n          showImmediately();\n        })\n        .on(`longpress.${COMPONENT_NAME}`, () => {\n          showImmediately();\n        })\n        .on(`updated.${COMPONENT_NAME}`, () => {\n          self.updated();\n        });\n    }\n\n    function toggleTooltipDisplay() {\n      if (!self.visible) {\n        hideImmediately();\n      } else {\n        showImmediately();\n      }\n    }\n\n    if (this.settings.trigger === 'click') {\n      this.element.on(`click.${COMPONENT_NAME}`, () => {\n        toggleTooltipDisplay();\n      });\n    }\n\n    if (this.settings.trigger === 'immediate') {\n      timer = setTimeout(() => {\n        toggleTooltipDisplay();\n      }, 1);\n    }\n\n    const isFocusable = this.settings.trigger === 'focus';\n    if (isFocusable) {\n      this.element\n        .on(`focus.${COMPONENT_NAME}`, () => {\n          showImmediately();\n        })\n        .on(`blur.${COMPONENT_NAME}`, () => {\n          if (!self.settings.keepOpen) {\n            hideImmediately();\n          }\n        });\n    }\n\n    // Close the popup/tooltip on orientation changes (but not when keyboard is open)\n    $(window).on(`orientationchange.${COMPONENT_NAME}`, () => {\n      if (!self.visible) {\n        return;\n      }\n      hideImmediately();\n    }, false);\n  },\n\n  /**\n   * Sets the content used inside the Tooltip element.\n   * @private\n   * @param {jquery[]|string|function} content incoming content to be set\n   * @param {boolean} dontRender causes the tooltip to prevent a visual refresh\n    after changing its content, meaning it will keep the previous content visible until this tooltip is closed or manually re-drawn.\n   * @returns {boolean} whether or not the render was successful\n   */\n  setContent(content, dontRender) {\n    const self = this;\n    const settingsContent = this.settings.content;\n    const noIncomingContent = (content === undefined || content === null);\n    const noSettingsContent = (settingsContent === undefined || settingsContent === null);\n\n    function doRender() {\n      if (dontRender === true) {\n        return;\n      }\n      self.addAria();\n      self.render();\n    }\n\n    // If all sources of content are undefined, just return false and don't show anything.\n    if (noIncomingContent && noSettingsContent) {\n      return false;\n    }\n\n    // If the settingsContent type is a function, we need to re-run that function\n    // to update the content.\n    // NOTE: If you need to use a function to generate content, understand that the\n    //  tooltip/popover will not cache your content for future reuse.  It will ALWAYS\n    //  override incoming content.\n    if (typeof settingsContent === 'function') {\n      content = settingsContent;\n    }\n\n    // Use the pre-set content if we have no incoming content\n    if (noIncomingContent) {\n      content = settingsContent;\n    }\n\n    // If the incoming/preset content is exactly the same as the stored content,\n    // don't continue with this step. Deep object comparison for jQuery objects\n    // is done further down the chain.\n    if (content === this.content) {\n      doRender();\n      return true;\n    }\n\n    // jQuery-wrapped elements don't get manipulated.\n    // Simply store the reference, render, and return.\n    if (content instanceof $ && content.length) {\n      this.content = content.addClass('hidden');\n      doRender();\n      return true;\n    }\n\n    // Handle setting of content based on its Object type.\n    // If type isn't handled, the tooltip will not display.\n    if (typeof content === 'string') {\n      if (!content.length) {\n        return false;\n      }\n\n      // Could be a translation definition\n      content = Locale.translate(content, true) || content;\n\n      // Could be an ID attribute.\n      // If it matches an element already on the page, grab that element's content\n      // and store the reference only.\n      if (content.indexOf('#') === 0) {\n        const contentCheck = $(`${content}`);\n        if (contentCheck.length) {\n          this.content = contentCheck;\n          doRender();\n          return true;\n        }\n        return false;\n      }\n\n    // functions\n    } else if (typeof content === 'function') {\n      const callbackResult = content.call(this.element);\n      if (!callbackResult || typeof callbackResult !== 'string' || !callbackResult.length) {\n        return false;\n      }\n      content = callbackResult;\n\n    // if type isn't handled, return false\n    } else {\n      return false;\n    }\n\n    // Store an internal copy of the processed content\n    this.content = xssUtils.sanitizeHTML(content);\n\n    // Wrap tooltip content in <p> tags if there isn't already one present.\n    // Only happens for non-jQuery markup.\n    this.content = `<p>${this.content}</p>`;\n\n    doRender();\n    return true;\n  },\n\n  /**\n   * Renders internal content either as a Tooltip or Popover.\n   * @private\n   * @returns {void}\n   */\n  render() {\n    if (this.isPopover) {\n      return this.renderPopover();\n    }\n    return this.renderTooltip();\n  },\n\n  /**\n   * Renders internal content as a Tooltip.\n   * @private\n   * @returns {void}\n   */\n  renderTooltip() {\n    const titleArea = this.tooltip[0].querySelectorAll('.tooltip-title')[0];\n    const contentArea = this.tooltip[0].querySelectorAll('.tooltip-content')[0];\n    const extraClass = this.settings.extraClass;\n    const content = this.content;\n    const tooltip = this.tooltip[0];\n    let classes = 'tooltip is-hidden';\n\n    if (extraClass) {\n      classes += ` ${extraClass}`;\n    }\n    tooltip.setAttribute('class', classes);\n\n    if (titleArea) {\n      titleArea.style.display = 'none';\n    }\n\n    if (!contentArea.previousElementSibling.classList.contains('arrow')) {\n      contentArea.insertAdjacentHTML('beforebegin', '<div class=\"arrow\"></div>');\n    }\n\n    const tooltipHTML = typeof this.content === 'string' ? content : content[0].innerHTML;\n    DOM.html(contentArea, tooltipHTML, '<div><p><span><ul><li><a><abbr><b><i><kbd><small><strong><sub><svg><use><br>');\n  },\n\n  /**\n   * Renders internal content as a Tooltip.\n   * @private\n   * @returns {void}\n   */\n  renderPopover() {\n    const self = this;\n    const extraClass = this.settings.extraClass;\n    const contentArea = this.tooltip.find('.tooltip-content');\n    let title = this.tooltip[0].querySelector('.tooltip-title');\n    let content = this.content;\n    let classes = 'popover is-hidden';\n\n    if (extraClass) {\n      classes += ` ${extraClass}`;\n    }\n\n    this.tooltip[0].setAttribute('class', classes);\n\n    if (typeof content === 'string') {\n      content = $(content);\n      contentArea.html(content);\n      contentArea.find('.hidden').removeClass('hidden');\n    } else {\n      contentArea.html(content);\n    }\n\n    const popoverWidth = contentArea.width();\n\n    if (!this.settings.placementOpts) {\n      this.settings.placementOpts = {};\n    }\n\n    if (!this.settings.placementOpts.parent) {\n      this.settings.placementOpts.parent = this.element;\n    }\n\n    content[0].classList.remove('hidden');\n    contentArea[0].firstElementChild.classList.remove('hidden');\n\n    const parentWidth = this.settings.placementOpts.parent.width();\n\n    if (Locale.isRTL()) {\n      this.settings.placementOpts.parentXAlignment = parentWidth > popoverWidth ? 'left' : 'right';\n    } else {\n      this.settings.placementOpts.parentXAlignment = parentWidth > popoverWidth ? 'right' : 'left';\n    }\n\n    if (this.settings.title !== null) {\n      if (!title) {\n        const titleFrag = document.createDocumentFragment();\n        title = document.createElement('div');\n        DOM.html(title, this.settings.title, '*');\n        title.classList.add('tooltip-title');\n\n        if (this.settings.headerClass) {\n          DOM.addClass(title, this.settings.headerClass, 'filled');\n        }\n        titleFrag.appendChild(title);\n        this.tooltip[0].insertBefore(titleFrag, this.tooltip[0].firstChild);\n      } else {\n        title.style.display = '';\n        title.childNodes[0].nodeValue = this.settings.title;\n      }\n    } else if (title) {\n      title.style.display = 'none';\n    }\n\n    if (this.settings.closebutton && title && !title.firstElementChild) {\n      const closeBtnX = $(`<button type=\"button\" class=\"btn-icon l-pull-right btn-close\">${\n        $.createIcon({ classes: ['icon-close'], icon: 'close' })\n      }<span>Close</span>` +\n        '</button>').on('click', () => {\n        self.hide(true);\n      });\n\n      title.appendChild(closeBtnX[0]);\n    }\n\n    if (this.settings.initializeContent) {\n      content.initialize();\n    }\n  },\n\n  /**\n   * Alias for _show()_.\n   * @private\n   * @returns {void}\n   */\n  open() {\n    return this.show();\n  },\n\n  /**\n   * Causes the tooltip to become shown\n   * @param {object} newSettings an object containing changed settings that will be\n   *  applied to the Tooltip/Popover before it's displayed.\n   * @param {boolean} ajaxReturn causes an AJAX-powered Tooltip/Popover not to refresh.\n   */\n  show(newSettings, ajaxReturn) {\n    const self = this;\n    this.isInPopup = false;\n\n    if (newSettings) {\n      this.settings = utils.mergeSettings(this.element[0], newSettings, this.settings);\n    }\n\n    // Don't open if this is an Actions Button with an open popupmenu\n    if (this.popupmenuAPI && this.popupmenuAPI.isOpen) {\n      return;\n    }\n\n    if (this.settings.beforeShow && !ajaxReturn) {\n      const response = function (content) {\n        if (typeof content === 'boolean' && !content) {\n          return;\n        }\n        self.content = content;\n        self.show({ content }, true);\n      };\n\n      if (typeof this.settings.beforeShow === 'string') {\n        window[this.settings.beforeShow](response, this.element);\n        return;\n      }\n\n      this.settings.beforeShow(response, this.element);\n      return;\n    }\n\n    let okToShow = true;\n    okToShow = this.setContent(this.content);\n    if (okToShow === false) {\n      return;\n    }\n\n    /**\n     * Fires before show the tooltip.\n     *\n     * @event beforeshow\n     * @memberof Tooltip\n     * @property {object} event - The jquery event object\n     * @property {object} tooltip - instance\n     */\n    okToShow = this.element.triggerHandler('beforeshow', [this.tooltip]);\n    if (okToShow === false) {\n      return;\n    }\n\n    this.tooltip[0].removeAttribute('style');\n    this.tooltip[0].classList.add(this.settings.placement);\n\n    if (this.settings.isError || this.settings.isErrorColor) {\n      this.tooltip[0].classList.add('is-error');\n    }\n\n    this.position();\n    utils.fixSVGIcons(this.tooltip);\n    /**\n     * Fires on show the tooltip.\n     *\n     * @event show\n     * @memberof Tooltip\n     * @property {object} event - The jquery event object\n     * @property {object} tooltip - instance\n     */\n    this.element.trigger('show', [this.tooltip]);\n\n    const mouseUpEventName = this.isTouch ? 'touchend' : 'mouseup';\n\n    setTimeout(() => {\n      $(document)\n        .on(`${mouseUpEventName}.${COMPONENT_NAME}-${self.uniqueId}`, (e) => {\n          const target = $(e.target);\n\n          if (self.settings.isError || self.settings.trigger === 'focus') {\n            return;\n          }\n\n          if (target.is(self.element) && target.is('svg.icon')) {\n            return;\n          }\n\n          if ($('#editor-popup').length && $('#colorpicker-menu').length) {\n            return;\n          }\n\n          if (target.closest('.popover').length === 0 &&\n              target.closest('.dropdown-list').length === 0) {\n            self.hide();\n          }\n\n          // Closes patepicker dialog closes when clicking on a parent popover\n          if (target.closest('.popover').length === 1 &&\n              target.closest('.popover').not('.monthview-popup').length &&\n              self.element.prev().is('.datepicker')) {\n            self.hide(e);\n          }\n        })\n        .on(`keydown.${COMPONENT_NAME}-${self.uniqueId}`, (e) => {\n          if (e.which === 27 || self.settings.isError) {\n            self.hide();\n          }\n        });\n\n      if (self.settings.isError &&\n          !self.element.is(':visible, .dropdown') &&\n          self.element.is('[aria-describedby]')) {\n        self.hide();\n      }\n\n      if (window.orientation === undefined) {\n        $('body').on(`resize.${COMPONENT_NAME}`, () => {\n          self.hide();\n        });\n      }\n\n      // Hide on Page scroll\n      $('body').on(`scroll.${COMPONENT_NAME}`, () => {\n        self.hide();\n      });\n\n      self.element.closest('.modal-body-wrapper').on('scroll.tooltip', () => {\n        self.hide();\n      });\n\n      self.element.closest('.scrollable').on('scroll.tooltip', () => {\n        self.hide();\n      });\n\n      self.element.closest('.datagrid-body').on('scroll.tooltip', () => {\n        self.hide();\n      });\n\n      // Click to close\n      if (self.settings.isError) {\n        self.tooltip.on(`click.${COMPONENT_NAME}`, () => {\n          self.hide();\n        });\n      }\n      /**\n       * Fires after show the tooltip.\n       *\n       * @event aftershow\n       * @memberof Tooltip\n       * @property {object} event - The jquery event object\n       * @property {object} tooltip - instance\n       */\n      self.element.trigger('aftershow', [self.tooltip]);\n    }, 400);\n  },\n\n  /**\n   * Places the tooltip element itself in the correct DOM element.\n   * If the current element is inside a scrollable container, the tooltip element\n   *  goes as high as possible in the DOM structure.\n   * @returns {void}\n   */\n  setTargetContainer() {\n    let targetContainer = $('body');\n\n    // adjust the tooltip if the element is being scrolled inside a scrollable DIV\n    this.scrollparent = this.element.closest('.page-container.scrollable');\n    if (this.scrollparent.length) {\n      targetContainer = this.scrollparent;\n    }\n\n    if (this.settings.parentElement) {\n      targetContainer = this.settings.parentElement;\n    }\n\n    // this.tooltip.detach().appendTo(targetContainer);\n    targetContainer[0].appendChild(this.tooltip[0]);\n  },\n\n  /**\n   * Placement behavior's \"afterplace\" handler.\n   * DO NOT USE FOR ADDITIONAL POSITIONING.\n   * @private\n   * @param {jquery.event} e custom `afterPlace` event\n   * @param {placementobject} placementObj object containing placement settings\n   * @returns {void}\n   */\n  handleAfterPlace(e, placementObj) {\n    this.tooltip.data('place').setArrowPosition(e, placementObj, this.tooltip);\n    this.tooltip.triggerHandler('tooltipafterplace', [placementObj]);\n  },\n\n  /**\n   * Resets the current position of the tooltip.\n   * @returns {this} component instance\n   */\n  position() {\n    this.setTargetContainer();\n    this.tooltip[0].classList.remove('is-hidden');\n\n    const self = this;\n    const distance = this.isPopover ? 20 : 10;\n    const tooltipPlacementOpts = this.settings.placementOpts || {};\n    const opts = $.extend({}, {\n      x: 0,\n      y: distance,\n      container: this.scrollparent,\n      containerOffsetX: tooltipPlacementOpts.containerOffsetX || this.settings.offset.left,\n      containerOffsetY: tooltipPlacementOpts.containerOffsetY || this.settings.offset.top,\n      parent: tooltipPlacementOpts.parent || this.activeElement,\n      placement: tooltipPlacementOpts.placement || this.settings.placement,\n      strategies: ['flip', 'nudge']\n    }, tooltipPlacementOpts);\n\n    if (opts.placement === 'left' || opts.placement === 'right') {\n      opts.x = distance;\n      opts.y = 0;\n    }\n\n    this.tooltip.one('afterplace.tooltip', (e, placementObj) => {\n      self.handleAfterPlace(e, placementObj);\n    });\n\n    // Tool tip may be cleaned up on a modal or CAP\n    if (this.tooltip.data('place')) {\n      this.tooltip.data('place').place(opts);\n    } else {\n      this.tooltip.place(opts);\n      this.tooltip.data('place').place(opts);\n    }\n    return this;\n  },\n\n  /**\n   * Alias for _hide()_ that works with the global _closeChildren()_ method.\n   * @private\n   * @returns {void}\n   */\n  close() {\n    return this.hide();\n  },\n\n  /**\n   * Hides the Tooltip/Popover\n   * @param {boolean} [force] Force the tooltip to hide no matter the settings.\n   * @returns {void}\n   */\n  hide(force) {\n    if ((this.settings.keepOpen && !force) || !this.visible) {\n      return;\n    }\n\n    if (this.isInPopup) {\n      this.settings.content.addClass('hidden');\n      return;\n    }\n\n    this.tooltip[0].classList.add('is-hidden');\n    this.tooltip[0].style.left = '';\n    this.tooltip[0].style.top = '';\n    this.tooltip.find('.arrow').removeAttr('style');\n\n    this.detachOpenEvents();\n\n    if ($('.popover').not('.is-hidden').length === 0) {\n      $(document).off('mouseup.tooltip keydown.tooltip');\n      $('body').off('resize.tooltip');\n    }\n\n    /**\n     * Fires when hide the tooltip.\n     *\n     * @event hide\n     * @memberof Tooltip\n     * @property {object} event - The jquery event object\n     * @property {object} tooltip - instance\n     */\n    this.element.triggerHandler('hide', [this.tooltip]);\n  },\n\n  /**\n   * Causes the tooltip to store updated settings and re-render itself.\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    const self = this;\n    if (self.settings.trigger === 'immediate') {\n      setTimeout(() => {\n        self.show();\n      }, 100);\n    } else {\n      self.setContent();\n    }\n\n    return this;\n  },\n\n  /**\n   * Removes any events which would cause the tooltip/popover to re-open.\n   * @private\n   * @returns {void}\n   */\n  detachOpenEvents() {\n    this.tooltip.off(`click.${COMPONENT_NAME}`);\n\n    $(document).off([\n      `keydown.${COMPONENT_NAME}-${self.uniqueId}`,\n      `mouseup.${COMPONENT_NAME}-${self.uniqueId}`,\n      `touchend.${COMPONENT_NAME}-${self.uniqueId}`].join(' '));\n\n    $('body').off([\n      `resize.${COMPONENT_NAME}`,\n      `scroll.${COMPONENT_NAME}`].join(' '));\n\n    this.element.closest('.modal-body-wrapper').off(`scroll.${COMPONENT_NAME}`);\n    this.element.closest('.scrollable').off(`scroll.${COMPONENT_NAME}`);\n    this.element.closest('.datagrid-body').off(`scroll.${COMPONENT_NAME}`);\n  },\n\n  /**\n   * Tears down this component instance, removing all internal flags and unbinding events.\n   * @private\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.description.remove();\n    this.descriptionId = undefined;\n    this.activeElement = undefined;\n\n    this.element.removeAttr('aria-describedby').removeAttr('aria-haspopup');\n    if (!this.tooltip.hasClass('is-hidden')) {\n      this.hide();\n    }\n\n    if (this.tooltip && this.tooltip.data('place')) {\n      this.tooltip.data('place').destroy();\n    }\n\n    this.element.off([\n      `mouseenter.${COMPONENT_NAME}`,\n      `mouseleave.${COMPONENT_NAME}`,\n      `longpress.${COMPONENT_NAME}`,\n      `click.${COMPONENT_NAME}`,\n      `updated.${COMPONENT_NAME}`,\n      `focus.${COMPONENT_NAME}`,\n      `blur.${COMPONENT_NAME}`].join(' '));\n\n    this.detachOpenEvents();\n\n    $(window).off(`orientationchange.${COMPONENT_NAME}`);\n\n    return this;\n  },\n\n  /**\n   * Destroys this component instance\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Tooltip, COMPONENT_NAME };\n","import { Tooltip, COMPONENT_NAME } from './tooltip';\n\n/**\n * jQuery Component Wrapper for Tooltip/Popover\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.tooltip = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Tooltip(this, settings));\n    }\n  });\n};\n","import '../tooltip/tooltip.jquery';\n\n// The Tooltip Component and Popover Component use the same prototype with different settings.\n// Simply setup the Popover to be the same thing as the Tooltip.\n$.fn.popover = $.fn.tooltip;\n","import * as debug from '../../utils/debug';\nimport { deprecateMethod, warnAboutDeprecation } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { Environment as env } from '../../utils/environment';\nimport { Locale } from '../locale/locale';\nimport { ListFilter } from '../listfilter/listfilter';\nimport { xssUtils } from '../../utils/xss';\n\n// jQuery Components\nimport '../icons/icons.jquery';\nimport '../../utils/lifecycle';\nimport '../place/place.jquery';\nimport '../tooltip/tooltip.jquery';\n\n// Name of this component.\nconst COMPONENT_NAME = 'dropdown';\n\n// Dropdown Settings and Options\nconst moveSelectedOpts = ['none', 'all', 'group'];\nconst reloadSourceStyles = ['none', 'open', 'typeahead'];\n\n/**\n* The Dropdown allows users to select from a list. Like an Html Select.\n* @class Dropdown\n* @param {object} element The component element.\n* @param {object} [settings] The component settings.\n* @param {boolean} [settings.closeOnSelect = true]  When an option is selected, the list will close if set to \"true\".  List stays open if \"false\".\n* @param {string} [settings.cssClass = null]  Append an optional css class to dropdown-list\n* @param {string} [settings.filterMode = 'contains']  Search mode to use between 'startsWith' and 'contains', false will not allow client side filter\n* @param {boolean} [settings.noSearch = false]  If true, disables the ability of the user to enter text\n* in the Search Input field in the open combo box\n* @param {boolean} [settings.showEmptyGroupHeaders = false]  If true, displays optgroup headers in the list\n* even if no selectable options are present underneath.\n* @param {boolean} [settings.source]  A function that can do an ajax call.\n* @param {boolean} [settings.sourceArguments = {}]  If a source method is defined, this flexible object can be\n* passed into the source method, and augmented with parameters specific to the implementation.\n* @param {boolean|string} [settings.reload = 'none']  Determines how a Dropdown list will repopulate its contents, when operating via AJAX.\n* @param {boolean} [settings.reloadSourceOnOpen = false]  If set to true, will always perform an ajax call\n* whenever the list is opened.  If false, the first AJAX call's results are cached.\n* @param {boolean} [settings.empty = false]  Initialize Empty Value\n* @param {boolean} [settings.delay = 300]  Typing buffer delay in ms\n* @param {number} [settings.maxWidth = null] If set the width of the dropdown is limited to this pixel width.\n* Fx 300 for the 300 px size fields. Default is size of the largest data.\n* @param {object} [settings.placementOpts = null]  Gets passed to this control's Place behavior\n* @param {function} [settings.onKeyDown = null]  Allows you to hook into the onKeyDown. If you do you can access the keydown event data. And optionally return false to cancel the keyDown action.\n*/\nconst DROPDOWN_DEFAULTS = {\n  closeOnSelect: true,\n  cssClass: null,\n  filterMode: 'contains',\n  maxSelected: undefined, // (multiselect) sets a limit on the number of items that can be selected\n  moveSelected: 'none',\n  moveSelectedToTop: undefined,\n  multiple: false, // Turns the dropdown into a multiple selection box\n  noSearch: false,\n  showEmptyGroupHeaders: false,\n  showSelectAll: false, // (Multiselect) shows an item the top of the list labeled \"select all\".\n  source: undefined,\n  sourceArguments: {},\n  reload: reloadSourceStyles[0],\n  empty: false,\n  delay: 300,\n  maxWidth: null,\n  placementOpts: null,\n  onKeyDown: null\n};\n\nfunction Dropdown(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, DROPDOWN_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Actual DropDown Code\nDropdown.prototype = {\n\n  /**\n   * @returns {array|string} currently-selected options\n   */\n  get value() {\n    const reload = this.settings.reload;\n    const multiple = this.settings.multiple;\n\n    if (reload === 'typeahead') {\n      if (multiple) {\n        return this.selectedValues;\n      }\n      return this.element.val();\n    }\n\n    const result = [];\n    const options = this.element[0].options;\n    let opt;\n\n    for (let i = 0; i < options.length; i++) {\n      opt = options[i];\n      if (opt.selected) {\n        result.push(opt.value || opt.text);\n      }\n    }\n\n    if (!multiple && result.length === 1) {\n      return result[0];\n    }\n    return result;\n  },\n\n  /**\n   * @returns {boolean} whether or not the text inside the in-page pseudo element too big to fit\n   */\n  get overflowed() {\n    if (!this.isMobile() || (this.isMobile() && !this.isOpen())) {\n      const span = this.pseudoElem.find('span').css('max-width', '');\n      if (span.width() > this.pseudoElem.width()) {\n        span.css('max-width', '100%');\n        return true;\n      }\n    }\n    return false;\n  },\n\n  /**\n   * Initialize the dropdown.\n   * @private\n   * @returns {object} The api for chaining\n   */\n  init() {\n    let orgId = this.element.attr('id');\n    orgId = orgId ? xssUtils.stripTags(orgId) : '';\n\n    this.inlineLabel = this.element.closest('label');\n    this.inlineLabelText = this.inlineLabel.find('.label-text');\n    this.isInlineLabel = this.element.parent().is('.inline');\n\n    this.timer = null;\n    this.filterTerm = '';\n\n    if (!orgId) {\n      orgId = utils.uniqueId(this.element, 'dropdown');\n      DOM.setAttribute(this.element[0], 'id', orgId);\n      DOM.setAttribute(this.element.parent().find('label').first()[0], 'for', orgId);\n    }\n\n    if (env.os.name === 'ios' || env.os.name === 'android') {\n      this.settings.noSearch = true;\n    }\n\n    // convert <select> tag's size css classes for the pseudo element\n    const elemClassList = this.element[0].classList;\n    if (elemClassList.length === 0) {\n      this.element[0].classList = 'dropdown';\n    }\n    let pseudoClassString = elemClassList.contains('dropdown-xs') ? 'dropdown input-xs' : //eslint-disable-line\n      elemClassList.contains('dropdown-sm') ? 'dropdown input-sm' : //eslint-disable-line\n        elemClassList.contains('dropdown-lg') ? 'dropdown input-lg' : 'dropdown'; //eslint-disable-line\n\n    // Detect Inline Styles\n    const style = this.element.attr('style');\n    this.isHidden = style && style.indexOf('display: none') >= 0;\n\n    // Build the wrapper if it doesn't exist\n    const baseElement = this.isInlineLabel ? this.inlineLabel : this.element;\n    this.wrapper = baseElement.next('.dropdown-wrapper');\n    this.isWrapped = this.wrapper.length > 0;\n\n    if (!this.isWrapped) {\n      this.wrapper = $('<div class=\"dropdown-wrapper\"></div>').insertAfter(baseElement);\n    }\n\n    if (this.isWrapped) {\n      this.pseudoElem = this.wrapper.find(`.${pseudoClassString}`);\n      this.trigger = this.wrapper.find('.trigger');\n    } else {\n      this.pseudoElem = $(`div#${orgId}-shdo`);\n    }\n\n    if (elemClassList.contains('text-align-reverse')) {\n      pseudoClassString += ' text-align-reverse';\n    } else if (elemClassList.contains('text-align-center')) {\n      pseudoClassString += ' text-align-center';\n    }\n\n    // Build sub-elements if they don't exist\n    this.label = $(`label[for=\"${xssUtils.stripTags(orgId)}\"]`);\n\n    if (!this.pseudoElem.length) {\n      this.pseudoElem = $(`<div class=\"${pseudoClassString}\">`);\n    } else {\n      this.pseudoElem[0].setAttribute('class', pseudoClassString);\n    }\n\n    if (!this.isWrapped) {\n      this.pseudoElem.append($('<span></span>'));\n    }\n    const toExclude = ['data-validate'];\n    const attributes = DOM.getAttributes(this.element[0]);\n    const attributesToCopy = this.getDataAttributes(attributes, toExclude);\n\n    this.pseudoElem\n      .attr(attributesToCopy.obj)\n      .attr({\n        role: 'button',\n        'aria-haspopup': 'listbox'\n      });\n\n    // Pass disabled/readonly from the original element, if applicable\n    // \"disabled\" is a stronger setting than \"readonly\" - should take precedent.\n    function handleStates(self) {\n      const disabled = self.element.prop('disabled');\n      const readonly = self.element.prop('readonly');\n\n      if (disabled) {\n        return self.disable();\n      }\n\n      if (readonly) {\n        return self.readonly();\n      }\n\n      return self.enable();\n    }\n    handleStates(this);\n\n    if (!this.isWrapped) {\n      this.wrapper.append(this.pseudoElem, this.trigger);\n    }\n\n    // Check for and add the icon\n    this.icon = this.wrapper.find('.icon');\n    if (!this.icon.length) {\n      this.icon = $.createIconElement('dropdown');\n      this.wrapper.append(this.icon);\n    }\n\n    // Setup the incoming options that can be set as properties/attributes\n    if (this.element.prop('multiple') && !this.settings.multiple) {\n      this.settings.multiple = true;\n    }\n    if (this.settings.multiple && !this.element.prop('multiple')) {\n      this.element.prop('multiple', true);\n    }\n\n    // Add the internal hash for typeahead filtering, if applicable\n    if (this.settings.reload === 'typeahead') {\n      this.selectedValues = [];\n    } else {\n      delete this.selectedValues;\n    }\n\n    const dataSource = this.element.attr('data-source');\n    if (dataSource && dataSource !== 'source') {\n      this.settings.source = dataSource;\n    }\n    const dataMaxselected = this.element.attr('data-maxselected');\n    if (dataMaxselected && !isNaN(dataMaxselected)) { //eslint-disable-line\n      this.settings.maxSelected = parseInt(dataMaxselected, 10);\n    }\n\n    // TODO: deprecate \"moveSelectedToTop\" in favor of \"moveSelected\"\n    // _getMoveSelectedSetting()_ converts the old setting to the new text type.\n    function getMoveSelectedSetting(incomingSetting, useText) {\n      switch (incomingSetting) {\n        case (useText ? 'true' : true):\n          return 'all';\n        case (useText ? 'false' : false):\n          return 'none';\n        default:\n          if (moveSelectedOpts.indexOf(incomingSetting) > -1) {\n            return incomingSetting;\n          }\n          return 'none';\n      }\n    }\n\n    // Backwards compatibility for deprecated \"moveSelectedToTop\" setting.\n    if (this.settings.moveSelectedToTop !== undefined) {\n      this.settings.moveSelected = this.settings.moveSelectedToTop;\n    }\n\n    const dataMoveSelected = this.element.attr('data-move-selected');\n    if (dataMoveSelected) {\n      this.settings.moveSelected = getMoveSelectedSetting(dataMoveSelected, true);\n    } else {\n      this.settings.moveSelected = getMoveSelectedSetting(this.settings.moveSelected);\n    }\n\n    // Backwards compatibility with `settings.reloadSourceOnOpen`\n    if (this.settings.reloadSourceOnOpen) {\n      this.settings.reload = 'open';\n      delete this.settings.reloadSourceOnOpen;\n    }\n\n    const dataCloseOnSelect = this.element.attr('data-close-on-select');\n    if (dataCloseOnSelect && !this.settings.closeOnSelect) {\n      this.settings.closeOnSelect = dataCloseOnSelect === 'true';\n    }\n    const dataNoSearch = this.element.attr('data-no-search');\n    if (dataNoSearch && !this.settings.noSearch) {\n      this.settings.noSearch = dataNoSearch === 'true';\n    }\n\n    // Persist sizing defintions\n    const sizingStrings = ['-xs', '-sm', '-mm', '-md', '-lg'];\n    const classString = this.element.attr('class');\n    let s = null;\n\n    for (let i = 0; i < sizingStrings.length; i++) {\n      s = sizingStrings[i];\n      if (classString.match(s)) {\n        this.pseudoElem.addClass(`dropdown${s}`);\n      }\n    }\n\n    // Cached dataset (from AJAX, if applicable)\n    this.dataset = [];\n\n    this.listfilter = new ListFilter({\n      filterMode: this.settings.filterMode\n    });\n\n    this.setListIcon();\n    this.setDisplayedValues();\n    this.setInitial();\n    this.setWidth();\n    this.toggleTooltip();\n\n    this.element.triggerHandler('rendered');\n\n    return this.handleEvents();\n  },\n\n  /**\n   * Used for preventing menus from popping open/closed when they shouldn't.\n   * Gets around the need for timeouts everywhere\n   * @private\n   * @returns {boolean} If the timeout should be cancelled.\n    */\n  inputTimer() {\n    if (this.inputTimeout) {\n      return false;\n    }\n\n    const self = this;\n\n    this.inputTimeout = setTimeout(() => {\n      clearTimeout(self.inputTimeout);\n      self.inputTimeout = null;\n    }, 100);\n\n    return true;\n  },\n\n  /**\n   * Set Width on the field\n   * @private\n   */\n  setWidth() {\n    const style = this.element[0].style;\n\n    if (style.width) {\n      this.pseudoElem[0].style.width = style.width;\n    }\n    if (style.position === 'absolute') {\n      this.pseudoElem[0].style.position = 'absolute';\n      this.pseudoElem[0].style.left = style.left;\n      this.pseudoElem[0].style.top = style.top;\n      this.pseudoElem[0].style.bottom = style.bottom;\n      this.pseudoElem[0].style.right = style.right;\n    }\n  },\n\n  /**\n   * Set list item icon\n   * @private\n   * @param  {object} listIconItem The icon info to use on the list.\n   */\n  setItemIcon(listIconItem) {\n    const self = this;\n    let specColor = null;\n\n    if (!listIconItem.icon) {\n      listIconItem.isIcon = false;\n      listIconItem.html = '';\n      self.listIcon.items.push(listIconItem);\n      return;\n    }\n\n    // Set icon properties\n    if (typeof listIconItem.icon === 'object') {\n      listIconItem.obj = listIconItem.icon;\n      listIconItem.icon = listIconItem.icon.icon;\n\n      // Color\n      if (listIconItem.obj.color) {\n        specColor = listIconItem.obj.color.indexOf('#') === 0;\n        if (specColor) {\n          listIconItem.specColor = listIconItem.obj.color;\n        } else {\n          listIconItem.classList = ` ${listIconItem.obj.color}`;\n        }\n      } else if (listIconItem.obj.class) {\n        specColor = listIconItem.obj.class.indexOf('#') === 0;\n        if (specColor) {\n          listIconItem.specColor = listIconItem.obj.class;\n        } else {\n          listIconItem.classList = ` ${listIconItem.obj.class}`;\n        }\n      }\n\n      // Color Over\n      if (listIconItem.obj.colorOver) {\n        specColor = listIconItem.obj.colorOver.indexOf('#') === 0;\n        if (specColor) {\n          listIconItem.specColorOver = listIconItem.obj.colorOver;\n        } else {\n          listIconItem.classListOver = ` ${listIconItem.obj.colorOver}`;\n        }\n      } else if (listIconItem.obj.classOver) {\n        specColor = listIconItem.obj.classOver.indexOf('#') === 0;\n        if (specColor) {\n          listIconItem.specColorOver = listIconItem.obj.classOver;\n        } else {\n          listIconItem.classListOver = ` ${listIconItem.obj.classOver}`;\n        }\n      }\n    }\n\n    // Set flags\n    listIconItem.isIcon = (listIconItem.icon && listIconItem.icon.length);\n\n    if (listIconItem.classList && listIconItem.classList.length) {\n      listIconItem.isClassList = true;\n    }\n    if (listIconItem.classListOver && listIconItem.classListOver.length) {\n      listIconItem.isClassListOver = true;\n    }\n\n    // Build icon\n    listIconItem.html = $.createIcon({\n      icon: listIconItem.isIcon ? listIconItem.icon : '',\n      class: `listoption-icon${listIconItem.isClassList ? ` ${listIconItem.classList}` : ''}`\n    });\n\n    if (listIconItem.icon === 'swatch') {\n      listIconItem.isSwatch = true;\n      listIconItem.html = `<span class=\"swatch ${listIconItem.isClassList ? listIconItem.classList : ''}\"></span>`;\n    }\n\n    self.listIcon.items.push(listIconItem);\n  },\n\n  /**\n   * Set all icons on the list.\n   * @private\n   */\n  setListIcon() {\n    const self = this;\n    let hasIcons = self.settings.multiple ? false : self.element.find('[data-icon]').length > 0;\n    const opts = hasIcons ? this.element.find('option') : [];\n\n    self.listIcon = { hasIcons, items: [] };\n\n    if (hasIcons) {\n      let count = 0;\n\n      opts.each(function (i) {\n        const iconAttr = $(this).attr('data-icon');\n        let icon = null;\n\n        if (typeof iconAttr !== 'string' || !iconAttr.length) {\n          return;\n        }\n\n        if (iconAttr.indexOf('{') !== 0) {\n          icon = iconAttr;\n        } else {\n          icon = $.fn.parseOptions(this, 'data-icon');\n        }\n        self.setItemIcon({ html: '', icon });\n\n        if (self.listIcon.items[i] && self.listIcon.items[i].isIcon) {\n          count++;\n        }\n      });\n\n      hasIcons = count > 0;\n    }\n\n    if (hasIcons) {\n      self.pseudoElem.prepend($.createIcon({ icon: '', class: 'listoption-icon' }));\n      self.listIcon.pseudoElemIcon = self.pseudoElem.find('> .listoption-icon');\n      self.listIcon.idx = -1;\n    }\n\n    self.listIcon.hasIcons = hasIcons;\n  },\n\n  /**\n   * Toggle toooltip (add if text over flowed)\n   * @private\n   * @returns {void}\n   */\n  toggleTooltip() {\n    if (this.overflowed) {\n      this.setTooltip();\n    } else if (this.tooltipApi) {\n      this.removeTooltip();\n    }\n  },\n\n  /**\n   * Triggers tooltip in multiselect\n   * @returns {void}\n   */\n  setTooltip() {\n    const opts = this.element.find('option:selected');\n    const optText = this.getOptionText(opts);\n    this.tooltipApi = this.pseudoElem.find('span')\n      .tooltip({\n        content: optText,\n        parentElement: this.pseudoElem,\n        trigger: this.isMobile() ? 'immediate' : 'hover',\n      })\n      .on('blur.dropdowntooltip', () => {\n        this.removeTooltip();\n      })\n      .data('tooltip');\n  },\n\n  /**\n   * Removes a tooltip\n   * @returns {void}\n   */\n  removeTooltip() {\n    if (this.tooltipApi) {\n      this.tooltipApi.element.off('blur.dropdowntooltip');\n      this.tooltipApi.destroy();\n      this.tooltipApi = null;\n    }\n  },\n\n  /**\n   * Set over color for list item icon,\n   * if run without pram {target}, it will make on only\n   * @private\n   * @param  {object} target The dom target.\n   */\n  setItemIconOverColor(target) {\n    const self = this;\n    if (self.listIcon.hasIcons) {\n      const targetIcon = target ? target.find('.listoption-icon') : null;\n      self.list.find('li').each(function (i) {\n        const li = $(this);\n        const icon = li.find('.listoption-icon');\n        const iconRef = self.listIcon.items[i];\n\n        if (!iconRef) {\n          return;\n        }\n\n        // make it on\n        if (li.is('.is-focused')) {\n          if (iconRef.isClassListOver) {\n            icon.removeClass(iconRef.classListOver)\n              .addClass(iconRef.classList);\n          }\n        }\n        // make it over\n        if (targetIcon && li.is(target)) {\n          if (iconRef.isClassListOver) {\n            targetIcon.removeClass(iconRef.classList);\n            targetIcon.addClass(iconRef.classListOver);\n          }\n        }\n      });\n    }\n  },\n\n  /**\n   * Update the icon.\n   * @private\n   * @param {object} opt The dom target.\n   */\n  updateItemIcon(opt) {\n    const self = this;\n    if (self.listIcon.hasIcons) {\n      const target = self.listIcon.pseudoElemIcon;\n      const i = opt.index();\n      const idx = self.listIcon.idx;\n      const iconRef = self.listIcon.items[i];\n      const icon = iconRef && iconRef.isIcon ? iconRef.icon : '';\n\n      // Return out if this item has no icon\n      if (!iconRef) {\n        return;\n      }\n\n      // Reset class and color\n      if (idx > -1) {\n        const iconAtIndex = self.listIcon.items[idx];\n        if (iconAtIndex) {\n          target.removeClass(`${iconAtIndex.classList} ${iconAtIndex.classListOver}`);\n          target[0].style.fill = '';\n        }\n      }\n\n      // Update new stuff\n      self.listIcon.idx = i;\n      target.changeIcon(icon);\n      if (iconRef.isClassList) {\n        target.addClass(iconRef.classList);\n      }\n    }\n  },\n\n  /**\n   * Update the visible list object.\n   * @param {string} [term = undefined] an optional search term that will cause highlighting of text\n   * @private\n   */\n  updateList(term) {\n    const self = this;\n    const isMobile = self.isMobile();\n    const listExists = self.list !== undefined && self.list !== null && self.list.length > 0;\n    let listContents = '';\n    let ulContents = '';\n    let upTopOpts = 0;\n    const hasOptGroups = this.element.find('optgroup').length;\n    let reverseText = '';\n    const isMultiselect = this.settings.multiple === true;\n    let moveSelected = `${this.settings.moveSelected}`;\n    const showSelectAll = this.settings.showSelectAll === true;\n\n    if (this.element[0].classList.contains('text-align-reverse')) {\n      reverseText = ' text-align-reverse';\n    } else if (this.element[0].classList.contains('text-align-center')) {\n      reverseText = ' text-align-center';\n    }\n\n    if (!listExists) {\n      listContents = `<div class=\"dropdown-list${reverseText}${isMobile ? ' mobile' : ''}${this.settings.multiple ? ' multiple' : ''}\" id=\"dropdown-list\" ${this.settings.multiple ? 'aria-multiselectable=\"true\"' : ''}>\n        <label for=\"dropdown-search\" class=\"audible\">${Locale.translate('TypeToFilter')}</label>\n        <input type=\"text\" class=\"dropdown-search${reverseText}\" id=\"dropdown-search\">\n        <span class=\"trigger\">${isMobile ? $.createIcon({ icon: 'close', classes: ['close'] }) : $.createIcon('dropdown')}<span class=\"audible\">${isMobile ? Locale.translate('Close') : Locale.translate('Collapse')}</span></span>\n        <ul role=\"listbox\">`;\n    }\n\n    // Get a current list of <option> elements\n    // If none are available, simply return out\n    let opts = this.element.find('option');\n    let groups = this.element.find('optgroup');\n    let selectedFilterMethod = ':selected';\n    const groupsSelectedOpts = [];\n\n    // For typeahead reloading, the <option> tags are not used for determining what's already\n    // selected.  Use the internal storage of selected values instead.\n    if (this.settings.reload === 'typeahead') {\n      selectedFilterMethod = function (i, opt) {\n        if (!self.selectedValues) {\n          return false;\n        }\n        return self.selectedValues.indexOf(opt.value) > -1;\n      };\n    }\n\n    const selectedOpts = opts.filter(selectedFilterMethod);\n\n    // Re-inforce typeahead-reloaded options' `selected` properties\n    if (this.settings.reload === 'typeahead') {\n      selectedOpts.prop('selected', true);\n    }\n\n    function buildLiHeader(textContent) {\n      return `<li role=\"presentation\" class=\"group-label\" focusable=\"false\">\n        ${textContent}\n      </li>`;\n    }\n\n    function buildLiOption(option, index) {\n      let liMarkup = '';\n      let text = option.innerHTML;\n      const attributes = DOM.getAttributes(option);\n      const value = attributes.getNamedItem('value');\n      const title = attributes.getNamedItem('title');\n      const hasTitle = title ? `\" title=\"${title.value}\"` : '';\n      const badge = attributes.getNamedItem('data-badge');\n      const badgeColor = attributes.getNamedItem('data-badge-color');\n      let badgeHtml = '';\n      const isSelected = option.selected ? ' is-selected' : '';\n      const isDisabled = option.disabled ? ' is-disabled' : '';\n      let liCssClasses = option.className ? ` ${option.className.value}` : '';\n      const aCssClasses = liCssClasses.indexOf('clear') > -1 ? ' class=\"clear-selection\"' : '';\n      const tabIndex = ` tabIndex=\"${index && index === 0 ? 0 : -1}\"`;\n      const toExclude = ['data-badge', 'data-badge-color', 'data-val', 'data-icon'];\n      const copiedDataAttrs = ` ${self.getDataAttributes(attributes, toExclude).str}`;\n      const trueValue = (value && 'value' in value ? value.value : text).replace(/\"/g, '/quot/');\n      let iconHtml = '';\n\n      if (self.listIcon.hasIcons && self.listIcon.items[index]) {\n        iconHtml = self.listIcon.items[index].html;\n      }\n\n      if (badge) {\n        badgeHtml = `<span class=\"badge ${badgeColor ? badgeColor.value : 'azure07'}\">${badge.value}</span>`;\n      }\n\n      if (liCssClasses.indexOf('clear') > -1 && text === '') {\n        text = Locale.translate('ClearSelection');\n      }\n\n      // Highlight search term\n      if (term && term.length > 0) {\n        const exp = self.getSearchRegex(term);\n        text = text.replace(exp, '<i>$1</i>').trim();\n      }\n\n      if (self.listIcon.hasIcons &&\n        self.listIcon.items[index] &&\n        self.listIcon.items[index].isSwatch) {\n        liCssClasses += ' is-swatch';\n      }\n\n      liMarkup += `<li class=\"dropdown-option${isSelected}${isDisabled}${liCssClasses}\" ${isSelected ? 'aria-selected=\"true\"' : ''} data-val=\"${trueValue}\" ${copiedDataAttrs}${tabIndex}${hasTitle} role=\"option\">\n        <a id=\"list-option-${index}\" href=\"#\" ${aCssClasses} role=\"option\">${iconHtml}${text}${badgeHtml}</a></li>`;\n\n      return liMarkup;\n    }\n\n    // In multiselect scenarios, shows an option at the top of the list that will\n    // select all available options if checked.\n    if (isMultiselect && showSelectAll) {\n      const allSelected = opts.not('[disabled], .hidden').length === selectedOpts.not('[disabled], .hidden').length;\n\n      ulContents += `<li role=\"presentation\" class=\"dropdown-select-all-list-item${allSelected ? ' is-selected' : ''}\">` +\n        `<a role=\"option\" href=\"#\" id=\"dropdown-select-all-anchor\" class=\"dropdown-select-all-anchor\">${\n          Locale.translate('SelectAll')\n        }</a>` +\n      '</li>';\n    }\n\n    // Move selected options in each group to just underneath their corresponding group headers.\n    if (moveSelected === 'group') {\n      // If no optgroups exist, change to \"all\" and skip this part.\n      if (!groups || !groups.length) {\n        moveSelected = 'all';\n      } else {\n        // Break apart selectedOpts into groups.\n        // These selected items are applied when the header is generated.\n        groups.each((i, g) => {\n          const els = selectedOpts.filter(function () {\n            return $.contains(g, this);\n          });\n          groupsSelectedOpts.push(els);\n        });\n      }\n    }\n\n    // Move all selected options to the top of the list if the setting is true.\n    // Also adds a group heading if other option groups are found in the <select> element.\n    if (moveSelected === 'all') {\n      opts = opts.not(selectedOpts);\n\n      // Show a \"selected\" header if there are selected options\n      if (selectedOpts.length > 0) {\n        ulContents += buildLiHeader(`${Locale.translate('Selected')} ${self.isInlineLabel ? self.inlineLabelText.text() : this.label.text()}`);\n      }\n\n      selectedOpts.each(function (i) {\n        ulContents += buildLiOption(this, i);\n        upTopOpts++;\n      });\n\n      // Only show the \"all\" header beneath the selected options if there\n      // are no other optgroups present\n      if (!hasOptGroups && opts.length > 0) {\n        ulContents += buildLiHeader(`${Locale.translate('All')} ${self.isInlineLabel ? self.inlineLabelText.text() : this.label.text()}`);\n      }\n    }\n\n    opts.each(function (i) {\n      const count = i + upTopOpts;\n      const option = $(this);\n      const parent = option.parent();\n      let optgroupIsNotDrawn;\n      let optgroupIndex;\n\n      // Add Group Header if this is an <optgroup>\n      // Remove the group header from the queue.\n      if (parent.is('optgroup') && groups.length) {\n        optgroupIndex = parent.index();\n        optgroupIsNotDrawn = groups.index(parent) > -1;\n\n        if (optgroupIsNotDrawn) {\n          groups = groups.not(parent);\n          ulContents += buildLiHeader(`${parent.attr('label')}`);\n\n          // Add all selected items for this group\n          if (moveSelected === 'group') {\n            groupsSelectedOpts[optgroupIndex].each(function (j) {\n              ulContents += buildLiOption(this, j);\n              upTopOpts++;\n            });\n          }\n        }\n      }\n\n      if (moveSelected !== 'none' && option.is(':selected')) {\n        return;\n      }\n\n      ulContents += buildLiOption(this, count);\n    });\n\n    // Render the new list contents to the page.\n    // Build the entire thing and set references if this is the first opening.\n    // Otherwise, simply replace the elements inside the <ul>.\n    if (!listExists) {\n      listContents += `${ulContents}</ul>` +\n        '</div>';\n\n      // Append markup to the DOM\n      this.list = $(listContents);\n\n      // Get references\n      this.listUl = this.list.find('ul');\n      this.searchInput = this.list.find('#dropdown-search');\n    } else {\n      this.listUl.html(ulContents);\n    }\n\n    if (this.listIcon.hasIcons) {\n      this.list.addClass('has-icons');\n      this.listIcon.pseudoElemIcon.clone().appendTo(this.list);\n    }\n\n    if (hasOptGroups) {\n      this.listUl.addClass('has-groups');\n    }\n\n    if ($.fn.tooltip) {\n      this.listUl.find('[title]').addClass('has-tooltip').tooltip();\n    }\n\n    this.position();\n\n    if (this.isOpen()) {\n      this.highlightOption(this.listUl.find('li:visible:not(.separator):not(.group-label):not(.is-disabled)').first());\n    }\n  },\n\n  /**\n   * Sets the displayed value of the Pseudo-Element based on currently-selected options.\n   * @private\n   */\n  setDisplayedValues() {\n    const opts = this.element.find('option:selected');\n    let text = this.getOptionText(opts);\n\n    if (opts.hasClass('clear')) {\n      text = '';\n    }\n\n    if (this.settings.empty && opts.length === 0) {\n      this.pseudoElem.find('span').html(`<span class=\"audible\">${this.label.text()} </span>`);\n      return;\n    }\n\n    // Displays the text on the pseudo-element\n    const maxlength = this.element.attr('maxlength');\n    if (maxlength) {\n      text = text.substr(0, maxlength);\n    }\n    text = text.trim();\n    this.pseudoElem.find('span').html(`<span class=\"audible\">${this.label.text()} </span>${text}`);\n\n    // If there is a placeholder set the selected text\n    if (this.element.attr('placeholder')) {\n      this.pseudoElem.find('span').not('.audible').attr('data-selected-text', text);\n    }\n\n    // Set the \"previousActiveDescendant\" to the first of the items\n    this.previousActiveDescendant = opts.first().val();\n\n    this.updateItemIcon(opts);\n    this.setBadge(opts);\n  },\n\n  /**\n   * Copy classes from the two objects\n   * @private\n   * @param  {object} from The from element\n   * @param  {object} to  The to element\n   * @param  {string} prop The property to set\n   */\n  copyClass(from, to, prop) {\n    if (from.hasClass(prop)) {\n      to.addClass(prop);\n    }\n  },\n\n  /**\n   * Copy initial stuff from the drop down to the pseudo element.\n   * @private\n   */\n  setInitial() {\n    if (this.element.is(':disabled')) {\n      this.disable();\n    }\n    if (this.element.is('[readonly]')) {\n      this.readonly();\n    }\n    if (this.isHidden) {\n      this.pseudoElem.hide().prev('label').hide();\n      this.pseudoElem.next('svg').hide();\n    }\n\n    // set placeholder text on pseudoElem span element\n    if (this.element.attr('placeholder')) {\n      this.pseudoElem.find('span').not('.audible').attr('data-placeholder-text', this.element.attr('placeholder'));\n      this.pseudoElem.find('span').not('.audible').attr('data-selected-text', '');\n    }\n  },\n\n  /**\n   * Figure out which keys to ignore on typehead.\n   * @private\n   * @param  {element} input The input element.\n   * @param  {object} e  The event.\n   * @returns {boolean} False if the key should be ignored.\n   */\n  ignoreKeys(input, e) {\n    const charCode = e.which;\n\n    // Needed for browsers that use keypress events to manipulate the window.\n    if (e.altKey && (charCode === 38)) {\n      e.stopPropagation();\n      e.preventDefault();\n      return false;\n    }\n\n    if (input.is(':disabled') || input.hasClass('is-readonly')) {\n      return; // eslint-disable-line\n    }\n\n    if (e.ctrlKey) {\n      if (this.settings.onKeyDown) {\n        const ret = this.settings.onKeyDown(e);\n        if (ret === false) {\n          e.stopPropagation();\n          e.preventDefault();\n          return false;\n        }\n      }\n    }\n\n    return true;\n  },\n\n  /**\n   * Handle events while search is focus'd\n   * @private\n   * @returns {void}\n   */\n  handleSearchEvents() {\n    if (this.settings.noSearch) {\n      this.searchInput.prop('readonly', true);\n    }\n\n    // Used to determine how spacebar should function.\n    // False means space will select/deselect.  True means\n    // Space will add a space inside the search input.\n    if (!this.filterTerm) {\n      this.searchKeyMode = false;\n    }\n\n    this.searchInput\n      .on(`keydown.${COMPONENT_NAME}`, (e) => {\n        const searchInput = $(this);\n        if (!this.ignoreKeys(searchInput, e)) {\n          return false;\n        }\n\n        return this.handleKeyDown(searchInput, e);\n      })\n      .on(`input.${COMPONENT_NAME}`, (e) => {\n        this.isFiltering = true;\n        this.handleAutoComplete(e);\n      });\n  },\n\n  /**\n   * Filter the list elements by term.\n   * @private\n   * @param  {string} term The search term\n   */\n  filterList(term) {\n    let typeahead = false;\n    // 'typeahead' reloading skips client-side filtering in favor of server-side\n    if (this.settings.source && this.settings.reload === 'typeahead') {\n      typeahead = true;\n      this.callSource();\n    }\n\n    const self = this;\n    let selected = false;\n    const list = $('.dropdown-option', this.listUl);\n    const headers = $('.group-label', this.listUl);\n    let hasIcons = false;\n    let results;\n\n    if (!list.length || !this.list || this.list && !this.list.length) {\n      return;\n    }\n\n    if (!term) {\n      term = '';\n    }\n\n    if (!typeahead && term && term.length) {\n      results = this.listfilter.filter(list, term);\n    } else {\n      results = list;\n    }\n\n    this.list.addClass('search-mode');\n    this.list.find('.trigger').find('.icon').attr('class', 'icon search').changeIcon('search');\n    this.searchInput.removeAttr('aria-activedescendant');\n\n    this.unhighlightOptions();\n\n    if (!results || !results.length && !term) {\n      this.resetList();\n      return;\n    }\n\n    results.removeClass('hidden');\n    list.not(results).add(headers).addClass('hidden');\n    list.filter(results).each(function (i) {\n      const li = $(this);\n      li.attr('tabindex', i === 0 ? '0' : '-1');\n\n      if (!selected) {\n        self.highlightOption(li);\n        selected = true;\n      }\n\n      // Highlight Term\n      const exp = self.getSearchRegex(term);\n      const text = li.text().replace(exp, '<span class=\"dropdown-highlight\">$1</span>').trim();\n      const icon = li.children('a').find('svg').length !== 0 ? new XMLSerializer().serializeToString(li.children('a').find('svg')[0]) : '';\n\n      if (icon) {\n        hasIcons = true;\n      }\n\n      li.children('a').html(icon + text);\n    });\n\n    headers.each(function () {\n      const children = $(this).nextUntil('.group-label, .selector').not('.hidden');\n      if (self.settings.showEmptyGroupHeaders || children.length) {\n        $(this).removeClass('hidden');\n      }\n    });\n\n    term = '';\n    this.position();\n\n    if (hasIcons && this.list.find('svg').length > 2) {\n      this.list.find('svg').last().changeIcon('icon-empty-circle');\n    }\n  },\n\n  /**\n   * Removes filtering from an open Dropdown list and turns off \"search mode\"\n   * @private\n   */\n  resetList() {\n    // 'typeahead' reloading skips client-side filtering in favor of server-side\n    if (this.settings.source && this.settings.reload === 'typeahead') {\n      this.filterTerm = '';\n      this.searchKeyMode = false;\n      this.callSource(null, true);\n      return;\n    }\n\n    if (!this.list || this.list && !this.list.length) {\n      return;\n    }\n\n    this.list.removeClass('search-mode');\n    const lis = this.listUl.find('li');\n    let hasIcons = false;\n    lis.removeAttr('style').each(function () {\n      const a = $(this).children('a');\n      const li = $(this);\n\n      const text = a.text();\n      const icon = li.children('a').find('svg').length !== 0 ? new XMLSerializer().serializeToString(li.children('a').find('svg')[0]) : '';\n\n      if (icon) {\n        hasIcons = true;\n      }\n\n      a.html(icon + text);\n    });\n\n    // Adjust height / top position\n    if (this.list.hasClass('is-ontop')) {\n      this.list[0].style.top = `${this.pseudoElem.offset().top - this.list.height() + this.pseudoElem.outerHeight() - 2}px`;\n    }\n\n    if (this.settings.multiple) {\n      this.updateList();\n    }\n\n    lis.removeClass('hidden');\n    this.position();\n\n    if (hasIcons && this.list.find('svg').length > 2) {\n      this.list.find('svg').last().changeIcon('icon-empty-circle');\n    }\n\n    if (this.list.find('svg').length === 2) {\n      this.list.find('svg').last().remove();\n    }\n  },\n\n  /**\n   * Select the blank item (if present)\n   * @private\n   */\n  selectBlank() {\n    const blank = this.element.find('option').filter(function () {\n      return !this.value || $.trim(this.value).length === 0;\n    });\n\n    if (!blank.length) {\n      return;\n    }\n\n    // TODO: Refactor this in v4.9.0 to call `selectOption` instead.  Can't currently\n    // do that because `selectOption` depends on the list being open.\n    blank[0].selected = true;\n    blank[0].setAttribute('selected', true);\n    this.element.triggerHandler('updated');\n    this.element.triggerHandler('change');\n  },\n\n  /**\n   * Handle the key down event actions.\n   * @private\n   * @param  {object} input The dom element.\n   * @param  {object} e The event element.\n   * @returns {boolean} Returns the event in some situations.\n   */\n  handleKeyDown(input, e) {\n    let selectedIndex = this.element[0].selectedIndex || -1;\n    let options = this.element[0].options;\n    const key = e.which;\n    const self = this;\n    const excludes = 'li:visible:not(.separator):not(.group-label):not(.is-disabled)';\n    let next;\n\n    if (this.isLoading()) {\n      return;\n    }\n\n    if (self.settings.onKeyDown) {\n      const ret = self.settings.onKeyDown(e);\n      if (ret === false) {\n        e.stopPropagation();\n        e.preventDefault();\n        return false; //eslint-disable-line\n      }\n    }\n\n    if (self.isOpen()) {\n      options = this.listUl.find(excludes);\n      selectedIndex = -1;\n      $(options).each(function (index) {\n        if ($(this).is('.is-focused')) {\n          selectedIndex = index;\n        }\n      });\n    }\n\n    switch (key) {  //eslint-disable-line\n      case 37: // backspace\n      case 8: // del & backspace\n      case 46: { // del\n        if (!self.isOpen()) {\n          self.selectBlank();\n          // Prevent Backspace from returning to the previous page.\n          e.stopPropagation();\n          e.preventDefault();\n          return false;  //eslint-disable-line\n        }\n        break;\n      }\n      case 9: { // tab - save the current selection\n        // If \"search mode\" is currently off, Tab should turn this mode on and place focus back\n        // into the SearchInput.\n        // If search mode is on, Tab should 'select' the currently highlighted\n        // option in the list, update the SearchInput and close the list.\n        if (self.isOpen()) {\n          self.closeList('tab');\n          this.activate();\n        }\n        // allow tab to propagate otherwise\n        return true;   //eslint-disable-line\n      }\n      case 27: { // Esc - Close the Combo and Do not change value\n        if (self.isOpen()) {\n          // Close the option list\n          self.element.closest('.modal.is-visible').data('listclosed', true);\n          const tdContainer = self.pseudoElem ? self.pseudoElem.parents('td') : null;\n          self.closeList('cancel');\n          self.activate();\n\n          if (tdContainer) {\n            tdContainer.focus();\n          }\n\n          e.stopPropagation();\n          return false;  //eslint-disable-line\n        }\n        // Allow Esc to propagate if the menu was closed, since some other Controls\n        // that rely on dropdown may need to trigger routines when the Esc key is pressed.\n        break;\n      }\n      case 32: // Spacebar\n      case 13: { // enter\n        if (self.isOpen()) {\n          if (key === 32 && self.searchKeyMode === true) {\n            break;\n          }\n\n          e.preventDefault();\n\n          if (options.length && selectedIndex > -1) {\n            self.selectOption($(options[selectedIndex])); // store the current selection\n          }\n\n          if (self.settings.closeOnSelect) {\n            self.closeList('select'); // Close the option list\n            self.activate();\n          }\n        }\n        e.stopPropagation();\n        return false;  //eslint-disable-line\n      }\n      case 38: { // up\n        if (e.shiftKey) {\n          return;\n        }\n        this.searchKeyMode = false;\n\n        if (selectedIndex > 0) {\n          next = $(options[selectedIndex - 1]);\n          this.highlightOption(next);\n          self.setItemIconOverColor(next);\n          // NOTE: Do not also remove the \".is-selected\" class here!\n          // It's not the same as \".is-focused\"!\n          // Talk to ed coyle if you need to know why.\n          next.parent().find('.is-focused').removeClass('is-focused');\n          next.addClass('is-focused');\n        }\n\n        e.stopPropagation();\n        e.preventDefault();\n        return false;  //eslint-disable-line\n      }\n      case 40: { // down\n        if (e.shiftKey) {\n          return;\n        }\n        this.searchKeyMode = false;\n\n        if (selectedIndex < options.length - 1) {\n          next = $(options[selectedIndex + 1]);\n          this.highlightOption(next);\n          self.setItemIconOverColor(next);\n          // NOTE: Do not also remove the \".is-selected\" class here!\n          //  It's not the same as \".is-focused\"!\n          // Talk to ed coyle if you need to know why.\n          next.parent().find('.is-focused').removeClass('is-focused');\n          next.addClass('is-focused');\n        }\n\n        e.stopPropagation();\n        e.preventDefault();\n        return false;  //eslint-disable-line\n      }\n      case 35: { // end\n        this.searchKeyMode = false;\n\n        const last = $(options[options.length - 1]);\n        this.highlightOption(last);\n\n        e.stopPropagation();\n        return false;  //eslint-disable-line\n      }\n      case 36: { // home\n        this.searchKeyMode = false;\n\n        const first = $(options[0]);\n        this.highlightOption(first);\n\n        e.stopPropagation();\n        return false;  //eslint-disable-line\n      }\n    }\n\n    if (!self.isOpen() && !self.isControl(key) &&\n      !this.settings.source && !this.settings.noSearch) {\n      // Make this into Auto Complete\n      self.isFiltering = true;\n      self.filterTerm = $.actualChar(e);\n\n      if (self.searchInput && self.searchInput.length) {\n        self.searchInput.val($.actualChar(e));\n      }\n      self.toggle();\n    }\n\n    this.searchKeyMode = true;\n    if (self.searchInput) {\n      self.searchInput.attr('aria-activedescendant', '');\n    }\n    return true;  // eslint-disable-line\n  },\n\n  /**\n   * @private\n   * @param {jQuery.Event} e incoming keydown event\n   * @returns {boolean} whether or not the keydown event is allowed to continue\n   */\n  handlePseudoElemKeydown(e) {\n    const target = $(e.target);\n    const key = e.key;\n\n    // No need to execute if readonly\n    if (target.is('.is-readonly')) {\n      return true;\n    }\n\n    // \"Esc\" is used by IE11\n    const isEscapeKey = key === 'Esc' || key === 'Escape';\n\n    // Control Keydowns are ignored\n    const controlKeys = ['Alt', 'Shift', 'Control', 'Meta'];\n    if (controlKeys.indexOf(key) > -1) {\n      return false;\n    }\n\n    if (!this.ignoreKeys(target, e)) {\n      return false;\n    }\n\n    if (this.settings.onKeyDown) {\n      const ret = this.settings.onKeyDown(e);\n      if (ret === false) {\n        e.stopPropagation();\n        e.preventDefault();\n        return false; //eslint-disable-line\n      }\n    }\n\n    // Down arrow opens the list.\n    // Down/Up are for IE/Edge.\n    // ArrowDown/ArrowUp are for all others.\n    const openKeys = ['ArrowDown', 'ArrowUp', 'Down', 'Up', 'Enter', 'Spacebar', ' '];\n    if (openKeys.indexOf(key) > -1) {\n      if (!this.isOpen()) {\n        this.open();\n      }\n\n      // TODO: refactor this out so that `handleKeyDown` is no longer necessary.\n      // This is necessary here because in `noSearch` mode, there is no actionable searchInput.\n      if (this.settings.noSearch && !e.ctrlKey) {\n        this.handleKeyDown(target, e);\n      }\n\n      return false;\n    }\n\n    // Mac OSX: \"backspace\" delete key\n    // Everything else: DEL key (numpad, control keys)\n    const isOSX = env.os.name === 'Mac OS X';\n    if ((!isOSX && key === 'Delete') || (isOSX && key === 'Backspace')) {\n      this.selectBlank();\n\n      // Stop the backspace key from navigating back a page\n      if (key === 'Backspace') {\n        e.stopPropagation();\n        e.preventDefault();\n      }\n      return true;\n    }\n\n    if (isEscapeKey || key === 'Tab') {\n      // In nosearch mode, bypass the typeahead autocomplete and pass keydown events\n      // along to the list elements\n      if (this.settings.noSearch && this.isOpen()) {\n        return this.handleKeyDown(target, e);\n      }\n\n      // Allow some keys to pass through with no changes in functionality\n      return true;\n    }\n\n    this.handleAutoComplete(e);\n    return true;\n  },\n\n  /**\n   * Handle the typeahead.\n   * @private\n   * @param {object} e The event object\n   */\n  handleAutoComplete(e) {\n    if (this.isLoading()) {\n      return;\n    }\n\n    const self = this;\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n\n    if (e.type === 'input') {\n      this.filterTerm = this.searchInput.val();\n    } else {\n      this.filterTerm += $.actualChar(e).toLowerCase();\n\n      if (e.key !== this.filterTerm && e.key.toLowerCase() === this.filterTerm\n          && !self.settings.noSearch) {\n        this.filterTerm = e.key;\n      }\n    }\n\n    // if called by `open()`, runs in the context of this Dropdown's API\n    function filter() {\n      if (self.filterTerm === '') {\n        self.resetList();\n      } else {\n        self.filterList(self.filterTerm.toLowerCase());\n      }\n    }\n\n    this.timer = setTimeout(() => {\n      if (self.settings.noSearch) {\n        self.selectStartsWith(self.filterTerm);\n        return;\n      }\n\n      this.searchKeyMode = true;\n      if (!self.isOpen()) {\n        self.open(filter);\n        return;\n      }\n\n      filter();\n    }, self.settings.delay);\n  },\n\n  /**\n   * Determine if the key is a control key\n   * @private\n   * @param  {number} keycode The keycode to check.\n   * @returns {boolean} true if the key is a control key.\n   */\n  isControl(keycode) {\n    const valid =\n      (keycode > 7 && keycode < 48) || // control chars\n      (keycode > 90 && keycode < 94) || // windows keys\n      (keycode > 111 && keycode < 146); // function keys\n\n    return valid;\n  },\n\n  /**\n   * Focus the input element. Since the select is hidden this is needed over normal focus()\n   * @private\n   * @param  {boolean} [useSearchInput] If true the search is used.\n   * @returns {void}\n   */\n  activate(useSearchInput) {\n    const self = this;\n    let input = this.pseudoElem;\n\n    if (useSearchInput || self.isMobile()) {\n      input = this.searchInput;\n    }\n\n    if (useSearchInput && (input.hasClass('is-readonly') || input.prop('readonly') === true)) {\n      return;\n    }\n\n    function selectText() {\n      if (self.isMobile() || self.filterTerm) {\n        return;\n      }\n\n      if (input[0].setSelectionRange) {\n        input[0].setSelectionRange(0, input[0].value.length); // scroll to left\n      } else if (input[0].tagName === 'INPUT') { // using Search Input instead of Pseudo Div\n        input[0].select();\n      }\n    }\n\n    selectText();\n\n    // Set focus back to the element\n    input[0].focus();\n  },\n\n  /**\n   * @private\n   * @param {string} term incoming search term\n   * @returns {RegExp} a valid regex object used to filter search results\n   */\n  getSearchRegex(term) {\n    let regex;\n\n    try {\n      regex = new RegExp(`(${term})`, 'i');\n    } catch (e) {\n      // create a \"matches all\" regex if we can't create a regex from the search term\n      regex = /[\\s\\S]*/i;\n    }\n\n    return regex;\n  },\n\n  /**\n   * Retrieves a string containing all text for currently selected options.\n   * @private\n   * @param  {array} opts The current option elements.\n   * @returns {string} The selection options in a string  delimited by commas.\n   */\n  getOptionText(opts) {\n    let text = '';\n\n    if (!opts) {\n      opts = this.element.find('option:selected');\n    }\n\n    opts.each(function () {\n      if (text.length > 0) {\n        text += ', ';\n      }\n      text += $(this).text().trim();\n    });\n\n    return text;\n  },\n\n  /**\n   * Open the dropdown list of options\n   * @param {function} callback additional items that can be run after the opening process completes\n   * @returns {void}\n   */\n  open(callback) {\n    const self = this;\n\n    if (!this.inputTimer()) {\n      return;\n    }\n\n    if (this.element.is(':disabled') || this.pseudoElem.hasClass('is-disabled') || this.pseudoElem.hasClass('is-readonly')) {\n      return;\n    }\n\n    function completeOpen() {\n      if (self.isMobile()) {\n        $('.tooltip:not(.is-hidden)').hide();\n      }\n\n      self.updateList();\n      self.openList();\n\n      if (callback && typeof callback === 'function') {\n        callback.call(this);\n      }\n    }\n\n    if (!self.callSource(completeOpen)) {\n      completeOpen();\n    }\n  },\n\n  /**\n   * Popup the list of options for selection.\n   * @private\n   */\n  openList() {\n    const current = this.previousActiveDescendant ?\n      this.list.find(`.dropdown-option[data-val=\"${this.previousActiveDescendant.replace(/\"/g, '/quot/')}\"]`) :\n      this.list.find('.is-selected');\n    const self = this;\n    const threshold = 10;\n    let isEmpty = true;\n    let pos;\n\n    this.touchPrevented = false;\n\n    if (current.length > 0) {\n      isEmpty = true;\n    }\n\n    if (env.os.name === 'ios') {\n      $('head').triggerHandler('disable-zoom');\n    }\n\n    // Close any other drop downs.\n    $('select').each(function () {\n      const data = $(this).data();\n      if (data.dropdown) {\n        data.dropdown.closeList('cancel');\n      }\n    });\n\n    // Close any open popup menus\n    const otherMenus = $('.popupmenu.is-open').filter(function () {\n      return $(this).parents('.popupmenu').length === 0;\n    }); // close others.\n\n    otherMenus.each(function () {\n      const trigger = $(this).data('trigger');\n      if (!trigger || !trigger.length) {\n        return;\n      }\n\n      const api = $(this).data('trigger').data('popupmenu');\n      if (api && typeof api.close === 'function') {\n        api.close();\n      }\n    });\n\n    if (!this.isOpen()) {\n      this.list.appendTo('body');\n    }\n    this.list.show();\n\n    // Persist the \"short\" input field\n    const isShort = (this.element.closest('.field-short').length === 1);\n\n    this.list.addClass(isShort ? 'dropdown-short' : '');\n\n    this.pseudoElem\n      .attr('aria-expanded', 'true')\n      .addClass('is-open');\n\n    this.searchInput.attr('aria-activedescendant', current.children('a').attr('id'));\n\n    // In a grid cell\n    this.isInGrid = this.pseudoElem.closest('.datagrid-row').length === 1;\n    if (this.pseudoElem.parent().hasClass('is-inline')) {\n      this.isInGrid = false;\n    }\n\n    if (this.isInGrid) {\n      const rowHeight = this.pseudoElem.closest('.datagrid').attr('class').replace('datagrid', '');\n      this.list.addClass(`datagrid-dropdown-list ${rowHeight}`);\n    }\n\n    if (this.pseudoElem.closest('.datagrid-filter-wrapper').length === 1) {\n      this.list.addClass('datagrid-filter-dropdown');\n    }\n\n    const cssClass = this.settings.cssClass;\n    if (cssClass && typeof cssClass === 'string') {\n      this.list.addClass(cssClass);\n    }\n\n    this.position();\n\n    // Limit the width\n    if (this.settings.maxWidth) {\n      this.list.css('max-width', `${this.settings.maxWidth}px`);\n    }\n\n    // Set the contents of the search input.\n    // If we've got a stored typeahead\n    if (this.filterTerm) {\n      this.searchInput.val(this.filterTerm);\n    } else {\n      const fieldValue = this.pseudoElem.find('span:not(.audible)')\n        .contents()\n        .eq(1)\n        .text()\n        .trim();\n      this.searchInput.val(fieldValue);\n      if (this.element.attr('placeholder')) {\n        this.pseudoElem.find('span').not('.audible').attr('data-selected-text', '');\n      }\n    }\n\n    const noScroll = this.settings.multiple;\n    this.highlightOption(current, noScroll);\n    if (this.settings.multiple && this.listUl.find('.is-selected').length > 0) {\n      this.highlightOption(this.listUl.find('.dropdown-option').eq(0));\n      setTimeout(() => {\n        self.listUl.scrollTop(0);\n      }, 0);\n    }\n\n    if (!this.settings.multiple && !isEmpty) {\n      this.searchInput.val(current.find('a').text());\n    }\n\n    this.handleSearchEvents();\n    this.activate(true); // Focus the Search Input\n\n    /**\n    *  Fires as the dropdown list is opened.\n    *\n    * @event listopened\n    * @memberof Dropdown\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n    this.element.trigger('listopened');\n\n    if (this.isMobile()) {\n      // iOS-specific keypress event that listens for when you click the \"done\" button\n      self.searchInput.on('keypress.dropdown', (e) => {\n        if (e.which === 13) {\n          self.closeList('select');\n        }\n      });\n    }\n\n    self.list\n      .removeClass('dropdown-tall')\n      .on('touchend.list click.list', 'li', function (e) {\n        if (self.touchPrevented) {\n          return;\n        }\n\n        const itemSelected = self.selectListItem($(this));\n        e.preventDefault();\n        if (!itemSelected) {\n          return;\n        }\n        e.stopPropagation();\n      })\n      .on('mouseenter.list', 'li', function () {\n        self.highlightOption($(this), true);\n      });\n\n    // Some list-closing events are on a timer to prevent immediate list close\n    // There would be several things to check with a setTimeout, so this is done with a CSS\n    // class to keep things a bit cleaner\n    setTimeout(() => {\n      self.list.addClass('is-closable');\n    }, 100);\n\n    // Is the jQuery Element a component of the current Dropdown list?\n    function isDropdownElement(target) {\n      return target.closest('.dropdown, .multiselect').length > 0 ||\n        target.closest('.dropdown-list').length > 0 ||\n        self.touchmove === true;\n    }\n\n    // Triggered when the user scrolls the page.\n    // Ignores Scrolling on Mobile, and will not close the list if accessing an item within the list\n    function scrollDocument(e) {\n      const focus = $('*:focus'); // dont close on timepicker arrow down and up\n      if (self.touchPrevented || isDropdownElement($(e.target)) || focus.is('.timepicker')) {\n        self.touchPrevented = false;\n        return;\n      }\n      self.closeList('cancel');\n    }\n\n    // Triggered when the user clicks anywhere in the document\n    // Will not close the list if the clicked target is anywhere inside the dropdown list.\n\n    function clickDocument(e) {\n      const target = $(e.target);\n      if (self.touchPrevented || (isDropdownElement(target) && !target.is('.icon'))) {\n        e.preventDefault();\n\n        self.touchPrevented = false;\n        return;\n      }\n\n      self.closeList('cancel');\n    }\n\n    function touchStartCallback(e) {\n      self.touchPrevented = false;\n\n      pos = {\n        x: e.originalEvent.touches[0].pageX,\n        y: e.originalEvent.touches[0].pageY\n      };\n\n      $(document).on('touchmove.dropdown', (evt) => {\n        const newPos = {\n          x: evt.originalEvent.touches[0].pageX,\n          y: evt.originalEvent.touches[0].pageY\n        };\n\n        if ((newPos.x >= pos.x + threshold) || (newPos.x <= pos.x - threshold) ||\n            (newPos.y >= pos.y + threshold) || (newPos.y <= pos.y - threshold)) {\n          self.touchPrevented = true;\n        }\n      });\n    }\n\n    function touchEndCallback(e) {  //eslint-disable-line\n      $(document).off('touchmove.dropdown');\n      e.preventDefault();\n\n      if (self.touchPrevented) {\n        e.stopPropagation();\n        return false;\n      }\n\n      clickDocument(e);\n    }\n\n    // Need to detect whether or not scrolling is happening on a touch-capable device\n    // The dropdown list should not close on mobile if scrolling is occuring, but should close\n    // if the user is simply tapping outside the list.\n    $(document)\n      .on('touchstart.dropdown', touchStartCallback)\n      .on('touchend.dropdown touchcancel.dropdown', touchEndCallback)\n      .on('click.dropdown', clickDocument);\n\n    const modalScroll = $('.modal.is-visible .modal-body-wrapper');\n    let parentScroll = self.element.closest('.scrollable').length ? self.element.closest('.scrollable') : $(document);\n    parentScroll = self.element.closest('.scrollable-y').length ? self.element.closest('.scrollable-y') : parentScroll;\n    parentScroll = modalScroll.length ? modalScroll : parentScroll;\n    parentScroll.on('scroll.dropdown', scrollDocument);\n\n    $('body').on('resize.dropdown', () => {\n      self.position();\n\n      // in desktop environments, close the list on viewport resize\n      if (window.orientation === undefined) {\n        self.closeList('cancel');\n      }\n    });\n\n    // In mobile environments, close the list on an orientation change.\n    // Don't do this on mobile against a resize because of the software keyboard's potential\n    // to cause a \"resize\" event to fire.\n    if (window.orientation !== undefined) {\n      $(window).on('orientationchange.dropdown', () => {\n        self.closeList('cancel');\n      });\n    }\n\n    if (env.os.name === 'ios') {\n      $('head').triggerHandler('enable-zoom');\n    }\n  },\n\n  /**\n   * Set size and positioning of the list\n   * @private\n   */\n  position() {\n    const self = this;\n    const positionOpts = {\n      parentXAlignment: 'left',\n      placement: 'bottom',\n      strategies: ['flip', 'shrink-y']\n    };\n\n    function dropdownAfterPlaceCallback(e, placementObj) {\n      // Turn upside-down if flipped to the top of the pseudoElem\n      if (placementObj.wasFlipped === true) {\n        self.list.addClass('is-ontop');\n        self.listUl.prependTo(self.list);\n      }\n\n      // Set the <UL> height to 100% of the `.dropdown-list` minus the size of the search input\n      const ulHeight = parseInt(self.listUl[0].offsetHeight, 10);\n      const listHeight = parseInt(self.list[0].offsetHeight, 10) + 5;\n      const searchInputHeight = $(this).hasClass('dropdown-short') ? 24 : 34;\n      const isToBottom = parseInt(self.list[0].offsetTop, 10) +\n        parseInt(self.list[0].offsetHeight, 10) >= window.innerHeight;\n      const isSmaller = (searchInputHeight < listHeight - (searchInputHeight * 2))\n        && (ulHeight + searchInputHeight >= listHeight);\n\n      if (isSmaller && !isToBottom) {\n        self.listUl[0].style.height = `${listHeight - (searchInputHeight * 2)}px`;\n      }\n\n      if (isSmaller && isToBottom) {\n        self.listUl[0].style.height = `${listHeight - (searchInputHeight * 2)}px`;\n        self.list[0].style.height = `${parseInt(self.list[0].style.height, 10) - 10}px`;\n      }\n\n      if (placementObj.wasFlipped) {\n        self.listUl[0].style.height = `${parseInt(self.listUl[0].style.height, 10) + (searchInputHeight - 5)}px`;\n      }\n\n      return placementObj;\n    }\n\n    // Reset styles that may have been appended to the list\n    this.list[0].removeAttribute('style');\n    this.listUl[0].removeAttribute('style');\n\n    let parentElement = this.pseudoElem;\n    if (this.isInGrid) {\n      parentElement = this.element.closest('.datagrid-cell-wrapper');\n    }\n\n    // If the list would end up being wider parent,\n    // use the list's width instead of the parent's width\n    const parentElementStyle = window.getComputedStyle(parentElement[0]);\n    const parentElementBorderWidth = parseInt(parentElementStyle.borderLeftWidth, 10) * 2;\n    const parentElementWidth = Math.round(parseInt(parentElement[0].clientWidth, 10) +\n      parentElementBorderWidth);\n\n    // Temporarily shrink the value of the search input, and compare the size of the list to\n    // the parent element.\n    this.searchInput[0].style.cssText = `width: ${parentElementWidth}px !important`;\n    const listDefaultWidth = Math.round(this.list.width());\n    const useParentWidth = listDefaultWidth <= parentElementWidth;\n    this.searchInput[0].style.width = '';\n\n    // Add parent info to positionOpts\n    positionOpts.parent = parentElement;\n    positionOpts.useParentWidth = useParentWidth;\n\n    // use negative height of the pseudoElem to get the Dropdown list to overlap the input.\n    const isRetina = window.devicePixelRatio > 1;\n    const isChrome = env.browser.name === 'chrome';\n\n    positionOpts.y = -(parseInt(parentElement[0].clientHeight, 10) +\n      parseInt(parentElementStyle.borderTopWidth, 10) +\n      parseInt(parentElementStyle.borderBottomWidth, 10) - (!isChrome && isRetina ? 1 : 0));\n    positionOpts.x = 0;\n    if (self.settings.placementOpts && self.settings.placementOpts.x) {\n      positionOpts.x = self.settings.placementOpts.x;\n    }\n\n    this.list.one('afterplace.dropdown', dropdownAfterPlaceCallback).place(positionOpts);\n    this.list.data('place').place(positionOpts);\n  },\n\n  /**\n   * @param {jQuery[]} target a jQuery-wrapped <option> or <li> tag representing an option.\n   * @returns {boolean} whether or not the item was successfully selected.\n   */\n  selectListItem(target) {\n    const ddOption = target.closest('li');\n\n    if (ddOption.length) {\n      target = ddOption;\n    }\n\n    if (target.is('.separator, .group-label')) {\n      return false;\n    }\n\n    if (target.is('.dropdown-select-all-anchor')) {\n      target = target.parent();\n    }\n\n    // If this is the Select All option, select/deselect all.\n    if (this.settings.multiple && target[0].classList.contains('dropdown-select-all-list-item')) {\n      const doSelectAll = !(target[0].classList.contains('is-selected'));\n      target[0].classList[doSelectAll ? 'add' : 'remove']('is-selected');\n      if (doSelectAll) {\n        target[0].setAttribute('aria-selected', 'true');\n      } else {\n        target[0].removeAttribute('aria-selected');\n      }\n      this.selectAll(doSelectAll);\n      return true;  //eslint-disable-line\n    }\n\n    const val = target.attr('data-val').replace(/\"/g, '/quot/');\n    let cur = this.element.find(`option[value=\"${val}\"]`);\n    // Try matching the option's text if 'cur' comes back empty or overpopulated.\n    // Supports options that don't have a 'value' attribute\n    // And also some special &quote handling\n    if (cur.length === 0 || cur.length > 1) {\n      cur = this.element.find('option').filter(function () {\n        const elem = $(this);\n        const attr = elem.attr('value');\n        return elem.text() === val || (attr && attr.replace(/\"/g, '/quot/') === val);\n      });\n    }\n\n    if (cur.is(':disabled')) {\n      return false; //eslint-disable-line\n    }\n\n    this.selectOption(cur);\n\n    if (this.settings.closeOnSelect) {\n      this.closeList('select');\n    }\n\n    if (this.isMobile()) {\n      return true;  //eslint-disable-line\n    }\n\n    this.activate(!this.settings.closeOnSelect);\n\n    // Check/uncheck select all depending on no. of selected items\n    if (this.settings.showSelectAll && this.list) {\n      const opts = this.element.find('option');\n      const selectedOpts = opts.filter(':selected');\n\n      if (opts.length > selectedOpts.length) {\n        this.list.find('.dropdown-select-all-list-item').removeClass('is-selected').removeAttr('aria-selected');\n      } else {\n        this.list.find('.dropdown-select-all-list-item').addClass('is-selected').attr('aria-selected', 'true');\n      }\n    }\n\n    return true;  //eslint-disable-line\n  },\n\n  /**\n  * Close the list of options if open.\n  * @returns {void}\n  */\n  close() {\n    return this.closeList('cancel'); // See \"js/lifecycle.js\"\n  },\n\n  /**\n   * Close the list of options if open.\n   * @private\n   * @param  {string} [action] The action that trigger the closing (cancel fx) this\n   * is passed to the events.\n   * @returns {void}\n   */\n  closeList(action) {\n    //  Also see \"js/lifecycle.js\" alias that works with the global \"closeChildren\" method.\n    if (!this.list || !this.list.is(':visible') || !this.isListClosable()) {\n      return;\n    }\n\n    if (!this.inputTimer()) {\n      return;\n    }\n\n    if (this.touchmove) {\n      this.touchmove = false;\n    }\n\n    // Rendering-related resets\n    this.filterTerm = '';\n    this.searchKeyMode = false;\n    this.setDisplayedValues();\n\n    this.searchInput.off([\n      `input.${COMPONENT_NAME}`,\n      `keydown.${COMPONENT_NAME}`,\n    ].join(' '));\n\n    // Destroy any tooltip items\n    this.listUl.find('.has-tooltip').each(function () {\n      const api = $(this).data('tooltip');\n      if (api) {\n        api.destroy();\n      }\n    });\n\n    this.list\n      .off([\n        `click.${COMPONENT_NAME}`,\n        `touchmove.${COMPONENT_NAME}`,\n        `touchend.${COMPONENT_NAME}`,\n        `touchcancel.${COMPONENT_NAME}`,\n        `mousewheel.${COMPONENT_NAME}`,\n        `mouseenter.${COMPONENT_NAME}`].join(' '))\n      .remove();\n\n    this.pseudoElem\n      .removeClass('is-open')\n      .removeAttr('aria-expanded');\n\n    this.searchInput\n      .removeAttr('aria-activedescendant');\n\n    $(document)\n      .off([\n        `click.${COMPONENT_NAME}`,\n        `scroll.${COMPONENT_NAME}`,\n        `touchmove.${COMPONENT_NAME}`,\n        `touchend.${COMPONENT_NAME}`,\n        `touchcancel.${COMPONENT_NAME}`].join(' '));\n\n    $('body').off('resize.dropdown');\n    $(window).off('orientationchange.dropdown');\n\n    /**\n    * Fires as the dropdown list is closed\n    *\n    * @event listclosed\n    * @memberof Dropdown\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n    this.element.trigger('listclosed', action);\n    this.activate();\n    this.toggleTooltip();\n    this.list = null;\n    this.searchInput = null;\n    this.listUl = null;\n  },\n\n  /**\n  * Scroll to a particular option and make it in view.\n  * @private\n  * @param  {object} current The option element to scroll to.\n  * @returns {void}\n  */\n  scrollToOption(current) {\n    const self = this;\n    if (!current) {\n      return;\n    }\n    if (current.length === 0) {\n      return;\n    }\n    // scroll to the currently selected option\n    self.listUl.scrollTop(0);\n    self.listUl.scrollTop(current.offset().top - self.listUl.offset().top -\n      self.listUl.scrollTop() - 40);\n  },\n\n  /**\n  * Blur and Close List\n  * @private\n  * @returns {void}\n  */\n  handleBlur() {\n    const self = this;\n    self.closeList('cancel');\n\n    return true;\n  },\n\n  /*\n  * Function that is used to chekc if the field is loading from an ajax call.\n  * @returns {void} Returns true if the field is attempting to load via AJAX.\n  */\n  isLoading() {\n    return this.element.is('.is-loading') && this.element.is('.is-blocked');\n  },\n\n  /**\n   * Return true/false depending on if the list is open.\n   * @returns {boolean} The current state (open = true).\n   */\n  isOpen() {\n    return !!(this.pseudoElem.hasClass('is-open'));\n  },\n\n  /**\n   * Toggle the current state of the list between open and closed.\n   * @private\n   */\n  toggle() {\n    if (this.isOpen() || this.isLoading()) {\n      this.closeList('cancel');\n      return;\n    }\n    this.open();\n  },\n\n  /**\n   * Toggle the current state of the list between open and closed.\n   * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n   * @deprecated as of v4.4.0.  Please use `toggle()` instead.\n   * @private\n   * @returns {void}\n   */\n  toggleList() {\n    return deprecateMethod(this.toggle, this.toggleList).apply(this);\n  },\n\n  /**\n   * Highlight the option that is being typed.\n   * @private\n   * @param {object} listOption The option element\n   * @param {boolean} noScroll If true will scroll to the option\n   */\n  highlightOption(listOption, noScroll) { //eslint-disable-line\n    if (!listOption) {\n      return;\n    }\n\n    if (listOption.length === 0) {\n      listOption = this.list.find('.dropdown-option').eq(0);\n    }\n\n    if (listOption.is('.separator, .group-label')) {\n      return;\n    }\n\n    // Get corresponding option from the list\n    const option = this.element.find(`option[value=\"${listOption.attr('data-val')}\"]`);\n\n    if (option.hasClass('.is-disabled') || option.is(':disabled')) {\n      return; //eslint-disable-line\n    }\n\n    if (!this.isOpen()) {\n      return;\n    }\n\n    this.setItemIconOverColor();\n    this.list.find('.is-focused').removeClass('is-focused').attr({ tabindex: '-1' });\n    if (!option.hasClass('clear')) {\n      this.setItemIconOverColor(listOption);\n      listOption.addClass('is-focused').attr({ tabindex: '0' });\n    }\n\n    // Set activedescendent for new option\n    // this.pseudoElem.attr('aria-activedescendant', listOption.attr('id'));\n    this.searchInput.attr('aria-activedescendant', listOption.children('a').attr('id'));\n\n    if (!noScroll || noScroll === false || noScroll === undefined) {\n      this.scrollToOption(listOption);\n    }\n  },\n\n  /**\n   * Un Highlight the option that is being typed.\n   * @private\n   * @param  {object} listOptions The option element\n   * @param  {boolean} noScroll If true will scroll to the option\n   */\n  unhighlightOptions(listOptions, noScroll) {\n    if (!listOptions || !listOptions.length) {\n      listOptions = this.list.find('.is-selected');\n    }\n    this.setItemIconOverColor();\n    listOptions.removeClass('is-focused').attr({ tabindex: '-1' });\n\n    this.searchInput.removeAttr('aria-activedescendant');\n\n    if (!noScroll || noScroll === false || noScroll === undefined) {\n      this.scrollToOption(listOptions.first());\n    }\n  },\n\n  /**\n   * Toggle all selection for items.\n   * @private\n   * @param {boolean} doSelectAll true to select and false will clear selection for all items.\n   * @returns {void}\n   */\n  selectAll(doSelectAll) {\n    const selector = {\n      options: 'option:not(.is-disabled):not(:disabled)',\n      items: 'li.dropdown-option:not(.separator):not(.group-label):not(.is-disabled)'\n    };\n    const options = [].slice.call(this.element[0].querySelectorAll(selector.options));\n    const items = [].slice.call(this.listUl[0].querySelectorAll(selector.items));\n    const last = options[options.length - 1];\n    let text = '';\n\n    if (doSelectAll) {\n      // Select all\n      items.forEach((node) => {\n        node.classList.add('is-selected');\n        node.setAttribute('aria-selected', true);\n      });\n      options.forEach((node) => {\n        node.selected = true;\n        node.setAttribute('selected', true);\n      });\n\n      text = this.getOptionText($(options));\n      const maxlength = this.element[0].getAttribute('maxlength');\n      if (maxlength) {\n        text = text.substr(0, maxlength);\n      }\n    } else {\n      // Clear all\n      items.forEach((node) => {\n        node.classList.remove('is-selected');\n        node.removeAttribute('aria-selected');\n      });\n      options.forEach((node) => {\n        // Fix for ie-edge\n        // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12087679/\n        node.selected = false;\n        node.setAttribute('selected', false);\n        node.removeAttribute('selected');\n      });\n    }\n    this.previousActiveDescendant = last.value || '';\n\n    this.pseudoElem[0].querySelector('span').textContent = text;\n    this.searchInput[0].value = text;\n    this.updateItemIcon(last);\n\n    if (this.list[0].classList.contains('search-mode')) {\n      this.resetList();\n    }\n    this.activate(true);\n    this.setBadge(last);\n    this.toggleTooltip();\n\n    this.element.trigger('change').triggerHandler('selected');\n  },\n\n  /**\n   * Convenience method for running _selectOption()_ on a set of list options.\n   * Accepts an array or jQuery selector containing valid list options and selects/deselects them.\n   * @private\n   * @param {object} options incoming options\n   * @param {boolean} noTrigger if true, causes the 'selected' and 'change' events\n   * not to fire on each list item.\n   */\n  selectOptions(options, noTrigger) {\n    // Use a jQuery selector if the incoming options are inside an array\n    if (Array.isArray(options)) {\n      options = $(options);\n    }\n\n    const self = this;\n    options.each(function () {\n      self.selectOption($(this), noTrigger);\n    });\n\n    self.element.trigger('change').triggerHandler('selected');\n  },\n\n  /**\n   * Select an option and conditionally trigger events.\n   * Accepts an array or jQuery selector containing valid list options and selects/deselects them.\n   * @private\n   * @param {object} option - the incoming li option\n   * @param {boolean} noTrigger - if true, causes the 'selected' and 'change' events not to\n   * fire on the list item.\n   */\n  selectOption(option, noTrigger) {\n    if (!option || !option.length) {\n      return;\n    }\n    let li;\n\n    if (option.is('li')) {\n      li = option;\n      option = this.element.find(`option[value=\"${option.attr('data-val')}\"]`);\n\n      // Try matching the option's text if 'cur' comes back empty.\n      // Supports options that don't have a 'value' attribute.\n      if (option.length === 0) {\n        option = this.element.find('option').filter(function () {\n          return $(this).text() === li.attr('data-val');\n        });\n      }\n    }\n\n    let value = option.val();\n    if (!option) {\n      return;\n    }\n\n    if (!li && typeof value === 'string') {\n      value = value.replace(/\"/g, '/quot/');\n      li = this.listUl.find(`li[data-val=\"${value}\"]`);\n    }\n\n    if (option.hasClass('is-disabled') || option.is(':disabled')) {\n      return;\n    }\n\n    const optionVal = option.val();\n    let val = this.element.val();\n    let text = '';\n    let trimmed = '';\n    let clearSelection = false;\n\n    if (this.settings.reload === 'typeahead') {\n      val = this.selectedValues || [];\n    }\n\n    // Sets to false if the option is being removed from a multi-select instead of added\n    let isAdded = true;\n\n    if (option.hasClass('clear') || !li) {\n      clearSelection = true;\n    }\n\n    if (this.settings.multiple) {\n      // Working with a select multiple allows for the \"de-selection\" of items in the list\n      if (!val) {\n        val = [];\n      }\n      if ($.inArray(optionVal, val) !== -1) {\n        val = $.grep(val, optionValue => optionValue !== optionVal);\n        li.removeClass('is-selected').removeAttr('aria-selected');\n        this.previousActiveDescendant = undefined;\n        isAdded = false;\n      } else {\n        if (!isNaN(this.settings.maxSelected) &&  //eslint-disable-line\n          this.element.find('option:selected').length >= this.settings.maxSelected) {\n          return;\n        }\n\n        val = typeof val === 'string' ? [val] : val;\n        val.push(optionVal);\n        li.addClass('is-selected').attr('aria-selected', 'true');\n        this.previousActiveDescendant = option.val();\n      }\n\n      const newOptions = this.element.find('option').filter(function () {\n        return $.inArray($(this)[0].value, val) !== -1;\n      });\n      text = this.getOptionText(newOptions);\n    } else {\n      // Working with a single select\n      val = optionVal;\n      this.listUl.find('li.is-selected').removeClass('is-selected').removeAttr('aria-selected');\n      if (!clearSelection) {\n        li.addClass('is-selected').attr('aria-selected', 'true');\n      }\n      this.previousActiveDescendant = option.val();\n      text = option.text();\n    }\n\n    if (!clearSelection) {\n      this.element.find('option').each(function () {  //eslint-disable-line\n        if (this.value === optionVal) {\n          $(this).prop('selected', true);\n          return false;\n        }\n      });\n    }\n\n    // Change the values of both inputs and swap out the active descendant\n    if (!clearSelection) {\n      this.pseudoElem.find('span').text(`<span class=\"audible\">${this.label.text()} </span>${text}`);\n      this.searchInput.val(text);\n    } else {\n      this.pseudoElem.find('span').text(`<span class=\"audible\">${this.label.text()} </span>${text}`);\n      this.searchInput.val('');\n    }\n\n    if (this.element.attr('maxlength')) {\n      trimmed = text.substr(0, this.element.attr('maxlength'));\n      this.pseudoElem.find('span').text(trimmed);\n      this.searchInput.val(trimmed);\n    }\n\n    // Set the new value on the <select>\n    this.selectedValues = val;\n    this.element.val(val);\n    this.updateItemIcon(option);\n\n    /**\n    * Fires after the value in the input is changed by any means.\n    * @event change\n    * @memberof Dropdown\n    * @property {object} event The jquery event object\n    */\n    if (!noTrigger) {\n      // Fire the change event with the new value if the noTrigger flag isn't set\n      this.element.trigger('change').triggerHandler('selected', [option, isAdded]);\n\n      this.toggleTooltip();\n    }\n\n    /**\n    * Fires after the value in the input is changed by user interaction.\n    * @event input\n    * @memberof Dropdown\n    * @property {object} event The jquery event object\n    */\n\n    // If multiselect, reset the menu to the unfiltered mode\n    if (this.settings.multiple) {\n      if (this.list.hasClass('search-mode')) {\n        this.resetList();\n      }\n      this.activate(true);\n    }\n\n    this.setBadge(option);\n  },\n\n  /**\n   * Select an option by the value.\n   * @param {string} value - A string containing the value to look for. (Case insensitive)\n   */\n  selectValue(value) {\n    if (typeof value !== 'string') {\n      return;\n    }\n\n    const option = this.element.find(`option[value=\"${value}\"]`);\n    if (!option || !option.length) {\n      return;\n    }\n\n    this.element.find('option:selected').prop('selected', false);\n    option.prop('selected', true);\n    this.updated();\n  },\n\n  /**\n   * Select the next item that starts with a given character (text of the option).\n   * @param {string} char - The starting letter to match for. (Case insensitive)\n   */\n  selectStartsWith(char) {\n    if (typeof char !== 'string') {\n      return;\n    }\n\n    const elem = this.element[0];\n    this.filterTerm = '';\n\n    let newIdx = -1;\n    let totalMatches = 0;\n\n    // Log search matches\n    if (!this.searchMatches || !this.searchMatches[char]) {\n      this.searchMatches = {};\n      this.searchMatches[char] = [];\n    }\n\n    for (let i = 0; i < elem.options.length; i++) {\n      const option = elem.options[i];\n      // Check if its a match (Case insensitive)\n      const isMatch = option.innerText.toLowerCase().indexOf(char) === 0;\n\n      if (isMatch) {\n        if (this.searchMatches[char].indexOf(i) === -1) {\n          this.searchMatches[char].push(i);\n          newIdx = i;\n          break;\n        }\n        totalMatches++;\n        continue;\n      }\n    }\n\n    if (newIdx === -1) {\n      if (!this.searchMatches[char].length) {\n        return;\n      }\n\n      if (totalMatches === this.searchMatches[char].length) {\n        newIdx = this.searchMatches[char][0];\n        this.searchMatches[char].length = 1; // reset\n      }\n    }\n\n    elem.selectedIndex = newIdx;\n    this.updated();\n    this.element.trigger('change');\n  },\n\n  /**\n   * Set the bade on the option from the config.\n   * @private\n   * @param {string} option - A string containing the value to look for. (Case insensitive)\n   */\n  setBadge(option) {\n    // Badge Support\n    if (this.badges) {\n      let badge = this.element.parent().find('.badge');\n\n      if (badge.length === 0) {\n        this.element.parent().find('.dropdown-wrapper').append('<span class=\"badge\">1</span>');\n        badge = this.element.parent().find('.badge');\n      }\n\n      badge.attr('class', `badge ${option.attr('data-badge-color') ? option.attr('data-badge-color') : 'azure07'}`)\n        .text(option.attr('data-badge'));\n    }\n  },\n\n  /**\n   * Execute the source ajax option\n   * @private\n   * @param {function} callback  The function call back.\n   * @param {boolean} doReset  if defined, acts as a \"reset\" source call, where the search term will be ignored.\n   * @returns {function} The callback for execution.\n   */\n  callSource(callback, doReset) {\n    const self = this;\n    let searchTerm = '';\n\n    if (!doReset && this.isOpen() && !this.element.hasClass('search-mode')) {\n      searchTerm = this.searchInput.val();\n    }\n\n    // Return false and let the normal display codepath run.\n    if (!this.settings.source) {\n      return false;\n    }\n\n    this.isFiltering = false;\n\n    const sourceType = typeof this.settings.source;\n    const response = function (data, isManagedByTemplate) {\n      // to do - no results back do not open.\n      let list = '';\n      const val = self.element.val();\n\n      function replaceDoubleQuotes(content) {\n        return content.replace(/\"/g, '\\'');\n      }\n\n      function buildOption(option) {\n        if (option === null || option === undefined) {\n          return;\n        }\n\n        const isString = typeof option === 'string';\n        const stringContent = option;\n        let id = '';\n        let selected = '';\n        let textContent = '';\n\n        if (isString) {\n          option = {\n            value: stringContent\n          };\n        }\n\n        if (option.value !== undefined) {\n          option.value = replaceDoubleQuotes(option.value);\n          textContent = option.label;\n        }\n\n        if (option.id !== undefined) {\n          if (!isNaN(option.id)) {  //eslint-disable-line\n            option.id = `${option.id}`;\n          }\n          option.id = replaceDoubleQuotes(option.id);\n          id = ` id=\"${option.id}\"`;\n        }\n\n        if (option.label !== undefined) {\n          option.label = replaceDoubleQuotes(option.label);\n          textContent = option.label;\n        }\n\n        const selectedValues = (self.selectedValues && self.selectedValues.indexOf(val) > -1);\n        if (option.value === val || selectedValues) {\n          option.selected = true;\n          selected = ' selected';\n        }\n\n        // Render the option element\n        list += `<option${id} value=\"${option.value}\"${selected}>\n          ${textContent}\n        </option>`;\n      }\n\n      // If the incoming dataset is different than the one we started with,\n      // replace the contents of the list, and rerender it.\n      if (!self.isFiltering && !utils.equals(data, self.dataset)) {\n        self.dataset = data;\n\n        if (!isManagedByTemplate) {\n          self.element.empty();\n          for (let i = 0; i < data.length; i++) {\n            let opts;\n\n            if (data[i].group) {\n              opts = data[i].options;\n              list += `<optgroup label=\"${data[i].group}\">`;\n              for (let ii = 0; ii < opts.length; ii++) {\n                buildOption(opts[ii]);\n              }\n              list += '</optgroup>';\n            } else {\n              buildOption(data[i]);\n            }\n          }\n\n          self.element.append(list);\n        }\n        self.updateList(searchTerm);\n      }\n\n      self.element.triggerHandler('complete'); // For Busy Indicator\n      self.element.trigger('requestend', [searchTerm, data]);\n\n      if (typeof callback !== 'function') {\n        return;\n      }\n      callback();\n    };\n\n    self.element.triggerHandler('start'); // For Busy Indicator\n    self.element.trigger('requeststart');\n\n    if (sourceType === 'function') {\n      // Call the 'source' setting as a function with the done callback.\n      this.settings.source(response, searchTerm, this.settings.sourceArguments);\n    } else if (sourceType === 'object') {\n      // Use the 'source' setting as pre-existing data.\n      // Sanitize accordingly.\n      const sourceData = $.isArray(this.settings.source) ? this.settings.source :\n        [this.settings.source];\n      response(sourceData);\n    } else {\n      // Attempt to resolve source as a URL string.  Do an AJAX get with the URL\n      const sourceURL = this.settings.source.toString();\n      const request = $.getJSON(sourceURL);\n\n      request.done((data) => {\n        response(data);\n      }).fail(() => {\n        response([]);\n      });\n    }\n\n    return true;\n  },\n\n  /**\n   * Get data attributes from passed list of attributes\n   * @private\n   * @param {array} attr - List of all attributes.\n   * @param {array} attrToExclude - List of attributes to be excluded from passed list.\n   * @returns {object} It will return an object containing two keys\n   * str - string of attributes\n   * obj - object of attributes\n   */\n  getDataAttributes(attr, attrToExclude) {\n    if (!attr) {\n      return;\n    } else if (typeof attr === 'string') {\n      attr = [attr];\n    }\n\n    let toExclude = attrToExclude || [];\n    if (typeof toExclude === 'string') {\n      toExclude = [toExclude];\n    }\n    const attrToCopy = {\n      obj: {},\n      str: '',\n      isExclude(attrib) {\n        return $.inArray(attrib, toExclude) > -1;\n      }\n    };\n    for (const key in attr) { //eslint-disable-line\n      if (!attr.hasOwnProperty(key)) {  //eslint-disable-line\n        continue; //eslint-disable-line\n      }\n      attrToCopy.name = `${attr[key].name}`;\n      attrToCopy.isData = attrToCopy.name.substr(0, 5) === 'data-';\n      if (attrToCopy.isData && !attrToCopy.isExclude(attrToCopy.name)) {\n        attrToCopy.obj[attrToCopy.name] = attr[key].value;\n        attrToCopy.str += ` ${\n          attrToCopy.name}=\"${attr[key].value}\"`;\n      }\n    }\n    return { str: attrToCopy.str, obj: attrToCopy.obj };  //eslint-disable-line\n  },\n\n  /**\n   * Public API for setting the `<select>`'s value.\n   * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n   * @private\n   * @deprecated as of v4.4.0. It's preferrable to set the input value and call `updated()` on the component API.\n   * @param {string} code - The value to match and set on the value element.\n   */\n  setCode(code) {\n    warnAboutDeprecation(this.setCode, this.element.val);\n\n    const self = this;\n    const doSetting = function () {\n      self.element.val(code);\n      self.updated();\n    };\n\n    if (!self.callSource(doSetting)) {\n      doSetting();\n    }\n  },\n\n  /**\n   * Returns true if the object is a mobile element.\n   * @private\n   * @returns {boolean} code - True if this is a mobile device\n   */\n  isMobile() {\n    return ['ios', 'android'].indexOf(env.os.name) > -1;\n  },\n\n  /**\n   * Returns true if the element already has the closable class.\n   * @private\n   * @returns {object} The list\n   */\n  isListClosable() {\n    return this.list.hasClass('is-closable');\n  },\n\n  /**\n   * Disable the input element.\n   */\n  disable() {\n    this.element\n      .prop('disabled', true)\n      .prop('readonly', false);\n\n    if (this.pseudoElem.is($(document.activeElement))) {\n      this.pseudoElem.blur();\n    }\n\n    this.pseudoElem\n      .addClass('is-disabled')\n      .removeClass('is-readonly')\n      .attr('tabindex', '-1')\n      .prop('readonly', false)\n      .prop('disabled', true);\n    this.closeList('cancel');\n  },\n\n  /**\n  * Returns true if the dropdown is disabled.\n  * @returns {boolean} True if the element is disabled.\n  */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n   * Enable the input element.\n   */\n  enable() {\n    this.element\n      .prop('disabled', false)\n      .prop('readonly', false);\n    this.pseudoElem\n      .prop('disabled', false)\n      .prop('readonly', false)\n      .attr('tabindex', '0')\n      .removeClass('is-disabled')\n      .removeClass('is-readonly');\n  },\n\n  /**\n   * Make the input element readonly.\n   */\n  readonly() {\n    this.element\n      .prop('disabled', false)\n      .prop('readonly', true);\n    this.pseudoElem\n      .removeClass('is-disabled')\n      .addClass('is-readonly')\n      .attr('tabindex', this.element.attr('tabindex') || '0')\n      .prop('disabled', false)\n      .prop('readonly', true);\n    this.closeList('cancel');\n  },\n\n  /**\n   * Tear down events and restore to original state.\n   * @param  {object} settings The settings object to use.\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.closeList('cancel');\n\n    if (this.pseudoElem && this.pseudoElem.hasClass('is-open')) {\n      this.pseudoElem\n        .removeClass('is-open')\n        .removeAttr('aria-expanded');\n    }\n\n    // Update the 'multiple' property\n    if (this.settings.multiple && this.settings.multiple === true) {\n      this.element.prop('multiple', true);\n    } else {\n      this.element.prop('multiple', false);\n    }\n\n    // update \"readonly\" prop\n    if (this.element.prop('readonly') === true) {\n      this.readonly();\n    } else {\n      this.pseudoElem.removeClass('is-readonly');\n    }\n\n    // update \"disabled\" prop\n    this.pseudoElem[this.element.prop('disabled') ? 'addClass' : 'removeClass']('is-disabled');\n\n    // update the list and set a new value, if applicable\n    this.updateList();\n    this.setDisplayedValues();\n\n    this.element.trigger('has-updated');\n\n    return this;\n  },\n\n  /**\n   * Tear down events and restore to original state.\n   */\n  destroy() {\n    if (this.selectedValues) {\n      delete this.selectedValues;\n    }\n\n    $.removeData(this.element[0], COMPONENT_NAME);\n    this.closeList('cancel');\n    this.label.remove();\n    this.pseudoElem.off().remove();\n    this.icon.remove();\n    this.wrapper.remove();\n    this.listfilter.destroy();\n    this.element.removeAttr('style');\n\n    const list = document.body.querySelector('#dropdown-list');\n    if (list && this.isOpen()) {\n      list.parentNode.removeChild(list);\n    }\n  },\n\n  /**\n   * Setup the internal event handlers.\n   * @private\n   */\n  handleEvents() {\n    const self = this;\n\n    this.pseudoElem\n      .on('keydown.dropdown', e => this.handlePseudoElemKeydown(e))\n      .on('click.dropdown', (e) => {\n        // landmark would like the click event to bubble up if ctrl and shift are pressed\n        if (!(e.originalEvent.ctrlKey && e.originalEvent.shiftKey)) {\n          e.stopPropagation();\n        }\n      }).on('mouseup.dropdown', (e) => {\n        if (e.button === 2) {\n          return;\n        }\n        self.toggle();\n      })\n      .on('touchend.dropdown touchcancel.dropdown', (e) => {\n        e.stopPropagation();\n        self.toggle();\n        e.preventDefault();\n      });\n\n    self.element.on('activated.dropdown', () => {\n      self.label.trigger('click');\n    }).on('updated.dropdown', (e) => {\n      e.stopPropagation();\n      self.updated();\n    }).on('openlist.dropdown', () => {\n      self.toggle();\n    });\n\n    // for form resets.\n    self.element.closest('form').on('reset.dropdown', () => {\n      setTimeout(() => {\n        self.element.triggerHandler('updated');\n      }, 1);\n    });\n\n    // Handle Label click\n    this.label.on('click', () => {\n      self.pseudoElem.focus();\n    });\n  }\n};\n\nexport { Dropdown, COMPONENT_NAME };\n","import { Dropdown, COMPONENT_NAME } from './dropdown';\n\n/**\n * jQuery Component Wrapper for the Dropdown\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.dropdown = function (settings) {\n  // Keep the Chaining and Init the Controls or Settings\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Dropdown(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { stringUtils as str } from '../../utils/string';\n\n// jQuery components\nimport '../dropdown/dropdown.jquery';\nimport '../icons/icons.jquery';\nimport '../mask/mask-input.jquery';\nimport '../popover/popover.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'timepicker';\n\n// Timepicker Modes\nconst TIMEPICKER_MODES = ['standard', 'range'];\n\n// Timepicker defaults\nconst TIMEPICKER_DEFAULTS = function () {\n  return {\n    locale: '',\n    timeFormat: undefined,\n    minuteInterval: 5,\n    secondInterval: 5,\n    mode: TIMEPICKER_MODES[0],\n    roundToInterval: true,\n    parentElement: null,\n    returnFocus: true\n  };\n};\n\n/**\n * The Timepicker Component provides a click/touch user interface for setting a time.\n * @class TimePicker\n * @param {HTMLElement|jQuery[]} element the base element\n * @param {object} [settings] incoming settings\n * @param {string} [settings.locale] The name of the locale to use for this instance. If not set the current locale will be used.\n * @param {string} [settings.timeFormat = 'h:mm a'] The time format, defaults to the current locales time format.\n * @param {number} [settings.minuteInterval = 5]  Integer from 1 to 60.  Multiples of this value\n *  are displayed as options in the minutes dropdown.\n * @param {number} [settings.secondInterval = 5]  Integer from 1 to 60.\n * @property {string} [settings.mode = 'standard']  Can be set to 'standard', 'range',\n * @property {boolean} [settings.roundToInterval = true]  if `false`, does not automatically round user-entered values\n * from the pickers to their nearest interval.\n * @param {null|jQuery[]} [settings.parentElement] if defined as a jQuery-wrapped element, will be used as the target element.\n * @property {string} [settings.returnFocus = true]  If set to false, focus will not be returned to\n *  the calling element. It usually should be for accessibility purposes.\n */\nfunction TimePicker(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, TIMEPICKER_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nTimePicker.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.setLocale();\n    if (!this.settings.locale) {\n      this.setCurrentCalendar().build();\n    }\n  },\n\n  /**\n   * Set current locale to be used.\n   * @private\n   * @returns {void}\n   */\n  setLocale() {\n    this.locale = Locale.currentLocale;\n    if (this.settings.locale) {\n      Locale.getLocale(this.settings.locale).done((locale) => {\n        this.locale = Locale.cultures[locale];\n        this.setCurrentCalendar();\n      });\n    }\n  },\n\n  /**\n   * Sets current calendar information.\n   * @private\n   * @returns {object} The api object for chaining.\n   */\n  setCurrentCalendar() {\n    this.currentCalendar = Locale.calendar(this.locale.name, this.settings.calendarName);\n    if (this.settings.timeFormat === undefined) {\n      this.settings.timeFormat = this.currentCalendar.timeFormat || 'h:mm a';\n    }\n    this.isRTL = this.locale.direction === 'right-to-left';\n    this.build();\n    return this;\n  },\n\n  /**\n   * Configure any settings for the Timepicker\n   * @private\n   * @returns {this} component instance\n   */\n  setup() {\n    function sanitizeIntervals(value, type) {\n      if (!type || ['minute', 'second'].indexOf(type) < 0) {\n        type = 'minute';\n      }\n\n      const defaultInterval = TIMEPICKER_DEFAULTS()[(`${type}Interval`)];\n      if (value === undefined || isNaN(value)) {\n        return defaultInterval;\n      }\n      const intValue = parseInt(value, 10);\n      return intValue > 0 && intValue < 60 ? intValue : defaultInterval;\n    }\n\n    function sanitizeTimeFormat(value) {\n      if (!value || !value.toUpperCase().match('H') || !value.match('mm')) {\n        return TIMEPICKER_DEFAULTS().timeFormat;\n      }\n\n      return value;\n    }\n\n    function sanitizeRoundToInterval(value) {\n      return value === true;\n    }\n\n    function sanitizeMode(value) {\n      const modes = ['standard', 'range'];\n      return $.inArray(value, modes) > -1 ? value : TIMEPICKER_DEFAULTS().mode;\n    }\n\n    this.id = `${utils.uniqueId(this.element, 'timepicker')}-id`;\n    this.hoursId = `timepicker-hours-${this.id.toString()}`;\n    this.minutesId = `timepicker-minutes-${this.id.toString()}`;\n    this.secondsId = `timepicker-seconds-${this.id.toString()}`;\n    this.periodId = `timepicker-period-${this.id.toString()}`;\n\n    if (this.element.is('[data-round-to-interval]')) {\n      this.settings.roundToInterval = sanitizeRoundToInterval(this.element.attr('data-round-to-interval'));\n    }\n    if (this.element.is('[data-minute-interval]')) {\n      this.settings.minuteInterval = sanitizeIntervals(this.element.attr('data-minute-interval'), 'minute');\n    }\n\n    this.settings.timeFormat = sanitizeTimeFormat(parseInt(this.element.attr('data-force-hour-mode'), 10) === 24 ? 'HH:mm' : this.settings.timeFormat);\n    this.settings.minuteInterval = sanitizeIntervals(this.settings.minuteInterval, 'minute');\n    this.settings.secondInterval = sanitizeIntervals(this.settings.secondInterval, 'second');\n    this.settings.mode = sanitizeMode(this.settings.mode);\n    this.settings.roundToInterval = sanitizeRoundToInterval(this.settings.roundToInterval);\n\n    this.dayPeriods = this.currentCalendar.dayPeriods;\n\n    return this;\n  },\n\n  /**\n   * Add any markup\n   * @private\n   * @returns {this} component instance\n   */\n  build() {\n    this\n      .setup();\n\n    // With this option forgoe the input and append the dropdowns/popup to the parent element\n    if (this.settings.parentElement) {\n      this.settings.parentElement.empty();\n      this.trigger = $();\n      this.buildStandardPopup();\n      this.setupStandardEvents();\n      return this;\n    }\n\n    // Append a Button\n    this.trigger = this.element.next('svg.icon');\n    if (this.trigger.length === 0) {\n      this.trigger = $.createIconElement('clock').insertAfter(this.element);\n    }\n\n    this.addAria()\n      .addMask()\n      .handleEvents()\n      .roundMinutes();\n    return this;\n  },\n\n  /**\n   * Adds ARIA-related attributes\n   * @private\n   * @returns {void}\n   */\n  addAria() {\n    this.element.attr({\n      'aria-expanded': 'false',\n      role: 'combobox'\n    });\n\n    // TODO: Confirm this with Accessibility Team\n    this.label = $(`label[for=\"${this.element.attr('id')}\"]`);\n    this.label.find('.audible').remove();\n    this.label.append(`<span class=\"audible\">${Locale.translate('UseArrow', { locale: this.locale.name })}</span>`);\n    return this;\n  },\n\n  /**\n   * Sets up a `keydown` event listener.\n   * @private\n   * @returns {void}\n   */\n  handleKeys() {\n    const self = this;\n\n    this.element.on('keydown.timepicker', (e) => {\n      let handled = false;\n\n      // Esc closes an open popup with no action\n      if (e.which === 27 && self.isOpen()) {\n        handled = true;\n        self.closeTimePopup();\n      }\n\n      // Arrow Down or Alt first opens the dialog\n      if (e.which === 40 && !self.isOpen()) {\n        handled = true;\n        self.openTimePopup();\n      }\n\n      if (handled) {\n        e.stopPropagation();\n        e.preventDefault();\n        return false;\n      }\n\n      return true;\n    });\n  },\n\n  /**\n   * Sets up a `blur` event listener.\n   * @private\n  */\n  handleBlur() {\n    const self = this;\n\n    this.element.on('blur.timepicker', () => {\n      self.roundMinutes();\n\n      // The action of closing the popup menu is set on a timer because technically\n      // there are no fields focused on frame 0 of the popup menu's existence, which\n      // would cause it to close immediately on open.\n      setTimeout(() => {\n        if (self.isOpen() && self.popup.find(':focus').length === 0) {\n          self.closeTimePopup();\n        }\n      }, 20);\n    });\n  },\n\n  /**\n   * Checks a time format value to see if it is a Military (24-hour) format.\n   * @private\n   * @param {string} value - a string value representing a time format.\n   * @returns {boolean} whether or not the time format is 24-hour\n   */\n  is24HourFormat(value) {\n    if (!value) { value = this.settings.timeFormat; }\n    return (value.match('H') || []).length > 0;\n  },\n\n  /**\n   * @private\n   * @param {number} value incoming value\n   * @returns {string} the hour text\n   */\n  hourText(value) {\n    return (((this.settings.timeFormat.toUpperCase().match('HH') || []).length > 0 && value < 10 ? '0' : '') + value);\n  },\n\n  /**\n   * Checks a time format value to see if it includes seconds.\n   * @private\n   * @param {string} value a string value representing a time format.\n   * @returns {boolean} whether or not seconds are included in the time format\n   */\n  hasSeconds(value) {\n    if (!value) { value = this.settings.timeFormat; }\n    return (value.match('ss') || []).length > 0;\n  },\n\n  /**\n   * Checks to see if a time format contains a space for presenting the day period.\n   * @private\n   * @param {string} value a string value representing a time format.\n   * @returns {boolean} whther or not the time format has day periods.\n   */\n  hasDayPeriods(value) {\n    if (!value) { value = this.settings.timeFormat; }\n    return (value.match('a') || []).length > 0;\n  },\n\n  /**\n   * Gets a Locale-defined version of the time separator.\n   * @returns {string} containing the time separator\n   */\n  getTimeSeparator() {\n    return this.currentCalendar.dateFormat.timeSeparator;\n  },\n\n  /**\n   * Rounds the current value of the minutes picker to its nearest interval value.\n   * @private\n   */\n  roundMinutes() {\n    if (!str.toBoolean(this.settings.roundToInterval)) {\n      return;\n    }\n\n    // separate out the minutes value from the rest of the value.\n    const val = this.element.val();\n    const timeSeparator = this.getTimeSeparator();\n    const parts = val ? val.split(timeSeparator) : [];\n    const interval = this.settings.minuteInterval;\n\n    if (!parts[1]) {\n      return;\n    }\n\n    if (!this.is24HourFormat(this.settings.timeFormat)) {\n      const periodParts = parts[1].split(' ');\n      parts[1] = periodParts[0];\n      if (periodParts[1]) {\n        parts.push(periodParts[1]);\n      }\n    }\n\n    parts[1] = parseInt(parts[1], 10);\n    if (parts[1] % interval === 0) {\n      return;\n    }\n\n    parts[1] = Math.round(parts[1] / interval) * interval;\n\n    parts[1] = parts[1].toString();\n    parts[1] = (parts[1].length < 2 ? '0' : '') + parts[1];\n\n    if (parts[1] === '60') {\n      parts[1] = '00';\n      parts[0] = (parseInt(parts[0], 10) + 1).toString();\n    }\n\n    const newVal = `${parts[0] + timeSeparator + parts[1]} ${parts[2] ? parts[2] : ''}`;\n    this.element.val(newVal);\n  },\n\n  /**\n   * Adds Masked Input and Validation components to the input field at build time.\n   * @private\n   * @returns {void}\n   */\n  addMask() {\n    if (this.element.data('mask') && typeof this.element.data('mask') === 'object') {\n      this.element.data('mask').destroy();\n    }\n    this.element.data('mask', undefined);\n\n    const maskOptions = {\n      keepCharacterPositions: true,\n      process: 'date',\n      patternOptions: {\n        format: this.settings.timeFormat\n      }\n    };\n\n    const validation = 'time';\n    const events = { time: 'blur change enter' };\n\n    if (!this.element[0].getAttribute('data-validate')) {\n      this.element\n        .attr('data-validate', validation)\n        .attr('data-validation-events', JSON.stringify(events))\n        .validate();\n    }\n\n    if (maskOptions) {\n      this.element\n        .mask(maskOptions);\n    }\n    return this;\n  },\n\n  /**\n   * Constructs all markup and subcomponents needed to build the standard Timepicker popup.\n   * @private\n   * @returns {void}\n   */\n  buildStandardPopup() {\n    const self = this;\n    const popupContent = $('<div class=\"timepicker-popup-content\"></div>');\n    const timeSeparator = this.getTimeSeparator();\n    let textValue = '';\n    let selected;\n\n    this.initValues = self.getTimeFromField();\n    const timeParts = $('<div class=\"time-parts\"></div>').appendTo(popupContent);\n\n    // Build the inner-picker HTML\n    const is24HourFormat = this.is24HourFormat();\n    const hasSeconds = this.hasSeconds();\n    const hasDayPeriods = this.hasDayPeriods();\n    let hourCounter = is24HourFormat ? 0 : 1;\n    const maxHourCount = is24HourFormat ? 24 : 13;\n\n    this.hourSelect = $(`<select id=\"${this.hoursId}\" data-options=\"{'noSearch': 'true'}\" class=\"hours dropdown\"></select>`);\n\n    while (hourCounter < maxHourCount) {\n      selected = '';\n      if (parseInt(self.initValues.hours, 10) === hourCounter) {\n        selected = ' selected';\n      }\n      self.hourSelect.append($(`<option${selected}>${self.hourText(hourCounter)}</option>`));\n      hourCounter++;\n    }\n    timeParts.append($(`<label for=\"${this.hoursId}\" class=\"audible\">${Locale.translate('Hours', { locale: this.locale.name })}</label>`));\n    timeParts.append(this.hourSelect);\n    timeParts.append($(`<span class=\"label colons\">${timeSeparator}</span>`));\n\n    // Minutes Picker\n    let minuteCounter = 0;\n    this.minuteSelect = $(`<select id=\"${this.minutesId}\" data-options=\"{'noSearch': 'true'}\" class=\"minutes dropdown\"></select>`);\n\n    while (minuteCounter <= 59) {\n      textValue = minuteCounter < 10 ? `0${minuteCounter}` : minuteCounter;\n\n      selected = '';\n      if (parseInt(self.initValues.minutes, 10) === minuteCounter) {\n        selected = ' selected';\n      }\n      self.minuteSelect.append($(`<option${selected}>${textValue}</option>`));\n      minuteCounter += self.settings.minuteInterval;\n    }\n\n    // If the value inside the picker doesn't match an interval, add the value\n    // as the currently selected option, right at the top\n    if (!this.minuteSelect.find('option[selected]').length) {\n      this.minuteSelect.prepend($(`<option selected>${self.initValues.minutes}</option>`));\n    }\n\n    timeParts.append($(`<label for=\"${this.minutesId}\" class=\"audible\">${Locale.translate('Minutes', { locale: this.locale.name })}</label>`));\n    timeParts.append(this.minuteSelect);\n\n    // Seconds Picker\n    if (hasSeconds) {\n      let secondCounter = 0;\n      this.secondSelect = $(`<select id=\"${this.secondsId}\" data-options=\"{'noSearch': 'true'}\" class=\"seconds dropdown\"></select>`);\n\n      while (secondCounter <= 59) {\n        textValue = secondCounter < 10 ? `0${secondCounter}` : secondCounter;\n\n        selected = '';\n        if (parseInt(self.initValues.seconds, 10) === secondCounter || (!self.initValues.seconds && textValue === '00')) {\n          selected = ' selected';\n        }\n        this.secondSelect.append($(`<option${selected}>${textValue}</option>`));\n        secondCounter += self.settings.secondInterval;\n      }\n\n      // If the value inside the picker doesn't match an interval, add the value\n      // as the currently selected option, right at the top\n      if (!this.secondSelect.find('option[selected]').length) {\n        this.secondSelect.prepend($(`<option selected>${self.initValues.seconds}</option>`));\n      }\n\n      timeParts.append($(`<span class=\"label colons\">${timeSeparator}</span>`));\n      timeParts.append($(`<label for=\"${this.secondsId}\" class=\"audible\">${Locale.translate('Seconds', { locale: this.locale.name })}</label>`));\n      timeParts.append(this.secondSelect);\n    }\n\n    if (!is24HourFormat && hasDayPeriods) {\n      this.periodSelect = $(`<select id=\"${this.periodId}\" data-options=\"{'noSearch': 'true'}\" class=\"period dropdown\"></select>`);\n      timeParts.append($('<span class=\"label colons\"></span>'));\n      const localeDays = this.currentCalendar.dayPeriods;\n      let localeCount = 0;\n      const regexDay = new RegExp(self.initValues.period, 'i');\n      let realDayValue = 'AM'; // AM\n\n      while (localeCount < 2) {\n        realDayValue = localeCount === 0 ? 'AM' : 'PM'; // ? AM : PM\n        selected = '';\n        if (regexDay.test(localeDays[localeCount])) {\n          selected = ' selected';\n        }\n        this.periodSelect.append($(`<option value=\"${realDayValue}\"${selected}>${localeDays[localeCount]}</option>`));\n\n        localeCount++;\n      }\n      timeParts.append($(`<label for=\"${this.periodId}\" class=\"audible\">${Locale.translate('TimePeriod', { locale: this.locale.name })}</label>`));\n      timeParts.append(this.periodSelect);\n    }\n\n    if (this.settings.parentElement) {\n      this.settings.parentElement.append(popupContent);\n      // self.afterShow(this.settings.parentElement);\n      self.popup = this.settings.parentElement.find('.timepicker-popup-content').addClass('timepicker-popup').attr('id', 'timepicker-popup');\n    } else {\n      popupContent.append(`<div class=\"modal-buttonset\"><button type=\"button\" class=\"btn-modal-primary set-time\">${Locale.translate('SetTime', { locale: this.locale.name })}</button></div>`);\n\n      let placementParent = this.element;\n      let placementParentXAlignment = (this.isRTL ? 'right' : 'left');\n      const parent = this.element.parent();\n\n      if (parent.is('.datagrid-cell-wrapper')) {\n        placementParentXAlignment = 'center';\n        placementParent = this.element.next('.icon');\n      }\n\n      this.trigger.popover({\n        content: popupContent,\n        trigger: 'immediate',\n        placement: 'bottom',\n        placementOpts: {\n          parent: placementParent,\n          parentXAlignment: placementParentXAlignment,\n          strategies: ['flip', 'nudge', 'shrink']\n        },\n        tooltipElement: '#timepicker-popup'\n      })\n        .on('show.timepicker', (e, ui) => {\n          self.afterShow(ui);\n        }).on('hide.timepicker', () => {\n          if (self.settings.returnFocus) {\n            self.element.focus();\n          }\n        });\n    }\n\n    // Make adjustments to the popup HTML specific to the timepicker\n    if (this.trigger.data('tooltip')) {\n      self.popup = this.trigger.data('tooltip').tooltip;\n      const tooltip = self.popup;\n      tooltip.addClass('timepicker-popup');\n    }\n  },\n\n  /**\n   * Handler for the Timepicker Popover's custom `show` event.\n   * @private\n   * @param {object} ui timepicker popup element\n   * @returns {void}\n   */\n  afterShow(ui) {\n    const self = this;\n\n    ui.find('button').button();\n\n    // Set default values based on what's retrieved from the Timepicker's input field.\n    this.hourSelect.val(this.initValues.hours);\n    this.hourSelect.data('dropdown').pseudoElem.find('span').text(this.initValues.hours);\n    this.minuteSelect.val(this.initValues.minutes);\n    this.minuteSelect.data('dropdown').pseudoElem.find('span').text(this.initValues.minutes);\n\n    if (this.secondSelect) {\n      this.secondSelect.val(this.initValues.seconds);\n      this.secondSelect.data('dropdown').pseudoElem.find('span').text(this.initValues.seconds);\n    }\n\n    if (self.hasDayPeriods()) {\n      this.periodSelect.val(this.initValues.period);\n      this.periodSelect.data('dropdown').pseudoElem.find('span').text(this.initValues.period);\n    }\n\n    ui.find('div.dropdown').first().focus();\n    ui.find('.set-time').off('click.timepicker').on('click.timepicker', (e) => {\n      e.preventDefault();\n      self.setTimeOnField();\n      self.closeTimePopup();\n    });\n\n    // Handle Tabbing on the dialog\n    if (!this.settings.parentElement) {\n      ui.on('keydown.timepicker', 'button, div.dropdown', (e) => {\n        const key = e.keyCode || e.charCode || 0;\n\n        if (key === 9) {\n          self.containFocus(e);\n          e.stopPropagation();\n          e.preventDefault();\n          return false;\n        }\n        return true;\n      });\n    }\n  },\n\n  /**\n   * Focus the next prev focusable element on the popup\n   * @private\n   * @param {jQuery.Event} e the event object\n   * @returns {void}\n   */\n  containFocus(e) {\n    const reverse = e.shiftKey;\n\n    // Set focus on (opt: next|prev) focusable element\n    const focusables = this.popup.find(':focusable');\n    let index = focusables.index($(':focus'));\n    const next = ((index + 1) >= focusables.length ? 0 : (index + 1));\n    const prev = ((index - 1) < 0 ? focusables.length : (index - 1));\n\n    index = (!reverse) ? next : prev;\n\n    focusables.eq(index).focus();\n  },\n\n  /**\n   * Sets up events that need to be bound to a standard time picker.\n   * @private\n   * @returns {void}\n   */\n  setupStandardEvents() {\n    const self = this;\n\n    self.popup.on('touchend.timepicker touchcancel.timepicker', '.set-time', (e) => {\n      e.preventDefault();\n      e.target.click();\n    }).on('keydown.timepicker', 'input.dropdown', function (e) {\n      let handled = false;\n\n      // Pressing Esc when focused on a closed dropdown menu causes the entire popup to close.\n      if (e.which === 27) {\n        handled = true;\n        self.closeTimePopup();\n        self.element.focus();\n      }\n\n      // Pressing Spacebar while the popup is open submits with the new time value.\n      if (e.which === 32) {\n        handled = true;\n        self.popup.find('.set-time').click();\n      }\n\n      // Left & Right Arrows will switch between the available dropdowns\n      if (e.which === 37 || e.which === 39) {\n        handled = true;\n        const inputs = self.popup.find('input[id$=\"-shdo\"]');\n\n        if (e.which === 37) {\n          let prev = inputs.eq(inputs.index(this) - 1);\n          if (!prev || prev.length === 0) {\n            prev = inputs.eq(inputs.length);\n          }\n          prev.focus();\n        }\n\n        if (e.which === 39) {\n          let next = inputs.eq(inputs.index(this) + 1);\n          if (!next || next.length === 0) {\n            next = inputs.eq(0);\n          }\n          next.focus();\n        }\n      }\n\n      if (handled) {\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      }\n\n      return true;\n    });\n\n    // Listen to the popover/tooltip's \"hide\" event to properly close out the\n    // popover's inner controls.\n    self.trigger.on('hide.timepicker', () => {\n      self.onPopupHide();\n    });\n  },\n\n  /**\n   * Constructs all markup and subcomponents needed to build a Timepicker popup\n   * containing a time range.\n   * @private\n   * @returns {void}\n   */\n  buildRangePopup() {\n    // TODO: Build this\n  },\n\n  /**\n   * Sets up events that need to be bound to a range timepicker.\n   * @private\n   * @returns {void}\n   */\n  setupRangeEvents() {\n    // TODO: Build this\n  },\n\n  /**\n   * Gets the value of the Timepicker field as an object separated into hours,\n   * minutes, (optional) seconds, and (optional) day period.\n   * @param {string} [value] this method can optionally be passed\n   * a string-based time value to calculate instead of the current field's value.\n   * @returns {object} containing key/value pairs representing time parts.\n   */\n  getTimeFromField(value) {\n    const self = this;\n    let val = value || this.element.val();\n    const sep = this.getTimeSeparator();\n    let parts;\n    let endParts;\n    const timeparts = {};\n\n    val = val.replace(/[T\\s:.-]/g, sep).replace(/z/i, '');\n    parts = val.split(sep);\n\n    // Check the last element in the array for a time period, and add it as an array\n    // member if necessary\n    if (!this.is24HourFormat()) {\n      endParts = parts[parts.length - 1].split(' ');\n      parts.pop();\n      parts = parts.concat(endParts);\n    }\n\n    function isDayPeriod(thisValue) {\n      return self.dayPeriods.indexOf(thisValue) > -1;\n    }\n\n    function removeLeadingWhitespace(thisValue) {\n      return thisValue.replace(/^\\s+|\\s+$/g, '');\n    }\n\n    function addLeadingZero(thisValue) {\n      if (!thisValue || isNaN(thisValue)) {\n        return '00';\n      }\n      thisValue = parseInt(thisValue, 10);\n      thisValue = thisValue < 10 ? `0${thisValue}` : thisValue;\n      return thisValue;\n    }\n\n    // Handle Hours\n    if (!parts[0] || !parts[0].length || isNaN(parts[0])) {\n      parts[0] = '1';\n    }\n\n    parts[0] = parseInt(parts[0], 10);\n    if (!isNaN(parts[0])) {\n      parts[0] = `${parseInt(parts[0], 10)}`;\n    }\n    timeparts.hours = self.hourText(parts[0]);\n\n    // Handle Minutes\n    if (parts[1]) {\n      // remove leading whitespace\n      parts[1] = removeLeadingWhitespace(parts[1]);\n      parts[1] = addLeadingZero(parts[1]);\n      timeparts.minutes = parts[1];\n    } else {\n      timeparts.minutes = '00';\n    }\n\n    // Handle Seconds/Period (slot 3)\n    function handleSlot2(thisValue) {\n      // Should not kick off at all if we don't pass it a value, OR if this field\n      // is 24-hour display with no seconds\n      if (!thisValue) {\n        if (self.hasSeconds()) {\n          thisValue = '00';\n          timeparts.seconds = thisValue;\n        }\n\n        if (!self.is24HourFormat()) {\n          thisValue = self.translateDayPeriod('AM');\n          timeparts.period = thisValue;\n        }\n\n        return;\n      }\n\n      thisValue = removeLeadingWhitespace(thisValue);\n\n      // Has seconds\n      if (self.hasSeconds()) {\n        thisValue = addLeadingZero(thisValue);\n        timeparts.seconds = thisValue;\n        return;\n      }\n      // No seconds, but has a day period\n      if (!isDayPeriod(thisValue)) {\n        thisValue = self.translateDayPeriod('AM');\n      }\n      timeparts.period = thisValue;\n    }\n    handleSlot2(parts[2]);\n\n    // Handle Period after seconds (slot 4)\n    if (parts[3]) {\n      parts[3] = removeLeadingWhitespace(parts[3]);\n      timeparts.period = parts[3];\n    } else if (!this.is24HourFormat() && this.hasSeconds()) {\n      timeparts.period = this.translateDayPeriod('AM');\n    }\n\n    return timeparts;\n  },\n\n  /**\n   * Translate Day Period\n   * @private\n   * @param {string} period should be \"am\", \"pm\", \"AM\", \"PM\", or \"i\"\n   * @returns {string} the translated day period.\n   */\n  translateDayPeriod(period) {\n    if (/am|pm|AM|PM/i.test(period)) {\n      const periods = this.currentCalendar.dayPeriods || ['AM', 'PM'];\n      return periods[/AM|am/i.test(period) ? 0 : 1];\n    }\n    return period;\n  },\n\n  /**\n   * Retrieves the values from the Timepicker popup's pickers and uses those values to set\n   * the contents of the Timepicker field.\n   * @returns {void}\n   */\n  setTimeOnField() {\n    const hours = $(`#${this.hoursId}`).val() || '';\n    const minutes = $(`#${this.minutesId}`).val() || '';\n    const seconds = $(`#${this.secondsId}`).val() || '';\n    let period = ($(`#${this.periodId}`).val() || '').toUpperCase();\n    const sep = this.getTimeSeparator();\n    let timeString = `${hours}${sep}${minutes}${this.hasSeconds() ? sep + seconds : ''}`;\n\n    period = (!this.is24HourFormat() && period === '') ? $(`#${this.periodId}-shdo`).val() : period;\n    timeString += period ? ` ${this.translateDayPeriod(period)}` : '';\n\n    /**\n    * Fires when the value is changed by typing or the picker.\n    * @event change\n    * @memberof TimePicker\n    * @property {object} event - The jquery event object\n    */\n    this.element.val(timeString)\n      .trigger('change');\n\n    this.element\n      .focus();\n  },\n\n  /**\n   * Return whether or not the Timepicker popup is open.\n   * @returns {boolean} whether or not the Timepicker popup is open.\n   */\n  isOpen() {\n    return !!((this.popup && this.popup.is(':visible')));\n  },\n\n  /**\n   * Opens the Timepicker popup, intializing all the dropdown elements and\n   * setting up internal events.\n   * @returns {void}\n   */\n  openTimePopup() {\n    const self = this;\n\n    // Get all current settings.\n    self.setup();\n\n    if (this.element.is(':disabled') || this.element.attr('readonly')) {\n      return;\n    }\n\n    if (this.popup && !this.popup.hasClass('is-hidden')) {\n      self.closeTimePopup();\n    }\n\n    this.element.addClass('is-active is-open');\n\n    // Build a different Time Popup based on settings\n    if (self.settings.mode === 'range') {\n      self.buildRangePopup();\n      self.setupRangeEvents();\n    } else {\n      self.buildStandardPopup();\n      self.setupStandardEvents();\n    }\n\n    this.element.attr({ 'aria-expanded': 'true' });\n    this.popup.find('div.dropdown').first().focus();\n  },\n\n  /**\n   * Triggers the \"hide\" method on the tooltip plugin.  The Timepicker officially\n   * \"closes\" after the popover's hide event fully completes because certain events\n   * need to be turned off and certain markup needs to be removed only AFTER\n   * the popover is hidden.\n   * @returns {void}\n   */\n  closeTimePopup() {\n    if (this.trigger.data('tooltip')) {\n      this.trigger.data('tooltip').hide();\n    }\n  },\n\n  /**\n   * Handles the time popover's \"hide\" event\n   * @private\n   * @returns {void}\n   */\n  onPopupHide() {\n    if (this.settings.mode === 'standard') {\n      const ddHours = $(`#${this.hoursId}`);\n      const ddMinutes = $(`#${this.minutesId}`);\n      const ddSeconds = $(`#${this.secondsId}`);\n      const ddPeriod = $(`#${this.periodId}`);\n\n      if (ddHours && ddHours.data('dropdown') &&\n        typeof ddHours.data('dropdown').destroy === 'function') {\n        ddHours.data('dropdown').destroy();\n      }\n      if (ddMinutes && ddMinutes.data('dropdown') &&\n        typeof ddMinutes.data('dropdown').destroy === 'function') {\n        ddMinutes.data('dropdown').destroy();\n      }\n      if (this.hasSeconds()) {\n        if (ddSeconds && ddSeconds.data('dropdown') &&\n          typeof ddSeconds.data('dropdown').destroy === 'function') {\n          ddSeconds.data('dropdown').destroy();\n        }\n      }\n      if (this.hasDayPeriods()) {\n        if (ddPeriod && ddPeriod.data('dropdown') &&\n          typeof ddPeriod.data('dropdown').destroy === 'function') {\n          ddPeriod.data('dropdown').destroy();\n        }\n      }\n      this.popup.off('click.timepicker touchend.timepicker touchcancel.timepicker keydown.timepicker');\n    }\n    this.element.attr({ 'aria-expanded': 'false' });\n    this.trigger.off('hide.timepicker show.timepicker');\n    this.trigger.data('tooltip').destroy();\n    this.trigger.data('tooltip', undefined);\n    $('#timepicker-popup').remove();\n    this.element.removeClass('is-active is-open');\n  },\n\n  /**\n   * Toggles the visibility of the Timepicker popup.\n   * @returns {void}\n   */\n  toggleTimePopup() {\n    if (this.isOpen()) {\n      this.closeTimePopup();\n    } else {\n      this.openTimePopup();\n    }\n  },\n\n  /**\n   * Getter method for retrieving the value of the Timepicker.\n   * @param {boolean} removePunctuation Gets rid of all the value's punctuation on return.\n   * @returns {string} the current timepicker value\n   */\n  value(removePunctuation) {\n    let val = this.element.val();\n    if (!removePunctuation || removePunctuation === false) {\n      return val;\n    }\n\n    const timeSeparator = this.currentCalendar.dateFormat.timeSeparator;\n    const sepRegex = new RegExp(timeSeparator, 'g');\n\n    // Remove punctuation\n    val = val.replace(sepRegex, '');\n\n    // Add leading zero for times without a double digit hour\n    const parts = val.split(' ');\n    if (parts[0].length < 4) {\n      val = `0${parts[0]}${parts[1] ? parts[1] : ''}`;\n    }\n\n    return val;\n  },\n\n  /**\n   * Enables the Timepicker\n   * @returns {void}\n   */\n  enable() {\n    this.element.removeAttr('disabled readonly').closest('.field').removeClass('is-disabled');\n  },\n\n  /**\n  * Set input to readonly.\n  * @returns {void}\n  */\n  readonly() {\n    this.enable();\n    this.element.attr('readonly', 'readonly');\n  },\n\n  /**\n   * Disables the Timepicker\n   * @returns {void}\n   */\n  disable() {\n    this.enable();\n    this.element.attr('disabled', 'disabled').closest('.field').addClass('is-disabled');\n  },\n\n  /**\n   * Detects whether or not the component is disabled\n   * @returns {boolean} whether or not the component is disabled\n   */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n   * Updates the component instance.  Can be used after being passed new settings.\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instanceof\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Removes all event bindings, subcomponents and unnecessary markup from this component instance.\n   * @private\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.trigger.off('keydown.timepicker');\n    this.element.off('focus.timepicker blur.timepicker keydown.timepicker');\n    if (this.popup) {\n      this.closeTimePopup();\n    }\n\n    this.trigger.remove();\n\n    const mask = this.element.data('mask');\n    if (mask && typeof mask.destroy === 'function') {\n      mask.destroy();\n    }\n\n    $.removeData(this.element[0], 'validate');\n    $.removeData(this.element[0], 'validationEvents');\n    this.element.removeAttr('data-validate').removeData('validate validationEvents');\n\n    this.label.find('.audible').remove();\n    $('#timepicker-popup').remove();\n    return this;\n  },\n\n  /**\n   * Destroys the component instance.\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Sets up event listeners for the timepicker instance.\n   * @fires TimePicker#events\n   * @listens click  &nbsp;-&nbsp;\n   * @listens touchstart  &nbsp;-&nbsp;\n   * @listens touchmove  &nbsp;-&nbsp;\n   * @listens touchend  &nbsp;-&nbsp;\n   * @listens blur  &nbsp;-&nbsp;\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n    this.trigger.off('click.timepicker').on('click.timepicker', () => {\n      self.toggleTimePopup();\n    });\n\n    this.handleKeys();\n    this.handleBlur();\n\n    return this;\n  }\n};\n\nexport { TimePicker, COMPONENT_NAME };\n","import { TimePicker, COMPONENT_NAME } from './timepicker';\n\n/**\n * jQuery Component Wrapper for Timepicker\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} textarea elements being acted on.\n */\n$.fn.timepicker = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new TimePicker(this, settings));\n    }\n  });\n};\n","import { Locale } from '../locale/locale';\n\n// The validation rules object.\n// This contains all base rules for validation that come bundled as part of Soho.\n// These rules can be extended.\nfunction ValidationRules() {\n  const self = this;\n\n  // define standard validation types\n  this.ValidationTypes = [];\n  this.ValidationTypes.error = {\n    type: 'error',\n    titleMessageID: 'Error',\n    pagingMessageID: 'ErrorOnPage',\n    errorsForm: true\n  };\n  this.ValidationTypes.alert = {\n    type: 'alert',\n    titleMessageID: 'Alert',\n    pagingMessageID: 'AlertOnPage',\n    errorsForm: false\n  };\n\n  this.ValidationTypes.success = {\n    type: 'success',\n    titleMessageID: 'Success',\n    pagingMessageID: 'SuccessOnPage',\n    errorsForm: false\n  };\n\n  // TODO: deprecate confirm in favor of success\n  this.ValidationTypes.confirm = this.ValidationTypes.success;\n\n  this.ValidationTypes.info = {\n    type: 'info',\n    titleMessageID: 'Info',\n    pagingMessageID: 'InfoOnPage',\n    errorsForm: false\n  };\n  this.ValidationTypes.icon = {\n    type: 'icon',\n    titleMessageID: 'Icon',\n    pagingMessageID: 'IconOnPage',\n    errorsForm: false,\n    icon: 'user-profile'\n  };\n\n  this.rules = {\n    required: {\n      isNotEmpty(value, field) {\n        const supportsPlaceholder = !!('placeholder' in document.createElement('input'));\n\n        if (!supportsPlaceholder && field &&\n            (value === field.attr('placeholder') || value === Locale.translate('Required'))) {\n          return false;\n        }\n\n        if (typeof value === 'string') {\n          // strip out any HTML tags and focus only on text content.\n          value = $.trim(value.replace(/<\\/?[^>]*>/g, ''));\n          if ($.trim(value).length === 0) {\n            return false;\n          }\n          return true;\n        }\n\n        if (typeof value === 'number') {\n          if (isNaN(value)) {\n            return false;\n          }\n          return true;\n        }\n\n        if ($.isArray(value)) {\n          return value.length > 0;\n        }\n\n        return (!!value);\n      },\n\n      // Check if at least one radio button checked in group\n      isRadioChecked(field) {\n        const name = field.attr('name');\n        return (name && name.length && $(`input[name=\"${name}\"]:radio:checked`).length);\n      },\n\n      check(value, field) {\n        let self = this; // eslint-disable-line\n\n        this.message = Locale.translate('Required');\n        let valid = true;\n\n        valid = field.is(':radio') ? this.isRadioChecked(field) : this.isNotEmpty(value, field);\n        return valid;\n      },\n      message: 'Required',\n      type: 'error',\n      id: 'required'\n    },\n\n    // date: Validate date, datetime (24hr or 12hr am/pm)\n    date: {\n      check(value, field) {\n        this.message = Locale.translate('InvalidDate');\n\n        if (value instanceof Date) {\n          return value && value.getTime && !isNaN(value.getTime());\n        }\n\n        let dateFormat = (value.indexOf(':') > -1) ? Locale.calendar().dateFormat.datetime : Locale.calendar().dateFormat.short;\n\n        if (field && field.data('datepicker')) {\n          dateFormat = field.data('datepicker').pattern;\n        }\n\n        const isStrict = !(dateFormat === 'MMMM d' || dateFormat === 'yyyy');\n        const parsedDate = Locale.parseDate(value, dateFormat, isStrict);\n        return !(((parsedDate === undefined) && value !== ''));\n      },\n      message: 'Invalid Date',\n      type: 'error',\n      id: 'date'\n    },\n\n    // Validate date, disable dates\n    availableDate: {\n      check(value, field) {\n        this.message = Locale.translate('UnavailableDate');\n        let check = true;\n\n        if (value === '') {\n          return check;\n        }\n\n        if (!self.rules.date.check(value, field)) {\n          // not a validate date so that will fail instead\n          check = false;\n          this.message = '';\n          return check;\n        }\n\n        const datepickerApi = field.data('datepicker');\n        const options = datepickerApi ? datepickerApi.settings : {};\n        const hasOptions = Object.keys(options).length > 0;\n        let d;\n        let i;\n        let l;\n        let min;\n        let max;\n        let dateObj = value;\n        if (typeof dateObj === 'string') {\n          let format = options.dateFormat !== 'locale' ?\n            options.dateFormat : Locale.calendar().dateFormat.short;\n          if (options.showTime) {\n            const timeFormat = options.timeFormat || Locale.calendar().timeFormat;\n            format += ` ${timeFormat}`;\n          }\n          dateObj = Locale.parseDate(dateObj, format);\n        }\n        let d2 = options.useUTC ? Locale.dateToUTC(dateObj) : dateObj;\n\n        // TODO: The developer will have to set disabled dates in arabic as arrays,\n        // will come back to this for now its not supported in arabic.\n        if (d2 instanceof Array) {\n          return check;\n        }\n\n        if (d2 && hasOptions) {\n          min = (options.useUTC ?\n            Locale.dateToUTC(new Date(options.disable.minDate)).setHours(0, 0, 0, 0) :\n            new Date(options.disable.minDate).setHours(0, 0, 0, 0));\n          max = (options.useUTC ?\n            Locale.dateToUTC(new Date(options.disable.maxDate)).setHours(0, 0, 0, 0) :\n            new Date(options.disable.maxDate).setHours(0, 0, 0, 0));\n\n          // dayOfWeek\n          if (options.disable.dayOfWeek.indexOf(d2.getDay()) !== -1) {\n            check = false;\n          }\n\n          d2 = d2.setHours(0, 0, 0, 0);\n\n          // min and max\n          if ((d2 <= min) || (d2 >= max)) {\n            check = false;\n          }\n\n          // dates\n          if (options.disable.dates.length && typeof options.disable.dates === 'string') {\n            options.disable.dates = [options.disable.dates];\n          }\n          for (i = 0, l = options.disable.dates.length; i < l; i++) {\n            d = options.useUTC ? Locale.dateToUTC(options.disable.dates[i]) :\n              new Date(options.disable.dates[i]);\n\n            if (d2 === d.setHours(0, 0, 0, 0)) {\n              check = false;\n              break;\n            }\n          }\n        }\n        if (hasOptions) {\n          check = !!(((check && !options.disable.isEnable) ||\n            (!check && options.disable.isEnable)));\n        }\n\n        return check;\n      },\n      message: 'Unavailable Date',\n      type: 'error',\n      id: 'availableDate'\n    },\n\n    // Range date\n    rangeDate: {\n      check(value, field) {\n        this.message = Locale.translate('rangeDate');\n        let check = true;\n        const api = field.data('datepicker');\n        if (api) {\n          const s = api.settings;\n          const parts = value.split(s.range.separator);\n          const checkRule = (rule, newvalue) => {\n            field.val(newvalue);\n            this.message = `${self.rules[rule].message} (${newvalue})`;\n            if (!self.rules[rule].check(newvalue, field)) {\n              check = false;\n            }\n          };\n          if (parts.length === 2) {\n            checkRule('date', parts[0]);\n            if (check) {\n              checkRule('date', parts[1]);\n            }\n            if (check) {\n              checkRule('availableDate', parts[0]);\n            }\n            if (check) {\n              checkRule('availableDate', parts[1]);\n            }\n          }\n        }\n        field.val(value);\n        return check;\n      },\n      message: 'Range Dates',\n      type: 'error',\n      id: 'rangeDate'\n    },\n\n    email: {\n      check(value) {\n        this.message = Locale.translate('EmailValidation');\n        const regex = /^([\\w-]+(?:\\.[\\w-]+)*)@((?:[\\w-]+\\.)*\\w[\\w-]{0,66})\\.([a-z]{2,16}(?:\\.[a-z]{2})?)$/i;\n\n        return (value.length) ? regex.test(value) : true;\n      },\n      message: 'EmailValidation',\n      type: 'error',\n      id: 'email'\n    },\n\n    enableSubmit: {\n      check(value, field) {\n        const submit = field.closest('.signin').find('button[type=\"submit\"]');\n        const ok = ((value.length) && (self.rules.email.check(value) ||\n            self.rules.passwordConfirm.check(value, field)));\n\n        if (ok) {\n          submit.enable();\n        } else {\n          submit.disable();\n        }\n        return true;\n      },\n      message: '',\n      type: 'error',\n      id: 'enableSubmit'\n    },\n\n    emailPositive: {\n      check(value, field) {\n        if ($.trim(value).length && !field.is('[readonly]')) {\n          self.rules.emailPositive.positive = true;\n          this.message = Locale.translate('EmailValidation');\n\n          const isValid = self.rules.email.check(value, field);\n\n          if (isValid) {\n            this.message = '';\n          }\n\n          return isValid;\n        }\n        self.rules.emailPositive.positive = false;\n        return true;\n      },\n      message: 'EmailValidation',\n      type: 'error',\n      id: 'emailPositive'\n    },\n\n    passwordReq: {\n      check(value) {\n        this.message = Locale.translate('PasswordValidation');\n        /* Must be at least 10 characters which contain at least\n        ** one lowercase letter,\n        ** one uppercase letter,\n        ** one numeric digit\n        ** and one special character */\n        const regex = /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\\s).{10,}$/;\n        return (value.length) ? value.match(regex) : true;\n      },\n      message: 'PasswordValidation',\n      type: 'error',\n      id: 'passwordReq'\n    },\n\n    passwordConfirm: {\n      check(value, field) {\n        this.message = Locale.translate('PasswordConfirmValidation');\n        let passwordValue = $(`input[type=\"password\"]:not(${field.attr('id')})`, field.closest('.signin')).eq(0).val(), // eslint-disable-line\n          check = ((value === passwordValue) && (self.rules.passwordReq.check(passwordValue))); // eslint-disable-line\n        return (value.length) ? check : true;\n      },\n      message: 'PasswordConfirmValidation',\n      type: 'error',\n      id: 'passwordConfirm'\n    },\n\n    time: {\n      check(value, field) {\n        value = value.replace(/ /g, '');\n        this.message = Locale.translate('InvalidTime');\n        const timepicker = field && field.data('timepicker');\n        const timepickerSettings = timepicker ? field.data('timepicker').settings : {};\n        const pattern = timepickerSettings && timepickerSettings.timeFormat ?\n          timepickerSettings.timeFormat :\n          Locale.calendar().timeFormat;\n        const is24Hour = (pattern.match('HH') || []).length > 0;\n        const maxHours = is24Hour ? 24 : 12;\n        const sep = value.indexOf(Locale.calendar().dateFormat.timeSeparator);\n        let valueHours = 0;\n        let valueMins = 0;\n        let valueSecs = 0;\n        let valueM;\n        let timeparts;\n\n        if (value === '') {\n          return true;\n        }\n\n        valueHours = parseInt(value.substring(0, sep), 10);\n        valueMins = parseInt(value.substring(sep + 1, sep + 3), 10);\n\n        // getTimeFromField\n        if (timepicker) {\n          timeparts = timepicker.getTimeFromField();\n\n          valueHours = timeparts.hours;\n          valueMins = timeparts.minutes;\n\n          if (timepicker.hasSeconds()) {\n            valueSecs = timeparts.seconds;\n          }\n        }\n\n        if (valueHours.toString().length < 1 || isNaN(valueHours) ||\n          parseInt(valueHours, 10) < 0 || parseInt(valueHours, 10) > maxHours) {\n          return false;\n        }\n        if (valueMins.toString().length < 1 || isNaN(valueMins) ||\n          parseInt(valueMins, 10) < 0 || parseInt(valueMins, 10) > 59) {\n          return false;\n        }\n        if (valueSecs.toString().length < 1 || isNaN(valueSecs) ||\n          parseInt(valueSecs, 10) < 0 || parseInt(valueSecs, 10) > 59) {\n          return false;\n        }\n\n        // AM/PM\n        if (!is24Hour) {\n          if (parseInt(valueHours, 10) < 1) {\n            return false;\n          }\n          const period0 = new RegExp(Locale.calendar().dayPeriods[0], 'i');\n          const period1 = new RegExp(Locale.calendar().dayPeriods[1], 'i');\n\n          valueM = value.match(period0) || value.match(period1) || [];\n          if (valueM.length === 0) {\n            return false;\n          }\n        }\n\n        return true;\n      },\n      message: 'Invalid Time',\n      type: 'error',\n      id: 'time'\n    },\n\n    // Test validation function which always returns false\n    test: {\n      check(value) {\n        return value === '1';\n      },\n      message: 'Value is not valid (test).',\n      type: 'error',\n      id: 'test'\n    }\n  };\n}\n\nconst Validation = new ValidationRules();\n\nexport { Validation };\n","import * as debug from '../../utils/debug';\nimport { utils, math } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { renderLoop, RenderLoopItem } from '../../utils/renderloop';\nimport { Locale } from '../../../src/components/locale/locale';\n\n// Component Name\nconst COMPONENT_NAME = 'toast';\n\n// Default Component Settings\nconst TOAST_DEFAULTS = {\n  title: '(Title)',\n  message: '(Content)',\n  position: 'top right',\n  audibleOnly: false,\n  progressBar: true,\n  timeout: 6000,\n  allowLink: false\n};\n\n/**\n * Toast Component.  This component produces small, temporary messages in\n *  one of the application's corners.\n * @constructor\n * @param {HTMLElement} element the target location for the Toast message\n * @param {object} [settings] incoming settings\n * @param {string} [settings.title = '(Title)'] Text that is displayed in the Toast's title.\n * @param {string} [settings.message = '(Content)' ] Text that's displayed in the Toast's body.\n * @param {string} [settings.position = 'top right'] Text that propagates into CSS classes that position the Toast in specific places\n * Can be top left, bottom left, bottom rightx\n * @param {boolean} [settings.audibleOnly = false] if true, causes the toast to be invisble on the screen, but still read out lout by screen readers.\n * @param {boolean} [settings.progressBar = true] causes the toast to have a visible progress bar that will be completely\n * disappeared when the toast should be removed.\n * @param {number} [settings.timeout = 6000] the amount of time the toast should be present on-screen.\n * @param {boolean} [settings.allowLink = false] if true, allows user to put links in the toast message.\n */\nfunction Toast(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(element, settings, TOAST_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Toast Methods\nToast.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.show();\n  },\n\n  /**\n   * Show a Single Toast Message\n   * @private\n   * @returns {void}\n   */\n  show() {\n    const self = this;\n    const settings = self.settings;\n    const maxHideTime = parseFloat(math.convertDelayToFPS(settings.timeout));\n    let isPausePlay = false;\n    let percentage = 100;\n    let container = $('#toast-container');\n    let toast = $(`\n      <div class=\"toast\">\n        <span class=\"toast-title\">${xssUtils.stripHTML(settings.title)}</span>\n        <span class=\"toast-message\">${xssUtils.stripHTML(settings.message)}</span>\n      </div>`);\n    if (settings.allowLink) {\n      toast = $(`\n        <div class=\"toast\">\n          <span class=\"toast-title\">${xssUtils.stripHTML(settings.title)}</span>\n          <span class=\"toast-message\">${xssUtils.stripTags(settings.message, '<a>')}</span>\n        </div>`);\n    }\n    const closeBtn = $(`\n      <button type=\"button\" class=\"btn-icon btn-close\" title=\"${Locale.translate('Close')}\" aria-hidden=\"true\">\n        ${$.createIcon('close')}\n        <span class=\"audible\">${Locale.translate('Close')}</span>\n      </button>\n    `);\n    const progress = $('<div class=\"toast-progress\"></div>');\n\n    if (!container.length) {\n      container = $('<div id=\"toast-container\" class=\"toast-container\" aria-relevant=\"additions\" aria-live=\"polite\"></div>').appendTo('body');\n    }\n\n    container.removeClass('toast-top-left toast-top-right toast-bottom-right toast-bottom-left')\n      .addClass(`toast-${settings.position.replace(' ', '-')}`);\n\n    settings.timeout = settings.audibleOnly ? 100 : settings.timeout;\n\n    if (settings.progressBar) {\n      toast.append(progress);\n    }\n\n    // Build the RenderLoop integration\n    const timer = new RenderLoopItem({\n      duration: math.convertDelayToFPS(settings.timeout),\n      timeoutCallback() {\n        self.remove(toast);\n      },\n      updateCallback(data) {\n        percentage = ((data.duration - data.elapsedTime) / maxHideTime) * 100;\n\n        if (Locale.isRTL()) {\n          percentage = 100 - percentage;\n        }\n\n        if (settings.progressBar) {\n          progress[0].style.width = `${percentage}%`;\n        }\n      }\n    });\n    renderLoop.register(timer);\n\n    container.append(toast);\n    toast.addClass((settings.audibleOnly ? 'audible' : 'effect-scale'));\n    toast.append(closeBtn);\n\n    $(document).on('keydown keyup', (e) => {\n      e = e || window.event;\n      if (e.ctrlKey && e.altKey && e.keyCode === 80) { // [Control + Alt + P] - Pause/Play toggle\n        isPausePlay = e.type === 'keydown';\n        timer[isPausePlay ? 'pause' : 'resume']();\n      }\n    });\n\n    toast.on('mousedown.toast touchstart.toast mouseup.toast touchend.toast', (e) => {\n      isPausePlay = !!/mousedown|touchstart/i.test(e.type);\n      timer[isPausePlay ? 'pause' : 'resume']();\n    });\n\n    closeBtn.on('click', () => {\n      timer.destroy();\n      self.remove(toast);\n    });\n  },\n\n  /**\n   * Remove the Message and Animate\n   * @private\n   * @param {jQuery[]|HTMLElement} toast the toast message to be removed\n   * @returns {void}\n   */\n  remove(toast) {\n    if (this.settings.audibleOnly) {\n      toast.remove();\n      return;\n    }\n\n    toast.addClass('effect-scale-hide');\n\n    const closeTimer = new RenderLoopItem({\n      duration: 20,\n      updateCallback() {}, // TODO: make this work without an empty function\n      timeoutCallback() {\n        toast.remove();\n      }\n    });\n    renderLoop.register(closeTimer);\n  },\n\n  /**\n   * @param {object} [settings] incoming settings\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, TOAST_DEFAULTS);\n    }\n    this.show();\n  },\n\n  /**\n   * Teardown\n   * @returns {void}\n   */\n  destroy() {\n    $('#toast-container').remove();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Toast, COMPONENT_NAME };\n","import { Toast, COMPONENT_NAME } from './toast';\n\n/**\n * jQuery Plugin Wrapper for Toast\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.toast = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Toast(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { Validation } from './validation';\n\n// jQuery Components\nimport '../icons/icons.jquery';\nimport '../toast/toast.jquery';\nimport { Environment as env } from '../../utils/environment';\n\n// Component Name\nconst COMPONENT_NAME = 'Validator';\n\n/**\n * Validation Message Defaults\n * @namespace\n * @property {boolean} inline\n * @property {string} message\n * @property {string} type\n * @property {boolean} showTooltip\n * @property {boolean} isHelpMessage\n */\nconst VALIDATION_MESSAGE_DEFAULTS = {\n  inline: true,\n  message: '',\n  type: 'error',\n  showTooltip: false,\n  isHelpMessage: false\n};\n\n/**\n * @class Validator\n * @constructor\n * @param {jQuery[]|HTMLElement} element the base element\n * @param {object} [settings] incoming settings\n */\nfunction Validator(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, VALIDATION_MESSAGE_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Object\nValidator.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.fields = 'input, textarea, select, div[data-validate], div[data-validation]';\n    this.isPlaceholderSupport = !!('placeholder' in document.createElement('input'));// placeholder native support is-exists\n\n    // If we initialize with a form find all inputs\n    this.inputs = this.element.find(this.fields);\n\n    // Or Just use the current input\n    if (this.element.is(this.fields)) {\n      this.inputs = $().add(this.element);\n    }\n\n    this.element.addClass('validation-active');\n    this.timeout = null;\n\n    this.attachEvents();\n  },\n\n  /**\n   * Gets a list of events\n   * @private\n   * @param {string} events a single event name, or a JSON-representation of several events\n   * @returns {void}\n   */\n  extractEvents(events) {\n    if (events.indexOf('{') > -1) {\n      events = JSON.parse(events.replace(/'/g, '\"'));\n    }\n\n    if (typeof events === 'object') {\n      let e = '';\n      for (const k in events) { // eslint-disable-line\n        if (e.indexOf(events[k]) === -1) {\n          e += `${events[k]} `;\n        }\n      }\n      e = e.split(' ').join('.validate ');\n      events = e;\n    }\n\n    return events;\n  },\n\n  /**\n   * @private\n   * @param {string} events a single event name, or a JSON-representation of several events\n   * @param {string} type a type of event to filter against\n   * @returns {array} of event types in string format\n   */\n  filterValidations(events, type) {\n    const validations = [];\n\n    if (!events) {\n      return [];\n    }\n\n    if (events.indexOf('{') > -1) {\n      events = JSON.parse(events.replace(/'/g, '\"'));\n    }\n\n    if (typeof events === 'object') {\n      for (const k in events) { // eslint-disable-line\n        if (type && events[k].indexOf(type) > -1) {\n          validations.push(k);\n        }\n      }\n    }\n\n    return validations;\n  },\n\n  /**\n   * Set error icon opacity for tooltip types, to avoid overlap text in the field\n   * @private\n   * @param {object} field validation element\n   * @returns {void}\n   */\n  setErrorIconOpacity(field) {\n    if (field.is(':text') && field.is('[data-error-type=\"tooltip\"]')) {\n      const textWidth = this.calculateTextWidth(field.val());\n      const fieldWidth = field.outerWidth() - 35; // 35: icon width + padding/margin\n      field.closest('.field, .field-short')\n        .find('.icon-error')[(textWidth > fieldWidth) ? 'addClass' : 'removeClass']('lower-opacity');\n    }\n  },\n\n  /**\n   * Calculate the width for given text\n   * @param {string} text to calculate the width\n   * @param {string} font used with given text (e.g. `14px arial`).\n   * @returns {number} the calculated width\n   */\n  calculateTextWidth(text, font) {\n    // use cached canvas for better performance, else, create new canvas\n    this.canvas = this.canvas || (this.canvas = document.createElement('canvas'));\n    const context = this.canvas.getContext('2d');\n    context.font = font || '14px arial';\n    const metrics = context.measureText(text);\n    return metrics.width;\n  },\n\n  /**\n   * @private\n   */\n  attachEvents() {\n    const self = this;\n    const attribs = '[data-validate],[data-validation]';\n\n    // Attach required\n    this.inputs.each(function () {\n      const field = $(this);\n      const attr = field.attr('data-validate') || field.attr('data-validation');\n\n      if (attr && attr.indexOf('required') > -1) {\n        field.addClass('required');\n      }\n    });\n\n    // Link on to the current object and perform validation.\n    this.inputs.filter('input, textarea, div').filter(attribs).not('input[type=checkbox], input[type=file]').each(function () {\n      const field = $(this);\n      const eventAttr = field.attr('data-validation-events');\n      const events = self.extractEvents(eventAttr || 'blur.validate change.validate keyup.validate');\n\n      // Custom enter event\n      if (events.indexOf('enter.validate') > -1) {\n        field.off('keypress.enter.validate').on('keypress.enter.validate', function (e) {\n          const thisField = $(this);\n          if (e.which === 13) {\n            self.validate(thisField, true, e);\n          }\n        });\n      }\n\n      field.off(events).on(events, function (e) {\n        if (e.type === 'keyup') {\n          // Skip on Tab\n          if (e.keyCode === 9) {\n            return;\n          }\n          self.setErrorIconOpacity(field);\n        }\n\n        const thisField = $(this);\n        const handleEventData = thisField.data(`handleEvent${[(e.type || '')]}`);\n\n        if (thisField.is('[readonly]') && !thisField.parent().is('.field-fileupload')) {\n          return;\n        }\n\n        if (handleEventData &&\n            handleEventData.type === e.type &&\n            e.handleObj.namespace === 'validate' &&\n            !thisField.closest('.modal:visible').length) {\n          return;\n        }\n        thisField.data(`handleEvent${[(e.type || '')]}`, e.handleObj);\n\n        setTimeout(() => {\n          if (thisField.closest('.modal-engaged').length && !thisField.closest('.modal-body').length) {\n            return;\n          }\n\n          self.validate(field, true, e);\n        }, 300);\n      });\n    });\n\n    this.inputs.filter('input[type=checkbox]').filter(attribs).off('click.validate').on('click.validate', function (e) {\n      self.validate($(this), true, e);\n    });\n\n    this.inputs.filter(':radio').off('click.validate').on('click.validate', function (e) {\n      const first = $(this).parent().find('.radio').first();\n      self.validate(first, true, e);\n    });\n\n    const selects = this.inputs.filter('select').filter(attribs);\n\n    if (selects.length) {\n      selects.off('change.validate listopened.validate listclosed.validate').on('change.validate', function (e) {\n        self.validate($(this), true, e);\n      }).on('listopened.validate', function () {\n        const thisField = $(this);\n        const tooltip = thisField.data('tooltip');\n\n        thisField.next('.dropdown-wrapper').next('.error-message').hide();\n        if (tooltip && document.activeElement === thisField.data('dropdown').searchInput[0]) {\n          tooltip.hide();\n        }\n        $('#validation-tooltip').hide();\n      }).on('listclosed.validate', function () {\n        const thisField = $(this);\n        let tooltip = thisField.data('tooltip');\n        const dropdownApi = thisField.data('dropdown');\n\n        if (env.features.touch) {\n          dropdownApi.pseudoElem.focus();\n          setTimeout(() => {\n            dropdownApi.pseudoElem.blur();\n          }, 100);\n        }\n\n        if (dropdownApi && dropdownApi.wrapper) {\n          tooltip = dropdownApi.wrapper\n            .find('.icon-error').data('tooltip');\n        }\n\n        thisField.next('.dropdown-wrapper').next('.error-message').show();\n        if (tooltip && document.activeElement !== thisField.data('dropdown').searchInput[0]) {\n          tooltip.show();\n        }\n      });\n\n      selects.filter(function () {\n        return $(this).data('dropdown') !== undefined;\n      }).each(function () {\n        const pseudoElem = $(this).data('dropdown').pseudoElem;\n        pseudoElem.off('blur.validate').on('blur.validate', function (e) {\n          const select = $(this).closest('.field, .field-short').find('select');\n          self.validate(select, true, e);\n        });\n      });\n    }\n\n    // Attach to Form Submit and Validate\n    if (this.element.is('form') && this.element.attr('data-validate-on')) {\n      const submitHandler = function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n\n        self.validateForm((isValid) => {\n          self.element.off('submit.validate');\n          self.element.triggerHandler('validated', isValid);\n          self.element.data('isValid', isValid);\n          self.element.on('submit.validate', submitHandler);\n        });\n      };\n\n      this.element.off('submit.validate').on('submit.validate', submitHandler);\n    }\n  },\n\n  /**\n   * Validates all elements inside of a form\n   * @private\n   * @param {function} callback method to call when the form's validation completes.\n   */\n  validateForm(callback) {\n    const self = this;\n    const deferreds = [];\n\n    self.inputs = this.element.find(self.fields);\n    self.inputs.each(function (e) {\n      const field = $(this);\n      if (field.attr('data-validate')) {\n        if (field.attr('data-disable-validation') === 'true' || field.hasClass('disable-validation')) {\n          return;\n        }\n\n        const dfds = self.validate(field, false, e);\n        for (let i = 0; i < dfds.length; i++) {\n          deferreds.push(dfds[i]);\n        }\n      }\n    });\n\n    $.when(...deferreds).then(() => {\n      callback(true);\n    }, () => {\n      callback(false);\n    });\n  },\n\n  /**\n   * Set disable/enable primary button in modal\n   * @private\n   * @param {jQuery[]|HTMLElement} field the target element\n   * @param {jQuery[]|HTMLElement} modalBtn the button that needs to be set to primary.\n   * @returns {void}\n   */\n  setModalPrimaryBtn(field, modalBtn) {\n    const modal = field.closest('.modal');\n    const modalFields = modal.find('[data-validate]:visible, select[data-validate], :checkbox[data-validate]');\n    let allValid = true;\n\n    if (modalFields.length > 0) {\n      modalFields.each(function () {\n        const modalField = $(this);\n\n        if (modalField.closest('.datagrid-filter-wrapper').length > 0) {\n          return;\n        }\n        const isVisible = modalField[0].offsetParent !== null;\n        if (modalField.is('.required')) {\n          if (isVisible && modalField.is('.editor') && !modalField.html()) {\n            allValid = false;\n          }\n          if ((isVisible || modalField.is('select, :checkbox')) && !modalField.val() && !modalField.is('.editor')) {\n            allValid = false;\n          }\n        }\n        if ((isVisible || modalField.is('select, :checkbox')) && !modalField.isValid()) {\n          allValid = false;\n        }\n      });\n    }\n\n    if (allValid) {\n      modalBtn.removeAttr('disabled');\n    } else {\n      modalBtn.attr('disabled', 'disabled');\n    }\n  },\n\n  /**\n   * Gets the current value of a field\n   * @private\n   * @param {jQuery[]} field the field being checked.\n   * @returns {any} the value of the field.\n   */\n  value(field) {\n    if (field.is('input[type=checkbox]')) {\n      return field.prop('checked');\n    }\n    if (field.is('div')) { // contentEditable div (Rich Text)\n      return field[0].innerHTML;\n    }\n    return field.val();\n  },\n\n  /**\n   * Get the types of validation from a field.\n   * @private\n   * @param {jQuery[]} field the field being checked\n   * @param {jQuery.Event} e the `validate` event\n   * @returns {array} an array of types\n   */\n  getTypes(field, e) {\n    const filters = this.filterValidations(field.attr('data-validation-events'), e.type);\n    let validations;\n\n    if (field.is('input.dropdown') && field.prev().prev('select').attr('data-validate')) {\n      validations = field.prev().prev('select').attr('data-validate').split(' ');\n    } else if (field.is('input.dropdown') && field.prev().prev('select').attr('data-validation')) {\n      validations = field.prev().prev('select').attr('data-validation').split(' ');\n    } else if (field.attr('data-validation')) {\n      validations = field.attr('data-validation').split(' ');\n    } else if (field.attr('data-validate')) {\n      validations = field.attr('data-validate').split(' ');\n    } else {\n      validations = [];\n    }\n\n    // Filter out not needed events\n    if (filters.length > 0) {\n      validations = validations.filter(n => filters.indexOf(n) !== -1);\n    }\n\n    // Filter out specific events that should not use keyup\n    if (e.type === 'keyup') {\n      validations = validations.filter(n => n !== 'date' && n !== 'time');\n    }\n\n    return validations;\n  },\n\n  /**\n   * Set icon on parent tabs/expandable\n   * @private\n   * @param {jQuery[]} field the field being appended to.\n   * @param {string} type the type of icon being appended.\n   * @returns {void}\n   */\n  setIconOnParent(field, type) {\n    const errorIcon = $.createIcon({ classes: [`icon-${type}`], icon: type });\n    const parent = field.closest('.tab-panel, .expandable-pane');\n    let iconTarget = parent.attr('id');\n    let parentContainer = field.closest('.tab-container, .tab-panel-container, .expandable-area');\n    let iconContainer;\n    let dropdown;\n    let dropdownParent;\n\n    // Tabs\n    if (parentContainer.is('.tab-panel-container')) {\n      parentContainer = parentContainer.prev('.tab-container');\n    }\n    if (parentContainer.is('.tab-container')) {\n      // Default Tabs\n      iconContainer = $(`.tab-list a[href=\"#${iconTarget}\"]`, parentContainer).closest('.tab');\n\n      // Tabs with Counts\n      if (iconContainer.length) {\n        if ($('.count', iconContainer).length) {\n          iconContainer = $('.count', iconContainer);\n        }\n      } else {\n        // Dropdown Tabs (with popupmenu)\n        iconTarget = $(`a[href=\"#${iconTarget}\"]`, '.popupmenu').closest('.popupmenu').attr('id');\n        iconContainer = $(`.tab-list .tab[aria-controls=\"${iconTarget}\"]`, parentContainer);\n        dropdown = iconTarget;\n      }\n    } else if (parentContainer.is('.expandable-area')) {\n      // Expandable\n      iconContainer = $(`.expandable-header[aria-controls=\"${iconTarget}\"] .title`, parentContainer);\n    } else {\n      // No action\n      return;\n    }\n\n    // if Dropdown Tabs set each menu item to check\n    if (dropdown && dropdown.length) {\n      dropdownParent = parent.add($($(dropdown).attr('href')));\n      $('a[role=\"menuitem\"]', `#${dropdown}`).each(function () {\n        dropdownParent = dropdownParent.add($($(this).attr('href')));\n      });\n    }\n    const menuitem = $(`a[href=\"#${parent.attr('id')}\"]`, `#${iconTarget}`);\n\n    // Add icon\n    if ((!!parent && $(`.${type}`, parent).length) ||\n        (!!dropdownParent && $(`.${type}`, dropdownParent).length)) {\n      // if Dropdown Tabs and current menu item has no error remove icon\n      if (!$(`.${type}`, parent).length) {\n        menuitem.removeClass(`is-${type}`);\n        $(`.icon-${type}`, menuitem).remove();\n      }\n\n      // if Dropdown Tabs and current menu item has error add icon\n      if ($(`.${type}`, parent).length &&\n          $(`.${type}`, dropdownParent).length &&\n          !$(`.icon-${type}`, menuitem).length) {\n        menuitem.addClass(`is-${type}`).append(errorIcon);\n      }\n\n      // Add icon to main tab area\n      if (!($(`.icon-${type}`, iconContainer).length)) {\n        iconContainer.addClass(`is-${type}`).append(errorIcon);\n      }\n    } else {\n      // Remove icon\n      iconContainer = iconContainer.add(menuitem);\n      iconContainer.removeClass(`is-${type}`);\n      $(`.icon-${type}`, iconContainer).remove();\n    }\n  },\n\n  /**\n   * @private\n   * @param {jQuery[]} field the field being validated\n   * @param {boolean} showTooltip whether or not this field should display its validation message in a tooltip\n   * @param {jQuery.Event} e the `validate` event\n   * @returns {array} of jQuery deferred objects\n   */\n  validate(field, showTooltip, e) {\n    field.data(`handleEvent${[(e.type || '')]}`, null);\n\n    if (field.attr('data-disable-validation') === 'true' || field.hasClass('disable-validation') || field.is(':disabled')) {\n      return [];\n    }\n\n    // call the validation function inline on the element\n    const self = this;\n    const types = self.getTypes(field, e) || [];\n    let rule;\n    let dfd;\n    const dfds = [];\n    const results = [];\n    let i;\n    let l;\n    let validationType;\n    const value = self.value(field);\n    const placeholder = field.attr('placeholder');\n\n    function manageResult(result, showResultTooltip, type, dfrd) {\n      rule = Validation.rules[type];\n      // Only remove if \"false\", not any other value ie.. undefined\n      if (rule.positive === false) {\n        self.removePositive(field);\n      }\n\n      validationType = Validation.ValidationTypes[rule.type] || Validation.ValidationTypes.error;\n      const isInline = field.attr(`data-${validationType.type}-type`) !== 'tooltip';\n\n      if (!result) {\n        if (!self.isPlaceholderSupport && (value === placeholder) &&\n           (rule.message !== Locale.translate('Required'))) {\n          return;\n        }\n        self.addMessage(field, rule, isInline, showResultTooltip);\n        results.push(rule.type);\n\n        if (validationType.errorsForm) {\n          dfrd.reject();\n        } else {\n          dfrd.resolve();\n        }\n      } else if ($.grep(results, res => res === validationType.type).length === 0) {\n        dfrd.resolve();\n\n        if (rule.positive) {\n          // FIX: In Contextual Action Panel control not sure why but need to add error,\n          // otherwise \"icon-success\" get misaligned,\n          // so for this fix adding and then removing error here\n\n          self.addMessage(field, rule, isInline, showResultTooltip);\n          self.removeMessage(field, rule, true);\n          dfrd.resolve();\n\n          self.addPositive(field);\n        }\n      } else if (!validationType.errorsForm) {\n        // Rules that do not error the form need to resolve\n        dfrd.resolve();\n      }\n\n      self.setIconOnParent(field, rule.type);\n      const loc = self.getField(field);\n      const data = loc.data(`${validationType.type}message`);\n\n      if (result && data && data.filter(rules => rules.id === rule.id || rule.message).length > 0) {\n        self.removeMessage(field, rule, true);\n      }\n\n      // Test Enabling primary button in modal\n      const modalBtn = field.closest('.modal').find('.btn-modal-primary').not('.no-validation');\n      if (modalBtn.length) {\n        self.setModalPrimaryBtn(field, modalBtn);\n      }\n\n      if (rule.type === 'error') {\n        field.closest('form').triggerHandler('aftervalidate', { field, rule, isValid: result });\n      }\n    }\n\n    for (i = 0, l = types.length; i < l; i++) {\n      rule = Validation.rules[types[i]];\n\n      dfd = $.Deferred();\n\n      if (!rule) {\n        continue;\n      }\n\n      if ($('#calendar-popup').is(':visible')) {\n        continue; // dont show validation message while selecting\n      }\n\n      if (rule.async) {\n        rule.check(value, field, manageResult, dfd);\n      } else {\n        manageResult(rule.check(value, field), showTooltip, types[i], dfd);\n      }\n      dfds.push(dfd);\n    }\n\n    return dfds;\n  },\n\n  /**\n   * Retrive the actionble element that should have an error class/icon appended to it.\n   * @private\n   * @param {jQuery[]} field the field being checked\n   * @returns {jQuery[]} the field to be checked\n   */\n  getField(field) {\n    if (field.is('select') && field.data('dropdown') !== undefined) {\n      field = field.data('dropdown').pseudoElem;\n    }\n    return field;\n  },\n\n  /**\n   * Returns true if the given object has an error\n   * @param {jQuery[]} field the field being checked\n   * @returns {boolean} whether or not the field currently has an error\n   */\n  hasError(field) {\n    return this.getField(field).hasClass('error');\n  },\n\n  /**\n   * Adds a validation message/icon to a form field.\n   * @private\n   * @param {jQuery[]} field the field to be appended\n   * @param {object} rule The validation message text\n   * @param {boolean} inline whether or not the text should appear inside the input field\n   *  (like a placeholder), or underneath the input field\n   * @param {boolean} showTooltip whether or not the legacy validation Tooltip will contain the\n   * message instead of placing it underneath\n   * @param {boolean} isHelpMessage whether or not this validation message type is \"alert\"\n   */\n  addMessage(field, rule, inline, showTooltip, isHelpMessage) {\n    if (rule.message === '') {\n      return;\n    }\n\n    if (field.is('.dropdown, .multiselect') && $('#dropdown-list').is(':visible')) {\n      return;\n    }\n\n    isHelpMessage = isHelpMessage || false;\n\n    const loc = this.getField(field);\n    let dataMsg = loc.data(`${rule.type}message`);\n    const validationType = Validation.ValidationTypes[rule.type] ||\n      Validation.ValidationTypes.error;\n\n    if (!isHelpMessage) {\n      loc.addClass(rule.type === 'icon' ? 'custom-icon' : rule.type);\n    }\n\n    // Inline messages are now an array\n    if (dataMsg && dataMsg === rule.message) {\n      // No need to add new message\n      return;\n    }\n\n    if (dataMsg &&\n      dataMsg.filter(rules =>\n        (rules.id || rules.message) === (rule.id || rule.message)\n        && rules.message === rule.message).length > 0) {\n      // No need to add new message\n      return;\n    }\n\n    let appendedMsg = rule.message;\n\n    if (dataMsg) {\n      for (let i = 0; i < dataMsg.length; i++) {\n        appendedMsg = `\\u2022 ${dataMsg[i].message}`;\n      }\n      appendedMsg += `<br>\\u2022 ${rule.message}`;\n    }\n\n    if (!dataMsg) {\n      dataMsg = [];\n    }\n\n    // Find the message by id and remove\n    field.closest('.field, .field-short').find(`[data-rule-id=\"${rule.id || rule.message}\"]`).remove();\n    if (field.hasClass('dropdown') || field.hasClass('multiselect')) {\n      field.parent().find(`.dropdown-wrapper > [data-rule-id=\"${rule.id || rule.message}\"]`).off('click.validate').remove();\n    }\n\n    // Remove the rule if it exists in the dataMsg\n    dataMsg = dataMsg.filter(rules => rules.id !== rule.id);\n\n    dataMsg.push({ id: rule.id, message: rule.message, type: rule.type });\n    loc.data(`${validationType.type}message`, dataMsg);\n\n    // Add Aria\n    if ($.fn.toast !== undefined) {\n      $('body').toast({\n        title: Locale.translate(validationType.titleMessageID),\n        audibleOnly: true,\n        message: appendedMsg\n      });\n    }\n\n    if (!inline) {\n      this.showTooltipMessage(field, appendedMsg, validationType.type, showTooltip);\n      return;\n    }\n\n    field.data('isValid', false);\n    this.showInlineMessage(field, rule, isHelpMessage);\n  },\n\n  /**\n   * Shows an error icon\n   * @private\n   * @param {jQuery[]} field the field being appended\n   * @param {string} type the error type\n   * @returns {jQuery[]} the new icon's markup\n   */\n  showIcon(field, type) {\n    const loc = this.getField(field).addClass(type === 'icon' ? 'custom-icon' : type);\n    let svg = $.createIconElement({ classes: [`icon-${type}`], icon: type });\n    const closestField = loc.closest('.field, .field-short');\n    const parent = field.parent();\n\n    if (closestField.find(`svg.icon-${type}`).length === 0) {\n      if (parent.is('.editor-container')) {\n        field.parent().addClass('is-error');\n      }\n\n      if (field.parent(':not(.editor-container)').find('.btn-actions').length === 1) {\n        parent.find('.btn-actions').before(svg);\n      } else if (parent.find('.data-description').length === 1) {\n        parent.find('.data-description').before(svg);\n      } else if (parent.find('.field-info').length === 1) {\n        parent.find('.field-info').before(svg);\n      } else if (field.is('textarea')) {\n        field.after(svg);\n      } else if (field.is('.dropdown, .multiselect')) {\n        parent.find('.dropdown-wrapper').append(svg);\n      } else if (field.is('.spinbox')) {\n        parent.append(svg);\n      } else if (field.is('.lookup')) {\n        parent.append(svg);\n      } else {\n        parent.append(svg);\n      }\n\n      $('.icon-success', closestField).remove();\n    } else {\n      svg = closestField.find('svg.icon-error');\n    }\n\n    return svg;\n  },\n\n  /**\n   * Shows an tooltip error\n   * @private\n   * @param {jQuery[]} field the field being appended\n   * @param {string} message text content containing the validation message.\n   * @param {string} type the validation type (error, alert, info, etc)\n   * @param {boolean} showTooltip whether or not to initially show the tooltip\n   */\n  showTooltipMessage(field, message, type, showTooltip) {\n    if (field.is(':radio')) {\n      return;\n    }\n\n    const icon = this.showIcon(field, type);\n    let representationField = field;\n\n    // Add error classes to pseudo-markup for certain controls\n    if (field.is('.dropdown, .multiselect') && field.data('dropdown') !== undefined) {\n      const input = field.data('dropdown').pseudoElem;\n      representationField = input;\n      input.addClass(type === 'icon' ? 'custom-icon' : type);\n    }\n    field.closest('.field, .field-short').find('.formatter-toolbar').addClass(type === 'icon' ? 'custom-icon' : type);\n\n    let tooltipAPI = icon.data('tooltip');\n\n    // Error tooltips should be positioned on the 'x' so that they sit directly\n    // underneath the fields that they are indicating.\n    function tooltipPositionCallback(placementObj) {\n      const fieldRect = representationField[0].getBoundingClientRect();\n      const elRect = tooltipAPI.tooltip[0].getBoundingClientRect();\n      const rtl = $('html').is('[dir=\"rtl\"]');\n      const currX = placementObj.x;\n      let xAdjustment = 0;\n\n      if (rtl) {\n        if (elRect.left < fieldRect.left) {\n          xAdjustment += (fieldRect.left - elRect.left);\n        }\n      } else if (elRect.right > fieldRect.right) {\n        xAdjustment += (elRect.right - fieldRect.right) * -1;\n      }\n\n      placementObj.setCoordinate('x', currX + xAdjustment);\n      if (!placementObj.nudges) {\n        placementObj.nudges = {};\n      }\n      placementObj.nudges.x = xAdjustment;\n\n      return placementObj;\n    }\n\n    // Build Tooltip\n    if (!tooltipAPI) {\n      icon.tooltip({\n        content: message,\n        placement: 'bottom',\n        placementOpts: {\n          callback: tooltipPositionCallback\n        },\n        trigger: 'focus',\n        isError: true,\n        tooltipElement: '#validation-tooltip'\n      });\n      tooltipAPI = icon.data('tooltip');\n    } else {\n      tooltipAPI.content = message;\n    }\n\n    field.on('focus.validate', () => {\n      if (!tooltipAPI) { return; }\n      tooltipAPI.show();\n    }).on('blur.validate', () => {\n      if (!tooltipAPI) { return; }\n      tooltipAPI.hide();\n    });\n\n    if (tooltipAPI) {\n      field.attr('data-error-type', 'tooltip');\n    }\n\n    this.setErrorIconOpacity(field);\n\n    if (showTooltip && tooltipAPI) {\n      tooltipAPI.show();\n    }\n  },\n\n  /**\n   * Shows an tooltip error\n   * @private\n   * @param {jQuery[]} field the field being toggled\n   * @param {string} message text content containing the validation message\n   * @param {string} type (error, alert, info, etc.)\n   * @param {HTMLElement} markup existing HTML markup to use\n   * @param {boolean} isShow whether or not the message is already showing\n   */\n  toggleRadioMessage(field, message, type, markup, isShow) {\n    let all;\n    let loc;\n    const name = field.attr('name');\n\n    if (name && name.length) {\n      all = $(`:radio[name=\"${name}\"], :radio[name=\"${name}\"] + label`);\n      loc = field.parent().is('.inline') ?\n        $(`:radio[name=\"${name}\"]:last`).parent() :\n        $(`:radio[name=\"${name}\"]:last + label`);\n\n      if (isShow) {\n        all.addClass(type === 'icon' ? 'custom-icon' : type);\n        $(markup).addClass(`radio-group-${type}`).insertAfter(loc);\n      } else {\n        all.removeClass(type);\n        loc.next(`.radio-group-${type}`).remove();\n      }\n    }\n  },\n\n  /**\n   * Shows an inline error message on a field\n   * @private\n   * @param {jQuery[]} field the field being modified\n   * @param {string} rule The validation rule data.\n   * @param {boolean} isHelpMessage whether or not the validation type is \"alert\"\n   */\n  showInlineMessage(field, rule, isHelpMessage) {\n    isHelpMessage = isHelpMessage || false;\n\n    const loc = this.getField(field);\n    const validationType = Validation.ValidationTypes[rule.type] ||\n      Validation.ValidationTypes.error;\n    rule.icon = rule.icon || validationType.icon;\n\n    let markup;\n    if (rule.type === 'icon') {\n      markup = '' +\n        `<div class=\"custom-icon-message\" data-rule-id=\"${rule.id || rule.message}\">\n          ${$.createIcon({ classes: ['icon-custom'], icon: rule.icon })}\n          <pre class=\"audible\">\n            ${Locale.translate(validationType.titleMessageID)}\n          </pre>\n          <p class=\"message-text\">${rule.message}</p>\n        </div>`;\n    } else {\n      markup = '' +\n        `<div class=\"${validationType.type}-message\" data-rule-id=\"${rule.id || rule.message}\">\n          ${$.createIcon({ classes: [`icon-${validationType.type}`], icon: validationType.type })}\n          <pre class=\"audible\">\n            ${Locale.translate(validationType.titleMessageID)}\n          </pre>\n          <p class=\"message-text\">${rule.message}</p>\n        </div>`;\n    }\n\n    if (!isHelpMessage) {\n      loc.addClass(rule.type === 'icon' ? 'custom-icon' : rule.type);\n    }\n\n    if (field.is(':radio')) {\n      this.toggleRadioMessage(field, rule.message, validationType.type, markup, true);\n    } else { // All other components\n      loc.closest('.field, .field-short').find('.formatter-toolbar').addClass(validationType.type === 'icon' ? 'custom-icon' : validationType.type);\n      loc.closest('.field, .field-short').append(markup);\n      loc.closest('.field, .field-short').find('.colorpicker-container').addClass(validationType.type === 'icon' ? 'custom-icon' : validationType.type);\n    }\n\n    if (field.is('.spinbox')) {\n      loc.closest('.spinbox-wrapper').addClass(validationType.type === 'icon' ? 'custom-icon' : validationType.type);\n    }\n\n    // Remove positive errors\n    if (validationType.type === 'error') {\n      field.parent().find('.icon-success').remove();\n    }\n\n    // Trigger an event\n    field.triggerHandler(validationType.type, { field, message: rule.message });\n    field.closest('form').triggerHandler(validationType.type, { field, message: rule.message });\n  },\n\n  /**\n   * Shows an inline error message on a field\n   * @private\n   * @param {jQuery[]} field the field being modified\n   */\n  addPositive(field) {\n    const svg = $.createIcon({ icon: 'success', classes: 'icon-success' });\n\n    if (!$('.icon-success', field.parent('.field, .field-short')).length) {\n      field.parent('.field, .field-short').append(svg);\n    }\n  },\n\n  /**\n   * Remove the message form the field if there is one and mark the field valid, if no other messages.\n   * @private\n   * @param {jQuery[]} field the field which is having its error removed\n   * @param {string} rule The validation rule to remove\n   * @param {boolean} triggerEvents If true events will be fired\n  */\n  removeMessage(field, rule, triggerEvents = true) {\n    // see if anything to remove\n    const loc = this.getField(field);\n    const oldData = loc.data(`${rule.type}message`);\n    const ruleId = rule.id || rule.message;\n\n    if (!rule) {\n      return;\n    }\n\n    if (rule.type === 'error' && !oldData || oldData.filter(rules => rules.id === ruleId).length === 0) {\n      return;\n    }\n\n    // Remove the message from the array\n    const newData = oldData.filter(rules => rules.id !== ruleId);\n    const noMoreMessages = newData.length === 0;\n\n    if (noMoreMessages) {\n      loc.removeData(`${rule.type}message`);\n    } else {\n      loc.data(`${rule.type}message`, newData);\n    }\n\n    // Find the message by id and remove\n    field.closest('.field, .field-short').find(`[data-rule-id=\"${rule.id || rule.message}\"]`).remove();\n\n    if (field.hasClass('dropdown') || field.hasClass('multiselect')) {\n      field.parent().find(`.dropdown-wrapper > [data-rule-id=\"${rule.id || rule.message}\"]`).off('click.validate').remove();\n    }\n\n    // Trigger valid and remove error / message classes\n    if (noMoreMessages && rule.type === 'error' && triggerEvents) {\n      field.triggerHandler('valid', { field, message: '' });\n      field.closest('form').triggerHandler('valid', { field, message: '' });\n    }\n\n    if (!noMoreMessages) {\n      return;\n    }\n\n    field.removeClass(`${rule.type} custom-icon`).data('isValid', true);\n\n    if (field.hasClass('dropdown') || field.hasClass('multiselect')) {\n      field.next().next().removeClass(`${rule.type} custom-icon`);\n      field.next().find('div.dropdown').removeClass(`${rule.type} custom-icon`);\n    }\n\n    if (field.is(':radio')) {\n      this.toggleRadioMessage(field, '', rule.type, '', false);\n    }\n\n    if (field.hasClass('spinbox')) {\n      field.closest('.spinbox-wrapper').removeClass(`${rule.type} custom-icon`);\n    }\n    if (field.hasClass('colorpicker')) {\n      field.parent('.colorpicker-container').removeClass(rule.type);\n    }\n    if (field.closest('.field-fileupload').length > 0) {\n      field.closest('.field-fileupload').find(`input.${rule.type}`).removeClass(rule.type);\n    }\n\n    // Remove tooltip style message and tooltip\n    if (field.attr(`data-${rule.type}-type`) === 'tooltip') {\n      const errorIcon = field.closest('.field, .field-short').find('.icon-error');\n      const tooltipAPI = errorIcon.data('tooltip');\n      // Destroy tooltip\n      if (tooltipAPI) {\n        tooltipAPI.destroy();\n      }\n      if (this.inputs) {\n        this.inputs.filter('input, textarea').off('focus.validate');\n      }\n      // Remove icon\n      field.parent().find(`.dropdown-wrapper > .icon-${rule.type}`).off('click.validate').remove(); // SVG Error Icon\n      field.parent().find(`.icon-${rule.type}`).remove();\n      field.next(`.icon-${rule.type}`).off('click.validate').remove();\n      field.parent('.field, .field-short').find(`.icon-${rule.type}`).remove();\n      field.next('.inforCheckboxLabel').next(`.icon-${rule.type}`).remove();\n    }\n  },\n\n  /**\n   * Shows an inline error message on a field\n   * @private\n   * @param {jQuery[]} field the field being modified\n   */\n  removePositive(field) {\n    $('.icon-success', field.parent('.field, .field-short')).remove();\n  },\n\n  /**\n   * Reset all form errors and values\n   * @param {jQuery[]} form The form to reset.\n   */\n  resetForm(form) {\n    const formFields = form.find('input, select, textarea');\n\n    // Clear Errors\n    formFields.removeClass('error');\n    form.find('.error').removeClass('error');\n    form.find('.icon-error').remove();\n    form.find('.icon-success').remove();\n    form.find('.error-message').remove();\n\n    // Clear Warnings\n    formFields.removeClass('alert');\n    form.find('.alert').removeClass('alert');\n    form.find('.icon-alert').remove();\n    form.find('.alert-message').remove();\n\n    // Clear Informations\n    formFields.removeClass('info');\n    form.find('.info').removeClass('info');\n    form.find('.icon-info').remove();\n    form.find('.info-message').remove();\n\n    setTimeout(() => {\n      $('#validation-errors').addClass('is-hidden');\n    }, 300);\n\n    // Remove Dirty\n    formFields.data('isDirty', false).removeClass('isDirty');\n    form.find('.isDirty').removeClass('isDirty');\n\n    // reset form data\n    if (form.is('form')) {\n      form[0].reset();\n    }\n\n    const validationTypes = $.fn.validation.ValidationTypes;\n    Object.keys(validationTypes).forEach((validationType) => {\n      formFields.removeData(`${validationType}message`);\n    });\n  },\n\n  /**\n   * See if any form errors and check for any empty required fields.\n   * @param {jQuery[]} form The form to check.\n   * @returns {boolean} True if the form is valid, false otherwise.\n   */\n  isFormValid(form) {\n    if ($(form).find('.error-message').length > 0) {\n      return false;\n    }\n\n    const formFields = $(form).find('[data-validate*=\"required\"]');\n    for (let i = 0; i < formFields.length; i++) {\n      const field = $(formFields[i]);\n      const value = this.value(field);\n\n      if ((field.is(':visible') || field.is('select')) && !value) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n\n  /**\n   * Update method\n   * @param {object} [settings] incoming settings\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n  }\n\n};\n\nexport { Validator, COMPONENT_NAME };\n","import * as debug from '../../utils/debug';\nimport { warnAboutDeprecation } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { Validation } from './validation';\nimport { Validator, COMPONENT_NAME as VALIDATOR_COMPONENT_NAME } from './validator';\n\n// Component Name\nconst VALIDATE_COMPONENT_NAME = 'validate';\n\n// Settings specific to error messages.\n// Used for backwards compatibility.\nconst ERROR_MESSAGE_DEFAULTS = {\n  type: 'error',\n  inline: true\n};\n\n/**\n * jQuery Component Wrapper for the Validation Component\n */\n$.fn.validation = Validation;\n\n/**\n * Returns the specific type message data object for a Field\n * @param {object} [settings] incoming settings\n * @returns {string} messages as a string for the specific type\n */\n$.fn.getMessage = function (settings) {\n  if (!settings) {\n    settings = { type: 'error' };\n  }\n  const dataAttr = `${settings.type}message`;\n  const messages = $.fn.getField($(this)).data(dataAttr);\n  let strMessages = '';\n\n  if (messages) {\n    if (messages.length === 1) {\n      return messages[0].message;\n    }\n\n    for (let i = 0; i < messages.length; i++) {\n      strMessages += `\\u2022 ${messages[i].message}`;\n    }\n  }\n\n  return strMessages;\n};\n\n/**\n * Returns all messages on an object as an array.\n * @param {object} [settings] incoming settings\n * @returns {array} message data for the specific type\n */\n$.fn.getMessages = function (settings) {\n  if (!settings) {\n    settings = { type: 'error' };\n  }\n  const dataAttr = `${settings.type}message`;\n\n  let messages = $.fn.getField($(this)).data(dataAttr);\n  if (!messages) {\n    messages = [];\n  }\n  return messages;\n};\n\n/**\n * Retrive the actionble element that should have an error class/icon appended to it.\n * @private\n * @param {jQuery[]} field the field being checked\n * @returns {jQuery[]} the field to be checked\n */\n$.fn.getField = function (field) {\n  if (field.is('select') && field.data('dropdown') !== undefined) {\n    field = field.data('dropdown').pseudoElem;\n  }\n  return field;\n};\n\n/**\n * Returns the errormessage data object for a Field.\n * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n * @deprecated as of v4.4.0.  Please use `$.fn.getMessage()` instead.\n * @param {object} [settings] incoming settings\n * @returns {object} error message data\n */\n$.fn.getErrorMessage = function (settings) {\n  warnAboutDeprecation('$.fn.getMessage', '$.fn.getErrorMessage');\n  settings = utils.extend({}, settings, ERROR_MESSAGE_DEFAULTS);\n  return $(this).getMessage(settings);\n};\n\n/**\n * ScrollIntoView and sets focus on an element\n * @param {boolean} [alignToTop] true (default) element will be aligned to the\n *  top of the visible area of the scrollable ancestor\n * @param {object} [settings] incoming settings\n */\n$.fn.scrollIntoView = function (alignToTop, settings) {\n  if (typeof alignToTop !== 'boolean') {\n    alignToTop = undefined;\n  }\n\n  const instance = new Validator(this, settings);\n  const elem = instance.getField($(this));\n  elem[0].scrollIntoView(alignToTop);\n  elem.focus();\n};\n\n/**\n * Add a Message to a Field\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements receiving messages\n */\n$.fn.addMessage = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, VALIDATOR_COMPONENT_NAME);\n    if (!instance) {\n      instance = $.data(this, VALIDATOR_COMPONENT_NAME, new Validator(this, settings));\n    }\n\n    const rule = {\n      message: settings.message,\n      type: settings.type,\n      triggerEvents: settings.triggerEvents,\n      icon: settings.icon,\n      id: settings.id || settings.message,\n    };\n\n    instance.addMessage(\n      $(this),\n      rule,\n      settings.inline,\n      settings.showTooltip,\n      settings.isAlert\n    );\n  });\n};\n\n/**\n * Add an error Message to a Field.\n * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n * @deprecated as of v4.4.0.  Please use `$.fn.addMessage()` instead.\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements receiving errors\n */\n$.fn.addError = function (settings) {\n  warnAboutDeprecation('$.fn.addMessage', '$.fn.addError');\n  let inline = true;\n  if (typeof settings.inline === 'boolean' && settings.inline === false) {\n    inline = false;\n  }\n  settings = utils.extend({}, settings, ERROR_MESSAGE_DEFAULTS);\n  settings.inline = inline;\n  return this.each(function () {\n    $(this).addMessage(settings);\n  });\n};\n\n/**\n * Remove a Message from a Field\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements having errors removed\n */\n$.fn.removeMessage = function (settings) {\n  if (!settings) {\n    settings = { type: 'error' };\n  }\n\n  return this.each(function () {\n    let instance = $.data(this, VALIDATOR_COMPONENT_NAME);\n    if (!instance) {\n      instance = $.data(this, VALIDATOR_COMPONENT_NAME, new Validator(this, settings));\n    }\n\n    const field = $(this);\n    const dataAttr = `${settings.type}message`;\n    const errors = $.fn.getField(field).data(dataAttr);\n    if (!errors) {\n      return;\n    }\n\n    for (let i = 0; i < errors.length; i++) {\n      instance.removeMessage(field, errors[i], settings.triggerEvents);\n    }\n    instance.setIconOnParent(field, settings.type);\n\n    $.removeData(this, VALIDATOR_COMPONENT_NAME);\n  });\n};\n\n/**\n * Remove an error Message from a Field.\n * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n * @deprecated as of v4.4.0.  Please use `$.fn.removeMessage()` instead.\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements having errors removed\n */\n$.fn.removeError = function (settings) {\n  warnAboutDeprecation('$.fn.removeMessage', '$.fn.removeError');\n  settings = utils.extend({}, settings, ERROR_MESSAGE_DEFAULTS);\n  return this.each(function () {\n    return $(this).removeMessage(settings);\n  });\n};\n\n/**\n * The Actual Validate Component\n * @param {object|string} [settings] incoming settings, or an API method name\n * @param {object} args that can be passed to an API method, if called via string settings\n * @returns {jQuery[]} components being acted on\n */\n$.fn.validate = function (settings, args) {\n  const settingsAreAPIFunction = typeof settings === 'string';\n\n  return this.each(function () {\n    let instance = $.data(this, VALIDATE_COMPONENT_NAME);\n    if (instance && typeof instance !== 'string') {\n      // If settings are a string, assume the string is a function on the instance API\n      // that needs to be called, and attempt to call it.\n      if (settingsAreAPIFunction) {\n        if (typeof instance[settings] === 'function') {\n          instance[settings](args);\n        } else {\n          debug.log('warn', `No method with name \"${settings}\" found on \"${VALIDATE_COMPONENT_NAME}\" component API.`);\n        }\n        return;\n      }\n\n      // Settings are object-based, and can be handled normally\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, VALIDATE_COMPONENT_NAME, new Validator(this, settings));\n    }\n  });\n};\n","/**\n * Soho Validation Utilities\n * ========================================\n */\n\n/**\n * jQuery Utility function wrapper for checking whether or not a field passes validation.\n * @returns {boolean} whether or not the field is valid\n */\n$.fn.isValid = function () {\n  const isValidAttr = $(this).data('isValid');\n  return isValidAttr === undefined || isValidAttr === null ? true : isValidAttr;\n};\n\n/**\n * Check validation manually.\n * @returns {void}\n */\n$.fn.validateField = function () {\n  const field = $(this);\n  const api = Soho.components.Validator.prototype;  //eslint-disable-line\n\n  if (api && api.validate) {\n    api.validate(field, false, 0);\n  }\n};\n\n/**\n * Clear out the stuff on the Form\n */\n$.fn.resetForm = function () {\n  const api = Soho.components.Validator.prototype;  //eslint-disable-line\n  api.resetForm(this);\n};\n","import * as debug from '../../utils/debug';\nimport { deprecateMethod } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { stringUtils } from '../../utils/string';\nimport { Locale } from '../locale/locale';\nimport { MonthView } from '../monthview/monthview';\nimport { Environment as env } from '../../utils/environment';\n\n// jQuery Components\nimport '../mask/mask-input.jquery';\nimport '../popover/popover.jquery';\nimport '../timepicker/timepicker.jquery';\nimport '../validation/validation.jquery';\nimport '../validation/validation.utils';\n\n// Component Name\nconst COMPONENT_NAME = 'datepicker';\n\n/**\n * A component to support date entry.\n * @class DatePicker\n * @constructor\n * @param {jQuery[]|HTMLElement} element The component element.\n * @param {object} [settings] The component settings.\n * @param {boolean} [settings.showTime=false] If true the time selector will be shown.\n * @param {boolean} [settings.useCurrentTime=false] If true current time will be used for the time portion otherwise 12:00 midnight is used\n * @param {string} [settings.timeFormat] Format to use time section fx HH:mm,\n *  defaults current locale settings.\n * @param {number} [settings.minuteInterval]\n * @param {number} [settings.secondInterval]\n * @param {string} [settings.mode] Time picker options: 'standard', 'range',\n *  this controls the time picker.\n * @param {boolean} [settings.roundToInterval] In time picker mode, if a non-matching\n *  minutes value is entered,\n *  rounds the minutes value to the nearest interval when the field is blurred.\n * @param {string} [settings.dateFormat='locale'] Defaults to current locale but can be\n * @param {string} [settings.placeholder=false] Text to show in input element while empty.\n * @param {number} [settings.firstDayOfWeek=null] Set first day of the week. '1' would be Monday.\n * @param {object} [settings.disable] Disable dates in various ways.\n * For example `{minDate: 'M/d/yyyy', maxDate: 'M/d/yyyy'}`. Dates should be in format M/d/yyyy\n * or be a Date() object or string that can be converted to a date with new Date().\n * @param {array} [settings.disable.dates] Disable specific dates.\n * Example `{dates: ['12/31/2018', '01/01/2019'}`.\n * @param {string|date} [settings.disable.minDate] Disable up to a minimum date.\n * Example `{minDate: '12/31/2016'}`.\n * @param {string|date} [settings.disable.maxDate] Disable up to a maximum date.\n * Example `{minDate: '12/31/2019'}`.\n * @param {array} [settings.disable.dayOfWeek] Disable a specific of days of the week 0-6.\n * Example `{dayOfWeek: [0,6]}`.\n * @param {boolean} [settings.disable.isEnable=false] Inverse the disable settings.\n * If true all the disable settings will be enabled and the rest will be disabled.\n * So you can inverse the settings.\n * @param {boolean} [settings.disable.retrictMonths=false] Restrict month selections on datepicker.\n * It requires minDate and maxDate for the feature to activate.\n * For example if you have more non specific dates to disable then enable ect.\n * @param {boolean} [settings.showLegend=false] If true a legend is show to associate dates.\n * @param {boolean} [settings.showMonthYearPicker=false] If true the month and year will render as dropdowns.\n * @param {boolean} [settings.hideDays=false] If true the days portion of the calendar will be hidden.\n *  Usefull for Month/Year only formats.\n * @param {number} [settings.advanceMonths=5] The number of months in each direction to show in\n *  the dropdown for months (when initially opening)\n * @param {array} [settings.legend]  Legend Build up\n * for example `[{name: 'Public Holiday', color: '#76B051', dates: []},\n * {name: 'Weekends', color: '#EFA836', dayOfWeek: []}]`\n * @param {object} [settings.range] Range between two dates with various options.\n * @param {boolean} [settings.range.useRange=false] Use range of two dates options.\n * @param {string|date} [settings.range.start] Start date in range.\n * @param {string|date} [settings.range.end] End date in range.\n * @param {string} [settings.range.separator=' - '] Visual separator between two dates.\n * @param {number} [settings.range.minDays=0] Minimum days to be in range.\n * @param {number} [settings.range.maxDays=0] Maximum days to be in range.\n * @param {boolean} [settings.range.selectForward=false] Range only in forward direction.\n * @param {boolean} [settings.range.selectBackward=false] Range only in backward direction.\n * @param {boolean} [settings.range.includeDisabled=false] Include disable dates in range of dates.\n * @param {string} [settings.calendarName] The name of the calendar to use in instance of multiple calendars. At this time only ar-SA and ar-EG locales have either 'gregorian' or 'islamic-umalqura' as valid values.\n * @param {string} [settings.locale] The name of the locale to use for this instance. If not set the current locale will be used.\n * @param {boolean} [settings.useUTC=false] If true the dates will use UTC format. This is only partially\n * implemented https://jira.infor.com/browse/SOHO-3437\n * @param {boolean} [settings.autoSize=false] If true the field will be sized to the width of the date.\n * @param {boolean} [settings.hideButtons=false] If true bottom and next/prev buttons will be not shown.\n */\nconst DATEPICKER_DEFAULTS = {\n  showTime: false,\n  useCurrentTime: false,\n  timeFormat: undefined,\n  minuteInterval: undefined,\n  secondInterval: undefined,\n  mode: undefined,\n  roundToInterval: undefined,\n  dateFormat: 'locale', // or can be a specific format\n  placeholder: false,\n  firstDayOfWeek: null,\n  disable: {\n    dates: [],\n    minDate: '',\n    maxDate: '',\n    dayOfWeek: [],\n    isEnable: false,\n    restrictMonths: false\n  },\n  showLegend: false,\n  showMonthYearPicker: false,\n  hideDays: false,\n  advanceMonths: 5,\n  legend: [\n    // Legend Build up example\n    // Color in level 6 - http://usmvvwdev53:424/controls/colors\n    { name: 'Public Holiday', color: '#76B051', dates: [] },\n    { name: 'Weekends', color: '#EFA836', dayOfWeek: [] }\n  ],\n  range: {\n    useRange: false, // true - if datepicker using range dates\n    start: '', // Start date '03/05/2018'\n    end: '', // End date '03/21/2018'\n    separator: ' - ', // separator string between two dates\n    minDays: 0, // Minimum days\n    maxDays: 0, // Maximum days\n    selectForward: false, // Only in forward direction\n    selectBackward: false, // Only in backward direction\n    includeDisabled: false // if true range will include disable dates in it\n  },\n  calendarName: null,\n  locale: '',\n  useUTC: false,\n  autoSize: false,\n  hideButtons: false\n};\n\nfunction DatePicker(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, DATEPICKER_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nDatePicker.prototype = {\n\n  init() {\n    this.build();\n    this.handleEvents();\n  },\n\n  /**\n   * Add markup\n   * @private\n   * @returns {void}\n   */\n  build() {\n    // Add \"is-disabled\" css class to closest \".field\" if element is disabled\n    if (this.element.is(':disabled')) {\n      this.element.closest('.field').addClass('is-disabled');\n    }\n\n    // Append a trigger button\n    this.trigger = $.createIconElement('calendar').insertAfter(this.element);\n\n    // Hide icon if datepicker input is hidden\n    if (this.element.hasClass('hidden')) {\n      this.trigger.addClass('hidden');\n    }\n\n    // Set the current calendar\n    this.setLocale();\n    this.addAria();\n    this.setCurrentCalendar();\n    this.setSize();\n  },\n\n  /**\n   * Set current locale to be used.\n   * @private\n   * @returns {void}\n   */\n  setLocale() {\n    this.locale = Locale.currentLocale;\n    if (this.settings.locale) {\n      Locale.getLocale(this.settings.locale).done((locale) => {\n        this.locale = Locale.cultures[locale];\n        this.setCurrentCalendar();\n      });\n    }\n  },\n\n  /**\n   *  Sets current calendar information.\n   * @private\n   * @returns {void}\n   */\n  setCurrentCalendar() {\n    this.currentCalendar = Locale.calendar(this.locale.name, this.settings.calendarName);\n    this.isIslamic = this.currentCalendar.name === 'islamic-umalqura';\n    this.isRTL = this.locale.direction === 'right-to-left';\n    this.conversions = this.currentCalendar.conversions;\n    this.isFullMonth = this.settings.dateFormat.indexOf('MMMM') > -1;\n    this.setFormat();\n    this.mask();\n  },\n\n  /**\n   * Set size attribute based on current contents\n   * @private\n   * @returns {void}\n   */\n  setSize() {\n    if (!this.settings.autoSize) {\n      return;\n    }\n    const elem = this.element[0];\n    const padding = 45;\n    elem.classList.add('input-auto');\n    elem.style.width = `${stringUtils.textWidth(elem.value, 16) + padding}px`;\n  },\n\n  /**\n   * Add aria\n   * @private\n   * @returns {void}\n   */\n  addAria() {\n    this.label = $(`label[for=\"${this.element.attr('id')}\"]`);\n    this.label.append(`<span class=\"audible\">${Locale.translate('PressDown', this.locale.name)}</span>`);\n  },\n\n  /**\n   * Handle Keyboard Stuff\n   * @private\n   * @param {object} elem to handle.\n   * @returns {void}\n   */\n  handleKeys(elem) {\n    const s = this.settings;\n\n    // Handle Tab key while popup is open - the rest is handled in monthview.js now\n    if (elem.is('#monthview-popup')) {\n      elem.off('keydown.datepicker').on('keydown.datepicker', '.monthview-table', (e) => {\n        let handled = false;\n        const key = e.keyCode || e.charCode || 0;\n\n        // Tab closes Date Picker and goes to next field on the modal\n        if (key === 9) {\n          this.containFocus(e);\n          handled = true;\n        }\n\n        // Esc closes Date Picker and goes back to field\n        if (key === 27) {\n          this.closeCalendar();\n          this.element.focus();\n          e.stopImmediatePropagation();\n          handled = true;\n        }\n\n        // 't' selects today\n        if (key === 84) {\n          this.closeCalendar();\n          this.element.focus();\n          handled = true;\n        }\n\n        if (handled) {\n          e.stopPropagation();\n          e.preventDefault();\n          return false;\n        }\n        return true;\n      });\n\n      elem.off('keydown.datepicker-tab').on('keydown.datepicker-tab', 'td, input, div.dropdown, button', (e) => {\n        const key = e.keyCode || e.charCode || 0;\n\n        // Tab closes Date Picker and goes to next field on the modal\n        if (key === 9) {\n          if (s.range.useRange && $(e.target).is('.next')) {\n            this.calendarAPI.days.find('td:visible:last').attr('tabindex', 0).focus();\n          } else {\n            this.containFocus(e);\n          }\n          e.stopPropagation();\n          e.preventDefault();\n          return false;\n        }\n        return true;\n      });\n\n      return;\n    }\n\n    // Handle keys on the input field\n    elem.off('keydown.datepicker').on('keydown.datepicker', (e) => {\n      let handled = false;\n      const key = e.keyCode || e.charCode || 0;\n\n      // Arrow Down or Alt first opens the dialog\n      if (key === 40 && !this.isOpen()) {\n        handled = true;\n        this.openCalendar();\n\n        setTimeout(() => {\n          this.setFocusAfterOpen();\n        }, 200);\n      }\n\n      // 't' selects today\n      if (key === 84) {\n        handled = true;\n        this.setToday();\n      }\n\n      if (handled) {\n        e.stopPropagation();\n        e.preventDefault();\n        return false;\n      }\n      return true;\n    });\n  },\n\n  /**\n   * Focus the next prev focusable element on the popup\n   * @private\n   * @param {object} e event.\n   * @returns {void}\n   */\n  containFocus(e) {\n    const reverse = e.shiftKey;\n\n    // Set focus on (opt: next|prev) focusable element\n    const focusables = this.popup.find(':focusable');\n    let index = focusables.index($(':focus'));\n\n    if (!reverse) {\n      index = ((index + 1) >= focusables.length ? 0 : (index + 1));\n    } else {\n      index = ((index - 1) < 0 ? focusables.length : (index - 1));\n    }\n\n    const elem = focusables.eq(index);\n    elem.focus();\n\n    if (elem.is('td')) {\n      elem.addClass(`is-selected${(this.settings.range.useRange ? ' range' : '')}`);\n      this.currentDate.setDate(elem.text());\n      this.currentDate.setMonth(this.calendar.find('.month').attr('data-month'));\n      this.insertDate(this.currentDate);\n      elem.focus();\n    }\n  },\n\n  /**\n   * Parse the Date Format Options\n   * @private\n   * @returns {void}\n   */\n  setFormat() {\n    const s = this.settings;\n    let localeDateFormat = ((typeof Locale === 'object' && this.currentCalendar.dateFormat) ? this.currentCalendar.dateFormat : null);\n    const localeTimeFormat = ((typeof Locale === 'object' && this.currentCalendar.timeFormat) ? this.currentCalendar.timeFormat : null);\n\n    if (typeof localeDateFormat === 'object' && localeDateFormat.short !== undefined) {\n      localeDateFormat = localeDateFormat.short;\n    }\n\n    if (s.dateFormat === 'locale') {\n      this.pattern = localeDateFormat + (s.showTime ? ` ${(s.timeFormat || localeTimeFormat)}` : '');\n    } else {\n      this.pattern = s.dateFormat + (s.showTime && s.timeFormat ? ` ${s.timeFormat}` : '');\n    }\n\n    this.show24Hours = (this.pattern.match('H') || []).length > 0;\n    this.isSeconds = (this.pattern.match('ss') || []).length > 0;\n  },\n\n  /**\n   * Add masking with the mask function\n   * @private\n   * @returns {void}\n   */\n  mask() {\n    this.setFormat();\n    const s = this.settings;\n    const maskOptions = {\n      process: 'date',\n      keepCharacterPositions: true,\n      patternOptions: {\n        format: this.pattern\n      }\n    };\n    let validation = 'date availableDate';\n    let events = { date: 'change blur enter', availableDate: 'change blur' };\n\n    if (s.range.useRange) {\n      maskOptions.process = 'rangeDate';\n      maskOptions.patternOptions.delimeter = s.range.separator;\n      validation = 'rangeDate';\n      events = { rangeDate: 'change blur' };\n    }\n\n    maskOptions.processOnInitialize = false;\n\n    if (this.isFullMonth) {\n      this.pattern = this.settings.dateFormat;\n    } else {\n      this.element.mask(maskOptions);\n    }\n\n    this.addedValidation = false;\n    if (this.element[0] && this.element[0].getAttribute &&\n      !this.element[0].getAttribute('data-validate')) {\n      this.addedValidation = true;\n      this.element.attr({\n        'data-validate': validation,\n        'data-validation-events': JSON.stringify(events)\n      }).validate();\n    }\n\n    this.setPlaceholder();\n  },\n\n  /**\n   * Set placeholder\n   * @private\n   * @returns {void}\n   */\n  setPlaceholder() {\n    const formatDate = d => Locale.formatDate(d, {\n      pattern: this.pattern,\n      locale: this.locale.name\n    });\n    const s = this.settings;\n    let placeholder = this.pattern;\n\n    if (s.placeholder && (!this.element.attr('placeholder') ||\n      this.element.attr('placeholder') === 'M / D / YYYY')) {\n      if (s.range.useRange) {\n        placeholder = s.range.first && s.range.first.date ?\n          formatDate(s.range.first.date) + s.range.separator + this.pattern :\n          this.pattern + s.range.separator + this.pattern;\n      }\n      this.element[0].setAttribute('placeholder', placeholder);\n    }\n  },\n\n  /**\n   * Check if the calendar div is open or not\n   * @private\n   * @returns {boolean} whether or not the calendar div is open.\n   */\n  isOpen() {\n    return (this.popup && this.popup.is(':visible') &&\n      !this.popup.hasClass('is-hidden'));\n  },\n\n  /**\n   * Open the calendar popup.\n   * This method is slated to be removed in a future v4.15.0 or v5.0.0.\n   * @deprecated as of v4.9.0. Please use `openCalendar()` instead.\n   * @returns {void}\n   */\n  open() {\n    return deprecateMethod(this.openCalendar, this.open).apply(this);\n  },\n\n  /**\n   * Open the calendar in a popup\n   * @private\n   * @returns {void}\n   */\n  openCalendar() {\n    const self = this;\n    const s = this.settings;\n    const timeOptions = {};\n\n    if ((this.element.is(':disabled') || this.element.attr('readonly')) && this.element.closest('.monthview').length === 0) {\n      return;\n    }\n\n    $('#validation-tooltip').addClass('is-hidden');\n\n    /**\n    * Fires as the calendar popup is opened.\n    * @event listopened\n    * @memberof DatePicker\n    * @property {object} event - The jquery event object\n    */\n    this.element.addClass('is-active is-open').trigger('listopened');\n    this.timepickerContainer = $('<div class=\"datepicker-time-container\"></div>');\n    this.footer = $('' +\n      `<div class=\"popup-footer\">\n        <button type=\"button\" class=\"cancel btn-tertiary\">\n          ${Locale.translate('Clear', this.locale.name)}\n        </button>\n        <button type=\"button\" class=\"is-today btn-tertiary\">\n          ${Locale.translate('Today', this.locale.name)}\n        </button>\n      </div>`);\n\n    if (s.hideDays) {\n      this.footer = $('' +\n        `<div class=\"popup-footer\">\n          <button type=\"button\" class=\"select-month btn-tertiary\">\n            ${Locale.translate('Select', this.locale.name)}\n          </button>\n        </div>`);\n    }\n\n    if (s.hideButtons) {\n      this.footer = $('');\n    }\n\n    // Timepicker options\n    if (s.showTime) {\n      if (s.timeFormat === undefined) {\n        // Getting time-format from date-format (dateFormat: 'M/d/yyyy HH:mm:ss')\n        timeOptions.timeFormat = this.pattern.slice(this.pattern.indexOf(' ')).trim();\n      } else {\n        timeOptions.timeFormat = s.timeFormat;\n      }\n      if (s.minuteInterval !== undefined) {\n        timeOptions.minuteInterval = s.minuteInterval;\n      }\n      if (s.secondInterval !== undefined) {\n        timeOptions.secondInterval = s.minuteInterval;\n      }\n      if (s.mode !== undefined) {\n        timeOptions.mode = s.mode;\n      }\n      if (s.roundToInterval !== undefined) {\n        timeOptions.roundToInterval = s.roundToInterval;\n      }\n    }\n\n    this.calendarContainer = $('<div class=\"monthview-container\"></div>');\n\n    // Show Month\n    this.setValueFromField();\n\n    // Set timepicker\n    if (this.settings.showTime) {\n      // Set to 12:00\n      if (this.element.val() === '' && this.currentDate && this.currentDate.getDate() && !this.settings.useCurrentTime) {\n        this.currentDate.setHours(0);\n        this.currentDate.setMinutes(0);\n        this.currentDate.setSeconds(0);\n      }\n\n      timeOptions.parentElement = this.timepickerContainer;\n      timeOptions.locale = this.settings.locale;\n      this.time = this.getTimeString(this.currentDate, this.show24Hours);\n      this.timepicker = this.timepickerContainer.timepicker(timeOptions).data('timepicker');\n      this.timepickerContainer.find('.dropdown').dropdown();\n\n      this.timepickerContainer.on('change.datepicker', () => {\n        this.currentDate = this.setTime(this.currentDate);\n        this.setValue(this.currentDate, true, true);\n      });\n\n      // Wait for timepicker to initialize\n      setTimeout(() => {\n        this.timepicker.initValues = this.timepicker.getTimeFromField(this.time);\n        this.timepicker.afterShow(this.timepickerContainer);\n        return; // eslint-disable-line\n      }, 1);\n    }\n\n    this.todayDate = new Date();\n    this.todayMonth = this.todayDate.getMonth();\n    this.todayYear = this.todayDate.getFullYear();\n    this.todayDay = this.todayDate.getDate();\n\n    if (this.isIslamic) {\n      this.todayDateIslamic = this.conversions.fromGregorian(this.todayDate);\n      this.todayYear = this.todayDateIslamic[0];\n      this.todayMonth = this.todayDateIslamic[1];\n      this.todayDay = this.todayDateIslamic[2];\n    }\n\n    this.settings.month = this.currentMonth;\n    this.settings.year = this.currentYear;\n    if (this.isIslamic) {\n      this.settings.activeDateIslamic = this.activeDate instanceof Date ?\n        this.conversions.fromGregorian(this.activeDate) : this.activeDate;\n    }\n\n    if (this.settings.onOpenCalendar) {\n      // In some cases, month picker wants to set a specifc time.\n      this.settings.activeDate = this.settings.onOpenCalendar();\n      if (this.isIslamic) {\n        this.settings.activeDateIslamic = this.conversions.fromGregorian(this.settings.activeDate);\n      }\n    } else {\n      this.settings.activeDate = this.currentDate || this.todayDate;\n      this.settings.activeDateIslamic = this.currentIslamicDate || this.todayDateIslamic;\n    }\n\n    this.settings.isPopup = true;\n    this.settings.headerStyle = 'simple';\n\n    // Handle day change\n    this.settings.onSelected = (node, args) => {\n      this.currentDate = new Date(args.year, args.month, args.day);\n      if (self.settings.range.useRange && self.settings.range.first) {\n        return;\n      }\n      self.insertDate(this.currentDate);\n\n      if (args.close) {\n        self.closeCalendar();\n        self.element.focus();\n      }\n    };\n\n    this.calendarAPI = new MonthView(this.calendarContainer, this.settings);\n    this.calendar = this.calendarAPI.element;\n\n    if (s.showTime) {\n      this.calendar.addClass('is-timepicker');\n    }\n    if (s.hideDays) {\n      this.calendar.addClass('is-monthyear');\n    }\n    this.calendar.append((s.showTime ? this.timepickerContainer : ''), this.footer);\n\n    let placementParent = this.element;\n    let placementParentXAlignment = (this.isRTL ? 'right' : 'left');\n    const parent = this.element.parent();\n\n    if (parent.is('.datagrid-cell-wrapper')) {\n      placementParentXAlignment = 'center';\n      placementParent = this.element.next('.icon');\n    }\n\n    const popoverOpts = {\n      content: this.calendar,\n      placementOpts: {\n        parent: placementParent,\n        parentXAlignment: placementParentXAlignment,\n        strategies: ['flip', 'nudge', 'shrink']\n      },\n      placement: 'bottom',\n      popover: true,\n      trigger: 'immediate',\n      extraClass: 'monthview-popup',\n      tooltipElement: '#monthview-popup',\n      initializeContent: false\n    };\n\n    this.trigger.popover(popoverOpts)\n      .off('show.datepicker')\n      .on('show.datepicker', () => {\n        if (env.os.name === 'ios') {\n          $('head').triggerHandler('disable-zoom');\n        }\n\n        // Horizontal view on mobile\n        if (window.innerHeight < 400 && this.popupClosestScrollable) {\n          this.popup.find('.arrow').hide();\n          this.popup.css('min-height', `${(this.popupClosestScrollable[0].scrollHeight + 2)}px`);\n          this.popupClosestScrollable.css('min-height', '375px');\n        }\n\n        // Hide calendar until range to be pre selected\n        if (s.range.useRange &&\n            s.range.first && s.range.first.date &&\n            s.range.second && s.range.second.date) {\n          this.popup.addClass('is-hidden');\n        }\n\n        if (this.settings.hideButtons) {\n          this.popup.addClass('hide-buttons');\n        }\n      })\n      .off('hide.datepicker')\n      .on('hide.datepicker', () => {\n        if (env.os.name === 'ios') {\n          this.trigger.one('hide', () => {\n            $('head').triggerHandler('enable-zoom');\n          });\n        }\n\n        this.popupClosestScrollable.add(this.popup).css('min-height', '');\n        this.closeCalendar();\n      });\n\n    this.handleKeys($('#monthview-popup'));\n    $('.monthview-footer a', this.calendar).button();\n\n    this.popup = $('#monthview-popup');\n    this.popupClosestScrollable = this.popup.closest('.scrollable');\n    this.popup.attr('role', 'dialog');\n    this.originalDate = this.element.val();\n    this.calendarAPI.currentDate = this.currentDate;\n    this.calendarAPI.currentIslamicDate = this.currentIslamicDate;\n    this.calendarAPI.validatePrevNext();\n\n    // Calendar Day Events\n    this.calendarAPI.days.off('click.datepicker').on('click.datepicker', 'td', function () {\n      const td = $(this);\n      if (td.hasClass('is-disabled')) {\n        self.calendarAPI.activeTabindex(td, true);\n      } else {\n        if (!(s.range.useRange && s.range.first)) {\n          self.calendarAPI.days.find('.is-selected').removeClass('is-selected range').removeAttr('aria-selected');\n        }\n\n        const cell = $(this);\n        cell.addClass(`is-selected${(s.range.useRange ? ' range' : '')}`).attr('aria-selected', 'true');\n\n        const cellDate = self.calendarAPI.getCellDate(cell);\n        const day = cellDate.day;\n        const month = cellDate.month;\n        const year = cellDate.year;\n\n        self.currentDate = new Date(year, month, day);\n\n        if (self.isIslamic) {\n          self.currentDateIslamic[0] = year;\n          self.currentDateIslamic[1] = month;\n          self.currentDateIslamic[2] = day;\n          self.currentYear = year;\n          self.currentMonth = month;\n          self.currentDay = day;\n          self.currentDate = self.conversions.toGregorian(year, month, day);\n        }\n\n        self.insertDate(self.isIslamic ? self.currentDateIslamic : self.currentDate);\n\n        if (s.range.useRange) {\n          self.isFocusAfterClose = true;\n        } else {\n          self.closeCalendar();\n          self.element.focus();\n        }\n      }\n    });\n\n    // Calendar Footer Events\n    this.footer.off('click.datepicker').on('click.datepicker', 'button', function (e) {\n      const btn = $(this);\n\n      if (btn.hasClass('cancel')) {\n        /**\n        * Fires after the value in the input is changed by any means.\n        *\n        * @event change\n        * @memberof DatePicker\n        * @property {object} event - The jquery event object\n        */\n        self.element.val('').trigger('change').trigger('input');\n        self.currentDate = null;\n        self.closeCalendar();\n      }\n\n      if (btn.hasClass('select-month')) {\n        const year = parseInt(self.calendarAPI.header.find('.year select').val(), 10);\n        const month = parseInt(self.calendarAPI.header.find('.month select').val(), 10);\n\n        self.currentDate = new Date(year, month, 1);\n\n        if (self.isIslamic) {\n          self.currentDateIslamic[0] = year;\n          self.currentDateIslamic[1] = month;\n          self.currentDateIslamic[2] = 1;\n          self.currentYear = year;\n          self.currentMonth = month;\n          self.currentDay = 1;\n          self.currentDate = self.conversions.toGregorian(year, month, 1);\n        }\n\n        self.insertDate(self.isIslamic ? self.currentDateIslamic : self.currentDate);\n        if (s.range.useRange) {\n          self.isFocusAfterClose = false;\n        } else {\n          self.closeCalendar();\n        }\n      }\n\n      if (btn.hasClass('is-today')) {\n        self.setToday();\n        if (!s.range.useRange) {\n          self.closeCalendar();\n        }\n      }\n      self.element.focus();\n      e.preventDefault();\n    });\n\n    setTimeout(() => {\n      self.setFocusAfterOpen();\n    }, 50);\n  },\n\n  /**\n   * Close the calendar popup.\n   * This method is slated to be removed in a future v4.15.0 or v5.0.0.\n   * @deprecated as of v4.9.0. Please use `closeCalendar()` instead.\n   * @returns {void}\n   */\n  close() {\n    return deprecateMethod(this.closeCalendar, this.close).apply(this);\n  },\n\n  /**\n   * Close the calendar in a popup\n   * @private\n   * @returns {void}\n   */\n  closeCalendar() {\n    // Remove range entries\n    const cell = this.calendarAPI && this.calendarAPI.days.length ? this.calendarAPI.days.find('td.is-selected') : null;\n    this.resetRange(cell);\n\n    // Close timepicker\n    if (this.settings.showTime && this.timepickerControl && this.timepickerControl.isOpen()) {\n      this.timepickerControl.closeTimePopup();\n    }\n\n    if (this.popup && this.popup.length) {\n      this.popup.hide().remove();\n    }\n\n    const popoverAPI = this.trigger.data('tooltip');\n    if (popoverAPI) {\n      popoverAPI.destroy();\n    }\n\n    if (this.element.hasClass('is-active')) {\n      /**\n      * Fires as the calendar popup is closed.\n      *\n      * @event listclosed\n      * @memberof DatePicker\n      * @property {object} event - The jquery event object\n      */\n      this.element.trigger('listclosed');\n      this.element.removeClass('is-active is-open');\n    }\n  },\n\n  /**\n   * Set focus after opening the calendar\n   * @private\n   * @returns {void}\n   */\n  setFocusAfterOpen() {\n    const s = this.settings;\n    if (!this.calendar) {\n      return;\n    }\n\n    if (s.hideDays) {\n      this.calendar.find('div.dropdown:first').focus();\n      return;\n    }\n\n    if (s.range.useRange) {\n      if (s.range.first && s.range.first.label &&\n        (!s.range.second || s.range.second && !s.range.second.date)) {\n        this.setRangeFirstPart(s.range.first.date);\n      }\n      this.calendarAPI.setRangeSelected();\n      if (s.range.second && s.range.first.date && s.range.second.date) {\n        this.element.val(this.getRangeValue());\n      }\n      // Pre selection compleated now show the calendar\n      this.popup.removeClass('is-hidden');\n    }\n    this.calendarAPI.activeTabindex(this.calendar.find('.is-selected'), true);\n  },\n\n  /**\n   * Set range first part\n   * @private\n   * @param {object} date .\n   * @returns {void}\n   */\n  setRangeFirstPart(date) {\n    const s = this.settings;\n    const dateObj = d => new Date(d.year, d.month, d.day);\n    const labelDate = d => Locale.formatDate(d, { date: 'full', locale: this.locale.name });\n    const minCell = this.calendarAPI.days.find('td:visible:first');\n    const maxCell = this.calendarAPI.days.find('td:visible:last');\n    const label = labelDate(date);\n    const cell = this.calendarAPI.days.find(`[aria-label=\"${label}\"]`);\n    const row = cell.closest('tr');\n    this.currentDate = date;\n\n    s.range.first = { date, label, cell, row, rowIdx: row.index(), cellIdx: cell.index() };\n    s.range.extra = {\n      minCell,\n      maxCell,\n      min: dateObj(this.calendarAPI.getCellDate(minCell)),\n      max: dateObj(this.calendarAPI.getCellDate(maxCell)),\n      cellLength: row.children('td').length\n    };\n    this.calendarAPI.settings.range.first = s.range.first;\n    this.calendarAPI.settings.range.extra = s.range.extra;\n  },\n\n  /**\n   * Put the date in the field and select on the calendar\n   * @private\n   * @param {object} date .\n   * @param {boolean} isReset .\n   * @returns {void}\n   */\n  insertDate(date, isReset) {\n    const s = this.settings;\n    const year = (date instanceof Array ? date[0] : date.getFullYear());\n    const month = (date instanceof Array ? date[1] : date.getMonth());\n    const day = (date instanceof Array ? date[2] : date.getDate()).toString();\n\n    // Make sure Calendar is showing that month\n    if (this.calendarAPI.currentMonth !== month || this.calendarAPI.currentYear !== year) {\n      this.calendarAPI.showMonth(month, year);\n    }\n\n    if (!this.isOpen()) {\n      return;\n    }\n\n    // Show the Date in the UI\n    const dateTd = this.calendarAPI.days.find('td:not(.alternate)').filter(function () {\n      return $(this).text().toLowerCase() === day;\n    });\n\n    if (dateTd.hasClass('is-disabled')) {\n      this.calendarAPI.activeTabindex(dateTd, true);\n    } else {\n      if (this.settings.showTime) {\n        if (isReset) {\n          this.time = this.getTimeString(date, this.show24Hours);\n\n          if (this.settings.roundToInterval) {\n            $('#timepicker-minutes').val('');\n            date = this.setTime(date);\n          }\n        } else {\n          date = this.setTime(date);\n        }\n      }\n\n      this.setValue(date, true);\n      if (s.range.useRange) {\n        this.calendarAPI.days.find('.is-selected').removeAttr('aria-selected').removeAttr('tabindex');\n      } else {\n        this.calendarAPI.days.find('.is-selected').removeClass('is-selected range').removeAttr('aria-selected').removeAttr('tabindex');\n      }\n      dateTd.addClass(`is-selected${(s.range.useRange ? ' range' : '')}`).attr({ 'aria-selected': true });\n      this.calendarAPI.activeTabindex(dateTd, true);\n    }\n  },\n\n  /**\n   * Set the Formatted value in the input\n   * @private\n   * @param {object} date The date to set in date format.\n   * @param {boolean} trigger If true will trigger the change event.\n   * @param {boolean} isTime will pass to set range.\n   * @returns {void}\n   */\n  setValue(date, trigger, isTime) {\n    const s = this.settings;\n    this.currentDate = date;\n\n    if (date instanceof Array) {\n      this.currentIslamicDate = date;\n      this.currentDate = this.conversions.toGregorian(date[0], date[1], date[2]);\n    }\n\n    if (s.range.useRange) {\n      if (!isTime) {\n        this.setRangeToElem(date, false);\n      }\n    } else {\n      this.element.val(Locale.formatDate(date, {\n        pattern: this.pattern,\n        locale: this.locale.name\n      }));\n    }\n\n    if (trigger) {\n      if (s.range.useRange) {\n        if (!isTime) {\n          this.element\n            .trigger('change', [s.range.data])\n            .trigger('input', [s.range.data]);\n        }\n      } else {\n        this.element.trigger('change').trigger('input');\n      }\n    }\n\n    this.setSize();\n  },\n\n  /**\n   * Set range value to element\n   * @private\n   * @param {object} date .\n   * @param {boolean} isSingleDate .\n   * @returns {void}\n   */\n  setRangeToElem(date, isSingleDate) {\n    const s = this.settings;\n    const formatDate = d => Locale.formatDate(d, {\n      pattern: this.pattern,\n      locale: this.locale.name\n    });\n    const labelDate = d => Locale.formatDate(d, { date: 'full', locale: this.locale.name });\n    let value = formatDate(date);\n    let handled = false;\n\n    // Closed calendar\n    if (!this.isOpen() && !isSingleDate) {\n      handled = true;\n      const d = date || new Date();\n      this.currentMonth = d.getMonth();\n      this.currentYear = d.getFullYear();\n      this.currentDay = d.getDate();\n      this.currentDate = d;\n\n      s.range.first = s.range.first || {};\n      s.range.second = s.range.second || {};\n      s.range.first.date = d;\n      s.range.second.date = d;\n      value = this.getRangeValue();\n    } else {\n      // Opened calendar\n      const label = labelDate(date);\n      let cell = this.calendarAPI.days.find(`[aria-label=\"${label}\"]`);\n      let row = cell.closest('tr');\n\n      if (s.range.second) {\n        this.resetRange(cell);\n      }\n\n      const time = {};\n      if (s.range.first) {\n        time.date = date.getTime();\n        time.firstdate = s.range.first.date.getTime();\n        time.min = this.calendarAPI.getDifferenceToDate(s.range.first.date, s.range.minDays);\n        time.max = this.calendarAPI.getDifferenceToDate(s.range.first.date, s.range.maxDays);\n      }\n\n      if (!s.range.first || isSingleDate) {\n        this.setRangeFirstPart(date);\n        value = this.getRangeValue();\n        this.setPlaceholder();\n      } else if (!s.range.second &&\n        (s.range.selectBackward && time.date > time.firstdate) ||\n        (s.range.selectForward && time.date < time.firstdate) ||\n        ((s.range.maxDays > 0) && (time.date > time.max.aftertime) ||\n        (time.date < time.max.beforetime))) {\n        this.resetRange(cell);\n        this.setRangeFirstPart(date);\n        value = this.getRangeValue();\n        this.setPlaceholder();\n      } else {\n        // Set second part for range\n        handled = true;\n        this.currentDate = date;\n        // minDays\n        if (s.range.minDays > 0) {\n          if (time.date > time.firstdate && time.date < time.min.aftertime) {\n            date = time.min.after;\n          } else if (time.date < time.firstdate && time.date > time.min.beforetime) {\n            date = time.min.before;\n          }\n          cell = this.calendarAPI.days.find(`[aria-label=\"${label}\"]`);\n          row = cell.closest('tr');\n        }\n        if (time.date > time.firstdate) {\n          s.range.second = { date, label, cell, row, rowIdx: row.index(), cellIdx: cell.index() };\n        } else {\n          s.range.second = s.range.first;\n          s.range.first = { date, label, cell, row, rowIdx: row.index(), cellIdx: cell.index() };\n        }\n        value = this.getRangeValue();\n      }\n    }\n\n    // Set range value(first only or both parts) on element\n    this.element.val(value);\n\n    // Set data to use in triggerHandler\n    if (!handled) {\n      s.range.data = {\n        value,\n        dates: [s.range.first.date],\n        startDate: s.range.first.date,\n        start: formatDate(s.range.first.date)\n      };\n    } else {\n      s.range.data = {\n        value,\n        dates: this.calendarAPI.getDateRange(s.range.first.date, s.range.second.date),\n        startDate: s.range.first.date,\n        start: formatDate(s.range.first.date),\n        endDate: s.range.second.date,\n        end: formatDate(s.range.second.date)\n      };\n\n      this.closeCalendar();\n      if (this.isFocusAfterClose) {\n        delete this.isFocusAfterClose;\n        this.element.focus();\n      }\n    }\n  },\n\n  /**\n   * Reset range values\n   * @private\n   * @param {object} cell to keep selection.\n   * @returns {void}\n   */\n  resetRange(cell) {\n    if (this.settings.range.useRange) {\n      delete this.settings.range.first;\n      delete this.settings.range.second;\n      delete this.settings.range.extra;\n      if (this.calendarAPI) {\n        delete this.calendarAPI.settings.range.first;\n        delete this.calendarAPI.settings.range.second;\n        delete this.calendarAPI.settings.range.extra;\n      }\n      if (this.calendarAPI && this.calendarAPI.days.length) {\n        this.calendarAPI.days.find('td').removeClass('range range-next range-prev range-selection end-date is-selected');\n      }\n      if (cell) {\n        cell.addClass('is-selected');\n      }\n    }\n  },\n\n  /**\n   * Set the range value from the field\n   * @private\n   * @returns {void}\n   */\n  setRangeValueFromField() {\n    const formatDate = d => Locale.formatDate(d, {\n      pattern: this.pattern,\n      locale: this.locale.name\n    });\n    const parseDate = d => Locale.parseDate(d, {\n      pattern: this.pattern,\n      locale: this.locale.name\n    }, false);\n    const getTime = d => ((d && typeof d.getTime === 'function') ? d.getTime() : (new Date()).getTime());\n    const alignDates = (dates) => {\n      let d1 = parseDate(dates[0]);\n      let d2 = parseDate(dates[1]);\n      if (d1 && d2) {\n        d1 = getTime(d1);\n        d2 = getTime(d2);\n        return (d1 > d2) ? [dates[1], dates[0]] : [dates[0], dates[1]];\n      }\n      return dates;\n    };\n    const s = this.settings;\n    const field = {};\n\n    field.value = s.range.value || this.element.val().trim();\n    field.isEmpty = field.value === '';\n\n    // Field value dates\n    if (!field.isEmpty && field.value.indexOf(s.range.separator) > -1) {\n      field.dates = alignDates(field.value.split(s.range.separator));\n    } else if (!field.isEmpty && field.value.indexOf(s.range.separator.slice(0, -1)) > -1) {\n      field.dates = field.value.split(s.range.separator.slice(0, -1));\n    }\n\n    // Start/End dates\n    if (!s.range.data && s.range.start && s.range.end && field.isEmpty) {\n      let dates;\n      if (typeof s.range.start === 'string' && typeof s.range.end === 'string') {\n        dates = alignDates([s.range.start, s.range.end]);\n      } else if (typeof s.range.start !== 'string' && typeof s.range.end === 'string') {\n        dates = alignDates([formatDate(s.range.start), s.range.end]);\n      } else if (typeof s.range.start === 'string' && typeof s.range.end !== 'string') {\n        dates = alignDates([s.range.start, formatDate(s.range.end)]);\n      } else {\n        dates = alignDates([formatDate(s.range.start), formatDate(s.range.end)]);\n      }\n      s.range.start = formatDate(dates[0]);\n      s.range.end = formatDate(dates[1]);\n    }\n\n    s.range.first = s.range.first || {};\n    s.range.second = s.range.second || {};\n\n    // Start date\n    if (s.range.data && s.range.data.startDate) {\n      s.range.first.date = s.range.data.startDate;\n    } else if (s.range.start && typeof s.range.start === 'string') {\n      s.range.first.date = parseDate(s.range.start);\n    } else if (field.dates) {\n      s.range.first.date = parseDate(field.dates[0]);\n    }\n\n    // End date\n    if (s.range.data && s.range.data.endDate) {\n      s.range.second.date = s.range.data.endDate;\n    } else if (s.range.end && typeof s.range.end === 'string') {\n      s.range.second.date = parseDate(s.range.end);\n    } else if (field.dates) {\n      s.range.second.date = parseDate(field.dates[1]);\n    }\n\n    if (this.calendarAPI) {\n      this.calendarAPI.setRangeSelected();\n    }\n\n    if (field.isEmpty || (!field.isEmpty && !s.range.data)) {\n      const value = formatDate(s.range.first.date);\n      if (value) {\n        this.element.val(value);\n      }\n    } else {\n      return false;\n    }\n    return true;\n  },\n\n  /**\n   * Get the value from the field and set the internal variables or use current date\n   * @private\n   * @returns {void}\n   */\n  setValueFromField() {\n    const s = this.settings;\n    this.setCurrentCalendar();\n\n    if (s.range.useRange && this.element.val().trim() === '') {\n      delete s.range.data;\n      this.resetRange();\n    }\n\n    if (s.range.useRange && ((this.element.val().trim() !== '') ||\n      (s.range.start && s.range.end) ||\n      (s.range.data && s.range.data.startDate && s.range.data.endDate))) {\n      if (!this.setRangeValueFromField()) {\n        if (this.currentDate && typeof this.currentDate.getMonth === 'function') {\n          this.currentMonth = this.currentDate.getMonth();\n          this.currentYear = this.currentDate.getFullYear();\n          this.currentDay = this.currentDate.getDate();\n        }\n        return;\n      }\n    }\n\n    const self = this;\n    const fieldValue = this.element.val();\n    let gregorianValue = fieldValue;\n\n    if (this.isIslamic && fieldValue) {\n      const islamicValue = Locale.parseDate(this.element.val(), {\n        pattern: this.pattern,\n        locale: this.locale.name\n      });\n      gregorianValue = this.conversions.toGregorian(\n        islamicValue[0],\n        islamicValue[1],\n        islamicValue[2]\n      );\n    }\n\n    this.currentDate = gregorianValue || new Date();\n    if (typeof this.currentDate === 'string') {\n      this.currentDate = Locale.parseDate(this.currentDate, {\n        pattern: this.pattern,\n        locale: this.locale.name\n      }, false);\n    }\n\n    if (this.currentDate === undefined) {\n      this.currentDate = Locale.parseDate(gregorianValue, {\n        pattern: this.pattern,\n        locale: this.locale.name\n      }, false);\n    }\n\n    if (this.isIslamic) {\n      this.currentDateIslamic = this.conversions.fromGregorian(this.currentDate);\n      this.currentYear = this.currentDateIslamic[0];\n      this.currentMonth = this.currentDateIslamic[1];\n      this.currentDay = this.currentDateIslamic[2];\n    } else {\n      this.currentDate = this.currentDate || new Date();\n      this.currentMonth = this.currentDate.getMonth();\n      this.currentYear = this.currentDate.getFullYear();\n      this.currentDay = this.currentDate.getDate();\n    }\n\n    // Check and fix two digit year for main input element\n    const dateFormat = self.pattern;\n    const isStrict = !(dateFormat === 'MMMM d' || dateFormat === 'yyyy');\n    const parsedDate = Locale.parseDate(self.element.val().trim(), {\n      pattern: dateFormat,\n      locale: this.locale.name\n    }, isStrict);\n\n    if (parsedDate !== undefined && self.element.val().trim() !== '' && !s.range.useRange) {\n      self.setValue(Locale.parseDate(self.element.val().trim(), {\n        pattern: self.pattern,\n        locale: this.locale.name\n      }, false));\n    }\n\n    if (s.range.useRange && s.range.first && s.range.first.date\n      && s.range.second && !s.range.second.date) {\n      this.setRangeToElem(this.currentDate, true);\n    }\n  },\n\n  /**\n   * Set input to enabled.\n   * @returns {void}\n   */\n  enable() {\n    this.element.removeAttr('disabled readonly').closest('.field').removeClass('is-disabled');\n  },\n\n  /**\n   * Set input to disabled.\n   * @returns {void}\n   */\n  disable() {\n    this.enable();\n    this.element.attr('disabled', 'disabled').closest('.field').addClass('is-disabled');\n  },\n\n  /**\n   * Detects whether or not the component is disabled\n   * @returns {boolean} whether or not the component is disabled\n   */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n   * Set input to readonly.\n   * @returns {void}\n   */\n  readonly() {\n    this.enable();\n    this.element.attr('readonly', 'readonly');\n  },\n\n  /**\n   * Set to todays date in current format.\n   * @private\n   * @returns {void}\n   */\n  setToday() {\n    const s = this.settings;\n    this.currentDate = new Date();\n\n    if (!this.settings.useCurrentTime) {\n      this.currentDate.setHours(0, 0, 0, 0);\n\n      if (this.element.val() !== '') {\n        if (this.timepicker && this.timepicker.hourSelect) {\n          this.currentDate.setHours(this.timepicker.hourSelect.val());\n        }\n\n        if (this.timepicker && this.timepicker.minuteSelect) {\n          this.currentDate.setMinutes(this.timepicker.minuteSelect.val());\n        }\n\n        if (this.timepicker && this.timepicker.secondSelect) {\n          this.currentDate.setSeconds(this.timepicker.secondSelect.val());\n        }\n      }\n    }\n\n    if (this.isIslamic) {\n      const islamicDateParts = this.conversions.fromGregorian(this.currentDate);\n      this.currentDateIslamic = islamicDateParts;\n    }\n\n    if (this.isOpen()) {\n      this.insertDate(this.isIslamic ? this.currentDateIslamic : this.currentDate, true);\n    } else {\n      if (s.range.useRange) {\n        this.setRangeToElem(this.currentDate);\n      } else {\n        const options = { pattern: this.pattern, locale: this.locale.name };\n        const islamicDateText =\n          Locale.formatDate(this.isIslamic ?\n            this.currentDateIslamic : this.currentDate, options);\n        this.element.val(islamicDateText);\n      }\n      /**\n      * Fires after the value in the input is changed by user interaction.\n      *\n      * @event input\n      * @memberof DatePicker\n      * @property {object} event - The jquery event object\n      */\n      if (s.range.useRange) {\n        this.element\n          .trigger('change', [s.range.data])\n          .trigger('input', [s.range.data]);\n      } else {\n        this.element.trigger('change').trigger('input');\n      }\n    }\n  },\n\n  /**\n   * Set time\n   * @private\n   * @param {object} date .\n   * @returns {void}\n   */\n  setTime(date) {\n    let hours = this.popup.find('.dropdown.hours').val();\n    const minutes = this.popup.find('.dropdown.minutes').val();\n    const seconds = this.isSeconds ? this.popup.find('.dropdown.seconds').val() : 0;\n    const period = this.popup.find('.dropdown.period');\n\n    hours = (period.length && period.val() === 'PM' && hours < 12) ? (parseInt(hours, 10) + 12) : hours;\n    hours = (period.length && period.val() === 'AM' && parseInt(hours, 10) === 12) ? 0 : hours;\n\n    date = new Date(date);\n    date.setHours(hours, minutes, seconds);\n    return date;\n  },\n\n  /**\n   * Get Time String\n   * @private\n   * @param {object} date .\n   * @param {boolean} isHours24 .\n   * @returns {string} time\n   */\n  getTimeString(date, isHours24) {\n    const twodigit = function (number) {\n      return (number < 10 ? '0' : '') + number;\n    };\n    const d = (date || new Date());\n    const h = d.getHours();\n    const m = twodigit(d.getMinutes());\n    const s = twodigit(d.getSeconds());\n    const h12 = `${(h % 12 || 12)}:${m}${(this.isSeconds ? `:${s}` : '')} ${(h < 12 ? 'AM' : 'PM')}`;\n    const h24 = `${h}:${m} + ${(this.isSeconds ? `:${s}` : '')}`;\n\n    return isHours24 ? h24 : h12;\n  },\n\n  /**\n   * Get the current date from the field. In date format\n   * @returns {Date} the set date object\n   */\n  getCurrentDate() {\n    return this.currentDate;\n  },\n\n  /**\n   * Updates the component instance. Can be used after being passed new settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, DATEPICKER_DEFAULTS);\n    }\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Get range value to insert in element\n   * @private\n   * @returns {string} range dates to display in element\n   */\n  getRangeValue() {\n    const s = this.settings;\n    const formatDate = d => Locale.formatDate(d, {\n      pattern: this.pattern,\n      locale: this.locale.name\n    });\n\n    if (s.range.useRange &&\n      s.range.first && s.range.first.date &&\n      s.range.second && s.range.second.date) {\n      return `${formatDate(s.range.first.date) + s.range.separator + formatDate(s.range.second.date)}`;\n    } else if (s.range.useRange &&\n      s.range.first && s.range.first.date) {\n      return s.placeholder ?\n        `${formatDate(s.range.first.date) + s.range.separator + this.pattern}` :\n        formatDate(s.range.first.date);\n    }\n    return '';\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {void}\n   */\n  teardown() {\n    if (this.isOpen()) {\n      this.closeCalendar();\n    }\n\n    this.element.off('blur.datepicker');\n    this.trigger.remove();\n    this.element.attr('data-mask', '');\n    this.element.removeAttr('placeholder');\n    if (this.calendarAPI) {\n      this.calendarAPI.destroy();\n    }\n    if (this.calendar && this.calendar.length) {\n      this.calendar.remove();\n    }\n\n    if (this.popup && this.popup.length) {\n      this.popup.remove();\n    }\n\n    const maskApi = this.element.data('mask');\n    if (maskApi) {\n      maskApi.destroy();\n    }\n\n    this.element.off('keydown.datepicker blur.validate change.validate keyup.validate focus.validate');\n\n    if (this.addedValidation) {\n      this.element.removeAttr('data-validate').removeData('validate validationEvents');\n    }\n\n    return this;\n  },\n\n  /**\n   * Destroy and remove added markup, reset back to default\n   * @returns {void}\n   */\n  destroy() {\n    this.closeCalendar();\n    this.teardown();\n    if (this.element[0]) {\n      $.removeData(this.element[0], COMPONENT_NAME);\n    }\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const s = this.settings;\n\n    this.trigger.on('click.datepicker', () => {\n      if (self.isOpen()) {\n        self.closeCalendar();\n      } else {\n        self.openCalendar();\n      }\n    });\n\n    this.handleKeys(this.element);\n\n    // Fix two digit year for main input element\n    self.element.on('blur.datepicker', () => {\n      if (self.element.val().trim() !== '') {\n        self.setValueFromField();\n      }\n    });\n\n    // Set initialize value\n    if (!this.isOpen() && s.range.useRange && !s.range.first) {\n      this.setRangeValueFromField();\n      const value = this.getRangeValue();\n      if (value) {\n        this.element.val(value);\n      }\n    }\n  }\n\n};\n\nexport { DatePicker, COMPONENT_NAME };\n","import { DatePicker, COMPONENT_NAME } from './datepicker';\n\n/**\n * jQuery Component Wrapper for Datepicker\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.datepicker = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new DatePicker(this, settings));\n    }\n  });\n};\n","/* eslint-disable no-useless-escape */\n/* eslint-disable no-restricted-syntax */\n/* eslint-disable consistent-return */\n\nimport { Environment as env } from '../../utils/environment';\nimport { debounce } from '../../utils/debounced-resize';\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { xssUtils } from '../../utils/xss';\nimport { DOM } from '../../utils/dom';\n\nconst COMPONENT_NAME = 'editor';\n\n/**\n* The Editor Component displays and edits markdown.\n*\n* @class Editor\n* @param {string} element The component element.\n* @param {string} [settings] The component settings.\n* @param {string} [settings.buttons =\n* { editor: [ 'header1', 'header2', 'separator', 'bold', 'italic', 'underline', 'strikethrough',\n* 'separator', 'foreColor', 'backColor', 'separator', 'justifyLeft', 'justifyCenter', 'justifyRight', 'separator', 'quote', 'orderedlist',\n* 'unorderedlist', 'separator', 'anchor', 'separator', 'image', 'separator', 'source' ], source: [ 'visual' ] }]\n* An array with all the visible buttons in it.\n* @param {string} [settings.excludeButtons = { editor: ['backColor'], source: [] }] An array with all the buttons in it to excloude\n* @param {string} [settings.firstHeader = 'h3'] Allows you to set if the first header inserted is a h3 or h4 element.\n* You should set this to match the structure of the parent page for accessibility\n* @param {boolean} [settings.secondHeader = 'h4'] Allows you to set if the second header inserted is a h3 or\n* h4 element. You should set this to match the structure of the parent page for accessibility\n* @param {string} [settings.pasteAsPlainText = false] If true, when you paste into the editor the element will be unformatted to plain text.\n* @param {string} [settings.anchor = { url: 'http://www.example.com', class: 'hyperlink', target: 'NewWindow', isClickable: false, showIsClickable: false }] An object with settings related to controlling link behavior when inserted example: `{url: 'http://www.example.com', class: 'hyperlink', target: 'NewWindow', isClickable: false, showIsClickable: false},` the url is the default url to display. Class should normally stay hyperlink and represents the styling class. target can be 'NewWindow' or 'SameWindow', isClickable make the links appear clickable in the editor, showIsClickable will show a checkbox to allow the user to make clickable links in the link popup.\n* @param {string} [settings.image = { url: 'https://imgplaceholder.com/250x250/368AC0/ffffff/fa-image' }] Info object to populate the image dialog defaulting to ` {url: 'http://lorempixel.com/output/cats-q-c-300-200-3.jpg'}`\n* @param {function} [settings.onLinkClick = null] Call back for clicking on links to control link behavior.\n* @param {function} [settings.showHtmlView = false] If set to true, editor should be displayed in HTML view initialy.\n* @param {function} [settings.preview = false] If set to true, editor should be displayed in preview mode with noneditable content.\n* @param {boolean} [settings.useFlexToolbar = false] if set to true, renders the toolbar as\n*/\nconst EDITOR_DEFAULTS = {\n  buttons: {\n    editor: [\n      'header1', 'header2',\n      'separator', 'bold', 'italic', 'underline', 'strikethrough',\n      'separator', 'foreColor', 'backColor',\n      'separator', 'justifyLeft', 'justifyCenter', 'justifyRight',\n      'separator', 'quote', 'orderedlist', 'unorderedlist',\n      'separator', 'anchor',\n      'separator', 'image',\n      'separator', 'clearFormatting',\n      'separator', 'source'\n    ],\n    source: [\n      'visual'\n    ]\n  },\n  excludeButtons: {\n    editor: ['backColor'],\n    source: []\n  },\n  delay: 200,\n  firstHeader: 'h3',\n  secondHeader: 'h4',\n  placeholder: null,\n  pasteAsPlainText: false,\n  // anchor > target: 'SameWindow'|'NewWindow'| any string value\n  anchor: { url: 'http://www.example.com', class: 'hyperlink', target: 'NewWindow', isClickable: false, showIsClickable: false },\n  image: { url: 'https://imgplaceholder.com/250x250/368AC0/ffffff/fa-image' },\n  onLinkClick: null,\n  showHtmlView: false,\n  preview: false,\n  useFlexToolbar: false\n};\n\nfunction Editor(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, EDITOR_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Editor Methods\nEditor.prototype = {\n\n  /**\n   * @returns {Toolbar|ToolbarFlex} a reference to the Editor's Toolbar API\n   */\n  get toolbarAPI() {\n    let api;\n    if (this.toolbar && this.toolbar.length) {\n      api = this.toolbar.data(this.settings.useFlexToolbar ? 'toolbar-flex' : 'toolbar');\n    }\n    return api;\n  },\n\n  init() {\n    const s = this.settings;\n    this.isIe = env.browser.name === 'ie';\n    this.isIeEdge = env.browser.name === 'edge';\n    this.isIe11 = this.isIe && env.browser.version === '11';\n    this.isMac = env.os.name === 'Mac OS X';\n    this.isFirefox = env.browser.name === 'firefox';\n    this.textarea = null;\n\n    this.parentElements = ['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre'];\n    this.id = `${utils.uniqueId(this.element, 'editor')}-id`;\n\n    this.container = this.element.parent('.field, .field-short').addClass('editor-container');\n\n    // Preview mode\n    if (!this.previewRendered && (this.element.hasClass('is-preview') || this.settings.preview)) {\n      this.container[0].classList.add('is-preview');\n      this.element[0].classList.remove('is-disabled', 'is-readonly', 'is-preview');\n      this.element[0].setAttribute('contenteditable', false);\n      this.element[0].removeAttribute('aria-multiline');\n      this.element[0].removeAttribute('role');\n      return;\n    }\n\n    s.anchor = $.extend({}, EDITOR_DEFAULTS.anchor, s.anchor);\n    s.image = $.extend({}, EDITOR_DEFAULTS.image, s.image);\n\n    s.anchor.defaultUrl = s.anchor.url;\n    s.anchor.defaultClass = s.anchor.class;\n    s.anchor.defaultTargetText = s.anchor.target;\n    s.anchor.defaultIsClickable = s.anchor.isClickable;\n\n    s.anchor.targets = s.anchor.targets || {\n      SameWindow: '',\n      NewWindow: '_blank'\n    };\n\n    $.each(this.settings.anchor.targets, (key, val) => {\n      if ((this.settings.anchor.defaultTargetText).toLowerCase() === (key).toLowerCase()) {\n        this.settings.anchor.target = val;\n        this.settings.anchor.defaultTarget = val;\n      }\n    });\n\n    if (!s.anchor.defaultTarget) {\n      if (s.anchor.target && $.trim(s.anchor.target).length) {\n        s.anchor.defaultTarget = s.anchor.target;\n      } else {\n        s.anchor.defaultTargetText = Locale.translate('SameWindow');\n        s.anchor.defaultTarget = s.anchor.targets[s.anchor.defaultTargetText];\n      }\n    }\n\n    this.setup();\n    if (this.element.hasClass('is-readonly')) {\n      this.readonly();\n    }\n\n    if (this.settings.showHtmlView) {\n      this.toggleSource();\n    }\n\n    return this;\n  },\n\n  setup() {\n    this.isActive = true;\n    this.modals = {};\n\n    this.initElements()\n      .bindSelect()\n      .bindPaste()\n      .setPlaceholders()\n      .bindWindowActions()\n      .setupKeyboardEvents()\n      .onPasteTriggered();\n  },\n\n  initElements() {\n    // Make it an editor\n    this.element.attr({\n      contentEditable: true,\n      'aria-multiline': true,\n      role: 'textbox'\n    });\n\n    // Bind functionality for Pre elements. We dont use this yet but could if we\n    // want to edit code blocks.\n    this.element.attr('data-editor', true);\n    this.bindParagraphCreation().bindTab();\n\n    this.initToolbar()\n      .bindButtons()\n      .bindModals()\n      .bindAnchorPreview();\n\n    // Build the textarea that will be used as source view and for content serialization\n    this.initTextarea();\n    return this;\n  },\n\n  // Returns true if the source view is currently active.\n  sourceViewActive() {\n    return this.element.hasClass('source-view-active');\n  },\n\n  // Bind Events for the place holder\n  setPlaceholders() {\n    this.element\n      .on('blur.editor', () => this.togglePlaceHolder())\n      .on('keypress.editor', () => this.togglePlaceHolder());\n\n    this.togglePlaceHolder();\n    return this;\n  },\n\n  togglePlaceHolder() {\n    if (this.element.text().trim() === '') {\n      this.element.addClass('editor-placeholder');\n    } else {\n      this.element.removeClass('editor-placeholder');\n    }\n  },\n\n  // Returns the currently visible element - either the main editor window,\n  // or the source-view textarea\n  getCurrentElement() {\n    return this.sourceViewActive() ? this.textarea : this.element;\n  },\n\n  bindParagraphCreation() {\n    const currentElement = this.getCurrentElement();\n    currentElement.on('keyup.editor', (e) => {\n      let node = this.getSelectionStart();\n      let tagName;\n\n      if (node && node.getAttribute('data-editor') && node.children.length === 0) {\n        document.execCommand('formatBlock', false, 'p');\n      }\n\n      if (e.which === 13) {\n        node = this.getSelectionStart();\n        tagName = node.tagName.toLowerCase();\n\n        if (tagName !== 'li' && !this.isListItemChild(node)) {\n          if (!e.shiftKey) {\n            document.execCommand('formatBlock', false, 'p');\n          }\n          if (tagName === 'a') {\n            document.execCommand('unlink', false, null);\n          }\n        }\n      }\n    });\n    return this;\n  },\n\n  bindTab() {\n    const currentElement = this.getCurrentElement();\n\n    currentElement.on('keydown.editor', (e) => {\n      if (e.which === 9) {\n        // Override tab only for pre nodes\n        const tag = this.getSelectionStart().tagName.toLowerCase();\n        if (tag === 'pre') {\n          e.preventDefault();\n          document.execCommand('insertHtml', null, '    ');\n        }\n        // Tab to indent list structures!\n        if (tag === 'li') {\n          // If Shift is down, outdent, otherwise indent\n          document.execCommand((e.shiftKey ? 'outdent' : 'indent'), e);\n        }\n      }\n    });\n\n    return this;\n  },\n\n  initToolbar() {\n    if (this.toolbar) {\n      return this;\n    }\n\n    this.createToolbar();\n    return this;\n  },\n\n  // Set excluded buttons\n  setExcludedButtons() {\n    const excludeButtons = (elements, toExclude) => {\n      let separatorIndex = -1;\n      let numOfExcluded = 0;\n\n      return elements.filter((x, i) => {\n        let r = true;\n        // Exclude matching buttons but keep separator/s\n        if (toExclude.indexOf(x) > -1 && x !== 'separator') {\n          numOfExcluded++;\n          r = false;\n        } else if (x === 'separator' && ((i - numOfExcluded - 1) === separatorIndex)) {\n          // Exclude extra separator/s\n          numOfExcluded = 0;\n          r = false;\n        }\n        if (x === 'separator') {\n          separatorIndex = i;\n        }\n        return r;\n      });\n    };\n\n    // Run only if it needs (excludeButtons)\n    const setButtons = () => {\n      const s = this.settings;\n      const btns = s.buttons;\n      const exBtns = s.excludeButtons;\n\n      if (this.sourceViewActive()) {\n        return (exBtns && exBtns.source && exBtns.source.length) ?\n          excludeButtons(btns.source, exBtns.source) : btns.source;\n      }\n      return (exBtns && exBtns.editor && exBtns.editor.length) ?\n        excludeButtons(btns.editor, exBtns.editor) : btns.editor;\n    };\n    return setButtons();\n  },\n\n  createToolbar() {\n    const toolbarCssClasses = [\n      this.settings.useFlexToolbar ? 'flex-toolbar' : 'toolbar',\n      'editor-toolbar',\n      'formatter-toolbar'\n    ].join(' ');\n\n    let sectionCss = '';\n    let moreButtonHTML = '';\n    if (this.settings.useFlexToolbar) {\n      sectionCss = 'toolbar-section ';\n      moreButtonHTML = `<div class=\"toolbar-section more\">\n        <button class=\"btn-actions\">\n          <svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n            <use xlink:href=\"#icon-more\"></use>\n          </svg>\n        </button>\n      </div>`;\n    }\n\n    const btns = this.setExcludedButtons();\n    let buttonsHTML = '';\n    for (let i = 0, l = btns.length; i < l; i += 1) {\n      const btn = this.buttonTemplate(btns[i]);\n      if (btn) {\n        buttonsHTML += btn;\n      }\n    }\n\n    const toolbar = `<div class=\"${toolbarCssClasses}\" id=\"editor-toolbar-${this.id}\">\n      <div class=\"${sectionCss}buttonset\">\n        ${buttonsHTML}\n      </div>\n      ${moreButtonHTML}\n    </div>`;\n\n    if (this.element.parent().find('.icon-dirty').length) {\n      this.toolbar = $(toolbar).insertBefore(this.element.parent().find('.icon-dirty'));\n    } else {\n      this.toolbar = $(toolbar).insertBefore(this.sourceViewActive() ?\n        this.element.prev() : this.element);\n    }\n\n    // Invoke Colorpicker, if applicable\n    const cpElements = this.toolbar.find('[data-action=\"foreColor\"], [data-action=\"backColor\"]');\n    cpElements.colorpicker({ placeIn: 'editor' });\n    $('.trigger', cpElements).off('click.colorpicker');\n\n    // Invoke the (Flex?) Toolbar\n    this.toolbar[this.settings.useFlexToolbar ? 'toolbarflex' : 'toolbar']();\n\n    // Invoke Tooltips\n    this.toolbar.find('button[title]').tooltip();\n\n    return this;\n  },\n\n  /**\n  * Switch between source and editing toolbar.\n  * @returns {void}\n  */\n  switchToolbars() {\n    this.destroyToolbar();\n\n    // Rebind everything to the new element\n    this.setupTextareaEvents();\n    this.initToolbar();\n    this.bindButtons().bindModals().bindAnchorPreview();\n    this.bindSelect().bindPaste().setupKeyboardEvents();\n    this.toolbar.find('button').button();\n  },\n\n  initTextarea() {\n    const self = this;\n    if (this.textarea && !this.settings.showHtmlView) {\n      return this;\n    }\n    this.textarea = this.createTextarea();\n\n    // fill the text area with any content that may already exist within the editor DIV\n    this.textarea.text(xssUtils.sanitizeHTML(this.element.html().toString()));\n\n    self.container.on('input.editor keyup.editor', '.editor', debounce(() => {\n      self.textarea.html(xssUtils.sanitizeHTML(self.element.html().toString()));\n      // setting the value via .val doesn't trigger the change event\n      self.element.trigger('change');\n    }, 500));\n\n    this.setupTextareaEvents();\n    return this.textarea;\n  },\n\n  createTextarea() {\n    this.sourceView = $('<div></div>').attr({\n      class: 'editor-source editable hidden',\n      id: `editor-source-${this.id}`\n    }).insertBefore(this.element);\n\n    $('<ul></ul>').addClass('line-numbers').appendTo(this.sourceView);\n    const textareaContainer = $('<div class=\"text-container\"></div>').appendTo(this.sourceView);\n\n    const newTextareaID = `source-textarea-${($('[id^=\"source-textarea-\"]').length + 1)}`;\n\n    const labelContents = `${this.element.prev('.label').addClass('audible').text()} - HTML Source View`;\n\n    $(`<label class=\"audible\" for=\"${newTextareaID}\">${labelContents}</label>`).appendTo(textareaContainer);\n\n    const textarea = $(`<textarea id=\"${newTextareaID}\" class=\"editable\"></textarea>`).appendTo(textareaContainer);\n    return textarea;\n  },\n\n  triggerClick(e, btn) {\n    $(`button[data-action=\"${btn}\"]`, this.toolbar).trigger('click.editor');\n  },\n\n  setupKeyboardEvents() {\n    const self = this;\n    const currentElement = this.getCurrentElement();\n    const keys = {\n      b: 66, // {Ctrl + B} bold\n      e: 69, // {Ctrl + E} justifyCenter\n      h: 72, // {Ctrl + H} anchor\n      i: 73, // {Ctrl + I} italic --------with SHIFT: {Ctrl + Shift + I} image\n      l: 76, // {Ctrl + L} justifyLeft\n      bl: 55, // {Ctrl + Shift + 7} bullet list\n      n: 56, // {Ctrl + Shift + 8} numbered list\n      q: 81, // {Ctrl + Q} blockquotes\n      r: 82, // {Ctrl + R} justifyRight\n      u: 85, // {Ctrl + U} underline\n      h3: 51, // {Ctrl + 3} h3\n      h4: 52, // {Ctrl + 4} h4\n      space: 32, // {Ctrl + Space} Clear Formatting\n      sv: 192 // {Ctrl + ~} toggle source -or- visualview\n    };\n\n    currentElement.on('keydown.editor', (e) => {\n      e = e || window.event;\n\n      if (e.which) {\n        keys.charCode = e.which;\n      } else if (e.keyCode) {\n        keys.charCode = e.keyCode;\n      } else {\n        keys.charCode = false;\n      }\n\n      switch (e.ctrlKey && keys.charCode) {\n        case keys.h3:\n          this.triggerClick(e, `append-${this.settings.firstHeader}`);\n          break;\n        case keys.h4:\n          this.triggerClick(e, `append-${this.settings.secondHeader}`);\n          break;\n        case keys.b:\n          this.triggerClick(e, 'bold');\n          e.preventDefault();\n          break;\n        case keys.e:\n          this.triggerClick(e, 'justifyCenter');\n          break;\n        case keys.h:\n          this.triggerClick(e, 'anchor');\n          e.preventDefault();\n          break;\n        case keys.i:\n          this.triggerClick(e, e.shiftKey ? 'image' : 'italic');\n          if (!e.shiftKey) {\n            e.preventDefault();\n          }\n          break;\n        case keys.bl:\n          if (e.shiftKey) {\n            this.triggerClick(e, 'insertunorderedlist');\n          }\n          e.preventDefault();\n          break;\n        case keys.l:\n          if (!e.shiftKey) {\n            this.triggerClick(e, 'justifyLeft');\n          }\n          e.preventDefault();\n          break;\n        case keys.n:\n          if (e.shiftKey) {\n            this.triggerClick(e, 'insertorderedlist');\n          }\n          break;\n        case keys.q:\n          this.triggerClick(e, 'append-blockquote');\n          break;\n        case keys.r:\n          this.triggerClick(e, 'justifyRight');\n          break;\n        case keys.u:\n          this.triggerClick(e, 'underline');\n          e.preventDefault();\n          break;\n        case keys.space:\n          this.triggerClick(e, 'clearFormatting');\n          break;\n        case keys.sv:\n          this.triggerClick(e, currentElement === this.element ? 'source' : 'visual');\n          break;\n        default:\n          break;\n      }\n    });\n\n    // Open link in new windows/tab, if clicked with command-key(for mac) or ctrl-key(for windows)\n    this.element.on('mousedown.editor', 'a', function (e) {\n      const href = $(this).attr('href');\n      if (!self.isFirefox && ((self.isMac && e.metaKey) || (!self.isMac && e.ctrlKey))) {\n        window.open(href, '_blank');\n        e.preventDefault();\n      }\n    });\n\n    this.element.on('updated.editor', () => {\n      this.updated();\n    });\n\n    return this;\n  },\n\n  setupTextareaEvents() {\n    // Adjust line numbers on input\n    this.textarea.off('.editor').on('input.editor keyup.editor', () => {\n      if (!(this.sourceView.hasClass('hidden'))) {\n        this.adjustSourceLineNumbers();\n      }\n    }).on('focus.editor', () => {\n      this.sourceView.addClass('is-focused');\n    }).on('blur.editor', (e) => {\n      this.sourceView.removeClass('is-focused');\n      this.element.empty().html(xssUtils.sanitizeHTML(this.textarea.val()));\n\n      if (this.element.data('validate')) {\n        this.element.data('validate').validate(this.element, true, e);\n      }\n    });\n\n    return this;\n  },\n\n  adjustSourceLineNumbers() {\n    const container = this.textarea.parent();\n    const lineHeight = parseInt(getComputedStyle(this.textarea[0]).lineHeight, 10);\n    const YPadding = (this.textarea.innerHeight() - this.textarea.height());\n\n    this.textarea[0].style.height = '';\n\n    const scrollHeight = this.textarea[0].scrollHeight;\n    const lineNumberCount = Math.floor((scrollHeight - YPadding) / lineHeight);\n    const numberList = this.sourceView.find('.line-numbers');\n    const lastIdx = numberList.find('li').length;\n\n    let list = '';\n    let i = 0;\n\n    if (!this.lineNumbers || lineNumberCount !== this.lineNumbers) {\n      if (!this.lineNumbers) {\n        // Build the list of line numbers from scratch\n        this.lineNumbers = lineNumberCount;\n        while (i < this.lineNumbers) {\n          list += `<li role=\"presentation\"><span>${(i + 1)}</span></li>`;\n          i++;\n        }\n        numberList.append(list);\n      } else if (this.lineNumbers < lineNumberCount) {\n        // Add extra line numbers to the bottom\n        while (i < (lineNumberCount - this.lineNumbers)) {\n          list += `<li role=\"presentation\"><span>${(lastIdx + i + 1)}</span></li>`;\n          i++;\n        }\n        numberList.append(list);\n      } else if (this.lineNumbers > lineNumberCount) {\n        // Remove extra line numbers from the bottom\n        i = this.lineNumbers - lineNumberCount;\n        numberList.find('li').slice(-(i)).remove();\n      }\n      this.lineNumbers = lineNumberCount;\n      container[0].style.width = `calc(100% - ${(numberList.outerWidth() + 1)}px)`;\n    }\n    if (scrollHeight !== this.textarea[0].scrollHeight) {\n      this.adjustSourceLineNumbers();\n      return;\n    }\n\n    this.textarea[0].style.height = `${numberList[0].scrollHeight}px`;\n  },\n\n  wrapTextInTags(insertedText, selectedText, action) {\n    let tags;\n    let finalText;\n    switch (action) {\n      case 'bold':\n        tags = ['<b>', '</b>'];\n        break;\n      case 'italic':\n        tags = ['<i>', '</i>'];\n        break;\n      case 'underline':\n        tags = ['<u>', '</u>'];\n        break;\n      case 'strikethrough':\n        tags = ['<strike>', '</strike>'];\n        break;\n      case 'append-blockquote':\n        tags = ['<blockquote>', '</blockquote>'];\n        break;\n      default:\n        tags = ['', ''];\n    }\n\n    if (action === 'anchor') {\n      const alink = $(`<a href=\"${insertedText}\">${selectedText}</a>`);\n\n      if (this.settings.anchor.class && $.trim(this.settings.anchor.class).length) {\n        alink.addClass(this.settings.anchor.class);\n      }\n      if (this.settings.anchor.target && $.trim(this.settings.anchor.target).length) {\n        alink.attr('target', this.settings.anchor.target);\n      }\n      if (this.settings.anchor.isClickable) {\n        alink.attr('contenteditable', false);\n      } else {\n        alink.removeAttr('contenteditable');\n      }\n\n      finalText = alink[0].outerHTML;\n    } else {\n      finalText = tags[0] + insertedText + selectedText + tags[1];\n    }\n    return finalText;\n  },\n\n  insertTextAreaContent(text, action) {\n    const el = this.textarea[0];\n    const val = el.value;\n\n    let sel;\n    let startPos;\n    let endPos;\n    let scrollTop;\n\n    // Always have empty text\n    text = text || '';\n\n    if (document.selection && el.tagName === 'TEXTAREA') {\n      // IE textarea support\n      $(el).focus();\n      sel = document.selection.createRange();\n      sel.text = this.wrapTextInTags(text, sel.text, action);\n      $(el).focus();\n    } else if (el.selectionStart || el.selectionStart === '0') {\n      // MOZILLA/NETSCAPE support\n      startPos = el.selectionStart;\n      endPos = el.selectionEnd;\n      scrollTop = el.scrollTop;\n      sel = this.wrapTextInTags(text, val.substring(startPos, endPos), action);\n      el.value = val.substring(0, startPos) + sel + val.substring(endPos, val.length);\n      $(el).focus();\n      el.selectionStart = startPos + sel.length;\n      el.selectionEnd = startPos + sel.length;\n      el.scrollTop = scrollTop;\n    } else {\n      // IE input[type=text] and other browsers\n      el.value += this.wrapTextInTags(text, el.value, action);\n      $(el).focus();\n\n      /* eslint-disable no-self-assign */\n      el.value = el.value; // hack to force cursor to end of text\n      /* eslint-enable no-self-assign */\n    }\n  },\n\n  buttonTemplate(btnType) {\n    const buttonLabels = this.getButtonLabels(this.settings.buttonLabels);\n    const buttonTemplates = {\n      bold: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('ToggleBold')}\" data-action=\"bold\" data-element=\"b\">${buttonLabels.bold}</button>`,\n\n      italic: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('ToggleItalic')}\" data-action=\"italic\" data-element=\"i\">${buttonLabels.italic}</button>`,\n\n      underline: `<button type=\"button\" class=\"btn underline\" title=\"${Locale.translate('ToggleUnderline')}\" data-action=\"underline\" data-element=\"u\">${buttonLabels.underline}</button>`,\n\n      strikethrough: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('StrikeThrough')}\" data-action=\"strikethrough\" data-element=\"strike\">${buttonLabels.strikethrough}</button>`,\n\n      foreColor: `<button type=\"button\" class=\"btn colorpicker-editor-button\" title=\"${Locale.translate('TextColor')}\" data-action=\"foreColor\" data-element=\"foreColor\">${buttonLabels.foreColor}</button>`,\n\n      backColor: `<button type=\"button\" class=\"btn colorpicker-editor-button\" title=\"${Locale.translate('BackgroundColor')}\" data-action=\"backColor\" data-element=\"backColor\">${buttonLabels.backColor}</button>`,\n\n      superscript: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('Superscript')}\" data-action=\"superscript\" data-element=\"sup\">${buttonLabels.superscript}</button>`,\n\n      subscript: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('Subscript')}\" data-action=\"subscript\" data-element=\"sub\">${buttonLabels.subscript}</button>`,\n\n      separator: '<div class=\"separator\"></div>',\n\n      anchor: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('InsertAnchor')}\" data-action=\"anchor\" data-modal=\"modal-url-${this.id}\" data-element=\"a\">${buttonLabels.anchor}</button>`,\n\n      image: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('InsertImage')}\" data-action=\"image\" data-modal=\"modal-image-${this.id}\" data-element=\"img\">${buttonLabels.image}</button>`,\n\n      header1: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('ToggleH3')}\" data-action=\"append-${this.settings.firstHeader}\" data-element=\"${this.settings.firstHeader}\">${buttonLabels.header1}</button>`,\n\n      header2: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('ToggleH4')}\" data-action=\"append-${this.settings.secondHeader}\" data-element=\"${this.settings.secondHeader}\">${buttonLabels.header2}</button>`,\n\n      quote: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('Blockquote')}\" data-action=\"append-blockquote\" data-element=\"blockquote\">${buttonLabels.quote}</button>`,\n\n      orderedlist: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('OrderedList')}\" data-action=\"insertorderedlist\" data-element=\"ol\">${buttonLabels.orderedlist}</button>`,\n\n      unorderedlist: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('UnorderedList')}\" data-action=\"insertunorderedlist\" data-element=\"ul\">${buttonLabels.unorderedlist}</button>`,\n\n      justifyLeft: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('JustifyLeft')}\" data-action=\"justifyLeft\" >${buttonLabels.justifyLeft}</button>`,\n\n      justifyCenter: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('JustifyCenter')}\" data-action=\"justifyCenter\">${buttonLabels.justifyCenter}</button>`,\n\n      justifyRight: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('JustifyRight')}\" data-action=\"justifyRight\" >${buttonLabels.justifyRight}</button>`,\n\n      clearFormatting: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('ClearFormatting')}\" data-action=\"clearFormatting\" >${buttonLabels.clearFormatting}</button>`,\n\n      source: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('ViewSource')}\" data-action=\"source\" >${buttonLabels.source}</button>`,\n\n      visual: `<button type=\"button\" class=\"btn\" title=\"${Locale.translate('ViewVisual')}\" data-action=\"visual\" >${buttonLabels.visual}</button>`\n    };\n    return buttonTemplates[btnType] || false;\n  },\n\n  getIcon(textName, iconName, className) {\n    return `<span class=\"audible\">${Locale.translate(textName)}</span>${$.createIcon({ classes: (className || ''), icon: iconName })}`;\n  },\n\n  getButtonLabels(buttonLabelType) {\n    const buttonLabels = {\n      bold: this.getIcon('Bold', 'bold'),\n      italic: this.getIcon('Italic', 'italic'),\n      underline: this.getIcon('Underline', 'underline'),\n      superscript: '<span aria-hidden=\"true\"><b>x<sup>1</sup></b></span>',\n      subscript: '<span aria-hidden=\"true\"><b>x<sub>1</sub></b></span>',\n      strikethrough: this.getIcon('StrikeThrough', 'strike-through'),\n      foreColor: this.getIcon('TextColor', 'fore-color'),\n      backColor: this.getIcon('BackgroundColor', 'back-color'),\n      anchor: this.getIcon('InsertAnchor', 'link'),\n      image: this.getIcon('InsertImage', 'insert-image'),\n      header1: this.getIcon('ToggleH3', 'h3'),\n      header2: this.getIcon('ToggleH4', 'h4'),\n      quote: this.getIcon('Blockquote', 'quote'),\n      orderedlist: this.getIcon('OrderedList', 'number-list'),\n      unorderedlist: this.getIcon('UnorderedList', 'bullet-list'),\n      pre: '<span aria-hidden=\"true\"><b>0101</b></span>',\n      indent: '<span aria-hidden=\"true\"><b>&rarr;</b></span>',\n      outdent: '<span aria-hidden=\"true\"><b>&larr;</b></span>',\n      justifyLeft: this.getIcon('JustifyLeft', 'left-text-align'),\n      justifyCenter: this.getIcon('JustifyCenter', 'center-text'),\n      justifyRight: this.getIcon('JustifyRight', 'right-text-align'),\n      clearFormatting: this.getIcon('clearFormatting', 'clear-formatting'),\n      source: this.getIcon('ViewSource', 'html', 'html-icon'),\n      visual: this.getIcon('ViewSource', 'visual', 'visual-icon')\n    };\n\n    let customButtonLabels;\n\n    if (typeof buttonLabelType === 'object') {\n      customButtonLabels = buttonLabelType;\n    }\n    if (typeof customButtonLabels === 'object') {\n      for (const attrname in customButtonLabels) {\n        if (customButtonLabels.hasOwnProperty(attrname)) {// eslint-disable-line\n          buttonLabels[attrname] = customButtonLabels[attrname];\n        }\n      }\n    }\n    return buttonLabels;\n  },\n\n  // Show the Buttons\n  activateButton(tag) {\n    this.toolbar.find(`[data-element=\"${tag}\"]`).addClass('is-active');\n  },\n\n  // Bind Events to Toolbar Buttons\n  bindButtons() {\n    const self = this;\n\n    this.toolbar.on('touchstart.editor click.editor', 'button', function (e) {\n      const btn = $(this);\n      const action = btn.attr('data-action');\n\n      // Don't do anything if it's the More Button\n      if (btn.is('.btn-actions')) {\n        return;\n      }\n\n      e.preventDefault();\n      self.getCurrentElement().focus();\n\n      if (self.selection === undefined) {\n        self.checkSelection();\n      }\n\n      if (!self.sourceViewActive()) {\n        btn.toggleClass('is-active');\n      }\n\n      if (action) {\n        self.execAction(action, e);\n      }\n\n      if (self.isIe || self.isIeEdge) {\n        self.getCurrentElement().trigger('change');\n      }\n\n      return false;\n    });\n\n    return this;\n  },\n\n  bindModals() {\n    const self = this;\n\n    this.modals = {\n      url: this.createURLModal(),\n      image: this.createImageModal()\n    };\n\n    $(`[name=\"em-target-${this.id}\"]`).dropdown();\n\n    $(`#modal-url-${this.id}, #modal-image-${this.id}`).modal()\n      .on('beforeopen', function () {\n        self.savedSelection = self.saveSelection();\n\n        if ($(this).attr('id') === (`modal-url-${self.id}`)) {\n          if (!self.selectionRange) {\n            return undefined;\n          }\n        }\n      })\n      .off('open')\n      .on('open', function () {\n        const isTouch = env.features.touch;\n        const id = $(this).attr('id');\n        const input = $('input:first', this);\n        const button = $('.modal-buttonset .btn-modal-primary', this);\n\n        $(`[name=\"em-url-${self.id}\"]`).val(self.settings.anchor.url);\n        $(`[name=\"em-class-${self.id}\"]`).val(self.settings.anchor.class);\n        $(`[name=\"em-target-${self.id}\"]`).val(self.settings.anchor.target).trigger('updated');\n        $(`[name=\"em-isclickable-${this.id}\"]`).prop('checked', self.settings.anchor.isClickable);\n\n        setTimeout(() => {\n          if (isTouch && id === `modal-image-${self.id}`) {\n            button.focus();\n          } else {\n            input.focus().select();\n          }\n        }, 10);\n      })\n      .off('close')\n      .on('close', function (e, isCancelled) {\n        self.restoreSelection(self.savedSelection);\n\n        if (isCancelled) {\n          return;\n        }\n\n        // insert image or link\n        if ($(this).attr('id') === (`modal-url-${self.id}`)) {\n          const currentLink = $(self.findElementInSelection('a', self.element[0]));\n          if (currentLink.length) {\n            self.updateCurrentLink(currentLink);\n          } else {\n            self.createLink($(`[name=\"em-url-${self.id}\"]`, this));\n          }\n        } else {\n          self.insertImage($(`#image-${self.id}`).val());\n        }\n      });\n\n    return this;\n  },\n\n  /**\n  * Function that creates the Url Modal Dialog. This can be customized by making\n   a modal with ID `#modal-url-${this.id}`\n  * @private\n  * @returns {void}\n  */\n  createURLModal() {\n    const s = this.settings;\n    const urlModal = $(`#modal-url-${this.id}`);\n\n    if (urlModal.length > 0) {\n      return urlModal;\n    }\n\n    let targetOptions = '';\n    let isTargetCustom = true;\n\n    $.each(s.anchor.targets, (key, val) => {\n      targetOptions += `<option value=\"${val}\">${Locale.translate(key)}</option>`;\n      if ((this.settings.anchor.defaultTargetText).toLowerCase() === (key).toLowerCase()) {\n        isTargetCustom = false;\n      }\n    });\n\n    if (isTargetCustom) {\n      targetOptions += `<option value=\"${s.anchor.target}\">${s.anchor.target}</option>`;\n    }\n    // TODO: Rename to link when you get strings\n    return $(`<div class=\"modal editor-modal-url\" id=\"modal-url-${this.id}\"></div>`)\n      .html(`<div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h1 class=\"modal-title\">${Locale.translate('InsertAnchor')}</h1>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"field\">\n            <label for=\"em-url-${this.id}\">${Locale.translate('Url')}</label>\n            <input id=\"em-url-${this.id}\" name=\"em-url-${this.id}\" type=\"text\" value=\"${s.anchor.url}\">\n          </div>\n          ${(s.anchor.showIsClickable ? (`<div class=\"field\">\n            <input type=\"checkbox\" class=\"checkbox\" id=\"em-isclickable-${this.id}\" name=\"em-isclickable-${this.id}\" checked=\"${s.anchor.isClickable}\">\n            <label for=\"em-isclickable-${this.id}\" class=\"checkbox-label\"> ${Locale.translate('Clickable')}</label>\n          </div>`) : '')}\n          <div class=\"field\">\n            <label for=\"em-class-${this.id}\">${Locale.translate('CssClass')}</label>\n            <input id=\"em-class-${this.id}\" name=\"em-class-${this.id}\" type=\"text\" value=\"${s.anchor.class}\">\n          </div>\n          <div class=\"field\">\n            <label for=\"em-target-${this.id}\" class=\"label\"> ${Locale.translate('Target')}</label>\n            <select id=\"em-target-${this.id}\" name=\"em-target-${this.id}\" class=\"dropdown\">\n              ${targetOptions}\n            </select>\n          </div>\n          <div class=\"modal-buttonset\">\n            <button type=\"button\" class=\"btn-modal btn-cancel\"> ${Locale.translate('Cancel')}</button>\n            <button type=\"button\" class=\"btn-modal-primary\"> ${Locale.translate('Insert')}</button>\n          </div>\n        </div>\n      </div>`).appendTo('body');\n  },\n\n  /**\n   * Function that creates the Image Dialog. This can be customized by making a\n    modal with ID `#modal-image-{this.id}`\n   * @private\n   * @returns {void}\n   */\n  createImageModal() {\n    const imageModal = $(`#modal-image-${this.id}`);\n\n    if (imageModal.length > 0) {\n      return imageModal;\n    }\n    return $(`<div class=\"modal editor-modal-image\" id=\"modal-image-${this.id}\"></div>'`)\n      .html(`<div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h1 class=\"modal-title\">${Locale.translate('InsertImage')}</h1>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"field\">\n            <label for=\"image-${this.id}\">${Locale.translate('Url')}</label>\n            <input id=\"image-${this.id}\" name=\"image-${this.id}\" type=\"text\" value=\"${this.settings.image.url}\">\n          </div>\n          <div class=\"modal-buttonset\">\n            <button type=\"button\" class=\"btn-modal btn-cancel\">\n              ${Locale.translate('Cancel')}</button>\n            <button type=\"button\" class=\"btn-modal-primary\">\n              ${Locale.translate('Insert')}</button>\n          </div>\n        </div>\n      </div>`).appendTo('body');\n  },\n\n  bindAnchorPreview() {\n    this.element.find('a').tooltip({\n      content() {\n        return $(this).attr('href');\n      }\n    });\n  },\n\n  updateCurrentLink(alink) {\n    const emUrl = xssUtils.stripTags($(`[name=\"em-url-${this.id}\"]`).val());\n    const emClass = xssUtils.stripTags($(`[name=\"em-class-${this.id}\"]`).val());\n    const emTarget = xssUtils.stripTags($(`[name=\"em-target-${this.id}\"]`).val());\n    const emIsClickable = this.settings.anchor.showIsClickable ? $(`[name=\"em-isclickable-${this.id}\"]`).is(':checked') : this.settings.anchor.isClickable;\n\n    if (alink) {\n      alink[0].setAttribute('href', this.fixLinkFormat((emUrl && $.trim(emUrl).length ? emUrl : this.settings.anchor.defaultUrl)));\n      alink[0].setAttribute('class', (emClass && $.trim(emClass).length ? emClass : this.settings.anchor.defaultClass));\n      alink[0].setAttribute('data-url', (emUrl && $.trim(emUrl).length ? emUrl : this.settings.anchor.defaultUrl).replace('http://', ''));\n    }\n\n    if (emIsClickable) {\n      alink.attr('contenteditable', false);\n    } else {\n      alink.removeAttr('contenteditable');\n    }\n\n    if (emTarget && $.trim(emTarget).length) {\n      alink.attr('target', emTarget);\n    } else {\n      alink.removeAttr('target');\n    }\n  },\n\n  createLink(input) {\n    // Restore Selection in the Editor and Variables\n    this.restoreSelection(this.savedSelection);\n\n    // Fix and Format the Link\n    const cleanValue = xssUtils.stripTags(this.fixLinkFormat(input[0].value));\n    input.val(cleanValue);\n\n    // Set selection url/class/target for Link\n    this.settings.anchor.url = input.val();\n    this.settings.anchor.class = $(`[name=\"em-class-${this.id}\"]`).val();\n    this.settings.anchor.target = $(`[name=\"em-target-${this.id}\"]`).val();\n    this.settings.anchor.isClickable = this.settings.anchor.showIsClickable ?\n      $(`[name=\"em-isclickable-${this.id}\"]`).is(':checked') : this.settings.anchor.isClickable;\n\n    const alink = $(`<a data-url=\"${cleanValue}\" href=\"${cleanValue}\">${cleanValue}</a>`);\n\n    if (this.settings.anchor.class && $.trim(this.settings.anchor.class).length) {\n      alink.addClass(this.settings.anchor.class);\n    }\n    if (this.settings.anchor.target && $.trim(this.settings.anchor.target).length) {\n      alink.attr('target', this.settings.anchor.target);\n    }\n    if (this.settings.anchor.isClickable) {\n      alink.attr('contenteditable', false);\n    } else {\n      alink.removeAttr('contenteditable');\n    }\n\n    if (this.sourceViewActive()) {\n      this.insertTextAreaContent(input.val(), 'anchor');\n    } else {\n      let sel;\n      let range;\n      let rangeChildren;\n      let rangeStr;\n      let rangeImg;\n\n      if (!this.selection.isCollapsed || this.isIe11) {\n        // get example from: http://jsfiddle.net/jwvha/1/\n        // and info: http://stackoverflow.com/questions/6690752/insert-html-at-caret-in-a-contenteditable-div\n        if (window.getSelection) {\n          // IE9 and non-IE\n          sel = window.getSelection();\n          if (sel.getRangeAt && sel.rangeCount) {\n            range = sel.getRangeAt(0);\n            rangeStr = `${range}`;\n            if (rangeStr.trim() !== '') {\n              alink.html(rangeStr);\n            }\n\n            rangeChildren = range.commonAncestorContainer.children;\n            const len = rangeChildren ? rangeChildren.length : 0;\n            for (let i = 0; i < len; i++) {\n              const rangeChild = rangeChildren[i];\n\n              if (rangeChild instanceof HTMLImageElement) {\n                rangeImg = rangeChild;\n              }\n            }\n            if (rangeImg) {\n              alink.html(rangeImg.outerHTML);\n            }\n\n            range.deleteContents();\n\n            // Range.createContextualFragment() would be useful here but is\n            // only relatively recently standardized and is not supported in\n            // some browsers (IE9, for one)\n            const el = document.createElement('div');\n            el.innerHTML = alink[0].outerHTML;\n            const frag = document.createDocumentFragment();\n            let node;\n            let lastNode;\n\n            while ((node = el.firstChild)) {// eslint-disable-line\n              lastNode = frag.appendChild(node);\n            }\n            range.insertNode(frag);\n\n            // Preserve the selection\n            if (lastNode) {\n              range = range.cloneRange();\n              range.setStartAfter(lastNode);\n              range.collapse(true);\n              sel.removeAllRanges();\n              sel.addRange(range);\n            }\n          }\n        }\n      } else {\n        document.execCommand('insertHtml', null, alink[0].outerHTML);\n        setTimeout(() => {\n          this.getCurrentElement().focus();\n        }, 1);\n      }\n      this.bindAnchorPreview();\n    }\n  },\n\n  fixLinkFormat(value) {\n    if (value.match(/^https?:\\/\\//)) {\n      return value;\n    }\n    return `http://${value}`;\n  },\n\n  // Setup Events For Text Selection\n  bindSelect() {\n    let selectionTimer = '';\n\n    this.selectionHandler = () => {\n      clearTimeout(selectionTimer);\n      selectionTimer = setTimeout(() => {\n        this.checkSelection();\n      }, this.settings.delay);\n    };\n\n    const currentElement = this.getCurrentElement();\n\n    currentElement.off('mouseup.editor keyup.editor')\n      .on('mouseup.editor keyup.editor', this.selectionHandler);\n\n    return this;\n  },\n\n  checkSelection() {\n    let newSelection;\n\n    if (this.selection === undefined) {\n      if (this.sourceViewActive()) {\n        newSelection = this.textarea.val().substring(\n          this.textarea[0].selectionStart,\n          this.textarea[0].selectionEnd\n        ).toString().trim();\n        this.hideToolbarActions();\n        return;\n      }\n    }\n\n    newSelection = window.getSelection();\n    const selectionElement = this.getSelectionElement();\n    if (!selectionElement) {\n      this.hideToolbarActions();\n    } else {\n      this.checkSelectionElement(newSelection, selectionElement);\n    }\n    return this;\n  },\n\n  getSelectionElement() {\n    let range;\n    let current;\n    let parent;\n    let result;\n    const selection = window.getSelection();\n    const getElement = (e) => {\n      let localParent = e;\n      try {\n        while (!localParent.getAttribute('data-editor')) {\n          localParent = localParent.parentNode;\n        }\n      } catch (errb) {\n        return false;\n      }\n      return localParent;\n    };\n\n    // First try on current node\n    try {\n      range = selection.getRangeAt(0);\n      current = range.commonAncestorContainer;\n      parent = current.parentNode;\n      result = current.getAttribute('data-editor') ? current : getElement(parent);\n    // If not search in the parent nodes.\n    } catch (err) {\n      result = getElement(parent);\n    }\n    return result;\n  },\n\n  // See if the Editor is Selected and Show Toolbar\n  checkSelectionElement(newSelection, selectionElement) {\n    const currentElement = this.sourceViewActive() ? this.sourceView[0] : this.element[0];\n\n    this.selection = newSelection;\n    this.selectionRange = this.selection.getRangeAt(0);\n    if (currentElement === selectionElement) {\n      this.setToolbarButtonStates();\n      return;\n    }\n    this.hideToolbarActions();\n  },\n\n  // Set button states for toolbar buttons\n  setToolbarButtonStates() {\n    this.toolbar.find('button').removeClass('is-active');\n    this.checkActiveButtons();\n    return this;\n  },\n\n  checkActiveButtons() {\n    this.checkButtonState('bold');\n    this.checkButtonState('italic');\n    this.checkButtonState('underline');\n    this.colorpickerButtonState('foreColor');\n    if (this.toolbar.find('.buttonset [data-action=\"backColor\"]').length) {\n      this.colorpickerButtonState('backColor');\n    }\n\n    let parentNode = this.getSelectedParentElement();\n\n    while (parentNode.tagName !== undefined &&\n      this.parentElements.indexOf(parentNode.tagName.toLowerCase) === -1) {\n      this.activateButton(parentNode.tagName.toLowerCase());\n\n      // we can abort the search upwards if we leave the contentEditable element\n      if (this.element.is(parentNode)) {\n        break;\n      }\n      parentNode = parentNode.parentNode;\n    }\n  },\n\n  checkButtonState(command) {\n    if (!document.queryCommandState) {\n      return;\n    }\n\n    if (document.queryCommandState(command)) {\n      this.toolbar.find(`[data-action=\"${command}\"]`).addClass('is-active');\n    } else {\n      this.toolbar.find(`[data-action=\"${command}\"]`).removeClass('is-active');\n    }\n  },\n\n  rangeSelectsSingleNode(range) {\n    const startNode = range.startContainer;\n    return startNode === range.endContainer &&\n        startNode.hasChildNodes() &&\n        range.endOffset === range.startOffset + 1;\n  },\n\n  getSelectedParentElement() {\n    let selectedParentElement = null;\n    const range = this.selectionRange;\n\n    if (this.rangeSelectsSingleNode(range)) {\n      selectedParentElement = range.startContainer.childNodes[range.startOffset];\n    } else if (range.startContainer.nodeType === 3) {\n      selectedParentElement = range.startContainer.parentNode;\n    } else {\n      selectedParentElement = range.startContainer;\n    }\n    return selectedParentElement;\n  },\n\n  // Hide Toolbar\n  hideToolbarActions() {\n    if (this.toolbar !== undefined) {\n      this.toolbar.removeClass('is-active');\n    }\n  },\n\n  // Handle Pasted In Text\n  bindPaste() {\n    const self = this;\n    const currentElement = self.getCurrentElement();\n\n    this.pasteWrapper = function (e) {\n      let paste;\n      if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n        paste = e.originalEvent.clipboardData.getData('text/plain');// Standard\n      } else {\n        paste = window.clipboardData && window.clipboardData.getData ?\n          window.clipboardData.getData('Text') : false;// MS : false\n      }\n\n      let p;\n      let paragraphs;\n      let html = '';\n\n      if (self.sourceViewActive()) {\n        return this;\n      }\n\n      if (paste && !e.defaultPrevented) {\n        e.preventDefault();\n        paragraphs = paste.split(/[\\r\\n]/g);\n\n        for (p = 0; p < paragraphs.length; p += 1) {\n          if (paragraphs[p] !== '') {\n            if (navigator.userAgent.match(/firefox/i) && p === 0) {\n              html += `<p>${self.htmlEntities(paragraphs[p])}</p>`;\n            } else if ((/\\.(gif|jpg|jpeg|tiff|png)$/i).test(paragraphs[p])) {\n              html += `<img src=\"${self.htmlEntities(paragraphs[p])}\" />`;\n            } else {\n              html += `<p>${self.htmlEntities(paragraphs[p])}</p>`;\n            }\n          }\n        }\n\n        if (document.queryCommandSupported('insertText')) {\n          document.execCommand('insertHTML', false, html);\n          return false;\n        }\n        // IE > 7\n        self.pasteHtmlAtCaret(html);\n      }\n    };\n\n    this.pasteWrapperHtml = function (e) {\n      if (self.sourceViewActive()) {\n        return this;\n      }\n      let types;\n      let clipboardData;\n      let pastedData;\n      let paste;\n      let p;\n      let paragraphs;\n\n      if (e.clipboardData || e.originalEvent) {\n        if (e.clipboardData && e.clipboardData.types) {\n          clipboardData = e.clipboardData;\n        } else if (e.originalEvent && e.originalEvent.clipboardData &&\n           e.originalEvent.clipboardData.getData) {\n          clipboardData = e.originalEvent.clipboardData;\n        }\n      }\n\n      if (clipboardData && clipboardData.types) {\n        types = clipboardData.types;\n        if ((types instanceof DOMStringList && types.contains('text/html')) ||\n            (types.indexOf && types.indexOf('text/html') !== -1) || self.isIeEdge) {\n          pastedData = e.originalEvent.clipboardData.getData('text/html');\n        }\n        if (types instanceof DOMStringList && types.contains('text/plain')) {\n          pastedData = e.originalEvent.clipboardData.getData('text/plain');\n        }\n        if ((typeof types === 'object' && types[0] && types[0] === 'text/plain') && !types[1]) {\n          pastedData = e.originalEvent.clipboardData.getData('text/plain');\n        }\n      } else {\n        paste = window.clipboardData ? window.clipboardData.getData('Text') : '';\n        paragraphs = paste.split(/[\\r\\n]/g);\n        pastedData = '';\n        for (p = 0; p < paragraphs.length; p += 1) {\n          if (paragraphs[p] !== '') {\n            if (navigator.userAgent.match(/firefox/i) && p === 0) {\n              pastedData += `<p>${self.htmlEntities(paragraphs[p])}</p>`;\n            } else if ((/\\.(gif|jpg|jpeg|tiff|png)$/i).test(paragraphs[p])) {\n              pastedData += `<img src=\"${self.htmlEntities(paragraphs[p])}\" />`;\n            } else {\n              pastedData += `<p>${self.htmlEntities(paragraphs[p])}</p>`;\n            }\n          }\n        }\n      }\n\n      self.pastedData = self.isIe11 ?\n        pastedData : self.getCleanedHtml(pastedData);\n\n      /**\n      * Fires before paste.\n      *\n      * @event beforepaste\n      * @memberof Editor\n      * @type {object}\n      * @property {object} event - The jquery event object\n      * @property {string} pastedData .\n      */\n      $.when(self.element.triggerHandler('beforepaste', [{ pastedData: self.pastedData }])).done(() => {\n        if (self.pastedData && !e.defaultPrevented) {\n          if (!self.isIe11 && !self.isIeEdge) {\n            e.preventDefault();\n          }\n\n          if (document.queryCommandSupported('insertText')) {\n            document.execCommand('insertHTML', false, self.pastedData);\n            return false;\n          }\n          self.pasteHtmlAtCaret(self.pastedData);\n        }\n\n        /**\n        * Fires after paste.\n        *\n        * @event afterpaste\n        * @memberof Editor\n        * @type {object}\n        * @property {object} event - The jquery event object\n        * @property {string} pastedData .\n        */\n        self.element.triggerHandler('afterpaste', [{ pastedData: self.pastedData }]);\n        self.pastedData = null;\n      });\n      if (!self.isIe11) {\n        return false;\n      }\n    };\n\n    currentElement.on('paste.editor', (self.settings.pasteAsPlainText ?\n      self.pasteWrapper : self.pasteWrapperHtml));\n\n    return this;\n  },\n\n  pasteHtmlAtCaret(html) {\n    const self = this;\n    const templIE11 = 'x-text-content-templ-x';\n\n    let sel;\n    let range;\n    if (window.getSelection) {\n      sel = window.getSelection();\n      if (sel.getRangeAt && sel.rangeCount) {\n        range = sel.getRangeAt(0);\n        range.deleteContents();\n\n        if (self.isIe11) {\n          html = templIE11;\n        }\n\n        // Range.createContextualFragment() would be useful here but is\n        // only relatively recently standardized and is not supported in\n        // some browsers\n        const el = document.createElement('div');\n\n        el.innerHTML = html;\n\n        const frag = document.createDocumentFragment();\n        let node;\n        let lastNode;\n\n        while ((node = el.firstChild)) {// eslint-disable-line\n          lastNode = frag.appendChild(node);\n        }\n        range.insertNode(frag);\n\n        // Preserve the selection\n        if (lastNode) {\n          range = range.cloneRange();\n          range.setStartAfter(lastNode);\n          range.collapse(true);\n          sel.removeAllRanges();\n          sel.addRange(range);\n        }\n\n        // IE 11\n        if (self.isIe11) {\n          let maxRun = 50;\n          const deferredIE11 = $.Deferred();\n\n          const waitForPastedData = (elem, savedContent) => {\n            maxRun--;\n            if (maxRun < 0) {\n              deferredIE11.reject();\n              return;\n            }\n            // If data has been processed by browser, process it\n            if (elem.childNodes && elem.childNodes.length > 0) {\n              // Retrieve pasted content via innerHTML\n              // (Alternatively loop through elem.childNodes or elem.getElementsByTagName here)\n              html = elem.innerHTML;\n              // self.pastedData = getCleanedHtml(elem.innerHTML);\n              // Restore saved content\n              elem.innerHTML = '';\n              elem.appendChild(savedContent);\n              deferredIE11.resolve();\n            } else {\n              // Else wait 5ms and try again\n              setTimeout(() => {\n                waitForPastedData(elem, savedContent);\n              }, 5);\n            }\n          };\n\n          // Everything else: Move existing element contents to a DocumentFragment for safekeeping\n          const savedContent = document.createDocumentFragment();\n          while (self.element[0].childNodes.length > 0) {\n            savedContent.appendChild(self.element[0].childNodes[0]);\n          }\n          // Then wait for browser to paste content into it and cleanup\n          waitForPastedData(self.element[0], savedContent);\n\n          $.when(deferredIE11).done(() => {\n            let str = '';\n            let thisNode = self.element\n              .find(`:contains(+ ${templIE11})`)\n              .filter(function () {\n                return (this.textContent === templIE11);\n              });\n\n            if (!thisNode.length) {\n              thisNode = self.element\n                .find(`:contains(+ ${templIE11})`)\n                .filter(function () {\n                  return (this.textContent.indexOf(templIE11) > -1 && this.tagName !== 'UL');\n                });\n            }\n\n            html = self.getCleanedHtml(html);\n\n            // Working with list\n            // Start with \"<li\"\n            let pasteHtml = '';\n            if (/(^(\\s+?)?<li)/ig.test(html)) {\n              // Pasted data starts and ends with \"li\" tag\n              if (/((\\s+?)?<\\/li>(\\s+?)?$)/ig.test(html)) { // ends with \"</li>\"\n                // Do not add \"ul\" if pasting on \"li\" node\n                if (!thisNode.is('li')) {\n                  html = `<ul>${html}</ul>`;\n                }\n                pasteHtml = html;\n              } else if (thisNode.is('li')) {\n                // Missing at the end \"</li>\" tag\n                // Pasting on \"li\" node\n                pasteHtml = `${html}</li>`;\n              } else {\n                // Not pasting on \"li\" node\n\n                // If ul was closed and have extra nodes after list close\n                str = (html.match(/<\\/ul|<\\/ol/gi) || []);\n                // Pasted data contains \"ul or ol\" tags\n                if (str.length) {\n                  pasteHtml = html;\n                } else {\n                  pasteHtml = `${html}</li></ul>`;\n                }\n              }\n            } else if (/((\\s+?)?<\\/li>(\\s+?)?$)/ig.test(html)) {\n              // Ends with \"</li>\" tag, but not started with \"li\" tag\n\n              // Pasting on \"li\" node\n              if (thisNode.is('li')) {\n                pasteHtml = `<li>${html}`;\n              } else {\n                str = (html.match(/<ul|<ol/gi) || []);\n                // Pasted data contains \"ul or ol\" tags\n                if (str.length) {\n                  html += (str[str.length - 1]).replace(/<(ul|ol)/gi, '<$1>');\n                } else {\n                  html = `<ul>${html}</ul>`;\n                }\n                pasteHtml = html;\n              }\n            }\n\n            if (pasteHtml) {\n              DOM.html(thisNode, pasteHtml, '*');\n            }\n\n            // Default case\n            str = self.element[0].innerHTML;\n            if (str.indexOf(templIE11) > -1) {\n              str = str.replace(templIE11, html);\n            }\n            self.element[0].innerHTML = self.getCleanedHtml(str);\n          });\n        }\n      }\n    } else if (document.selection && document.selection.type !== 'Control') {\n      document.selection.createRange().pasteHTML(html);\n    }\n  },\n\n  // Get cleaned extra from html\n  getCleanedHtml(pastedData) {\n    let attributeStripper;\n    let s = pastedData || '';\n\n    const badAttributes = [\n      'start', 'xmlns', 'xmlns:o', 'xmlns:w', 'xmlns:x', 'xmlns:m',\n      'onmouseover', 'onmouseout', 'onmouseenter', 'onmouseleave',\n      'onmousemove', 'onload', 'onfocus', 'onblur', 'onclick',\n      'style'\n    ];\n\n    // Remove extra word formating\n    if (this.isWordFormat(s)) {\n      s = this.cleanWordHtml(s);\n    }\n\n    // Remove bad attributes\n    for (let i = 0, l = badAttributes.length; i < l; i++) {\n      attributeStripper = new RegExp(` ${badAttributes[i]}=\"(.*?)\"`, 'gi');\n      s = this.stripAttribute(s, badAttributes[i], attributeStripper);\n\n      attributeStripper = new RegExp(` ${badAttributes[i]}='(.*?)'`, 'gi');\n      s = this.stripAttribute(s, badAttributes[i], attributeStripper);\n    }\n\n    // Remove \"ng-\" directives and \"ng-\" classes\n    s = s.replace(/\\sng-[a-z-]+/, '');\n\n    // Remove comments\n    s = s.replace(/<!--(.*?)-->/gm, '');\n\n    // Remove extra spaces\n    s = s.replace(/\\s\\s+/g, ' ').replace(/\\s>+/g, '>');\n\n    // Remove extra attributes from list elements\n    s = s.replace(/<(ul|ol)(.*?)>/gi, '<$1>');\n\n    // Remove empty list\n    s = s.replace(/<li><\\/li>/gi, '');\n    s = s.replace(/<(ul|ol)><\\/(ul|ol)>/gi, '');\n\n    // Remove html and body tags\n    s = s.replace(/<\\/?(html|body)(.*?)>/gi, '');\n\n    // Remove header tag and content\n    s = s.replace(/<head\\b[^>]*>(.*?)<\\/head>/gi, '');\n\n    // Remove empty tags\n    s = s.replace(/<[^/>]+>[\\s]*<\\/[^>]+>/gi, '');\n\n    if (s.indexOf('') > -1) {\n      // Replace span and paragraph tags from bulleted list pasting\n      s = s.replace(/<\\/p>/gi, '</li>');\n      s = s.replace(/<p><span><span><\\/span><\\/span>/gi, '<li>');\n      // Remove white space\n      s = s.replace(/<\\/li>\\s<li>/gi, '<\\/li><li>');\n      // Add in opening and closing ul tags\n      s = [s.slice(0, s.indexOf('<li>')), '<ul>', s.slice(s.indexOf('<li>'))].join('');\n      s = [s.slice(0, s.lastIndexOf('</li>')), '</ul>', s.slice(s.lastIndexOf('</li>'))].join('');\n    }\n\n    return s;\n  },\n\n  htmlEntities(str) {\n    // converts special characters (e.g., <) into their escaped/encoded values (e.g., &lt;).\n    // This allows you to display the string without the browser reading it as HTML.\n    return String(str)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;');\n  },\n\n  bindWindowActions() {\n    const editorContainer = this.element.closest('.editor-container');\n    const currentElement = this.getCurrentElement();\n    const self = this;\n\n    this.element\n    // Work around for Firefox with using keys was not focusing on first child in editor\n    // Firefox behaves differently than other browsers\n      .on('mousedown.editor', () => {\n        this.mousedown = true;\n      })\n      .on('focus.editor', () => {\n        if (this.isFirefox && !this.mousedown && this.element === currentElement) {\n          this.setFocus();\n        }\n      })\n\n      // Work around for Chrome's bug wrapping contents in <span>\n      // http://www.neotericdesign.com/blog/2013/3/working-around-chrome-s-contenteditable-span-bug\n      .on('DOMNodeInserted', (e) => {\n        const target = $(e.target);\n        const helper = $('<b>helper</b>');\n\n        if (e.target.tagName === 'IMG') {\n          target.removeAttr('id style srcset');\n        } else if (e.target.tagName === 'SPAN') {\n          target.before(helper);\n          helper.after(target.contents());\n          helper.add(target).remove();\n        }\n      });\n\n    editorContainer\n      .on('focus.editor', '.editor, .editor-source', function () {\n        const elem = $(this);\n\n        editorContainer.addClass('is-active');\n        setTimeout(() => {\n          if (elem.hasClass('error')) {\n            editorContainer.parent().find('.editor-toolbar').addClass('error');\n            editorContainer.parent().find('.editor-source').addClass('error');\n          }\n        }, 100);\n      })\n      .on('blur.editor', '.editor, .editor-source', () => {\n        editorContainer.removeClass('is-active');\n        editorContainer.parent().find('.editor-toolbar').removeClass('error');\n        editorContainer.parent().find('.editor-source').removeClass('error');\n      });\n\n    if (self.settings.onLinkClick) {\n      editorContainer.on('click.editorlinks', 'a', (e) => {\n        self.settings.onLinkClick(e, { elem: this, url: e.currentTarget.getAttribute('data-url') });\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        e.stopPropagation();\n      });\n    }\n\n    // Attach Label\n    const label = this.element.prevAll('.label');\n    for (let i = 0, l = label.length; i < l; i++) {\n      label[i].style.cursor = 'default';\n    }\n    label.on('click.editor', () => {\n      currentElement.focus();\n    });\n    currentElement.attr('aria-label', label.text());\n    return this;\n  },\n\n  // Restore Text Selection\n  restoreSelection(savedSel) {\n    const sel = window.getSelection();\n\n    if (!savedSel) {\n      savedSel = this.savedSelection;\n    }\n\n    if (savedSel) {\n      sel.removeAllRanges();\n      for (let i = 0, len = savedSel.length; i < len; i += 1) {\n        sel.addRange(savedSel[i]);\n      }\n    }\n  },\n\n  // Save Text Selection\n  saveSelection() {\n    let ranges;\n    const sel = window.getSelection();\n\n    if (sel.getRangeAt && sel.rangeCount) {\n      ranges = [];\n      for (let i = 0, len = sel.rangeCount; i < len; i += 1) {\n        ranges.push(sel.getRangeAt(i));\n      }\n      return ranges;\n    }\n    return null;\n  },\n\n  // Get the Element the Caret idea from http://bit.ly/1kRmZIL\n  getSelectionStart() {\n    const node = document.getSelection().anchorNode;\n    const startNode = (node && node.nodeType === 3 ? node.parentNode : node);\n    return startNode;\n  },\n\n  getrange() {\n    return window.getSelection().getRangeAt(0);\n  },\n\n  // Find element within the selection\n  // http://stackoverflow.com/questions/6052870/how-to-know-if-there-is-a-link-element-within-the-selection\n  findElementInSelection(tagname, container) {\n    let el;\n    let comprng;\n    let selparent;\n    const rng = this.getrange();\n\n    if (rng) {\n      selparent = rng.commonAncestorContainer || rng.parentElement();\n      // Look for an element *around* the selected range\n      for (el = selparent; el !== container; el = el.parentNode) {\n        if (el && el.tagName && el.tagName.toLowerCase() === tagname) {\n          return el;\n        }\n      }\n\n      // Look for an element *within* the selected range\n      if (!rng.collapsed && (rng.text === undefined || rng.text) &&\n       selparent.getElementsByTagName) {\n        el = selparent.getElementsByTagName(tagname);\n        comprng = document.createRange ? document.createRange() : document.body.createTextRange();\n\n        for (let i = 0, len = el.length; i < len; i++) {\n          // determine if element el[i] is within the range\n          if (document.createRange) { // w3c\n            comprng.selectNodeContents(el[i]);\n            if (rng.compareBoundaryPoints(Range.END_TO_START, comprng) < 0 &&\n             rng.compareBoundaryPoints(Range.START_TO_END, comprng) > 0) {\n              return el[i];\n            }\n          } else { // microsoft\n            comprng.moveToElementText(el[i]);\n            if (rng.compareEndPoints('StartToEnd', comprng) < 0 && rng.compareEndPoints('EndToStart', comprng) > 0) {\n              return el[i];\n            }\n          }\n        }\n      }\n    }\n  },\n\n  // Restore if Selection is a Link\n  restoreLinkSelection() {\n    const currentLink = $(this.findElementInSelection('a', this.element[0]));\n\n    this.settings.anchor.url = this.settings.anchor.defaultUrl;\n    this.settings.anchor.class = this.settings.anchor.defaultClass;\n    this.settings.anchor.target = this.settings.anchor.defaultTarget;\n    this.settings.anchor.isClickable = this.settings.anchor.defaultIsClickable;\n\n    if (currentLink.length) {\n      this.settings.anchor.url = currentLink.attr('href');\n      this.settings.anchor.class = currentLink.attr('class');\n      this.settings.anchor.target = currentLink.attr('target');\n      const contenteditable = currentLink.attr('contenteditable');\n\n      if (contenteditable === false || contenteditable === 'false') {\n        this.settings.anchor.isClickable = true;\n      }\n    }\n  },\n\n  // Run the CE action.\n  execAction(action) {\n    const currentElement = this.getCurrentElement();\n\n    // Visual Mode\n    if (currentElement === this.element) {\n      if (action.indexOf('append-') > -1) {\n        this.execFormatBlock(action.replace('append-', ''));\n      } else if (action === 'anchor') {\n        this.restoreLinkSelection();\n        this.modals.url.data('modal').open();\n      } else if (action === 'image') {\n        this.modals.image.data('modal').open();\n      } else if (action === 'foreColor' || action === 'backColor') {\n        this.colorpickerActions(action);\n      } else if (action === 'clearFormatting') {\n        this.clearFormatting();\n      } else if (action === 'source' || action === 'visual') {\n        this.toggleSource();\n      } else {\n        document.execCommand(action, false, null);\n      }\n    } else {\n      // Source Mode\n      switch (action) {\n        case 'visual':\n          this.toggleSource();\n          break;\n        case 'anchor':\n          this.modals.url.data('modal').open();\n          break;\n        default:\n          this.insertTextAreaContent(null, action);\n          break;\n      }\n    }\n  },\n\n  insertImage(url) {\n    document.execCommand('insertImage', false, url);\n  },\n\n  toggleSource() {\n    if (this.sourceViewActive()) {\n      this.element.empty().html(xssUtils.sanitizeHTML(this.textarea.val()));\n      this.element.removeClass('source-view-active hidden');\n      this.sourceView.addClass('hidden').removeClass('is-focused');\n      this.element.trigger('focus.editor');\n    } else {\n      // Format The Text being pulled from the WYSIWYG editor\n      const val = this.element.html().toString().trim()\n        .replace(/\\s+/g, ' ')\n        .replace(/<br( \\/)?>/g, '<br>\\n')\n        .replace(/<\\/p> /g, '</p>\\n\\n')\n        .replace(/<\\/blockquote>( )?/g, '</blockquote>\\n\\n');\n\n      this.textarea.val(val).focus();\n\n      // var val = this.element.html().toString();\n      // this.textarea.val(this.formatHtml(val)).focus();\n\n      this.element.addClass('source-view-active hidden');\n      this.sourceView.removeClass('hidden');\n      this.adjustSourceLineNumbers();\n      this.textarea.focus();\n    }\n    this.switchToolbars();\n  },\n\n  /**\n   * Function to clear formatting on selected area.\n   * @private\n   * @returns {void}\n   */\n  clearFormatting() {\n    const parentEl = this.getSelectionParentElement();\n    let parentTag = parentEl.tagName;\n    let align = {};\n\n    // Function to get text-align value if found\n    const getTextAlign = () => {\n      const isFound = el => el && el.style && el.style.textAlign !== '';\n      let elem = parentEl;\n      let found = isFound(elem);\n      let max = 9999;\n      while (!found && max > 0) {\n        max--;\n        elem = elem ? elem.parentNode : null;\n        found = elem && elem === this.element[0] || isFound(elem);\n      }\n      const r = { found: elem && elem !== parentEl && elem !== this.element[0] };\n      if (r.found) {\n        r.elem = elem;\n        r.textAlign = elem.style.textAlign;\n      }\n      return r;\n    };\n\n    // Clear other formated tags.\n    const clearFormatedTags = () => {\n      const replaceTag = (elem) => {\n        const parent = elem.parentNode;\n        const p = document.createElement('p');\n        p.innerHTML = elem.innerHTML;\n        parent.replaceChild(p, elem);\n      };\n      if (this.parentElements.indexOf(parentTag) > -1) {\n        if (parentTag !== 'p') {\n          document.execCommand('removeFormat', false, null);\n          replaceTag(parentEl);\n        }\n      } else {\n        this.parentElements.forEach((el) => {\n          if (el !== 'p') {\n            const nodes = [].slice.call(parentEl.querySelectorAll(el));\n            nodes.forEach(node => replaceTag(node));\n          }\n        });\n      }\n      // Blockquote or Pre\n      const nodes = [].slice.call(this.element[0].querySelectorAll('blockquote, pre'));\n      for (let i = 0, l = nodes.length; i < l; i++) {\n        let found = false;\n        const children = [].slice.call(nodes[i].children);\n        const checkChildren = (childrenNodes) => {\n          for (let i2 = 0, l2 = childrenNodes.length; i2 < l2; i2++) {\n            const child = childrenNodes[i2];\n            const childChildren = [].slice.call(child.children);\n            if (child === parentEl) {\n              found = true;\n            }\n            if (childChildren.length && !found) {\n              checkChildren(childChildren);\n            }\n          }\n        };\n        checkChildren(children);\n        if (found) {\n          document.execCommand('removeFormat', false, null);\n          replaceTag(nodes[i]);\n        }\n      }\n    };\n\n    // Clear all lists belongs to selection area\n    const clearLists = () => {\n      const normalizeList = (list) => {\n        const items = [].slice.call(list.querySelectorAll('li'));\n        if (items.length > 0) {\n          const fragment = document.createDocumentFragment();\n          items.forEach((item) => {\n            const textNode = document.createTextNode(item.textContent);\n            fragment.appendChild(textNode);\n            fragment.appendChild(document.createElement('br'));\n          });\n          const target = items[0].parentNode;\n          target.parentNode.insertBefore(fragment, target.nextSibling);\n          target.parentNode.removeChild(target);\n        }\n      };\n      if (parentTag === 'li') {\n        normalizeList(parentEl.parentNode);\n      } else if (/ul|ol/.test(parentTag)) {\n        normalizeList(parentEl);\n      } else {\n        const lists = [].slice.call(parentEl.parentNode.querySelectorAll('ul, ol'));\n        lists.forEach(list => normalizeList(list));\n      }\n    };\n\n    // Check if selection contains given node\n    const containsNodeInSelection = (node) => {\n      const sel = window.getSelection();\n      let r = false;\n      if (this.isIe11) {\n        const rangeAt = sel.getRangeAt(0);\n        const range = document.createRange();\n        range.selectNode(node);\n        const s2s = rangeAt.compareBoundaryPoints(Range.START_TO_END, range);\n        const s2e = rangeAt.compareBoundaryPoints(Range.START_TO_START, range);\n        const e2s = rangeAt.compareBoundaryPoints(Range.END_TO_START, range);\n        const e2e = rangeAt.compareBoundaryPoints(Range.END_TO_END, range);\n        r = ((s2s !== s2e) || (e2s !== e2e) || (s2s !== e2e));\n      } else {\n        r = sel.containsNode(node, true);\n      }\n      return r;\n    };\n\n    // Convert hyperlinks to plain text in selected area.\n    const hyperlinksToText = () => {\n      const toText = (a) => {\n        const parent = a.parentNode;\n        const text = a.firstChild;\n        parent.insertBefore(text, a);\n        parent.removeChild(a);\n        parent.normalize();\n      };\n      if (parentTag === 'a') {\n        toText(parentEl);\n      } else {\n        const links = [].slice.call(parentEl.querySelectorAll('a'));\n        links.forEach((a) => {\n          if (containsNodeInSelection(a)) {\n            toText(a);\n          }\n        });\n      }\n    };\n\n    if (parentEl && parentTag) {\n      parentTag = parentTag.toLowerCase();\n      align = getTextAlign();\n      clearLists();\n      clearFormatedTags();\n      hyperlinksToText();\n    }\n\n    // Some browser (IE, Firefox) use attr 'align' instead style `text-align`\n    const gParentEl = parentEl.parentNode;\n    if (gParentEl && (gParentEl !== this.element[0])) {\n      const alignAttrElems = [].slice.call(gParentEl.querySelectorAll('[align]'));\n      alignAttrElems.forEach(el => el.removeAttribute('align'));\n    }\n    document.execCommand('removeFormat', false, null);\n\n    // Restore style `text-align`, some browser (chrome, safari) clear `text-align` on parent node with command `removeFormat`\n    if (align.found) {\n      align.elem.style.textAlign = align.textAlign;\n    }\n  },\n\n  /**\n   * Get selection parent element.\n   * @private\n   * @returns {object} parent element.\n   */\n  getSelectionParentElement() {\n    let parentEl = null;\n    let sel;\n    if (window.getSelection) {\n      sel = window.getSelection();\n      if (sel.rangeCount) {\n        parentEl = sel.getRangeAt(0).commonAncestorContainer;\n        if (parentEl.nodeType !== 1) {\n          parentEl = parentEl.parentNode;\n        }\n      }\n    } else {\n      sel = document.selection;\n      if (sel && sel.type !== 'Control') {\n        parentEl = sel.createRange().parentElement();\n      }\n    }\n    return parentEl;\n  },\n\n  // Set ['foreColor'|'backColor'] button icon color in toolbar\n  colorpickerButtonState(action) {\n    const cpBtn = $(`[data-action=\"${action}\"]`, this.toolbar);\n    const cpApi = cpBtn.data('colorpicker');\n    const preventColors = ['transparent', '#1a1a1a', '#f0f0f0', '#ffffff', '#313236'];\n\n    let color = document.queryCommandValue(action);\n\n    // Set selection color checkmark in picker popup\n    // by adding/updating ['data-value'] attribute\n    if (cpApi) {\n      if (this.isFirefox && action === 'backColor') {\n        color = $(window.getSelection().focusNode.parentNode).css('background-color');\n      }\n      // IE-11 queryCommandValue returns the as decimal\n      if (typeof color === 'number') {\n        color = cpApi.decimal2rgb(color);\n      }\n      color = color ? cpApi.rgb2hex(color) : '';\n      cpBtn.attr('data-value', color)\n        .find('.icon').css('fill', (preventColors.indexOf(color.toLowerCase()) > -1) ? '' : color);\n    }\n    return { cpBtn, cpApi, color };\n  },\n\n  // Colorpicker actions ['foreColor'|'backColor']\n  colorpickerActions(action) {\n    const state = this.colorpickerButtonState(action);\n    const cpBtn = state.cpBtn;\n    const cpApi = state.cpApi;\n\n    cpBtn.one('selected.editor', (e, item) => {\n      // Detect Flex Toolbar item\n      let target = item;\n      if (target !== undefined && !(target instanceof $) && target.element) {\n        target = $(item.element);\n      }\n\n      // Use the value to set the color\n      let value = (`${target.data('value')}`).toLowerCase();\n      value = value !== '#' ? value : '';\n      if (value.indexOf('#') === -1) {\n        value = `#${value}`;\n      }\n\n      cpBtn.attr('data-value', value).find('.icon').css('fill', value);\n\n      if (this.isIe || action === 'foreColor') {\n        if (value) {\n          document.execCommand(action, false, value);\n        } else {\n          document.execCommand('removeFormat', false, action);\n        }\n      } else {\n        // [action: backColor] - for Chrome/Firefox/Safari\n\n        // FIX: \"backColor\" - Chrome/Firefox/Safari\n        // some reason font/span node not get inserted with \"backColor\"\n        // so use \"fontSize\" command to add node, then remove size attribute\n        // this fix will conflict with combination of font size & background color\n        document.execCommand('fontSize', false, '2');\n        const parent = this.getSelectionParentElement().parentNode;\n        const els = parent.getElementsByTagName('font');\n\n        // Clearing all the background style in any element node in selection's parent\n        for (let i = 0, j = els.length; i < j; i++) {\n          if (els[i].hasAttribute('style')) {\n            els[i].style.backgroundColor = '';\n          }\n        }\n\n        // Using timeout, firefox not executes with current call stack\n        setTimeout(() => {\n          for (let i = 0, l = els.length; i < l; i++) {\n            if (els[i].hasAttribute('size')) {\n              els[i].style.backgroundColor = value;\n              els[i].removeAttribute('size');\n            }\n          }\n        }, 0);\n      }\n\n      setTimeout(() => {\n        this.getCurrentElement().focus();\n      }, 0);\n    });\n\n    // Toggle colorpicker\n    cpApi.toggleList();\n  },\n\n  execFormatBlock(el) {\n    const selectionData = this.getSelectionData(this.selection.anchorNode);\n    // FF handles blockquote differently on formatBlock\n    // allowing nesting, we need to use outdent\n    // https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla\n    if (el === 'blockquote' && selectionData.el &&\n      selectionData.el.parentNode.tagName.toLowerCase() === 'blockquote') {\n      return document.execCommand('outdent', false, null);\n    }\n    if (selectionData.tagName === el) {\n      el = 'p';\n    }\n    // When IE we need to add <> to heading elements and\n    // blockquote needs to be called as indent\n    // http://stackoverflow.com/questions/10741831/execcommand-formatblock-headings-in-ie\n    // http://stackoverflow.com/questions/1816223/rich-text-editor-with-blockquote-function/1821777#1821777\n    if (this.isIe) {\n      if (el === 'blockquote') {\n        return document.execCommand('indent', false, el);\n      }\n      el = `<${el}>`;\n    }\n\n    return document.execCommand('formatBlock', false, el);\n  },\n\n  // Get What is Selected\n  getSelectionData(el) {\n    let tagName;\n\n    if (el && el.tagName) {\n      tagName = el.tagName.toLowerCase();\n    }\n\n    while (el && this.parentElements.indexOf(tagName) === -1) {\n      el = el.parentNode;\n      if (el && el.tagName) {\n        tagName = el.tagName.toLowerCase();\n      }\n    }\n\n    return { el, tagName };\n  },\n\n  isListItemChild(node) {\n    let parentNode = node.parentNode;\n    let tagName = parentNode.tagName.toLowerCase();\n\n    while (this.parentElements.indexOf(tagName) === -1 && tagName !== 'div') {\n      if (tagName === 'li') {\n        return true;\n      }\n      parentNode = parentNode.parentNode;\n      if (parentNode && parentNode.tagName) {\n        tagName = parentNode.tagName.toLowerCase();\n      } else {\n        return false;\n      }\n    }\n    return false;\n  },\n\n  destroyToolbar() {\n    // Unbind all events attached to the old element that involve triggering the toolbar hide/show\n    const checkJQ = el => el || $();\n    this.toolbar = checkJQ(this.toolbar);\n    this.element = checkJQ(this.element);\n    this.textarea = checkJQ(this.textarea);\n\n    const toolbarApi = this.toolbar.data('toolbar');\n    if (toolbarApi) {\n      toolbarApi.destroy();\n    }\n\n    const tooltips = this.toolbar.find('button');\n    for (let i = 0, l = tooltips.length; i < l; i++) {\n      const tooltip = $(tooltips[i]).data('tooltip');\n      if (tooltip && typeof tooltip.destroy === 'function') {\n        tooltip.destroy();\n      }\n    }\n\n    const colorpickers = $('[data-action=\"foreColor\"], [data-action=\"backColor\"]', this.element);\n    for (let i = 0, l = colorpickers.length; i < l; i++) {\n      const colorpicker = $(colorpickers[i]).data('colorpicker');\n      if (colorpicker && typeof colorpicker.destroy === 'function') {\n        colorpicker.destroy();\n      }\n    }\n\n    this.toolbar.off('touchstart.editor click.editor click.editor mousedown.editor');\n    this.toolbar.remove();\n    this.toolbar = undefined;\n    this.element.off('mouseup.editor keypress.editor input.editor keyup.editor keydown.editor focus.editor mousedown.editor DOMNodeInserted.editor updated.editor blur.editor paste.editor');\n    this.textarea.off('mouseup.editor click.editor keyup.editor input.editor focus.editor blur.editor');\n    this.element.prev('.label').off('click.editor');\n\n    this.element.closest('.editor-container').off('focus.editor blur.editor click.editorlinks');\n\n    let state = this.colorpickerButtonState('foreColor');\n    let cpBtn = state.cpBtn;\n    cpBtn.off('selected.editor');\n\n    state = this.colorpickerButtonState('backColor');\n    cpBtn = state.cpBtn;\n    cpBtn.off('selected.editor');\n\n    $(window).off('resize.editor');\n\n    if (this.modals) {\n      for (let i = 0, l = this.modals.length; i < l; i++) {\n        const modal = $(this.modals[i]);\n        const modalApi = modal.data('modal');\n        modal.off('beforeclose.editor close.editor open.editor beforeopen.editor');\n        if (modalApi && typeof modalApi.destroy === 'function') {\n          modalApi.destroy();\n        }\n      }\n    }\n    this.modals = {};\n\n    this.element.trigger('destroy.toolbar.editor');\n  },\n\n  /**\n   * Setup the preview mode.\n   * @private\n   * @returns {void}\n   */\n  setPreviewMode() {\n    const containerClassList = this.container[0].classList;\n    const elementClassList = this.element[0].classList;\n\n    if (!containerClassList.contains('is-preview')) {\n      if (!this.isEditable()) {\n        const classes = ['is-disabled', 'is-readonly', 'is-preview'];\n        containerClassList.remove(...classes);\n        elementClassList.remove(...classes);\n      }\n      if (this.sourceViewActive()) {\n        this.toggleSource();\n      }\n      containerClassList.add('is-preview');\n      elementClassList.remove('is-preview');\n      this.element[0].setAttribute('contenteditable', false);\n      this.element[0].removeAttribute('aria-multiline');\n      this.element[0].removeAttribute('role');\n\n      // Remove tooltip for links in editor\n      const links = [].slice.call(this.element[0].querySelectorAll('a'));\n      links.forEach((link) => {\n        const tooltipApi = $(link).data('tooltip');\n        if (tooltipApi && typeof tooltipApi.destroy === 'function') {\n          tooltipApi.destroy();\n        }\n      });\n    }\n  },\n\n  /**\n   * Destroy preview mode.\n   * @private\n   * @returns {void}\n   */\n  destroyPreviewMode() {\n    if (!this.container[0]) {\n      return;\n    }\n\n    const classList = this.container[0].classList;\n    if (classList.contains('is-preview')) {\n      classList.remove('is-preview');\n      if (!this.previewRendered) {\n        this.previewRendered = true;\n        this.init();\n      } else {\n        this.element[0].setAttribute('aria-multiline', true);\n        this.element[0].setAttribute('role', 'textbox');\n        this.bindAnchorPreview();\n      }\n    }\n  },\n\n  /**\n   * Check for the editor is in preview mode.\n   * @returns {boolean} true if editor in preview mode\n   */\n  isPreview() {\n    return this.container[0] ? this.container[0].classList.contains('is-preview') : false;\n  },\n\n  /**\n   * Check for the editor is in editable mode.\n   * @returns {boolean} true if editor is editabled\n   */\n  isEditable() {\n    let isEnabled = true;\n    const isContains = (el, className) => el.classList.contains(className);\n    ['is-disabled', 'is-readonly', 'is-preview'].forEach((className) => {\n      if (isContains(this.container[0], className) || isContains(this.element[0], className)) {\n        isEnabled = false;\n      }\n    });\n    return isEnabled;\n  },\n\n  /**\n   * Updates the component instance.  Can be used after being passed new settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, EDITOR_DEFAULTS);\n    }\n    return this\n      .teardown()\n      .init();\n  },\n\n  teardown() {\n    this.element.attr('contenteditable', 'false');\n    this.element.off('input.editor keyup.editor');\n    $('html').off('mouseup.editor');\n\n    this.destroyToolbar();\n    if (this.sourceView) {\n      this.sourceView.off('.editor');\n      this.sourceView.remove();\n      this.sourceView = null;\n    }\n\n    if ($('[data-editor=\"true\"]').length === 1) {\n      $(`#modal-url-${this.id}, #modal-image-${this.id}`).remove();\n    }\n\n    return this;\n  },\n\n  /**\n   * Destroy this component instance and remove all events and reset back to default.\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n  * Disable the editable area.\n  * @returns {void}\n  */\n  disable() {\n    this.destroyPreviewMode();\n    this.element.addClass('is-disabled').attr('contenteditable', 'false');\n    this.container.addClass('is-disabled');\n  },\n\n  /**\n  * Enable the editable area.\n  * @returns {void}\n  */\n  enable() {\n    this.destroyPreviewMode();\n    this.element.removeClass('is-disabled is-readonly').attr('contenteditable', 'true');\n    this.container.removeClass('is-disabled is-readonly');\n  },\n\n  /**\n  * Make the editable area readonly.\n  * @returns {void}\n  */\n  readonly() {\n    this.destroyPreviewMode();\n    this.element.removeClass('is-readonly').attr('contenteditable', 'false');\n    this.container.addClass('is-readonly');\n  },\n\n  /**\n   * Make the editable mode.\n   * @returns {void}\n   */\n  editable() {\n    this.enable();\n  },\n\n  /**\n   * Make the preview mode.\n   * @returns {void}\n   */\n  preview() {\n    if (!this.container[0].classList.contains('is-preview')) {\n      this.setPreviewMode();\n    }\n  },\n\n  // Fix to Firefox get focused by keyboard\n  setFocus() {\n    const el = ($.trim(this.element.html()).slice(0, 1) === '<') ?\n      $(':first-child', this.element)[0] : this.element[0];\n\n    window.setTimeout(() => {\n      let sel;\n      let range;\n      if (window.getSelection && document.createRange) {\n        range = document.createRange();\n        range.selectNodeContents(el);\n        range.collapse(true);\n        sel = window.getSelection();\n        sel.removeAllRanges();\n        sel.addRange(range);\n      } else if (document.body.createTextRange) {\n        range = document.body.createTextRange();\n        range.moveToElementText(el);\n        range.collapse(true);\n        range.select();\n      }\n    }, 1);\n  },\n\n  // Called whenever a paste event has occured\n  onPasteTriggered() {\n    if (!this.isFirefox && document.addEventListener) {\n      document.addEventListener('paste', (e) => {\n        if (typeof e.clipboardData !== 'undefined') {\n          const copiedData = e.clipboardData.items[0]; // Get the clipboard data\n          // If the clipboard data is of type image, read the data\n          if (copiedData.type.indexOf('image') === 0) {\n            const imageFile = copiedData.getAsFile();\n            // We will use HTML5 FileReader API to read the image file\n            const reader = new FileReader();\n\n            reader.onload = function (evt) {\n              const result = evt.target.result; // base64 encoded image\n              document.execCommand('insertImage', false, result);\n              // Create an image element and append it to the content editable div\n              // var img = document.createElement('img');\n              // img.src = result;\n              // document.getElementById('editablediv').appendChild(img);\n            };\n            // Read the image file\n            reader.readAsDataURL(imageFile);\n          }\n        }\n      }, false);\n    }\n  },\n\n  isWordFormat(content) {\n    return (\n      (/<font face=\"Times New Roman\"|class=\"?Mso|style=\"[^\"]*\\bmso-|style='[^'']*\\bmso-|w:WordDocument/i).test(content) ||\n      (/class=\"OutlineElement/).test(content) ||\n      (/id=\"?docs\\-internal\\-guid\\-/.test(content))\n    );\n  },\n\n  cleanWordHtml(content) {\n    let s = content;\n\n    // Word comments like conditional comments etc\n    s = s.replace(/<!--[\\s\\S]+?-->/gi, '');\n\n    // Remove comments, scripts (e.g., msoShowComment), XML tag, VML content,\n    // MS Office namespaced tags, and a few other tags\n    s = s.replace(/<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|img|meta|link|style|\\w:\\w+)(?=[\\s\\/>]))[^>]*>/gi, '');\n\n    // Convert <s> into <strike> for line-though\n    s = s.replace(/<(\\/?)s>/gi, '<$1strike>');\n\n    // Replace nbsp entites to char since it's easier to handle\n    s = s.replace(/&nbsp;/gi, '\\u00a0');\n\n    // Convert <span style=\"mso-spacerun:yes\"></span> to string of alternating\n    // breaking/non-breaking spaces of same length\n    s = s.replace(/<span\\s+style\\s*=\\s*\"\\s*mso-spacerun\\s*:\\s*yes\\s*;?\\s*\"\\s*>([\\s\\u00a0]*)<\\/span>/gi, (str, spaces) => ((spaces.length > 0) ?\n      spaces.replace(/./, ' ').slice(Math.floor(spaces.length / 2)).split('').join('\\u00a0') : ''));\n\n    // Remove line breaks / Mso classes\n    s = s.replace(/(\\n|\\r| class=(\\'|\")?Mso[a-zA-Z]+(\\'|\")?)/g, ' ');\n\n    const badTags = ['style', 'script', 'applet', 'embed', 'noframes', 'noscript'];\n\n    // Remove everything in between and including \"badTags\"\n    for (let i = 0, l = badTags.length; i < l; i++) {\n      const re = new RegExp(`<${badTags[i]}.*?${badTags[i]}(.*?)>`, 'gi');\n      s = s.replace(re, '');\n    }\n\n    return s;\n  },\n\n  // Strip attributes\n  stripAttribute(s, attribute, attributeStripper) {\n    return (attribute === 'style') ?\n      this.stripStyles(s, attributeStripper) :\n      s.replace(attributeStripper, '');\n  },\n\n  // Strip styles\n  stripStyles(s, styleStripper) {\n    const stylesToKeep = ['color', 'background', 'font-weight', 'font-style', 'text-decoration', 'text-align'];\n    return s.replace(styleStripper, (m) => {\n      m = m.replace(/( style=|(\"|\\'))/gi, '');\n      const attributes = m.split(';');\n      let strStyle = '';\n      for (let i = 0; i < attributes.length; i++) {\n        const entry = attributes[i].split(':');\n        strStyle += (stylesToKeep.indexOf(entry[0]) > -1) ? `${entry[0]}:${entry[1]};` : '';\n      }\n      return (strStyle !== '') ? ` style=\"${strStyle}\"` : '';\n    });\n  },\n\n  getIndent(level) {\n    let result = '';\n    let i = level * 2;\n    if (level > -1) {\n      while (i--) {\n        result += ' ';\n      }\n    }\n    return result;\n  },\n\n  formatHtml(html) {\n    html = html.trim();\n    let result = '';\n    let indentLevel = 0;\n    const tokens = html.split(/</);\n\n    for (let i = 0, l = tokens.length; i < l; i++) {\n      const parts = tokens[i].split(/>/);\n      if (parts.length === 2) {\n        if (tokens[i][0] === '/') {\n          indentLevel--;\n        }\n        result += this.getIndent(indentLevel);\n        if (tokens[i][0] !== '/') {\n          indentLevel++;\n        }\n        if (i > 0) {\n          result += '<';\n        }\n        result += `${parts[0].trim()} + >\\n`;\n        if (parts[1].trim() !== '') {\n          result += `${this.getIndent(indentLevel) + parts[1].trim().replace(/\\s+/g, ' ')}\\n`;\n        }\n        if (parts[0].match(/^(area|base|br|col|command|embed|hr|img|input|link|meta|param|source)/)) {\n          indentLevel--;\n        }\n      } else {\n        result += `${this.getIndent(indentLevel) + parts[0]}\\n`;\n      }\n    }\n    return result.trim();\n  },\n\n  /**\n   * Clear the editor of its contents.\n   */\n  clear() {\n    this.element.empty();\n    this.textarea.empty();\n    this.sourceView.find('.line-numbers').empty();\n    this.sourceView.find('.textarea-print').empty();\n  }\n\n};\n\n/* eslint-enable consistent-return */\n/* eslint-enable no-restricted-syntax */\n/* eslint-enable no-useless-escape */\nexport { Editor, COMPONENT_NAME };\n","import { Editor, COMPONENT_NAME } from './editor';\n\n// Initialize the plugin (Once)\n$.fn.editor = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Editor(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { Tmpl } from '../tmpl/tmpl';\nimport { Locale } from '../locale/locale';\n\n// Jquery Imports\nimport '../../utils/animations';\n\n// The name of this component\nconst COMPONENT_NAME = 'hierarchy';\n\n/**\n * The displays customizable hierarchical data such as an org chart.\n *\n * @class Hierarchy\n * @param {string} element The component element.\n * @param {string} [settings] The component settings.\n * @param {string} [settings.legend] Pass in custom markdown for the legend structure.\n * @param {string} [settings.legendKey] Key to use for the legend matching\n * @param {array} [settings.dataset=[]] Hierarchical Data to display\n * @param {boolean} [settings.newData=[]] New data to be appended into dataset\n * @param {string} [settings.templateId] Additional product name information to display\n * @param {boolean} [settings.mobileView=false] If true will only show mobile view, default using device info.\n * @param {number} [settings.leafHeight=null] Set the height of the leaf\n * @param {number} [settings.leafWidth=null] Set the width of the leaf\n * @param {string} [settings.beforeExpand=null] A callback that fires before node expansion of a node.\n * @param {boolean} [settings.paging=false] If true show pagination.\n * @param {boolean} [settings.renderSubLevel=false] If true elements with no children will be rendered detached\n * @param {boolean} [settings.layout=string] Which layout should be rendered {'horizontal', 'mobile-only', 'stacked', 'paging'}\n * @param {object} [settings.emptyMessage] An optional settings object for the empty message when there is no data.\n * @param {string} [settings.emptyMessage.title=(Locale ? Locale.translate('NoData')] The text to show\n * @param {string} [settings.emptyMessage.info=''] Longer block of test to show.\n * @param {string} [settings.emptyMessage.icon='icon-empty-no-data'] The icon to show.\n * @param {object} [settings.emptyMessage.button='{}'] The button and text to show with an optional click function.\n */\nconst HIERARCHY_DEFAULTS = {\n  legend: [],\n  legendKey: '',\n  dataset: [],\n  newData: [],\n  templateId: '', // Id to the Html Template\n  mobileView: false,\n  leafHeight: null,\n  leafWidth: null,\n  beforeExpand: null,\n  paging: false,\n  renderSubLevel: false,\n  layout: 'horizontal', // stacked, horizontal, paging, mobile-only\n  rootClass: 'hierarchy',\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' }\n};\n\nfunction Hierarchy(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, HIERARCHY_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Hierarchy Methods\nHierarchy.prototype = {\n  init() {\n    const s = this.settings;\n    this.settings.rootClass = 'hierarchy';\n\n    s.colorClass = [\n      'azure08', 'turquoise02', 'amethyst06', 'slate06', 'amber06', 'emerald07', 'ruby06'\n    ];\n\n    // Setup events\n    this.handleEvents();\n\n    // Warn about deprecated settings\n    if (s.paging) {\n      console.warn(`\n      Hierarchy,\n      WARNING: Paging setting will be deprecated.\n      Date of Message: 02/12/2019\n      Date of deprecation: 05/15/2019.\n      `);\n    }\n\n    if (s.mobileView) {\n      console.warn(`\n      Hierarchy,\n      WARNING: MobileView setting will be deprecated.\n      Date of Message: 02/12/2019\n      Date of deprecation: 05/15/2019.\n      `);\n    }\n\n    // Safety check, check for data\n    if (s.dataset === undefined || s.dataset.length === 0 || !Array.isArray(s.dataset)) {\n      this.element.emptymessage(s.emptyMessage);\n      return;\n    }\n\n    if ((s.dataset[0] && s.dataset[0].children) &&\n      s.dataset[0].children.length > 0 || this.isStackedLayout()) {\n      this.render(s.dataset[0]);\n    } else if (s.dataset && s.dataset.children.length > 0) {\n      this.render(s.dataset);\n    }\n\n    if (s.leafHeight !== null && s.leafWidth !== null) {\n      const style = `'body .hierarchy .leaf,body .hierarchy .sublevel .leaf,body .hierarchy .container .root.leaf { width: ${s.leafWidth}px;  height: ${s.leafHeight}px;  }'`;\n\n      $(`<style type=\"text/css\" id=\"hierarchyLeafStyles\">${style}</style>`).appendTo('body');\n    }\n\n    if (s.layout) {\n      this.setLayout(s.layout);\n    }\n  },\n\n  /**\n   * Setup the hierarchy layout.\n   * @private\n   * @param {string} layout The layout to display\n   * @returns {void}\n   */\n  setLayout(layout) {\n    if (this.settings.paging) {\n      layout = 'paging';\n    }\n\n    if (this.settings.mobileView) {\n      layout = 'mobile-only';\n    }\n\n    switch (layout) {\n      case 'horizontal':\n        this.element.addClass('layout-is-horizontal');\n        break;\n      case 'stacked':\n        this.element.addClass('layout-is-stacked');\n        break;\n      case 'paging':\n        this.element.addClass('layout-is-paging');\n        break;\n      case 'mobile-only':\n        this.element.addClass('layout-is-mobile-only');\n        break;\n      default:\n        this.element.addClass('layout-is-horizontal');\n    }\n  },\n\n  /**\n   * Attach all event handlers\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const s = this.settings;\n\n    // Expand or Collapse\n    self.element.off('click.hierarchy').on('click.hierarchy', '.btn', function (e) {\n      // Stacked layout doesn't expand/collapse\n      if (self.isStackedLayout()) {\n        return;\n      }\n\n      if (s.newData.length > 0) {\n        s.newData = [];\n      }\n\n      const nodeId = $(this).closest('.leaf').attr('id');\n      const nodeData = $(`#${nodeId}`).data();\n      const domObject = {\n        branch: $(this).closest('li'),\n        leaf: $(this).closest('.leaf'),\n        button: $(this)\n      };\n\n      if (nodeData.isExpanded) {\n        self.collapse(e, nodeData, domObject);\n      } else {\n        self.expand(e, nodeData, domObject);\n      }\n    });\n\n    this.element.on('keypress', '.leaf', function (e) {\n      const nodeId = $(this).attr('id');\n      const nodeData = $(`#${nodeId}`);\n\n      if (e.which === 13) {\n        if (nodeData.isExpanded) {\n          self.collapse(e, nodeData);\n        } else {\n          self.expand(e, nodeData);\n        }\n      }\n    });\n\n    self.element.off('dblclick.hierarchy').on('dblclick.hierarchy', '.leaf', (e) => {\n      const nodeId = e.currentTarget.id;\n      const nodeData = $(`#${nodeId}`).data();\n      const dblClickEvent = { event: e, data: nodeData };\n      e.stopImmediatePropagation();\n\n      this.element.trigger('dblclick', dblClickEvent);\n    });\n\n    /**\n     * Fires when node is selected\n     * @event selected\n     * @memberof Hierarchy\n     * @param {object} event - The jquery event object\n     * @param {object} eventInfo - More info to identify the node.\n     */\n    self.element.on('mouseup', '.leaf, .back button', function (e) {\n      const leaf = $(this);\n      const target = $(e.target);\n      const hierarchy = leaf.closest('.hierarchy').data('hierarchy');\n      const nodeData = leaf.data();\n      const nodeId = $(this).attr('id');\n      const targetInfo = { target: e.target, pageX: e.pageX, pageY: e.pageY };\n      const isButton = target.is('button');\n      const isNotBack = !target.hasClass('btn-back');\n      const isBack = target.is('.btn-back');\n      const svgHref = target.find('use').prop('href');\n      const isCollapseButton = svgHref ? svgHref.baseVal === '#icon-caret-up' : false;\n      const isExpandButton = svgHref ? svgHref.baseVal === '#icon-caret-down' : false;\n      const isForward = svgHref ? svgHref.baseVal === '#icon-caret-right' : false;\n      const isActions = target.hasClass('btn-actions');\n      const isAction = target.is('a') && target.parent().parent().is('ul.popupmenu');\n      const isAncestor = leaf.hasClass('ancestor');\n      let eventType = 'selected';\n\n      e.stopImmediatePropagation();\n\n      if (isAction && $(target).parent().data('disabled')) {\n        return;\n      }\n\n      $('.is-selected').removeClass('is-selected');\n      $(`#${nodeId}`).addClass('is-selected');\n\n      // Is collapse event\n      if (isButton && isCollapseButton && isNotBack) {\n        eventType = isAncestor ? 'back' : 'collapse';\n      }\n\n      // Is expand event\n      if (isButton && isExpandButton && isNotBack) {\n        eventType = 'expand';\n      }\n\n      if (isBack) {\n        eventType = 'back';\n      }\n\n      if (isActions) {\n        eventType = 'actions';\n        hierarchy.buildActionsMenu(nodeData, leaf);\n      }\n\n      if (isAction) {\n        eventType = 'action';\n      }\n\n      if (isButton && isForward && isNotBack) {\n        eventType = 'forward';\n      }\n\n      // Is right click event\n      if (e.which === 3) {\n        eventType = 'rightClick';\n      }\n\n      if (!hierarchy) {\n        return;\n      }\n\n      const eventInfo = {\n        id: nodeId,\n        data: nodeData,\n        actionReference: isAction ? target.data('actionReference') : null,\n        targetInfo,\n        eventType,\n        isForwardEvent: hierarchy.isForwardEvent(eventType),\n        isBackEvent: hierarchy.isBackEvent(eventType),\n        isAddEvent: hierarchy.isAddEvent(eventType),\n        isExpandEvent: hierarchy.isExpandEvent(eventType),\n        isCollapseEvent: hierarchy.isCollapseEvent(eventType),\n        isSelectedEvent: hierarchy.isSelectedEvent(eventType),\n        isActionsEvent: hierarchy.isActionsEvent(eventType),\n        isActionEvent: hierarchy.isActionEvent(eventType),\n        allowLazyLoad: hierarchy.allowLazyLoad(nodeData, eventType)\n      };\n\n      leaf.trigger('selected', eventInfo);\n    });\n  },\n\n  /**\n   * Manually set selection on a leaf\n   * @public\n   * @param {string} nodeId id used to find leaf\n   */\n  selectLeaf(nodeId) {\n    const leaf = $(`#${nodeId}`);\n    $('.is-selected').removeClass('is-selected');\n    leaf.addClass('is-selected');\n\n    const eventInfo = {\n      data: leaf.data(),\n      actionReference: null,\n      isForwardEvent: false,\n      isBackEvent: false,\n      isAddEvent: false,\n      isExpandEvent: false,\n      isCollapseEvent: false,\n      isSelectedEvent: true,\n      isActionsEvent: false,\n      isActionEvent: false,\n      allowLazyLoad: false\n    };\n\n    leaf.trigger('selected', eventInfo);\n  },\n\n  /**\n   * Update existing leaf actions with new actions\n   * @public\n   * @param {object} eventInfo eventType, target, data, ect..\n   * @param {array} updatedActions -actions to be appended to the menu\n   */\n  updateActions(eventInfo, updatedActions) {\n    const leaf = $(eventInfo.targetInfo.target).closest('.leaf');\n    const nodeData = eventInfo.data;\n    const popupMenu = $(leaf).find('.popupmenu');\n    const lineItemsToRemove = popupMenu.find('li').not(':eq(0)');\n\n    $(lineItemsToRemove).each((idx, item) => {\n      $(item).remove();\n    });\n\n    nodeData.menu.actions = updatedActions;\n    popupMenu.append(this.getActionMenuItems(nodeData));\n  },\n\n  /**\n   * @private\n   * @param {object} data associated with leaf\n   * @param {leaf} leaf jQuery reference in DOM\n   */\n  buildActionsMenu(data, leaf) {\n    const popupMenu = $(leaf).find('.popupmenu');\n    const template = [];\n\n    // Safety\n    if (data.menu === undefined) {\n      return;\n    }\n\n    // Reset & rebuild\n    popupMenu.empty();\n\n    if (data.menu.details) {\n      popupMenu.addClass('has-detail-fields');\n      template.push(`<li><div class=\"detail-fields\">${data.menu.details.map(v => `<div class=\"dt-fields-row\"><div class=\"dt-fields-cell\">${v.key}</div><div class=\"dt-fields-cell\">${v.value}</div></div>`).join('')}</div></li>`);\n    }\n\n    if (data.menu.actions) {\n      template.push(this.getActionMenuItems(data));\n    }\n\n    template.forEach((i) => { popupMenu.append(i); });\n  },\n\n  /**\n   * @private\n   * @param {object} data the data to be iterated\n   * @returns {string} returns list items as a string\n   */\n  getActionMenuItems(data) {\n    const actions = data.menu.actions.map((a) => {\n      if (a.disabled === undefined) {\n        a.disabled = false;\n      }\n\n      return a;\n    });\n\n    // Ignoring next line. Eslint expects template literals vs string concat.\n    // However template literals break JSON.stringify() in this case\n    /* eslint-disable */\n    return `${actions.map(a => `\n      <li data-disabled='${a.disabled}' class='${a.menu ? 'submenu' : ''}'>\n        <a href='${a.url}' data-action-reference='` + JSON.stringify(a.data) + `'>\n          ${a.value}\n          ${a.menu ? '<svg class=\"arrow icon-dropdown icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-dropdown\"></use></svg>' : ''}\n        </a>\n        ${a.menu ? `<div class=\"wrapper\" role=\"application\" aria-hidden=\"true\">\n          <ul class=\"popupmenu\">\n            ${a.menu.map(i => `\n            <li data-disabled='${a.disabled}'>\n              <a href='${a.url}' data-action-reference='` + JSON.stringify(a.data) + `'>${i.value}</a>\n            </li>`).join('')}\n          </ul>\n        </div>` : ''}\n      </li>`).join('')}`;\n    /* eslint-enable */\n  },\n\n  /**\n   * Check if event is back\n   * @private\n   * @param {string} eventType is back\n   * @returns {boolean} true if back event\n   */\n  isBackEvent(eventType) {\n    return eventType === 'back';\n  },\n\n  /**\n   * Check if event is forward\n   * @private\n   * @param {string} eventType is forward\n   * @returns {boolean} true if forward event\n   */\n  isForwardEvent(eventType) {\n    return eventType === 'forward';\n  },\n\n  /**\n   * Check if event is add\n   * @private\n   * @param {string} eventType is add\n   * @returns {boolean} true if add event\n   */\n  isAddEvent(eventType) {\n    return eventType === 'add';\n  },\n\n  /**\n   * Check if event is expand\n   * @private\n   * @param {string} eventType is expand\n   * @returns {boolean} true if expand event\n   */\n  isExpandEvent(eventType) {\n    return eventType === 'expand';\n  },\n\n  /**\n   * Check if event is collapse\n   * @private\n   * @param {string} eventType is collapse\n   * @returns {boolean} true if collapse event\n   */\n  isCollapseEvent(eventType) {\n    return eventType === 'collapse';\n  },\n\n  /**\n   * Check if event is selected\n   * @private\n   * @param {string} eventType is selected\n   * @returns {boolean} true if selected event\n   */\n  isSelectedEvent(eventType) {\n    return eventType === 'selected';\n  },\n\n  /**\n   * Checks if is actions event\n   * @private\n   * @param {string} eventType is actions\n   * @returns {boolean} true if actions event\n   */\n  isActionsEvent(eventType) {\n    return eventType === 'actions';\n  },\n\n  /**\n   * @private\n   * @param {string} evenType is action\n   * @returns {boolean} true if action\n   */\n  isActionEvent(evenType) {\n    return evenType === 'action';\n  },\n\n  /**\n   * Check to see if lazy load is allowed\n   * @private\n   * @param {object} data contains info\n   * @param {string} eventType is expand\n   * @returns {boolean} true if lazy load is allowed\n   */\n  allowLazyLoad(data, eventType) {\n    if (data === undefined || eventType === undefined) {\n      return false;\n    }\n    return !data.isLoaded && !data.isLeaf && eventType === 'expand';\n  },\n\n  /**\n   * Process data attached through jquery data\n   * @private\n   * @param {string} nodeId .\n   * @param {string} currentDataObject .\n   * @param {string} newDataObject .\n   * @param {string} params .\n   * @returns {object} data\n   */\n  data(nodeId, currentDataObject, newDataObject, params) {\n    /* eslint-disable no-use-before-define */\n    if (params === undefined) {\n      params = {};\n    }\n\n    const s = this.settings;\n    const obj = currentDataObject.isRootNode ? currentDataObject : currentDataObject[0];\n    const nodeData = [];\n\n    if (s.newData.length > 0) {\n      s.newData = [];\n    }\n\n    function addChildrenToObject(thisObj, thisParams) {\n      if (thisParams.insert) {\n        delete thisObj.isLeaf;\n        thisObj.isExpanded = true;\n      }\n      if (newDataObject.length !== 0 && thisParams.insert) {\n        thisObj.children = [newDataObject];\n      } else {\n        thisObj.children = newDataObject;\n      }\n    }\n\n    function checkForChildren(self, thisObj, thisNewDataObject) {\n      Object.keys(thisObj).forEach((prop) => {\n        if (prop === 'id' && nodeId === thisObj.id) {\n          if (!thisObj.isLoaded && !thisObj.isRootNode) {\n            addChildrenToObject(thisObj, params);\n          }\n          nodeData.push(thisObj);\n        }\n      });\n      if (thisObj.children) {\n        processData(self, thisObj.children, thisNewDataObject); // eslint-disable-line\n      }\n    }\n\n    function processData(self, thisObj, thisNewDataObject) {\n      if (thisObj.length === undefined) {\n        checkForChildren(self, thisObj, thisNewDataObject);\n      } else {\n        for (let i = 0, l = thisObj.length; i < l; i++) {\n          checkForChildren(self, thisObj[i], thisNewDataObject);\n        }\n      }\n    }\n\n    if (newDataObject !== undefined) {\n      processData(this, obj, newDataObject);\n    }\n\n    if (nodeData.length !== 0) {\n      $(`#${nodeData[0].id}`).data(nodeData[0]);\n    }\n\n    return nodeData[0];\n    /* eslint-enable no-use-before-define */\n  },\n\n  /**\n   * Add data as children for the given nodeId.\n   * @private\n   * @param {string} nodeId .\n   * @param {object} currentDataObject info\n   * @param {object} newDataObject .\n   * @returns {void}\n   */\n  add(nodeId, currentDataObject, newDataObject) {\n    const s = this.settings;\n    const id = currentDataObject.id !== undefined ? currentDataObject.id : nodeId;\n    const node = $(`#${id}`);\n    const parentContainer = node.parent().hasClass('leaf-container') ? node.parent().parent() : node.parent();\n    const selectorObject = {};\n    const isSubLevelChild = parentContainer.parent().attr('class') !== 'sub-level';\n    const subListExists = parentContainer.children('.sublist').length === 1;\n\n    if (isSubLevelChild) {\n      if (subListExists) {\n        selectorObject.element = parentContainer.children('.sublist');\n      } else {\n        selectorObject.el = parentContainer.append('<ul class=\\'sublist\\'></ul>');\n        selectorObject.element = $(selectorObject.el).find('.sublist');\n      }\n    } else {\n      selectorObject.el = parentContainer.children('ul');\n      selectorObject.element = $(selectorObject.el);\n    }\n\n    if (selectorObject.element.length === 0) {\n      selectorObject.el = parentContainer.append('<ul></ul>');\n      selectorObject.element = $(selectorObject.el).find('ul');\n    }\n\n    if (!currentDataObject.isRootNode) {\n      for (let i = 0, l = newDataObject.length; i < l; i++) {\n        s.newData.push(newDataObject[i]);\n      }\n      this.createLeaf(newDataObject, selectorObject.element);\n    }\n\n    this.updateState(node, false, null, 'add');\n  },\n\n  /**\n   * Closes popupmenu\n   * @private\n   * @param {object} node leaf containing btn-actions\n   */\n  closePopupMenu(node) {\n    const actionButton = node.find('.btn-actions');\n\n    if (actionButton.length !== 0) {\n      actionButton.data('popupmenu').close();\n    }\n  },\n\n  /**\n   * Expand the nodes until nodeId is displayed on the page.\n   * @private\n   * @param {object} event .\n   * @param {object} nodeData info\n   * @param {object} domObject .\n   * @returns {void}\n   */\n  expand(event, nodeData, domObject) {\n    const s = this.settings;\n    const node = domObject.leaf;\n    let nodeTopLevel = node.next();\n\n    // close popupmenu if open\n    this.closePopupMenu(node);\n\n    nodeTopLevel.animateOpen();\n    /**\n     * Fires when leaf expanded.\n     *\n     * @event expanded\n     * @memberof Hierarchy\n     * @type {object}\n     * @param {object} event - The jquery event object\n     * @param {array} args [nodeData, dataset]\n     */\n    this.element.trigger('expanded', [nodeData, s.dataset]);\n\n    if (node.hasClass('root')) {\n      nodeTopLevel = nodeTopLevel.next('ul');\n      nodeTopLevel.animateOpen();\n    }\n\n    node.parent().removeClass('branch-collapsed').addClass('branch-expanded');\n    this.updateState(node, false, null, 'expand');\n  },\n\n  /**\n   * Collapse the passed in nodeId.\n   * @private\n   * @param {object} event .\n   * @param {object} nodeData info\n   * @param {object} domObject .\n   * @returns {void}\n   */\n  collapse(event, nodeData, domObject) {\n    const s = this.settings;\n    const node = domObject.leaf;\n    let nodeTopLevel = node.next();\n\n    // close popupmenu if open\n    this.closePopupMenu(node);\n\n    nodeTopLevel.animateClosed().on('animateclosedcomplete', () => {\n      /**\n       * Fires when leaf collapsed.\n       *\n       * @event collapsed\n       * @memberof Hierarchy\n       * @type {object}\n       * @param {object} event - The jquery event object\n       * @param {array} args [nodeData, dataset]\n       */\n      this.element.trigger('collapsed', [nodeData, s.dataset]);\n    });\n\n    if (node.hasClass('root')) {\n      nodeTopLevel = nodeTopLevel.next('ul');\n      nodeTopLevel.animateClosed();\n    }\n\n    node.parent().removeClass('branch-expanded').addClass('branch-collapsed');\n    this.updateState(node, false, null, 'collapse');\n  },\n\n  /**\n   * Main render method\n   * @private\n   * @param {object} data info.\n   * @returns {void}\n   */\n  render(data) {\n    /* eslint-disable no-use-before-define */\n    const s = this.settings;\n    const thisLegend = s.legend;\n    const thisChildren = data.children;\n    const rootNodeHTML = [];\n    const structure = {\n      legend: '<legend><ul></ul></legend>',\n      chart: '<ul class=\"container\"><li class=\"chart\"></li></ul>',\n      toplevel: s.paging ? '<ul class=\"child-nodes\"></ul>' : '<ul class=\"top-level\"></ul>',\n      sublevel: s.paging ? '' : '<ul class=\"sub-level\"></ul>'\n    };\n\n    const chartContainer = this.element.append(structure.chart);\n    const chart = $('.chart', chartContainer);\n\n    if (thisLegend.length !== 0) {\n      this.element.prepend(structure.legend);\n      const element = $('legend', chartContainer);\n      this.createLegend(element);\n    }\n\n    // check to see how many children are not leafs and have children\n    if (this.isSingleChildWithChildren()) {\n      $(chart).addClass('has-single-child');\n    }\n\n    // Create root node\n    this.setColor(data);\n\n    if (s.paging && data.parentDataSet) {\n      const backMarkup = '' +\n        '<div class=\"back\">' +\n        '<button type=\"button\" class=\"btn-icon hide-focus btn-back\">' +\n        '<svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">' +\n        '<use xlink:href=\"#icon-caret-left\"></use>' +\n        '</svg>' +\n        '<span>Back</span>' +\n        '</button>' +\n        '</div>';\n\n      // Append back button to chart to go back to view previous level\n      const backButton = $(backMarkup).appendTo(chart);\n\n      // Wrap back button and leaf after leaf has been rendered\n      setTimeout(() => backButton.next($('.leaf')).addBack($('.back')).wrapAll('<div class=\"back-container\"></div>'));\n\n      // Attach data reference to back button\n      backButton.children('button').data(data);\n\n      // Class used to adjust heights and account for back button\n      $(chart).addClass('has-back');\n    }\n\n    if (data.isMultiRoot) {\n      let multiRootHTML = `<div class=\"leaf multiRoot\"><div><h2>${data.multiRootText}</h2></div></div>`;\n      multiRootHTML = xssUtils.sanitizeHTML(multiRootHTML);\n      rootNodeHTML.push(multiRootHTML);\n      $(rootNodeHTML[0]).addClass('root').appendTo(chart);\n    } else if (data.ancestorPath !== null && data.ancestorPath !== undefined) {\n      data.ancestorPath.push(data.centeredNode);\n      let ancestorHTML = `${data.ancestorPath.map(a => ` ${this.getTemplate(a)} `).join('')}`;\n      ancestorHTML = xssUtils.sanitizeHTML(ancestorHTML);\n      rootNodeHTML.push(ancestorHTML);\n      $(rootNodeHTML[0]).addClass('root ancestor').appendTo(chart);\n\n      const roots = $('.leaf.root');\n\n      roots.each((index, root) => {\n        this.updateState(root, false, data.ancestorPath[index], 'add');\n\n        if (index === roots.length - 1) {\n          $(root).addClass('is-selected');\n        }\n      });\n    } else {\n      const centeredNode = data.centeredNode;\n      let leaf;\n\n      if (this.isStackedLayout() && centeredNode !== null) {\n        leaf = this.getTemplate(centeredNode);\n      } else if (!this.isStackedLayout()) {\n        leaf = this.getTemplate(data);\n      }\n\n      if (leaf) {\n        leaf = xssUtils.sanitizeHTML(leaf);\n        rootNodeHTML.push(leaf);\n        $(rootNodeHTML[0]).addClass('root is-selected').appendTo(chart);\n      }\n\n      if (centeredNode && centeredNode !== null) {\n        this.updateState($('.leaf.root'), true, centeredNode, undefined);\n      } else {\n        this.updateState($('.leaf.root'), true, data, undefined);\n      }\n    }\n\n    function renderSubChildren(self, subArray, thisData) {\n      if (subArray !== null && subArray !== undefined) {\n        for (let i = 0, l = subArray.length; i < l; i++) {\n          const obj = subArray[i];\n          subArrayChildren(self, obj, thisData);  // eslint-disable-line\n        }\n      }\n    }\n\n    // Create children nodes\n    if (thisChildren && thisChildren.length > 0) {\n      for (let i = 0, l = thisChildren.length; i < l; i++) {\n        const childObject = data.children[i].children;\n\n        // If child has no children then render the element in the top level\n        // If paging then render all children in the top level\n        // If not paging and child has children then render in the sub level\n        if (this.isLeaf(thisChildren[i]) && !s.paging && s.renderSubLevel) {\n          this.createLeaf(data.children[i], $(structure.toplevel));\n        } else if (s.paging) {\n          this.createLeaf(data.children[i], $(structure.toplevel));\n        } else {\n          this.createLeaf(data.children[i], $(structure.sublevel));\n        }\n\n        if (childObject !== undefined && childObject !== null) {\n          const subArray = data.children[i].children;\n          const self = this;\n          renderSubChildren(self, subArray, data);\n        }\n      }\n    }\n\n    function subArrayChildren(self, obj, thisData) {\n      Object.keys(obj).forEach((prop) => {\n        if (prop === 'children') {\n          const nodeId = obj.id;\n          const currentDataObject = obj;\n          const newDataObject = obj.children;\n\n          if (newDataObject !== null && newDataObject !== undefined) {\n            if (newDataObject.length > 0) {\n              self.add(nodeId, currentDataObject, newDataObject);\n            }\n          }\n          return renderSubChildren(self, newDataObject, thisData);\n        }\n        return true;\n      });\n    }\n\n    const containerWidth = this.element.find('.container').outerWidth();\n    const windowWidth = $(window).width();\n    const center = (containerWidth - windowWidth) / 2;\n    this.element.scrollLeft(center);\n\n    // Add a no-sublevel class if only two levels (to remove extra border)\n    const topLevel = this.element.find('.top-level');\n    if (this.element.find('.sub-level').length === 0 && topLevel.length === 1) {\n      topLevel.addClass('no-sublevel');\n    }\n\n    /* eslint-enable no-use-before-define */\n  },\n\n  /**\n   * @private\n   * @returns {boolean} true if stacked layout\n   */\n  isStackedLayout() {\n    return this.settings.layout && this.settings.layout === 'stacked';\n  },\n\n  /**\n   * Checks to see if children have children\n   * @private\n   * @returns {boolean} true if have children\n   */\n  isSingleChildWithChildren() {\n    if (this.isStackedLayout()) {\n      return false;\n    }\n\n    const s = this.settings;\n    if (s.dataset && (s.dataset[0] && s.dataset[0].children)) {\n      let i = s.dataset[0].children.length;\n      let count = 0;\n\n      while (i--) {\n        if (!s.dataset[0].children[i].isLeaf) {\n          count++;\n        }\n      }\n\n      return count === 1;\n    }\n    return false;\n  },\n\n  /**\n   * Builds leaf template\n   * @private\n   * @param {object} data leaf data\n   * @returns {string} compiled template as HTML string\n   */\n  getTemplate(data) {\n    const template = Tmpl.compile(`{{#dataset}}${$(`#${xssUtils.stripTags(this.settings.templateId)}`).html()}{{/dataset}}`, { dataset: data });\n\n    // Init popupmenu after rendered in DOM\n    setTimeout(() => {\n      const actionButton = $(`#btn-${xssUtils.stripTags(data.id)}`);\n      if (actionButton.length !== 0) {\n        actionButton.hideFocus().popupmenu();\n      }\n    }, 1);\n\n    return $(template).prop('outerHTML');\n  },\n\n  /**\n   * Add the legend from the Settings\n   * @private\n   * @param {object} element .\n   * @returns {void}\n   */\n  createLegend(element) {\n    const s = this.settings;\n    const mod = 4;\n    let index = 0;\n\n    for (let i = 0, l = s.legend.length; i < l; i++) {\n      const thislabel = s.legend[i].label;\n      const color = s.colorClass[i];\n\n      if ((i - (1 % mod)) + 1 === mod) {\n        element.append('<ul></ul>');\n        index++;\n      }\n\n      element.children('ul').eq(index).append('' +\n        `<li>\n          <span>${thislabel}</span>\n          <span class=\"key ${color}\"></span>\n        </li>`);\n    }\n  },\n\n  /**\n   * Creates a leaf node under element for nodeData\n   * @private\n   * @param {object} nodeData contains info.\n   * @param {object} container .\n   * @returns {void}\n   */\n  createLeaf(nodeData, container) {\n    const self = this;\n    const chartClassName = self.settings.rootClass;\n    const chart = $(`.${chartClassName} .chart`, self.container);\n    const elClassName = container.attr('class');\n    const el = elClassName !== undefined ? $(`.${elClassName}`) : container;\n\n    if (el.length < 1) {\n      if (elClassName === 'top-level') {\n        container.insertAfter('.root');\n      } else {\n        container.appendTo(chart);\n      }\n    }\n\n    function processDataForLeaf(thisNodeData) {\n      self.setColor(thisNodeData);\n\n      const leaf = self.getTemplate(thisNodeData);\n      let parent = el.length === 1 ? el : container;\n      let branchState = thisNodeData.isExpanded || thisNodeData.isExpanded === undefined ? 'branch-expanded' : 'branch-collapsed';\n\n      if (thisNodeData.isLeaf) {\n        branchState = '';\n      }\n\n      if ($(`#${thisNodeData.id}`).length === 1) {\n        return;\n      }\n\n      parent.append(`<li class=${branchState}>${$(leaf)[0].outerHTML}</li>`);\n\n      if (thisNodeData.children) {\n        let childrenNodes = '';\n\n        for (let j = 0, l = thisNodeData.children.length; j < l; j++) {\n          self.setColor(thisNodeData.children[j]);\n          const childLeaf = self.getTemplate(thisNodeData.children[j]);\n\n          if (j === thisNodeData.children.length - 1) {\n            childrenNodes += `<li>${$(childLeaf)[0].outerHTML}</li>`;\n          } else {\n            childrenNodes += `<li>${$(childLeaf)[0].outerHTML}</li>`;\n          }\n        }\n\n        parent = $(`#${xssUtils.stripTags(thisNodeData.id)}`).parent();\n        parent.append(`<ul>${childrenNodes}</ul>`);\n\n        let childLength = thisNodeData.children.length;\n        while (childLength--) {\n          const lf = $(`#${xssUtils.stripTags(thisNodeData.children[childLength].id)}`);\n          self.updateState(lf, false, thisNodeData.children[childLength], undefined);\n        }\n      }\n    }\n\n    if (nodeData.length) {\n      for (let i = 0, l = nodeData.length; i < l; i++) {\n        const isLast = (i === (nodeData.length - 1));\n        processDataForLeaf(nodeData[i], isLast);\n        self.updateState($(`#${xssUtils.stripTags(nodeData[i].id)}`), false, nodeData[i], undefined);\n      }\n    } else {\n      processDataForLeaf(nodeData, true);\n      self.updateState($(`#${xssUtils.stripTags(nodeData.id)}`), false, nodeData, undefined);\n    }\n  },\n\n  /**\n   * Set leaf colors matching data to key in legend\n   * @private\n   * @param {object} data contains info.\n   * @returns {void}\n   */\n  setColor(data) {\n    const s = this.settings;\n    this.setRootColor(data);\n\n    if (this.isStackedLayout()) {\n      if (data.ancestorPath && data.ancestorPath !== null) {\n        data.ancestorPath.forEach((d) => {\n          this.setRootColor(d);\n        });\n      }\n\n      if (data.centeredNode && data.centeredNode !== null) {\n        this.setRootColor(data.centeredNode);\n      }\n    }\n\n    if (data.children && !data.isRootNode) {\n      for (let k = 0, ln = data.children.length; k < ln; k++) {\n        for (let j = 0, x = s.legend.length; j < x; j++) {\n          if (data.children[k][s.legendKey] === s.legend[j].value) {\n            data.children[k].colorClass = s.colorClass[j];\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * Set the color of the root element.\n   * @private\n   * @param {object} data  The data object to use.\n   */\n  setRootColor(data) {\n    const s = this.settings;\n    for (let i = 0, l = s.legend.length; i < l; i++) {\n      if (data[s.legendKey] === s.legend[i].value) {\n        data.colorClass = s.colorClass[i];\n        break;\n      } else if (data[s.legendKey] === '') {\n        data.colorClass = 'default-color';\n      }\n    }\n  },\n\n  /**\n   * Check to see if particular node is a leaf\n   * @private\n   * @param {object} dataNode contains data info\n   * @returns {boolean} whether or not a particular node is a leaf\n   */\n  isLeaf(dataNode) {\n    const s = this.settings;\n    if (dataNode.isLeaf) {\n      return dataNode.isLeaf;\n    }\n\n    if (s.beforeExpand) {\n      return dataNode.isLeaf;\n    }\n\n    // Node is not a leaf and should display and expand/collapse icon\n    if ((dataNode.children && dataNode.children.length > 0)) {\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * Handle all leaf state here,\n   * get the current state via .data() and re-attach the new state\n   * @private\n   * @param {string} leaf .\n   * @param {boolean} isRoot .\n   * @param {object} nodeData .\n   * @param {string} eventType .\n   * @returns {void}\n   */\n  updateState(leaf, isRoot, nodeData, eventType) {\n    // set data if it has not been set already\n    if ($.isEmptyObject($(leaf).data()) && nodeData) {\n      const d = nodeData === undefined ? {} : nodeData;\n      $(leaf).data(d);\n    }\n\n    const s = this.settings;\n    const btn = $(leaf).find('.btn');\n    const expandCaret = s.paging ? 'caret-right' : 'caret-up';\n    let data = $(leaf).data();\n\n    if (data === undefined && nodeData !== undefined) {\n      data = nodeData;\n    }\n\n    // data has been loaded if it has children\n    if ((data.children && data.children.length !== 0) || eventType === 'add') {\n      data.isExpanded = true;\n      data.isLoaded = true;\n    }\n\n    if (isRoot) {\n      data.isRootNode = true;\n      data.isLoaded = true;\n    }\n\n    if ((data.isExpanded === undefined && data.children) || eventType === 'expand') {\n      data.isExpanded = true;\n    }\n\n    // defaults to collapsed state\n    if (data.isExpanded === undefined || eventType === 'collapse') {\n      data.isExpanded = false;\n    }\n\n    if (data.isExpanded) {\n      btn.find('svg.icon').changeIcon(expandCaret);\n      btn.addClass('btn-expand').removeClass('btn-collapse');\n    } else {\n      btn.find('svg.icon').changeIcon('caret-down');\n      btn.addClass('btn-collapse').removeClass('btn-expand');\n    }\n\n    if (data.isLeaf || data.isRootNode) {\n      btn.addClass('btn-hidden');\n    }\n\n    if (data.isLeaf) {\n      data.isLoaded = false;\n      data.isExpanded = false;\n    }\n\n    // Keep reference of the parent dataset for paging\n    if (this.settings.layout === 'paging' || this.settings.paging) {\n      data.parentDataSet = s.dataset;\n    }\n\n    // Reset data\n    $(leaf).data(data);\n  },\n\n  /**\n   * Reloads hierarchy control with new dataset\n   * @private\n   * @param {object} options hierarchy\n   * @returns {void}\n   */\n  reload(options) {\n    this.destroy();\n    this.element.hierarchy(options);\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {void}\n   */\n  unbind() {\n    this.element.empty();\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, HIERARCHY_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Removes the component from existence\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    this.element.removeData(COMPONENT_NAME);\n  }\n\n};\n\nexport { Hierarchy, COMPONENT_NAME };\n","import { Hierarchy, COMPONENT_NAME } from './hierarchy';\n\n/**\n * jQuery Component Wrapper for Hierarchy\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.hierarchy = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Hierarchy(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { stringUtils as str } from '../../utils/string';\nimport { Tmpl } from '../tmpl/tmpl';\nimport { Locale } from '../locale/locale';\n\n// jQuery components\nimport '../dropdown/dropdown.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'fieldfilter';\n\n/**\n * Ability to have a dropdown next to the field.\n *\n * @class FieldFilter\n * @constructor\n *\n * @param {jQuery[]|HTMLElement} element The component element.\n * @param {object} [settings] The component settings.\n * @param {array} [settings.dataset]  Array of data\n * @param {object} [settings.dropdownOpts]  Gets passed to this control's dropdown\n * @param {string} [settings.template] An Html String with the mustache template for the view.\n */\nconst FIELDFILTER_DEFAULTS = {\n  dataset: [],\n  dropdownOpts: {}, // Dropdown custom settings\n  template: '' +\n  `<label>${Locale.translate('FieldFilter')}</label>\n    <select class=\"dropdown no-init field-filter-dropdown\">\n      {{#dataset}}\n        <option\n          {{#value}} value=\"{{value}}\"{{/value}}\n          {{#selected}} selected{{/selected}}\n          {{#disabled}} class=\"is-disabled\" disabled{{/disabled}}\n          {{#icon}} data-icon=\"{{icon}}\"{{/icon}}\n        >{{text}}</option>\n      {{/dataset}}\n    </select>`\n};\nfunction FieldFilter(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, FIELDFILTER_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// FieldFilter Methods\nFieldFilter.prototype = {\n\n  init() {\n    this.render();\n    this.handleEvents();\n    this.setFiltered();\n  },\n\n  /**\n   * Render the template against the dataset.\n   * @private\n   * @param {array} dataset  The dataset to use\n   * @returns {void}\n   */\n  render(dataset) {\n    const s = this.settings;\n    dataset = dataset || s.dataset;\n    // Render \"mustache\" Template\n    if (typeof Tmpl === 'object' && dataset && s.template) {\n      // create a copy of an inlined template\n      if (s.template instanceof $) {\n        s.template = `${s.template.html()}`;\n      } else if (typeof s.template === 'string') {\n        // If a string doesn't contain HTML elments,\n        // assume it's an element ID string and attempt to select with jQuery\n        if (!str.containsHTML(s.template)) {\n          s.template = $(`#${s.template}`).html();\n        }\n      }\n\n      const renderedTmpl = Tmpl.compile(s.template, { dataset: !s.dropdownOpts.source ? dataset : [] });  // eslint-disable-line\n      const emptyTmpl = '' +\n        `<label for=\"ffdropdown-empty\" class=\"audible\">\n          ${Locale.translate('FieldFilter')}\n        </label>\n        <select id=\"ffdropdown-empty\" name=\"ffdropdown-empty\" class=\"dropdown no-init field-filter-dropdown\"></select>`;\n\n      if (dataset.length > 0) {\n        this.element.before(renderedTmpl);\n      } else if (dataset.length === 0) {\n        this.element.before(renderedTmpl || emptyTmpl);\n      }\n\n      // Set element id\n      let id = this.element.attr('id') || this.element.attr('name');\n      if (typeof id === 'undefined') {\n        id = utils.uniqueId(this.element, 'fieldfilter-');\n        this.element[0].setAttribute('id', id);\n      }\n      const ffId = `${id}-ff`;\n\n      // Set Field\n      this.field = this.element.closest('.field');\n\n      // RTL list x-position\n      const isRTL = Locale.isRTL();\n      s.dropdownOpts = s.dropdownOpts || {};\n      if (isRTL && typeof s.dropdownOpts === 'object') {\n        if (s.dropdownOpts.placementOpts) {\n          s.dropdownOpts.placementOpts.x = this.element.outerWidth();\n        } else {\n          s.dropdownOpts.placementOpts = { x: this.element.outerWidth() };\n        }\n      }\n\n      // Set Dropdown\n      s.dropdownOpts.cssClass = s.dropdownOpts.cssClass ? `${s.dropdownOpts.cssClass} ffdropdown` : 'ffdropdown';\n      s.dropdownOpts.noSearch = true;\n\n      // Find the field filter dropdown\n      this.ffdropdown = this.field.find('select.dropdown.field-filter-dropdown');\n      this.ffdropdown\n        .dropdown(s.dropdownOpts)\n        .prev('label')\n        .addClass('audible');\n\n      this.ffdropdown[0].setAttribute('id', ffId);\n      this.ffdropdown[0].setAttribute('name', ffId);\n      this.ffdropdown.prev('label')[0].setAttribute('for', ffId);\n\n      // Add css classes\n      this.field.addClass('fieldfilter-wrapper')\n        .find('div.dropdown.field-filter-dropdown span').addClass('audible');\n\n      // Dropdown api\n      this.ddApi = this.ffdropdown.data('dropdown');\n      if (this.ddApi && this.ddApi.icon) {\n        this.ddApi.icon.addClass('ffdropdown-icon');\n      }\n    }\n  },\n\n  /**\n   * Set currently filtered item\n   * @private\n   * @returns {object} The api\n   */\n  setFiltered() {\n    if (this.ddApi) {\n      const item = this.ddApi.element.find('option:selected');\n      this.filtered = this.getTriggerData(item);\n    }\n    return this;\n  },\n\n  /**\n   * Get currently triggerData for given item args\n   * @private\n   * @param {object} args selected item.\n   * @returns {object} The api\n   */\n  getTriggerData(args) {\n    const s = this.settings;\n    const dataset = s.dropdownOpts.source && this.ddApi ? this.ddApi.dataset : s.dataset;\n    return { idx: args.index(), item: args, data: dataset[args.index()] };\n  },\n\n  /**\n   * Get current filter type\n   * @returns {object} The current filter type\n   */\n  getFilterType() {\n    this.setFiltered();\n    return this.filtered;\n  },\n\n  /**\n   * Set filter type to given value\n   * @param {number|string} value to be set, index or value.\n   * @returns {void}\n   */\n  setFilterType(value) {\n    if (this.ddApi) {\n      let newIdx = -1;\n      const s = this.settings;\n      const dataset = s.dropdownOpts.source && this.ddApi ? this.ddApi.dataset : s.dataset;\n\n      if (typeof value === 'number' && value > -1 && value < dataset.length) {\n        newIdx = value;\n      } else if (typeof value === 'string') {\n        let option = this.ffdropdown.find(`option[value=\"${value}\"]`);\n        if (!option.length) {\n          option = this.ffdropdown.find('option').filter(function () {\n            return $(this).text() === value;\n          });\n        }\n        if (option.length) {\n          newIdx = option.index();\n        }\n      }\n\n      // Make filtered\n      if (newIdx !== -1 && newIdx !== this.ffdropdown[0].selectedIndex) {\n        this.ffdropdown[0].selectedIndex = newIdx;\n        this.ddApi.updated();\n        this.ffdropdown.triggerHandler('change');\n        this.setFiltered();\n        this.element.triggerHandler('filtered', [this.filtered]);\n      }\n    }\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {object} The api\n   */\n  handleEvents() {\n    this.ffdropdown\n      .on(`listopened.${COMPONENT_NAME}`, () => {\n        // drowpdownWidth - border (52)\n        $('#dropdown-list ul').width(this.element.outerWidth() + 52);\n      })\n      .on(`selected.${COMPONENT_NAME}`, (e, args) => {\n        /**\n         * Fires after the value in the dropdown is selected.\n         * @event filtered\n         * @memberof FieldFilter\n         * @property {object} event The jquery event object.\n         * @property {object} data for selected item.\n         */\n        const triggerData = this.getTriggerData(args);\n        this.element.triggerHandler('filtered', [triggerData]);\n      });\n\n    return this;\n  }, // END: Handle Events -------------------------------------------------\n\n  /**\n   * Set component to readonly.\n   * @returns {object} The api\n   */\n  readonly() {\n    this.ffdropdown.readonly();\n    return this;\n  },\n\n  /**\n   * Set component to enabled.\n   * @returns {object} The api\n   */\n  enable() {\n    this.ffdropdown.enable();\n    return this;\n  },\n\n  /**\n   * Set component to disabled.\n   * @returns {object} The api\n   */\n  disable() {\n    this.ffdropdown.disable();\n    return this;\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.ffdropdown.off(`.${COMPONENT_NAME}`);\n\n    // Remove Dropdown\n    if (this.ddApi && typeof this.ddApi.destroy === 'function') {\n      this.ddApi.destroy();\n    }\n    this.ffdropdown.add(this.ffdropdown.prev('label')).remove();\n\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element[0], settings, FIELDFILTER_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Teardown process for this plugin\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { FieldFilter, COMPONENT_NAME };\n","import { FieldFilter, COMPONENT_NAME } from './field-filter';\n\n/**\n * jQuery Component Wrapper for FieldFilter\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.fieldfilter = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new FieldFilter(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\n\n// Component Name\nconst COMPONENT_NAME = 'fieldoptions';\n\n/**\n* A control bind next to another component to add some extra functionality.\n* @class FieldOptions\n* @constructor\n*\n* @param {jQuery[]|HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n*/\nconst FIELDOPTIONS_DEFAULTS = {\n};\n\nfunction FieldOptions(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, FIELDOPTIONS_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// FieldOptions Methods\nFieldOptions.prototype = {\n\n  init() {\n    this.setElements();\n    this.handleEvents();\n  },\n\n  /**\n   * Set all elements used by the Control\n   * @private\n   * @returns {object} The api\n   */\n  setElements() {\n    this.isFirefox = env.browser.name === 'firefox';\n    this.isSafari = env.browser.name === 'safari';\n\n    this.field = this.element.closest('.field, .radio-group');\n    this.targetElem = this.element;\n\n    const label = this.field.find('label');\n    if (label) {\n      this.label = label;\n    }\n\n    // In some cases, adjust the target element\n    if (this.element[0].className.match(/(dropdown|multiselect)/)) {\n      this.targetElem = this.element.data('dropdown').pseudoElem;\n    }\n    if (this.element[0].className.match(/(fileupload)/)) {\n      this.targetElem = this.field.find('.fileupload[type=\"text\"]');\n    }\n\n    this.field.addClass('is-fieldoptions');\n\n    this.fieldParent = this.element.closest('.field').parent();\n    this.trigger = this.field.find('.btn-actions');\n\n    // Fix: Some reason firfox \"event.relatedTarget\" not working\n    // with un-focusable elements(ie.. div) on focusout, use \"contentEditable\"\n    // https://stackoverflow.com/a/43010274\n    if (this.isFirefox && this.trigger.length) {\n      this.trigger[0].contentEditable = true;\n      this.trigger.on(`keydown.${COMPONENT_NAME}`, (e) => {\n        const key = e.which || e.keyCode || e.charCode || 0;\n        if (key !== 9) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      });\n    }\n\n    // Adjust some setting for popupmenu this trigger(action button)\n    setTimeout(() => {\n      this.popupmenuApi = this.trigger.data('popupmenu');\n      if (this.popupmenuApi) {\n        this.popupmenuApi.settings.returnFocus = false;\n        this.popupmenuApi.settings.offset.y = 10;\n      }\n    }, 100);\n\n    return this;\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {object} The api\n   */\n  handleEvents() {\n    const self = this;\n    const datepicker = this.element.data('datepicker');\n    const timepicker = this.element.data('timepicker');\n    const dropdown = this.element.data('dropdown');\n    const lookup = this.element.data('lookup') || this.element.hasClass('lookup');\n    const isCheckbox = this.element.is('.checkbox');\n    const isFileupload = this.element.is('.fileupload');\n    const isSearchfield = this.element.is('.searchfield');\n    const isColorpicker = this.element.is('.colorpicker');\n    const isRadio = this.element.closest('.radio-group').length > 0;\n    const isFieldset = this.element.is('.data') && this.element.closest('.summary-form').length > 0;\n\n    // Helper functions\n    const isFocus = elem => $(':focus').is(elem);\n    const addFocused = (elem) => {\n      (elem || this.element).addClass('is-focused');\n    };\n    const removeFocused = (elem) => {\n      (elem || this.element).removeClass('is-focused');\n    };\n    const canActive = () => {\n      let r = isFocus(this.element);\n      r = datepicker && datepicker.isOpen() ? false : r;\n      r = timepicker && timepicker.isOpen() ? false : r;\n      r = dropdown && dropdown.isOpen() ? false : r;\n      return r;\n    };\n    const doActive = () => {\n      self.element.add(self.trigger).add(self.field).add(self.fieldParent)\n        .addClass('is-active');\n    };\n    const doUnactive = () => {\n      self.element.add(self.trigger).add(self.field).add(self.fieldParent)\n        .removeClass('is-active');\n    };\n    const canUnactive = (e) => {\n      let r = !isFocus(this.element);\n      r = this.trigger.is(e.relatedTarget) ? false : r;\n      r = this.trigger.is('.is-open') ? false : r;\n      r = datepicker && datepicker.isOpen() ? false : r;\n      r = timepicker && timepicker.isOpen() ? false : r;\n      r = $(e.relatedTarget).prev().is(this.element) ? false : r;\n      r = dropdown && dropdown.isOpen() ? false : r;\n      r = lookup && lookup.modal && lookup.modal.isOpen() ? false : r;\n      r = isColorpicker && this.element.is('.is-open') ? false : r;\n      return r;\n    };\n    const onPopupToggle = (elem) => {\n      if (elem.trigger) {\n        elem.trigger\n          .off(`show.${COMPONENT_NAME}`).on(`show.${COMPONENT_NAME}`, () => {\n            doActive();\n          })\n          .off(`hide.${COMPONENT_NAME}`).on(`hide.${COMPONENT_NAME}`, (e) => {\n            if (canUnactive(e)) {\n              doUnactive();\n              this.element.removeClass('is-open');\n            }\n          });\n      }\n    };\n    const getTriggerTopVal = () => {\n      const height = this.element.height();\n      let returns;\n\n      if (isFieldset) {\n        const lineHeight = parseInt(this.element.css('line-height'), 10);\n        if (height > lineHeight) {\n          this.element.css({ 'margin-bottom': '', 'padding-bottom': '' });\n          returns = ((height - lineHeight) / 2) * -1;\n        } else {\n          this.element.css({ 'margin-bottom': '8px', 'padding-bottom': '12px' });\n          returns = 6;\n        }\n      } else if (isRadio) {\n        returns = ((height - this.trigger.height()) / 2) * -1;\n      }\n      return returns;\n    };\n    const setTriggerCssTop = () => {\n      this.trigger.css({ top: `${getTriggerTopVal()}px` });\n    };\n\n    // Set field-options visibility.\n    // In touch environments, the button should always be visible.\n    // In desktop environments, the button should only display when the field is in use.\n    if (env.features.touch) {\n      this.field.addClass('visible');\n      this.trigger.on(`beforeopen.${COMPONENT_NAME}`, (e) => {\n        if (!canActive(e)) {\n          return;\n        }\n        doActive();\n      }).on(`close.${COMPONENT_NAME}`, (e) => {\n        if (!canUnactive(e)) {\n          return;\n        }\n        doUnactive();\n      });\n    } else {\n      this.field.removeClass('visible');\n      this.field\n        .on(`mouseover.${COMPONENT_NAME}`, () => {\n          if (self.element.prop('disabled') || self.element.closest('is-disabled').length) {\n            return;\n          }\n\n          if (self.field[0].className.indexOf('visible') < 0) {\n            self.field[0].classList.add('visible');\n          }\n        })\n        .on(`mouseout.${COMPONENT_NAME}`, () => {\n          if (self.field[0].className.indexOf('visible') > -1) {\n            self.field[0].classList.remove('visible');\n          }\n        });\n    }\n\n    // Adjust stack order for dropdown\n    if (dropdown) {\n      setTimeout(() => {\n        const popupmenu = this.trigger.data('popupmenu');\n        if (popupmenu) {\n          popupmenu.menu.closest('.popupmenu-wrapper').css({ 'z-index': '4502' });\n        }\n      }, 0);\n    }\n    // Bind active/unactive on show datepicker or timepicker\n    if (datepicker || timepicker) {\n      if (datepicker) {\n        onPopupToggle(datepicker);\n      } else {\n        onPopupToggle(timepicker);\n      }\n    }\n    // Adjust return focus for timepicker\n    if (timepicker) {\n      timepicker.settings.returnFocus = false;\n    }\n    // Move trigger(action-button) in to lookup-wrapper\n    if (lookup || isColorpicker) {\n      this.field.on(`click.${COMPONENT_NAME}`, '.lookup-wrapper .trigger, .colorpicker-container .trigger', () => {\n        doActive();\n      });\n\n      if (isColorpicker) {\n        this.element\n          .on(`beforeopen.${COMPONENT_NAME}`, () => {\n            doActive();\n          });\n      }\n    }\n    // Checkbox add parent css class\n    if (isCheckbox) {\n      this.trigger.addClass('is-checkbox');\n    }\n    // Bind fileupload events\n    if (isFileupload) {\n      this.element.on(`change.${COMPONENT_NAME}`, () => {\n        this.targetElem.focus();\n      });\n      this.field.on(`click.${COMPONENT_NAME}`, '.trigger, .trigger-close', () => {\n        doActive();\n      });\n    }\n    // Move trigger(action-button) in to searchfield-wrapper\n    if (isSearchfield) {\n      setTimeout(() => {\n        this.trigger.add(this.trigger.next('.popupmenu'))\n          .appendTo(this.element.closest('.searchfield-wrapper'));\n      }, 0);\n    }\n    // Fieldset - set trigger(action-button) top value and bind events\n    if (isFieldset) {\n      setTriggerCssTop();\n      this.targetElem.add(this.trigger).on(`keydown.${COMPONENT_NAME}`, (e) => {\n        const key = e.which || e.keyCode || e.charCode || 0;\n        if (key === 13) {\n          setTimeout(() => {\n            doActive();\n          }, 0);\n        }\n      });\n      this.targetElem.attr('tabindex', 0)\n        .on(`click.${COMPONENT_NAME}`, () => {\n          doActive();\n        });\n      $(document).on(`click.${COMPONENT_NAME}`, (e) => {\n        if (!$(e.target).is(this.element)) {\n          doUnactive();\n        }\n      });\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        setTriggerCssTop();\n      });\n    }\n    // Radio group - set trigger(action-button) top value and bind events\n    if (isRadio) {\n      setTriggerCssTop();\n      this.element\n        .on(`focusin.${COMPONENT_NAME}`, '.radio', () => {\n          const delay = this.isSafari ? 200 : 0;\n          addFocused();\n          setTimeout(() => {\n            doActive();\n          }, delay);\n        })\n        .on(`focusout.${COMPONENT_NAME}`, '.radio', () => {\n          removeFocused();\n        });\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        setTriggerCssTop();\n      });\n    }\n\n    // Element events\n    this.targetElem\n      .on(`focusin.${COMPONENT_NAME}`, () => {\n        doActive();\n        if (isRadio && this.isSafari) {\n          addFocused();\n        }\n      })\n      .on(`focusout.${COMPONENT_NAME}`, (e) => {\n        const delay = this.isSafari ? 200 : 0;\n        if (isRadio && this.isSafari) {\n          removeFocused();\n        }\n        setTimeout(() => {\n          if (canUnactive(e)) {\n            doUnactive();\n          }\n        }, delay);\n      });\n\n    // Trigger(action button) events\n    this.trigger\n      .on(`focusin.${COMPONENT_NAME} click.${COMPONENT_NAME}`, () => {\n        doActive();\n      })\n      .on(`focusout.${COMPONENT_NAME}`, (e) => {\n        if (canUnactive(e)) {\n          doUnactive();\n        }\n      })\n      .on(`selected.${COMPONENT_NAME}`, () => {\n        this.popupmenuApi.settings.returnFocus = true;\n      })\n      .on(`close.${COMPONENT_NAME}`, (e) => {\n        if (canUnactive(e)) {\n          doUnactive();\n        }\n      });\n\n    // FIX: Safari - by default does not get focus on some elements while using tab key\n    // https://stackoverflow.com/a/29106095\n    if (this.isSafari || isFileupload) {\n      if (isRadio) {\n        this.element.attr('tabindex', 0);\n      }\n      this.targetElem.on(`keydown.${COMPONENT_NAME}`, (e) => {\n        const key = e.which || e.keyCode || e.charCode || 0;\n        if (key === 9 && !e.shiftKey) {\n          if (isRadio) {\n            this.targetElem.find(':checked, .radio:first').not(':disabled').focus();\n            this.targetElem.find('.radio')\n              .off(`keydown.${COMPONENT_NAME}`).on(`keydown.${COMPONENT_NAME}`, (e2) => {\n                const key2 = e2.which || e2.keyCode || e2.charCode || 0;\n                if (key2 === 9 && !e.shiftKey) {\n                  setTimeout(() => {\n                    this.trigger.focus();\n                  }, 0);\n                }\n              });\n          } else {\n            this.trigger.focus();\n          }\n          doActive();\n          e.preventDefault();\n          e.stopPropagation();\n        }\n      });\n    }\n\n    this.element\n      .on(`listopened.${COMPONENT_NAME}`, () => {\n        doActive();\n      })\n      .on(`listclosed.${COMPONENT_NAME}`, () => {\n        doUnactive();\n      });\n\n    return this;\n  }, // END: Handle Events -------------------------------------------------\n\n  /**\n  * Set component to enabled.\n  * @returns {object} The api\n  */\n  enable() {\n    this.trigger.prop('disabled', false);\n    return this;\n  },\n\n  /**\n  * Set component to disabled.\n  * @returns {object} The api\n  */\n  disable() {\n    this.trigger.prop('disabled', true);\n    return this;\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.field.off([\n      `click.${COMPONENT_NAME}`,\n      `mouseover.${COMPONENT_NAME}`,\n      `mouseout.${COMPONENT_NAME}`\n    ].join(' '));\n\n    this.element.off([\n      `beforeopen.${COMPONENT_NAME}`,\n      `change.${COMPONENT_NAME}`,\n      `focusin.${COMPONENT_NAME}`,\n      `focusout.${COMPONENT_NAME}`,\n      `listclosed.${COMPONENT_NAME}`,\n      `listopened.${COMPONENT_NAME}`\n    ].join(' '));\n\n    this.trigger.off([\n      `beforeopen.${COMPONENT_NAME}`,\n      `click.${COMPONENT_NAME}`,\n      `focusin.${COMPONENT_NAME}`,\n      `focusout.${COMPONENT_NAME}`,\n      `selected.${COMPONENT_NAME}`,\n      `close.${COMPONENT_NAME}`\n    ].join(' '));\n\n    this.targetElem.off([\n      `click.${COMPONENT_NAME}`,\n      `keydown.${COMPONENT_NAME}`\n    ].join(' '));\n\n    $('body').off([\n      `resize.${COMPONENT_NAME}`\n    ].join(' '));\n\n    $(document).off([\n      `click.${COMPONENT_NAME}`\n    ].join(' '));\n\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, FIELDOPTIONS_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n  * Teardown process for this plugin\n  * @returns {void}\n  */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { FieldOptions, COMPONENT_NAME };\n","import { FieldOptions, COMPONENT_NAME } from './field-options';\n\n/**\n * jQuery Component Wrapper for FieldOptions\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.fieldoptions = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new FieldOptions(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Component Name\nconst COMPONENT_NAME = 'fileupload';\n\n/**\n* A list of items with add/remove/delete and sort functionality.\n* @class FileUpload\n* @constructor\n*\n* @param {jQuery[]|HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n*/\n\nconst FILEUPLOAD_DEFAULTS = {\n};\n\nfunction FileUpload(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, FILEUPLOAD_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// FileUpload Methods\nFileUpload.prototype = {\n\n  init() {\n    this.build();\n  },\n\n  // Example Method\n  build() {\n    const self = this;\n    const elem = this.element;\n    const hasInlineLabel = !elem.is('input.fileupload');\n\n    this.fileInput = hasInlineLabel ? elem.find('input') : elem;\n\n    elem.closest('.field').addClass('field-fileupload');\n\n    // append markup\n    let id = elem.find('input').attr('name');\n    if (!hasInlineLabel) {\n      id = elem.attr('id') || elem.attr('name');\n    }\n\n    let elemClass = !hasInlineLabel ? elem.attr('class') : elem.find('input').attr('class');\n    elemClass = elemClass ? ` ${elemClass}` : '';\n\n    const instructions = Locale.translate('FileUpload');\n    let label = $(`<label for=\"${id}-filename\">${elem.text()} <span class=\"audible\">${instructions}</span></label>`);\n    const shadowField = $(`<input readonly id=\"${id}-filename\" class=\"fileupload-background-transparent${elemClass}\" type=\"text\">`);\n    const svg = `<span class=\"trigger\" tabindex=\"-1\">${$.createIcon('folder')}</span>`;\n    const svgClose = `<span class=\"trigger-close\" tabindex=\"-1\">${$.createIcon('close')}</span>`;\n\n    if (!hasInlineLabel) {\n      let orgLabel = elem.prev('label');\n\n      // Could be wrapped (angular)\n      if (orgLabel.length === 0) {\n        orgLabel = elem.parent().prev('label');\n      }\n\n      label = $(`<label for=\"${(elem.attr('id') || elem.attr('name'))}-filename\">${orgLabel.text()}</label>`);\n      elem.before(label, shadowField);\n      this.fileInput.after(svgClose);\n      this.fileInput.after(svg);\n      orgLabel.addClass('audible').append(`<span class=\"audible\">${instructions}</span>`);\n    } else {\n      elem.before(label, shadowField);\n      this.fileInput.after(svgClose);\n      this.fileInput.after(svg);\n    }\n\n    // if there is a value attribute, then this will be used as the current value since unable to set files[0].name\n    // move it to the text input and remove it off the file input\n    const fileInputValue = this.fileInput.attr('value');\n    if (fileInputValue && fileInputValue.length > 0) {\n      shadowField.val(fileInputValue);\n      this.fileInput.attr('value', '');\n    }\n\n    this.textInput = shadowField;\n    this.svg = elem.parent().find('.trigger');\n    this.svgClose = elem.parent().find('.trigger-close');\n\n    /*\n    * Added Keydown for Keyboard Backspace and remove Keypress because it doesn't detect Backspace\n    */\n    this.textInput.on('keydown.fileupload', (e) => {\n      let handle = false;\n      if (e.which === 13 || e.which === 32) {\n        elem.parent().find('[type=\"file\"]').trigger('click');\n        handle = true;\n      } else if (e.which === 8) {\n        this.clearUploadFile();\n        handle = true;\n      }\n      if (handle) {\n        e.stopPropagation();\n      }\n    });\n\n    this.svg.on('click.fileupload', (e) => {\n      this.fileInput.trigger('click');\n      if (hasInlineLabel) {\n        this.fileInput.data(`handleEvent${[(e.type || '')]}`, e.handleObj);\n      }\n    });\n\n    this.svgClose.on('click.fileupload', (e) => {\n      this.clearUploadFile();\n      if (hasInlineLabel) {\n        this.fileInput.data(`handleEvent +${[(e.type || '')]}`, e.handleObj);\n      }\n    });\n\n    if (this.fileInput.is(':disabled')) {\n      this.textInput.prop('disabled', true);\n    }\n\n    if (elem.hasClass('required')) {\n      label.addClass('required');\n      elem.removeClass('required');\n    }\n\n    if (this.fileInput.attr('data-validate')) {\n      this.textInput.attr('data-validate', this.fileInput.attr('data-validate'));\n      this.textInput.validate();\n    }\n\n    if (this.fileInput.attr('readonly')) {\n      this.textInput.prop('disabled', false);\n      this.textInput[0].classList.remove('fileupload-background-transparent');\n      this.fileInput.attr('disabled', 'disabled');\n    }\n\n    /*\n    * New Event for File Upload Change\n    */\n    this.fileInput.on('change.fileupload', function () {\n      if (this.files.length > 0) {\n        self.textInput.val(this.files[0].name).trigger('change');\n        self.svgClose.show().addClass('is-visible');\n      } else {\n        self.clearUploadFile();\n      }\n    });\n\n    // Fix - Not to buble events when clicked on trigger/close icons\n    this.fileInput.on('click.fileupload', (e) => {\n      const handleEventData = this.fileInput.data(`handleEvent${[(e.type || '')]}`);\n      if (handleEventData &&\n          handleEventData.type === e.type &&\n          e.handleObj.namespace === 'fileupload') {\n        this.fileInput.data(`handleEvent${[(e.type || '')]}`, null);\n        e.preventDefault();\n      }\n    });\n\n    // Fix: not sure why, but some browser(ie. safari) need to rerender,\n    // some rules were not applying from css file\n    self.fileInput.css({ position: 'static', left: 0 });\n    setTimeout(() => {\n      self.fileInput.css({ position: 'fixed', left: '-10000px' });\n    }, 0);\n  },\n\n  /*\n  * Clear the Input Upload File\n  */\n  clearUploadFile() {\n    const val = this.fileInput.val();\n    this.fileInput.add(this.textInput).val('');\n    this.svgClose.hide().removeClass('is-visible');\n    if (val !== '') {\n      this.fileInput.triggerHandler('change');\n    }\n  },\n\n  // Unbind all events\n  unbind() {\n    this.svg.add(this.svgClose).off('click.fileupload');\n    this.fileInput.off('change.fileupload');\n    this.textInput.off('keydown.fileupload');\n\n    this.element.closest('.field-fileupload')\n      .removeClass('field-fileupload')\n      .find('>label:first, >[type=\"text\"]:first, .trigger, .trigger-close, .icon-dirty, .msg-dirty').remove();\n\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, FILEUPLOAD_DEFAULTS);\n    }\n    // Nothing to do here as there are no settings.\n    return this;\n  },\n\n  /**\n  * Teardown process for this plugin\n  * @returns {void}\n  */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n  * Disable the input and button.\n  * @returns {void}\n  */\n  disable() {\n    this.textInput.prop('disabled', true);\n    this.fileInput.prop('disabled', true);\n  },\n\n  /**\n  * Enable the input and button.\n  * @returns {void}\n  */\n  enable() {\n    this.textInput.prop('disabled', false).prop('readonly', false);\n    this.fileInput.removeAttr('disabled');\n  },\n\n  /**\n  * Make the input readonly and disable the button.\n  * @returns {void}\n  */\n  readonly() {\n    this.textInput.prop('readonly', true);\n    this.fileInput.prop('disabled', true);\n\n    this.textInput.prop('disabled', false);\n    this.textInput.removeClass('fileupload-background-transparent');\n  }\n\n};\n\nexport { FileUpload, COMPONENT_NAME };\n","import { FileUpload, COMPONENT_NAME } from './fileupload';\n\n/**\n * jQuery Component Wrapper for FileUpload\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.fileupload = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new FileUpload(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { Locale } from '../locale/locale';\n\n// Component Name\nconst COMPONENT_NAME = 'fileuploadadvanced';\n\n/**\n* A trigger field for uploading a single file.\n* @class FileUploadAdvanced\n* @constructor\n*\n* @param {jQuery[]|HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n* @param {boolean} [settings.isStandalone=true] On page(true)|on modal(false), used for some visual style only.\n* @param {string} [settings.standaloneClass='standalone'] Css class if on page.\n* @param {string} [settings.allowedTypes='*'] Restrict file types(ie. 'jpg|png|gif') ['*' all types]\n* @param {number} [settings.maxFilesInProcess=99999] Max number of files can be uploaded\n* @param {number} [settings.maxFileSize=-1] Max file size in bytes, -1 for unlimited\n* @param {string} [settings.fileName='myfile'] Variable name to read from server\n* @param {boolean} [settings.isDisabled=false] Make control disabled\n* @param {boolean} [settings.showBrowseButton=true] Add way to browse files to upload\n* @param {Function} [settings.send] Method for send file to upload\n* @param {string} [settings.textDropArea] Text to show in drop area\n* @param {string} [settings.textDropAreaWithBrowse] Text to show in drop area when browse option true\n* @param {string} [settings.textBtnCancel] Hidden text for cancel button\n* @param {string} [settings.textBtnCloseError] Hidden text for error close button\n* @param {string} [settings.textBtnRemove] Hidden text for remove button\n* @param {string} [settings.errorAllowedTypes] Error text for allowed types\n* @param {string} [settings.errorMaxFileSize] Error text for max file size\n* @param {string} [settings.errorMaxFilesInProcess] Error text for max files in process\n*/\n\nconst FILEUPLOADADVANCED_DEFAULTS = {\n  isStandalone: true, //\n  standaloneClass: 'standalone', // css class if on page\n  allowedTypes: '*', // restrict file types(ie. 'jpg|png|gif') ['*' all types]\n  maxFilesInProcess: 99999, // max files can be upload\n  maxFileSize: -1, // max file size in bytes, -1 for unlimited\n  fileName: 'myfile', // variable name to read from server\n  isDisabled: false, // Disabled\n  showBrowseButton: true, // Browse files to upload\n  send: null, // Function to send files to server\n\n  // Text strings\n  textDropArea: null,\n  textDropAreaWithBrowse: null,\n  textBtnCancel: null,\n  textBtnCloseError: null,\n  textBtnRemove: null,\n\n  // Error strings\n  errorAllowedTypes: null,\n  errorMaxFileSize: null,\n  errorMaxFilesInProcess: null\n};\n\nfunction FileUploadAdvanced(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, FILEUPLOADADVANCED_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// FileUploadAdvanced Methods\nFileUploadAdvanced.prototype = {\n\n  init() {\n    this.build();\n    this.handleEvents();\n  },\n\n  /**\n   * Add markup\n   * @private\n   * @returns {void}\n   */\n  build() {\n    const s = this.settings;\n    let html;\n    let cssClassList = s.isStandalone ? s.standaloneClass : '';\n\n    // Re-evaluate strings\n    s.textDropArea = s.textDropArea || Locale.translate('TextDropArea');\n    s.textDropAreaWithBrowse = s.textDropAreaWithBrowse || Locale.translate('TextDropAreaWithBrowse');\n    s.textBtnCancel = s.textBtnCancel || Locale.translate('TextBtnCancel');\n    s.textBtnCloseError = s.textBtnCloseError || Locale.translate('TextBtnCloseError');\n    s.textBtnRemove = s.textBtnRemove || Locale.translate('TextBtnRemove');\n    s.errorAllowedTypes = s.errorAllowedTypes || `<em>${Locale.translate('Error')}</em>: ${Locale.translate('ErrorAllowedTypes')}`;\n    s.errorMaxFileSize = s.errorMaxFileSize || `<em>${Locale.translate('Error')}</em>: ${Locale.translate('ErrorMaxFileSize')}`;\n    s.errorMaxFilesInProcess = s.errorMaxFilesInProcess || `<em>${Locale.translate('Error')}</em>: ${Locale.translate('ErrorMaxFilesInProcess')}`;\n\n    // Disabled\n    if (this.element.is('.is-disabled')) {\n      s.isDisabled = true;\n    }\n    if (s.isDisabled) {\n      cssClassList += ' is-disabled';\n    }\n\n    // Browse files option\n    if (s.showBrowseButton) {\n      let types = '';\n      const id = utils.uniqueId(this.element, 'fileupload-adv-');\n      const fileExtensions = s.allowedTypes.split(/[\\s|]+/g);\n      let isExtra = s.maxFilesInProcess > 1 ? ' multiple' : '';\n      isExtra += s.isDisabled ? ' disabled' : '';\n\n      if (fileExtensions.length === 1) {\n        if (fileExtensions[0] !== '*') {\n          types = `.${fileExtensions[0]}`;\n        }\n      } else {\n        for (let i = 0, l = fileExtensions.length; i < l; i++) {\n          types += `.${(fileExtensions[i] + (i !== (l - 1) ? ',' : ''))}`;\n        }\n      }\n\n      html = '' +\n        `<div class=\"fileupload-wrapper ${cssClassList}\">\n          <div class=\"container drop-area\">\n            ${$.createIcon('upload')}\n            <label class=\"fileupload-adv-browse-lbl\">\n              <span>${s.textDropAreaWithBrowse}</span>\n              <input type=\"file\" name=\"${id}\" accept=\"${types}\"${isExtra} />\n            </label>\n          </div>\n        </div>`;\n    } else {\n      // Without browse files option\n\n      html = '' +\n        `<div class=\"fileupload-wrapper ${cssClassList}\">\n          <div class=\"container drop-area\">\n            ${$.createIcon('upload')}\n            <p>${s.textDropArea}</p>\n          </div>\n        </div>`;\n    }\n\n    DOM.append(this.element, html, '<div><svg><use><label><span><input>');\n    this.dropArea = $('.drop-area', this.element);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const s = this.settings;\n\n    this.dropArea\n      // Drag enter\n      .on('dragenter.fileuploadadvanced', function (e) {\n        self.element.triggerHandler('filesdragenter');\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (s.isDisabled) {\n          return;\n        }\n        $(this).addClass('hover');\n      })\n\n      // Drag over\n      .on('dragover.fileuploadadvanced', (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n      })\n\n      // Drop\n      .on('drop.fileuploadadvanced', function (e) {\n        const files = e.originalEvent.dataTransfer.files;\n        e.preventDefault();\n        if (s.isDisabled) {\n          return;\n        }\n\n        /**\n        * Fires when file/s drag and droped to drop area.\n        *\n        * @event filesdroped\n        * @memberof FileUploadAdvanced\n        * @property {object} event - The jquery event object\n        * @property {array} files - List of files droped\n        */\n        self.element.triggerHandler('filesdroped', [files]);\n\n        $(this).removeClass('hover is-focus');\n\n        // Clear previous errors in general area\n        $('span.msg', this.element).closest('.error').remove();\n\n        // Max files can be upload\n        if ((files.length + $('.progress', this.element).length) > s.maxFilesInProcess) {\n          self.showError(s.errorMaxFilesInProcess);\n          return;\n        }\n\n        self.handleFileUpload(files);\n      });\n\n    if (s.showBrowseButton && !s.isDisabled) {\n      const label = this.dropArea.find('.fileupload-adv-browse-lbl');\n      const input = label.find('input[type=\"file\"]');\n\n      // Only let open dialog if clicked on link or input\n      label.click((e) => {\n        if (!$(e.target).is('.hyperlink, input[type=\"file\"]')) {\n          e.preventDefault();\n        }\n      });\n\n      input.hideFocus();\n      input\n        .on('hidefocusremove.fileuploadadvanced', (e) => {\n          e.stopPropagation();\n          this.dropArea.addClass('is-focus');\n        })\n        .on('hidefocusadd.fileuploadadvanced', (e) => {\n          e.stopPropagation();\n          this.dropArea.removeClass('is-focus');\n        })\n        .on('change.fileuploadadvanced', function (e) {\n          e.stopPropagation();\n          self.handleFileUpload(this.files);\n        });\n    }\n\n    // If the files are dropped outside the div, files will open in the browser window.\n    // To avoid this prevent 'drop' event on document.\n    $(document).on('dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced', (e) => {\n      e.stopPropagation();\n      e.preventDefault();\n\n      if (e.type === 'dragover') {\n        self.dropArea.removeClass('hover');\n      }\n    });\n  },\n\n  /**\n  * Read the file contents using HTML5 FormData()\n  * @param {object} files File object containing uploaded files.\n  * @returns {void}\n  */\n  handleFileUpload(files) {\n    const s = this.settings;\n    const fileName = s.fileName.replace('[]', '');\n\n    /* eslint-disable no-continue */\n    for (let i = 0, l = files.length; i < l; i++) {\n      // Check if file type allowed\n      if (!this.isFileTypeAllowed(files[i].name)) {\n        this.showError(s.errorAllowedTypes, files[i]);\n        continue;\n      }\n\n      // Check for max file size\n      if (s.maxFileSize !== -1 && files[i].size > s.maxFileSize) {\n        this.showError(s.errorMaxFileSize, files[i]);\n        continue;\n      }\n\n      /**\n      * Fires before create the progress status object.\n      *\n      * @event beforecreatestatus\n      * @memberof FileUploadAdvanced\n      * @property {object} event - The jquery event object\n      * @property {object} file - file to set the status\n      */\n      this.element.triggerHandler('beforecreatestatus', [files[i]]);\n      /* global FormData */\n      const fd = new FormData();\n      fd.append(`${fileName}[]`, files[i]);\n\n      const status = this.createStatus(files[i]);\n      status.container.find('.status-icon .action').focus();\n\n      /**\n      * Fires after create the progress status object.\n      *\n      * @event aftercreatestatus\n      * @memberof FileUploadAdvanced\n      * @property {object} event - The jquery event object\n      * @property {object} file - file to set the status\n      */\n      this.element.triggerHandler('aftercreatestatus', [files[i]]);\n\n      if (typeof s.send === 'function') {\n        s.send(fd, status);\n      } else {\n        this.sendFileToServer(fd, status);\n      }\n    }\n    /* eslint-enable no-continue */\n\n    if (s.showBrowseButton) {\n      // Clear browse file input\n      this.dropArea.find('.fileupload-adv-browse-lbl input[type=\"file\"]').val('');\n    }\n  },\n\n  /**\n  * Create status object\n  * @param {object} file to create progress status.\n  * @returns {object} contains file and status methods to access.\n  */\n  createStatus(file) {\n    const self = this;\n    const s = this.settings;\n    const container = $('' +\n      `<div class=\"container\">\n        <div class=\"file-row\">\n          <span class=\"status-icon\">\n            <button type=\"button\" class=\"btn-icon action\">\n              ${$.createIcon({ icon: 'close', classes: ['icon-close'] })}\n              <span>${s.textBtnCancel}</span>\n            </button>\n          </span>\n          <span class=\"description\">${file.name}</span>\n          <div class=\"l-pull-right\">\n            <span class=\"size\">${this.formatFileSize(file.size)}</span>\n          </div>\n        </div>\n        <div class=\"progress-row\">\n          <span class=\"progress\">\n            <span class=\"progress-bar\" data-value=\"0\"></span>\n          </span>\n        </div>\n      </div>`);\n\n    const btnCancel = $('.action', container).button();\n    const rightSide = $('.l-pull-right', container);\n    const progressBar = $('.progress-bar', container).progress({ animationLength: 10 });\n\n    // Add this container\n    this.dropArea.after(container);\n\n    // Update progress-bar\n    const setProgress = (progress) => {\n      /**\n      * Fires when file progress status changes.\n      *\n      * @event fileprogress\n      * @memberof FileUploadAdvanced\n      * @property {object} event - The jquery event object\n      * @property {object} status - `{ file, progress }`\n      */\n      this.element.triggerHandler('fileprogress', [{ file, progress }]);\n      progressBar.attr('data-value', progress).triggerHandler('updated');\n    };\n\n    // Set abort action\n    const setAbort = (jqxhr) => {\n      btnCancel.on('click.fileuploadadvanced', () => {\n        /**\n        * Fires when file aborted.\n        *\n        * @event fileaborted\n        * @memberof FileUploadAdvanced\n        * @property {object} event - The jquery event object\n        * @property {object} file - aborted\n        */\n        this.element.triggerHandler('fileaborted', [file]);\n        jqxhr.abort();\n        btnCancel.off('click.fileuploadadvanced');\n        container.remove();\n      });\n    };\n\n    // Set completed state\n    const setCompleted = function (data) {\n      container.addClass('completed');\n\n      // Add \"Completed\" icon\n      btnCancel.after($.createIcon('check'));\n\n      // Add \"Remove from server\" button\n      rightSide.append('' +\n        `<button type=\"button\" class=\"btn-icon action\">\n          ${$.createIcon({ classes: ['icon-close'], icon: 'close' })}\n          <span>${s.textBtnRemove}</span>\n        </button>`);\n\n      // Set \"Remove from server\" button action\n      $('.action', rightSide).button().on('click.fileuploadadvanced', function () {\n        $(this).off('click.fileuploadadvanced');\n        container.remove();\n\n        // TODO: server call for removing data\n        data.remove();\n      });\n\n      // Remove Cancel button and progress-bar area\n      btnCancel.off('click.fileuploadadvanced');\n      btnCancel.add(progressBar.closest('.progress-row')).remove();\n      /**\n      * Fires when file complete uploading.\n      *\n      * @event filecompleteuploading\n      * @memberof FileUploadAdvanced\n      * @property {object} event - The jquery event object\n      * @property {object} file uploaded\n      */\n      self.element.triggerHandler('filecompleteuploading', [file]);\n    };\n\n    return { file, container, setProgress, setAbort, setCompleted };\n  },\n\n  /**\n  * Function you can implement to send data to the server.\n  * @param {object} formData - Contains the form data / file data.\n  * @param {object} status - Status of the upload operation\n  * @returns {void}\n  */\n  sendFileToServer(formData, status) {\n    const jqXHR = { abort: () => {} };\n    const tempData = { remove: () => {} };\n    let percent = 0;\n    const total = parseFloat(status.file.size);\n    /* eslint-disable new-cap */\n    const timer = new $.fn.timer(() => {\n      status.setCompleted(tempData);\n    }, total);\n    /* eslint-enable new-cap */\n\n    $(timer.event)\n      .on('update', (e, data) => {\n        percent = Math.ceil((data.counter / total) * 100);\n        status.setProgress(percent);\n      });\n\n    status.setAbort(jqXHR);\n  },\n\n  /**\n   * Show error on ui\n   * @private\n   * @param {string} error to display\n   * @param {object} file contains the error.\n   * @returns {void}\n   */\n  showError(error, file) {\n    let container;\n    const s = this.settings;\n\n    if (error === s.errorMaxFilesInProcess) {\n      // This error show without file name or size in general area\n      container = $('' +\n        `<div class=\"container error\">\n          <div class=\"file-row\">\n            <span class=\"status-icon\">\n              <button type=\"button\" class=\"btn-icon action\">\n                ${$.createIcon({ classes: ['icon-close'], icon: 'close' })}\n                <span>${s.textBtnCloseError}</span>\n              </button>\n            </span>\n            <span class=\"msg\">${error}</span>\n          </div>\n        </div>`);\n    } else {\n      container = $('' +\n        `<div class=\"container error\">\n          <div class=\"file-row\">\n            <span class=\"status-icon\">\n              <button type=\"button\" class=\"btn-icon action\">\n                ${$.createIcon({ classes: ['icon-close'], icon: 'close' })}\n                <span>${s.textBtnCloseError}</span>\n              </button>\n            </span>\n            <span class=\"description\">${file.name}</span>\n            <div class=\"l-pull-right\">\n              <span class=\"size\">${this.formatFileSize(file.size)}</span>\n            </div>\n          </div>\n          <div class=\"msg\">\n            <p>${error}</p>\n          </div>\n        </div>`);\n    }\n\n    $('.action', container).button().on('click.fileuploadadvanced', () => {\n      container.remove();\n    });\n\n    // Add this container\n    this.dropArea.after(container);\n  },\n\n  /**\n   * Check if file type allowed\n   * @private\n   * @param {string} fileName to check types\n   * @returns {boolean} true if allowed to uploaded\n   */\n  isFileTypeAllowed(fileName) {\n    const fileExtensions = this.settings.allowedTypes.toLowerCase().split(/[\\s|]+/g);\n    const ext = fileName.split('.').pop().toLowerCase();\n    if (this.settings.allowedTypes !== '*' && $.inArray(ext, fileExtensions) < 0) {\n      return false;\n    }\n    return true;\n  },\n\n  /**\n   * Helper function that formats the file sizes\n   * @private\n   * @param {number} bytes to be formated\n   * @returns {string} formated to use in ui\n   */\n  formatFileSize(bytes) {\n    const scale = {\n      GB: 1000000000,\n      MB: 1000000,\n      KB: 1000\n    };\n    if (typeof bytes !== 'number') {\n      return '';\n    }\n    if (bytes >= scale.GB) {\n      return `${(bytes / scale.GB).toFixed(2)} GB`;\n    }\n    if (bytes >= scale.MB) {\n      return `${(bytes / scale.MB).toFixed(2)} MB`;\n    }\n    return `${(bytes / scale.KB).toFixed(2)} KB`;\n  },\n\n  /**\n  * Set component to enabled.\n  * @returns {void}\n  */\n  enable() {\n    this.settings.isDisabled = false;\n    this.unbind();\n    this.element\n      .find('.fileupload-wrapper').removeClass('is-disabled')\n      .find('.fileupload-adv-browse-lbl input[type=\"file\"]').removeAttr('disabled');\n    this.handleEvents();\n  },\n\n  /**\n  * Set component to disabled.\n  * @returns {void}\n  */\n  disable() {\n    this.settings.isDisabled = true;\n    this.unbind();\n    this.element\n      .find('.fileupload-wrapper').addClass('is-disabled')\n      .find('.fileupload-adv-browse-lbl input[type=\"file\"]').attr('disabled', 'disabled');\n    this.handleEvents();\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {void}\n   */\n  unbind() {\n    this.dropArea.find('.fileupload-adv-browse-lbl input[type=\"file\"]').off('hidefocusremove.fileuploadadvanced hidefocusadd.fileuploadadvanced change.fileuploadadvanced');\n\n    this.dropArea.off('dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced');\n    $(document).off('dragenter.fileuploadadvanced dragover.fileuploadadvanced drop.fileuploadadvanced');\n    $('.action', this.element).off('click.fileuploadadvanced');\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, FILEUPLOADADVANCED_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n  * Destroy and remove added markup, all events\n  * @returns {void}\n  */\n  destroy() {\n    this.unbind();\n    $('.fileupload-wrapper', this.element).remove();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { FileUploadAdvanced, COMPONENT_NAME };\n\n/*\nERROR\n--------\nhttps://social.technet.microsoft.com/Forums/ie/en-US/ec3c0be0-0834-4873-8e94-700e9df9c822/edge-browser-drag-and-drop-files-not-working?forum=ieitprocurrentver\n\n*/\n","import { FileUploadAdvanced, COMPONENT_NAME } from './fileupload-advanced';\n\n/**\n * jQuery Component Wrapper for FileUpload Advanced\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.fileuploadadvanced = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new FileUploadAdvanced(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Default Settings\nconst COMPONENT_NAME = 'homepage';\n\n/**\n* The Homepage handles card layout at multiple breakpoints.\n*\n* @class Homepage\n* @constructor\n* @param {HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n* @param {boolean} [settings.animate] Disable animation during resize\n* @param {number} [settings.columns] Display in 3 (default) or 4 column layout\n* @param {string} [settings.easing]\n* @param {number} [settings.gutterSize]\n* @param {number} [settings.widgetWidth]\n* @param {number} [settings.widgetHeight]\n* @param {number} [settings.timeout]\n*/\nconst HOMEPAGE_DEFAULTS = {\n  animate: true,\n  columns: 3,\n  easing: 'blockslide', // Private\n  gutterSize: 20, // Private\n  widgetWidth: 360, // Private\n  widgetHeight: 370, // Private\n  timeout: 100 // Private\n};\n\nfunction Homepage(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, HOMEPAGE_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Homepage Methods\nHomepage.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.isTransitionsSupports = this.supportsTransitions();\n    this.initHeroWidget();\n    this.handleEvents();\n\n    // Initial Sizing\n    this.resize(this, false);\n  },\n\n  /**\n   * Initialize columns.\n   * @private\n   * @param {number} row to be initialize.\n   * @returns {void}\n   */\n  initColumns(row) {\n    row = row || 0;\n    this.rowsAndCols[row] = [];\n\n    for (let i = 0, l = this.settings.columns; i < l; i++) {\n      this.rowsAndCols[row][i] = true;// Make all columns available in first row[true]\n    }\n  },\n\n  /**\n   * Initialize hero widget.\n   * @private\n   * @returns {void}\n   */\n  initHeroWidget() {\n    let heroWidget = $('.hero-widget');\n    if (heroWidget.length > 1) {\n      heroWidget = heroWidget.not(':first').remove();\n    }\n    this.heroWidget = heroWidget;\n  },\n\n  /**\n   * Initialize rows and cols.\n   * @private\n   * @returns {void}\n   */\n  initRowsAndCols() {\n    this.rowsAndCols = [];// Keeping all blocks as rows and columns\n    this.initColumns();\n  },\n\n  /**\n   * Get availability where we can fit this given block.\n   * @private\n   * @param {object} block to get availability.\n   * @returns {object} [x and y] where we can fit this block\n   */\n  getAvailability(block) {\n    let abort = false;\n    const smallest = {};\n    const rows = this.rowsAndCols.length;\n\n    // Loop thru each row and column soon it found first available spot\n    // Then check for if block's width can fit in(yes), asign to [smallest] and break both loops\n    for (let i = 0, l = rows; i < l && !abort; i++) {\n      for (\n        let j = 0, innerCheck = true, cols = this.rowsAndCols[i].length;\n        j < cols && !abort;\n        j++\n      ) {\n        if ((this.rowsAndCols[i][j]) && ((block.w + j) <= cols)) {\n          if ((block.w > 1) && (cols > (j + 1))) {\n            for (let n = 0; n < block.w; n++) {\n              if (!this.rowsAndCols[i][j + n]) {\n                innerCheck = false;\n                break;\n              }\n            }\n          }\n          if ((block.h > 1) && (rows > (i + 1))) {\n            for (let n = 0; n < block.h; n++) {\n              if (!this.rowsAndCols[i + n][j]) {\n                innerCheck = false;\n                break;\n              }\n            }\n          }\n          if (innerCheck) {\n            smallest.row = i;\n            smallest.col = j;\n            abort = true;\n          }\n        }\n      }\n    }\n\n    // If did not found any available spot from previous loops\n    // Add new row and asign to [smallest] first column in this new row\n    if (!Object.getOwnPropertyNames(smallest).length) {\n      this.initColumns(rows);\n      smallest.row = rows;\n      smallest.col = 0;\n    }\n\n    return smallest; // {x:0, y:0}\n  },\n\n  /**\n   * Make all spots as unavailable, depends on block's width and height\n   * Soon we used this block\n   * @private\n   * @param {number} r as row.\n   * @param {number} c as col.\n   * @param {number} block to fit.\n   * @returns {void}\n   */\n  fitBlock(r, c, block) {\n    let addRow = true;\n\n    block.x = c;\n    block.y = r;\n\n    if ((block.w === 1) && (block.h === 1)) { // Single block can fit anywhere\n      this.rowsAndCols[r][c] = false;\n    } else if (block.w !== 1) {\n      // If more then one row or column then loop thru to block's width and height\n      // If height is more then current rows then add new row\n      // Mark those spots as unavailable[false]\n\n      // Left to right\n      for (let i = r, l = block.h + r; i < l; i++) {\n        for (let j = c, l2 = block.w + c; j < l2; j++) {\n          if (!this.rowsAndCols[i]) {\n            this.initColumns(i);\n          }\n          this.rowsAndCols[i][j] = false;\n        }\n      }\n    } else {\n      // Top to bottom\n      for (let i = r, l = block.h + r; i < l; i++) {\n        for (let j = c, l2 = block.h + c; j < l2; j++) {\n          if (!this.rowsAndCols[i]) {\n            this.initColumns(i);\n          }\n          this.rowsAndCols[i][c] = false;\n        }\n      }\n    }\n\n    // Check if reach to end of columns then assign flag[addRow]\n    for (let i = 0, l = this.rowsAndCols[r].length; i < l; i++) {\n      if (this.rowsAndCols[r][i]) {\n        addRow = false;\n      }\n    }\n\n    // If reach to end of columns and next row is not avaiable then add new row\n    // Make all columns available, if not assigned earlier as unavailable\n    if (addRow) {\n      if (!this.rowsAndCols[r + 1]) {\n        this.initColumns(r + 1);\n      }\n    }\n  },\n\n  /**\n   * Setup each block sizes, based on classes provided from markup\n   * @private\n   * @returns {void}\n   */\n  setBlocks() {\n    const cards = this.element.find('.card, .widget');\n    this.blocks = [];\n\n    for (let i = 0, l = cards.length; i < l; i++) {\n      const card = $(cards[i]);\n      const h = card.hasClass('double-height') ? 2 : 1;\n      let w;\n\n      if (card.hasClass('quad-width')) {\n        w = 4;\n      } else if (card.hasClass('triple-width')) {\n        w = 3;\n      } else if (card.hasClass('double-width')) {\n        w = 2;\n      } else {\n        w = 1;\n      }\n\n      this.blocks.push({ w, h, elem: card, text: card.text() });\n    }\n\n    // Max sized columns brings to top\n    if (this.settings.columns > 1) {\n      for (let i = 0, j = 0, w = 0, l = this.blocks.length; i < l; i++) {\n        if (this.blocks[i].w >= this.settings.columns && i && w) {\n          this.arrayIndexMove(this.blocks, i, j);\n        }\n        w += this.blocks[i].w;\n        if (w >= this.settings.columns) {\n          w = 0; // reset\n          j = (this.blocks[j].w >= this.settings.columns) ? j + 1 : i; // record to move\n        }\n      }\n    }\n  },\n\n  /**\n   * Move an array element position\n   * @private\n   * @param {array} arr .\n   * @param {number} from index.\n   * @param {number} to index.\n   * @returns {void}\n   */\n  arrayIndexMove(arr, from, to) {\n    arr.splice(to, 0, arr.splice(from, 1)[0]);\n  },\n\n  /**\n   * Resize Method\n   * @private\n   * @param {object} self .\n   * @param {boolean} animate .\n   * @returns {void}\n   */\n  resize(self, animate) {\n    // Sizes of \"breakpoints\" is  320, 660, 1000 , 1340 (for 320)\n    // or 360, 740, 1120, 1500 or (for 360)\n    const bpXL = (self.settings.widgetWidth * 4) + (self.settings.gutterSize * 3);\n    const bpDesktop = (self.settings.widgetWidth * 3) + (self.settings.gutterSize * 2);\n    const bpTablet = (self.settings.widgetWidth * 2) + self.settings.gutterSize;\n    const bpPhone = self.settings.widgetWidth;\n\n    let bp = bpXL; // 1340\n    // Math min against window.screen.width for single line mobile support\n    const elemWidth = self.element.outerWidth();\n\n    // elemWidth -= 30; //extra break space\n\n    // Find the Breakpoints\n    const xl = (elemWidth >= bpXL);\n    const desktop = (elemWidth >= bpDesktop && elemWidth <= bpXL);\n    const tablet = (elemWidth >= bpTablet && elemWidth <= bpDesktop);\n    const phone = (elemWidth <= bpTablet);\n\n    const maxAttr = this.element.attr('data-columns');\n    const content = self.element.find('> .content');\n    this.settings.columns = parseInt((maxAttr || this.settings.columns), 10);\n\n    // Assign columns as breakpoint sizes\n    if (xl && self.settings.columns === 4) {\n      self.settings.columns = 4;\n      bp = bpXL;\n    }\n    if ((desktop) || (xl && self.settings.columns === 3)) {\n      self.settings.columns = 3;\n      bp = bpDesktop;\n    }\n    if (tablet) {\n      self.settings.columns = 2;\n      bp = bpTablet;\n    }\n    if (phone) {\n      self.settings.columns = 1;\n      bp = bpPhone;\n    }\n\n    if (content.length) {\n      content[0].style.marginLeft = `-${(bp / 2)}px`;\n    }\n\n    this.setBlocks(); // setup blocks\n    this.initRowsAndCols(); // setup colums\n\n    // Loop thru each block, make fit where available and\n    // If block more wider than available size, make as  available size\n    // Assign new left and top css positions\n    for (let i = 0, l = self.blocks.length; i < l; i++) {\n      // let left, top, pos, available,\n      const block = self.blocks[i];\n\n      // Remove extra classes if assigned earlier\n      block.elem.removeClass('to-single to-double to-triple');\n\n      // If block more wider than available size, make as available size\n      if (block.w > self.settings.columns) {\n        block.w = self.settings.columns;\n\n        if (self.settings.columns === 1) {\n          block.elem.addClass('to-single');\n        } else if (self.settings.columns === 2) {\n          block.elem.addClass('to-double');\n        } else if (self.settings.columns === 3) {\n          block.elem.addClass('to-triple');\n        }\n      }\n\n      // Get Availability\n      const available = self.getAvailability(block);\n\n      // Set positions\n      const box = self.settings.widgetWidth + self.settings.gutterSize;\n      const totalWidth = box * self.settings.columns;\n\n      const left = Locale.isRTL() ? totalWidth - ((box * block.w) + (box * available.col)) : box * available.col;// eslint-disable-line\n      const top = (self.settings.widgetHeight + self.settings.gutterSize) * available.row;\n      const pos = { left, top };\n\n      if (animate) {\n        const easing = self.settings.easing;\n        const blockslide = [0.09, 0.11, 0.24, 0.91];\n\n        if (easing === 'blockslide') {\n          if (self.isTransitionsSupports) {\n            self.applyCubicBezier(block.elem, blockslide);\n            block.elem[0].style.left = `${pos.left}px`;\n            block.elem[0].style.top = `${pos.top}px`;\n          } else {\n            // IE-9\n            block.elem.animate(pos, self.settings.timeout);\n          }\n        } else {\n          // Other easing effects ie (linear, swing)\n          block.elem.animate(pos, self.settings.timeout, easing);\n        }\n      } else {\n        block.elem[0].style.left = `${pos.left}px`;\n        block.elem[0].style.top = `${pos.top}px`;\n      }\n\n      // Mark all spots as unavailable for this block, as we just used this one\n      self.fitBlock(available.row, available.col, block);\n    }\n\n    /**\n    * Fires after the page is resized and layout is set.\n    * Can be used for any special adjustments.\n    * @event resize\n    * @memberof Homepage\n    * @type {object}\n    * @param {object} event - The jquery event object\n    */\n    self.element.triggerHandler('resize', self.settings.columns);\n  },\n\n  /**\n   * Apply cubic-bezier effects\n   * @private\n   * @param {object} el as element.\n   * @param {string} cubicBezier effect to apply.\n   * @returns {void}\n   */\n  applyCubicBezier(el, cubicBezier) {\n    const value = `all .3s cubic-bezier(${cubicBezier})`;\n    el[0].style['-webkit-transition'] = value;\n    el[0].style['-moz-transition'] = value;\n    el[0].style['-ms-transition'] = value;\n    el[0].style['-o-transition'] = value;\n    el[0].style.transition = value;\n  },\n\n  /**\n   * Check if browser supports transitions\n   * @private\n   * @returns {boolean} true if supports transitions\n   */\n  supportsTransitions() {\n    const s = document.createElement('p').style;\n    let p = 'transition';\n\n    if (typeof s[p] === 'string') {\n      return true;\n    }\n\n    // Tests for vendor specific prop\n    const v = ['Moz', 'webkit', 'Webkit', 'Khtml', 'O', 'ms'];\n    p = p.charAt(0).toUpperCase() + p.substr(1);\n\n    for (let i = 0, l = v.length; i < l; i++) {\n      if (typeof s[v[i] + p] === 'string') {\n        return true;\n      }\n    }\n    return false;\n  },\n\n  /**\n   * Detach events\n   * @private\n   * @returns {void}\n   */\n  detachEvents() {\n    $('body').off('resize.homepage');\n    $('.application-menu').off('applicationmenuopen.homepage applicationmenuclose.homepage');\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, HOMEPAGE_DEFAULTS);\n    }\n    return this\n      .detachEvents()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.detachEvents();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    $('body').on('resize.homepage', () => {\n      this.resize(this, this.settings.animate);\n    });\n\n    $('.application-menu').on('applicationmenuopen.homepage applicationmenuclose.homepage', () => {\n      this.resize(this, this.settings.animate);\n    });\n  }\n\n};\n\nexport { Homepage, COMPONENT_NAME };\n","import { Homepage, COMPONENT_NAME } from './homepage';\n\n/**\n * jQuery Component Wrapper for Homepage\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.homepage = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Homepage(this, settings));\n    }\n  });\n};\n","/* eslint-disable no-underscore-dangle */\nimport * as debug from '../../utils/debug';\nimport { DOM } from '../../utils/dom';\nimport { warnAboutDeprecation } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { stringUtils } from '../../utils/string';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../button/button.jquery';\nimport '../icons/icons.jquery';\nimport '../mask/mask-input';\nimport '../popupmenu/popupmenu.jquery';\nimport '../tooltip/tooltip.jquery';\n\n// The name of this component.\nconst COMPONENT_NAME = 'pager';\n\n// Selector for Pager elements that should have a tabIndex\nconst FOCUSABLE_SELECTOR = [\n  '.pager-first > a',\n  '.pager-prev > a',\n  '.pager-next > a',\n  '.pager-last > a',\n  '.pager-no > a',\n  '.pager-count input',\n  '.pager-pagesize button'\n].join(', ');\n\n/**\n* The Pager Component supports paging on lists.\n* @class Pager\n* @param {jQuery[]|HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n*\n* @param {string} [settings.componentAPI]  If defined, becomes the definitive way to call methods on\n* parent component.\n* @param {string} [settings.type = 'list']  Different types of pagers option sets.\n* list - just shows next and previous and a listing of page numbers you can click\n* pageof - for datagrid also shows next and previous and first and last with a page number input and page size selector used optionally for\n* firstlast - for lists shows next and previous and first and last with option to set showPageSizeSelector\n* standalone - lets you control all the options with settings, events and methods. In the future i will refactor the others out.\n* @param {string} [settings.position = 'bottom']  Can be on 'bottom' or 'top'.\n* @param {number} [settings.activePage = 1]  Start on this page\n* @param {boolean} [settings.hideOnOnePage = false]  If true, hides the pager if there is only one page worth of results.\n* @param {Function} [settings.source] Call back function for pager data source\n* @param {number} [settings.pagesize = 15]  Can be calculated or a specific number\n* @param {array} [settings.pagesizes = [15, 25, 50, 75]] Array of numbers of the page size selector\n* @param {boolean} [settings.showPageSizeSelector = true] If false will not show page size selector\n* @param {boolean} [settings.smallPageSizeSelector = false] If true, shows a condensed view of the page size selector\n* @param {boolean} [settings.onPageSizeChange] Call back function for page change\n* @param {boolean} [settings.showFirstButton = true] If false the first button will be hidden (standalone mode)\n* @param {boolean} [settings.enableFirstButton = true] If false the first button will be disabled (standalone mode)\n* @param {boolean} [settings.onFirstPage] Call back function for first page button click\n* @param {boolean} [settings.showPreviousButton = true] If false the previous button will be hidden (standalone mode)\n* @param {boolean} [settings.enablePreviousButton = true] If false the previous button will be disabled (standalone mode)\n* @param {boolean} [settings.onPreviousPage] Call back function for previous page button click\n* @param {boolean} [settings.showNextButton = true] If false the next button will be hidden (standalone mode)\n* @param {boolean} [settings.enableNextButton = true] If false the next button will be disabled (standalone mode)\n* @param {boolean} [settings.onNextPage] Call back function for next page button click\n* @param {boolean} [settings.showLastButton = true] If false the last button will be hidden (standalone mode)\n* @param {boolean} [settings.enableLastButton = true] If false the last button will be disabled (standalone mode)\n* @param {boolean} [settings.onLastPage] Call back function for next page button click\n* @param {boolean} [settings.indeterminate = false] If true will not show anything that lets you go to a specific page (deprecated for standalone)\n* @param {boolean} [settings.firstPageTooltip = 'First Page'] Tooltip for the first page, defaults to an internally translated tooltip.\n* @param {boolean} [settings.previousPageTooltip = 'Previous Page'] Tooltip for the first page, defaults to an internally translated tooltip.\n* @param {boolean} [settings.nextPageTooltip = 'Next Page'] Tooltip for the first page, defaults to an internally translated tooltip.\n* @param {boolean} [settings.lastPageTooltip = 'Last Page'] Tooltip for the first page, defaults to an internally translated tooltip.\n*/\nconst PAGER_DEFAULTS = {\n  componentAPI: undefined,\n  type: 'list',\n  position: 'bottom',\n  activePage: 1,\n  hideOnOnePage: false,\n  source: null,\n  pagesize: 15,\n  pagesizes: [15, 25, 50, 75],\n  showPageSizeSelector: true,\n  smallPageSizeSelector: false,\n  onPageSizeChange: null,\n  showFirstButton: true,\n  enableFirstButton: true,\n  showPreviousButton: true,\n  enablePreviousButton: true,\n  showNextButton: true,\n  enableNextButton: true,\n  showLastButton: true,\n  enableLastButton: true,\n  indeterminate: false,\n  onFirstPage: null,\n  onPreviousPage: null,\n  onNextPage: null,\n  onLastPage: null,\n  firstPageTooltip: 'FirstPage',\n  previousPageTooltip: 'PreviousPage',\n  nextPageTooltip: 'NextPage',\n  lastPageTooltip: 'LastPage'\n};\n\nfunction Pager(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, PAGER_DEFAULTS);\n  this.settings.dataset = settings.dataset; // by pass deep copy\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nPager.prototype = {\n\n  /**\n   * Displays the current state of the pager. Replaces `pagingInfo` object.\n   * @returns {object} containing various state properties.\n   */\n  get state() {\n    let total = 0;\n    let pages = 1;\n    let filteredPages;\n    let filteredTotal;\n    let grandTotal;\n    const indeterminate = this.settings.indeterminate;\n    const indeterminatePageCount = 999999999;\n    const pagesize = this.settings.pagesize;\n    const type = this.previousOperation;\n    const trigger = this.previousTrigger;\n    const ds = this.settings.dataset;\n\n    // pass in total number of records\n    if (!isNaN(this.serverDatasetTotal)) {\n      total = this.serverDatasetTotal;\n    } else if (ds && ds.length) {\n      total = ds.length;\n      if (this.isFilteredClientside) {\n        const filteredDs = ds.filter(i => !i.isFiltered);\n        total = filteredDs.length;\n      }\n    }\n\n    if (this.grandTotal) {\n      grandTotal = this.grandTotal;\n    }\n\n    // calculate number of pages\n    if (indeterminate) {\n      pages = indeterminatePageCount;\n    } else if (total < 1) {\n      pages = 1;\n    } else {\n      pages = Math.ceil(total / pagesize);\n    }\n\n    // calculate number of filtered pages, if applicable\n    if (!isNaN(this.filteredTotal)) {\n      filteredTotal = this.filteredTotal;\n      if (indeterminate) {\n        pages = indeterminatePageCount;\n      } else if (filteredTotal < 1) {\n        filteredPages = 1;\n      } else {\n        filteredPages = Math.ceil(filteredTotal / pagesize);\n      }\n    }\n\n    return {\n      activePage: this.activePage,\n      indeterminate: this.settings.indeterminate,\n      grandTotal,\n      pagesize,\n      pages,\n      trigger,\n      total,\n      type,\n      filteredActivePage: this.filteredActivePage,\n      filteredTotal,\n      filteredPages\n    };\n  },\n\n  /**\n   * This method is slated to be removed in a future v4.21.0 or v5.0.0.\n   * (See https://github.com/infor-design/enterprise/issues/922)\n   * @deprecated as of v4.15.0.  Please use the `state` property instead.\n   * @returns {object} containing various state properties\n   */\n  get pagingInfo() {\n    warnAboutDeprecation('state', 'pagingInfo');\n    return this.state;\n  },\n\n  /**\n   * @returns {Array} of HTMLElements representing focusable elements in the pager\n   */\n  get focusableElements() {\n    return utils.getArrayFromList(this.pagerBar[0].querySelectorAll(FOCUSABLE_SELECTOR));\n  },\n\n  /**\n   * @returns {Array|undefined} containing references to numeric paging buttons, if enabled\n   */\n  get numberButtons() {\n    if (this.isTable) {\n      return undefined;\n    }\n    const numberButtonSelector = 'li:not(.pager-prev):not(.pager-next):not(.pager-first):not(.pager-last):not(.pager-pagesize)';\n    const buttons = this.pagerBar[0].querySelectorAll(numberButtonSelector);\n    return utils.getArrayFromList(buttons);\n  },\n\n  /**\n   * @returns {HTMLElement|undefined} the input field used for selecting pages, if enabled\n   */\n  get pageSelectorInput() {\n    if (this.isListView) {\n      return undefined;\n    }\n    return this.pagerBar[0].querySelector('.pager-count input');\n  },\n\n  /**\n   * @returns {HTMLElement|undefined} the button used to select from a list of page sizes, if enabled\n   */\n  get pageSizeSelectorButton() {\n    if (!this.settings.showPageSizeSelector) {\n      return undefined;\n    }\n    return this.pagerBar[0].querySelector('.pager-pagesize button');\n  },\n\n  /**\n   * @returns {boolean} if true, shows the condensed version of the Page Size\n   * Selector Button for smaller viewing areas.\n   */\n  get showSmallPageSizeSelector() {\n    if (!this.settings.showPageSizeSelector) {\n      return false;\n    }\n    if (this.settings.smallPageSizeSelector === true) {\n      return true;\n    }\n    return this.isListView && this.element.parents('.list-detail').length;\n  },\n\n  /**\n   * Init the pager.\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.setup();\n    this.createPagerBar();\n    this.setActivePage(this.settings.activePage, true); // Get First Page\n    this.handleEvents();\n  },\n\n  /**\n   * Setting the internals of the pager.\n   * @private\n   * @returns {void}\n   */\n  setup() {\n    // Check for legacy data attributes\n    if (this.element.attr('data-pagesize')) {\n      const pagesize = Number(this.element.attr('data-pagesize'));\n      if (!isNaN(pagesize)) {\n        this.settings.pagesize = pagesize;\n      }\n      this.element.removeAttr('data-pagesize');\n    }\n\n    // Add [pagesize] if not found in [pagesizes]\n    if (this.settings.pagesizes.indexOf(this.settings.pagesize) === -1) {\n      const sortNumber = function (a, b) {\n        return a - b;\n      };\n      this.settings.pagesizes.push(this.settings.pagesize);\n      this.settings.pagesizes = this.settings.pagesizes.sort(sortNumber);\n    }\n\n    const widgetContainer = this.element.parents('.card, .widget');\n\n    // Adjust for the possibility of the pager being attached to a Table instead\n    // of normal grid markup\n    if (this.element.is('tbody')) {\n      this.isTable = true;\n      this.settings.type = 'table';\n      this.mainContainer = this.element.closest('.datagrid-container');\n\n      if (!this.settings.componentAPI) {\n        this.settings.componentAPI = this.mainContainer.data('datagrid');\n      }\n\n      if (widgetContainer.length) {\n        widgetContainer[0].classList.add('has-datagrid');\n      }\n    }\n\n    // If contained by a widget/card container, build some settings for that\n    const listviewContainer = this.element.is('.listview');\n    if (listviewContainer) {\n      this.isTable = false;\n      this.isListView = true;\n      this.mainContainer = this.element;\n\n      if (!this.settings.componentAPI) {\n        this.settings.componentAPI = this.element.data('listview');\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * Add the pager dom elements.\n   * @private\n   */\n\n  createPagerBar() {\n    if (this.pagerBar) {\n      return;\n    }\n    this.pagerBar = this.element.prev('.pager-toolbar');\n\n    if (this.pagerBar.length === 0) {\n      this.pagerBar = $('<ul class=\"pager-toolbar\"></ul>');\n    }\n\n    if (this.settings.type === 'standalone') {\n      if (this.isListView) {\n        this.mainContainer.after(this.pagerBar);\n      } else {\n        this.element.append(this.pagerBar);\n      }\n    } else if (this.isTable) {\n      this.mainContainer.after(this.pagerBar);\n    } else if (this.settings.position === 'bottom') {\n      this.element.after(this.pagerBar);\n    } else {\n      this.element.before(this.pagerBar);\n    }\n\n    if (this.isListView) {\n      this.pagerBar.addClass('is-listview');\n    }\n\n    // Inside of Listviews, place the pager bar inside of the card/widget footer\n    const widgetContainer = this.element.closest('.card, .widget');\n    if (widgetContainer.length) {\n      const self = this;\n      const widgetTypes = ['widget', 'card'];\n\n      widgetTypes.forEach((type) => {\n        const widgetContent = self.element.closest(`.${type}-content`);\n        if (!widgetContent.length) {\n          return;\n        }\n\n        let widgetFooter = widgetContent.next(`.${type}-footer`);\n        if (!widgetFooter.length) {\n          widgetFooter = $(`<div class=\"${type}-footer\"></div>`).insertAfter(widgetContent);\n        }\n\n        self.pagerBar.appendTo(widgetFooter);\n      });\n    }\n  },\n\n  /**\n   * Attach All relevant events\n   * @private\n   */\n  handleEvents() {\n    const self = this;\n\n    // Attach button click and touch\n    this.pagerBar.on('click.pager', 'a', function (e) {\n      const a = e.currentTarget;\n      const li = a.parentNode;\n\n      e.preventDefault();\n\n      if ($(this).attr('disabled')) {\n        return false;\n      }\n\n      // If this is a filtered dataset, use the `filteredTotal` instead\n      const state = self.state;\n      let currentPage = state.activePage;\n      if (state.filteredTotal) {\n        currentPage = state.filteredActivePage;\n      }\n\n      if (DOM.hasClass(li, 'pager-prev')) {\n        self.setActivePage(currentPage - 1, false, 'prev');\n        self.triggerPagingEvents(currentPage);\n        return false;\n      }\n\n      if (DOM.hasClass(li, 'pager-next')) {\n        self.setActivePage((currentPage === -1 ? 1 : currentPage) + 1, false, 'next');\n        self.triggerPagingEvents(currentPage);\n        return false;\n      }\n\n      if (DOM.hasClass(li, 'pager-first')) {\n        self.setActivePage(1, false, 'first');\n        self.triggerPagingEvents(currentPage);\n        return false;\n      }\n\n      if (DOM.hasClass(li, 'pager-last')) {\n        self.setActivePage(self.pageCount(), false, 'last'); // TODO Calculate Last Page?\n        self.triggerPagingEvents(currentPage);\n        return false;\n      }\n\n      // Go to the page via the applied `data-page` attribute of the button\n      let activePageIdx = Number(a.getAttribute('data-page'));\n      if (isNaN(activePageIdx) || activePageIdx < 1) {\n        activePageIdx = 1;\n      }\n      self.setActivePage(activePageIdx, false, 'page');\n      self.triggerPagingEvents(currentPage);\n      return false;\n    });\n\n    self.pagerBar.on('keydown.pager', $(self.focusableElements), (event) => {\n      event = event || window.event;\n      const key = event.which || event.keyCode || event.charCode || false;\n      let isLeft = key === 37 || key === 40;\n      let isRight = key === 39 || key === 38;\n\n      const elem = event.target;\n      if (elem.nodeName === 'INPUT') { // work on up down key\n        isLeft = key === 40;\n        isRight = key === 38;\n      }\n\n      if (!isLeft && !isRight) {\n        return true;\n      }\n\n      const parent = elem.nodeName === 'INPUT' ? elem.parentNode.parentNode : elem.parentNode;\n      const next = parent.nextSibling;\n      const prev = parent.previousSibling;\n      const isFirst = prev === null;\n      const isLast = next === null;\n\n      event.preventDefault();\n\n      if (isLeft && !isFirst) {\n        const link = prev.querySelector('a, button, input');\n        link.removeAttribute('tabindex');\n        elem.setAttribute('tabindex', '-1');\n        link.focus();\n        return false;\n      }\n\n      if (isLeft && isFirst) {\n        const link = parent.parentNode.lastChild.querySelector('a, button, input');\n        link.removeAttribute('tabindex');\n        elem.setAttribute('tabindex', '-1');\n        link.focus();\n        return false;\n      }\n\n      if (isRight && !isLast) {\n        const link = next.querySelector('a, button, input');\n        link.removeAttribute('tabindex');\n        elem.setAttribute('tabindex', '-1');\n        link.focus();\n        return false;\n      }\n\n      if (isRight && isLast) {\n        const link = parent.parentNode.firstChild.querySelector('a, button, input');\n        link.removeAttribute('tabindex');\n        elem.setAttribute('tabindex', '-1');\n        link.focus();\n      }\n\n      return false;\n    });\n  },\n\n  /**\n   * Resets the pager to its original settings\n   * @param {string} [operation=undefined] optional informational string that describes the purpose of a filtering operation\n   * @param {string} [trigger=undefined] optional information string that describes the reason for the reset\n   * @returns {void}\n   */\n  reset(operation, trigger) {\n    this.activePage = this.settings.activePage;\n    this.previousOperation = operation;\n    this.previousTrigger = trigger;\n\n    this.teardown();\n    this.init();\n  },\n\n  /**\n   * Show page size selector\n   * @param  {boolean} toggleOption Toggle vs show\n   */\n  showPageSizeSelector(toggleOption) {\n    toggleOption = (`${toggleOption}`).toLowerCase() === 'true';\n    this.settings.showPageSizeSelector = toggleOption;\n\n    if (toggleOption) {\n      this.isShowPageSizeSelectorCall = toggleOption;\n    }\n  },\n\n  /**\n   * Shows or hides a specified special control button on the Pager.\n   * @param {string} [type] the type of button to target.\n   * @param {boolean} toggleOption Show vs. Hide\n   */\n  showButton(type, toggleOption) {\n    // Determine the correct button\n    const types = ['first', 'last', 'next', 'previous'];\n    if (types.indexOf(type) === -1) {\n      return;\n    }\n    let selector = `.pager-${type} a`;\n    if (type === 'previous') {\n      selector = '.pager-prev a';\n    }\n\n    // Get anchor/option\n    const a = this.pagerBar[0].querySelector(selector);\n    toggleOption = (`${toggleOption}`).toLowerCase() === 'true';\n\n    // Set the value in the settings\n    this.settings[`show${stringUtils.capitalize(type)}Button`] = toggleOption;\n\n    // If the button hasn't been rendered, don't alter the DOM.\n    if (!a) {\n      return;\n    }\n\n    // Change the DOM\n    if (toggleOption) {\n      a.parentNode.classList.remove('hidden');\n    } else {\n      a.parentNode.classList.add('hidden');\n    }\n  },\n\n  /**\n   * Enables or disables a specified special control button on the Pager.\n   * @param {string} [type] the type of button to target.\n   * @param {boolean} toggleOption Enable vs. Disable\n   */\n  enableButton(type, toggleOption) {\n    // Determine the correct button\n    const types = ['first', 'last', 'next', 'previous'];\n    if (types.indexOf(type) === -1) {\n      return;\n    }\n    let selector = `.pager-${type} a`;\n    if (type === 'previous') {\n      selector = '.pager-prev a';\n    }\n\n    // Get anchor/option\n    const a = this.pagerBar[0].querySelector(selector);\n    toggleOption = (`${toggleOption}`).toLowerCase() === 'true';\n\n    // Set the value in the settings\n    this.settings[`enable${stringUtils.capitalize(type)}Button`] = toggleOption;\n\n    // If the button hasn't been rendered, don't alter the DOM.\n    if (!a) {\n      return;\n    }\n\n    // Change the DOM\n    if (toggleOption) {\n      a.disabled = false;\n      a.parentNode.classList.remove('is-disabled');\n      $(a).removeAttr('disabled');\n    } else {\n      a.disabled = true;\n      a.parentNode.classList.add('is-disabled');\n      $(a).attr('disabled', 'disabled');\n    }\n  },\n\n  /**\n   * Set or Get Current Page.\n   * @param {number|object} pagingInfo a number representing a page, or a state object with an `activePage` property\n   * @param {boolean} force Force the update\n   * @param {string} op The paging operation type.\n   * @returns {void}\n   */\n  setActivePage(pagingInfo, force, op) {\n    const useFiltering = typeof pagingInfo.searchActivePage === 'number' ||\n      typeof pagingInfo.filteredActivePage === 'number' ||\n      typeof this.filteredActivePage === 'number';\n\n    let pageNum = this.filteredActivePage || this.activePage || this.settings.activePage;\n    if (typeof pagingInfo === 'object') {\n      if (useFiltering) {\n        pageNum = pagingInfo.filteredActivePage || pagingInfo.searchActivePage;\n      } else if (pagingInfo.activePage) {\n        pageNum = pagingInfo.activePage;\n      } else {\n        pageNum = 1;\n      }\n    } else if (!isNaN(pagingInfo)) {\n      pageNum = pagingInfo;\n    }\n\n    // Set the active page interally and render the new state.\n    // If working against a filtered dataset, use the filtered active page instead of\n    // the standard one.\n    if (useFiltering) {\n      this.filteredActivePage = pageNum;\n    } else {\n      this.activePage = pageNum;\n    }\n\n    this.previousOperation = op;\n    this.render();\n\n    // If any of the following conditions are met, don't rerender the pages.\n    // Only rerender the pager bar.\n    if (pageNum === undefined ||\n        pageNum === 0 ||\n        isNaN(pageNum) ||\n        (pageNum === this.activePage && !force)) {\n      return this.activePage;\n    }\n\n    // TODO: This is datagrid specific, need to move this specifically back there\n    if (this.settings.componentAPI && this.settings.componentAPI.saveUserSettings) {\n      this.settings.componentAPI.saveUserSettings();\n    }\n\n    return pageNum;\n  },\n\n  /**\n   * Adjust an integer representing a Page Number to fit within the boundaries of the page count limits\n   * @param {number} [pageNum=1] the incoming number to be analyzed\n   * @returns {number} the adjusted value\n   */\n  adjustPageCount(pageNum) {\n    const state = this.state;\n    const useFiltering = typeof state.filteredActivePage === 'number' ||\n      typeof this.filteredActivePage === 'number';\n\n    // Never go above the total number of pages (determined internally by the state,\n    // or externally by the incoming `pagingInfo` object)\n    let totalPages = state.pages;\n    if (useFiltering && state.filteredPages) {\n      totalPages = state.filteredPages;\n    }\n\n    // If the page number provided is out of bounds, reset it to the one previously set.\n    if (pageNum < 1 || pageNum > totalPages) {\n      pageNum = this.filteredActivePage || this.activePage;\n    }\n\n    return pageNum;\n  },\n\n  /**\n  * Fires when the page size changer is used.\n  * @event pagesizechange\n  * @memberof Pager\n  * @property {object} event - The jquery event object\n  * @property {function} request - Various paging info\n  */\n  /**\n   * Get the Total Number of pages\n   * @private\n   * @param  {object} pages The pages to set.\n   * @returns {void}\n   */\n  pageCount(pages) {\n    const isShowPageSizeSelectorCall = this.isShowPageSizeSelectorCall;\n\n    // Remove call, after cached\n    delete this.isShowPageSizeSelectorCall;\n\n    if (pages === undefined && this.settings.indeterminate) {\n      this._pageCount = this.settings.pagesize; //eslint-disable-line\n    }\n\n    if (pages === undefined && !this.settings.source && !isShowPageSizeSelectorCall) {\n      return this._pageCount; //eslint-disable-line\n    }\n\n    if (pages !== undefined) {\n      this._pageCount = pages;  //eslint-disable-line\n    }\n\n    this._pageCount = this._pageCount || 1;\n    if (this.settings.indeterminate) {\n      return 999999999;\n    }\n    return this._pageCount;\n  },\n\n  /**\n   * Renders a row of numbers that can be used to select pages (Blockgrid/Listview)\n   * @returns {void}\n   */\n  renderButtons() {\n    // Only certain types of Pages get to have the `last` and `first` buttons\n    // const types = ['table', 'pageof', 'firstlast', 'standalone'];\n    // const canHaveFirstLastButtons = types.indexOf(this.settings.type) > -1 || !this.isListView;\n    let activePage = this.activePage;\n    let totalPages = this.state.pages;\n    let buttonHTML = '';\n    let doRenderFirstButton = false;\n    let doRenderPreviousButton = false;\n    let doRenderNextButton = false;\n    let doRenderLastButton = false;\n    let disableFirstButton = !this.settings.enableFirstButton;\n    let disablePreviousButton = !this.settings.enablePreviousButton;\n    let disableNextButton = !this.settings.enableNextButton;\n    let disableLastButton = !this.settings.enableLastButton;\n\n    const disableFirstIndeterminate = this.settings.indeterminate && this.firstPage === true;\n    const disableLastIndeterminate = this.settings.indeterminate && this.lastPage === true;\n    const hasDataset = (this.settings.dataset && this.settings.dataset.length);\n\n    // If this is a filtered dataset, use the `filteredTotal` instead\n    if (this.state.filteredPages) {\n      activePage = this.state.filteredActivePage;\n      totalPages = this.state.filteredPages;\n    }\n\n    // Determine whether or not special navigation buttons should eventually be rendered\n    // First Button\n    if (this.settings.showFirstButton) {\n      if (disableFirstIndeterminate || (!this.settings.indeterminate && this.settings.type !== 'standalone' && activePage === 1)) {\n        disableFirstButton = true;\n      }\n      doRenderFirstButton = true;\n    }\n    // Previous Button\n    if (this.settings.showPreviousButton) {\n      if (disableFirstIndeterminate || (!this.settings.indeterminate && this.settings.type !== 'standalone' && activePage === 1)) {\n        disablePreviousButton = true;\n      }\n      doRenderPreviousButton = true;\n    }\n    // Next Button\n    if (this.settings.showNextButton) {\n      if (disableLastIndeterminate || (!this.settings.indeterminate && this.settings.type !== 'standalone' && activePage === totalPages)) {\n        disableNextButton = true;\n      }\n      doRenderNextButton = true;\n    }\n    // Last Button\n    if (this.settings.showLastButton) {\n      if (disableLastIndeterminate || (!this.settings.indeterminate && this.settings.type !== 'standalone' && activePage === totalPages)) {\n        disableLastButton = true;\n      }\n      doRenderLastButton = true;\n    }\n\n    const AVG_BUTTON_WIDTH = 40;\n    const AVG_PAGESIZESELECTOR_WIDTH = 190;\n    const buttonsToRender = [];\n\n    const pageSizeButtonSize = this.settings.showPageSizeSelector ? AVG_PAGESIZESELECTOR_WIDTH : 0;\n    const availableButtonWidth = (this.pagerBar.width() - pageSizeButtonSize) / AVG_BUTTON_WIDTH;\n\n    // `maxAllowedButtons` does not include the Page Size Selector.\n    // Subtract an allowed number button for each set of special controls.\n    const maxAllowedButtons = Math.floor(availableButtonWidth);\n    let maxNumberButtons = maxAllowedButtons;\n    if (doRenderPreviousButton || doRenderNextButton) {\n      maxNumberButtons -= 1;\n    }\n    if (doRenderLastButton || doRenderFirstButton) {\n      maxNumberButtons -= 1;\n    }\n\n    // Disable first/last if we can display all available page numbers\n    if (!this.isTable && this.settings.type !== 'standalone' && hasDataset && maxNumberButtons >= totalPages) {\n      disableFirstButton = true;\n      disableLastButton = true;\n    }\n\n    // Figure out the distance on either side of the median value of the number button array.\n    // If either index goes out of page boundaries, shift the array to fit the same\n    // number of pages by adding to the opposite side.\n    if (!this.settings.indeterminate) {\n      const maxDistanceFromCenter = Math.floor(maxNumberButtons / 2);\n      let startIndex = activePage - maxDistanceFromCenter;\n      let endIndex = activePage + maxDistanceFromCenter;\n      while (startIndex < 1) {\n        ++startIndex;\n        if (endIndex < totalPages) {\n          ++endIndex;\n        }\n      }\n      while (endIndex > totalPages) {\n        if (startIndex > 1) {\n          --startIndex;\n        }\n        --endIndex;\n      }\n      for (let i = startIndex; i < (endIndex + 1); i++) {\n        buttonsToRender.push(i);\n      }\n    }\n\n    function renderButton(visibleContent = '', audibleContent = '', tooltipContent, targetPageNum, classAttr = '', selected = false, disabled = false, hidden = false) {\n      let isAriaSelected = '';\n      let isAriaDisabled = '';\n      let isControlDisabled = '';\n      let titleAttr = '';\n      let pageAttr = '';\n\n      if (targetPageNum) {\n        pageAttr = ` data-page=\"${targetPageNum}\"`;\n      }\n      if (hidden) {\n        classAttr += ' hidden';\n      }\n      if (selected) {\n        classAttr += ' selected';\n        isAriaSelected = ' aria-selected=\"true\"';\n        isAriaDisabled = ' aria-disabled=\"true\"';\n      }\n      if (disabled) {\n        isControlDisabled = ' disabled';\n        isAriaDisabled = ' aria-disabled=\"true\"';\n      }\n      if (tooltipContent) {\n        titleAttr = ` title=\"${tooltipContent}\"`;\n      }\n\n      const html = `<li class=\"${classAttr}\"${isAriaSelected}>\n        <a${titleAttr}${pageAttr} href=\"#\"${isAriaDisabled}${isControlDisabled}>\n          <span class=\"audible\">${audibleContent} </span>${visibleContent}\n        </a>\n      </li>`;\n\n      return html;\n    }\n\n    // Remove all existing buttons\n    $(this.numberButtons).remove();\n\n    // First Button\n    if (doRenderFirstButton) {\n      buttonHTML += renderButton($.createIcon({ icon: 'first-page' }), Locale.translate('FirstPage'), this.settings.firstPageTooltip, null, 'pager-first', false, disableFirstButton, false);\n    }\n\n    // Previous Button\n    if (doRenderPreviousButton) {\n      buttonHTML += renderButton($.createIcon({ icon: 'previous-page' }), Locale.translate('PreviousPage'), this.settings.previousPageTooltip, null, 'pager-prev', false, disablePreviousButton, false);\n    }\n\n    // Draw all relevant page numbers, if applicable\n    // Page Number Buttons are only rendered if there is visible space available to fit them.\n    if (!this.isTable && hasDataset) {\n      let numberButtonHTML = '';\n      buttonsToRender.forEach((i) => {\n        if (i === (activePage || 1)) {\n          numberButtonHTML += renderButton(i, Locale.translate('PageOn'), null, i, 'pager-no', true, false, false);\n        } else {\n          numberButtonHTML += renderButton(i, Locale.translate('Page'), null, i, 'pager-no', false, false, false);\n        }\n      });\n      buttonHTML += numberButtonHTML;\n    }\n\n    // Next Button\n    if (doRenderNextButton) {\n      buttonHTML += renderButton($.createIcon({ icon: 'next-page' }), Locale.translate('NextPage'), this.settings.nextPageTooltip, null, 'pager-next', false, disableNextButton, false);\n    }\n\n    // Last Button\n    if (doRenderLastButton) {\n      buttonHTML += renderButton($.createIcon({ icon: 'last-page' }), Locale.translate('LastPage'), this.settings.lastPageTooltip, null, 'pager-last', false, disableLastButton, false);\n    }\n\n    // Render all elements into the pager container element\n    this.pagerBar[0].innerHTML = buttonHTML;\n\n    if (!doRenderLastButton && !doRenderFirstButton && !this.settings.showPageSizeSelector) {\n      this.pagerBar[0].classList.add('two-button');\n    } else {\n      this.pagerBar[0].classList.remove('two-button');\n    }\n\n    // Invoke all sub-components\n    this.pagerBar.children('li').children('a')\n      .button()\n      .tooltip();\n  },\n\n  /**\n   * Renders an input-field based page selector (Datagrid only)\n   * @returns {void}\n   */\n  renderPageSelectorInput() {\n    if (!this.isTable || this.settings.indeterminate) {\n      return;\n    }\n\n    let activePage = this.activePage;\n    let totalPages = this.state.pages || 1;\n\n    // If this is a filtered dataset, use the `filteredTotal` instead\n    if (this.state.filteredPages) {\n      activePage = this.state.filteredActivePage;\n      totalPages = this.state.filteredPages;\n    }\n\n    if (!this.pageSelectorInput) {\n      let text = Locale.translate('PageOf');\n      text = text.replace('{0}', `<input class=\"new-mask\" name=\"pager-pageno\" value=\"${activePage}\" autocomplete=\"off\">`);\n      text = text.replace('{1}', `<span class=\"pager-total-pages\">${totalPages}</span>`);\n      $(`<li class=\"pager-count\"><label>${text} </label>`).insertAfter(this.pagerBar.find('.pager-prev'));\n    } else {\n      // Update the total number of pages\n      if (totalPages > 1) {\n        this.pagerBar.find('.pager-total-pages').text(totalPages);\n      }\n      // Update the input field's number\n      this.pagerBar.find('.pager-count input').val(activePage);\n    }\n\n    let lastValue = null;\n    const pattern = (`${totalPages}`).replace(/\\d/g, '#');\n    const self = this;\n    const maskSettings = {\n      pattern,\n      mode: 'number',\n      processOnInitialize: false\n    };\n\n    function update(elem) {\n      const newValue = self.adjustPageCount(parseInt(elem.val(), 10));\n      if (lastValue === newValue) {\n        elem.val(lastValue);\n        return;\n      }\n\n      let currentPage = self.activePage;\n      if (self.state.filteredPages) {\n        currentPage = self.state.filteredActivePage;\n      }\n      elem.val(self.setActivePage(newValue, false, 'page'));\n      self.triggerPagingEvents(currentPage);\n    }\n\n    $(this.pageSelectorInput)\n      .mask(maskSettings)\n      .on('focus', function () {\n        lastValue = parseInt($(this).val(), 10);\n      })\n      .on('blur', function () {\n        update($(this));\n        lastValue = null;\n      })\n      .on('keydown', function (e) {\n        if (e.which === 13) {\n          update($(this));\n          e.stopPropagation();\n          e.preventDefault();\n          return false;\n        }\n        return true;\n      });\n  },\n\n  /**\n   * Displays a Page Size Selector button as part of the pager bar\n   * @returns {void}\n   */\n  renderPageSizeSelectorButton() {\n    if (!this.settings.showPageSizeSelector || this.settings.pagesizes.length < 2) {\n      return;\n    }\n\n    if (!this.pageSizeSelectorButton) {\n      const pageSizeLi = $('<li class=\"pager-pagesize\"></li>');\n      const dropdownIcon = $.createIcon({ icon: 'dropdown' });\n      let translatedText = Locale.translate('RecordsPerPage').replace('{0}', this.settings.pagesize);\n      let isAudible = '';\n      let recordHtml = `<span>${translatedText}</span>`;\n\n      // Change to the condensed layout, if applicable\n      if (this.showSmallPageSizeSelector) {\n        isAudible = ' class=\"audible\"';\n        translatedText = Locale.translate('RecordsPerPage').replace('{0}', '');\n        recordHtml = `<span class=\"record-count\">${this.settings.pagesize}</span>\n        <span${isAudible}>${translatedText}</span>`;\n      }\n\n      // Render the button\n      const pageSizeButton = $(`<button type=\"button\" class=\"btn-menu\">\n        ${recordHtml}\n        ${dropdownIcon}\n      </button>`).appendTo(pageSizeLi);\n      pageSizeLi.appendTo(this.pagerBar);\n\n      // Render menu items that render available records per page\n      let menuItems = '';\n      if (this.showSmallPageSizeSelector) {\n        menuItems = `<li class=\"heading\">${translatedText}</li>`;\n      }\n      for (let k = 0; k < this.settings.pagesizes.length; k++) {\n        const size = this.settings.pagesizes[k];\n        menuItems += `<li class=\"${size === this.settings.pagesize ? ' is-checked' : ''}\"><a href=\"#\">${size}</a></li>`;\n      }\n      const menu = $(`<ul class=\"popupmenu is-selectable\">${menuItems}</ul>`);\n      pageSizeButton.after(menu);\n\n      const popupOpts = {\n        placementOpts: {\n          parent: pageSizeButton,\n          parentXAlignment: (Locale.isRTL() ? 'left' : 'right'),\n          strategies: ['flip']\n        }\n      };\n\n      pageSizeButton.popupmenu(popupOpts);\n    }\n\n    $(this.pageSizeSelectorButton).on('selected.pager', (e, args) => {\n      this.changePageSize(args);\n    });\n  },\n\n  /**\n   * Renders the contents of the pager bar\n   * @returns {void}\n   */\n  render() {\n    // Adjust Page count numbers\n    const state = this.state;\n    let totalPages = state.pages;\n    if (state.filteredPages) {\n      totalPages = state.filteredPages;\n    }\n    this.pageCount(totalPages);\n\n    this.renderButtons();\n    this.renderPageSelectorInput();\n    this.renderPageSizeSelectorButton();\n    this.renderBar();\n  },\n\n  /**\n   * Renders the pager bar based on derived or forced settings.\n   * @private\n   * @param {SohoPagingInfo} pagingInfo - an object containing information on how to render the pager.\n   * @returns {undefined}\n   */\n  renderBar(pagingInfo) {\n    if (!pagingInfo) {\n      pagingInfo = this.state;\n    } else {\n      pagingInfo = utils.extend({}, this.state, pagingInfo);\n    }\n\n    let activePage = pagingInfo.activePage;\n    if (pagingInfo.filteredActivePage) {\n      activePage = pagingInfo.filteredActivePage;\n    }\n\n    // hide buttons feature\n    if (!this.settings.showFirstButton) {\n      this.showButton('first', false);\n    }\n\n    if (!this.settings.enableFirstButton) {\n      this.enableButton('first', false);\n    }\n\n    if (!this.settings.showPreviousButton) {\n      this.showButton('previous', false);\n    }\n\n    if (!this.settings.enablePreviousButton) {\n      this.enableButton('previous', false);\n    }\n\n    if (!this.settings.showNextButton) {\n      this.showButton('next', false);\n    }\n\n    if (!this.settings.enableNextButton) {\n      this.enableButton('next', false);\n    }\n\n    if (!this.settings.showLastButton) {\n      this.showButton('last', false);\n    }\n\n    if (!this.settings.enableLastButton) {\n      this.enableButton('last', false);\n    }\n\n    if (this.settings.showPageSizeSelector) {\n      this.showPageSizeSelector(true);\n    }\n\n    // Explicit true/false when using `firstPage` or `lastPage` will force the state\n    // on the specified set of buttons to change.\n    if (pagingInfo.firstPage !== undefined) {\n      // First/Prev page\n      if (pagingInfo.firstPage === false) {\n        this.enableButton('first', true);\n        this.enableButton('previous', true);\n      }\n      if (pagingInfo.firstPage === true || activePage === 1) {\n        this.enableButton('first', false);\n        this.enableButton('previous', false);\n      }\n    }\n\n    if (pagingInfo.lastPage !== undefined) {\n      // Next/Last Page\n      if (pagingInfo.lastPage === false) {\n        this.enableButton('next', true);\n        this.enableButton('last', true);\n      }\n      if (pagingInfo.lastPage === true || activePage === this.pageCount()) {\n        this.enableButton('next', false);\n        this.enableButton('last', false);\n      }\n    }\n\n    if (this.hidePagerBar(pagingInfo)) {\n      this.pagerBar[0].classList.add('hidden');\n    }\n\n    this.initTabIndexes();\n  },\n\n  /**\n   * Sync the tabindexes\n   * @private\n   */\n  initTabIndexes() {\n    const tabbables = $(this.focusableElements);\n    tabbables.attr('tabindex', '-1');\n    tabbables.filter(':not([disabled])').first().removeAttr('tabindex');\n  },\n\n  /**\n  * Fires when the first page button is clicked.\n  * @event firstpage\n  * @memberof Pager\n  * @property {object} event - The jquery event object\n  * @property {function} request - Various paging info\n  */\n  /**\n  * Fires when the previous page button is clicked.\n  * @event previouspage\n  * @memberof Pager\n  * @property {object} event - The jquery event object\n  * @property {function} request - Various paging info\n  */\n  /**\n  * Fires when the next page button is clicked.\n  * @event nextpage\n  * @memberof Pager\n  * @property {object} event - The jquery event object\n  * @property {function} request - Various paging info\n  */\n  /**\n   *Fires when the last page button is clicked.\n   * @event lastpage\n   * @memberof Pager\n   * @property {object} event - The jquery event object\n   * @property {function} request - Various paging info\n   */\n  /**\n   * @private\n   * Triggers the `page` event, along with other special events.  Also runs associated callbacks.\n   * @param {number} [previousActivePage=undefined] if defined, sets a previous page value for determining some event triggers\n   * @returns {void}\n   */\n  triggerPagingEvents(previousActivePage) {\n    const state = this.state;\n    if (!previousActivePage) {\n      previousActivePage = this.state.activePage;\n    }\n\n    // Trigger events for specific special pages, and always trigger the `page` event\n    // containing the new pager state.\n    if (state.type === 'first') {\n      // First Page\n      if (this.settings.onFirstPage) {\n        this.settings.onFirstPage(this, state);\n      }\n      this.element.trigger('firstpage', state);\n    }\n    if (state.type === 'prev') {\n      // Previous Page\n      if (this.settings.onPreviousPage) {\n        this.settings.onPreviousPage(this, state);\n      }\n      this.element.trigger('previouspage', state);\n    }\n    if (state.type === 'next') {\n      // Next Page\n      if (this.settings.onNextPage) {\n        this.settings.onNextPage(this, state);\n      }\n      this.element.trigger('nextpage', state);\n    }\n    if (state.type === 'last') {\n      // Last Page\n      if (this.settings.onLastPage) {\n        this.settings.onLastPage(this, state);\n      }\n      this.element.trigger('lastpage', state);\n    }\n\n    if (state.type === 'pageinfo') {\n      return;\n    }\n\n    this.element.trigger('page', state);\n  },\n\n  /**\n   * Update the component and optionally apply new settings.\n   * @param  {object} settings the settings to update to.\n   * @returns {object} The plugin api for chaining.\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n    if (Array.isArray(settings.pagesizes) && settings.pagesizes.length) {\n      this.settings.pagesizes = settings.pagesizes;\n    }\n\n    // Limit updated paging info to a specific subset\n    const pagingInfo = {\n      activePage: this.settings.activePage,\n      indeterminate: this.settings.indeterminate,\n      pagesize: this.settings.pagesize\n    };\n\n    this.updatePagingInfo(pagingInfo);\n    return this;\n  },\n\n  /**\n   * Changes the size of the visible page\n   * @param {jQuery} anchor containing a reference to the jQuery-wrapped popupmenu menu item element that was chosen.\n   * @returns {void}\n   */\n  changePageSize(anchor) {\n    const tag = anchor;\n    tag.closest('.popupmenu').find('.is-checked').removeClass('is-checked');\n    tag.parent('li').addClass('is-checked');\n    this.settings.pagesize = parseInt(tag.text(), 10);\n\n    if (this.settings.componentAPI) {\n      this.settings.componentAPI.settings.pagesize = this.settings.pagesize;\n    }\n    this.setActivePage(1, true, 'first');\n\n    if (this.settings.onPageSizeChange) {\n      this.settings.onPageSizeChange(this, {\n        tag: anchor,\n        pagesize: this.settings.pagesize,\n        settings: this.settings\n      });\n    }\n\n    this.element.trigger('pagesizechange', {\n      tag: anchor,\n      pagesize: this.settings.pagesize,\n      settings: this.settings\n    });\n  },\n\n  /**\n   * Updates this instance of pager with externally-provided settings.\n   * @param {object} pagingInfo - contains settings that will change buttons on the pager.\n   * @param {number} pagingInfo.pagesize - the number of items visible per page\n   * @param {number} pagingInfo.total - the total number of pages\n   * @param {number} pagingInfo.activePage - the currently visible page\n   * @param {boolean} [pagingInfo.firstPage=false] - passed if the currently visible page is the\n   * first one\n   * @param {boolean} [pagingInfo.lastPage=false] - passed if the currently visible page is the\n   * last one\n   * @param {boolean} [pagingInfo.hideDisabledPagers=false] - causes the pager to become completely\n   * hidden if all buttons are disabled\n   * @param {boolean} [isResponse=false] if true, causes events not to be triggered (avoids infinite loops)\n   * @returns {void}\n   */\n  updatePagingInfo(pagingInfo, isResponse) {\n    if (!pagingInfo) {\n      return;\n    }\n\n    // Grab and retain the pagesize\n    if (pagingInfo.pagesize) {\n      this.settings.pagesize = pagingInfo.pagesize;\n      if (this.isTable && this.settings.componentAPI) {\n        this.settings.componentAPI.settings.pagesize = pagingInfo.pagesize;\n      }\n    }\n\n    // Detect client-side filtering in the other component's API\n    if (pagingInfo.isFilteredClientside) {\n      this.isFilteredClientside = true;\n      delete this.serverDatasetTotal;\n    } else if (this.isFilteredClientside) {\n      delete this.isFilteredClientside;\n    }\n\n    // Explicitly setting `firstPage` or `lastPage` to true/false will cause pager buttons\n    // to be forced enabled/disabled\n    delete this.firstPage;\n    delete this.lastPage;\n    if (pagingInfo.firstPage !== undefined) {\n      this.firstPage = pagingInfo.firstPage;\n      this.settings.enableFirstButton = !pagingInfo.firstPage;\n      this.settings.enablePreviousButton = !pagingInfo.firstPage;\n    }\n    if (pagingInfo.lastPage !== undefined) {\n      this.lastPage = pagingInfo.lastPage;\n      this.settings.enableNextButton = !pagingInfo.lastPage;\n      this.settings.enableLastButton = !pagingInfo.lastPage;\n    }\n\n    // Track \"grandTotal\" for all records, including filtered-out, if applicable\n    if (!isNaN(pagingInfo.grandTotal)) {\n      this.grandTotal = pagingInfo.grandTotal;\n    }\n\n    // For server-side paging, retain a separate \"total\" for the server dataset.\n    if (!this.isFilteredClientside) {\n      this.serverDatasetTotal = pagingInfo.total;\n    }\n\n    // If the dataset is filtered, store some extra meta-data for the state.\n    if (!isNaN(pagingInfo.filteredTotal)) {\n      this.filteredTotal = pagingInfo.filteredTotal;\n      this.filteredActivePage = pagingInfo.searchActivePage || pagingInfo.filteredActivePage || 1;\n    } else if (this.filteredTotal || this.filteredActivePage) {\n      delete this.filteredTotal;\n      delete this.filteredActivePage;\n    }\n\n    if (!pagingInfo.type) {\n      pagingInfo.type = 'pageinfo';\n    }\n\n    if (this.settings.source || this.settings.dataset) {\n      // Set first and last page if passed\n      // If we get a page number as a result, rendering has already happened and\n      // we should not attempt to re-render.\n      this.setActivePage(pagingInfo, false, pagingInfo.type);\n      if (pagingInfo.type !== 'initial' && !isResponse) {\n        this.triggerPagingEvents();\n      }\n      return;\n    }\n\n    this.teardown();\n    this.render();\n    this.handleEvents();\n  },\n\n  /**\n   * Reclaim the pager height so that datagrid can use it's full container, if only one page.\n   * @private\n   * @param  {object} pagingInfo The pager states.\n   * @returns {void}\n   */\n  hidePagerBar(pagingInfo) {\n    if (this.settings.hideOnOnePage && pagingInfo.total <= pagingInfo.pagesize) {\n      return true;\n    }\n\n    if ((pagingInfo.firstPage === true && pagingInfo.lastPage === true) &&\n      pagingInfo.hideDisabledPagers) {\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * Removes all event listeners and generated HTML markup from the pager instance\n   * @returns {void}\n   */\n  teardown() {\n    if (this.numberButtons) {\n      this.numberButtons.forEach((li) => {\n        const a = li.querySelector('a');\n        const buttonAPI = $(a).data('button');\n        const tooltipAPI = $(a).data('tooltip');\n\n        if (buttonAPI) {\n          buttonAPI.destroy();\n        }\n        if (tooltipAPI) {\n          tooltipAPI.destroy();\n        }\n      });\n    }\n\n    this.pagerBar.off([\n      `click.${COMPONENT_NAME}`,\n      `keydown.${COMPONENT_NAME}`\n    ].join(' '));\n\n    if (this.pageSelectorInput) {\n      $(this.pageSelectorInput).off([\n        `focus.${COMPONENT_NAME}`,\n        `blur.${COMPONENT_NAME}`,\n        `keydown.${COMPONENT_NAME}`\n      ].join(' '));\n      $(this.pageSelectorInput).data('mask').destroy();\n    }\n\n    if (this.pageSizeSelectorButton) {\n      $(this.pageSizeSelectorButton).off(`selected.${COMPONENT_NAME}`);\n      $(this.pageSizeSelectorButton).data('popupmenu').destroy();\n    }\n\n    this.pagerBar[0].innerHTML = '';\n\n    delete this.firstPage;\n    delete this.lastPage;\n  },\n\n  /**\n   * Tear down and detatch all events\n   */\n  destroy() {\n    this.teardown();\n    if (this.pagerBar) {\n      this.pagerBar.remove();\n    }\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Pager, COMPONENT_NAME };\n","import { Pager, COMPONENT_NAME } from './pager';\n\n/**\n * jQuery Component Wrapper for pager\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.pager = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (!instance) {\n      instance = $.data(this, COMPONENT_NAME, new Pager(this, settings));\n    } else {\n      instance.updated(settings);\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { deprecateMethod } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { stringUtils as str } from '../../utils/string';\nimport { Tmpl } from '../tmpl/tmpl';\nimport { ListFilter } from '../listfilter/listfilter';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../../utils/animations';\nimport '../pager/pager.jquery';\nimport '../popupmenu/popupmenu.jquery';\nimport '../searchfield/searchfield.jquery';\nimport '../emptymessage/emptymessage.jquery';\n\nconst COMPONENT_NAME = 'listview';\n\n/**\n * Creates lists of small pieces of relevant, actionable information.\n * @class ListView\n * @constructor\n *\n * @param {jquery[]|htmlelement} element the base element\n * @param {object} [settings] incoming settings\n * @param {array} [settings.dataset] Array of data to feed the template\n * @param {string} [settings.template] Html Template String\n * @param {string} [settings.description] Audible Label (or use parent title)\n * @param {boolean} [settings.paging=false] If true, activates paging\n * @param {number} [settings.pagesize=10] If paging is activated, sets the number of listview items available per page\n * @param {boolean} [settings.searchable=false] If true, associates itself with a Searchfield/Autocomplete and allows itself to be filtered\n * @param {boolean} [settings.highlight=true] If false the highlighting of text when using searchable is disabled. You may want to disable this on larger lists.\n * @param {string|boolean} [settings.selectable='single'] selection mode, can be false, 'single', 'multiple' or 'mixed'\n * @param {boolean} [settings.selectOnFocus=true] If true the first item in the list will be selected as it is focused.\n * @param {boolean} [settings.showCheckboxes=true] If false will not show checkboxes used with multiple selection mode only\n * @param {boolean} [settings.hoverable=true] If true the list element will show a hover action to indicate its actionable.\n * @param {string} [settings.emptyMessage] Text to go in emptyMessage.\n * @param {function|string} [settings.source] If source is a string then it serves as\n  the url for an ajax call that returns the dataset. If its a function it is a call back for getting the data asyncronously.\n * @param {boolean} [settings.forceToRenderOnEmptyDs=false] If true list will render as an empty list with ul tag, but not any li tags in it.\n * @param {boolean} [settings.disableItemDeactivation=false] If true when an item is\n  activated the user should not be able to deactivate it by clicking on the activated item. They can only select another row.\n * @param {boolean} [settings.showPageSizeSelector=false] If true the page size select will be shown when paging.\n * @param {object} [settings.listFilterSettings=null] If defined as an object, passes settings into the internal ListFilter component\n * @param {object} [settings.pagerSettings=null] If defined as an object, passes settings into the internal Pager component\n */\nconst LISTVIEW_DEFAULTS = {\n  dataset: [],\n  template: null,\n  description: null,\n  paging: false,\n  pagesize: 10,\n  searchable: false,\n  highlight: true,\n  selectable: 'single',\n  selectOnFocus: true,\n  showCheckboxes: true,\n  hoverable: true,\n  emptyMessage: null,\n  source: null,\n  forceToRenderOnEmptyDs: false,\n  disableItemDeactivation: false,\n  showPageSizeSelector: false,\n  listFilterSettings: null,\n  pagerSettings: {\n    showFirstButton: false,\n    showLastButton: false\n  }\n};\n\nfunction ListView(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, LISTVIEW_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n\n  return this;\n}\n\nListView.prototype = {\n\n  /**\n   * @returns {Pager|undefined} Pager component instance, if one exists\n   */\n  get pagerAPI() {\n    return this.element.data('pager');\n  },\n\n  /**\n   * @returns {object} containing valid Pager Component settings\n   */\n  get pagerSettings() {\n    let pagerSettings = {};\n    if (this.settings.pagerSettings) {\n      pagerSettings = this.settings.pagerSettings;\n    }\n    pagerSettings.dataset = this.settings.dataset;\n    pagerSettings.source = this.settings.source;\n    pagerSettings.type = 'list';\n\n    // Backwards compatibility for direct pager settings\n    const oldSettingTypes = ['pagesize', 'showPageSizeSelector'];\n    for (let i = 0; i < oldSettingTypes.length; i++) {\n      if (this.settings[oldSettingTypes[i]] !== undefined && !pagerSettings[oldSettingTypes[i]]) {\n        pagerSettings[oldSettingTypes[i]] = this.settings[oldSettingTypes[i]];\n      }\n    }\n\n    return pagerSettings;\n  },\n\n  /**\n   * Initialize this component.\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.setup();\n    this.handleEvents();\n    this.refresh();\n    this.selectedItems = [];\n    this.lastSelectedItem = 0; // Rember index to use shift key\n    this.isSelectedAll = false; // Rember if all selected or not\n    this.sortInit('listview', 'click.listview', 'data-sortlist');\n    this.handleResize();\n  },\n\n  /**\n   * Do initial dom and settings setup.\n   * @private\n   * @returns {void}\n   */\n  setup() {\n    const self = this;\n    const card = this.element.closest('.card, .widget');\n    const selectable = this.element.attr('data-selectable');\n    const selectOnFocus = this.element.attr('data-select-onfocus');\n\n    // Check for legacy data attributes\n    if (this.element.attr('data-pagesize')) {\n      const pagesize = Number(this.element.attr('data-pagesize'));\n      if (!isNaN(pagesize)) {\n        this.settings.pagesize = pagesize;\n      }\n      this.element.removeAttr('data-pagesize');\n    }\n\n    // Convert a DOM-based list into a stored dataset (legacy)\n    if (!this.settings.dataset.length) {\n      if (this.element.is('ul') && this.element.children('li').length) {\n        const items = this.element.children('li');\n        if (!this.settings.template) {\n          this.settings.template = '{{#dataset}}<li>{{text}}</li>{{/dataset}}';\n        }\n        items.each((i, item) => {\n          this.settings.dataset.push({ text: $(item).text() });\n        });\n        items.remove();\n      }\n    }\n\n    // Search the global variable space for a dataset variable name, if provided.\n    if (this.settings.dataset && typeof this.settings.dataset === 'string') {\n      const globalDataset = window[this.settings.dataset];\n      if (globalDataset && globalDataset.length) {\n        this.settings.dataset = globalDataset;\n      }\n    }\n\n    if (selectable && selectable.length) {\n      this.settings.selectable = selectable;\n    }\n\n    if (selectOnFocus && selectOnFocus.length) {\n      this.settings.selectOnFocus = JSON.parse(selectOnFocus);\n    }\n\n    self.actionButton = card.find('.btn-actions');\n\n    if (self.actionButton.length > 0) {\n      // Action Buttons may already be invoked via initialize.js.\n      if (!(self.actionButton.data('popupmenu'))) {\n        self.actionButton.popupmenu();\n      }\n    }\n\n    this.element.attr({ tabindex: '-1', 'x-ms-format-detection': 'none' });\n\n    // Configure Paging\n    if (this.element.is('.paginated') || this.settings.paging === true) {\n      this.element.pager(this.pagerSettings);\n    }\n\n    const cardWidgetContent = this.element.parent('.card-content, .widget-content');\n    if (cardWidgetContent[0]) {\n      cardWidgetContent[0].style.overflow = 'hidden';\n    }\n\n    // Add Aria Roles\n    this.element.attr({\n      role: 'listbox',\n      'aria-label': this.settings.description || card.find('.card-title, .widget-title').text()\n    });\n\n    // Associate with an existing searchfield, if applicable\n    if (this.settings.searchable) {\n      this.searchfield = this.element.parent().find('.searchfield, .autocomplete');\n\n      if (!this.searchfield.length) {\n        // TODO: Create Searchfield somehow\n      }\n\n      // Setup the ListFilter with externally-defined settings, if applicable\n      let listFilterSettings = {\n        filterMode: 'contains'\n      };\n      if (typeof this.settings.listFilterSettings === 'object') {\n        listFilterSettings = utils.extend({}, listFilterSettings, this.settings.listFilterSettings);\n      }\n\n      this.listfilter = new ListFilter(listFilterSettings);\n    }\n\n    if (this.settings.emptyMessage) {\n      // Object { title: \"No Data Available\", info: \"\", icon: \"icon-empty-no-data\" }\n      self.emptyMessageContainer = $('<div>').emptymessage(this.settings.emptyMessage);\n    }\n  },\n\n  /**\n   * Calculate the totals for totalling examples.\n   * This is displayed in the template by referencing {{totals}}.\n   * @private\n   * @param {array} dataset the incoming dataset\n   * @returns {number} the total number of listview items.\n   */\n  getTotals(dataset) {\n    const totals = { count: dataset.length };\n    let property;\n\n    if (!dataset[0]) {\n      return undefined;\n    }\n\n    for (property in dataset[0]) { //eslint-disable-line\n      totals[property] = 0;\n    }\n\n    for (let i = 0; i < dataset.length; i++) {\n      for (property in dataset[i]) { //eslint-disable-line\n        totals[property] += parseFloat(dataset[i][property]);\n      }\n    }\n    return totals;\n  },\n\n  /**\n   * Render the template against the dataset.\n   * @private\n   * @param {array} dataset  The dataset to use\n   * @param {object} pagerInfo  Pager instructions\n   */\n  render(dataset, pagerInfo) {\n    const self = this;\n    const isServerSide = typeof this.settings.source === 'function';\n    let totals = {};\n    let displayedDataset = dataset;\n    let firstRecordIdx = 0;\n    let lastRecordIdx = displayedDataset ? displayedDataset.length : 0;\n    let pagesize = this.settings.pagesize;\n    let setSize = dataset.length;\n\n    if (pagerInfo) {\n      pagesize = pagerInfo.pagesize || pagesize;\n      setSize = pagerInfo.filteredTotal || setSize;\n    }\n\n    if (!isServerSide && this.pagerAPI) {\n      this.renderPager(pagerInfo, true);\n      pagerInfo = this.pagerAPI.state;\n    }\n\n    // If the paging information sets limits on the dataset, customize the\n    // displayed dataset to fit the conditions.\n    if (setSize > pagesize) {\n      const pages = this.filteredDataset ? pagerInfo.filteredPages : pagerInfo.pages;\n      if (pages > 1) {\n        let trueActivePage = pagerInfo.activePage > 0 ? pagerInfo.activePage - 1 : 0;\n        if (this.filteredDataset) {\n          trueActivePage = pagerInfo.filteredActivePage - 1;\n        }\n        firstRecordIdx = pagerInfo.pagesize * trueActivePage;\n        lastRecordIdx = pagerInfo.pagesize * (trueActivePage + 1);\n        displayedDataset = dataset.slice(firstRecordIdx, lastRecordIdx);\n      }\n    }\n\n    // Render \"mustache\" Template\n    if (typeof Tmpl === 'object' && displayedDataset && this.settings.template) {\n      // create a copy of an inlined template\n      if (this.settings.template instanceof $) {\n        this.settings.template = `${this.settings.template.html()}`;\n      } else if (typeof this.settings.template === 'string') {\n        // If a string doesn't contain HTML elments,\n        // assume it's an element ID string and attempt to select with jQuery\n        if (!str.containsHTML(this.settings.template)) {\n          this.settings.template = $(`#${this.settings.template}`).html();\n        }\n      }\n\n      if (this.settings.template.indexOf('{{#totals}}') > -1) {\n        totals = this.getTotals(dataset);\n      }\n\n      const renderedTmpl = Tmpl.compile(this.settings.template, {\n        dataset: displayedDataset,\n        totals\n      });\n\n      if (displayedDataset.length > 0 || this.settings.forceToRenderOnEmptyDs) {\n        this.element.html(renderedTmpl);\n      } else if (self.emptyMessageContainer) {\n        this.element.empty();\n        DOM.append(this.element, this.emptyMessageContainer[0].outerHTML, '<div><svg><use><span><b>');\n      } else if (displayedDataset.length === 0) {\n        this.element.html(renderedTmpl || '<ul></ul>');\n      }\n    }\n\n    // Add Aria\n    $('ul', this.element).attr({ role: 'presentation' });\n\n    // Add Checkboxes\n    const first = this.element.find('li, tbody > tr').first();\n    const items = this.element.find('li, tr');\n    const isMultiselect = (this.settings.selectable === 'multiple' || this.settings.selectable === 'mixed');\n\n    // Set Initial Tab Index\n    this.focusItem = first.attr('tabindex', 0);\n\n    // Let the link be focus'd\n    if (!this.settings.selectable && first.find('a').length === 1) {\n      first.removeAttr('tabindex');\n    }\n\n    items.each(function (i) {\n      const item = $(this);\n\n      item.attr('role', 'option');\n\n      if (isMultiselect) {\n        // Add Selection Checkboxes\n        self.element.addClass('is-multiselect');\n\n        // Create a Toolbar for the \"Selected Items\" area\n        const selectedToolbar = self.element.prevAll('.toolbar');\n        if (selectedToolbar.length && selectedToolbar.data('toolbar')) {\n          selectedToolbar.data('toolbar').toggleMoreMenu();\n        }\n\n        if (self.settings.showCheckboxes) {\n          // For mixed selection mode primarily append a checkbox object\n          item.prepend('<label class=\"listview-selection-checkbox l-vertical-center inline inline-checkbox\"><input tabindex=\"-1\" type=\"checkbox\" class=\"checkbox\"><span class=\"label-text\">&nbsp;</span></label>');\n        }\n      }\n\n      // Add Aria\n      item.attr({ 'aria-posinset': (firstRecordIdx + i + 1), 'aria-setsize': setSize });\n\n      // Add Aria disabled\n      if (item.hasClass('is-disabled')) {\n        item.attr('aria-disabled', 'true');\n      }\n\n      // If this dataset is filtered, hightlight the relevant search term inside the element.\n      if (self.settings.highlight && self.searchTerm) {\n        item.highlight(self.searchTerm);\n      }\n    });\n\n    // TODO: Invoke the \"element\" here after we write an updated method.\n    this.element.children().initialize();\n\n    /**\n     * Fires after the listbox is fully rendered.\n     *\n     * @event rendered\n     * @memberof ListView\n     * @property {object} event - The jquery event object\n     * @property {array} dataset .\n     */\n    this.element.trigger('rendered', [displayedDataset]);\n\n    // Handle refresh\n    this.element.off('updated.listview').on('updated.listview', (e, settings) => {\n      self.updated(settings);\n    });\n  },\n\n  /**\n   * Add and update the pager (if used)\n   * @private\n   * @param {object} updatedPagerInfo contains updated paging settings\n   * @param {boolean} isResponse represents whether or not this render call was caused by an AJAX response\n   * @returns {void}\n   */\n  renderPager(updatedPagerInfo, isResponse) {\n    if (!this.pagerAPI) {\n      return;\n    }\n\n    this.pagerAPI.updatePagingInfo(updatedPagerInfo, isResponse);\n  },\n\n  /**\n   * Reliably gets all the pre-rendered elements in the container and returns them for use.\n   * @private\n   * @returns {array} TThe pagable items\n   */\n  getPageableElements() {\n    let elements = this.element.children();\n\n    // Adjust for cases where the root is a <ul>\n    if (elements.is('ul')) {\n      elements = elements.children();\n    }\n\n    return elements;\n  },\n\n  /**\n   * Get the Data Source. Can be an array, Object or Url and render the list.\n   * @private\n   * @param {array} dataset contains a potential new dataset to display inside the listview.\n   * @param {object} [pagingInfo=undefined] information about desired pager state\n   */\n  refresh(dataset, pagingInfo) {\n    this.loadData(dataset, pagingInfo);\n\n    if (this.list) {\n      this.render(this.list.data);\n    }\n  },\n\n  /**\n   * Load Data from an external API\n   * @param {object} ds  The dataset to use or will use settings.dataset.\n   * @param {object} pagerInfo  The pager settings to use (see pager api)\n   * @param {boolean} isResponse Flag used to avoid dup source calls.\n   * @returns {void}\n   */\n  loadData(ds, pagerInfo, isResponse) {\n    let ajaxDs = false;\n    const self = this;\n\n    ds = ds || this.settings.dataset;\n    if (this.filteredDataset) {\n      ds = this.filteredDataset;\n    }\n\n    if (!pagerInfo) {\n      if (this.pagerAPI) {\n        if (ds.length !== this.pagerAPI.settings.dataset.length) {\n          this.pagerAPI.updated({\n            dataset: ds\n          });\n        }\n        pagerInfo = this.pagerAPI.state;\n      } else {\n        pagerInfo = {\n          activePage: 1\n        };\n      }\n    }\n\n    if (this.filteredDataset) {\n      pagerInfo.filteredTotal = ds.length;\n    } else {\n      pagerInfo.total = ds.length;\n    }\n\n    if (!Array.isArray(ds)) {\n      return;\n    }\n\n    function done(response, pagingInfo) {\n      self.settings.dataset = response;\n      ds = response;\n      const activePage = self.pagerAPI ? self.pagerAPI.activePage : 1;\n\n      if (typeof pagingInfo === 'string') {\n        pagingInfo = {\n          activePage,\n          pagesize: self.settings.pagesize,\n          total: ds.length,\n          type: pagingInfo\n        };\n      }\n\n      if (self.pagerAPI) {\n        self.renderPager(pagingInfo, true);\n        pagingInfo = self.pagerAPI.state;\n      }\n      self.render(ds, pagingInfo);\n    }\n\n    let s = this.settings.source;\n\n    if (typeof ds === 'string' && (ds.indexOf('http') === 0 || ds.indexOf('/') === 0)) {\n      s = ds;\n      ajaxDs = true;\n    }\n\n    // If paging is not active, and a source is present, attempt to retrieve\n    // information from the datasource.\n    // TODO: Potentially abstract this datasource concept out for use elsewhere\n    if ((s || ajaxDs) && !this.filteredDataset && !isResponse) {\n      switch (typeof s) {\n        case 'function':\n          s(pagerInfo, done);\n          break;\n        case 'string':\n          if (s.indexOf('http') === 0 || s.indexOf('/') === 0) {\n            $.getJSON(s, done);\n          }\n          return;\n        default:\n          this.settings.dataset = s;\n          ds = s;\n          this.render(s, pagerInfo);\n          break;\n      }\n      return;\n    }\n\n    // Otherwise, simply render with the existing dataset\n    this.render(ds, pagerInfo);\n  },\n\n  /**\n   * Toggle all items from selected to deselected, useful for multi/mixed selection\n   * @returns {void}\n   */\n  toggleAll() {\n    this[this.isSelectedAll ?\n      'deselectItemsBetweenIndexes' :\n      'selectItemsBetweenIndexes']([0, $('li, tbody tr', this.element).length - 1]);\n    this.isSelectedAll = !this.isSelectedAll;\n  },\n\n  /**\n   * Select Items between a set of indexes. Used for shift selection.\n   * @private\n   * @param {array} indexes an array containing two numeric indicies that will\n   *  be used to make a selection.\n   * @returns {void}\n   */\n  selectItemsBetweenIndexes(indexes) {\n    this.clearSelection();\n    indexes.sort((a, b) => a - b);\n    for (let i = indexes[0]; i <= indexes[1]; i++) {\n      const item = $('li, tbody tr', this.element).eq(i);\n\n      if (!item.is('.is-disabled, .is-selected')) {\n        this.select(item);\n      }\n    }\n  },\n\n  /**\n  * De-Select Items between a set of indexes. Used for shift selection.\n  * @private\n  * @param {array} indexes an array containing two numeric indicies that will\n  *  be used to deselect.\n  * @returns {void}\n  */\n  deselectItemsBetweenIndexes(indexes) {\n    indexes.sort((a, b) => a - b);\n    for (let i = indexes[0]; i <= indexes[1]; i++) {\n      const item = $('li, tbody tr', this.element).eq(i);\n      if (!item.is('.is-disabled') && item.is('.is-selected')) {\n        this.select(item);\n      }\n    }\n  },\n\n  /**\n  * Clear all currently selected list items.\n  * @private\n  * @returns {void}\n  */\n  clearSelection() {\n    if (window.getSelection) {\n      window.getSelection().removeAllRanges();\n    } else if (document.selection) {\n      document.selection.empty();\n    }\n  },\n\n  /**\n  * Handle page/form resize\n  * @private\n  * @returns {void}\n  */\n  handleResize() {\n    const items = $('li .listview-heading, tr .listview-heading', this.element);\n    const item1 = items.eq(1);\n    const item1W = item1.width();\n\n    if (item1.length && item1W) {\n      items[0].style.width = `${item1W}px`;\n    }\n\n    if (this.pagerAPI) {\n      this.pagerAPI.render();\n    }\n  },\n\n  /**\n   * @private\n   * @param {jquery.event} e custom jQuery `contents-checked` event.\n   * @param {jquery[]} searchfield the element representing a searchfield.\n   * @returns {void}\n   */\n  handleSearch(e, searchfield) {\n    this.filter(searchfield);\n  },\n\n  /**\n   * Filters the contents of Listviews that are paired with a Searchfield.\n   * @param {jquery[]} searchfield the element representing a searchfield.\n   * @returns {void}\n   */\n  filter(searchfield) {\n    if (!searchfield) {\n      return;\n    }\n\n    searchfield = $(searchfield);\n\n    // Get the search string and trim whitespace\n    const searchFieldVal = searchfield.val().trim();\n    const pagingInfo = {\n      searchActivePage: 1\n    };\n\n    // Clear\n    if (!searchFieldVal) {\n      if (!this.searchTerm) {\n        return;\n      }\n      this.resetSearch();\n      return;\n    }\n\n    // Make sure there is a search term...and its not the\n    // same as the previous term\n    if (searchFieldVal.length < 2 || this.searchTerm === searchFieldVal) {\n      return;\n    }\n\n    // Set a global \"searchTerm\" and get the list of elements\n    this.searchTerm = searchFieldVal;\n\n    // Filter the results and highlight things\n    let results = this.listfilter.filter(this.settings.dataset, this.searchTerm);\n    if (!results.length) {\n      results = [];\n    }\n    pagingInfo.filteredTotal = results.length;\n    pagingInfo.searchActivePage = 1;\n    results.forEach((result) => {\n      result.isFiltered = true;\n    });\n\n    this.filteredDataset = results;\n    this.loadData(null, pagingInfo);\n\n    /**\n     * Fires after filtering the list.\n     * @event filtered\n     * @memberof ListView\n     * @property {object} event - The jquery event object\n     * @property {object} args.elem The list element\n     * @property {array} args.filteredResults The filter list items\n     * @property {term} args.term The search term used.\n     */\n    this.element.trigger('filtered', { elem: this.element, filteredResults: results, term: this.searchTerm });\n  },\n\n  /**\n   * Reset the current search parameters and highlight.\n   * @private\n   * @returns {void}\n   */\n  resetSearch() {\n    if (this.filteredDataset) {\n      delete this.filteredDataset;\n    }\n    if (this.searchTerm) {\n      delete this.searchTerm;\n    }\n\n    const pagingInfo = {\n      activePage: 1,\n      filteredTotal: undefined,\n      searchActivePage: undefined\n    };\n\n    this.refresh(null, pagingInfo);\n  },\n\n  /**\n   * Focus the provided list item with the keyboard\n   * @private\n   * @param {jquery} item  The list item (as jQuery) to focus\n   * @returns {void}\n   */\n  focus(item) {\n    if (item.is(':hidden') || item.is('.is-disabled')) {\n      return;\n    }\n\n    if (this.focusItem) {\n      this.focusItem.removeAttr('tabindex');\n    }\n    this.focusItem = item.attr('tabindex', 0).focus();\n\n    if (!this.settings.selectable && item.find('a').length === 1) {\n      item.find('a').focus();\n      item.removeAttr('tabindex');\n    }\n\n    if (this.settings.selectOnFocus &&\n      this.settings.selectable !== 'multiple' &&\n      this.settings.selectable !== 'mixed') {\n      this.select(item);\n    }\n  },\n\n  /**\n   * Remove the given list item.\n   * @param {jquery|number} li Either the actually jQuery list element or a zero based index\n   * @returns {void}\n   */\n  remove(li) {\n    if (typeof li === 'number') {\n      li = $(this.element.children()[0]).children().eq(li);\n    }\n    // Un-select selected item\n    // and donot trigger selected event, sinnce we removeing\n    if (li.is('.is-selected')) {\n      this.select(li, true);\n    }\n    li.remove();\n  },\n\n  /**\n   * Remove all list items.\n   * @returns {void}\n   */\n  clear() {\n    const root = $(this.element.children()[0]);\n    root.empty();\n  },\n\n  /**\n   * Remove all selected items entirely from the list.\n   * @returns {void}\n   */\n  removeAllSelected() {\n    const self = this;\n    $.each(this.selectedItems, (index, selected) => {\n      self.remove(selected);\n    });\n  },\n\n  /**\n   * Deselect all selected items.\n   * @returns {void}\n   */\n  clearAllSelected() {\n    const self = this;\n    $.each(this.selectedItems, (index, selected) => {\n      // Un-select selected item\n      self.select(selected);\n    });\n  },\n\n  /**\n   * Initialize the sorted list\n   * @private\n   * @param {string} control component name\n   * @param {string} onEvent the name of the event to sort on\n   * @param {string} attr the name of the HTML attribute to retrieve options from.\n   * @returns {void}\n   */\n  sortInit(control, onEvent, attr) {\n    if (!attr || $.trim(attr) === '') {\n      return;\n    }\n    $(`[${attr}]`).each(function () {\n      const element = $(this);\n      const options = $.fn.parseOptions(element, attr);\n\n      element.on(onEvent, (e) => {\n        $(options.list).data(control).setSortColumn(options);\n        e.preventDefault();\n      });\n    });\n  },\n\n  /**\n  * Sort the list with the given options.\n  * @private\n  * @param {object} [options] incoming sort options\n  * @returns {void}\n  */\n  setSortColumn(options) {\n    let field = options.orderBy || this.list.sort.field;\n    let reverse = options.order;\n\n    if (!this.list.data && !field) {\n      return;\n    }\n\n    reverse = reverse ?\n      (reverse === 'desc') :\n      !((this.list.sort && this.list.sort[field] && this.list.sort[field].reverse));\n\n    // reload data\n    if (options.reloadApi || options.reloadApiNoSort) {\n      this.loadData();\n    }\n\n    // reload data but no sort change\n    if (options.reloadApiNoSort) {\n      field = this.list.sort.field;\n      reverse = this.list.sort[field].reverse;\n    }\n\n    const sort = this.sortFunction(field, reverse);\n    this.list.data.sort(sort);\n    this.render(this.list.data);\n\n    this.list.sort = { field };\n    this.list.sort[field] = { reverse };\n    /**\n     * Fires after sorting the list.\n     *\n     * @event sorted\n     * @memberof ListView\n     * @property {object} event - The jquery event object\n     * @property {object} this.element\n     * @property {string} this.list.sort\n     */\n    this.element.trigger('sorted', [this.element, this.list.sort]);\n  },\n\n  /**\n  * Overridable function to conduct sorting\n  * @private\n  * @param {string} field  The field in the dataset to sort on.\n  * @param {string} reverse  If true sort descending.\n  * @param {function} primer  A sorting primer function.\n  * @returns {function} a customized sorting algorithm\n  */\n  sortFunction(field, reverse, primer) {\n    if (!primer) {\n      primer = function (a) {\n        a = (a === undefined || a === null ? '' : a);\n        if (typeof a === 'string') {\n          a = a.toUpperCase();\n\n          if (!isNaN(parseFloat(a))) {\n            a = parseFloat(a);\n          }\n        }\n        return a;\n      };\n    }\n\n    const key = primer ? function (x) { return primer(x[field]); } :\n      function (x) { return x[field]; };\n\n    reverse = !reverse ? 1 : -1;\n\n    return function (a, b) {\n      return a = key(a), b = key(b), reverse * ((a > b) - (b > a)); //eslint-disable-line\n    };\n  },\n\n  /**\n  * Deselect the given list item.\n  * @param {jquery[]|number} li  Either the actually jQuery list element or a zero based index\n  */\n  deselect(li) {\n    if (typeof li === 'number') {\n      li = $(this.element.children()[0]).children().eq(li);\n    }\n    if (li.is('.is-selected')) {\n      this.select(li);\n    }\n  },\n\n  /**\n   * Deselect the given list item.\n   * This method is slated to be removed in a future v4.9.0 or v5.0.0.\n   * @deprecated as of v4.3.0. Please use `deselect()` instead.\n   * @param {jquery[]|number} li a list item\n   * @returns {void}\n   */\n  unselect(li) {\n    return deprecateMethod(this.deselect, this.unselect).apply(this, [li]);\n  },\n\n  /**\n   * Select the given list item.\n   * @param {jquery|number} li Either the actually jQuery list element or a zero based index\n   * @param {boolean} noTrigger Do not trigger the selected event.\n   */\n  select(li, noTrigger) {\n    const self = this;\n    let isChecked = false;\n    const isMixed = self.settings.selectable === 'mixed';\n\n    self.selectedItems = [];\n    if (typeof li === 'number') {\n      li = $(this.element.children()[0]).children().eq(li);\n    }\n\n    isChecked = li.hasClass('is-selected');\n\n    // focus\n    if (!li.is('[tabindex=\"0\"]')) {\n      if (this.focusItem) {\n        this.focusItem.removeAttr('tabindex');\n      }\n      li.attr('tabindex', 0);\n    }\n\n    if (this.settings.selectable === false || this.settings.selectable === 'false') {\n      return;\n    }\n\n    // Select\n    if (this.settings.selectable !== 'multiple' && this.settings.selectable !== 'mixed') {\n      li.parent().children().removeAttr('aria-selected');\n      li.parent().find('.is-selected').removeClass('is-selected');\n      self.selectedItems[0] = $(this);\n    }\n\n    if (isChecked) {\n      self.selectedItems = [];\n      li.removeClass('is-selected hide-selected-color');\n    } else if (this.settings.selectable) {\n      li.addClass(`is-selected${isMixed ? ' hide-selected-color' : ''}`);\n      self.lastSelectedItem = li.index();// Rember index to use shift key\n    }\n\n    li.parent().find('.is-selected').each(function (i) {\n      self.selectedItems[i] = $(this);\n    });\n\n    li.attr('aria-selected', !isChecked);\n    li.find('.listview-selection-checkbox input').prop('checked', !isChecked);\n\n    if (!noTrigger) {\n      const triggerStr = isChecked ? 'unselected' : 'selected';\n      const selectedData = [];\n\n      for (let i = 0; i < this.selectedItems.length; i++) {\n        const posinset = this.selectedItems[i][0].getAttribute('aria-posinset');\n        selectedData.push(this.settings.dataset[posinset - 1]);\n      }\n\n      /**\n       * Fires when a item is selected.\n       * @event selected\n       * @memberof ListView\n       * @property {object} event - The jquery event object\n       * @property {object} selected items and item info and item data\n       */\n      this.element.triggerHandler(triggerStr, {\n        selectedItems: this.selectedItems,\n        elem: li,\n        selectedData\n      });\n\n      if (triggerStr === 'unselected') {\n        /**\n         * Fires when a item is deselected.\n         *\n         * @event deselected\n         * @memberof ListView\n         * @property {object} event - The jquery event object\n         * @property {object} selected items and item info\n         */\n        this.element.triggerHandler('deselected', { selectedItems: this.selectedItems, elem: li, selectedData });\n      }\n    }\n\n    let parent = this.element.closest('.card, .widget');\n    if (!parent.length) {\n      parent = this.element.parent();\n    }\n\n    const toolbar = parent.find('.listview-toolbar, .contextual-toolbar');\n    const toolbarControl = toolbar.data('toolbar');\n\n    if (self.selectedItems.length > 0) {\n      if (toolbarControl) {\n        toolbarControl.toggleMoreMenu();\n      }\n      // Order of operations: set up event, change display prop, animate, toggle menu.\n      // Menu toggle takes place after the animation starts\n      toolbar.one('animateopencomplete', () => {\n        self.element.addClass('is-toolbar-open');\n        toolbar.trigger('recalculate-buttons').removeClass('is-hidden');\n      });\n      if (toolbar[0]) {\n        toolbar[0].style.display = 'block';\n      }\n      // toolbar.animateOpen({distance: 52});\n      toolbar.animateOpen({ distance: 40 });\n\n      let title = toolbar.find('.title, .selection-count');\n      if (!title || !title.length) {\n        title = $('<div class=\"title selection-count\"></div>');\n        toolbar.prepend(title);\n      }\n      title.text(`${self.selectedItems.length} ${Locale ? Locale.translate('Selected') : 'Selected'}`);\n    } else {\n      toolbar.addClass('is-hidden').one('animateclosedcomplete', function (e) {\n        e.stopPropagation();\n        this.style.display = 'none';\n        self.element.removeClass('is-toolbar-open');\n      }).animateClosed();\n    }\n  },\n\n  /**\n   * Toggle acivation state on the list item\n   * @private\n   * @param {jquery} li The jQuery list element.\n   * @returns {void}\n   */\n  toggleItemActivation(li) {\n    const isActivated = li.hasClass('is-activated');\n\n    if (isActivated) {\n      if (!this.settings.disableItemDeactivation) {\n        this.deactivateItem(li);\n      }\n      return;\n    }\n\n    this.activateItem(li);\n  },\n\n  /**\n   * Set item to activated, unactivate others and fire an event.\n   * @private\n   * @param {jquery|number} li The jQuery list element or the index.\n   * @returns {void}\n   */\n  activateItem(li) {\n    const idx = (typeof li === 'number' ? li : li.index());\n    const active = this.element.find('li.is-activated');\n    let elemCanActivate = true;\n\n    if (typeof li === 'number') {\n      li = this.element.find('ul').children().eq(li);\n    }\n    this.deactivateItem(active);\n    /**\n     * Fires before activate item.\n     *\n     * @event beforeactivate\n     * @memberof ListView\n     * @property {object} event - The jquery event object\n     * @property {object} args index, elem, data\n     */\n    elemCanActivate = this.element.triggerHandler('beforeactivate', [{ index: idx, elem: li, data: this.settings.dataset[idx] }]);\n\n    if (elemCanActivate === false) {\n      return;\n    }\n    li.addClass('is-activated');\n\n    /**\n     * Fires after activate item.\n     *\n     * @event itemactivated\n     * @memberof ListView\n     * @property {object} event - The jquery event object\n     * @property {object} args index, elem, data\n     */\n    this.element.triggerHandler('itemactivated', [{ index: idx, elem: li, data: this.settings.dataset[idx] }]);\n  },\n\n  /**\n  * Return an object containing info about the currently activated item.\n  * @returns {object} An object containing the active row's index, dom element and data.\n  */\n  activatedItem() {\n    const active = this.element.find('li.is-activated');\n    const idx = active.index();\n\n    return {\n      index: idx,\n      elem: active,\n      data: this.settings.dataset[idx]\n    };\n  },\n\n  /**\n   * Set item to deactivated, and fire an event.\n   * @param {jquery|number} li The jQuery list element. The li element or the index.\n   *  If null the currently activated one will be deactivated.\n   * @returns {void}\n   */\n  deactivateItem(li) {\n    if (typeof li === 'number') {\n      li = this.element.find('ul').children().eq(li);\n    }\n\n    if (li === undefined) {\n      li = this.element.find('li.is-activated');\n    }\n\n    li.removeClass('is-activated');\n    const idx = li.index();\n\n    if (idx < 0) {\n      return;\n    }\n\n    /**\n     * Fires after deactivated item.\n     *\n     * @event itemdeactivated\n     * @memberof ListView\n     * @property {object} event - The jquery event object\n     * @property {object} args index, elem, data\n     */\n    this.element.triggerHandler('itemdeactivated', [{ index: idx, elem: li, data: this.settings.dataset[idx] }]);\n  },\n\n  /**\n   * @returns {jquery[]} the currently selected ListView item, or an empty jQuery selector\n   *  if there are currently no items selected.\n   */\n  getSelected() {\n    return this.element.find('.is-selected');\n  },\n\n  /**\n   * Handle to update the search data\n   * @private\n   * @returns {void}\n   */\n  updateSearch() {\n    if (this.settings.searchable && this.filteredDataset) {\n      delete this.filteredDataset;\n      if (this.searchTerm) {\n        delete this.searchTerm;\n      }\n      const searchfieldApi = this.searchfield.data('searchfield');\n      if (searchfieldApi && searchfieldApi.xButton) {\n        searchfieldApi.xButton.trigger('click');\n      }\n    }\n  },\n\n  /**\n   * Refresh the list with any optioned options that might have been set.\n   * @param {object} [settings] incoming settings\n   * @returns {object} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n      if (settings && settings.dataset) {\n        this.settings.dataset = settings.dataset;\n      }\n    }\n\n    this.updateSearch();\n    this.refresh(settings && settings.dataset ? settings.dataset : null);\n    return this;\n  },\n\n  /**\n   * Disables the functionality of a ListView.\n   * @returns {void}\n   */\n  disable() {\n    this.element.addClass('is-disabled');\n  },\n\n  /**\n  * Enables the functionality of a ListView.\n  * @returns {void}\n  */\n  enable() {\n    this.element.removeClass('is-disabled');\n  },\n\n  /**\n   * Detatch all bound events.\n   * @private\n   * @returns {object} component instance\n   */\n  teardown() {\n    $('body').off('resize.listview');\n    this.element.prev('.listview-header').off('click.listview');\n    if (this.searchfield) {\n      this.searchfield.off([\n        'contents-checked.searchable-listview',\n        'cleared.searchable-listview'\n      ].join(' '));\n    }\n    this.element.off('change.selectable-listview', '.listview-checkbox input');\n    this.element.off('contextmenu.listview dblclick.listview', 'li, tr');\n    this.element.off('click.listview', 'li, tr, input[checkbox]');\n    this.element.off('keydown.listview', 'li, tr, a');\n    this.element.off('focus.listview', 'li, tbody tr');\n    this.element.off('focus.listview click.listview touchend.listview keydown.listview change.selectable-listview afterpaging.listview updated.listview').empty();\n\n    if (this.filteredDataset) {\n      delete this.filteredDataset;\n    }\n    if (this.searchTerm) {\n      delete this.searchTerm;\n    }\n\n    return this;\n  },\n\n  /**\n   * Detatch all events and tear down data object\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    this.element.removeData(COMPONENT_NAME);\n  },\n\n  /**\n    * Attach Events used by the Control\n    * @private\n    * @returns {void}\n    */\n  handleEvents() {\n    const self = this;\n    let isSelect = false;\n    let isFocused = false;\n    const isMultiple = self.settings.selectable === 'multiple' || self.settings.selectable === 'mixed';\n\n    this.element\n      .off('focus.listview', 'li, tbody tr')\n      .on('focus.listview', 'li, tbody tr', function (evt) {\n        const item = $(this);\n\n        // Ignore favorite clicks\n        if (evt.originalEvent && evt.originalEvent.target && $(evt.originalEvent.target).is('.icon-favorite')) {\n          return;\n        }\n\n        // First element if disabled\n        if (item.is(':first-child') && item.hasClass('is-disabled')) {\n          const e = $.Event('keydown.listview');\n\n          e.keyCode = 40; // move down\n          isSelect = true;\n          item.trigger(e);\n        }\n\n        if ((!isSelect) &&\n            (!item.hasClass('is-disabled')) &&\n            (self.settings.selectOnFocus) &&\n            (self.settings.selectable !== 'multiple') &&\n            (self.settings.selectable !== 'mixed')) {\n          self.select(item);\n          isSelect = true;\n          isFocused = true;\n        }\n      });\n\n    // Keyboard\n    this.element\n      .off('keydown.listview', 'li, tr, a')\n      .on('keydown.listview', 'li, tr, a', function (e) {\n        const elem = $(this);\n        const item = elem.is('a') ? elem.closest('li') : $(this);\n        const list = item.is('a') ? item.closest('ul') : item.parent();\n        const key = e.keyCode || e.charCode || 0;\n        const metaKey = e.metaKey;\n\n        if (item.index() === 0 && e.keyCode === 38) {\n          return false;\n        }\n\n        if ((key === 40 || key === 38) && !metaKey) { // move down or up\n          const newItem = e.keyCode === 40 ? item.nextAll(':not(.is-disabled):visible:first') : item.prevAll(':not(.is-disabled):visible:first');\n\n          if (newItem.length && ($(e.target).is(item) || e.shiftKey || elem.is('a'))) {\n            self.focus(newItem);\n          }\n          e.preventDefault();\n          e.stopPropagation(); // prevent container from scrolling\n        }\n\n        if (key === 35 || (key === 40 && metaKey)) { // end\n          const last = list.children().last();\n          self.focus(last);\n          e.stopPropagation();\n          return false;\n        }\n\n        if (key === 36 || (key === 38 && metaKey)) { // home\n          const first = list.children().first();\n          self.focus(first);\n          e.stopPropagation();\n          return false;\n        }\n\n        if (key === 32) { // Space to toggle selection\n          if ($(e.target).is(item)) {\n            if (isMultiple && e.shiftKey) {\n              self.selectItemsBetweenIndexes([self.lastSelectedItem, item.index()]);\n            } else {\n              self.select(item);\n            }\n            e.preventDefault();\n          }\n        }\n\n        // If multiSelect is enabled, press Control+A to toggle select all items\n        if (isMultiple && ((e.ctrlKey || e.metaKey) && key === 65)) {\n          self.toggleAll();\n          self.focus(item);\n          e.preventDefault();\n        }\n\n        return true;\n      });\n\n    // Selection View Click/Touch\n    if (this.settings.selectable) {\n      this.element.addClass('is-selectable');\n\n      const pattern = $(this.element).closest('.list-detail, .builder');\n\n      this.element\n        .off('click.listview', 'li, tr, input[checkbox]')\n        .on('click.listview', 'li, tr, input[checkbox]', function (e) {\n          const item = $(this);\n          const isCheckbox = $(e.target).closest('.listview-selection-checkbox').length > 0;\n          const isMixed = self.settings.selectable === 'mixed';\n          const target = $(e.target);\n\n          // ignore clicking favorites element or a hyperlink\n          if (target.hasClass('icon-favorite') || target.hasClass('hyperlink')) {\n            return;\n          }\n\n          if (!isFocused && !item.hasClass('is-disabled') && (!isMixed || isCheckbox)) {\n            isSelect = true;\n\n            if (isMultiple && e.shiftKey) {\n              self.selectItemsBetweenIndexes([self.lastSelectedItem, item.index()]);\n              e.preventDefault();\n            } else {\n              self.select(item);\n            }\n            item.focus();\n          }\n\n          if (!item.hasClass('is-disabled') && isMixed && !isCheckbox) {\n            item.focus();\n            self.toggleItemActivation(item);\n          }\n\n          if (pattern.length > 0 && $(window).outerWidth() < 767 && !item.hasClass('is-disabled') && !isCheckbox) {\n            self.element.trigger('drilldown', [item]);\n          }\n\n          isFocused = false;\n\n          e.preventDefault();\n          e.stopPropagation();\n\n          self.element.trigger('click', [{\n            elem: item,\n            data: self.settings.dataset[item.attr('aria-posinset') - 1],\n            index: item.index(),\n            originalEvent: e\n          }]);\n        });\n\n      this.element\n        .off('dblclick.listview', 'li, tr')\n        .on('dblclick.listview', 'li, tr', function (e) {\n          const item = $(this);\n\n          e.preventDefault();\n          e.stopPropagation();\n          self.element.trigger('dblclick', [{\n            elem: $(this),\n            data: self.settings.dataset[item.attr('aria-posinset') - 1],\n            index: item.index(),\n            originalEvent: e\n          }]);\n          return false;\n        });\n\n      this.element\n        .off('contextmenu.listview', 'li, tr')\n        .on('contextmenu.listview', 'li, tr', function (e) {\n          const item = $(this);\n\n          e.preventDefault();\n          e.stopPropagation();\n          self.element.trigger('contextmenu', [{\n            elem: $(this),\n            data: self.settings.dataset[item.attr('aria-posinset') - 1],\n            index: item.index(),\n            originalEvent: e\n          }]);\n          return false;\n        });\n    }\n\n    if (!this.settings.hoverable || this.settings.hoverable === 'false') {\n      this.element.removeClass('is-selectable');\n      this.element.addClass('disable-hover');\n    }\n\n    if (!this.settings.selectable || this.settings.selectable === 'false') {\n      this.element.removeClass('is-selectable');\n      this.element.addClass('disable-hover');\n    }\n\n    if (this.settings.selectable === 'multiple' || this.settings.selectable === 'mixed') {\n      this.element\n        .off('change.selectable-listview', '.listview-checkbox input')\n        .on('change.selectable-listview', '.listview-checkbox input', function (e) {\n          $(this).parent().trigger('click');\n          e.stopPropagation();\n        });\n    }\n\n    // For use with Searchfield\n    if (this.settings.searchable) {\n      this.searchfield\n        .off('contents-checked.searchable-listview')\n        .on('contents-checked.searchable-listview', function (e) {\n          self.handleSearch(e, $(this));\n        })\n        .off('cleared.searchable-listview')\n        .on('cleared.searchable-listview', () => {\n          self.resetSearch();\n          self.element.trigger('filtered', { elem: self.element, filteredResults: [], term: '' });\n        });\n    }\n\n    // If used with a Pager Control, listen for the end of the page and scroll\n    // the Listview to the top\n    if (this.pagerAPI) {\n      this.element\n        .off('page.listview').on('page.listview', (e, pagingInfo) => {\n          self.handlePageChange(pagingInfo);\n        })\n        .off('pagesizechange.listview').on('pagesizechange.listview', (e, pagingInfo) => {\n          self.handlePageSizeChange(pagingInfo);\n        });\n    }\n\n    $('body').off('resize.listview').on('resize.listview', (e) => {\n      self.handleResize(e);\n    });\n\n    // Animate open and Closed from the header\n    self.element.prev('.listview-header')\n      .off('click.listview')\n      .on('click.listview', function () {\n        const icon = $(this).find('.plus-minus');\n        if (icon.hasClass('active')) {\n          icon.removeClass('active');\n          self.element.animateClosed();\n        } else {\n          icon.addClass('active');\n          self.element.animateOpen();\n        }\n      });\n  },\n\n  /**\n   * Listens for a `pagesizechange` event from the dropdown that recalculates page size\n   * @param {object} pagingOpts state information from the pager\n   */\n  handlePageSizeChange(pagingOpts) {\n    pagingOpts.activePage = 1;\n    this.loadData(undefined, pagingOpts);\n  },\n\n  /**\n   * Listens for `page` events from the Pager.\n   * @param {object} pagingOpts state information from the pager\n   */\n  handlePageChange(pagingOpts) {\n    this.loadData(undefined, pagingOpts);\n  },\n};\n\nexport { ListView, COMPONENT_NAME, LISTVIEW_DEFAULTS };\n","import { utils } from '../../utils/utils';\nimport { ListView, COMPONENT_NAME } from './listview';\n\n/**\n * jQuery Component Wrapper for ListView\n * @param {object} settings The settings to apply.\n * @returns {jQuery[]} The jquery object for chaining.\n */\n$.fn.listview = function (settings) {\n  /**\n   * NOTE: Much of this is here for backwards-compatibility reasons.  In the future we need to\n   * make sure these enhancements make it to the components.\n   */\n  const cs = $(this);\n  const attr = cs.attr('data-dataset');\n  const tmpl = cs.attr('data-tmpl');\n  const inlineOpts = utils.parseOptions(this) || {};\n\n  inlineOpts.dataset = inlineOpts.dataset || attr;\n  inlineOpts.template = inlineOpts.template || tmpl;\n\n  if (window[inlineOpts.dataset]) {\n    inlineOpts.dataset = window[inlineOpts.dataset];\n  }\n\n  if (inlineOpts.template && inlineOpts.template.length) {\n    inlineOpts.template = $(`#${inlineOpts.template}`).html();\n  }\n\n  const combinedSettings = utils.extend({}, settings, inlineOpts);\n\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(combinedSettings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ListView(this, combinedSettings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../listview/listview.jquery';\nimport '../arrange/arrange.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'listbuilder';\n\n/**\n * A list of items with add/remove/delete and sort functionality.\n * @class ListBuilder\n * @constructor\n * @param {jQuery[]|HTMLElement} element The base element.\n * @param {object} [settings] incoming settings.\n *\n * @param {array} [settings.dataset]  Array of data\n * @param {string} [settings.handle]  The CSS Class of the handle element\n * @param {string|jQuery[]} [settings.btnAdd]  \"Add\" action button (takes a string representing a\n *  \"data-action\" attribute, or a jQuery-wrapped element reference).\n * @param {string|jQuery[]} [settings.btnEdit]  \"Edit\" action button (takes a string representing a\n *  \"data-action\" attribute, or a jQuery-wrapped element reference).\n * @param {string|jQuery[]} [settings.btnDelete]  \"Delete\" action button (takes a string representing a\n *  \"data-action\" attribute, or a jQuery-wrapped element reference).\n * @param {string|jQuery[]} [settings.btnGoUp]  \"GoUp\" action button (takes a string representing a\n *  \"data-action\" attribute, or a jQuery-wrapped element reference).\n * @param {string|jQuery[]} [settings.btnGoDown]  \"GoDown\" action button (takes a string representing a\n *  \"data-action\" attribute, or a jQuery-wrapped element reference).\n * @param {string} [settings.template]  representing HTML content that builds a list\n * @param {string} [settings.templateNewItem]  representing HTML content that builds a single list item\n * @param {string} [settings.templateItemContent]  representing HTML content that replaces the inner content\n *  section of each item.\n */\n\nconst LISTBUILDER_DEFAULTS = {\n  dataset: [],\n  handle: '.handle',\n  btnAdd: 'add',\n  btnEdit: 'edit',\n  btnDelete: 'delete',\n  btnGoUp: 'goup',\n  btnGoDown: 'godown',\n  template: '' +\n    '<ul data-handle=\".handle\">' +\n      '{{#dataset}}' +\n        '{{#text}}' +\n          '<li' +\n            '{{#value}} data-value=\"{{value}}\"{{/value}}' +\n            '{{#selected}} selected=\"selected\"{{/selected}}' +\n            '{{#disabled}} class=\"is-disabled\"{{/disabled}}' +\n          '>' +\n            '<span class=\"handle\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">&#8286;</span>' +\n            '<div class=\"item-content\"><p>{{text}}</p></div>' +\n          '</li>' +\n        '{{/text}}' +\n      '{{/dataset}}' +\n    '</ul>',\n  templateNewItem: '' +\n    '<li data-value=\"{{text}}\" role=\"option\">' +\n      '<span class=\"handle\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">&#8286;</span>' +\n      '<div class=\"item-content\"><p>{{text}}</p></div>' +\n    '</li>',\n  templateItemContent: '<p>{{text}}</p>'\n};\n\nfunction ListBuilder(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, LISTBUILDER_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// ListBuilder Methods\nListBuilder.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this\n      .loadListview()\n      .initDataset()\n      .setElements()\n      .handleEvents();\n\n    setTimeout(() => {\n      this.setSelected();\n    }, 0);\n  },\n\n  /**\n   * Load listview\n   * @private\n   * @returns {this} component instance\n   */\n  loadListview() {\n    const s = this.settings;\n    const lv = $('.listview', this.element);\n\n    if (!s.dataset.length && lv.length && $('li', lv).length) {\n      this.listApi = lv.listview({ selectable: 'single' }).data('listview');\n    } else if (lv.length) {\n      this.listApi = lv.listview({ dataset: s.dataset, template: s.template, selectable: 'single' }).data('listview');\n    }\n    return this;\n  },\n\n  /**\n   * Initialize dataset\n   * @private\n   * @returns {this} component instance\n   */\n  initDataset() {\n    const s = this.settings;\n    const nodes = $('.listview li', this.element);\n\n    this.dataset = [];\n    for (let i = 0, l = nodes.length; i < l; i++) {\n      let data;\n      const li = $(nodes[i]);\n      if (s.dataset) {\n        // Make sure it's not reference pointer to data object, make copy of data\n        data = JSON.parse(JSON.stringify(s.dataset[i]));\n        data.node = li;\n      } else {\n        data = this.extractNodeData(li);\n      }\n      this.dataset.push(data);\n    }\n    return this;\n  },\n\n  /**\n   * Extract node data\n   * @private\n   * @param {jQuery[]} node element to be checked for data\n   * @returns {object} data from the node.\n   */\n  extractNodeData(node) {\n    const data = { node, text: $.trim($('.item-content', node).text()) };\n    const value = node.attr('data-value');\n    if (typeof value !== 'undefined') {\n      data.value = value;\n    }\n    return data;\n  },\n\n  /**\n   * Set elements\n   * @private\n   * @returns {this} component instance\n   */\n  setElements() {\n    const s = this.settings;\n\n    // Action buttons\n    const setAction = (selector) => {\n      if (this.isjQuery(selector)) {\n        return selector;\n      } else if (typeof selector === 'string') {\n        return $(`[data-action=\"${selector}\"]`, this.element);\n      }\n      return null;\n    };\n    s.btnAdd = setAction(s.btnAdd);\n    s.btnGoUp = setAction(s.btnGoUp);\n    s.btnGoDown = setAction(s.btnGoDown);\n    s.btnEdit = setAction(s.btnEdit);\n    s.btnDelete = setAction(s.btnDelete);\n\n    // Init tooltips\n    this.topButtons = s.btnAdd.add(s.btnGoUp).add(s.btnGoDown).add(s.btnEdit).add(s.btnDelete);\n    this.topButtons.tooltip();\n\n    // Make Draggable\n    this.ul = $('.listview ul', this.element);\n    this.arrangeApi = this.ul.arrange({\n      handle: s.handle,\n      placeholder: s.templateNewItem\n    }).data('arrange');\n\n    return this;\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    let data;\n    const self = this;\n    const s = self.settings;\n\n    // TOP BUTTONS =============================================================\n    const topButtonsClick = (btn, method) => {\n      btn.off('click.listbuilder')\n        .on('click.listbuilder', () => {\n          self[method]();\n        });\n    };\n    topButtonsClick(s.btnAdd, 'addItem');\n    topButtonsClick(s.btnGoUp, 'moveItemUp');\n    topButtonsClick(s.btnGoDown, 'moveItemDown');\n    topButtonsClick(s.btnEdit, 'editItem');\n    topButtonsClick(s.btnDelete, 'deleteItem');\n\n    // DRAGGABLE ===============================================================\n    this.arrangeApi.element\n      .on('beforearrange.listbuilder', (e, status) => {\n        const d = this.getDataByNode(status.start);\n        const str = s.templateItemContent.replace(/{{text}}/g, d.data.text);\n\n        this.arrangeApi.placeholders.attr('data-value', d.data.text)\n          .find('.item-content').html(str);\n      })\n      .on('arrangeupdate.listbuilder', (e, status) => {\n        this.updateAttributes();\n        this.arrayIndexMove(this.dataset, status.startIndex, status.endIndex);\n        data = this.getDataByNode(status.end);\n        data.indexBeforeMove = status.startIndex;\n        this.element.triggerHandler('arrangeupdate', [data]);\n      });\n\n    $(`li:not(.is-disabled) ${this.arrangeApi.handle}`, this.ul)\n      .on('mousedown.listbuilder touchstart.listbuilder', function () {\n        const li = $(this);\n        if (!li.is('.is-selected')) {\n          li.trigger('click');\n        }\n      });\n\n    $('.listview', this.element)\n      .off('selected.listbuilder')\n      .on('selected.listbuilder', (e, args) => {\n        data = this.getDataByNode(args.elem[0]);\n\n        /**\n         * Fires when a item is selected.\n         * @event selected\n         * @memberof ListBuilder\n         * @type {object}\n         * @property {object} event - The jquery event object\n         * @property {object} data - Data for this selected item\n         */\n        this.element.triggerHandler('selected', [data]);\n      });\n\n    this.updatedEventsStr = 'arrangeupdate.listbuilder aftergoup.listbuilder aftergodown.listbuilder exiteditmode.listbuilder';\n    this.element\n      .off(this.updatedEventsStr)\n      .on(this.updatedEventsStr, (e, updatedData) => {\n        /**\n         * Fires when a item is updated.\n         * @event updated\n         * @memberof ListBuilder\n         * @type {object}\n         * @property {object} event - The jquery event object\n         * @property {object} data - Data for this item\n         */\n        this.element.triggerHandler('updated', [updatedData]);\n      });\n\n    return this;\n  }, // END: Handle Events -----------------------------------------------------\n\n  /**\n   * Add an item into edit mode.\n   * @private\n   * @returns {void}\n   */\n  addItem() {\n    const self = this;\n    const s = this.settings;\n\n    /**\n     * Fires before add new item.\n     *\n     * @event beforeadd\n     * @memberof ListBuilder\n     * @type {object}\n     * @property {object} event - The jquery event object\n     */\n    $.when(this.element.triggerHandler('beforeadd')).done(() => {\n      let li;\n      let data;\n      let index = 0;\n\n      const node = self.listApi.selectedItems[0];\n      const str = s.templateNewItem.replace(/{{text}}/g, Locale.translate('NewItem'));\n\n      if (node && node.length > 0) {\n        data = self.getDataByNode(node);\n        index = data.index + 1;\n        $(str).insertAfter(node);\n        li = $('li', self.ul).eq(index);\n      } else {\n        self.ul.prepend(str);\n        li = $('li:first-child', self.ul);\n      }\n\n      self.dataset.push(self.extractNodeData(li));\n      self.arrayIndexMove(self.dataset, self.dataset.length - 1, index);\n      self.updateAttributes();\n      li.trigger('click');\n      self.arrangeApi.updated();\n      self.editItem(true);\n\n      data = { index, data: self.dataset[index] };\n\n      /**\n       * Fires after add new item.\n       * @event afteradd\n       * @memberof ListBuilder\n       * @type {object}\n       * @property {object} event - The jquery event object\n       * @property {object} data - Data for this new item\n       */\n      self.element.triggerHandler('afteradd', [data]);\n    });\n  },\n\n  /**\n   * Move the currently selected item up.\n   * @private\n   * @returns {void}\n   */\n  moveItemUp() {\n    const self = this;\n    const node = self.listApi.selectedItems[0];\n\n    if (node && node.length > 0) {\n      const data = self.getDataByNode(node);\n      if (typeof data.index !== 'undefined' && data.index > 0) {\n        /**\n         * Fires before move up item.\n         * @event beforegoup\n         * @memberof ListBuilder\n         * @type {object}\n         * @property {object} event - The jquery event object\n         * @property {object} data - Data for this item\n         */\n        $.when(self.element.triggerHandler('beforegoup', [data])).done(() => {\n          const prev = node.prev();\n          node.insertBefore(prev);\n          self.updateAttributes();\n          self.arrayIndexMove(self.dataset, data.index, data.index - 1);\n          data.indexBeforeMove = data.index;\n          data.index--;\n\n          /**\n           * Fires after move up item.\n           * @event aftergoup\n           * @memberof ListBuilder\n           * @type {object}\n           * @property {object} event - The jquery event object\n           * @property {object} data - Data for this item\n           */\n          self.element.triggerHandler('aftergoup', [data]);\n        });\n      }\n    }\n  },\n\n  /**\n   * Move the currently selected item down.\n   * @private\n   * @returns {void}\n   */\n  moveItemDown() {\n    const self = this;\n    const node = self.listApi.selectedItems[0];\n    if (node && node.length > 0) {\n      const data = self.getDataByNode(node);\n      if (typeof data.index !== 'undefined' && data.index < self.dataset.length - 1) {\n        /**\n         * Fires before move down item.\n         * @event beforegodown\n         * @memberof ListBuilder\n         * @type {object}\n         * @property {object} event - The jquery event object\n         * @property {object} data - Data for this item\n         */\n        $.when(self.element.triggerHandler('beforegodown', [data])).done(() => {\n          const next = node.next();\n          node.insertAfter(next);\n          self.updateAttributes();\n          self.arrayIndexMove(self.dataset, data.index, data.index + 1);\n          data.indexBeforeMove = data.index;\n          data.index++;\n\n          /**\n           * Fires after move down item.\n           * @event aftergodown\n           * @memberof ListBuilder\n           * @type {object}\n           * @property {object} event - The jquery event object\n           * @property {object} data - Data for this item\n           */\n          self.element.triggerHandler('aftergodown', [data]);\n        });\n      }\n    }\n  },\n\n  /**\n   * Edit the selected item\n   * @private\n   * @param {boolean} isNewItem  Is it a newly added item?\n   * @returns {void}\n   */\n  editItem(isNewItem) {\n    const node = this.listApi.selectedItems[0];\n    if (node && node.length > 0) {\n      if (node.is('.is-editing')) {\n        this.commitEdit(node, isNewItem);\n      } else {\n        this.makeEditable(node, isNewItem);\n      }\n    }\n  },\n\n  /**\n   * Make the node editable\n   * @private\n   * @param {object} node  The HTML element to edit\n   * @param {boolean} isNewItem  Is it a newly added item?\n   * @returns {void}\n   */\n  makeEditable(node, isNewItem) {\n    const self = this;\n    const data = self.getDataByNode(node);\n    const container = $('.item-content', node);\n\n    if (typeof data.index !== 'undefined' && data.index < self.dataset.length) {\n      /**\n       * Fires before edit item.\n       * @event beforeedit\n       * @memberof ListBuilder\n       * @type {object}\n       * @property {object} event - The jquery event object\n       * @property {object} data - Data for this item\n       */\n      $.when(self.element.triggerHandler('beforeedit', [data])).done(() => {\n        const origValue = xssUtils.escapeHTML((container.text().trim() || '').toString());\n        const editInput = $(`<input name=\"edit-input\" class=\"edit-input\" type=\"text\" value=\"${origValue}\" />`);\n\n        node.addClass('is-editing');\n        container.html(editInput);\n        setTimeout(() => {\n          editInput.focus().select();\n        }, 0);\n\n        editInput\n          .on('click.listbuilder', () => false)\n          .on('blur.listbuilder', () => self.commitEdit(node, isNewItem))\n          .on('keypress.listbuilder', (e) => {\n            const key = e.keyCode || e.charCode || 0;\n            if (key === 13) {\n              self.commitEdit(node, isNewItem);\n              node.focus();\n            }\n          });\n\n        /**\n         * Fires when enter to edit mode.\n         * @event entereditmode\n         * @memberof ListBuilder\n         * @type {object}\n         * @property {object} event - The jquery event object\n         * @property {object} data - Data for this item\n         */\n        self.element.triggerHandler('entereditmode', [data]);\n      });\n    }\n  },\n\n  /**\n   * Commit the changes to item.\n   * @private\n   * @param {object} node  The HTML element to commit changes\n   * @param {boolean} isNewItem  Is it a newly added item?\n   * @returns {void}\n   */\n  commitEdit(node, isNewItem) {\n    const s = this.settings;\n    const data = this.getDataByNode(node);\n    const container = $('.item-content', node);\n    const editInput = $('.edit-input', container);\n\n    editInput.val(xssUtils.escapeHTML((editInput.val() || '').toString()));\n\n    if (isNewItem) {\n      data.data.value = editInput.val();\n    }\n    data.data.text = editInput.val();\n    editInput.off('click.listbuilder blur.listbuilder keypress.listbuilder');\n    container.html(s.templateItemContent.replace(/{{text}}/g, editInput.val()));\n    node.removeClass('is-editing');\n\n    /**\n     * Fires when exited to edit mode.\n     * @event exiteditmode\n     * @memberof ListBuilder\n     * @type {object}\n     * @property {object} event - The jquery event object\n     * @property {object} data - Data for this item\n     */\n    this.element.triggerHandler('exiteditmode', [data]);\n  },\n\n  /**\n   * Delete the selected item.\n   * @private\n   * @returns {void}\n   */\n  deleteItem() {\n    const self = this;\n    const node = self.listApi.selectedItems[0];\n    if (node && node.length > 0) {\n      const data = self.getDataByNode(node);\n      if (typeof data.index !== 'undefined') {\n        /**\n         * Fires before delete item.\n         * @event beforedelete\n         * @memberof ListBuilder\n         * @type {object}\n         * @property {object} event - The jquery event object\n         * @property {object} data - Data for this item\n         */\n        $.when(self.element.triggerHandler('beforedelete', [data])).done(() => {\n          self.listApi.removeAllSelected();\n          self.updateAttributes();\n          self.dataset.splice(data.index, 1);\n\n          /**\n           * Fires after delete item.\n           * @event afterdelete\n           * @memberof ListBuilder\n           * @type {object}\n           * @property {object} event - The jquery event object\n           * @property {object} data - Data for this item\n           */\n          self.element.triggerHandler('afterdelete', [data]);\n        });\n      }\n    }\n  },\n\n  /**\n   * Get data from dataset by node\n   * @param {jQuery[]} node  The HTML element to get data\n   * @returns {object} node data\n   */\n  getDataByNode(node) {\n    let data = {};\n    for (let i = 0, l = this.dataset.length; i < l; i++) {\n      const d = this.dataset[i];\n      if ($(d.node).is(node)) {\n        data = { index: i, data: d };\n        break;\n      }\n    }\n    return data;\n  },\n\n  /**\n   * Move an array element position\n   * @private\n   * @param {array} arr .\n   * @param {number} from .\n   * @param {number} to .\n   * @returns {void}\n   */\n  arrayIndexMove(arr, from, to) {\n    arr.splice(to, 0, arr.splice(from, 1)[0]);\n  },\n\n  /**\n   * Check if given object is a jQuery object\n   * @private\n   * @param {object} obj .\n   * @returns {boolean} true if jQuery\n   */\n  isjQuery(obj) {\n    return (obj && (obj instanceof jQuery || obj.constructor.prototype.jquery));\n  },\n\n  /**\n   * Move cursor to end\n   * http://stackoverflow.com/a/26900921\n   * @private\n   * @param {object} el as element.\n   * @returns {void}\n   */\n  moveCursorToEnd(el) {\n    setTimeout(() => {\n      if (typeof el.selectionStart === 'number') {\n        el.selectionEnd = el.value.length;\n        el.selectionStart = el.value.length;\n      } else if (typeof el.createTextRange !== 'undefined') {\n        const range = el.createTextRange();\n        range.collapse(false);\n        range.select();\n      }\n    }, 100);\n  },\n\n  /**\n   * Update attributes\n   * @private\n   * @returns {void}\n   */\n  updateAttributes() {\n    const nodes = $('li', this.ul);\n\n    for (let i = 0, l = nodes.length; i < l; i++) {\n      $(nodes[i]).attr({ 'aria-posinset': i + 1, 'aria-setsize': l });\n    }\n  },\n\n  /**\n   * Update dataset\n   * @private\n   * @param {object} ds as dataset.\n   * @returns {void}\n   */\n  updateDataset(ds) {\n    const nodes = $('li', this.ul);\n    const lv = $('.listview', this.element).data('listview');\n\n    lv.deselectItemsBetweenIndexes([0, nodes.length - 1]);\n    this.settings.dataset = ds;\n    lv.loadData(this.settings.dataset);\n\n    this\n      .initDataset()\n      .setElements()\n      .handleEvents();\n\n    setTimeout(() => {\n      this.setSelected();\n    }, 0);\n  },\n\n  /**\n   * Set pre selected items\n   * @private\n   * @returns {object} this api\n   */\n  setSelected() {\n    const nodes = $('li[selected]', this.ul);\n    for (let i = 0, l = nodes.length; i < l; i++) {\n      const li = $(nodes[i]);\n      li.removeAttr('selected');\n      if (!li.is('.is-selected')) {\n        li.trigger('click');\n      }\n    }\n    return this;\n  },\n\n  /**\n   * Make selected\n   * @private\n   * @param {object} selector .\n   * @returns {void}\n   */\n  select(selector) {\n    const li = this.getListItem(selector);\n\n    if (li && !li.is('.is-selected')) {\n      li.trigger('click');\n    }\n  },\n\n  /**\n   * Make unselected\n   * @private\n   * @param {object} selector .\n   * @returns {void}\n   */\n  unselect(selector) {\n    const li = this.getListItem(selector);\n\n    if (li && li.is('.is-selected')) {\n      li.trigger('click');\n    }\n  },\n\n  /**\n   * Get an item from list, selector: can be\n   * jQuery, DOM element, zero based index or 'first'|'last' as string\n   * @private\n   * @param {object} selector .\n   * @returns {object} item node\n   */\n  getListItem(selector) {\n    let li = $();\n    if (this.isElement(selector) && $.contains(this.ul, selector)) {\n      li = this.isjQuery(selector) ? selector : $(selector);\n    } else {\n      const idx = parseInt(selector, 10);\n      const items = $('li', this.ul);\n      if (!isNaN(idx) && (idx > -1 && idx < items.length)) {\n        li = items.eq(idx); // zero based index\n      } else if ((`${selector}`).toLowerCase() === 'first') {\n        li = items.first(); // first\n      } else if ((`${selector}`).toLowerCase() === 'last') {\n        li = items.last(); // last\n      }\n    }\n    // Make sure to return only one item -or- null\n    if (li.length < 1) {\n      return null;\n    } else if (li.length > 1) {\n      return li.eq(0);\n    }\n    return li;\n  },\n\n  /**\n   * Check if given object is a DOM object\n   * @private\n   * @param {object} obj .\n   * @returns {object} item node\n   */\n  isElement(obj) {\n    /* global Element */\n    return (this.isjQuery(obj) && obj.get(0) instanceof Element) || obj instanceof Element;\n  },\n\n  /**\n   * Make enable.\n   * @returns {void}\n   */\n  enable() {\n    this.element.removeClass('is-disabled')\n      .find('.toolbar .buttonset button').removeAttr('disabled').end()\n      .find('.toolbar .buttonset button[data-original-disabled]')\n      .attr('disabled', 'disabled')\n      .removeAttr('data-original-disabled');\n\n    this.ul\n      .find('li').removeClass('is-disabled').end()\n      .find('li[data-original-disabled]')\n      .addClass('is-disabled')\n      .removeAttr('data-original-disabled');\n  },\n\n  /**\n   * Make disable.\n   * @returns {void}\n   */\n  disable() {\n    this.element.addClass('is-disabled')\n      .find('.toolbar .buttonset button[disabled]').attr('data-original-disabled', 'disabled').end()\n      .find('.toolbar .buttonset button')\n      .attr('disabled', 'disabled');\n\n    this.ul\n      .find('li.is-disabled').attr('data-original-disabled', 'is-disabled').end()\n      .find('li')\n      .addClass('is-disabled');\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {this} component instance\n   */\n  unbind() {\n    this.element.off(this.updatedEventsStr);\n    $('.listview', this.element).off('selected.listbuilder');\n\n    $(`li ${this.arrangeApi.handle}`, this.ul)\n      .off('mousedown.listbuilder touchstart.listbuilder');\n\n    this.arrangeApi.element\n      .off('beforearrange.listbuilder arrangeupdate.listbuilder').destroy();\n\n    this.topButtons.off('click.listbuilder');\n    if (this.topButtons) {\n      for (let i = 0, l = this.topButtons.length; i < l; i++) {\n        const tooltipApi = $(this.topButtons[i]).data('tooltip');\n        if (tooltipApi && typeof tooltipApi.destroy === 'function') {\n          tooltipApi.destroy();\n        }\n      }\n    }\n\n    if (this.listApi && typeof this.listApi.destroy === 'function') {\n      this.listApi.destroy();\n    }\n\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} [settings] incoming settings.\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, LISTBUILDER_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Teardown process for this plugin\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { ListBuilder, COMPONENT_NAME };\n","import { ListBuilder, COMPONENT_NAME } from './listbuilder';\n\n/**\n * jQuery Component Wrapper for ListBuilder\n * @param {object} settings The settings to apply.\n * @returns {jQuery[]} The jquery object for chaining.\n */\n$.fn.listbuilder = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ListBuilder(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { warnAboutDeprecation } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../../../src/components/locale/locale';\n\n// jQuery components\nimport '../button/button.jquery';\n\n// The name of this component.\nconst COMPONENT_NAME = 'modal';\n\n/**\n* Responsive and Accessible Modal Control\n* @class Modal\n* @param {string} element The component element.\n* @param {string} settings The component settings.\n*\n* @param {string} [settings.trigger='click'] The method of opening the dialog. Supports click, immediate.\n* @param {array} [settings.buttons=null]  A list of buttons that will sit in the toolbar's Buttonset area.\n* @param {isAlert} [settings.isAlert=false] Adds alertdialog role for message dialogs.\n* @param {content} [settings.content=null] Ability to pass in dialog html content.\n* @param {string} [settings.cssClass=null] Append a css class to top level.\n* @param {boolean} [settings.autoFocus=true] If true the first input will be focused.\n* @param {string} [settings.id=null] Optionally tag a dialog with an id.\n* @param {number} [settings.frameHeight=180] Optional extra height to add.\n* @param {number} [settings.frameWidth=46] Optional extra width to add.\n* @param {function} [settings.beforeShow=null] A call back function that can be used to return data for the modal.\n* @param {boolean} [settings.useFlexToolbar] If true the new flex toolbar will be used (For CAP)\n* @param {boolean} [settings.showCloseBtn] If true, show a close icon button on the top right of the modal.\n* @param {number} [settings.maxWidth=null] Optional max width to add in pixels.\n* return the markup in the response and this will be shown in the modal. The busy indicator will be shown while waiting for a response.\n*/\nconst MODAL_DEFAULTS = {\n  trigger: 'click',\n  buttons: null,\n  isAlert: false,\n  content: null,\n  cssClass: null,\n  autoFocus: true,\n  id: null,\n  frameHeight: 180,\n  frameWidth: 46,\n  beforeShow: null,\n  useFlexToolbar: false,\n  showCloseBtn: false,\n  maxWidth: null\n};\n\nfunction Modal(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, MODAL_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n  this.reStructure();\n}\n\n// Actual Plugin Code\nModal.prototype = {\n\n  /**\n   * @private\n   * @returns {boolean} whether or not the Modal is a Contextual Action Panel (CAP)\n   */\n  get isCAP() {\n    return this.element.is('.contextual-action-panel');\n  },\n\n  /**\n   * @private\n   * @returns {ContextualActionPanel|undefined} a reference to a Contextual Action Panel\n   * API associated with this modal, if one exists.\n   */\n  get capAPI() {\n    let api;\n    if (this.trigger && this.trigger.length) {\n      api = this.trigger.data('contextualactionpanel');\n    } else if (this.mainContent.is('body')) {\n      api = this.mainContent.data('contextualactionpanel');\n    }\n    return api;\n  },\n\n  /**\n   * @returns {boolean} whether or not the body tag is this Modal's trigger element\n   */\n  get isAttachedToBody() {\n    return (this.trigger.length && this.trigger.is('body'));\n  },\n\n  /**\n   * @returns {boolean} whether or not this Modal is currently being displayed\n   */\n  get visible() {\n    return this.element.is('.is-visible');\n  },\n\n  /**\n   * @returns {boolean} whether or not this Modal instance is the top-level one\n   */\n  get isOnTop() {\n    let max = 0;\n    const dialog = this.element;\n\n    $('.modal.is-visible').each(function () {\n      if (max < this.style.zIndex) {\n        max = this.style.zIndex;\n      }\n    });\n\n    return max === dialog[0].style.zIndex;\n  },\n\n  /**\n   * @private\n   */\n  init() {\n    const self = this;\n\n    // Used for tracking events tied to the Window object\n    this.id = this.element.attr('id') || (parseInt($('.modal').length, 10) + 1);\n\n    // Find the button or anchor with same dialog ID\n    this.trigger = $(`[data-modal=\"${this.element.attr('id')}\"]`);\n    if (this.element.is('body')) {\n      this.trigger = this.element;\n    }\n\n    if (!this.overlay) {\n      this.overlay = $('<div class=\"overlay\"></div>');\n    }\n\n    this.oldActive = this.trigger;\n\n    if (this.settings.trigger === 'click' && !this.isAttachedToBody) {\n      this.trigger.on('click.modal', (e) => {\n        if (!$(e.currentTarget).is(self.trigger)) {\n          return;\n        }\n        self.open();\n      });\n    }\n\n    if (this.settings.trigger === 'immediate') {\n      setTimeout(() => {\n        self.open();\n      }, 1);\n    }\n\n    self.isCancelled = false;\n\n    // ensure is appended to body for new dom tree\n    if (this.settings.content) {\n      this.settings.trigger = this.settings.content instanceof jQuery ? this.settings.trigger : 'immediate';\n      this.appendContent();\n      setTimeout(() => {\n        self.open();\n      }, 1);\n      return;\n    }\n\n    if (this.settings.beforeShow) {\n      this.settings.trigger = this.settings.content instanceof jQuery ? this.settings.trigger : 'immediate';\n      this.appendContent();\n      this.callSource();\n      return;\n    }\n\n    self.addButtons(this.settings.buttons);\n    this.element.appendTo('body');\n    this.element[0].style.display = 'none';\n  },\n\n  appendContent() {\n    let isAppended = false;\n\n    this.element = $(`${'<div class=\"modal\">' +\n        '<div class=\"modal-content\" style=\"max-width: '}${this.settings.maxWidth ? this.settings.maxWidth : ''}px${'\">' +\n          '<div class=\"modal-header\"><h1 class=\"modal-title\">'}${this.settings.title}</h1></div>` +\n          '<div class=\"modal-body-wrapper\">' +\n            '<div class=\"modal-body\"></div>' +\n          '</div>' +\n        '</div>' +\n      '</div>');\n\n    if (this.settings.showCloseBtn) {\n      const closeBtn = $(`\n        <button type=\"button\" class=\"btn-icon btn-close\" title=\"${Locale.translate('Close')}\" aria-hidden=\"true\">\n          ${$.createIcon('close')}\n          <span class=\"audible\">${Locale.translate('Close')}</span>\n        </button>\n      `);\n      this.element.find('.modal-content').append(closeBtn);\n      closeBtn.on('click.modal', () => this.close()).tooltip();\n    }\n\n    if (this.settings.id) {\n      this.element.attr('id', this.settings.id);\n    }\n\n    if ($(this.settings.content).is('.modal')) {\n      this.element = $(this.settings.content);\n      isAppended = this.element.parent().hasClass('modal-wrapper');\n    } else if (this.settings.content && this.settings.content.length > 0) {\n      if (this.settings.content instanceof jQuery && this.settings.content.parent().is('.modal-body')) {\n        isAppended = true;\n        this.element = this.settings.content.closest('.modal');\n      } else {\n        this.element.find('.modal-body').append(this.settings.content);\n      }\n\n      if (this.settings.content instanceof jQuery && !this.settings.beforeShow) {\n        this.settings.content.removeClass('hidden is-hidden');\n        this.settings.content.show();\n      }\n    }\n\n    if (this.settings.beforeShow) {\n      this.busyIndicator = $('<div class=\"overlay busy\"></div>' +\n        '<div class=\"busy-indicator-container blocked-ui\" aria-live=\"polite\" role=\"status\">' +\n          '<div class=\"busy-indicator active\">' +\n            '<div class=\"bar one\"></div>' +\n            '<div class=\"bar two\"></div>' +\n            '<div class=\"bar three\"></div>' +\n            '<div class=\"bar four\"></div>' +\n            '<div class=\"bar five\"></div>' +\n          '</div>' +\n          '<span>Loading...</span>' +\n        '</div>');\n      $('body').append(this.busyIndicator);\n    }\n\n    if (!isAppended) {\n      this.element.appendTo('body');\n    }\n\n    if (this.settings.cssClass) {\n      this.element.addClass(this.settings.cssClass);\n    }\n\n    if (this.settings.title) {\n      this.element.find('.modal-title').text(this.settings.title);\n    }\n\n    if (!isAppended) {\n      this.addButtons(this.settings.buttons);\n    }\n\n    utils.fixSVGIcons(this.element);\n  },\n\n  reStructure() {\n    const body = $('.modal-body', this.element);\n    const hr = $('hr:first-child', body);\n    const buttonset = $('.modal-buttonset', this.element);\n\n    if (body && body.length && !body.parent().hasClass('modal-body-wrapper')) {\n      body.wrap('<div class=\"modal-body-wrapper\"></div>');\n    }\n    if (hr && hr.length && !hr.parent().hasClass('modal-content')) {\n      hr.insertAfter(this.element.find('.modal-header'));\n    }\n    if (buttonset && buttonset.length && !buttonset.parent().hasClass('modal-content')) {\n      buttonset.insertAfter(this.element.find('.modal-body-wrapper'));\n    }\n  },\n\n  /**\n   * Check if the submit button should be disabled based on validation status.\n   * @private\n   * @returns {void}\n   */\n  disableSubmit() {\n    const body = this.element;\n    const inlineBtns = body.find('.modal-buttonset button');\n    const primaryButton = inlineBtns.filter('.btn-modal-primary').not('.no-validation');\n    const dropdowns = body.find('select.dropdown[data-validate]');\n    let fields = body.find('[data-validate]:visible');\n\n    dropdowns.each(function () {\n      const dropdown = $(this);\n      if (dropdown.next('.dropdown-wrapper').is(':visible')) {\n        fields = fields.add(this);\n      }\n    });\n\n    if (fields.length > 0) {\n      primaryButton.removeAttr('disabled');\n\n      let allValid = true;\n      fields.each(function () {\n        const field = $(this);\n        if (field.closest('.datagrid-filter-wrapper').length > 0) {\n          return;\n        }\n\n        const isVisible = field.is('.dropdown') && field.next('.dropdown-wrapper').is(':visible') || field[0].offsetParent !== null;\n\n        if (field.is('.required')) {\n          if (isVisible && !field.val()) {\n            allValid = false;\n          }\n        } else {\n          field.validateField();\n          if (isVisible && !field.isValid()) {\n            allValid = false;\n          }\n        }\n\n        if (isVisible && field.is('.error')) {\n          allValid = false;\n        }\n\n        if (allValid) {\n          primaryButton.removeAttr('disabled');\n        }\n      });\n\n      if (!allValid && !primaryButton.is(':disabled')) {\n        primaryButton.attr('disabled', 'true');\n      }\n    }\n  },\n\n  addButtons(buttons) {\n    const self = this;\n    const body = this.element.find('.modal-body');\n    const bodywrapper = body.parent();\n    const flexToolbar = this.element.find('.flex-toolbar');\n    let btnWidth = 100;\n    let isPanel = false;\n    let buttonset;\n\n    this.modalButtons = buttons;\n\n    if (!buttons) {\n      const inlineBtns = this.element.find('.modal-buttonset button');\n\n      // Buttons in markup\n      btnWidth = 100 / inlineBtns.length;\n      for (let i = 0, l = inlineBtns.length; i < l; i++) {\n        inlineBtns[i].style.width = `${btnWidth}%`;\n      }\n      inlineBtns.button();\n      inlineBtns.not('[data-ng-click], [ng-click], [onclick], :submit').on('click.modal', (e) => {\n        if ($(e.target).is('.btn-cancel')) {\n          self.isCancelled = true;\n        }\n        self.close();\n      });\n      return;\n    }\n\n    if (this.isCAP) {\n      // CAP is responsible for rendering this part, and will have done so by the\n      // time this code runs\n      isPanel = true;\n      buttonset = this.element.find('.buttonset');\n    } else {\n      buttonset = this.element.find('.modal-buttonset');\n      if (!buttonset.length) {\n        buttonset = $('<div class=\"modal-buttonset\"></div>').insertAfter(bodywrapper);\n      }\n    }\n\n    btnWidth = 100 / buttons.length;\n\n    if (buttons) {\n      buttonset.empty();\n    }\n\n    const decorateButtons = function (props, cnt) {\n      let btn = $(`<button type=\"button\">\n        <span></span>\n      </button>`);\n      const span = btn.find('span');\n\n      span.text(props.text);\n      btn.attr('type', props.type || 'button');\n\n      if (props.cssClass === 'separator') {\n        btn = $('<div class=\"separator\"></div>');\n      }\n\n      if (props.cssClass) {\n        btn.attr('class', props.cssClass);\n      } else if (props.isDefault) {\n        btn.addClass('btn-modal-primary');\n      } else {\n        btn.addClass('btn-modal');\n      }\n\n      if (props.audible) {\n        span.addClass('audible');\n      }\n\n      if (props.validate !== undefined && !props.validate) {\n        btn.addClass('no-validation');\n      }\n\n      const attrs = {};\n      const attrTypes = ['id', 'name', 'text'];\n\n      for (let k = 0; k < attrTypes.length; k++) {\n        if (props[attrTypes[k]]) {\n          attrs[attrTypes[k]] = props[attrTypes[k]];\n        }\n      }\n\n      if (props.type === 'input') {\n        const label = $(`<label class=\"audible\" for=\"filter\">${props.text}</label>`);\n        const input = $('<input class=\"searchfield\">').attr(attrs);\n\n        if (flexToolbar.length) {\n          flexToolbar.find('.toolbar-section.search').append(label, input);\n        } else {\n          buttonset.append(label, input);\n        }\n        input.searchfield(props.searchfieldSettings);\n        return;\n      }\n\n      if (props.icon && props.icon.charAt(0) === '#') {\n        $.createIconElement({\n          classes: [props.icon === '#icon-close' ? 'icon-close' : ''],\n          icon: props.icon.substr('#icon-'.length)\n        }).prependTo(btn);\n      }\n\n      btn[0].setAttribute('id', props.id || utils.uniqueId(self.element, 'button', 'modal'));\n\n      const func = buttons[cnt].click;\n\n      btn.on('click.modal', (e) => {\n        if (func) {\n          func.apply(self.element[0], [e, self]);\n          return;\n        }\n        self.close();\n      });\n\n      if (!isPanel) {\n        btn[0].style.width = `${btnWidth}%`;\n      }\n\n      btn.button();\n\n      if ((self.settings.useFlexToolbar || self.settings.centerTitle) && props.align) {\n        if (props.align === 'left') {\n          flexToolbar.find('.toolbar-section').eq(0).append(btn);\n        }\n\n        if (props.align === 'center') {\n          flexToolbar.find('.toolbar-section').eq(1).find('h2').append(btn);\n        }\n\n        if (props.align === 'right') {\n          flexToolbar.find('.toolbar-section').eq(2).append(btn);\n        }\n      } else {\n        buttonset.append(btn);\n      }\n    };\n\n    for (let cnt = 0; cnt < buttons.length; cnt++) {\n      decorateButtons(buttons[cnt], cnt);\n    }\n  },\n\n  /**\n  * Size the inner content on resize.\n  * @private\n  * @returns {void}\n  */\n  sizeInner() {\n    const messageArea = this.element.find('.detailed-message');\n    // Set a max width\n    const h = $(window).height() - messageArea.offset().top - 150;\n    messageArea[0].style.maxHeight = `${h}px`;\n    messageArea[0].style.overflow = 'auto';\n    messageArea[0].style.width = `${messageArea.width()}px`;\n  },\n\n  callSource() {\n    if (typeof this.settings.beforeShow !== 'function') {\n      return;\n    }\n\n    const self = this;\n    const response = function (content) {\n      if (content === false) {\n        return false;\n      }\n\n      $('#modal-busyindicator').trigger('complete.busyindicator');\n\n      // Returning `true` from the response will cause a modal area to render to the page,\n      // but remain hidden.  In this scenario it will be up to the app developer to reveal\n      // the modal when needed.\n      if (content === true) {\n        if (self.busyIndicator) {\n          self.busyIndicator.remove();\n          delete self.busyIndicator;\n        }\n\n        return true;\n      }\n\n      if (!(content instanceof jQuery)) {\n        content = $(content);\n      }\n\n      self.open(true);\n\n      self.element.find('.modal-body').empty();\n      self.element.find('.modal-body').append(content);\n\n      content.show();\n\n      return true;\n    };\n\n    const callBackOpts = {};\n    this.settings.beforeShow(response, callBackOpts);\n  },\n\n  /**\n   * Open the modal via the api.\n   * @param {boolean} ajaxReturn Flag used internally to denote its an ajax result return.\n   */\n  open(ajaxReturn) {\n    let messageArea = null;\n    let elemCanOpen = true;\n\n    // close any active tooltips\n    $('#validation-errors, #tooltip, #validation-tooltip').addClass('is-hidden');\n\n    if (this.busyIndicator) {\n      this.busyIndicator.remove();\n      delete this.busyIndicator;\n    }\n\n    if (!this.trigger || this.trigger.length === 0) {\n      this.oldActive = $(':focus'); // Save and restore focus for A11Y\n    }\n\n    if (!this.element.next().is('.overlay')) {\n      this.element.after(this.overlay);\n    }\n\n    if (this.element && !this.element.parent().hasClass('modal-wrapper')) {\n      this.element.wrap('<div class=\"modal-page-container\"><div class=\"modal-wrapper\"></div>');\n    }\n    this.root = this.element.closest('.modal-page-container');\n\n    messageArea = this.element.find('.detailed-message');\n    if (messageArea.length === 1) {\n      $('body').on(`resize.modal-${this.id}`, () => {\n        this.sizeInner();\n      });\n      this.sizeInner();\n    }\n\n    /**\n    * Fires when the modal is about to open. You can return false to abort opening.\n    * @event beforeopen\n    * @memberof Modal\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n    elemCanOpen = this.element.triggerHandler('beforeopen', [this]);\n    $('body').triggerHandler('beforeopen', [this]);\n    this.isCancelled = false;\n\n    if (elemCanOpen === false) {\n      this.overlay.remove();\n      this.root[0].style.display = 'none';\n      return;\n    }\n\n    if (!ajaxReturn) {\n      this.callSource();\n\n      if (this.settings.beforeShow) {\n        return;\n      }\n    }\n\n    // Look for other nested dialogs and adjust the zindex.\n    const currentModalApi = this;\n    const modals = $('.modal');\n    const lastModalIndex = modals.length - 1;\n    modals.each(function (i) {\n      const modal = $(this);\n      this.style.zIndex = (1020 + (i + 1)).toString();\n\n      if (modal.data('modal') && modal.data('modal').overlay) {\n        modal.data('modal').overlay[0].style.zIndex = (1020 + i).toString();\n      }\n\n      if (!modal.data('modal')) {\n        const overlay = modal.closest('.modal-page-container').next('.overlay');\n        if (overlay && overlay[0]) {\n          overlay[0].style.zIndex = (1020 + i).toString();\n        }\n      }\n      if (i === lastModalIndex) {\n        const zIndex = {\n          element: parseInt(currentModalApi.element[0].style.zIndex, 10),\n          overlay: parseInt(currentModalApi.overlay[0].style.zIndex, 10)\n        };\n        if (!zIndex.overlay) {\n          currentModalApi.overlay[0].style.zIndex = zIndex.element - 1;\n        }\n      }\n    });\n\n    $('body > *').not(this.element).not('.modal, .overlay, .modal-page-container').attr('aria-hidden', 'true');\n\n    // Ensure aria-labelled by points to the id\n    if (this.settings.isAlert) {\n      this.element.attr('aria-labelledby', 'message-title');\n      this.element.attr('aria-describedby', 'message-text');\n    } else {\n      const h1 = this.element.find('h1:first');\n      let id = h1.attr('id');\n\n      if (!id) {\n        id = `${this.element.attr('id') ? this.element.attr('id') : 'h1'}-title`;\n        h1.attr('id', id);\n      }\n\n      const body = this.element.find('.modal-body');\n      const descById = `${this.element.attr('id') ? this.element.attr('id') : 'message'}-text`;\n\n      this.element.attr('aria-labelledby', id);\n\n      // Contextual Action Panel Case - Has a toolbar\n      if (this.element.find('.toolbar .title').length) {\n        this.element.find('.toolbar .title').attr('id', descById);\n        this.element.attr('aria-describedby', descById);\n      } else {\n        body.attr('id', descById);\n        this.element.attr('aria-describedby', descById);\n      }\n    }\n\n    this.mainContent = $('body').children('.scrollable-container');\n    if (!this.mainContent.length) {\n      this.mainContent = $('body');\n    }\n\n    this.removeNoScroll = !this.mainContent.hasClass('no-scroll');\n    this.mainContent.addClass('no-scroll');\n\n    $('body').on(`resize.modal-${this.id}`, () => {\n      this.resize();\n    });\n\n    // Center\n    this.root[0].style.display = '';\n    this.element[0].style.display = '';\n\n    setTimeout(() => {\n      this.resize();\n      this.element.addClass('is-visible').attr('role', (this.settings.isAlert ? 'alertdialog' : 'dialog'));\n      this.root.removeAttr('aria-hidden');\n      this.overlay.attr('aria-hidden', 'true');\n      this.element.attr('aria-modal', 'true'); // This is a forward thinking approach, since aria-modal isn't actually supported by browsers or ATs yet\n    }, 1);\n\n    // Add the 'modal-engaged' class after all the HTML markup and CSS classes have a\n    // chance to be established\n    // (Fixes an issue in non-V8 browsers (FF, IE) where animation doesn't work correctly).\n    // http://stackoverflow.com/questions/12088819/css-transitions-on-new-elements\n    $('body').addClass('modal-engaged');\n\n    // Handle Default button.\n    $(this.element).on('keypress.modal', (e) => {\n      const target = $(e.target);\n\n      if (target.is('.editor, .searchfield, textarea, :button') || target.closest('.tab-list').length || $('#dropdown-list').length) {\n        return;\n      }\n\n      if (e.which === 13 && this.isOnTop &&\n          !target.closest('form').find(':submit').length &&\n          this.element.find('.btn-modal-primary:enabled').length) {\n        e.stopPropagation();\n        e.preventDefault();\n\n        if ((!target.hasClass('fileupload') && !$(target).is(':input')) || target.hasClass('colorpicker')) {\n          this.element.find('.btn-modal-primary:enabled').trigger('click');\n        }\n      }\n    });\n\n    // Override this page's skip-link default functionality to instead focus the top\n    // of this element if it's clicked.\n    $('.skip-link').on('focus.modal', (e) => {\n      e.preventDefault();\n      this.getTabbableElements().first.focus();\n    });\n\n    function focusElement(self) {\n      let focusElem = self.element.find(':focusable').not('.modal-header .searchfield').first();\n      self.keepFocus();\n\n      /**\n      * Fires when the modal opens.\n      * @event open\n      * @memberof Modal\n      * @property {object} event - The jquery event object\n      * @property {object} ui - The dialog object\n      */\n      self.element.trigger('open', [self]);\n\n      if (focusElem.length === 0) {\n        focusElem = self.element.find('.btn-modal-primary');\n      }\n\n      if (focusElem.length === 1 && focusElem.is('.btn-modal')) {\n        focusElem = self.element.find('.btn-modal-primary');\n      }\n\n      if (focusElem.length === 1 && focusElem.is('button') && !focusElem.is(':disabled')) {\n        focusElem.addClass('hide-focus');\n      }\n\n      if (!self.settings.autoFocus) {\n        return;\n      }\n\n      // If the selected element is a tab, actually make sure it's the \"selected\" tab.\n      let selected;\n      let tabParent;\n\n      if (focusElem.is('.tab:not(.is-selected) a')) {\n        tabParent = focusElem.closest('.tab-container');\n        selected = tabParent.find('.is-selected');\n        if (selected.length) {\n          focusElem = selected;\n          tabParent.data('tabs').select(selected.children('a').attr('href'));\n          return;\n        }\n      }\n\n      // Otherwise, just focus\n      focusElem.focus();\n    }\n\n    const pagerElem = this.element.find('.paginated');\n    pagerElem.on('afterpaging', () => {\n      this.resize();\n    });\n\n    setTimeout(() => {\n      this.disableSubmit();\n    }, 10);\n\n    const fields = this.element.find('[data-validate]');\n    fields.removeClass('disable-validation');\n\n    setTimeout(() => {\n      focusElement(this);\n    }, 200);\n\n    /**\n    * Fires after the modal has opened.\n    * @event afteropen\n    * @memberof Modal\n    * @property {object} event - The jquery event object\n    * @property {object} ui - The dialog object\n    */\n    setTimeout(() => {\n      this.element.trigger('afteropen');\n    }, 300);\n  },\n\n  resize() {\n    // 90% -(180 :extra elements-height)\n    let calcHeight = ($(window).height() * 0.9) - this.settings.frameHeight;\n    const calcWidth = ($(window).width() * 1) - this.settings.frameWidth;\n\n    const wrapper = this.element.find('.modal-body-wrapper');\n\n    if (wrapper.length) {\n      wrapper[0].style.maxHeight = `${calcHeight}px`;\n      wrapper[0].style.maxWidth = `${calcWidth}px`;\n    }\n\n    if (this.element.hasClass('lookup-modal')) {\n      const table = this.element.find('.datagrid-body');\n      const hasPager = this.element.find('.pager-toolbar');\n      const container = table.closest('.datagrid-container');\n\n      calcHeight = calcHeight - (container.prev().is('.toolbar') ? 130 : 60) - (container.next().is('.pager-toolbar') ? 35 : 0);\n      table[0].style.maxHeight = `${calcHeight + (hasPager.length ? -15 : 0)}px`;\n      table[0].style.maxWidth = `${calcWidth}px`;\n    }\n\n    const toolbars = this.element.find('.toolbar');\n    if (toolbars.length) {\n      toolbars.triggerHandler('recalculate-buttons');\n    }\n  },\n\n  /**\n   * This method is slated to be removed in a future v4.20.0 or v5.0.0.\n   * @deprecated as of v4.14.0. Please use the `visible` property instead.\n   * @returns {boolean} The current state open (true) or closed (false).\n   */\n  isOpen() {\n    warnAboutDeprecation('visible', 'isOpen');\n    return this.visible;\n  },\n\n  getTabbableElements() {\n    const allTabbableElements = $(this.element).find('a[href], area[href], input:not([disabled]),' +\n      'select:not([disabled]), textarea:not([disabled]),' +\n      'button:not([disabled]), iframe, object, embed, *[tabindex],' +\n      '*[contenteditable]').filter(':visible');\n    return {\n      first: allTabbableElements[0],\n      last: allTabbableElements[allTabbableElements.length - 1]\n    };\n  },\n\n  keepFocus() {\n    const self = this;\n    let tabbableElements;\n\n    // Escape key\n    $(document)\n      .off(`keydown.modal-${this.id}`)\n      .on(`keydown.modal-${this.id}`, (e) => {\n        const keyCode = e.which || e.keyCode;\n        if (keyCode === 27) {\n          const modals = $('.modal.is-visible');\n\n          self.isCancelled = true;\n\n          if (modals.length > 1) {\n            modals.not(':last').on('beforeclose.modal', () => false);\n            modals.on('afterclose.modal', () => {\n              modals.off('beforeclose.modal');\n            });\n            const apiModal = modals.last().data('modal');\n            if (apiModal && apiModal.close) {\n              apiModal.close();\n            }\n          } else {\n            self.close();\n          }\n        }\n      });\n\n    $(self.element)\n      .off('keypress.modal keydown.modal')\n      .on('keypress.modal keydown.modal', (e) => {\n        const keyCode = e.which || e.keyCode;\n\n        if (keyCode === 9) {\n          tabbableElements = self.getTabbableElements();\n\n          // Move focus to first element that can be tabbed if Shift isn't used\n          if (e.target === tabbableElements.last && !e.shiftKey) {\n            e.preventDefault();\n            tabbableElements.first.focus();\n          } else if (e.target === tabbableElements.first && e.shiftKey) {\n            e.preventDefault();\n            tabbableElements.last.focus();\n          }\n\n          self.element.find('#message-title').removeAttr('tabindex');\n        }\n      });\n  },\n\n  /**\n   * Close the modal.\n   * @param  {boolean} destroy Call the destroy method.\n   * @returns {boolean} If the dialog was open returns false. If the dialog was closed is true.\n   */\n  close(destroy) {\n    if (!this.visible) {\n      return true;\n    }\n\n    const elemCanClose = this.element.triggerHandler('beforeclose');\n    const self = this;\n    const fields = this.element.find('[data-validate]');\n\n    this.root = this.element.closest('.modal-page-container');\n    fields.addClass('disable-validation');\n\n    if (elemCanClose === false) {\n      return false;\n    }\n\n    if (this.mainContent && this.removeNoScroll) {\n      this.mainContent.removeClass('no-scroll');\n    }\n    $('body').off(`resize.modal-${this.id}`);\n\n    this.element.off('keypress.modal keydown.modal');\n    this.element.removeClass('is-visible');\n\n    this.overlay.attr('aria-hidden', 'true');\n    if (this.root) {\n      this.root.attr('aria-hidden', 'true');\n    }\n\n    if ($('.modal-page-container').length <= 1) {\n      $('body').removeClass('modal-engaged');\n      $('body > *').not(this.element.closest('.modal-page-container')).removeAttr('aria-hidden');\n      $('.overlay').remove();\n    }\n\n    // Fire Events\n    self.element.trigger('close', self.isCancelled);\n\n    // Restore focus\n    if (this.oldActive && $(this.oldActive).is('a:visible, button:visible, input:visible, textarea:visible')) {\n      this.oldActive.focus();\n      this.oldActive = null;\n    } else if (this.trigger.parents('.toolbar, .formatter-toolbar').length < 1) {\n      this.trigger.focus();\n    }\n\n    // close tooltips\n    $('#validation-errors, #tooltip, #validation-tooltip').addClass('is-hidden');\n\n    // remove the event that changed this page's skip-link functionality in the open event.\n    $('.skip-link').off('focus.modal');\n\n    setTimeout(() => {\n      self.overlay.remove();\n      self.root[0].style.display = 'none';\n      self.element.trigger('afterclose');\n\n      if (self.settings.trigger === 'immediate' || destroy) {\n        if (!self.isCAP || (self.isCAP && !self.capAPI)) {\n          self.destroy();\n        }\n      }\n    }, 300); // should match the length of time needed for the overlay to fade out\n\n    return false;\n  },\n\n  /**\n   * Update the modal\n   * @param {settings} settings The settings to update on the modal\n   * @returns {object} The modal object for chaining.\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    if (this.settings.trigger === 'immediate') {\n      this.open();\n    }\n\n    return this;\n  },\n\n  /**\n   * Destroy the modal.\n   */\n  destroy() {\n    const self = this;\n    const canDestroy = this.element.trigger('beforedestroy');\n\n    if (!canDestroy) {\n      return;\n    }\n\n    function destroyCallback() {\n      if (self.modalButtons) {\n        self.element.find('button').off('click.modal');\n      }\n\n      if (self.element.find('.detailed-message').length === 1) {\n        $('body').off(`resize.modal-${this.id}`);\n      }\n\n      // Properly teardown contexual action panels\n      if (self.isCAP && self.capAPI) {\n        self.capAPI.teardown();\n      }\n\n      self.trigger.off('click.modal');\n\n      if (self.root && self.root.length) {\n        self.root.remove();\n      } else {\n        self.element.closest('.modal-page-container').remove();\n      }\n      self.element[0].removeAttribute('data-modal');\n\n      $.removeData(self.element[0], 'modal');\n      if (self.isCAP && self.capAPI) {\n        self.capAPI.destroy();\n      }\n    }\n\n    if (!this.visible) {\n      destroyCallback();\n      return;\n    }\n\n    this.element.one('afterclose.modal', () => {\n      destroyCallback();\n    });\n\n    this.close(true);\n  }\n};\n\nexport { Modal, COMPONENT_NAME };\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\n\n// jQuery Components\nimport '../modal/modal';\n\n// This component name\nconst COMPONENT_NAME = 'message';\n\n/**\n * The Message Component is used to show warning / error messages.\n * @class Message\n * @param {object} element The component element.\n * @param {object} [settings] The component settings.\n * @param {string} [settings.title='Message Title']  Title text or content shown in the message\n * @param {string} [settings.status='']  Pass a status to style icon and title color ('error', 'alert', 'success')\n * @param {string} [settings.message='Message Summary']  The message content or text\n * @param {number} [settings.width='auto']  Pass a specific with or defaults to auto\n * @param {object} [settings.buttons=null]  Array of buttons to add to the message (see modal examples as well)\n * @param {string} [settings.cssClass=null]  Extra Class to add to the dialog for customization.\n * @param {string} [settings.returnFocus=null]  JQuery Element selector to focus on return.\n * @param {string} [allowedTags='<a><b><br><br/><del><em><i><ins><mark><small><strong><sub><sup>']  String of allowed HTML tags.\n */\nconst MESSAGE_DEFAULTS = {\n  title: 'Message Title',\n  status: '',\n  message: 'Message Summary',\n  width: 'auto',\n  buttons: null,\n  cssClass: null,\n  returnFocus: null,\n  allowedTags: '<a><b><br><br/><del><em><i><ins><mark><small><strong><sub><sup>'\n};\n\nfunction Message(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(element, settings, MESSAGE_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nMessage.prototype = {\n\n  init() {\n    const self = this;\n    let content;\n    const tags = this.settings.allowedTags;\n    let allowTags = true;\n\n    // Check for any allowed tags in settings string\n    if (!(this.settings.allowedTags.length > 0)) {\n      allowTags = false;\n    }\n\n    // Create the Markup\n    this.message = $('<div class=\"modal message\"></div>');\n    this.messageContent = $('<div class=\"modal-content\"></div>');\n    this.title = $(`<h1 class=\"modal-title\" id=\"message-title\">${allowTags ? xssUtils.stripTags(this.settings.title, tags) : xssUtils.stripHTML(this.settings.title)}</h1>`).appendTo(this.messageContent).wrap('<div class=\"modal-header\"></div>');\n    this.content = $(`<div class=\"modal-body\"><p class=\"message\" id=\"message-text\">${allowTags ? xssUtils.stripTags(this.settings.message, tags) : xssUtils.stripHTML(this.settings.message)}</p></div>`).appendTo(this.messageContent);\n\n    if (this.title.text().toLowerCase().indexOf('alert') === -1) {\n      this.title.text(`Alert: ${this.title.text()}`);\n    }\n\n    // Append The Content if Passed in\n    if (!this.element.is('body')) {\n      content = this.element;\n      this.content.empty().append(content.show());\n    }\n\n    this.message.append(this.messageContent).appendTo('body');\n    this.message.modal({\n      trigger: 'immediate',\n      buttons: this.settings.buttons,\n      resizable: this.settings.resizable,\n      close: this.settings.close,\n      isAlert: true\n    });\n\n    // Adjust Width if Set as a Setting\n    if (this.settings.width !== 'auto') {\n      this.content.closest('.modal')[0].style.maxWidth = 'none';\n      this.content.closest('.modal')[0].style.width = this.settings.width + (/(px|%)/i.test(`${this.settings.width}`) ? '' : 'px');\n    }\n\n    if (this.settings.cssClass) {\n      this.message.addClass(this.settings.cssClass);\n    }\n\n    // Setup the destroy event to fire on close.\n    // Needs to fire after the \"close\" event on the modal.\n    this.message.on('beforeclose.message', () => {\n      const ok = self.element.triggerHandler('beforeclose');\n      return ok;\n    }).on('beforeopen.message', () => {\n      const ok = self.element.triggerHandler('beforeopen');\n      return ok;\n    }).on('open.message', () => {\n      self.element.trigger('open');\n    }).on('afterclose.message', () => {\n      self.destroy();\n      if (self.settings.returnFocus) {\n        self.settings.returnFocus.focus();\n      }\n\n      $(document).off('keypress.message keydown.message');\n    });\n\n    $(document).on('keypress.message keydown.message', (e) => {\n      const keyCode = e.which || e.keyCode;\n\n      if (keyCode === 27) {\n        setTimeout(() => {\n          const modalData = self.message.data('modal');\n          if (modalData !== undefined) {\n            modalData.close();\n          }\n        }, 0);\n      }\n    });\n\n    if (this.settings.status === 'error') {\n      this.title.addClass('has-status is-error').prepend($.createIconElement('error'));\n    } else if (this.settings.status === 'alert') {\n      this.title.addClass('has-status is-alert').prepend($.createIconElement('alert'));\n    } else if (this.settings.status === 'success') {\n      this.title.addClass('has-status is-success').prepend($.createIconElement('success'));\n    } else {\n      this.title.removeClass('has-status is-error is-alert is-success').find('svg').remove();\n    }\n  },\n\n  destroy() {\n    const modalData = this.message.data('modal');\n    if (modalData !== undefined) {\n      modalData.destroy();\n    }\n\n    this.message\n      .off('beforeclose.message beforeopen.message open.message afterclose.message')\n      .remove();\n  }\n};\n\nexport { Message, COMPONENT_NAME };\n","import { Message } from './message';\n\n/**\n * jQuery Component Wrapper for Messages\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.message = function (settings) {\n  // Support Chaining and Init the Control or Set Settings\n  return this.each(function () {\n    return new Message(this, settings);\n  });\n};\n","import { Modal, COMPONENT_NAME } from './modal';\n\n/**\n* jQuery Component Wrapper for Modal\n* @param {object} settings The settings to apply.\n* @returns {jQuery[]} The jquery object for chaining.\n*/\n$.fn.modal = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    const elem = $(this);\n\n    if (!elem.is('.modal')) {\n      instance = elem.closest('.modal').data(COMPONENT_NAME);\n    }\n\n    if (instance && settings) {\n      instance.updated(settings);\n      // This was added for backwards compatability when using:\n      // `$(this).modal('close');`\n      // Examples have been updated to not show this.\n      if (typeof instance[settings] === 'function') {\n        instance[settings]();\n      }\n      return;\n    }\n\n    if (instance && !settings) {\n      return;\n    }\n\n    instance = $.data(this, COMPONENT_NAME, new Modal(this, settings));\n  });\n};\n","import { MonthView, COMPONENT_NAME } from './monthview';\n\n/**\n * jQuery Component Wrapper for MonthView\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.monthview = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new MonthView(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\n\n// jQuery Components\nimport '../dropdown/dropdown.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'multiselect';\n\n// Component Defaults\nconst MULTISELECT_DEFAULTS = {\n  closeOnSelect: false,\n  empty: true,\n  filterMode: 'contains',\n  maxSelected: undefined,\n  moveSelected: 'all',\n  multiple: true,\n  showEmptyGroupHeaders: false,\n  showSelectAll: false,\n  source: undefined\n};\n\n/**\n * The MultiSelect Component allows selecting multiple items from a list\n * @class MultiSelect\n * @constructor\n * @param {jQuery[]|HTMLElement} element the base element\n * @param {object} [settings] incoming settings\n * @param {string} [settings.filterMode = 'contains']  The search mode to use, can be 'contains' or 'startsWith'\n * @param {number} [settings.maxSelected = null]  The max number of items which can be selected\n * @param {string} [settings.moveSelected = 'all']   Move selected options in each group to just underneath their corresponding group headers.\n * @param {boolean} [settings.showEmptyGroupHeaders = false]  If true groups with no items will still show the empty group header.\n * @param {boolean} [settings.showSelectAll = false]  Show the select all button and text .\n * @param {function} [settings.source]  The calback for ajax.\n */\nfunction MultiSelect(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, MULTISELECT_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nMultiSelect.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.build();\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  build() {\n    this.element.dropdown(this.settings);\n    this.dropdown = this.element.data('dropdown');\n\n    return this;\n  },\n\n  /**\n   * Enable the multiselect input\n   * @returns {void}\n   */\n  enable() {\n    this.dropdown.enable();\n  },\n\n  /**\n  * Disable the multiselect input\n  * @returns {void}\n  */\n  disable() {\n    this.dropdown.disable();\n  },\n\n  /**\n  * Trigger a rebuild due to settings change\n  * @param {object} [settings] incoming settings\n  * @returns {void}\n  */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.build();\n  },\n\n  /**\n   * Remove added markup and events\n   * @returns {void}\n   */\n  destroy() {\n    this.dropdown.destroy();\n    this.element.off();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { MultiSelect, COMPONENT_NAME };\n","import { MultiSelect, COMPONENT_NAME } from './multiselect';\n\n/**\n * jQuery Component wrapper for Multiselect\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.multiselect = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new MultiSelect(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Settings and Options\nconst COMPONENT_NAME = 'notification';\n\nconst NOTIFICATION_DEFAULTS = {\n  message: 'Hi! Im a notification message.',\n  type: 'alert',\n  parent: '.header',\n  link: '#',\n  linkText: 'Click here to view.'\n};\n\n/**\n * Notification - Shows a slide in notifcation banner on the top of the page.\n * @class Notification\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings] The settings element.\n * @param {string} [settings.message] The text message to show in the notification.\n * @param {string} [settings.type] The message type, this influences the icon and color, possible types are 'error', 'alert', 'info' and 'success'\n * @param {string} [settings.parent] The jQuery selector to find where to insert the message into (prepended). By default this will appear under the .header on the page.\n * @param {string} [settings.link] The url to use for the hyperlink\n * @param {string} [settings.linkText] The text to show in the hyperlink. Leave empty for no link.\n */\nfunction Notification(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, NOTIFICATION_DEFAULTS);\n  this.element = $(element);\n  this.init();\n}\n\n// Plugin Methods\nNotification.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The Notification prototype, useful for chaining.\n   */\n  init() {\n    return this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n   * Add any needed markup to the component.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  build() {\n    this.notificationEl = document.createElement('div');\n\n    // IE 10/11 does not support multiple paramets for classList.add()\n    this.notificationEl.classList.add('notification');\n    this.notificationEl.classList.add(this.settings.type);\n\n    const htmlIcon = `\n      <svg class=\"icon notification-icon icon-${this.settings.type}\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n        <use xlink:href=\"#icon-${this.settings.type}\"></use>\n      </svg>`;\n\n    let htmlText = `<p class=\"notification-text\">${this.settings.message}`;\n\n    if (this.settings.linkText) {\n      htmlText += `<a class=\"notification-link\" href=\"${this.settings.link}\">${this.settings.linkText}</a>`;\n    }\n\n    htmlText += '</p>';\n\n    const htmlButton = `\n      <button type=\"text\" class=\"notification-close\">\n        <svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n          <use xlink:href=\"#icon-close\"></use>\n        </svg>\n        <span class=\"audible\">${Locale.translate('Close')}</span>\n      </button>`;\n\n    this.notificationEl.innerHTML = htmlIcon.concat(htmlText, htmlButton);\n\n    const parentEl = document.querySelector(this.settings.parent);\n\n    parentEl.parentNode.insertBefore(this.notificationEl, parentEl.nextSibling);\n    $(this.notificationEl).animateOpen();\n    return this;\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.off(`updated.${COMPONENT_NAME}`).on(`updated.${COMPONENT_NAME}`, () => {\n      self.updated();\n    });\n\n    $(this.notificationEl).off(`click.${COMPONENT_NAME}`).on(`click.${COMPONENT_NAME}`, '.notification-close', () => {\n      self.destroy();\n    });\n\n    return this;\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param {object} [settings] incoming settings\n   * @returns {object} [description]\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, NOTIFICATION_DEFAULTS);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    this.element.off(`click.${COMPONENT_NAME}`, '.notification-close');\n    return this;\n  },\n\n  /**\n   * Destroy and remove added markup and detatch events.\n   */\n  destroy() {\n    if (this.notificationEl && this.notificationEl.parentNode) {\n      this.notificationEl.parentNode.removeChild(this.notificationEl);\n    }\n\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Notification, COMPONENT_NAME };\n","import { Notification, COMPONENT_NAME } from './notification';\n\n/**\n * jQuery Component Wrapper for notification\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.notification = function (settings) {\n  return this.each(function () {\n    $.data(this, COMPONENT_NAME, new Notification(this, settings));\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\n\n// jQuery components\nimport '../tooltip/tooltip.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'progress';\n\n// Default Progress Options\nconst PROGRESS_DEFAULTS = {\n};\n\n/**\n* A list of items with add/remove/delete and sort functionality.\n* @class Progress\n* @constructor\n* @param {jQuery[]|HTMLElement} element The component element.\n* @param {object} [settings] The component settings.\n*/\nfunction Progress(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, PROGRESS_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Actual Progress Code\nProgress.prototype = {\n\n  /**\n   * Init this component.\n   * @private\n   */\n  init() {\n    this.update();\n\n    this.element.off('updated.progress').on('updated.progress', (e) => {\n      e.stopPropagation();\n      this.update();\n    });\n  },\n\n  /**\n   * Update the aria on this component\n   * @private\n   * @param  {string} value The progress value.\n   */\n  updateAria(value) {\n    this.element.attr({ role: 'progressbar', 'aria-valuenow': value, 'aria-valuemax': '100' });\n\n    const container = this.element.parent();\n    if (container.data('tooltip')) {\n      container.data('tooltip').content = `${value}%`;\n    } else {\n      container[0].setAttribute('title', `${value}%`);\n      container.tooltip();\n    }\n  },\n\n  /**\n   * Unbind all events.\n   * @private\n   */\n  unbind() {\n    this.element.off('updated.progress');\n  },\n\n  /**\n  * Update the progress bar.\n  * @param {string} value  The percent value to use to fill. 0-100\n  * @returns {void}\n  */\n  update(value) {\n    let perc = this.element.attr('data-value');\n\n    if (value) {\n      perc = value;\n      this.element.attr('data-value', value);\n    }\n\n    this.element[0].style.width = `${perc}%`;\n    this.updateAria(perc);\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, PROGRESS_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n  * Teardown and remove any added markup and events.\n  */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Progress, COMPONENT_NAME };\n","import { Progress, COMPONENT_NAME } from './progress';\n\n/**\n * jQuery Component Wrapper for Progress\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.progress = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Progress(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\n\n// Component Name\nconst COMPONENT_NAME = 'popdown';\n\n/**\n * The Popdown Component can be used to open an animated popdown from a button. This may in the future\n * be deprecated to one thing. Popup vs Popdown vs Tooltip.\n * @class Popdown\n * @deprecated\n * @param {object} element The component element.\n * @param {object} [settings] The component settings.\n * @property {boolean} [settings.keepOpen = false] If true, will keep the Popdown open after clicking out until the Trigger\n * element is clicked, or until another pop-open element is opened.\n * @property {jQuery[]} [settings.trigger] If defined, provides a way to place the popdown against an alternate element.\n*/\nconst POPDOWN_DEFAULTS = {\n  keepOpen: false,\n  trigger: undefined\n};\n\nfunction Popdown(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, POPDOWN_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nPopdown.prototype = {\n\n  init() {\n    return this\n      .setup()\n      .build()\n      .handleEvents();\n  },\n\n  setup() {\n    const self = this;\n    this.popdown = $();\n\n    // Setup the proper trigger element to use\n    this.trigger = this.element;\n    if (this.settings.trigger instanceof $ || DOM.isElement(this.settings.trigger)) {\n      this.trigger = $(this.settings.trigger);\n    }\n    // Force-change the trigger element in some specific scenarios\n    if (this.trigger.is('.dropdown, .multiselect')) {\n      this.trigger = $(`#${this.element.attr('id')}-shdo`);\n    }\n\n    // Find the correct element to use as the popdown's view.\n    function tryPopdownElement(elem) {\n      if (!elem) { return false; }\n\n      if (typeof elem === 'string') {\n        if (!elem.match('#') || elem.indexOf('#') !== 0) {\n          elem = `#${elem}`;\n        }\n        elem = $(elem);\n      }\n\n      if (elem.length) {\n        self.popdown = elem;\n        return true;\n      }\n\n      return false;\n    }\n\n    const popdownElem = tryPopdownElement(this.trigger.attr('data-popdown'));\n    if (!popdownElem) {\n      tryPopdownElement(this.trigger.next('.popdown'));\n    }\n\n    // Setup an ID for this popdown if it doesn't already have one\n    this.id = this.popdown.attr('id');\n    if (!this.id) {\n      this.id = `popdown-${$('body').find('.popdown').index(this.popdown)}`;\n      this.popdown.attr('id', this.id);\n    }\n\n    return this;\n  },\n\n  build() {\n    // Ensure the popdown window is a popdown, and remove any hidden classes from it.\n    this.popdown.addClass('popdown').removeClass('hidden');\n\n    // Wrap the contents inside for spacing purposes\n    const contents = this.popdown.children('.popdown-contents');\n    if (!contents.length) {\n      this.popdown.children().wrap('<div class=\"popdown-contents\"></div>');\n    }\n\n    // Add the arrow markup if it doesn't already exist\n    this.arrow = $('<div class=\"arrow\"></div>').prependTo(this.popdown);\n\n    this.place();\n\n    // Expand if necessary\n    const ariaExpanded = this.trigger.attr('aria-expanded');\n    if (!ariaExpanded || ariaExpanded === undefined) {\n      this.trigger.attr('aria-expanded', '');\n    }\n    if (ariaExpanded === 'true') {\n      this.open();\n    }\n\n    // aria-controls for the trigger element\n    if (this.trigger) {\n      this.trigger[0].setAttribute('aria-controls', this.id);\n    }\n    return this;\n  },\n\n  handleEvents() {\n    const self = this;\n\n    this.trigger\n      .on('click.popdown', () => {\n        self.toggle();\n      })\n      .on('updated.popdown', () => {\n        self.updated();\n      });\n\n    return this;\n  },\n\n  hasValidTriggerSetting() {\n    return (this.settings.trigger instanceof $ || DOM.isElement(this.settings.trigger));\n  },\n\n  /**\n   * Detects whether or not the Popdown has focus.\n   * @private\n   * @returns {boolean} whether or not the element is currently focused.\n   */\n  hasFocus() {\n    const active = document.activeElement;\n    if (this.trigger.is(active)) {\n      return true;\n    }\n    if ($.contains(this.popdown[0], active)) {\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * Determines whether or not the popdown is open.\n   * @returns {boolean} returns current state.\n   */\n  isOpen() {\n    return this.trigger.attr('aria-expanded') === 'true';\n  },\n\n  /**\n   * Open the popdown.\n   */\n  open() {\n    if (this.isAnimating) {\n      return;\n    }\n\n    const self = this;\n    let setFocusinEvent = false;\n\n    this.isAnimating = true;\n    this.trigger.attr('aria-expanded', 'true');\n    this.position();\n    this.popdown.addClass('visible');\n\n    // Setup events that happen on open\n    // Needs to be on a timer to prevent automatic closing of popdown.\n    setTimeout(() => {\n      $('body').on('resize.popdown', () => {\n        if (!self.hasFocus()) {\n          self.close();\n        }\n      });\n\n      // Only allow $(document).click() to close the Popdown if `keepOpen` isn't set.\n      if (!self.settings.keepOpen) {\n        $(document).on('click.popdown', () => {\n          if (!self.hasFocus()) {\n            self.close();\n          }\n        });\n\n        // When focusing in on other important page elements, this Popdown instance will check to\n        // see if it contains those elements, and will close if it doesn't.\n        if (!setFocusinEvent) {\n          setFocusinEvent = true;\n          $(document).on('focusin.popdown', () => {\n            if (!self.hasFocus()) {\n              self.close();\n            }\n          });\n        }\n      }\n\n      self.isAnimating = false;\n    }, 400);\n  },\n\n  /**\n   * Close the popdown.\n   */\n  close() {\n    if (this.isAnimating) {\n      return;\n    }\n\n    const self = this;\n    this.isAnimating = true;\n    this.trigger.attr('aria-expanded', 'false');\n    this.popdown.removeClass('visible');\n\n    // Turn off events\n    this.popdown.off('focusin.popdown');\n    $('body').off('resize.popdown');\n    $(document).off('click.popdown focusin.popdown');\n\n    // Sets the element to \"display: none\" to prevent interactions while hidden.\n    setTimeout(() => {\n      self.popdown[0].style.display = 'none';\n      self.isAnimating = false;\n    }, 400);\n  },\n\n  /**\n   * Toggle the popdown.\n   */\n  toggle() {\n    if (this.isOpen()) {\n      this.close();\n      return;\n    }\n    this.open();\n  },\n\n  /**\n   * Detaches Popdown Element and places at the body tag root, or at the root of the nearest scrollable parent.\n   * @private\n   */\n  place() {\n    this.scrollparent = $('body');\n    this.popdown.detach().appendTo(this.scrollparent);\n  },\n\n  /**\n   * Set the right popdown position.\n   * @private\n   */\n  position() {\n    const parent = {\n      offset: {\n        left: 0,\n        top: 0\n      },\n      scrollDistance: {\n        left: 0,\n        top: 0\n      }\n    };\n    let winH = window.innerHeight + $(document).scrollTop();\n    // subtract 2 from the window width to account for the tooltips\n    // resizing themselves to fit within the CSS overflow boundary.\n    let winW = (window.innerWidth - 2) + $(document).scrollLeft();\n\n    // Reset adjustments to panel and arrow\n    this.popdown.removeAttr('style');\n    this.arrow.removeAttr('style');\n\n    // Add/subtract offsets if a scrollable parent element is involved\n    if (this.scrollparent.length) {\n      parent.offset = this.scrollparent.offset();\n      parent.scrollDistance.top = this.scrollparent.scrollTop();\n      parent.scrollDistance.left = this.scrollparent.scrollLeft();\n      winH -= (parent.offset.top + parent.scrollDistance.top);\n      winW -= (parent.offset.left + parent.scrollDistance.left);\n    }\n\n    let adjustX = false;\n    let adjustY = false;\n    const t = this.trigger;\n    const to = t.offset(); // Trigger offset\n    const arrowHeight = 11;\n    let XoffsetFromTrigger = 0;\n    let YoffsetFromTrigger = 0;\n    let po; // Popover offset\n\n    // Place the popdown below to start\n    this.popdown.addClass('bottom');\n\n    this.popdown[0].style.left = `${to.left}px`;\n    this.popdown[0].style.top = `${to.top + t.outerHeight(true) + arrowHeight}px`;\n\n    this.arrow[0].style.left = `${t.outerWidth(true) / 2}px`;\n    this.arrow[0].style.top = `${0 - arrowHeight}px`;\n\n    // Get the newly-set values for the popdown's offset\n    po = this.popdown.offset();\n\n    // Get deltas for popdown position if the button is off either X edge\n    if (po.left < 0) { // Checking the left edge\n      adjustX = true;\n      XoffsetFromTrigger = 0 - po.left;\n    }\n    const rightEdgePos = po.left + this.popdown.outerWidth(true);\n    if (rightEdgePos > winW) { // Checking the right edge\n      adjustX = true;\n      XoffsetFromTrigger = rightEdgePos - winW + (Locale.isRTL() ? 20 : 0);\n    }\n\n    if (adjustX) {\n      // Adjust the X position based on the deltas\n      this.popdown[0].style.left = `${po.left + (XoffsetFromTrigger * -1)}px`;\n\n      const popdownRect = this.popdown[0].getBoundingClientRect();\n      const triggerRect = t[0].getBoundingClientRect();\n      const deltaRightEdge = popdownRect.right - triggerRect.right + 10;\n\n      this.arrow[0].style.left = 'auto';\n      this.arrow[0].style.right = `${deltaRightEdge}px`;\n\n      // Get the newly set values\n      po = this.popdown.offset();\n    }\n\n    // Get the deltas for popdown position if the button is off either Y edge\n    if (po.top < 0) { // Checking top edge\n      adjustY = true;\n      YoffsetFromTrigger = 0 - po.top;\n    }\n    let bottomEdgePos = po.top + this.popdown.outerHeight(true);\n    if (bottomEdgePos > winH) { // Checking the bottom edge\n      adjustY = true;\n      YoffsetFromTrigger = bottomEdgePos - winH;\n    }\n\n    // Remove the arrow if we need to adjust this, since it won't line up anymore\n    if (adjustY) {\n      this.arrow[0].style.display = 'none';\n\n      // Adjust the Y position based on the deltas\n      this.popdown[0].style.top = `${po.top + (YoffsetFromTrigger * -1)}px`;\n      this.arrow[0].style.top = `${parseInt(this.arrow[0].style.top, 10) - (YoffsetFromTrigger * -1)}px`;\n\n      // Get the values again\n      po = this.popdown.offset();\n    }\n\n    // One last check of the Y edges.  At this point, if either edge is out of bounds, we need to\n    // shrink the height of the popdown, as it's too tall for the viewport.\n    if (po.top < 0 || po.top + this.popdown.outerHeight(true) > winH) {\n      this.popdown[0].style.top = 0;\n      po = this.popdown.offset();\n\n      bottomEdgePos = po.top + this.popdown.outerHeight(true);\n      this.popdown[0].style.height = `${parseInt(this.popdown[0].style.height, 10) - (bottomEdgePos - winH)}px`;\n    }\n  },\n\n  /**\n   * Update the popdown and refresh with new settings\n   * @param  {object} settings The new settings\n   * @returns {object} The component api.\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    if (this.hasValidTriggerSetting()) {\n      this.trigger = $(this.settings.trigger);\n    }\n\n    return this;\n  },\n\n  /**\n   * Release Events\n   * @private\n   * @returns {object} The component api.\n   */\n  teardown() {\n    if (this.isOpen()) {\n      this.close();\n    }\n\n    this.trigger\n      .off('updated.popdown click.popdown')\n      .removeAttr('aria-controls')\n      .removeAttr('aria-expanded');\n\n    if (this.originalParent && this.originalParent.length) {\n      this.popdown.detach().appendTo(this.originalParent);\n    }\n\n    this.arrow.remove();\n\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Popdown, COMPONENT_NAME };\n","import { Popdown, COMPONENT_NAME } from './popdown';\n\n/**\n * jQuery component wrapper for Popdown\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery selector containing all elements\n */\n$.fn.popdown = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Popdown(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils, math } from '../../utils/utils';\n\n// Component Name\nconst COMPONENT_NAME = 'rating';\n\n// Default Rating Options\nconst RATING_DEFAULTS = {\n};\n\n/**\n * @class Rating\n * @param {jQuery[]|HTMLElement} element The component element.\n * @param {object} [settings] The component settings.\n */\nfunction Rating(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, RATING_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Actual Rating Code\nRating.prototype = {\n  init() {\n    this.handleEvents();\n    this.allInputs = this.element.find('input');\n    this.readonly();\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const inputs = $('input', this.element);\n\n    for (let i = 0, l = inputs.length; i < l; i++) {\n      $(inputs[i]).on(`change.${COMPONENT_NAME}`, () => {\n        if (!this.element.hasClass('is-readonly')) {\n          this.val(i + 1);\n        }\n      });\n    }\n  },\n\n  /**\n   * Icon filled star\n   * @param {jQuery|HTMLElement} inpt - Input element\n   * @param {jQuery|HTMLElement} svg - SVG element\n   */\n  fillStar(inpt, svg) {\n    $(inpt)\n      .addClass('is-filled')\n      .removeClass('is-half')\n      .next(svg)\n      .find('svg')\n      .changeIcon('star-filled');\n  },\n\n  /**\n   * Icon empty star\n   * @param {jQuery|HTMLElement} inpt - Input element\n   * @param {jQuery|HTMLElement} svg - SVG element\n   */\n  emptyStar(inpt, svg) {\n    $(inpt)\n      .removeClass('is-filled')\n      .removeClass('is-half')\n      .next(svg)\n      .find('svg')\n      .changeIcon('star-outlined');\n  },\n\n  /**\n   * Icon half star\n   * @param {jQuery|HTMLElement} inpt - Input element\n   * @param {jQuery|HTMLElement} svg - SVG element\n   */\n  halfStar(inpt, svg) {\n    $(inpt)\n      .addClass('is-half')\n      .removeClass('is-filled')\n      .next(svg)\n      .find('svg')\n      .changeIcon('star-half');\n  },\n\n  /**\n   * Optionally set the value and return the current value\n   * @param {number} [value] - A new value\n   * @returns {number}- The current value\n   */\n  val(value) {\n    if (arguments.length === 0\n      || value === ''\n      || isNaN(value)\n      || math.sign(value) === -1\n    ) {\n      return this.currentValue;\n    }\n\n    this.currentValue = parseFloat(value, 10);\n    const chkIdx = Math.floor(this.currentValue);\n\n    for (let i = 0, l = this.allInputs.length; i < l; i++) {\n      const input = $(this.allInputs[i]);\n      const svgSelector = input.parent().is('.inline') ? 'svg' : 'label';\n      const valNotAWholeNumber = (value % 1 !== 0 && chkIdx === i);\n\n      if (valNotAWholeNumber) {\n        this.halfStar(input, svgSelector);\n      } else if (i < value) {\n        this.fillStar(input, svgSelector);\n      } else {\n        this.emptyStar(input, svgSelector);\n      }\n\n      if (i + 1 === chkIdx) {\n        input.prop('checked', true);\n      }\n    }\n\n    if (chkIdx <= 0 && value > 0) {\n      $(this.allInputs[0]).prop('checked', true);\n    }\n\n    return this.currentValue;\n  },\n\n  /**\n  * Set component to readonly.\n  * @returns {void}\n  */\n  readonly() {\n    const elem = $(this.element);\n    if (elem.hasClass('is-readonly')) {\n      elem.find('input').attr('disabled', '');\n    }\n  },\n\n  /**\n  * Set component to enable.\n  * @returns {void}\n  */\n  enable() {\n    const elem = $(this.element);\n    elem.removeClass('is-readonly').find('input').removeAttr('disabled');\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.element.find('input').off(`change.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, RATING_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n  * Destroy and remove added markup, all events\n  * @returns {void}\n  */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Rating, COMPONENT_NAME };\n","import { Rating, COMPONENT_NAME } from './rating';\n\n/**\n * jQuery Component Wrapper for Rating\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.rating = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Rating(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Component Name\nconst COMPONENT_NAME = 'signin';\n\n// Default SignIn Options\nconst SIGNIN_DEFAULTS = {\n};\n\n/**\n* The sign in page component.\n* @class SignIn\n* @param {string} element The component element.\n* @param {string} [settings] The component settings.\n*/\nfunction SignIn(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, SIGNIN_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nSignIn.prototype = {\n\n  init() {\n    this.handleKeys();\n  },\n\n  /**\n   * Checks a keyboard event for a CAPS LOCK modifier.\n   * @private\n   * @param {object} e jQuery.Event\n   * @returns {boolean} true if caps lock\n   */\n  isCapslock(e) {\n    e = e || window.event;\n    let charCode = false;\n    let shifton = false;\n\n    if (e.which) {\n      charCode = e.which;\n    } else if (e.keyCode) {\n      charCode = e.keyCode;\n    }\n\n    if (e.shiftKey) {\n      shifton = e.shiftKey;\n    } else if (e.modifiers) {\n      shifton = !!(e.modifiers & 4);// eslint-disable-line\n    }\n\n    if (charCode >= 97 && charCode <= 122 && shifton) {\n      return true;\n    }\n    if (charCode >= 65 && charCode <= 90 && !shifton) {\n      return true;\n    }\n    return false;\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    $('body').off('keypress.signin blur.signin change.signin');\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, SIGNIN_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleKeys() {\n    const self = this;\n    const cssIcon = $.createIconElement({ classes: 'icon-capslock', icon: 'capslock' });\n\n    // Disable default [caps lock on] popup in IE\n    document.msCapsLockWarningOff = true;\n\n    this.element\n      .on('keypress.signin', '[type=\"password\"]', function (e) {\n        const field = $(this);\n        const fieldParent = field.parent('.field');\n        const iconCapslock = $('.icon-capslock', fieldParent);\n\n        if (self.isCapslock(e) && !field.hasClass('error')) {\n          if (!iconCapslock.length) {\n            fieldParent.append(cssIcon);\n            $('body').toast({ audibleOnly: true, message: Locale.translate('CapsLockOn') });\n          }\n        } else {\n          iconCapslock.remove();\n        }\n      })\n      .on('blur.signin change.signin', '[type=\"password\"]', function () {\n        const field = $(this);\n        const fieldParent = field.closest('.field');\n        const iconCapslock = $('.icon-capslock', fieldParent);\n\n        setTimeout(() => {\n          if (iconCapslock && iconCapslock.length) {\n            if (field.hasClass('error')) {\n              iconCapslock.remove();\n            } else {\n              fieldParent.append(cssIcon);\n            }\n          }\n        }, 150);\n      });\n  }\n};\n\nexport { SignIn, COMPONENT_NAME };\n","import { SignIn, COMPONENT_NAME } from './signin';\n\n/**\n * jQuery Component Wrapper for SignIn\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.signin = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new SignIn(this, settings));\n    }\n  });\n};\n","/* eslint-disable no-underscore-dangle */\nimport * as debug from '../../utils/debug';\nimport { deprecateMethod } from '../../utils/deprecated';\nimport { theme } from '../theme/theme';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../drag/drag.jquery';\nimport '../tooltip/tooltip.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'slider';\n\n// The Component Defaults\nconst SLIDER_DEFAULTS = {\n  value: [50],\n  min: 0,\n  max: 100,\n  range: false,\n  step: undefined,\n  ticks: [],\n  tooltipContent: undefined,\n  persistTooltip: false\n};\n\n/**\n * Touch Enabled/Responsive and Accessible Slider Control\n * @class Slider\n * @param {jQuery[]|HTMLElement} element The DOM element\n * @param {object} [settings] incoming settings\n * @param {array} [settings.value = [50]] An array with the slider values. Or one if a single value slider.\n * @param {number} [settings.min = 0] The minimum slider value.\n * @param {number} [settings.max = 100] The maximum slider value.\n * @param {boolean} [settings.range = false] If true a range slider with two selectors is formed.\n * @param {undefined|Number} [settings.step] If added will be the number of slider steps to use.\n * @param {array} [settings.ticks = []] An array of the ticks to use for the steps\n * @param {undefined|Array} [settings.tooltipContent] Special customizable tooltip content.\n * @param {boolean} [settings.persistTooltip = false] If true the tooltip will stay visible.\n */\nfunction Slider(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, SLIDER_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Check if is an integer\nfunction isInt(n) {\n  return n % 1 === 0;\n}\n\n// Round a non-integer to an integer closest to the nearest increment/decrement.\n// If no increment is provided or the increment is 0, only round to the nearest whole number.\nfunction roundToIncrement(number, increment) {\n  if (!increment || isNaN(increment) || increment === 0) {\n    increment = 1;\n  }\n  return Math.round(number / increment) * increment;\n}\n\n// Get the distance between two points.\n// PointA & PointB are both arrays containing X and Y coordinates of two points.\n// Distance Formula:  http://www.purplemath.com/modules/distform.htm\nfunction getDistance(pointA, pointB) {\n  const aX = pointA[0];\n  const aY = pointA[1];\n  const bX = pointB[0];\n  const bY = pointB[1];\n\n  return Math.sqrt(Math.pow(bX - aX, 2) + Math.pow(bY - aY, 2));\n}\n\n// Actual Plugin Code\nSlider.prototype = {\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  init() {\n    return this\n      .buildSettings()\n      .addMarkup()\n      .bindEvents();\n  },\n\n  /**\n   * Handles Data Attribute settings, some markup settings\n   * @private\n   * @returns {this} component instance\n   */\n  buildSettings() {\n    const self = this;\n\n    // Add \"is-disabled\" css class to closest \".field\" if element is disabled\n    if (this.element.is(':disabled')) {\n      this.element.closest('.field').addClass('is-disabled');\n    }\n\n    if (!this.settings) {\n      this.settings = {};\n    }\n    this.settings.value = this.element.attr('value') !== undefined ? this.element.attr('value') : this.settings.value;\n    this.settings.min = this.element.attr('min') !== undefined ? parseInt(this.element.attr('min'), 10) : this.settings.min;\n    this.settings.max = this.element.attr('max') !== undefined ? parseInt(this.element.attr('max'), 10) : this.settings.max;\n    this.settings.range = this.element.attr('data-range') !== undefined ? (this.element.attr('data-range') === 'true') : this.settings.range;\n    this.settings.step = !isNaN(this.element.attr('step')) ? Number(this.element.attr('step')) : this.settings.step;\n\n    if (this.settings.value === '') {\n      this.settings.value = this.settings.min;\n    }\n\n    // build tick list\n    let parsedTicks;\n    if (this.element.attr('data-ticks') !== undefined) {\n      try {\n        parsedTicks = JSON.parse(self.element.attr('data-ticks'));\n      } catch (e) {\n        parsedTicks = [];\n      }\n\n      if ($.isArray(parsedTicks)) {\n        this.settings.ticks = parsedTicks;\n      }\n    }\n\n    // build tooltip content\n    const isTooltipPersist = (this.element.attr('data-tooltip-persist') === 'true' || this.element.attr('data-tooltip-persist') === true);\n    this.settings.persistTooltip = this.element.attr('data-tooltip-persist') !== undefined ? isTooltipPersist : this.settings.persistTooltip;\n    this.settings.tooltip = this.settings.tooltipContent;\n    if (this.element.attr('data-tooltip-content') !== undefined) {\n      try {\n        self.settings.tooltip = JSON.parse(self.element.attr('data-tooltip-content'));\n      } catch (e) {\n        self.settings.tooltip = ['', ''];\n      }\n    }\n    if (typeof this.settings.tooltip === 'string') {\n      if (this.settings.tooltip.indexOf(',') === -1) {\n        this.settings.tooltip = [this.settings.tooltip, ''];\n      } else {\n        const strings = this.settings.tooltip.split(',');\n        this.settings.tooltip = [strings[0]];\n        this.settings.tooltip.push(strings[1] ? strings[1] : '');\n      }\n    }\n    if (this.settings.tooltip && this.settings.tooltip.length === 1) {\n      this.settings.tooltip.push('');\n    }\n\n    // Build ticks.  All sliders have a tick for minimum and maximum by default.\n    // Some will be provided as extra.\n    this.ticks = [];\n    const minTick = {\n      value: this.settings.min,\n      description: self.getModifiedTextValue(this.settings.min)\n    };\n    const maxTick = {\n      value: this.settings.max,\n      description: self.getModifiedTextValue(this.settings.max)\n    };\n\n    if (!this.settings.ticks) {\n      this.ticks.push(minTick, maxTick);\n    } else {\n      // Check the type of the data-ticks.  If it's not a complete array\n      // and doesn't have at least one option, ignore it.\n      let ticks = self.settings.ticks || [];\n\n      if ($.isArray(ticks) && ticks.length > 0) {\n        // Filter through the incoming ticks to figure out if any have been defined\n        // That match the values of min and max.\n        const equalsMin = ticks.filter(obj => obj.value === self.settings.min);\n        const equalsMax = ticks.filter(obj => obj.value === self.settings.max);\n\n        // Overwrite description and color for min/max if they've been found.\n        if (equalsMin.length > 0) {\n          minTick.description = equalsMin[0].description;\n          minTick.color = equalsMin[0].color;\n          ticks = $.grep(ticks, val => val !== equalsMin[0]);\n        }\n        if (equalsMax.length > 0) {\n          maxTick.description = equalsMax[0].description;\n          maxTick.color = equalsMax[0].color;\n          ticks = $.grep(ticks, val => val !== equalsMax[0]);\n        }\n      }\n\n      // Push the values of all ticks out to the ticks array\n      self.ticks.push(minTick);\n      for (let i = 0; i < ticks.length; i++) {\n        const tick = {};\n        if (ticks[i].value !== undefined) {\n          tick.value = ticks[i].value;\n          tick.description = ticks[i].description !== undefined ? ticks[i].description : '';\n          tick.color = ticks[i].color;\n          self.ticks.push(tick);\n        }\n      }\n      self.ticks.push(maxTick);\n    }\n\n    // configure the slider to deal with an array of values, and normalize the\n    // values to make sure they are numbers.\n    if ($.isArray(this.settings.value)) {\n      this.settings.value[0] = isNaN(this.settings.value[0]) ?\n        (this.settings.min + this.settings.max) / 2 :\n        parseInt(this.settings.value[0], 10);\n    } else if (typeof this.settings.value === 'number') {\n      this.settings.value = [this.settings.value];\n    } else if (this.settings.value.indexOf(',') === -1) {\n      // String\n      this.settings.value = [isNaN(this.settings.value) ?\n        (this.settings.min + this.settings.max) / 2 :\n        parseInt(this.settings.value, 10)];\n    } else {\n      const vals = this.settings.value.split(',');\n      vals[0] = isNaN(vals[0]) ? this.settings.min : parseInt(vals[0], 10);\n      vals[1] = isNaN(vals[1]) ? this.settings.max : parseInt(vals[1], 10);\n      this.settings.value = vals;\n    }\n\n    // Add a second value to the array if we're dealing with a range.\n    if (this.settings.range && !this.settings.value[1]) {\n      this.settings.value.push(this.settings.max);\n    }\n\n    return this;\n  },\n\n  /**\n   * Adds pseudo-markup that helps build the component\n   * @private\n   * @returns {this} component instance\n   */\n  addMarkup() {\n    const self = this;\n    let isVertical = false;\n\n    if (self.element[0].tagName !== 'INPUT') {\n      throw new Error(`Element with ID \"${self.element.id}\" cannot invoke a slider;  it's not an Input element.`);\n    }\n\n    // store values and attributes on the original element\n    self.originalElement = {\n      type: self.element.attr('type')\n    };\n\n    // Hide the input element\n    self.element.attr('type', 'hidden');\n\n    // Build the slider controls\n    self.wrapper = $('<div class=\"slider-wrapper\"></div>').attr('id', `${self.element.attr('id')}-slider`).insertAfter(self.element);\n    self.hitarea = $('<div class=\"slider-hit-area\"></div>').appendTo(self.wrapper);\n    self.range = $('<div class=\"slider-range\"></div>').appendTo(self.wrapper);\n\n    // Set to a vertical slider if the class exists on the input\n    if (this.element.hasClass('vertical')) {\n      this.wrapper.addClass('vertical');\n      isVertical = true;\n    }\n\n    // Set RTL\n    this.isRtlHorizontal = (Locale.isRTL() && !isVertical);\n    this.isRtlVertical = (Locale.isRTL() && isVertical);\n\n    // Retain any width or height size properties from the original range\n    // element onto the Pseudo-markup\n    let style = this.element.attr('style');\n    if (style) {\n      if (style.match(/min-height/)) {\n        this.wrapper[0].style.minHeight = this.element[0].style.minHeight;\n        style = style.replace('min-height', '');\n      }\n      if (style.match(/height/)) {\n        this.wrapper[0].style.height = this.element[0].style.height;\n      }\n      if (style.match(/min-width/)) {\n        this.wrapper[0].style.minWidth = this.element[0].style.minWidth;\n        style = style.replace('min-width', '');\n      }\n      if (style.match(/width/)) {\n        this.wrapper[0].style.width = this.element[0].style.width;\n      }\n    }\n\n    // Handles\n    self.handles = [];\n    const labelText = self.element.prev('label').text();\n    const handleLower = $(`<div class=\"slider-handle${self.settings.range ? ' lower' : ''}\" tabindex=\"0\"></div>`)\n      .attr('aria-label', `${self.settings.range ? Locale.translate('SliderMinimumHandle') : Locale.translate('SliderHandle')} ${labelText}`);\n    self.handles.push(handleLower);\n    if (self.settings.range) {\n      const handleHigher = $('<div class=\"slider-handle higher\" tabindex=\"0\"></div>')\n        .attr('aria-label', `${Locale.translate('SliderMaximumHandle')} ${labelText}`);\n      self.handles.push(handleHigher);\n    }\n    $.each(self.handles, (i, handle) => {\n      // Add WAI-ARIA to the handles\n      handle.attr({\n        role: 'slider',\n        'aria-orientation': (isVertical ? 'vertical' : 'horizontal'),\n        'aria-valuemin': self.settings.min,\n        'aria-valuemax': self.settings.max\n      }).hideFocus();\n      handle.appendTo(self.wrapper);\n    });\n\n    function positionTick(tick) {\n      const convertValueToPercentage = self.isRtlHorizontal ?\n        (100 - self.convertValueToPercentage(tick.value)) :\n        self.convertValueToPercentage(tick.value);\n      const pos = `calc(${convertValueToPercentage}% - 4px)`;\n\n      tick.element = $(`<div class=\"tick\" data-value=\"${tick.value}\"></div>`);\n      tick.label = $(`<span class=\"label\">${tick.description}</span>`);\n      tick.element[0].style[isVertical ? 'bottom' : 'left'] = pos;\n      tick.element.append(tick.label);\n      self.wrapper.append(tick.element);\n\n      if (isVertical) {\n        return;\n      }\n      tick.label[0].style.left = `${-(tick.label.outerWidth() / 2 - tick.element.width() / 2)}px`;\n    }\n\n    // Ticks\n    self.ticks.forEach((tick) => {\n      positionTick(tick);\n    });\n\n    self.value(self.settings.value);\n    self.updateRange();\n\n    // Tooltip on handle needs to update later\n    $.each(self.handles, (i, handle) => {\n      if (self.settings.tooltip) {\n        handle.tooltip({\n          content() {\n            return `${self.getModifiedTextValue(Math.floor(self.value()[i]))}`;\n          },\n          placement: (isVertical ? 'right' : 'bottom'),\n          trigger: 'focus',\n          keepOpen: self.settings.persistTooltip\n        });\n        handle.removeAttr('aria-describedby');\n      }\n    });\n\n    if (this.element.prop('readonly') === true) {\n      this.readonly();\n    } else if (this.element.prop('disabled') === true) {\n      this.disable();\n    }\n\n    return self;\n  },\n\n  /**\n   * User is interacting with the Slider Range (not the handle or ticks)\n   * @private\n   * @param {jQuery.Event} e jQuery `click` event\n   * @returns {void}\n   */\n  handleRangeClick(e) {\n    e.preventDefault();\n    if (this.isDisabled()) {\n      return;\n    }\n\n    const self = this;\n    const isVertical = this.wrapper.hasClass('vertical');\n    const pageX = e.originalEvent.type !== 'click' ? e.originalEvent.changedTouches[0].pageX : e.pageX;\n    const pageY = e.originalEvent.type !== 'click' ? e.originalEvent.changedTouches[0].pageY : e.pageY;\n    const mouseX = pageX - self.wrapper.offset().left - $(document).scrollLeft();\n    const mouseY = pageY - self.wrapper.offset().top - $(document).scrollTop();\n    const clickCoords = [mouseX, mouseY];\n    const fhX = (self.handles[0].offset().left + (self.handles[0].width() / 2)) -\n      self.wrapper.offset().left - $(document).scrollLeft();\n    const fhY = (self.handles[0].offset().top + (self.handles[0].height() / 2)) -\n      self.wrapper.offset().top - $(document).scrollTop();\n    const firstHandleCoords = [fhX, fhY];\n    let shX;\n    let shY;\n    let secondHandleCoords;\n    const oldVals = self.value();\n    const dLower = getDistance(clickCoords, firstHandleCoords);\n    let dHigher;\n    let targetOldVal = oldVals[0];\n    let targetHandle = self.handles[0];\n\n    targetHandle.addClass('hide-focus');\n\n    function conversion() {\n      if (isVertical) {\n        const wh = self.wrapper.height();\n        return ((wh - mouseY) / wh) * 100;\n      }\n      return (mouseX / self.wrapper.width()) * 100;\n    }\n\n    // Convert the coordinates of the mouse click to a value\n    const val = conversion();\n    const rangeVal = self.convertPercentageToValue(val);\n\n    // If the slider is a range, we may use the second handle instead of the first\n    if (self.handles[1]) {\n      shX = (self.handles[1].offset().left + (self.handles[1].width() / 2)) -\n        self.wrapper.offset().left - $(document).scrollLeft();\n      shY = (self.handles[1].offset().top + (self.handles[1].height() / 2)) -\n        self.wrapper.offset().top - $(document).scrollTop();\n      secondHandleCoords = [shX, shY];\n      dHigher = getDistance(clickCoords, secondHandleCoords);\n\n      if (dLower > dHigher) {\n        self.value([undefined, rangeVal]);\n        targetHandle = self.handles[1];\n        targetOldVal = oldVals[1];\n      } else {\n        self.value([rangeVal]);\n      }\n    } else {\n      self.value([rangeVal]);\n    }\n\n    self.checkHandleDifference(targetHandle, targetOldVal, rangeVal);\n\n    const moveBy = self.settings.step ? self.settings.step : 0;\n    if (rangeVal < targetOldVal) {\n      self.decreaseValue(e, targetHandle, rangeVal, moveBy);\n    } else {\n      self.increaseValue(e, targetHandle, rangeVal, moveBy);\n    }\n\n    // Tooltip repositioner will focus the handle after positioning occurs, but if\n    // we are clicking a tick on a slider with no tooltip, we need to focus it manually.\n    if (!self.settings.tooltip) {\n      targetHandle.focus();\n    }\n  },\n\n  /**\n   * Activates one of the slider handles\n   * @private\n   * @param {jQuery[]} handle element representing a slider handle\n   */\n  activateHandle(handle) {\n    handle.addClass('is-active');\n  },\n\n  /**\n   * Deactivates one of the slider handles\n   * @private\n   * @param {jQuery[]} handle element representing a slider handle\n   */\n  deactivateHandle(handle) {\n    handle.removeClass('is-active');\n  },\n\n  /**\n   * Enables the ability to drag one of the slider handles.\n   * @private\n   * @param {jQuery[]} handle element representing a slider handle\n   */\n  enableHandleDrag(handle) {\n    if (this.isDisabled()) {\n      return;\n    }\n\n    const self = this;\n    const draggableOptions = {\n      containment: 'parent',\n      axis: (this.isVertical() ? 'y' : 'x'),\n      clone: false\n    };\n\n    function updateHandleFromDraggable(e, thisHandle, args) {\n      if (self.isDisabled()) {\n        return;\n      }\n\n      function conversion() {\n        if (self.isVertical()) {\n          const wh = self.wrapper.height();\n          // Vertical Slider accounts for limits set on the height by IDS Enterprise Drag.js\n          const adjustedHeight = wh - thisHandle.outerHeight();\n\n          return ((adjustedHeight - args.top) / adjustedHeight) * 100;\n        }\n        return args.left / (self.wrapper.width() - thisHandle.outerWidth()) * 100;\n      }\n\n      const val = conversion();\n      let rangeVal = self.convertPercentageToValue(val);\n\n      // Ranged values need to check to make sure that the higher-value handle\n      // doesn't drawindowg past the lower-value handle, and vice-versa.\n      if (self.settings.range) {\n        const originalVal = self.value();\n        if (thisHandle.hasClass('higher') && rangeVal <= originalVal[0]) {\n          rangeVal = originalVal[0];\n        }\n        if (thisHandle.hasClass('lower') && rangeVal >= originalVal[1]) {\n          rangeVal = originalVal[1];\n        }\n      }\n\n      // Round the value to the nearest step, if the step is defined\n      if (self.settings.step) {\n        rangeVal = Math.round(rangeVal / self.settings.step) * self.settings.step;\n      }\n\n      /**\n      * Fires while the slider is being slid.\n      * @event sliding\n      * @memberof Slider\n      * @property {object} event The jquery event object\n      * @property {object} args Extra event information.\n      * @property {HTMLElement} args.handle The slider handle DOM element.\n      * @property {number} args.value The current range value.\n      */\n      if (!e.defaultPrevented) {\n        self.value(thisHandle.hasClass('higher') ? [undefined, rangeVal] : [rangeVal]);\n        self.updateRange();\n        self.updateTooltip(thisHandle);\n        self.element.trigger('sliding', thisHandle, rangeVal);\n      }\n    }\n\n    // Add/Remove Classes for canceling animation of handles on the draggable's events.\n    /**\n    * Fires while the slider is being slid.\n    * @event slidestart\n    * @memberof Slider\n    * @property {object} event The jquery event object\n    * @property {object} args Extra event information.\n    * @property {HTMLElement} args.handle The slider handle DOM element.\n    */\n    /**\n     * Fires while the slider is being slid.\n     * @event slidestop\n     * @memberof Slider\n     * @property {object} event The jquery event object\n     * @property {object} args Extra event information.\n     * @property {HTMLElement} args.handle The slider handle DOM element.\n     */\n    handle.drag(draggableOptions)\n      .on('drag.slider', (e, args) => {\n        updateHandleFromDraggable(e, $(e.currentTarget), args);\n      })\n      .on('dragstart', function () {\n        $(this).addClass('is-dragging');\n        self.range.addClass('is-dragging');\n        self.element.trigger('slidestart', handle);\n      })\n      .on('dragend', function () {\n        $(this).removeClass('is-dragging');\n        self.range.removeClass('is-dragging');\n        self.element.trigger('slidestop', handle);\n      });\n  },\n\n  /**\n   * Disables the dragging of a handle.\n   * @private\n   * @param {jQuery[]} handle element representing a slider handle\n   */\n  disableHandleDrag(handle) {\n    handle.off('drag.slider dragstart dragend');\n\n    this.range.removeClass('is-dragging');\n    handle.removeClass('is-dragging');\n\n    const dragAPI = handle.data('drag');\n    if (dragAPI) {\n      dragAPI.destroy();\n    }\n  },\n\n  /**\n   * @private\n   * @param {number} value pixel value\n   * @returns {number} representing a percentage\n   */\n  convertValueToPercentage(value) {\n    return (((value - this.settings.min) / (this.settings.max - this.settings.min)) * 100);\n  },\n\n  /**\n   * @private\n   * @param {number} percentage percentage value\n   * @returns {number} representing a pixel value\n   */\n  convertPercentageToValue(percentage) {\n    const val = (percentage / 100) * (this.settings.max - this.settings.min) + this.settings.min;\n    return this.isRtlHorizontal ? (this.settings.max - val + this.settings.min) : val;\n  },\n\n  /**\n   * Gets a 10% increment/decrement as a value within the range of minimum and maximum values.\n   * @returns {number} nearest 10% increment\n   */\n  getIncrement() {\n    let increment = 0.1 * (this.settings.max - this.settings.min);\n    if (this.settings.step !== undefined && increment <= this.settings.step) {\n      increment = this.settings.step;\n    }\n    return increment;\n  },\n\n  /**\n   * Handles Slider Component's keystrokes\n   * @private\n   * @param {jQuery.Event} e jQuery `keydown` event\n   * @param {this} self reference to this component instance\n   */\n  handleKeys(e, self) {\n    if (self.isDisabled()) {\n      return;\n    }\n\n    const key = e.which;\n    const handle = $(e.currentTarget);\n\n    handle.removeClass('hide-focus');\n\n    // If the keycode got this far, it's an arrow key, Page Up, Page Down, HOME, or END.\n    switch (key) {\n      case 33: // Page Up increases the value by 10%\n        self.increaseValue(e, handle, undefined, this.getIncrement());\n        break;\n      case 34: // Page Down decreases the value by 10%\n        self.decreaseValue(e, handle, undefined, this.getIncrement());\n        break;\n      case 35: // End key sets the handle to its maximum possible value\n        self.increaseValue(e, handle, this.settings.max);\n        break;\n      case 36:\n        // Home key sets the handle to its lowest\n        // (either minimum value or as low as the \"lower\" handle)\n        self.decreaseValue(e, handle, this.settings.min);\n        break;\n      case 38: case 39: // Right and Up increase the spinbox value\n        if (self.isRtlHorizontal && key === 39) {\n          self.decreaseValue(e, handle);\n        } else {\n          self.increaseValue(e, handle);\n        }\n        break;\n      case 37: case 40: // Left and Down decrease the spinbox value\n        if (self.isRtlHorizontal && key === 37) {\n          self.increaseValue(e, handle);\n        } else {\n          self.decreaseValue(e, handle);\n        }\n        break;\n      default:\n        break;\n    }\n  },\n\n  /**\n   * Increases the value of one of the slider handles, accounting for step value, percentage, etc.\n   * Also visually updates the handle on the visual part of the slider.\n   * @param {jQuery.Event} e jQuery `click` or `keydown` event.\n   * @param {jQuery[]} handle represents a slider handle element.\n   * @param {number} [value] - target value - will be automatically determined if not passed.\n   * @param {number} [increment] - an integer that will be used as the amount to increment.\n   */\n  increaseValue(e, handle, value, increment) {\n    e.preventDefault();\n    clearTimeout(handle.data('animationTimeout'));\n\n    const val = this.value().slice(0);\n    let incrementBy = increment !== undefined ? increment : this.settings.step !== undefined ? this.settings.step : 1; //eslint-disable-line\n    let testVal;\n    let updatedVal;\n    let finalVal;\n\n    if (handle.hasClass('higher')) {\n      testVal = value !== undefined ? value : val[1];\n      incrementBy = isInt(testVal) ? incrementBy : isNaN(testVal % incrementBy) ? 0 : testVal % incrementBy; //eslint-disable-line\n      updatedVal = testVal + incrementBy <\n        this.settings.max ? testVal + incrementBy : this.settings.max;\n      finalVal = updatedVal % incrementBy ? updatedVal : roundToIncrement(updatedVal, incrementBy);\n      this.value([undefined, finalVal]);\n    } else {\n      testVal = value !== undefined ? value : val[0];\n      const maxValue = val[1] === undefined ? this.settings.max : val[1];\n      incrementBy = isInt(testVal) ? incrementBy : isNaN(testVal % incrementBy) ? 0 : incrementBy - (testVal % incrementBy); //eslint-disable-line\n      updatedVal = testVal + incrementBy < maxValue ? testVal + incrementBy : maxValue;\n      finalVal = updatedVal % incrementBy ? updatedVal : roundToIncrement(updatedVal, incrementBy);\n      this.value([finalVal]);\n    }\n    this.checkHandleDifference(handle, testVal, finalVal);\n    this.updateRange();\n    this.updateTooltip(handle);\n  },\n\n  /**\n   * Decreases the value of one of the slider handles, accounting for step value, percentage, etc.\n   * Also visually updates the handle on the visual part of the slider.\n   * @param {jQuery.Event} e jQuery `click` or `keydown` event.\n   * @param {jQuery[]} handle element representing a slider handle.\n   * @param {number} [value] - target value - will be automatically determined if not passed.\n   * @param {number} [decrement] - an integer that will be used as the amount to decrement.\n   */\n  decreaseValue(e, handle, value, decrement) {\n    e.preventDefault();\n    clearTimeout(handle.data('animationTimeout'));\n\n    const val = this.value();\n    let decrementBy = decrement !== undefined ? decrement : this.settings.step !== undefined ? this.settings.step : 1; //eslint-disable-line\n    let testVal;\n    let updatedVal;\n    let finalVal;\n\n    if (handle.hasClass('higher')) {\n      testVal = value !== undefined ? value : val[1];\n      const minValue = val[0] === undefined ? this.settings.min : val[0];\n      decrementBy = isInt(testVal) ? decrementBy : isNaN(testVal % decrementBy) ? 0 : decrementBy - (testVal % decrementBy); //eslint-disable-line\n      updatedVal = testVal - decrementBy > minValue ? testVal - decrementBy : minValue;\n      finalVal = updatedVal % decrementBy ? updatedVal : roundToIncrement(updatedVal, decrementBy);\n      this.value([undefined, finalVal]);\n    } else {\n      testVal = value !== undefined ? value : val[0];\n      decrementBy = isInt(testVal) ? decrementBy : isNaN(testVal % decrementBy) ? 0 : testVal % decrementBy; //eslint-disable-line\n      updatedVal = testVal - decrementBy >\n        this.settings.min ? testVal - decrementBy : this.settings.min;\n      finalVal = updatedVal % decrementBy ? updatedVal : roundToIncrement(updatedVal, decrementBy);\n      this.value([finalVal]);\n    }\n    this.checkHandleDifference(handle, testVal, finalVal);\n    this.updateRange();\n    this.updateTooltip(handle);\n  },\n\n  /**\n   * Changes the position of the bar and handles based on their values.\n   * @private\n   */\n  updateRange() {\n    const self = this;\n    const newVal = this.value();\n    const percentages = [];\n    const color = this.getColorClosestToValue();\n    const isVertical = self.wrapper.hasClass('vertical');\n\n    for (let i = 0; i < this.ticks.length; i++) {\n      const condition = !this.settings.range ? this.ticks[i].value <= newVal[0] :\n        newVal[0] < this.ticks[i].value && this.ticks[i].value <= newVal[1];\n\n      if (condition) {\n        this.ticks[i].element.addClass('complete');\n        if (color) {\n          this.ticks[i].element[0].style.backgroundColor = color;\n          this.ticks[i].element.addClass('inherit');\n        }\n      } else {\n        this.ticks[i].element.removeClass('complete');\n        if (color) {\n          this.ticks[i].element[0].style.backgroundColor = '';\n          this.ticks[i].element.removeClass('inherit');\n        }\n      }\n    }\n\n    if (color) {\n      this.range[0].style.backgroundColor = color;\n      $.each(this.handles, (i, handle) => {\n        handle[0].style.backgroundColor = color;\n        handle[0].style.borderColor = color;\n      });\n    }\n\n    // Remove any text colors that already existed.\n    $.each(self.ticks, (i) => {\n      self.ticks[i].label[0].style.color = '';\n    });\n\n    // Convert the stored values from ranged to percentage\n    percentages[0] = this.convertValueToPercentage(newVal[0]);\n    if (newVal[1] !== undefined) {\n      percentages[1] = this.convertValueToPercentage(newVal[1]);\n    }\n\n    function getPosAttrs() {\n      if (isVertical) {\n        return ['bottom', 'top'];\n      }\n      if (self.isRtlHorizontal) {\n        return ['right', 'left'];\n      }\n      return ['left', 'right'];\n    }\n\n    const posAttrs = getPosAttrs();\n    const cssProps = {};\n\n    // If no arguments are provided, update both handles with the latest stored values.\n    if (!this.handles[1]) {\n      cssProps[posAttrs[0]] = '0%';\n      cssProps[posAttrs[1]] = `${100 - percentages[0]}%`;\n    } else {\n      cssProps[posAttrs[0]] = `${percentages[0]}%`;\n      cssProps[posAttrs[1]] = `${100 - percentages[1]}%`;\n    }\n    this.range.css(cssProps);\n\n    function positionHandle(handle, percentage) {\n      const basePosition = isVertical ? posAttrs[1] : posAttrs[0];\n      const realPercentage = isVertical ? 100 - percentage : percentage;\n\n      handle.css(basePosition, `calc(${realPercentage}% - ${handle.outerWidth() / 2}px)`);\n    }\n\n    if (this.handles[0].hasClass('is-animated')) {\n      this.handles[0].data('animationTimeout', setTimeout(() => {\n        self.handles[0].removeClass('is-animated').trigger('slide-animation-end');\n        self.range.removeClass('is-animated');\n      }, 201));\n    }\n    positionHandle(this.handles[0], percentages[0]);\n\n    if (this.handles[1]) {\n      if (this.handles[1].hasClass('is-animated')) {\n        this.handles[1].data('animationTimeout', setTimeout(() => {\n          self.handles[1].removeClass('is-animated').trigger('slide-animation-end');\n          self.range.removeClass('is-animated');\n        }, 201));\n      }\n      positionHandle(this.handles[1], percentages[1]);\n\n      // update the 'aria-valuemin' attribute on the Max handle, and the 'aria-valuemax'\n      // attribute on the Min handle for better screen reading compatability\n      this.handles[0].attr('aria-valuemax', newVal[1]);\n      this.handles[1].attr('aria-valuemin', newVal[0]);\n    }\n  },\n\n  /**\n   * Allows a handle to animate to a new position if the difference in value is greater\n   *  than 3% of the size of the range.\n   * @private\n   * @param {jQuery[]} handle element representing a slider handle\n   * @param {number} originalVal the value before it was modified\n   * @param {number} updatedVal the target value\n   */\n  checkHandleDifference(handle, originalVal, updatedVal) {\n    // IE9 doesn't support animation so return immediately.\n    if ($('html').hasClass('ie9')) {\n      return;\n    }\n    const origPercent = this.convertValueToPercentage(originalVal);\n    const updatedPercent = this.convertValueToPercentage(updatedVal);\n\n    if (Math.abs(origPercent - updatedPercent) > 3) {\n      handle.addClass('is-animated');\n      this.range.addClass('is-animated');\n    }\n  },\n\n  /**\n   * If tooltips are active, updates the current placement and content of the Tooltip.\n   * If no handle argument is passed, this method simply hides both handles' tooltips.\n   * @param {jQuery[]} [handle] element representing a slider handle.\n   */\n  updateTooltip(handle) {\n    if (!this.settings.tooltip) {\n      return;\n    }\n\n    if (!handle) {\n      const tooltipLow = this.handles[0].data('tooltip');\n      let tooltipHigh;\n\n      if (this.handles[1]) {\n        tooltipHigh = this.handles[1].data('tooltip');\n      }\n\n      tooltipLow.hide();\n      if (tooltipHigh) {\n        tooltipHigh.hide();\n      }\n\n      return;\n    }\n\n    const tooltip = handle.data('tooltip');\n\n    function update() {\n      tooltip.position();\n      handle.focus();\n    }\n\n    // NOTE: This is a bit hacky because it depends on the setTimeout() method for\n    // animation that is triggered inside the self.updateRange() method to have not\n    // fired yet.  If you put a breakpoint anywhere in there you may see strange\n    // results with animation.\n    if (handle.hasClass('is-animated')) {\n      tooltip.hide();\n      handle.one('slide-animation-end', () => {\n        update();\n      });\n    } else {\n      update();\n    }\n  },\n\n  /**\n   * Gets a string-based hex value for the closest tick's defined color.\n   * @private\n   * @returns {string} hex value representing a color\n   */\n  getColorClosestToValue() {\n    const currentTheme = theme.currentTheme.id;\n    const preColors = {\n      light: {\n        default: '#000000',\n        'very-poor': '#a13030',\n        poor: '#d66221',\n        adequate: '#f2bc41',\n        good: '#9cce7c',\n        'very-good': '#76b051',\n        superior: '#488421'\n      },\n      dark: {\n        default: '#ffffff',\n        'very-poor': '#a13030',\n        poor: '#d66221',\n        adequate: '#f2bc41',\n        good: '#9cce7c',\n        'very-good': '#76b051',\n        superior: '#488421'\n      },\n      'high-contrast': {\n        default: '#000000',\n        'very-poor': '#a13030',\n        poor: '#d66221',\n        adequate: '#e4882b',\n        good: '#76b051',\n        'very-good': '#56932e',\n        superior: '#397514'\n      }\n    };\n\n    const themeColors = preColors[currentTheme];\n    const val = this.value()[0];\n    let highestTickColor;\n    let c;\n\n    for (let i = 0; i < this.ticks.length; i++) {\n      c = this.ticks[i].color;\n      if (c && val >= this.ticks[i].value) {\n        highestTickColor = c;\n        highestTickColor = (c.indexOf('#') > -1) ? c : (themeColors[c] || themeColors.default);\n      }\n    }\n\n    return highestTickColor;\n  },\n\n  /**\n   * External Facing Function to set the value. Works as percent for now but need it on ticks.\n   * NOTE:  Does not visually update the range.  Use _setValue()_ to do both in one swoop.\n   * @param {number} minVal the smaller handle's value\n   * @param {number} [maxVal] the larger handle's value, if applicable\n   * @returns {array} both currently set handle values\n   */\n  value(minVal, maxVal) {\n    const self = this;\n\n    // if both options are absent, act as a getter and return the current value\n    if (minVal === undefined && maxVal === undefined) {\n      return self._value;\n    }\n\n    // if an array is passed as the first argument, break it apart\n    if (minVal && $.isArray(minVal)) {\n      if (minVal[1] !== undefined) {\n        maxVal = minVal[1];\n      }\n      minVal = minVal[0];\n    }\n\n    // set the values back to the existing one if they aren't passed.\n    if (minVal === undefined && $.isArray(self._value) && self._value[0] !== undefined) {\n      minVal = self._value[0];\n    }\n    if (maxVal === undefined && $.isArray(self._value) && self._value[1] !== undefined) {\n      maxVal = self._value[1];\n    }\n\n    // set the internal value and the element's retrievable value.\n    self._value = [minVal, maxVal];\n    self.element.val(maxVal !== undefined ? self._value : self._value[0]);\n    $.each(self.handles, (i, handle) => {\n      const value = self._value[i];\n      let valueText = self.getModifiedTextValue(value);\n\n      $.each(self.ticks, (a, tick) => {\n        if (tick.value === value) {\n          valueText = tick.description;\n        }\n      });\n\n      handle.attr({\n        'aria-valuenow': self._value[i],\n        'aria-valuetext': valueText\n      });\n    });\n\n    self.element.trigger('change');\n    return self._value;\n  },\n\n  /**\n   * Returns a value with prefixed/suffixed text content.\n   * Used by the tooltip and default ticks to get potential identifiers like $ and %.\n   * @private\n   * @param {string} content the original tooltip content\n   * @returns {string} prepended/appended text that will be displayed inside the tooltip\n   */\n  getModifiedTextValue(content) {\n    if (!this.settings.tooltip) {\n      return content;\n    }\n    return this.settings.tooltip[0] + content + this.settings.tooltip[1];\n  },\n\n  /**\n   * Enables the slider instance.\n   * @returns {this} component instance\n   */\n  enable() {\n    this.element.prop('disabled', false);\n    this.element.prop('readonly', false);\n    this.wrapper.removeClass('is-readonly');\n    this.wrapper.removeClass('is-disabled');\n\n    const self = this;\n    $.each(this.handles, (i, handle) => {\n      self.enableHandleDrag(handle);\n    });\n\n    return this;\n  },\n\n  /**\n   * Disables the slider instance.\n   * @returns {this} component instance\n   */\n  disable() {\n    this.element.prop('disabled', true);\n    this.element.prop('readonly', false);\n    this.wrapper.removeClass('is-readonly');\n    this.wrapper.addClass('is-disabled');\n\n    const self = this;\n    $.each(this.handles, (i, handle) => {\n      self.disableHandleDrag(handle);\n    });\n\n    return this;\n  },\n\n  /**\n   * Sets the slider in a readonly state\n   * @returns {this} component instance\n   */\n  readonly() {\n    this.element.prop('disabled', true);\n    this.element.prop('readonly', true);\n    this.wrapper.removeClass('is-disabled');\n    this.wrapper.addClass('is-readonly');\n\n    $.each(this.handles, (i, handle) => {\n      this.disableHandleDrag(handle);\n    });\n\n    return this;\n  },\n\n  /**\n   * Detects whether or not this slider is disabled\n   * @returns {boolean} whether or not this slider is disabled\n   */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n   * Detects whether or not this slider is vertical\n   * @returns {boolean} whether or not this slider is vertical\n   */\n  isVertical() {\n    return this.wrapper.hasClass('vertical');\n  },\n\n  /**\n   * Externally-facing function that updates the current values and correctly\n   * animates the range handles, if applicable.\n   * @param {number} lowVal the value for the lower slider handle.\n   * @param {number} [highVal] the value for the upper slider handle, if applicable.\n   * @returns {array} the newly set values\n   */\n  setValue(lowVal, highVal) {\n    const oldVals = this.value();\n\n    this.checkHandleDifference(this.handles[0], oldVals[0], lowVal);\n    if (this.handles[1]) {\n      this.checkHandleDifference(this.handles[1], oldVals[1], highVal);\n    }\n\n    const vals = this.value(lowVal, highVal);\n    this.updateRange();\n    this.updateTooltip();\n\n    return vals;\n  },\n\n  /**\n   * @deprecated in v4.2.0. Please use `setValue()` instead.\n   * @param {number} lowVal the value for the lower slider handle.\n   * @param {number} [highVal] the value for the upper slider handle, if applicable.\n   * @returns {array} the newly set values\n   */\n  refresh(lowVal, highVal) {\n    return deprecateMethod(this.setValue, this.refresh).apply(this, [lowVal, highVal]);\n  },\n\n  /**\n   * Updates the slider instance after a settings change.\n   * Settings and markup are complicated in the slider so we just destroy and re-invoke it\n   * with fresh settings.\n   * @param {object|function} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    this.element.removeAttr('value');\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Removes the events and pseudo-markup created by the slider\n   * @private\n   * @returns {this} component instance\n   */\n  teardown() {\n    const self = this;\n    $.each(self.handles, (i, handle) => {\n      self.disableHandleDrag(handle);\n      handle.off('mousedown.slider click.slider blur.slider keydown.slider keyup.slider');\n    });\n    this.wrapper.off('click.slider touchend.slider touchcancel.slider').remove();\n    this.element.attr('type', xssUtils.ensureAlphaNumeric(this.originalElement.type));\n\n    return this;\n  },\n\n  /**\n   * Destroys the slider component instance and unlinks it from its base element.\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Handle component events.\n   * @private\n   * @returns {void}\n   */\n  bindEvents() {\n    const self = this;\n\n    $.each(self.handles, (i, handle) => {\n      handle.on('mousedown.slider', function () {\n        if (self.isDisabled()) {\n          return;\n        }\n        $(this).focus();\n      })\n        .on('click.slider', (e) => {\n          e.preventDefault(); // Prevent from jumping to top.\n        })\n        .on('keydown.slider', (e) => {\n          self.activateHandle(handle);\n          self.handleKeys(e, self);\n        })\n        .on('keyup.slider blur.slider', () => {\n          self.deactivateHandle(handle);\n        });\n\n      self.enableHandleDrag(handle);\n    });\n\n    self.wrapper.on('click.slider touchend.slider touchcancel.slider', (e) => {\n      self.handleRangeClick(e);\n    });\n\n    // Slider Control listens to 'updated' trigger on its base element to update values\n    self.element.on('updated.slider', () => {\n      self.updated();\n    });\n\n    return self;\n  }\n};\n\nexport { Slider, COMPONENT_NAME };\n","import { Slider, COMPONENT_NAME } from './slider';\n\n/**\n * jQuery Component Wrapper for Slider\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.slider = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Slider(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\n\n// Name of this component\nconst COMPONENT_NAME = 'zoom';\n\n/**\n* The Zoom Component is used to manage zoom on mobile devices.\n* @class Zoom\n* @param {object} element The component element.\n* @param {object} [settings] The component settings.\n*/\nfunction Zoom(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(element, settings);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nZoom.prototype = {\n  init() {\n    return this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n  * Add markup to the control\n  * @private\n  * @returns {object} The api prototype for chaining.\n  */\n  build() {\n    // get references to elements\n    this.viewport = this.element.find('meta[name=viewport]');\n    this.body = $('body');\n\n    return this;\n  },\n\n  /**\n  * Sets up event handlers for this control and its sub-elements\n  * @private\n  * @returns {object} The api prototype for chaining.\n  */\n  handleEvents() {\n    const self = this;\n\n    // Allow the head to listen to events to globally deal with the zoom problem on\n    // a per-control basis (for example, Dropdown/Multiselect need to handle this issue manually).\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      self.updated();\n    }).on('enable-zoom', () => {\n      self.enableZoom();\n    }).on('disable-zoom', () => {\n      self.disableZoom();\n    });\n\n    // Don't continue setting this up on each element if\n    if (env.os.name !== 'ios') {\n      return this;\n    }\n\n    // Setup conditional events for all elements that need it.\n    this.body.on('touchstart.zoomdisabler', 'input, label', () => {\n      if (self.noZoomTimeout) {\n        return;\n      }\n\n      self.disableZoom();\n    }).on('touchend.zoomdisabler', 'input, label', () => {\n      if (self.noZoomTimeout) {\n        clearTimeout(self.noZoomTimeout);\n        self.noZoomTimeout = null;\n      }\n      self.noZoomTimeout = setTimeout(() => {\n        self.noZoomTimeout = null;\n        self.enableZoom();\n      }, 600);\n    });\n\n    return this;\n  },\n\n  /**\n  * Enable zoom by un-setting the meta tag.\n  */\n  enableZoom() {\n    // TODO: Test to see if prepending this meta tag conflicts with Base Tag implementation\n    this.viewport[0].setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=1');\n  },\n\n  /**\n  * Disable zoom by setting the meta tag.\n  */\n  disableZoom() {\n    // TODO: Test to see if prepending this meta tag conflicts with Base Tag implementation\n    this.viewport[0].setAttribute('content', 'width=device-width, initial-scale=1.0, user-scalable=0');\n  },\n\n  /**\n  * Handle Updating Settings\n  * @param {object} settings The settings to update to.\n  * @returns {this} component instance\n  */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n  * Simple Teardown - remove events & rebuildable markup.\n  * @private\n  * @returns {object} component instance\n  */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME} enable-zoom disable-zoom`);\n    this.body.off('touchstart.zoomdisabler touchend.zoomdisabler');\n    return this;\n  },\n\n  /**\n  * Teardown - Remove added markup and events\n  */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Zoom, COMPONENT_NAME };\n","import { Zoom, COMPONENT_NAME } from './zoom';\n\n/**\n * jQuery Component Wrapper for Zoom\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.zoom = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Zoom(this, settings));\n    }\n  });\n};\n","import { Environment as env } from '../../utils/environment';\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../button/button.jquery';\nimport '../mask/mask-input.jquery';\nimport '../zoom/zoom.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'spinbox';\n\n// Component Defaults\nconst SPINBOX_DEFAULTS = {\n  autocorrectOnBlur: false,\n  min: -2147483647,\n  max: 2147483647,\n  step: null,\n  validateOnInput: true\n};\n\n/**\n * The Spinbox component provides easy access to modification of a numeric input field.\n * @class Spinbox\n * @constructor\n * @param {jQuery[]|HTMLElement} element the base element\n * @param {object} [settings] incoming settings\n * @param {boolean} [settings.autocorrectOnBlur = false] If true the input will adjust to the nearest step on blur.\n * @param {Number} [settings.min = -2147483647] if defined, provides a minimum numeric limit\n * @param {Number} [settings.max = 2147483647]  if defined, provides a maximum numeric limit\n * @param {null|Number} [settings.step = null]  if defined, increases or decreases the spinbox value\n *  by a specific interval whenever the control buttons are used.\n * @param {boolean} [settings.validateOnInput = true]  If set to false, will only automatically correct\n *  the spinbox value after the spinbox has lost focus.\n */\nfunction Spinbox(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, SPINBOX_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nSpinbox.prototype = {\n\n  /**\n   * @private\n   * @returns {boolean} whether or not touch controls are available\n   */\n  get isTouch() {\n    return env.features.touch;\n  },\n\n  /**\n   * @private\n   */\n  init() {\n    this.inlineLabel = this.element.closest('label');\n    this.inlineLabelText = this.inlineLabel.find('.label-text');\n    this.isInlineLabel = this.element.parent().is('.inline');\n    this.isWrapped = this.element.parent().is('.spinbox-wrapper');\n\n    this\n      .setInitialValue()\n      .addMarkup()\n      .bindEvents()\n      .setWidth();\n  },\n\n  /**\n   * Sets the width of the spinbox input field.\n   * @private\n   * @returns {this} component instance\n   */\n  setWidth() {\n    const style = this.element[0].style;\n\n    if (style.width) {\n      this.element.parent()[0].style.width = `${parseInt(style.width, 10) + (this.element.parent().find('.down').outerWidth() * 2)}px`;\n    }\n\n    return this;\n  },\n\n  /**\n   * Sanitize the initial value of the input field.\n   * @private\n   * @returns {this} component instance\n   */\n  setInitialValue() {\n    const self = this;\n    const val = self.checkForNumeric(self.element.val());\n\n    this.element.val(val);\n    // If using Dirty Tracking, reset the \"original\" value of the dirty tracker to the current value\n    // of the input, since it may have changed after re-invoking the input field.\n    if (this.element.attr('data-trackdirty')) {\n      this.element.data('original', val);\n    }\n\n    // allow numeric input on iOS\n    const iOS = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);\n    if (iOS) {\n      this.element.attr('pattern', '\\\\d*');\n    }\n\n    if (this.element.attr('max')) {\n      this.settings.max = this.element.attr('max');\n    } else if (this.settings.max) {\n      this.element.attr('max', this.settings.max);\n    }\n\n    if (this.element.attr('step')) {\n      this.settings.max = this.element.attr('step');\n    } else if (this.settings.step) {\n      this.element.attr('step', this.settings.step);\n    }\n\n    if (this.element.attr('min')) {\n      this.settings.max = this.element.attr('min');\n    } else if (this.settings.min) {\n      this.element.attr('min', this.settings.min);\n    }\n\n    return this;\n  },\n\n  /**\n   * Appends extra control markup to a Spinbox field.\n   * @private\n   * @returns {this} component instance\n   */\n  addMarkup() {\n    const self = this;\n    if (this.isInlineLabel) {\n      this.inlineLabel.addClass('spinbox-wrapper');\n    } else if (!this.isWrapped) {\n      const spinboxWrapper = '<span class=\"spinbox-wrapper\"></span>';\n      if (this.element.is('.field-options')) {\n        const field = this.element.closest('.field');\n        const fieldOptionsTrigger = field.find('.btn-actions');\n\n        this.element\n          .add(fieldOptionsTrigger)\n          .add(fieldOptionsTrigger.next('.popupmenu'))\n          .wrapAll(spinboxWrapper);\n      } else {\n        this.element.wrap(spinboxWrapper);\n      }\n    }\n\n    if (this.isWrapped) {\n      this.buttons = {\n        down: this.element.parent().find('.down').button(),\n        up: this.element.parent().find('.up').button()\n      };\n\n      if (this.isTouch) {\n        this.buttons.down.attr('aria-hidden', 'true');\n        this.buttons.up.attr('aria-hidden', 'true');\n      }\n    }\n\n    if (!this.buttons) {\n      this.buttons = {\n        down: $(`<span ${this.isTouch ? '' : 'aria-hidden=\"true\"'} class=\"spinbox-control down\">-</span>`).insertBefore(this.element).button(),\n        up: $(`<span ${this.isTouch ? '' : 'aria-hidden=\"true\"'} class=\"spinbox-control up\">+</span>`).insertAfter(this.element).button()\n      };\n    }\n\n    // Figure out minimum/maximum and data-masking attributes.  The user can provide the spinbox\n    // plugin either the min/max or the mask, and the plugin will automatically figure out how to\n    // use them.\n    const min = this.element.attr('min');\n    let max = this.element.attr('max');\n    let mask = this.element.attr('data-mask');\n    let maskValue = '';\n    const attributes = {\n      role: 'spinbutton'\n    };\n    let i = 0;\n\n    // Define a default Max value if none of these attributes exist, to ensure the mask plugin will\n    // work correctly.  Cannot define a Min value here because the plugin must be able to invoke\n    // itself with a NULL value.\n    if (!min && !max && !mask) {\n      max = '9999999';\n    }\n\n    // If a mask doesn't exist, but min and max values do exist, create a mask that reflects\n    // those min/max values\n    if ((min || max) && !mask) {\n      let newMask = '';\n      const tempMin = min || '';\n      const tempMax = max || '';\n      const longerVal = tempMin.length > tempMax.length ? tempMin : tempMax;\n      i = 0;\n\n      while (i <= longerVal.length) {\n        newMask += '#';\n        i++;\n      }\n\n      // Add a negative symbol to the mask if it exists within the longer value.\n      if (tempMin.indexOf('-') !== -1 || tempMax.indexOf('-') !== -1) {\n        newMask = `-${newMask.substring(0, (newMask.length - 1))}`;\n      }\n\n      attributes['data-mask'] = newMask;\n      mask = newMask;\n    }\n\n    // If a \"data-mask\" attribute is already defined, use it to determine missing values\n    // for min/max, if they don't already exist.\n    const maskSize = mask.length;\n\n    i = 0;\n    while (i <= maskSize) {\n      maskValue += '9';\n      i++;\n    }\n\n    // If no negative symbol exists in the mask, the minimum value must be zero.\n    if (mask.indexOf('-') === -1) {\n      attributes.min = min || 0;\n      attributes.max = max || maskValue;\n    } else {\n      attributes.min = min || maskValue;\n      attributes.max = max || maskValue.substring(0, (maskValue.length - 1));\n    }\n\n    if (!this.element.attr('data-mask-mode') || this.element.attr('data-mask-mode') !== 'number') {\n      attributes['data-mask-mode'] = 'number';\n    }\n\n    // Destroy the Mask Plugin if it's already been invoked.  We will reinvoke it later\n    // on during initialization.  Check to make sure its the actual Mask plugin object,\n    // and not the \"data-mask\" pattern string.\n    if (this.element.data('mask') && typeof this.element.data('mask') === 'object') {\n      this.element.data('mask').destroy();\n    }\n\n    // Add Aria Properties for valuemin/valuemax\n    attributes['aria-valuemin'] = min || 0;\n    attributes['aria-valuemax'] = max || 0;\n    this.element.attr(attributes);\n\n    // Set an initial \"aria-valuenow\" value.\n    this.updateAria(self.element.val());\n\n    // Invoke the mask plugin\n    this.element.mask();\n\n    // Disable in full if the settings have determined we need to disable on init.\n    if (this.isDisabled()) {\n      this.disable();\n    }\n\n    if (this.element.attr('readonly')) {\n      this.readonly();\n    }\n\n    return this;\n  },\n\n  /**\n   * Enables Long Pressing one of the Spinbox control buttons.\n   * @private\n   * @param {jQuery.Event} e jQuery `touchstart` or `mousedown` events\n   * @param {Spinbox} self this component instance\n   * @returns {void}\n   */\n  enableLongPress(e, self) {\n    self.addButtonStyle(e);\n    self.longPressInterval = setInterval(() => {\n      if ($(e.currentTarget).is(':hover')) {\n        self.handleClick(e);\n      }\n    }, 140);\n  },\n\n  /**\n   * Disables Long Pressing one of the Spinbox control buttons.\n   * @private\n   * @param {jQuery.Event} e jQuery `touchend` or `mouseup` events\n   * @param {Spinbox} self this component instance\n   * @returns {void}\n   */\n  disableLongPress(e, self) {\n    self.removeButtonStyle(e);\n    clearInterval(self.longPressInterval);\n    self.longPressInterval = null;\n  },\n\n  /**\n   * Event handler for 'click' events\n   * @private\n   * @param {jQuery.Event} e jQuery `click` event\n   * @returns {void}\n   */\n  handleClick(e) {\n    e.preventDefault();\n\n    if (this.isDisabled() || e.which !== 1 || this.isReadonly()) {\n      return;\n    }\n    const target = $(e.currentTarget);\n    if (target.hasClass('up')) {\n      this.increaseValue();\n    } else {\n      this.decreaseValue();\n    }\n\n    this.safeFocus();\n  },\n\n  /**\n   * Event handler for 'keydown' events\n   * @private\n   * @param {jQuery.Event} e jQuery `keydown` event\n   * @param {Spinbox} self component instance\n   */\n  handleKeyDown(e, self) {\n    const key = e.which;\n    const validKeycodes = [35, 36, 37, 38, 39, 40];\n\n    if ($.inArray(key, validKeycodes) === -1) {\n      return;\n    }\n\n    if (this.isReadonly()) {\n      return;\n    }\n\n    // If the keycode got this far, it's an arrow key, HOME, or END.\n    switch (key) {\n      case 35: // End key sets the spinbox to its minimum value\n        if (self.element.attr('min')) { self.element.val(self.element.attr('min')); }\n        break;\n      case 36: // Home key sets the spinbox to its maximum value\n        if (self.element.attr('max')) { self.element.val(self.element.attr('max')); }\n        break;\n      case 38: // Up increases the spinbox value\n        self.addButtonStyle(self.buttons.up);\n        self.increaseValue();\n        break;\n      case 40: // Down decreases the spinbox value\n        self.addButtonStyle(self.buttons.down);\n        self.decreaseValue();\n        break;\n      default:\n        break;\n    }\n  },\n\n  /**\n   * Event handler for 'keypress' events\n   * TODO: Deprecate in 4.4.0\n   * @private\n   * @param {jQuery.Event} e jQuery `keypress` event\n   * @param {Spinbox} self component instance\n   * @returns {void}\n   */\n  handleKeyPress(e, self) {\n    const key = e.which;\n\n    // NOTE:\n    if (key < 48 || (key > 57 && key < 96) || key > 105) {\n      return undefined;\n    }\n\n    return this.handleInput(e, self);\n  },\n\n  /**\n   * Event handler for the 'input' event\n   * @private\n   * @param {jQuery.Event} e jQuery `input` event\n   * @param {Spinbox} self this component instance\n   * @returns {void}\n   */\n  handleInput(e, self) {\n    if (self.isDisabled() || this.isReadonly()) {\n      return undefined;\n    }\n\n    // If we're only auto-correcting on blur, don't continue.\n    if (this.settings.autocorrectOnBlur) {\n      return undefined;\n    }\n\n    return this.correctValue(e);\n  },\n\n  /**\n   * Event handler for 'keyup' events\n   * @private\n   * @param {jQuery.Event} e jQuery `input` event\n   * @param {Spinbox} self this component instance\n   * @returns {void}\n   */\n  handleKeyup(e, self) {\n    if (self.isDisabled() || this.isReadonly()) {\n      return;\n    }\n    const key = e.which;\n\n    // Spinbox Control Button styles are added/removed on keyup.\n    switch (key) {\n      case 38: case 39:\n        if (Locale.isRTL() && key === 39) {\n          self.removeButtonStyle(self.buttons.down);\n        } else {\n          self.removeButtonStyle(self.buttons.up);\n        }\n        break;\n      case 37: case 40:\n        if (Locale.isRTL() && key === 39) {\n          self.removeButtonStyle(self.buttons.up);\n        } else {\n          self.removeButtonStyle(self.buttons.down);\n        }\n        break;\n      default:\n        break;\n    }\n\n    self.updateAria(self.element.val());\n  },\n\n  /**\n   * Change a newly pasted value to this element's min or max values, if the pasted\n   * value goes beyond either of those limits.  Listens to an event emitted by the\n   * Mask plugin after pasted content is handled.\n   * @private\n   * @param {Spinbox} self this component instance\n   * @returns {void}\n   */\n  handleAfterPaste(self) {\n    const min = Number(self.element.attr('min'));\n    const max = Number(self.element.attr('max'));\n    let val = Number(self.element.val());\n\n    if (val < min) {\n      val = min;\n    }\n    if (val > max) {\n      val = max;\n    }\n\n    self.updateVal(val);\n  },\n\n  /**\n   * Fixes a value that may have been entered programmatically, or by paste,\n   * if it goes out of the range boundaries.\n   * @private\n   * @param {jQuery.Event} e jQuery `input` event\n   * @returns {void}\n   */\n  correctValue(e) {\n    const num = Number(this.element.val());\n    const min = this.element.attr('min');\n    const max = this.element.attr('max');\n\n    if (num < min) {\n      if (e) {\n        e.preventDefault();\n      }\n      return this.updateVal(min);\n    }\n    if (num > max) {\n      if (e) {\n        e.preventDefault();\n      }\n      return this.updateVal(max);\n    }\n    return undefined;\n  },\n\n  /**\n   * Increases the value of the Spinbox field, constrained by the step interval and maximum limit.\n   * @returns {void}\n   */\n  increaseValue() {\n    const max = this.element.attr('max');\n    const val = this.checkForNumeric(this.element.val()) + Number(this.element.attr('step') || 1);\n\n    if (max && val > max) {\n      return this.updateVal(max);\n    }\n    return this.updateVal(val);\n  },\n\n  /**\n   * Decreases the value of the Spinbox field, constrained by the step interval and minimum limit.\n   * @returns {void}\n   */\n  decreaseValue() {\n    const min = this.element.attr('min');\n    const val = this.checkForNumeric(this.element.val()) - Number(this.element.attr('step') || 1);\n\n    if (min && val < min) {\n      return this.updateVal(min);\n    }\n    return this.updateVal(val);\n  },\n\n  /**\n   * Sets a new spinbox value and focuses the spinbox.\n   * @param {Number|String} newVal the value to set on the spinbox\n   * @returns {void}\n   */\n  updateVal(newVal) {\n    this.element.val(newVal).trigger('change');\n    this.updateAria(newVal);\n  },\n\n  /**\n   * Sanitizes the value of the input field to an integer if it isn't already established.\n   * @private\n   * @param {Number|String} val will be converted to a number if it's a string.\n   * @returns {number} a numeric version of the value provided, or a corrected value.\n   */\n  checkForNumeric(val) {\n    // Allow for NULL\n    if (val === '') {\n      return val;\n    }\n    if ($.isNumeric(val)) {\n      return Number(val);\n    }\n    val = parseInt(val, 10);\n    if ($.isNumeric(val)) {\n      return Number(val);\n    }\n    // Zero out the value if a number can't be made out of it.\n    return 0;\n  },\n\n  /**\n   * Updates the \"aria-valuenow\" property on the spinbox element if the value is currently set\n   * @private\n   * @param {number} val the new value to be set on the spinbox\n   * @returns {void}\n   */\n  updateAria(val) {\n    const min = this.element.attr('min');\n    const max = this.element.attr('max');\n\n    val = this.checkForNumeric(val);\n    this.element[0].setAttribute('aria-valuenow', val || '0');\n\n    // Toggle min/max buttons\n    this.setIsDisabled(this.buttons.up, (val !== '' && max && val >= max) ? 'disable' : 'enable');\n    this.setIsDisabled(this.buttons.down, (val !== '' && min && val <= min) ? 'disable' : 'enable');\n  },\n\n  /**\n   * Adds a \"pressed-in\" styling for one of the spinner buttons.\n   * @private\n   * @param {jQuery.Event|jQuery[]} e either an incoming event, or a button element to be acted on\n   * @returns {void}\n   */\n  addButtonStyle(e) {\n    if (this.isDisabled() || this.isReadonly()) {\n      return;\n    }\n    let target = e;\n    if (e.currentTarget) {\n      target = $(e.currentTarget);\n    }\n    target.addClass('is-active');\n  },\n\n  /**\n   * Removes \"pressed-in\" styling for one of the spinner buttons\n   * @private\n   * @param {jQuery.Event|jQuery[]} e either an incoming event, or a button element to be acted on\n   * @returns {void}\n   */\n  removeButtonStyle(e) {\n    if (this.isDisabled() || this.isReadonly()) {\n      return;\n    }\n    let target = e;\n    if (e.currentTarget) {\n      target = $(e.currentTarget);\n    }\n    target.removeClass('is-active');\n  },\n\n  /**\n   * Focuses the main input field without a mobile zoom.\n   * @returns {void}\n   */\n  safeFocus() {\n    const isMobile = env.os.name === 'ios' || env.os.name === 'android';\n    if (isMobile) {\n      $('head').triggerHandler('disable-zoom');\n    }\n\n    this.element.focus();\n\n    if (isMobile) {\n      $('head').triggerHandler('enable-zoom');\n    }\n  },\n\n  /**\n   * Enables the Spinbox\n   * @returns {void}\n   */\n  enable() {\n    this.element.prop('disabled', false);\n    this.element.parent('.spinbox-wrapper').removeClass('is-disabled is-readonly');\n  },\n\n  /**\n   * Disables the Spinbox\n   * @returns {void}\n   */\n  disable() {\n    this.element.prop('disabled', true);\n    this.element.parent('.spinbox-wrapper').addClass('is-disabled');\n  },\n\n  /**\n   * Makes the Spinbox readonly\n   * @returns {void}\n   */\n  readonly() {\n    this.element.prop('readonly', true);\n    this.element.parent('.spinbox-wrapper').addClass('is-readonly');\n  },\n\n  /**\n   * Checks if the Spinbox is readonly\n   * @returns {void}\n   */\n  isReadonly() {\n    return this.element.prop('readonly');\n  },\n\n  /**\n   * Determines whether or not the spinbox is disabled.\n   * @returns {boolean} whether or not the spinbox is disabled.\n   */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n   * Toggle whther or not the component is disabled.\n   * @private\n   * @param {jQuery[]} button the button element to be disabled\n   * @param {booelan} [isDisabled] whether or not to force a change to the button's state.\n   * @returns {void}\n   */\n  setIsDisabled(button, isDisabled) {\n    isDisabled = isDisabled === undefined ? true :\n      !((!isDisabled || isDisabled === 'enable'));\n\n    button[isDisabled ? 'addClass' : 'removeClass']('is-disabled');\n  },\n\n  /**\n   * Updated\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n    return this;\n  },\n\n  /**\n   * Teardown\n   * @returns {void}\n   */\n  destroy() {\n    const mask = this.element.data('mask');\n    if (mask && typeof mask.destroy === 'function') {\n      mask.destroy();\n    }\n\n    for (const button in this.buttons) { // eslint-disable-line\n      const buttonAPI = $(button).data('button');\n\n      if (buttonAPI) {\n        buttonAPI.destroy();\n      }\n    }\n\n    this.buttons.up.off('click.spinbox mousedown.spinbox');\n    this.buttons.up.remove();\n    this.buttons.down.off('click.spinbox mousedown.spinbox');\n    this.buttons.down.remove();\n    this.element.off('focus.spinbox blur.spinbox keydown.spinbox keyup.spinbox');\n    this.element.unwrap();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n  *  Fires when the input gains focus.\n  * @event focus\n  * @memberof Spinbox\n  * @property {object} event - The jquery event object\n  */\n  /**\n   * Fires when the input looses focus.\n   * @event blur\n   * @memberof Spinbox\n   * @property {object} event - The jquery event object\n   */\n  /**\n    * Fires when a key is pressed down.\n    * @event keydown\n    * @memberof Spinbox\n    * @property {object} event - The jquery event object\n  */\n  /**\n    * Fires when a key is pressed.\n    * @event keypress\n    * @memberof Spinbox\n    * @property {object} event - The jquery event object\n  */\n  /**\n    * Fires when a key is pressed up.\n    * @event keyup\n    * @memberof Spinbox\n    * @property {object} event - The jquery event object\n  */\n  /**\n    * Fires after input is pasted in.\n    * @event afterpaste\n    * @memberof Spinbox\n    * @property {object} event - The jquery event object\n  */\n\n  /**\n   * Sets up event handlers for this control and its sub-elements\n   * @private\n   * @returns {void}\n   */\n  bindEvents() {\n    const self = this;\n    let preventClick = false;\n\n    // Main Spinbox Input\n    this.element.on('focus.spinbox', () => {\n      self.element.parent('.spinbox-wrapper').addClass('is-focused');\n    }).on('blur.spinbox', () => {\n      self.element.parent('.spinbox-wrapper').removeClass('is-focused');\n      if (self.settings.autocorrectOnBlur) {\n        self.correctValue();\n      }\n    }).on('keydown.spinbox', (e) => {\n      self.handleKeyDown(e, self);\n    }).on('input.spinbox', (e) => {\n      self.handleInput(e, self);\n    })\n      .on('keyup.spinbox', (e) => {\n        self.handleKeyup(e, self);\n      })\n      .on('afterpaste.mask', () => {\n        self.handleAfterPaste(self);\n      });\n\n    // Up and Down Buttons\n    const buttons = this.buttons.up.add(this.buttons.down[0]);\n    buttons.on('touchstart.spinbox mousedown.spinbox', (e) => {\n      if (e.which === 1) {\n        if (!preventClick) {\n          self.handleClick(e);\n        }\n\n        if (self.isTouch) {\n          return;\n        }\n\n        preventClick = true;\n        self.enableLongPress(e, self);\n\n        $(document).one('mouseup', () => {\n          self.disableLongPress(e, self);\n          preventClick = false;\n          self.safeFocus();\n        });\n      }\n    });\n\n    return this;\n  }\n};\n\nexport { Spinbox, COMPONENT_NAME };\n","import { Spinbox, COMPONENT_NAME } from './spinbox';\n\n/**\n * jQuery Component Wrapper for Spinbox\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.spinbox = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Spinbox(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\n\n// Component Name\nconst COMPONENT_NAME = 'splitter';\n\n// Default Splitter Options\nconst SPLITTER_DEFAULTS = {\n  axis: 'x',\n  side: 'left', // or right\n  resize: 'immediate',\n  containment: null, // document or parent\n  save: true,\n  maxWidth: {\n    left: 'auto',\n    right: 'auto'\n  }\n};\n\n/**\n* Splitter Component\n* @class Splitter\n* @constructor\n* @param {string} element The component element.\n* @param {string} [settings] The component settings.\n* @param {string} [settings.axis = 'x'] The axis on which to split x or y\n* @param {string} [settings.side = 'left'] Which side to dock to 'left' or 'right'.\n* @param {string} [settings.resize = 'immediate'] When to resize, during the drag 'immediate' or 'end'\n* @param {HTMLElement|jQuery[]} [settings.containment = null] When to stop the splitter, this can be document, or a parent element\n* @param {boolean} [settings.save = true] If true the split size will automatically be saved for next time\n* @param {object} [settings.maxWidth = {left: 'auto', right: 'auto'}] Ability to stop dragging at a max left or right size.\n*/\nfunction Splitter(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, SPLITTER_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nSplitter.prototype = {\n\n  /**\n   * Do other init (change/normalize settings, load externals, etc)\n   * @private\n   * @returns {this} component instance\n   */\n  init() {\n    return this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n   * Build the Control and Events\n   * @private\n   * @returns {void}\n   */\n  build() {\n    const self = this;\n    const s = this.settings;\n    const splitter = this.element;\n    const parent = splitter.parent();\n    const direction = s.axis === 'x' ? 'left' : 'top';\n    const thisSide = parent.is('.content') ? parent.parent() : parent;\n    const defaultOffset = 299;\n    let w = parent.width();\n    let parentHeight;\n\n    setTimeout(() => {\n      parentHeight = parent.height();\n    }, 0);\n\n    this.docBody = $('body');\n    this.isSplitterRightSide = splitter.is('.splitter-right') || (s.axis === 'x' && s.side === 'right');\n    this.isSplitterHorizontal = splitter.is('.splitter-horizontal') || s.axis === 'y';\n    s.uniqueId = utils.uniqueId(this.element, 'splitter');\n\n    if (this.isSplitterRightSide) {\n      const thisPrev = thisSide.prev();\n      if (thisPrev.is('.main')) {\n        this.leftSide = thisPrev;\n        w = thisSide.parent().outerWidth() - w;\n      } else {\n        this.leftSide = thisSide;\n        splitter.addClass('splitter-right');\n      }\n\n      thisSide.addClass('is-right-side')\n        .next().addClass('flex-grow-shrink is-right-side')\n        .parent()\n        .addClass('splitter-container');\n\n      if (s.collapseButton) {\n        let savedOffset = 0;\n        const splitterButton = $('<button type=\"button\" class=\"splitter-btn\" id=\"splitter-collapse-btn\"><svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-double-chevron\"></use></svg></button>');\n        splitterButton.appendTo(splitter);\n        if (splitter[0].offsetLeft > 10) {\n          $('#splitter-collapse-btn').addClass('rotate');\n        }\n        $('#splitter-collapse-btn').click(function () {\n          if (savedOffset <= 0) {\n            if (splitter[0].offsetLeft <= 10) {\n              self.splitTo(defaultOffset, parentHeight);\n              $(this).addClass('rotate');\n            } else {\n              savedOffset = splitter[0].offsetLeft;\n              self.splitTo(0, parentHeight);\n              $(this).removeClass('rotate');\n            }\n          } else if (splitter[0].offsetLeft > 10) {\n            savedOffset = splitter[0].offsetLeft;\n            self.splitTo(0, parentHeight);\n            $(this).removeClass('rotate');\n          } else {\n            self.splitTo(savedOffset, parentHeight);\n            $(this).addClass('rotate');\n            savedOffset = 0;\n          }\n        });\n      }\n    } else if (this.isSplitterHorizontal) {\n      this.topPanel = splitter.prev();\n      w = this.topPanel.height();\n\n      parent.addClass('splitter-container is-horizontal');\n      splitter.next().addClass('flex-grow-shrink');\n      splitter.addClass('splitter-horizontal');\n    } else {\n      this.rightSide = thisSide;\n      this.leftSide = thisSide.prev().parent();\n\n      thisSide.prev()\n        .addClass('flex-grow-shrink')\n        .parent().addClass('splitter-container');\n    }\n\n    // Restore from local storage\n    if (localStorage && s.save &&\n      !isNaN(parseInt(localStorage[s.uniqueId], 10))) {\n      w = localStorage[s.uniqueId];\n    }\n\n    w = parseInt(w, 10);\n\n    if (this.isSplitterHorizontal) {\n      splitter[0].style.top = `${w}px`;\n    } else {\n      splitter[0].style.top = 0;\n    }\n\n    this.splitTo(w, parentHeight);\n\n    if (w <= 10) {\n      $('#splitter-collapse-btn').removeClass('rotate');\n    }\n\n    // Add the Splitter Events\n    this.documentWidth = 0;\n\n    this.element.drag({\n      axis: s.axis,\n      containment: s.containment || s.axis === 'x' ? 'document' : 'parent',\n      containmentOffset: { left: 20, top: 0 }\n    }).on('dragstart.splitter', () => {\n      const iframes = $('iframe');\n      self.documentWidth = $(document).width();\n\n      if (iframes.length > 0) {\n        for (let i = 0, l = iframes.length; i < l; i++) {\n          const frame = $(iframes[i]);\n          // eslint-disable-next-line\n          const width = `${parseInt(getComputedStyle(frame.parent()[0]).width, 10) - 40}px`;\n          const overlay = $('<div class=\"overlay splitter-overlay\"></div>');\n          overlay.css('width', width);\n          frame.before(overlay);\n        }\n      }\n    }).on('dragend.splitter', (e, args) => {\n      $('.overlay').remove();\n\n      if (s.collapseButton) {\n        if (args[direction] <= 10) {\n          $('#splitter-collapse-btn').removeClass('rotate');\n        } else {\n          $('#splitter-collapse-btn').addClass('rotate');\n        }\n      }\n\n      if (s.resize === 'end') {\n        self.splitTo(args[direction], parentHeight);\n      }\n    }).on('drag.splitter', (e, args) => {\n      if (args.left <= 0) {\n        return false;\n      }\n      if (s.resize === 'immediate') {\n        self.splitTo(args[direction], parentHeight);\n      }\n      return true;\n    });\n\n    // Horizontal Splitter\n    if (s.axis === 'y') {\n      this.element.addClass('splitter-horizontal');\n    }\n\n    // Aria\n    this.element.attr({ 'aria-dropeffect': 'move', tabindex: '0', 'aria-grabbed': 'false' });\n\n    return this;\n  },\n\n  /**\n   * Toggle selection\n   * @private\n   * @returns {void}\n   */\n  toggleSelection() {\n    this.element.toggleClass('is-dragging');\n  },\n\n  /**\n   * Resize the panel vertically\n   * @private\n   * @param {object} splitter element.\n   * @param {number} top value.\n   * @param {number} parentHeight value.\n   * @returns {void}\n   */\n  resizeTop(splitter, top, parentHeight) {\n    if (top > parentHeight || top < 0) {\n      top = parseInt(parentHeight, 10) / 2;\n    }\n\n    this.topPanel[0].style.height = `${top}px`;\n  },\n\n  /**\n   * Resize the panel to the Left\n   * @private\n   * @param {object} splitter element.\n   * @param {number} leftArg value.\n   * @returns {void}\n   */\n  resizeLeft(splitter, leftArg) {\n    const left = this.leftSide.outerWidth() - leftArg;\n\n    // Adjust Left and Right Side\n    this.rightSide[0].style.width = `${left}px`;\n\n    // Reset the Width\n    splitter[0].style.left = '';\n  },\n\n  /**\n   * Resize the panel to the Right\n   * @private\n   * @param {object} splitter element.\n   * @param {number} w - width value.\n   * @returns {void}\n   */\n  resizeRight(splitter, w) {\n    // Adjust Left and Right Side\n    this.leftSide[0].style.width = `${w}px`;\n    splitter[0].style.left = `${(w - 1)}px`;\n  },\n\n  /**\n   * Split to\n   * @private\n   * @param {number} split value.\n   * @param {number} parentHeight value.\n   * @returns {void}\n   */\n  splitTo(split, parentHeight) {\n    const self = this;\n    const s = this.settings;\n    const splitter = this.element;\n\n    if (this.isSplitterRightSide) {\n      if (split > s.maxWidth.right) {\n        split = s.maxWidth.right;\n      }\n      this.resizeRight(splitter, split);\n    } else if (this.isSplitterHorizontal) {\n      this.resizeTop(splitter, split, parentHeight);\n    } else {\n      if (split > s.maxWidth.left) {\n        split = s.maxWidth.left;\n      }\n      this.resizeLeft(splitter, split);\n    }\n\n    /**\n    * Fires when after the split occurs. Allowing you to sync any ui.\n    * @event split\n    * @memberof Splitter\n    * @property {object} event The jquery event object\n    * @property {number} split value\n    */\n    this.element.trigger('split', [split]);\n    this.docBody.triggerHandler('resize', [self]);\n\n    // Save to local storage\n    if (localStorage) {\n      localStorage[this.settings.uniqueId] = split;\n    }\n\n    this.split = split;\n    this.parentHeight = parentHeight;\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, SPLITTER_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n  * Destroy and remove added markup, all events\n  * @returns {void}\n  */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    this.element\n      /**\n      * Fires when the component updates.\n      *\n      * @event updated\n      * @memberof Splitter\n      * @type {object}\n      * @property {object} event - The jquery event object\n      */\n      .on(`updated.${COMPONENT_NAME}`, () => {\n        this.updated();\n      })\n\n      /**\n      * Fires when a key is pressed while the component is focused.\n      *\n      * @event keydown\n      * @memberof Splitter\n      * @type {object}\n      * @property {object} event - The jquery event object\n      */\n      .on(`keydown.${COMPONENT_NAME}`, (e) => {\n        // Space will toggle selection\n        if (e.which === 32) {\n          this.toggleSelection();\n          e.preventDefault();\n        }\n\n        if (e.which === 37) {\n          this.splitTo(this.split - 15, this.parentHeight);\n        }\n\n        if (e.which === 39) {\n          this.splitTo(this.split + 15, this.parentHeight);\n        }\n      });\n\n    return this;\n  }\n\n};\n\nexport { Splitter, COMPONENT_NAME };\n","import { Splitter, COMPONENT_NAME } from './splitter';\n\n/**\n * jQuery Component Wrapper for Splitter\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.splitter = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Splitter(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { Environment as env } from '../../utils/environment';\n\n// jQuery Components\nimport '../listview/listview.jquery';\n\n// The name of this component\nconst COMPONENT_NAME = 'swaplist';\n\n// The Component Defaults\nconst SWAPLIST_DEFAULTS = {\n  // Searchable\n  searchable: false,\n\n  // Datasets\n  available: null,\n  selected: null,\n  additional: null,\n\n  // Main containers\n  availableClass: '.available',\n  selectedClass: '.selected',\n  additionalClass: '.full-access',\n\n  // Action buttons\n  availableBtn: '.btn-moveto-selected',\n  selectedBtnLeft: '.btn-moveto-left',\n  selectedBtnRight: '.btn-moveto-right',\n  additionalBtn: '.btn-moveto-selected',\n\n  draggable: {\n    available: true,\n    selected: true,\n    additional: true\n  },\n\n  // Template HTML\n  template: '' +\n    '<ul data-swap-handle=\".handle\">' +\n      '{{#dataset}}' +\n        '{{#text}}' +\n          '<li data-id=\"{{id}}\"' +\n            '{{#value}} data-value=\"{{value}}\"{{/value}}' +\n            '{{#selected}} selected=\"selected\"{{/selected}}' +\n            '{{#disabled}} class=\"is-disabled\"{{/disabled}}' +\n          '>' +\n            '<span class=\"handle\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">&#8286;</span>' +\n            '<div class=\"swaplist-item-content\"><p>{{text}}</p></div>' +\n          '</li>' +\n        '{{/text}}' +\n      '{{/dataset}}' +\n    '</ul>'\n};\n\n/**\n* The SwapList Component creates a list of options that can be picked and organized.\n* @class SwapList\n* @param {object} element The component element.\n* @param {object} [settings] The component settings.\n* @param {boolean} [settings.searchable = false] If true, associates itself with a Searchfield/Autocomplete\n*  and allows itself to be filtered\n* @param {array} [settings.available] An array containing items for the available bucket.\n* @param {array} [settings.selected] An array containing items for the selected bucket.\n* @param {array} [settings.additional] An array containing items for the additional bucket.\n* @param {string} [settings.availableClass = '.available'] A class name linking the available root element.\n* @param {string} [settings.selectedClass = '.selected'] A class name linking the selected root element.\n* @param {string} [settings.additionalClass = '.full-access'] A class name linking the additional root element.\n* @param {string} [settings.availableBtn = '.btn-moveto-selected'] A class name linking the available button element.\n* @param {string} [settings.selectedBtnLeft = '.btn-moveto-left'] A class name linking the move left button element.\n* @param {string} [settings.selectedBtnRight = '.btn-moveto-right'] A class name linking the move right button element.\n* @param {string} [settings.additionalBtn = '.btn-moveto-selected'] A class name linking the additional button element.\n* @param {string} [settings.template] An Html String with the mustache template for the view.\n* @param {object} [settings.draggable] An object containing boolean key/value to make container/s\n*  disable for dragging and moving items. Supported keys with draggable are \"available\",\n*  \"selected\", \"additional\".\n*/\nfunction SwapList(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, SWAPLIST_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// SwapList Methods\nSwapList.prototype = {\n\n  init() {\n    const s = this.settings;\n    s.draggable = $.extend(true, SWAPLIST_DEFAULTS.draggable, s.draggable);\n    this.isTouch = env.features.touch;\n    this.isAdditional = $(`${s.additionalClass} .listview`, this.element).length > 0;\n\n    if (this.isTouch) {\n      this.element.addClass('is-touch');\n    }\n    this.loadListview();\n    this.initDataset();\n    this.setElements();\n    this.isMultiSelectClass();\n\n    setTimeout(() => { // Wait for Listview availability\n      this.makeDraggable();\n      this.handleEvents();\n      this.initSelected(s.availableClass);\n      this.initSelected(s.additionalClass);\n    }, 0);\n  },\n\n  /**\n   * Load listview\n   * @private\n   */\n  loadListview() {\n    const s = this.settings;\n    const containers = [\n      { dataset: s.available, class: s.availableClass, draggable: s.draggable.available },\n      { dataset: s.selected, class: s.selectedClass, draggable: s.draggable.selected },\n      { dataset: s.additional, class: s.additionalClass, draggable: s.draggable.additional }\n    ];\n\n    for (let i = 0, l = containers.length; i < l; i++) {\n      const c = containers[i];\n      const lv = $(`${c.class} .listview`, this.element);\n      const list = lv.data('listview');\n      const options = { dataset: c.dataset || [], selectable: 'multiple', showCheckboxes: false };\n      const isSearchable = ((s.searchable === true || s.searchable === 'true') && ($(`${c.class} .searchfield`, this.element).length > 0));\n\n      if (isSearchable) {\n        options.searchable = true;\n      }\n\n      // Initialize listview\n      if (!c.dataset && lv.length && $('li', lv).length) {\n        lv.listview(options);\n      } else if (lv.length) {\n        // Remove any previous listview instance\n        if (list) {\n          list.destroy();\n        }\n\n        // Force to have id attribute\n        if (s.template.indexOf('data-id=\"{{id}}\"') === -1) {\n          s.template = s.template.replace('<li', '<li data-id=\"{{id}}\"');\n        }\n\n        options.template = s.template;\n        options.dataset = c.dataset || [];\n\n        // Generate unique id\n        options.dataset.forEach((node) => {\n          if (!(/string|number/.test(typeof node.id)) || node.id === '') {\n            node.id = `sw${(Date.now().toString(36) + Math.round((Math.random() * 36 ** 12)).toString(36).substr(2, 5)).toLowerCase()}`;\n          }\n        });\n\n        if (options.dataset.length === 0) {\n          options.forceToRenderOnEmptyDs = true;\n        }\n        lv.listview(options);\n      }\n\n      // Add css class('is-not-droppable') to ul in this container\n      if (!c.draggable) {\n        $('ul', lv).addClass('is-not-droppable');\n      }\n    }\n  },\n\n  /**\n   * Set elements\n   * @private\n   */\n  setElements() {\n    const s = this.settings;\n    let disabledBtnStr = '';\n\n    this.offset = null;\n\n    this.containers = $(`${s.availableClass},${\n      s.selectedClass},${\n      s.additionalClass}`, this.element);\n\n    this.actionButtons = $(`${s.availableBtn},${\n      s.additionalBtn},${\n      s.selectedBtnLeft},${\n      s.selectedBtnRight}`, this.element);\n\n    this.selectedButtons = $(`${s.selectedBtnLeft},${\n      s.selectedBtnRight}`, this.element);\n\n    this.tabButtonsStr = `${\n      s.availableBtn}, ${\n      s.additionalBtn}, ${\n      this.selectedButtons.length > 1 ?\n        s.selectedBtnRight : s.selectedBtnLeft}`;\n\n    this.dragElements = 'ul:not(.is-not-droppable), ul:not(.is-not-droppable) li:not(.is-disabled)';\n    this.dragStart = 'dragstart.swaplist touchstart.swaplist gesturestart.swaplist';\n    this.dragEnterWhileDragging = 'dragenter.swaplist';\n    this.dragOverWhileDragging = 'dragover.swaplist touchmove.swaplist gesturechange.swaplist';\n    this.dragEnd = 'dragend.swaplist touchend.swaplist touchcancel.swaplist gestureend.swaplist';\n\n    this.selections = {\n      items: [],\n      owner: null,\n      related: null,\n      droptarget: null,\n      isInSelection: null,\n      isHandle: null,\n      placeholder: null,\n      placeholderTouch: null,\n      dragged: null,\n      draggedIndex: null\n    };\n\n    // Dragging time placeholder\n    s.numOfSelectionsClass = 'num-of-selections';\n    s.itemContentClass = 'swaplist-item-content';\n    s.itemContentTempl = $(`<div><p><span class=\"${s.numOfSelectionsClass}\">###</span> ${\n      Locale ? Locale.translate('ItemsSelected') : ' Items Selected '}</p><div/>`);\n\n    // Make top buttons disabled if not draggable\n    if (!s.draggable.available) {\n      disabledBtnStr = `${s.availableClass} ${s.availableBtn},${s.selectedBtnLeft}`;\n      $(disabledBtnStr, this.element).prop('disabled', true);\n    }\n    if (!s.draggable.selected) {\n      disabledBtnStr = `${s.selectedBtnLeft},${s.selectedBtnRight}`;\n      if (!s.draggable.available) {\n        disabledBtnStr += `,${s.additionalClass} ${s.additionalBtn}`;\n      }\n      if (!this.isAdditional || !s.draggable.additional) {\n        disabledBtnStr += `,${s.availableClass} ${s.availableBtn}`;\n      }\n      $(disabledBtnStr, this.element).prop('disabled', true);\n      $(`${s.additionalClass} ${s.additionalBtn}`, this.element).addClass('is-rotate');\n    }\n    if (!s.draggable.additional) {\n      $(`${s.additionalClass} ${s.additionalBtn},${\n        s.selectedBtnRight}`, this.element).prop('disabled', true);\n    }\n  },\n\n  /**\n   * When list is Empty force to add css class \"is-multiselect\"\n   * @private\n   */\n  isMultiSelectClass() {\n    const s = this.settings;\n    const containers = [s.availableClass, s.selectedClass, s.additionalClass];\n\n    for (let i = 0, l = containers.length; i < l; i++) {\n      const lv = $(`${containers[i]} .listview`, this.element);\n      if (!$('li', lv).length) {\n        lv.addClass('is-multiselect');\n      }\n    }\n  },\n\n  /**\n   * Initialize pre selected items\n   * @private\n   * @param {jQuery|HTMLElement} container container element\n   * @returns {void}\n   */\n  initSelected(container) {\n    container = this.isjQuery(container) ? container : $(container, this.element);\n    if (container.length) {\n      const list = $('.listview', container).data('listview');\n      const selected = $('li[selected]', container);\n\n      for (let i = 0, l = selected.length; i < l; i++) {\n        const li = $(selected[i]);\n        li.removeAttr('selected');\n        list.select(li);// Select this item\n      }\n      this.moveElements(container, this.settings.selectedClass);\n    }\n  },\n\n  /**\n   * Move Elements\n   * @private\n   * @param {jQuery[]|HTMLElement} from beginning container\n   * @param {jQuery[]|HTMLElement} to ending contaner\n   * @returns {void}\n   */\n  moveElements(from, to) {\n    if (to === null) {\n      return;\n    }\n\n    from = (typeof from !== 'string') ? from : $(from, this.element);\n    to = (typeof to !== 'string') ? to : $(to, this.element);\n    const list = $('.listview', from).data('listview');\n\n    this.clearSelections();\n    this.selections.owner = from;\n    this.selections.droptarget = to;\n\n    if (this.isTouch) {\n      if (list.selectedItems) {\n        for (let i = 0, l = list.selectedItems.length; i < l; i++) {\n          this.selections.items[i] = list.selectedItems[i].closest('li');\n        }\n      }\n    } else {\n      this.selections.items = list.selectedItems;\n    }\n\n    this.setSelectionsItems(this.selections.owner);\n    this.unselectElements(list);\n\n    if (this.selections.items.length) {\n      this.selections.move = {\n        items: this.selections.itemsData,\n        from: this.getContainer(this.selections.itemsData)\n      };\n      const result = this.element.triggerHandler('beforeswap', [this.selections.move]);\n      if ((typeof result === 'boolean' && !result) || (typeof result === 'string' && result.toLowerCase() === 'false')) {\n        return;\n      }\n\n      const ul = $('ul', to);\n      const currentSize = $('li', ul).length;\n      const size = this.selections.items.length + currentSize;\n\n      if (this.selections.items) {\n        for (let i = 0, l = this.selections.items.length; i < l; i++) {\n          const val = $(this.selections.items[i]);\n          val.attr({ 'aria-posinset': currentSize + i + 1, 'aria-setsize': size }).find('mark.highlight').contents().unwrap();\n          ul.append(val);\n        }\n      }\n\n      this.afterUpdate($('.listview', to).data('listview'));\n    }\n  },\n\n  /**\n   * Get container info from given list items\n   * @private\n   * @param {Array} items to get container info.\n   * @returns {Object} container info (jQuery container element, css-class)\n   */\n  getContainer(items) {\n    const s = this.settings;\n\n    if (typeof items[0] === 'object' && items[0].node) {\n      const container = items[0].node.closest('.card');\n      let cssClass = '';\n\n      if (container.is(s.availableClass)) {\n        cssClass = s.availableClass;\n      } else if (container.is(s.selectedClass)) {\n        cssClass = s.selectedClass;\n      } else if (container.is(s.additionalClass)) {\n        cssClass = s.additionalClass;\n      }\n      return { container, class: cssClass };\n    }\n    return null;\n  },\n\n  /**\n   * Un-select Elements\n   * @private\n   * @param {jQuery|HTMLElement} list the list\n   */\n  unselectElements(list) {\n    if (list.selectedItems) {\n      for (let i = 0, l = list.selectedItems.length; i < l; i++) {\n        list.select($(list.selectedItems[i]));\n      }\n    }\n    if (list && list.element) {\n      list.element.find('li').attr('aria-selected', false).removeClass('is-selected');\n    }\n  },\n\n  /**\n   * Detect browser support for drag-n-drop\n   * @private\n   * @returns {boolean} whether or not drag-n-drop is supported\n   */\n  isDragAndDropSupports() {\n    const div = document.createElement('div');\n    return ('draggable' in div) || ('ondragstart' in div && 'ondrop' in div);\n  },\n\n  /**\n   * Detect browser support for match-media\n   * @private\n   * @returns {boolean} whether or not matchMedia is supported in this browser\n   */\n  isMatchMediaSupports() {\n    return (typeof window.matchMedia !== 'undefined' || typeof window.msMatchMedia !== 'undefined');\n  },\n\n  /**\n   * Detect browser viewport\n   * @private\n   * @returns {object} contains width and height\n   */\n  viewport() {\n    let e = window;\n    let a = 'inner';\n    if (!('innerWidth' in window)) {\n      a = 'client';\n      e = document.documentElement || document.body;\n    }\n    return { width: e[`${a}Width`], height: e[`${a}Height`] };\n  },\n\n  /**\n   * Check given [max-width] is true/false\n   * @private\n   * @param {number} w the current page width\n   * @returns {boolean} whether or not the max-width has been matched\n   */\n  isMaxWidth(w) {\n    return ((this.isMatchMediaSupports() && window.matchMedia(`(max-width: ${w}px)`).matches) || this.viewport().width <= w);\n  },\n\n  /**\n   * Make Draggable\n   * @private\n   */\n  makeDraggable() {\n    const self = this;\n    const ul = $('ul', this.element);\n\n    if (this.isDragAndDropSupports) {\n      // Use Handle if available\n      this.handle = ul.first().attr('data-swap-handle');\n      this.handle = $(this.handle, ul).length > 0 ? this.handle : null;\n      // this.handle = (!this.isTouch && $(this.handle, ul).length > 0) ? this.handle : null;\n      $(this.handle, ul).addClass('draggable')\n        .off('mousedown.swaplist touchstart.swaplist')\n        .on('mousedown.swaplist touchstart.swaplist', () => {\n          this.selections.isHandle = true;\n        })\n        .off('mouseup.swaplist touchend.swaplist')\n        .on('mouseup.swaplist touchend.swaplist', () => {\n          this.selections.isHandle = false;\n        });\n\n      this.targets = ul.attr({ 'aria-dropeffect': 'none' });\n\n      this.items = $('li:not(.is-disabled)', this.element)\n        .not('a[href], img')\n        .off('selectstart.swaplist')\n        .on('selectstart.swaplist', function () {\n          if (this.dragDrop) { this.dragDrop(); } // ie9\n          return false;\n        })\n        .end()\n        .attr({ draggable: true })\n        .addClass(self.handle ? '' : 'draggable');\n    }\n  },\n\n  /**\n   * Get Element By Touch In List\n   * @private\n   * @param {jQuery|HTMLElement} list the list element\n   * @param {number} x touch event's x coordinate\n   * @param {number} y touch event's y coordinate\n   * @returns {jQuery[]} component that was tapped\n   */\n  getElementByTouchInList(list, x, y) {\n    let returns = false;\n    const listJq = $(list);\n\n    for (let i = 0, l = listJq.length; i < l; i++) {\n      const item = $(listJq[i]);\n      const offset = item.offset();\n\n      if (!(x <= offset.left || x >= offset.left + item.outerWidth() ||\n            y <= offset.top || y >= offset.top + item.outerHeight())) {\n        returns = item;\n      }\n    }\n    return returns;\n  },\n\n  /**\n   * Drag touch element\n   * @private\n   * @param {jQuery.Event} e jquery-wrapped `touch` event\n   * @param {jQuery[]} elm the element being dragged\n   */\n  draggTouchElement(e, elm) {\n    const orig = e.originalEvent.changedTouches[0];\n    elm[0].style.top = `${orig.pageY - this.offset.y}px`;\n    elm[0].style.left = `${orig.pageX - this.offset.x}px`;\n  },\n\n  /**\n   * Shorctut for testing whether a modifier key is pressed\n   * @private\n   * @param {jQuery.Event} e the keypress event\n   * @returns {boolean} whether or not a modifier key is pressed\n   */\n  hasModifier(e) {\n    return (e.ctrlKey || e.metaKey || e.shiftKey);\n  },\n\n  /**\n   * Applying dropeffect to the target containers\n   * @private\n   */\n  addDropeffects() {\n    if (this.targets) {\n      for (let i = 0, l = this.targets.length; i < l; i++) {\n        $(this.targets[i]).attr({ 'aria-dropeffect': 'move', tabindex: 0 });\n      }\n    }\n    if (this.selections && this.selections.items) {\n      for (let i = 0, l = this.selections.items.length; i < l; i++) {\n        $(this.selections.items[i]).attr({ 'aria-grabbed': true, tabindex: 0 });\n      }\n    }\n  },\n\n  /**\n   * Removing dropeffect from the target containers\n   * @private\n   */\n  clearDropeffects() {\n    this.targets.attr({ 'aria-dropeffect': 'none' }).removeAttr('tabindex');\n    if (this.selections && this.selections.items) {\n      for (let i = 0, l = this.selections.items.length; i < l; i++) {\n        const val = $(this.selections.items[i]);\n        val.removeAttr(`aria-grabbed${!val.is(':focus') ? ' tabindex' : ''}`);\n      }\n    }\n  },\n\n  /**\n   * Clear selections\n   * @private\n   */\n  clearSelections() {\n    this.selections.items = [];\n    this.selections.itemsData = [];\n    this.selections.owner = null;\n    this.selections.related = null;\n    this.selections.droptarget = null;\n    this.selections.isInSelection = null;\n    this.selections.dragged = null;\n    this.selections.placeholder = null;\n    this.selections.placeholderTouch = null;\n    $('ul, li', this.element).removeClass('over');\n    $('#sl-placeholder-container, #sl-placeholder-touch, #sl-placeholder-touch2, #sl-placeholder').remove();\n  },\n\n  /**\n   * Set selections items\n   * @private\n   * @param {jQuery[]|HTMLElement} container the container element\n   */\n  setSelectionsItems(container) {\n    container = this.isjQuery(container) ? container : $(container, this.element);\n    const nodes = $('.listview li', container);\n    const dataList = this.getDataList(container);\n\n    for (let i = 0, l = nodes.length; i < l; i++) {\n      if ($(nodes[i]).is('.is-selected')) {\n        this.selections.itemsData.push(dataList[i]);\n      }\n    }\n  },\n\n  /**\n   * Init dataset\n   * @private\n   */\n  initDataset() {\n    const s = this.settings;\n    const containers = [\n      { type: 'available', dataset: s.available, class: s.availableClass },\n      { type: 'selected', dataset: s.selected, class: s.selectedClass },\n      { type: 'additional', dataset: s.additional, class: s.additionalClass }\n    ];\n\n    this.dataset = { available: [], selected: [] };\n    if (this.isAdditional) {\n      this.dataset.additional = [];\n    }\n\n    for (let i = 0, l = containers.length; i < l; i++) {\n      const c = containers[i];\n      const nodes = $(`${c.class} .listview li`, this.element);\n\n      for (let nodeIndex = 0, l2 = nodes.length; nodeIndex < l2; nodeIndex++) {\n        let data;\n        let value;\n        const li = $(nodes[nodeIndex]);\n        if (c.dataset) {\n          // Make sure it's not reference pointer to data object, make copy of data\n          data = JSON.parse(JSON.stringify(c.dataset[nodeIndex]));\n          delete data.selected;\n        } else {\n          data = { text: $.trim($('.swaplist-item-content', li).text()) };\n          value = li.attr('data-value');\n          if (value) {\n            data.value = value;\n          }\n        }\n        if (this.dataset[c.type]) {\n          data.node = li;\n          this.dataset[c.type].push(data);\n        }\n      }\n    }\n  },\n\n  /**\n   * Get data list\n   * @private\n   * @param {jQuery[]|HTMLElement} container the container element\n   * @returns {object|array} the subset of the dataset desired\n   */\n  getDataList(container) {\n    const s = this.settings;\n    const d = this.dataset;\n    container = this.isjQuery(container) ? container : $(container, this.element);\n\n    if (container.is(s.additionalClass)) {\n      return d.additional;\n    }\n    if (container.is(s.selectedClass)) {\n      return d.selected;\n    }\n    if (container.is(s.availableClass)) {\n      return d.available;\n    }\n    return [];\n  },\n\n  /**\n   * Move an array element position\n   * @private\n   * @param {array} arr target array to manipulate\n   * @param {number} from index to pull from\n   * @param {number} to index to move to\n   */\n  arrayIndexMove(arr, from, to) {\n    arr.splice(to, 0, arr.splice(from, 1)[0]);\n  },\n\n  /**\n   * Sync dataset\n   * @private\n   * @param {jQuery[]} owner element that currently contains the dataset\n   * @param {jQuery[]} droptarget element that will receive the dataset\n   */\n  syncDataset(owner, droptarget) {\n    const droptargetNodes = $('.listview li', droptarget);\n    const ownerAPI = owner.find('.listview').data('listview');\n    const dropTargetAPI = droptarget.find('.listview').data('listview');\n    const ownerDataList = this.getDataList(owner);\n    const dtDataList = this.getDataList(droptarget);\n    const isMoved = (mOwner, mItem) => {\n      if (mOwner && mItem) {\n        const id = { owner: mOwner.getAttribute('data-id'), item: mItem.getAttribute('data-id') };\n        return ((typeof id.owner !== 'undefined') && (typeof id.item !== 'undefined') && (id.owner === id.item));\n      }\n      return false;\n    };\n\n    for (let i = 0, l = this.selections.items.length; i < l; i++) {\n      const item = this.selections.items[i];\n      for (let dtIndex = 0, l2 = droptargetNodes.length; dtIndex < l2; dtIndex++) {\n        if ($(droptargetNodes[dtIndex]).is(item)) {\n          for (let ownerIndex = 0, l3 = ownerDataList.length; ownerIndex < l3; ownerIndex++) {\n            const ownerItem = ownerDataList[ownerIndex];\n            if (isMoved(ownerItem.node[0], item[0])) {\n              dtDataList.push(ownerItem);\n              ownerDataList.splice(ownerIndex, 1);\n              this.arrayIndexMove(dtDataList, dtDataList.length - 1, dtIndex);\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    ownerAPI.updated({ dataset: ownerDataList });\n    dropTargetAPI.updated({ dataset: dtDataList });\n    this.makeDraggable();\n  },\n\n  /**\n   * Check if a object is jQuery object\n   * @private\n   * @param {object} obj the object being checked\n   * @returns {boolean} whether or not the object is a jQuery selector\n   */\n  isjQuery(obj) {\n    return (obj && (obj instanceof jQuery || obj.constructor.prototype.jquery));\n  },\n\n  /**\n   * Update attributes\n   * @private\n   * @param {jQuery[]} list the target element to update\n   */\n  updateAttributes(list) {\n    const items = $('li', list);\n\n    for (let i = 0, l = items.length; i < l; i++) {\n      $(items[i]).attr({ 'aria-posinset': i + 1, 'aria-setsize': l });\n    }\n  },\n\n  /**\n   * After update\n   * @private\n   * @param {jQuery[]} list the target element to change after an update\n   */\n  afterUpdate(list) {\n    const focusIdx = this.selections.droptarget.find('li:focus').index();\n    const focusClass = `.card.${this.selections.droptarget[0].classList[1]} li`;\n\n    if (list) {\n      if (this.selections.placeholder) {\n        list.select(this.selections.placeholder);\n        this.selections.placeholder.focus();\n      }\n      this.unselectElements(list);\n      this.syncDataset(this.selections.owner, this.selections.droptarget);\n      this.updateAttributes($('.listview', this.selections.owner));\n      this.updateAttributes($('.listview', this.selections.droptarget));\n      if (this.selections.items.length) {\n        this.selections.move = $.extend(true, this.selections.move, {\n          to: this.getContainer(this.selections.itemsData)\n        });\n        /**\n        * Fires when any bucket has its content changed.\n        * @event swapupdate\n        * @memberof SwapList\n        * @type {object}\n        * @property {object} event - The jquery event object\n        * @property {array} items - List of items data\n        */\n        this.element.triggerHandler('swapupdate', [this.selections.move]);\n      }\n    }\n\n    this.selections.items.forEach((elem) => {\n      elem.show();\n    });\n\n    this.clearDropeffects();\n    this.clearSelections();\n    this.items.removeClass('is-dragging is-dragging-touch');\n\n    if (focusIdx >= 0) {\n      this.element.find(focusClass).eq(focusIdx).focus();\n    }\n  },\n\n  /**\n   * Get items from provided container\n   * @private\n   * @param {jQuery[]|HTMLElement} container the container being checked\n   * @returns {object|array} dataset\n   */\n  getItems(container) {\n    container = this.isjQuery(container) ? container : $(container, this.element);\n    return this.getDataList(container);\n  },\n\n  /**\n   * Get the current representative dataset with only the available elements in it.\n   * @returns {object|array} dataset\n   */\n  getAvailable() {\n    return this.getDataList(this.settings.availableClass);\n  },\n\n  /**\n   * Get the current representative dataset with only the selected elements in it.\n   * @returns {object|array} dataset\n   */\n  getSelected() {\n    return this.getDataList(this.settings.selectedClass);\n  },\n\n  /**\n   * Get the current representative dataset with only the additional elements in it.\n   * @returns {object|array} dataset\n   */\n  getAdditional() {\n    return this.getDataList(this.settings.additionalClass);\n  },\n\n  /**\n   * Make selected if dragged element was not selected\n   * @private\n   * @param {object} list the list to manipulate\n   * @param {jQuery[]} target the target to give a \"selected\" state\n   * @returns {boolean} whether or not an item was made selected\n   */\n  draggedMakeSelected(list, target) {\n    let isInSelection = false;\n    if (!this.selections.isInSelection) {\n      // Check if dragged element was selected or not\n      if (list.selectedItems) {\n        for (let i = 0, l = list.selectedItems.length; i < l; i++) {\n          if (target.is(list.selectedItems[i])) {\n            isInSelection = true;\n            return false;\n          }\n        }\n      }\n      if (!isInSelection) {\n        list.select(target); // Make selected\n        this.selections.isInSelection = true;\n      }\n    }\n    return true;\n  },\n\n  /**\n   * Updates the internal datasets and refresh the ui.\n   * @param {object} ds The updated dataset(s) of the form.\n   *  `{available: [], selected: [], additional: []}`\n   * @returns {void}\n   */\n  updateDataset(ds) {\n    const s = this.settings;\n    const containers = [\n      { type: 'available', dataset: ds.available, class: s.availableClass },\n      { type: 'selected', dataset: ds.selected, class: s.selectedClass },\n      { type: 'additional', dataset: ds.additional, class: s.additionalClass }\n    ];\n\n    for (let i = 0, l = containers.length; i < l; i++) {\n      const c = containers[i];\n      const lv = $(`${c.class} .listview`, this.element);\n      const api = lv.data('listview');\n\n      if (api) {\n        api.deselectItemsBetweenIndexes([0, $('li', lv).length - 1]);\n        s[c.type] = c.dataset || [];\n        api.loadData(s[c.type]);\n      }\n    }\n\n    this.initDataset();\n    this.makeDraggable();\n    this.initSelected(s.availableClass);\n    this.initSelected(s.additionalClass);\n  },\n\n  /**\n   * Removes event bindings from the swaplist instance.\n   * @private\n   * @returns {this} component instance\n   */\n  unbind() {\n    this.actionButtons.off('click.swaplist');\n    this.containers.off('keydown.swaplist', '.listview');\n    this.selectedButtons.off('keydown.swaplist');\n    this.element.off('keydown.swaplist', this.tabButtonsStr);\n    this.element.off(`${this.dragStart} ${this.dragEnterWhileDragging} ${this.dragOverWhileDragging} ${this.dragEnd}`, this.dragElements);\n\n    $('#sl-placeholder-container, #sl-placeholder-touch, #sl-placeholder-touch2, #sl-placeholder').remove();\n    return this;\n  },\n\n  /**\n   * Updates this instance of the swaplist component with new settings.\n   * @private\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, SWAPLIST_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroys this instance of the swaplist component and removes its link to its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  // Handle Events\n  handleEvents() {\n    const self = this;\n    const settings = self.settings;\n    const selections = self.selections;\n\n    // TOP BUTTONS =============================================================================\n    self.actionButtons.off('click.swaplist').on('click.swaplist', function () {\n      const actionButton = $(this);\n      const container = actionButton.closest('.card'); // Current list clicked from\n\n      let moveTo = null;\n\n      if (container.is(settings.availableClass)) { // Move from Available to Selected or Additional\n        if (settings.draggable.selected) {\n          moveTo = settings.selectedClass;\n        } else {\n          moveTo = self.isAdditional && settings.draggable.additional ?\n            settings.additionalClass : null;\n        }\n        self.moveElements(settings.availableClass, moveTo);\n      } else if (container.is(settings.additionalClass)) {\n        // Move from Additional to Selected or Available\n        if (settings.draggable.selected) {\n          moveTo = settings.selectedClass;\n        } else {\n          moveTo = settings.draggable.available ? settings.availableClass : null;\n        }\n        self.moveElements(settings.additionalClass, moveTo);\n      } else if (container.is(settings.selectedClass)) {\n        // Move from Selected\n        if (actionButton.is(settings.selectedBtnLeft)) { // to Available\n          self.moveElements(settings.selectedClass, settings.availableClass);\n        } else if (actionButton.is(settings.selectedBtnRight)) { // to Additional\n          self.moveElements(settings.selectedClass, settings.additionalClass);\n        }\n      }\n    });\n\n    // KEYSTROKE ===============================================================================\n    // Keydown event to implement selections\n    self.containers.on('keydown.swaplist', '.listview', function (e) {\n      const container = $(this).closest(self.containers);\n      e = e || window.event;\n      if (e.keyCode === 77 && self.hasModifier(e)) { // Modifier + M\n        if (!container.is(settings.selectedClass) ||\n          (container.is(settings.selectedClass) && self.selectedButtons.length === 1)) {\n          container.find(self.actionButtons).trigger('click.swaplist');\n        } else {\n          self.selectedButtons.first().focus();\n        }\n        e.preventDefault();\n      }\n    });\n\n    // Keydown event to handle selected container\n    self.selectedButtons.on('keydown.swaplist', function (e) {\n      const btn = $(this);\n      let index;\n      let move;\n      e = e || window.event;\n      if (e.keyCode === 13 || e.keyCode === 32) { // Enter or Space\n        btn.trigger('click.swaplist');\n        e.preventDefault();\n      }\n      // Left or Right arrow\n      if ((e.keyCode === 37 || e.keyCode === 39) && self.selectedButtons.length > 1) {\n        index = self.selectedButtons.index(this);\n        if (e.keyCode === 37) {\n          move = index > 0 ? index - 1 : self.selectedButtons.length - 1;\n        } else {\n          move = index < self.selectedButtons.length - 1 ? index + 1 : 0;\n        }\n        self.selectedButtons[move].focus();\n      }\n    });\n\n    self.element.on('keydown.swaplist', self.tabButtonsStr, function (e) {\n      const btn = $(this);\n      const keyCode = e.keyCode || e.which;\n\n      if (keyCode === 9 && !e.shiftKey) { // Tab key\n        const card = btn.closest('.card')[0];\n        const items = [].slice.call(card.querySelectorAll('li[tabindex]'));\n        const itemsLen = items.length;\n        let found = false;\n        if (itemsLen) {\n          items.forEach((item) => {\n            const tabindex = parseInt(item.getAttribute('tabindex'), 10);\n            if (tabindex !== -1) {\n              found = true;\n            }\n          });\n        }\n        if (!found) {\n          const item = card.querySelector('li');\n          if (item) {\n            item.setAttribute('tabindex', 0);\n          }\n        }\n      }\n    });\n\n    // SEARCHFIELD =============================================================================\n    self.containers.on('filtered.swaplist', '.listview', () => {\n      self.makeDraggable();\n    });\n\n    // DRAGGABLE ===============================================================================\n    self.element\n      .on('mousedown.swaplist', self.dragElements, (e) => {\n        if (self.handle) {\n          const target = $(e.target).closest('li');\n          target.attr({ draggable: $(e.target).is('.draggable') });\n        }\n        e.stopPropagation();\n      })\n      // Dragstart - initiate dragging\n      .on(self.dragStart, self.dragElements, (e) => {\n        e.stopImmediatePropagation();\n        if (self.handle && !selections.isHandle) {\n          e.stopPropagation();\n          return;\n        }\n        let rect;\n        let touch;\n        let placeholderContainer;\n        const target = $(e.target).closest('li');\n        const list = $('.listview', target.closest('.card')).data('listview');\n\n        // Not in draging area\n        if (!list) {\n          return;\n        }\n\n        if (!self.isTouch) {\n          self.draggedMakeSelected(list, target);\n        }\n\n        self.clearSelections(); // Clear selection before fill\n\n        selections.owner = target.closest('.card');\n        selections.dragged = target;\n        selections.draggedIndex = target.index();\n        selections.placeholder = target.clone(true);\n        selections.placeholder.attr('id', 'sl-placeholder');\n\n        self.setSelectionsItems(selections.owner);\n\n        selections.items = list.selectedItems;\n\n        self.selections.move = {\n          items: self.selections.itemsData,\n          from: self.getContainer(self.selections.itemsData)\n        };\n\n        /**\n          * Fires before moving an element allowing you to access the draggable item.\n          * @event beforeswap\n          * @memberof SwapList\n          * @type {object}\n          * @property {object} event - The jquery event object\n          * @property {array} items - List of selected items data\n          */\n        const result = self.element.triggerHandler('beforeswap', [self.selections.move]);\n        if ((typeof result === 'boolean' && !result) || (typeof result === 'string' && result.toLowerCase() === 'false')) {\n          selections.dragged = null;\n          return;\n        }\n\n        $(`.${settings.numOfSelectionsClass}`, settings.itemContentTempl).html(selections.items.length);\n        self.addDropeffects();\n\n        if (!self.isTouch) {\n          selections.dragged.addClass('is-dragging');\n          e.originalEvent.dataTransfer.setData('text', '');\n\n          if (selections.items.length > 1) {\n            $(`.${settings.itemContentClass}`, selections.dragged).html(settings.itemContentTempl.html());\n          }\n        } else {\n          rect = target[0].getBoundingClientRect();\n          touch = e.originalEvent.changedTouches[0];\n\n          // Save offset\n          self.offset = {\n            x: touch.pageX - rect.left,\n            y: touch.pageY - rect.top\n          };\n\n          for (let i = 0, l = self.containers.length; i < l; i++) {\n            self.containers[i].style.zIndex = '1';\n          }\n          selections.placeholderTouch = selections.dragged.clone(true);\n\n          if (selections.items.length > 1 && !$('#sl-placeholder-touch2').length) {\n            selections.dragged.clone()\n              .addClass('is-dragging-touch').attr('id', 'sl-placeholder-touch2')\n              .insertBefore(selections.dragged)\n              .hide();\n          }\n          selections.placeholderTouch.attr('id', 'sl-placeholder-touch').removeClass('is-selected').hide();\n\n          // Mobile view with three container(available, selected, additional) prepend to parent\n          placeholderContainer = (self.element.is('.one-third') && self.isMaxWidth(766)) ? self.element.parent() : self.element;\n          placeholderContainer.prepend('<ul id=\"sl-placeholder-container\"></ul>');\n\n          $('#sl-placeholder-container').append(selections.placeholderTouch);\n          $('#sl-placeholder-container')[0].style.width = `${selections.owner.width()}px`;\n          $('#sl-placeholder-touch')[0].style.width = `${selections.owner.width()}px`;\n\n          self.draggTouchElement(e, selections.placeholderTouch);\n        }\n        e.stopPropagation();\n      })\n\n    // Dragenter - set that related/droptarget\n      .on(self.dragEnterWhileDragging, self.dragElements, (e) => {\n        if (!selections.dragged) {\n          return;\n        }\n        self.element.triggerHandler('draggingswap', [selections.move]);\n        selections.related = e.target;\n        $('ul, li', self.element).removeClass('over');\n        $(e.target).closest('ul, li').addClass('over');\n        selections.droptarget = $(selections.related).closest('.card');\n        $('[aria-grabbed=\"true\"]', self.element).not(selections.dragged).slideUp();\n        e.stopPropagation();\n      })\n\n    // Dragover - allow the drag by preventing default, for touch set related/droptarget\n      .on(self.dragOverWhileDragging, self.dragElements, function (e) {\n        if (!selections.dragged) {\n          return;\n        }\n        let touch;\n        let overItem = $(this);\n        const list = $('.listview', selections.dragged.closest('.card')).data('listview');\n\n        if (self.isTouch) {\n          if (!!self.handle && !selections.isHandle) {\n            return;\n          }\n\n          if (!selections.isInSelection) {\n            self.draggedMakeSelected(list, selections.dragged);\n            selections.items = list.selectedItems;\n            $(`.${settings.numOfSelectionsClass}`, settings.itemContentTempl).html(selections.items.length);\n          }\n\n          touch = e.originalEvent.touches[0];\n          overItem = self.getElementByTouchInList($('ul, li', self.element), touch.pageX, touch.pageY) || overItem;\n\n          selections.dragged.addClass('is-dragging');\n          selections.placeholderTouch.addClass('is-dragging is-dragging-touch');\n          selections.placeholderTouch.show();\n\n          $('[aria-grabbed=\"true\"]', self.element)\n            .not(selections.dragged)\n            .not(selections.placeholderTouch)\n            .not('#sl-placeholder-touch2')\n            .slideUp();\n\n          if (selections.items.length > 1) {\n            $(`.${settings.itemContentClass}`, (selections.placeholderTouch.add('#sl-placeholder-touch2')))\n              .html(settings.itemContentTempl.html());\n\n            $('#sl-placeholder-touch2').show();\n            selections.dragged.hide();\n          }\n          self.draggTouchElement(e, selections.placeholderTouch);\n\n          self.element.triggerHandler('draggingswap', [selections.move]);\n          selections.related = overItem;\n          $('ul, li', this.element).removeClass('over');\n          overItem.closest('ul, li').addClass('over');\n          selections.droptarget = selections.related.closest('.card');\n        }\n        e.preventDefault();\n        e.stopPropagation();\n      })\n\n    // Dragend - implement items being validly dropped into targets\n      .on(self.dragEnd, self.dragElements, (e) => {\n        if (!selections.dragged) {\n          return;\n        }\n        const related = $(selections.related).closest('li');\n        const ul = $('ul', selections.droptarget);\n        const currentSize = $('li', ul).length;\n        const size = selections.items.length + currentSize;\n\n        self.unselectElements($('.listview', selections.owner).data('listview'));\n\n        $.each(selections.items, (index, val) => {\n          val = $(val);\n          val.find('mark.highlight').contents().unwrap();\n          if (currentSize && !$(selections.related).is('ul')) {\n            const isLess = (related.index() < selections.draggedIndex);\n            const el = isLess ? val : $(selections.items[(selections.items.length - 1) - index]);\n            const posinset = related.index() + (isLess ? index + 1 : index + 2);\n\n            val.attr({ 'aria-posinset': posinset, 'aria-setsize': size });\n            related[isLess ? 'before' : 'after'](el);\n          } else {\n            val.attr({ 'aria-posinset': currentSize + index + 1, 'aria-setsize': size });\n            ul.append(val);\n          }\n          val.focus();\n        });\n\n        if (selections.items.length > 1) {\n          $(`.${settings.itemContentClass}`, selections.dragged).html($(`.${settings.itemContentClass}`, selections.placeholder).html());\n          if (self.isTouch) {\n            selections.dragged.show();\n          }\n        }\n\n        if (self.isTouch) {\n          for (let i = 0, l = self.containers.length; i < l; i++) {\n            self.containers[i].style.zIndex = '';\n          }\n        }\n\n        self.makeDraggable();\n\n        selections.isHandle = null;\n        $('[aria-grabbed=\"true\"]', self.element).show();\n        self.afterUpdate($('.listview', selections.droptarget).data('listview'));\n        e.preventDefault();\n        e.stopPropagation();\n      });\n  } // END: Handle Events ---------------------------------------------------------------------\n\n};\n\nexport { SwapList, COMPONENT_NAME };\n","import { SwapList, COMPONENT_NAME } from './swaplist';\n\n/**\n * jQuery Component Wrapper for SwapList\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.swaplist = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new SwapList(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\n\n// Component Name\nconst COMPONENT_NAME = 'scrollaction';\n\n// Default ScrollAction Options\nconst SCROLLACTION_DEFAULTS = {\n  scrollActionTarget: '.js-scroll-target', // The element to add a class to based on scrolling logic\n  classToAdd: 'scrolled-down' // The class added to the target element\n};\n\n/**\n* A component that applies a class based on scroll direction\n* @class ScrollAction\n* @param {string} element The component element.\n* @param {object} [settings] The component settings.\n* @param {string} [scrollActionTarget='.js-scroll-target'] The selector of the element to add the class to.\n* @param {string} [classToAdd ='scrolled-down'] The class name to use when toggling.\n*/\nfunction ScrollAction(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, SCROLLACTION_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// ScrollAction Methods\nScrollAction.prototype = {\n\n  init() {\n    this.handleEvents();\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    const s = this.settings;\n    this.element.off('scroll.scrollaction');\n    if (s) {\n      $(s.scrollActionTarget).removeClass(s.classToAdd);\n    }\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, SCROLLACTION_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const s = this.settings;\n    this.lastScrollTop = 0;\n\n    this.element.on('scroll.scrollaction', () => {\n      const scrollTop = this.element.scrollTop();\n\n      if (scrollTop > this.lastScrollTop) {\n        $(s.scrollActionTarget).addClass(s.classToAdd);\n      } else {\n        $(s.scrollActionTarget).removeClass(s.classToAdd);\n      }\n\n      this.lastScrollTop = scrollTop;\n    });\n  }\n};\n\nexport { ScrollAction, COMPONENT_NAME };\n","import { ScrollAction, COMPONENT_NAME } from './scrollaction';\n\n/**\n * jQuery Component Wrapper for ScrollAction\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.scrollaction = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ScrollAction(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Component Name\nconst COMPONENT_NAME = 'stepchart';\n\n// Default component options\nconst DEFAULT_STEPCHART_OPTIONS = {\n  steps: null,\n  completed: null,\n  inProgress: null,\n  iconType: null,\n  completedText: null,\n  extraText: '',\n  completedColor: null,\n  allCompletedColor: null,\n  inProgressColor: null\n};\n\n/**\n * The Step Chart Component is displays visual info on step completion.\n * @class StepChart\n * @constructor\n * @param {jQuery[]|HTMLElement} element The base element\n * @param {object} [settings] incoming settings\n * @param {number} [settings.steps = null] The number of steps to show.\n * @param {number} [settings.completed = null] The number of steps complete (linear).\n * @param {number} [settings.inProgress = null] The number of the in progress step (linear).\n * @param {boolean} [settings.iconType = null] The icon to display fx. 'icon-error', 'icon-success'\n * @param {string} [settings.completedText = null] The completed text or uses a localized 'N of N Steps complete'.\n *  You can use {0} and {1} to replace n of n in the string.\n * @param {boolean} [settings.extraText = ''] The additional text to show on the right. Defaults to none. You\n *  can use {0} to replace with the steps remaining count and {1} to replace the number of steps.\n * @param {string} [settings.completedColor = null] The color to show completed steps. Defaults to primary color.\n * @param {string} [settings.allCompletedColor = null] The color to steps when all are completed. Defaults to primary color.\n * @param {string} i[settings.nProgressColor The color to show in-progress steps. Defaults to ruby02.\n */\nfunction StepChart(element, settings) {\n  return this.init(element, settings);\n}\n\nStepChart.prototype = {\n\n  /**\n   * Initialize and render the chart\n   * @private\n   * @param {jQuery[]|HTMLElement} element The base element\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  init(element, settings) {\n    if (!this.element && element instanceof HTMLElement) {\n      this.element = $(element);\n    }\n\n    if (typeof settings === 'object' || this.settings === undefined) {\n      const previousSettings = this.settings || DEFAULT_STEPCHART_OPTIONS;\n      this.settings = utils.mergeSettings(this.element[0], settings, previousSettings);\n    }\n\n    return this.render();\n  },\n\n  /**\n   * Initialize and render the from the options\n   * @private\n   * @returns {this} component instance\n   */\n  render() {\n    const container = $('<div class=\"step-chart-steps\"></div>');\n    const icon = `\n      <svg class=\"icon {icon-name}\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n        <use xlink:href=\"#icon-success\"></use>\n      </svg>\n    `;\n\n    const isEmpty = this.settings.completed === null && this.settings.steps === null;\n    if (isEmpty) {\n      this.settings.completed = 0;\n      this.settings.steps = 1;\n    }\n\n    if (this.element.attr('data-options')) {\n      this.settings = utils.parseSettings(this.element);\n    }\n\n    if (this.element.children().length > 0) {\n      return this;\n    }\n\n    for (let i = 0; i < this.settings.steps; i++) {\n      const step = $('<div class=\"step-chart-step\"></div>');\n\n      // Set up ticks\n      if (i < this.settings.completed) {\n        step.addClass('is-complete');\n\n        if (this.settings.completedColor) {\n          step.css('background-color', this.settings.completedColor);\n        }\n      }\n\n      if (i === this.settings.inProgress - 1) {\n        step.addClass('is-inprogress');\n\n        if (this.settings.inProgressColor) {\n          step.css('background-color', this.settings.inProgressColor);\n        }\n      }\n\n      container.append(step);\n    }\n\n    // Set up labels and alerts\n    let completedText = this.settings.completedText || Locale.translate('StepsCompleted');\n    completedText = completedText.replace('{0}', this.settings.completed);\n    completedText = completedText.replace('{1}', this.settings.steps);\n\n    if (isEmpty) {\n      completedText = Locale ? Locale.translate('NoData') : 'No Data Available';\n    }\n    const label = $(`<span class=\"step-chart-label\">${completedText}</span>`);\n\n    if (this.settings.steps === this.settings.completed) {\n      container.addClass('is-complete');\n      label.append(icon.replace('{icon-name}', 'icon-success'));\n    }\n\n    if (this.settings.iconType) {\n      label.append(icon.replace('{icon-name}', this.settings.iconType));\n    }\n\n    if (this.settings.extraText) {\n      let extraText = this.settings.extraText;\n      extraText = (extraText === '{0} Days Remaining' ? Locale.translate('DaysRemaining') : extraText);\n      extraText = (extraText === '{1} Days Overdue' ? Locale.translate('DaysOverdue') : extraText);\n      extraText = extraText.replace('{0}', this.settings.steps - this.settings.completed);\n      extraText = extraText.replace('{1}', this.settings.completed);\n      label.append(`<span class=\"step-chart-label-small\">${extraText}</span>`);\n    }\n\n    this.element.append(label, container);\n\n    // Adjust completed color\n    if (this.settings.steps === this.settings.completed && this.settings.allCompletedColor) {\n      container.find('.step-chart-step').css('background-color', this.settings.allCompletedColor);\n      label.find('.icon').attr('style', `fill: ${this.settings.allCompletedColor}!important`);\n    }\n\n    return this;\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    this.element.empty();\n\n    return this.render();\n  },\n\n  /**\n   * Tear down and remove.\n   * @returns {this} component instance\n   */\n  destroy() {\n    this.element.empty();\n    this.settings = null;\n    $.removeData(this.element[0], COMPONENT_NAME);\n\n    return this;\n  }\n};\n\nexport { StepChart, COMPONENT_NAME };\n","import { StepChart, COMPONENT_NAME } from './stepchart';\n\n/**\n * jQuery Component Wrapper for StepChart\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.stepchart = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new StepChart(this, settings));\n      instance.destroy = function destroy() {\n        this.teardown();\n        $.removeData(this, COMPONENT_NAME);\n      };\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils, math } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\nimport { xssUtils } from '../../utils/xss';\nimport { DOM } from '../../utils/dom';\nimport { breakpoints } from '../../utils/breakpoints';\nimport { stringUtils } from '../../utils/string';\nimport { renderLoop, RenderLoopItem } from '../../utils/renderloop';\nimport { Locale } from '../locale/locale';\n\n// jQuery components\nimport '../../utils/lifecycle';\nimport '../icons/icons.jquery';\nimport '../popupmenu/popupmenu.jquery';\nimport '../tooltip/tooltip.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'tabs';\n\n// Types of possible Tab containers\nconst tabContainerTypes = ['horizontal', 'vertical', 'module-tabs', 'header-tabs'];\n\n/**\n * @class Tabs\n * @constructor\n * @param {HTMLElement|jQuery[]} element the base element for this component\n * @param {object} settings incoming settings\n *\n * @param {boolean} [settings.addTabButton=false] If set to true, creates a button at the end\n * of the tab list that can be used to add an empty tab and panel\n * @param {function} [settings.addTabButtonCallback=null] if defined as a function, will\n * be used in-place of the default Tab Adding method\n * @param {boolean} [settings.appMenuTrigger=false] If set to true, will force an App Menu\n * trigger to be present on Non-Vertical Tabs implementatations.\n * @param {string} [settings.appMenuTriggerText] If defined, replaces the default \"Menu\" text used\n * in the app menu trigger.\n * @param {object} [settings.ajaxOptions] if defined, will be used by any internal\n * Tabs AJAX calls as the desired request settings.\n * @param {function} [settings.beforeActivate] If defined as a function, fires\n * this before a tab is activated to allow a possible \"veto\" of the tab swap (SOHO-5250).\n * @param {string|jQuery} [settings.containerElement=null] Defines a separate element\n * to be used for containing the tab panels.  Defaults to a `.tab-panel-container`\n * element that is created if it doesn't already exist.\n * @param {boolean} [settings.changeTabOnHashChange=false] If true, will change the selected\n * tab on invocation based on the URL that exists after the hash.\n * @param {function} [settings.hashChangeCallback=null] If defined as a function,\n * provides an external method for adjusting the current page hash used by these tabs.\n * @param {boolean} [settings.lazyLoad=true] if true, when using full URLs in tab HREFs,\n * or when using Ajax calls, tabs will be loaded as needed instead of the markup\n * all being established at once.\n * @param {boolean} [settings.moduleTabsTooltips=false] if true, will display a tooltip on\n * Module Tabs with cut-off text content.\n * @param {function} [settings.source=null] If defined, will serve as a way of pulling\n * in external content to fill tabs.\n * @param {object} [settings.sourceArguments={}] If a source method is defined, this\n * flexible object can be passed into the source method, and augmented with\n * parameters specific to the implementation.\n * @param {boolean} [settings.tabCounts=false] If true, Displays a modifiable count above each tab.\n * @param {boolean} [settings.verticalResponsive=false] If Vertical Tabs & true, will automatically\n * switch to Horizontal Tabs on smaller breakpoints.\n */\nconst TABS_DEFAULTS = {\n  addTabButton: false,\n  addTabButtonCallback: null,\n  appMenuTrigger: false,\n  appMenuTriggerText: undefined,\n  ajaxOptions: null,\n  beforeActivate: undefined,\n  containerElement: null,\n  changeTabOnHashChange: false,\n  hashChangeCallback: null,\n  lazyLoad: true,\n  moduleTabsTooltips: false,\n  source: null,\n  sourceArguments: {},\n  tabCounts: false,\n  verticalResponsive: false\n};\n\nfunction Tabs(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, TABS_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nTabs.prototype = {\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  init() {\n    return this\n      .setup()\n      .build()\n      .setupEvents();\n  },\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  setup() {\n    // Used by the $(body).resize event to correctly identify the tabs container element\n    this.tabsIndex = $('.tab-container').index(this.element);\n    return this;\n  },\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  build() {\n    const self = this;\n    let tabPanelContainer;\n    let moveTabPanelContainer = false;\n\n    // Check for a tab panel container immediately after the `.tab-container`\n    // element (default as of IDS Enterprise 4.3.0)\n    tabPanelContainer = this.element.next('.tab-panel-container');\n\n    // Auto-detect and move existing tab-panel containers in key areas, if applicable.\n    // Check inside the container first\n    if (!tabPanelContainer.length) {\n      tabPanelContainer = this.element.children('.tab-panel-container');\n\n      if (!this.isVerticalTabs()) {\n        moveTabPanelContainer = true;\n      }\n    }\n\n    // Special case for Header Tabs, find the page container and use that as the container\n    const bodyPageContainer = $('body > .page-container, .application-menu + .page-container');\n    if (this.element.closest('.header').length > 0 && bodyPageContainer.length) {\n      tabPanelContainer = bodyPageContainer;\n    }\n\n    // Special case for Module Tabs, where it's possible for layout reasons for there to be\n    // an application menu element adjacent between the Tab list and the Tab Panel container\n    if (this.element.next('.application-menu').length) {\n      tabPanelContainer = this.element.next().next('.page-container');\n      moveTabPanelContainer = false;\n    }\n\n    // Defining `this.settings.containerElement` ultimately overrides any internal\n    // changes to the tab panel container.\n    if (this.settings.containerElement && $(this.settings.containerElement).length) {\n      tabPanelContainer = $(this.settings.containerElement);\n      moveTabPanelContainer = false;\n    }\n\n    // If a `.tab-panel-container` still doesn't exist, create one.\n    if (!tabPanelContainer || !tabPanelContainer.length) {\n      tabPanelContainer = $('<div class=\"tab-panel-container\"></div>');\n      moveTabPanelContainer = true;\n    }\n\n    if (!tabPanelContainer[0].classList.contains('tab-panel-container')) {\n      tabPanelContainer[0].classList.add('tab-panel-container');\n    }\n    if (moveTabPanelContainer) {\n      tabPanelContainer.insertAfter(this.element);\n    }\n\n    this.container = tabPanelContainer;\n\n    // Detect the existence of a \"tab-list-container\" element, if applicable.\n    // Tab List containers are optional for all tab container types, but mandatory for\n    // Composite Form tabs.\n    let tablistContainer = this.element.children('.tab-list-container');\n    if (!tablistContainer.length && this.isScrollableTabs()) {\n      tablistContainer = $('<div class=\"tab-list-container\"></div>').prependTo(this.element);\n    }\n    if (tablistContainer.length) {\n      this.tablistContainer = tablistContainer;\n    }\n\n    // Add a default tabs class of \"horizontal\" if it doesn't already exist\n    let noClass = true;\n    const closestHeader = this.element.closest('.header');\n    tabContainerTypes.forEach((val, i) => {\n      if (this.element.hasClass(tabContainerTypes[i])) {\n        noClass = false;\n      }\n    });\n    if (noClass) {\n      if (closestHeader.length) {\n        self.element.addClass('header-tabs');\n      } else {\n        self.element.addClass('horizontal');\n      }\n    }\n\n    // Build Tab Counts\n    if (self.settings.tabCounts) {\n      self.element.addClass('has-counts');\n    }\n\n    // Attach Tablist role and class to the tab headers container\n    this.tablist = this.element.children('.tab-list');\n    if (!this.tablist.length) {\n      // If we have a `.tab-list-container` element, check that before creating markup\n      if (this.tablistContainer) {\n        this.tablist = this.tablistContainer.children('.tab-list');\n      }\n\n      // Create and append the `.tab-list` if it still doesn't exist.\n      if (!this.tablist.length) {\n        this.tablist = $('<ul class=\"tab-list\"></ul>');\n        if (this.tablistContainer) {\n          this.tablist.appendTo(this.tablistContainer);\n        } else {\n          this.tablist.appendTo(this.element);\n        }\n      }\n    }\n\n    // Double-check that the `.tab-list-container` actually contains the `.tab-list`.\n    // Move it if necessary.\n    if (this.tablistContainer) {\n      if (!this.tablist.parent().is(this.tablistContainer)) {\n        this.tablistContainer.append(this.tablist);\n      }\n\n      this.tablistContainer.on('mousewheel.tabs', function (e) {\n        if (e.deltaY) {\n          this.scrollLeft += e.deltaY;\n        }\n      });\n    }\n\n    self.tablist\n      .attr({\n        class: 'tab-list',\n        role: 'tablist',\n        'aria-multiselectable': 'false'\n      });\n\n    // Conditionally Change layout classes if veritcal tabs is in responsive\n    // mode, and breakpoints match.\n    this.checkResponsive(false);\n\n    // Handle Focus State, Animated Bar, More Button, Add Tabs Button, and\n    // App Menu Button.\n    this.renderHelperMarkup();\n\n    // for each item in the tabsList...\n    self.anchors = self.tablist.children('li:not(.separator)').children('a');\n    self.anchors.each(function prepareAnchor() {\n      const a = $(this);\n      a.attr({ role: 'tab', 'aria-expanded': 'false', 'aria-selected': 'false', tabindex: '-1' })\n        .parent().attr('role', 'presentation').addClass('tab');\n\n      if (a.parent().hasClass('dismissible') && !a.parent().children('.icon').length) {\n        $.createIconElement({ icon: 'close', classes: 'icon close' }).insertAfter(a);\n      }\n\n      // Find and configure dropdown tabs\n      const dd = a.nextAll('ul').first();\n      if (dd.length > 0) {\n        dd.addClass('dropdown-tab');\n        const li = a.parent();\n\n        li.addClass('has-popupmenu').popupmenu({\n          menu: dd,\n          trigger: 'click',\n          attachToBody: true\n        });\n\n        a.removeAttr('role').removeAttr('aria-expanded').removeAttr('aria-selected');\n\n        if (!a.parent().children('.icon.icon-more').length) {\n          $.createIconElement({ classes: 'icon-more', icon: 'dropdown' }).insertAfter(a);\n        }\n      }\n\n      if (self.settings.tabCounts && $(this).find('.count').length === 0) {\n        $(this).prepend('<span class=\"count\">0 </span>');\n      }\n\n      // Make it possible for Module Tabs to display a tooltip containing their contents\n      // if the contents are cut off by ellipsis.\n      if (self.settings.moduleTabsTooltips) {\n        a.on('beforeshow.toolbar', () => a.data('cutoffTitle') === 'yes').tooltip({\n          content: `${a.text().trim()}`\n        });\n      }\n    });\n\n    // Build/manage tab panels\n    function associateAnchorWithPanel() {\n      const a = $(this);\n      const li = a.parent();\n      const popup = li.data('popupmenu');\n      let panel;\n\n      // Associated the current one\n      let href = a.attr('href');\n\n      if (href.substr(0, 1) !== '#') {\n        // is an outbound Link\n        return;\n      }\n\n      if (href.substr(0, 2) === '#/') {\n        // uses angular LocationStrategy\n        // Just to find the panel but these are handled by angular\n        href = href.replace('#/', '#');\n      }\n\n      if (href !== undefined && href !== '#') {\n        panel = $(href);\n\n        if (li.is(':not(.has-popupmenu)') && !panel.length) {\n          return;\n        }\n\n        a.data('panel-link', panel);\n        panel.data('tab-link', a);\n        self.panels = self.panels.add(panel);\n      }\n\n      // If dropdown tab, add the contents of the dropdown\n      // NOTE: popupmenu items that represent dropdown tabs shouldn't have children,\n      // so they aren't accounted for here.\n      if (popup) {\n        popup.menu.children('li').each(function () {\n          const popupLi = $(this);\n          const popupA = popupLi.children('a');\n          const popupHref = popupA.attr('href');\n          const popupPanel = $(popupHref);\n\n          popupA.data('panel-link', popupPanel);\n          popupPanel.data('tab-link', popupA);\n\n          self.panels = self.panels.add(popupPanel);\n          self.anchors = self.anchors.add(popupA);\n\n          if (!popupLi.hasClass('dismissible')) {\n            return;\n          }\n\n          let popupIcon = popupLi.children('.icon');\n          if (!popupIcon.length) {\n            popupIcon = $.createIconElement({ icon: 'close', classes: 'icon close' });\n          }\n          popupIcon.detach().appendTo(popupA);\n        }).on('click.popupmenu', '.icon', function iconClickHandler(e) {\n          const popupIcon = $(this);\n          const popupLi = popupIcon.closest('li');\n\n          if (popupLi.is('.dismissible') && popupIcon.is('.icon')) {\n            e.preventDefault();\n            e.stopPropagation();\n            self.closeDismissibleTab(popupLi.children('a').attr('href'));\n          }\n        });\n      }\n    }\n\n    self.panels = $();\n    self.anchors.each(associateAnchorWithPanel);\n    self.panels\n      .addClass('tab-panel')\n      .attr({ role: 'tabpanel' })\n      .find('h3:first').attr('tabindex', '0');\n\n    self.panels.appendTo(self.container);\n\n    const excludes = ':not(.separator):not(.is-disabled):not(.is-hidden)';\n    const tabs = this.tablist.children(`li${excludes}`);\n    let selected = this.tablist.children(`li.is-selected${excludes}`);\n    let selectedAnchor = selected.children('a');\n    let hash;\n    let matchingTabs;\n\n    // Setup a hash for nested tab controls\n    self.nestedTabControls = self.panels.find('.tab-container');\n\n    if (tabs.length) {\n      // If the hashChange setting is on, change the selected tab to the one referenced by the hash\n      if (this.settings.changeTabOnHashChange) {\n        hash = window.location.hash;\n        if (hash && hash.length) {\n          matchingTabs = tabs.find(`a[href=\"${hash}\"]`);\n          if (matchingTabs.length) {\n            selected = matchingTabs.first().parent();\n            selectedAnchor = selected.children('a');\n          }\n        }\n      }\n\n      // If there is no selected tab, try to find the first available tab (if there are any present)\n      if (!selected.length) {\n        selected = tabs.not('.add-tab-button, .application-menu-trigger').first();\n        selectedAnchor = selected.children('a');\n      }\n\n      // If there are tabs present, activate the first one\n      if (selected.length) {\n        this.activate(selectedAnchor.attr('href'), selectedAnchor);\n      }\n    }\n\n    if (this.isModuleTabs() && this.element.children('.toolbar').length) {\n      this.element.addClass('has-toolbar');\n    }\n\n    this.setOverflow();\n\n    this.positionFocusState(selectedAnchor);\n\n    if (this.hasAnimatedBar()) {\n      this.animatedBar.addClass('no-transition');\n      this.focusBar(undefined, () => {\n        setTimeout(() => {\n          this.animatedBar.removeClass('no-transition');\n        }, 0);\n      });\n    }\n\n    // Setup Edge Fades\n    if (this.tablistContainer) {\n      this.tablistContainer.on('scroll.tabs', () => {\n        this.renderEdgeFading();\n      });\n      this.renderEdgeFading();\n    }\n\n    return this;\n  },\n\n  /**\n   * Adds/removes helper buttons and accessibility-centric markup, based on Tabs' configuration\n   * Designed to be run at any point in the Tabs lifecycle.\n   * @private\n   * @returns {this} component instance\n   */\n  renderHelperMarkup() {\n    let auxilaryButtonLocation = this.tablistContainer || this.tablist;\n    if (this.isModuleTabs()) {\n      auxilaryButtonLocation = this.tablist;\n    }\n\n    this.focusState = this.element.find('.tab-focus-indicator');\n    if (!this.focusState.length) {\n      this.focusState = $('<div class=\"tab-focus-indicator\" role=\"presentation\"></div>').insertBefore(this.tablist);\n    }\n\n    // Animated Bar\n    if (this.hasAnimatedBar()) {\n      this.animatedBar = this.element.find('.animated-bar');\n      if (!this.animatedBar.length) {\n        this.animatedBar = $('<div class=\"animated-bar\" role=\"presentation\"></div>');\n      }\n      this.animatedBar.insertBefore(this.tablist);\n    } else if (this.animatedBar && this.animatedBar.length) {\n      this.animatedBar.off().remove();\n      this.animatedBar = undefined;\n    }\n\n    // Add the markup for the \"More\" button if it doesn't exist.\n    if (!this.moreButton) {\n      this.moreButton = $();\n    }\n\n    if (!this.isVerticalTabs()) {\n      if (!this.moreButton.length) {\n        this.moreButton = auxilaryButtonLocation.next('.tab-more');\n      }\n      // If we still don't have a More Button, create one\n      if (!this.moreButton.length) {\n        this.moreButton = $('<div>').attr({ class: 'tab-more' });\n        this.moreButton.append($('<span class=\"more-text\">').text(Locale.translate('More')));\n        this.moreButton.append($.createIconElement({ classes: 'icon-more', icon: 'dropdown' }));\n      }\n\n      // Append in the right place based on configuration\n      auxilaryButtonLocation.after(this.moreButton);\n    } else if (this.moreButton.length) {\n      this.moreButton.off().remove();\n      this.moreButton = $();\n    }\n\n    // Add the application menu Module Tab, if applicable\n    let appMenuTrigger = this.tablist.find('.application-menu-trigger');\n    if (this.settings.appMenuTrigger === true) {\n      // Backwards Compatibility for the original Application Menu codepath.\n      if (this.isModuleTabs()) {\n        if (!appMenuTrigger.length) {\n          appMenuTrigger = $(`\n            <li class=\"tab application-menu-trigger\">\n              <a href=\"#\">\n                <span class=\"icon app-header\">\n                  <span class=\"one\"></span>\n                  <span class=\"two\"></span>\n                  <span class=\"three\"></span>\n                </span>\n                <span>${this.settings.appMenuTriggerText || Locale.translate('AppMenuTriggerText')}</span>\n              </a>\n            </li>\n          `);\n          this.tablist.prepend(appMenuTrigger);\n        }\n      } else if (this.isVerticalTabs() && appMenuTrigger.length) {\n        appMenuTrigger.off().remove();\n      }\n    } else if (appMenuTrigger.length) {\n      if (this.isVerticalTabs()) {\n        appMenuTrigger.off().remove();\n      } else {\n        this.tablist.prepend(appMenuTrigger);\n      }\n    }\n\n    // Add Tab Button\n    if (this.settings.addTabButton) {\n      if (!this.addTabButton || !this.addTabButton.length) {\n        this.addTabButton = $(`\n          <div class=\"add-tab-button\" tabindex=\"0\" role=\"button\">\n            <span aria-hidden=\"true\" role=\"presentation\">+</span>\n            <span class=\"audible\">${Locale.translate('AddNewTab')}</span>\n          </div>\n        `);\n        this.addTabButton.insertAfter(this.moreButton);\n        this.element.addClass('has-add-button');\n      }\n    } else if (this.addTabButton && this.addTabButton.length) {\n      this.addTabButton.remove();\n      this.addTabButton = undefined;\n      this.element.removeClass('has-add-button');\n    }\n\n    return this;\n  },\n\n  /**\n   * Establishes the bound event listeners on all tabs elements\n   * @private\n   * @returns {this} component instance\n   */\n  setupEvents() {\n    const self = this;\n\n    // Set animation bar if tabs under modal\n    const modal = self.element.closest('.modal');\n    if (modal.length) {\n      modal.on('afteropen', () => {\n        if (self.hasAnimatedBar()) {\n          self.focusBar();\n        }\n      });\n    }\n\n    // Clicking the 'a' triggers the click on the 'li'\n    function routeAnchorClick(e) {\n      const a = $(e.currentTarget);\n\n      if (this.wasTapped === true) {\n        this.wasTapped = false;\n        return;\n      }\n\n      if (e.type === 'touchend') {\n        this.wasTapped = true;\n      }\n\n      if (a.attr('href').substr(0, 1) !== '#') {\n        // is an outbound Link\n        return;\n      }\n      e.preventDefault();\n    }\n\n    // Some tabs have icons that can be clicked and manipulated\n    function handleIconClick(e) {\n      const elem = $(this);\n      if (elem.is('[disabled]') || elem.parent().hasClass('is-disabled')) {\n        return;\n      }\n\n      const li = $(elem).parent();\n\n      if (li.hasClass('dismissible')) {\n        e.preventDefault();\n        e.stopPropagation();\n        self.closeDismissibleTab(li.children('a').attr('href'));\n      }\n    }\n\n    function handleTabBlur() {\n      $(this).parent().removeClass('is-focused');\n    }\n\n    // Any events bound to individual tabs (li) and their anchors (a) are bound\n    // to the tablist element so that tabs can be added/removed/hidden/shown without\n    // needing to change event bindings.\n    this.tablist\n      .on('mousedown.tabs', '> li', function (e) {\n        self.handleAddFocusData(e, $(this));\n\n        if ($(e.target).hasClass('close') && $(e.target).parent().hasClass('has-popupmenu')) {\n          const menu = $(this).data('popupmenu').menu;\n          const hrefs = [];\n          $.each(menu[0].children, (i, li) => {\n            hrefs.push(li.children[0].href);\n          });\n          self.closeDismissibleTabs(hrefs);\n        }\n\n        // let right click pass through\n        if (e.which !== 3) {\n          return self.handleTabClick(e, $(this));\n        }\n        return false;\n      })\n      .on('click.tabs', 'a', routeAnchorClick)\n      .on('click.tabs', '.icon', handleIconClick)\n      .on('focus.tabs', 'a', function (e) {\n        return self.handleTabFocus(e, $(this));\n      })\n      .on('blur.tabs', 'a', handleTabBlur)\n      .on('keydown.tabs', 'a', e => this.handleTabKeyDown(e));\n\n    // Setup events on Dropdown Tabs\n    function dropdownTabEvents(i, tab) {\n      const li = $(tab);\n      const a = li.children('a');\n      const menu = li.data('popupmenu').menu;\n\n      // Alt+Del or Alt+Backspace closes a dropdown tab item\n      function closeDropdownMenuItem(e) {\n        if (!e.altKey || !li.is('.dismissible')) {\n          return;\n        }\n\n        self.closeDismissibleTab(a.attr('href'));\n      }\n\n      menu.on('keydown.popupmenu', 'a', (e) => {\n        switch (e.which) {\n          case 27: // escape\n            li.addClass('is-selected');\n            a.focus();\n            break;\n          case 8: // backspace (delete on Mac)\n            closeDropdownMenuItem(e);\n            break;\n          case 46: // The actual delete key\n            closeDropdownMenuItem(e);\n            break;\n          default:\n            break;\n        }\n      });\n\n      li.on('selected.tabs', function (e, anchor) {\n        const popupLi = $(this);\n        const href = $(anchor).attr('href');\n\n        if (!self.activate(href, $(anchor))) {\n          return false;\n        }\n\n        self.positionFocusState(a);\n\n        if (self.hasAnimatedBar()) {\n          self.focusBar(popupLi);\n        }\n\n        a.focus();\n        self.scrollTabList(popupLi);\n\n        popupLi.addClass('is-selected');\n        return false;\n      });\n    }\n\n    const ddTabs = self.tablist.find('li').filter('.has-popupmenu');\n    ddTabs.each(dropdownTabEvents);\n\n    function dismissibleTabEvents(i, tab) {\n      const li = $(tab);\n      const a = li.children('a');\n\n      a.on('keydown.tabs', (e) => {\n        self.handleDismissibleTabKeydown(e);\n      });\n    }\n\n    const dismissible = self.tablist.find('li').filter('.dismissible');\n    dismissible.each(dismissibleTabEvents);\n\n    this.setupHelperMarkupEvents();\n\n    this.panels.on('keydown.tabs', (e) => {\n      self.handlePanelKeydown(e);\n    });\n\n    // Check whether or not all of the tabs + more button are de-focused.\n    // If true, the focus-state and animated bar need to revert positions\n    // back to the currently selected tab.\n    this.element.on('focusout.tabs', () => {\n      const noFocusedTabs = !$.contains(self.element[0], document.activeElement);\n      const noPopupMenusOpen = self.tablist.children('.has-popupmenu.is-open').length === 0;\n\n      if (noFocusedTabs && noPopupMenusOpen && !self.moreButton.is('.is-selected, .popup-is-open')) {\n        self.hideFocusState();\n      }\n    }).on('updated.tabs', (e, settings) => {\n      self.updated(settings);\n    }).on('activated.tabs', (e) => {\n      // Stop propagation of the activate event from going higher up into the DOM tree\n      e.stopPropagation();\n    }).on('add.tabs', (e, newTabId, newTabOptions, newTabIndex) => {\n      self.add(newTabId, newTabOptions, newTabIndex);\n    })\n      .on('remove.tabs', (e, tabId) => {\n        self.remove(tabId);\n      });\n\n    // Check to see if we need to add/remove the more button on resize\n    $('body').on(`resize.tabs${this.tabsIndex}`, () => {\n      self.handleResize();\n    });\n    self.handleResize(true);\n\n    // Resize the tab to show the error\n    $('.tab-panel input').on('error.tabs, valid.tabs', () => {\n      const currentLi = $('.tab.is-selected');\n      self.focusBar(currentLi);\n    });\n\n    return this;\n  },\n\n  /**\n   * Adds events associated with elements that are re-renderable during the Tabs lifecycle\n   * @private\n   */\n  setupHelperMarkupEvents() {\n    const self = this;\n\n    // Setup the \"more\" function\n    this.moreButton\n      .on('click.tabs', (e) => {\n        self.handleMoreButtonClick(e);\n      })\n      .on('keydown.tabs', (e) => {\n        self.handleMoreButtonKeydown(e);\n      })\n      .on('focus.tabs', (e) => {\n        self.handleMoreButtonFocus(e);\n      })\n      .on('mousedown.tabs', function (e) {\n        self.handleAddFocusData(e, $(this));\n      });\n\n    if (this.settings.addTabButton) {\n      this.addTabButton\n        .on('click.tabs', () => {\n          self.handleAddButton();\n        })\n        .on('keydown.tabs', (e) => {\n          self.handleAddButtonKeydown(e);\n        })\n        .on('focus.tabs', (e) => {\n          self.handleAddButtonFocus(e);\n        });\n    }\n  },\n\n  /**\n   * Removes events associated with elements that are re-renderable during the Tabs lifecycle\n   * @private\n   * @returns {this} component instance\n   */\n  removeHelperMarkupEvents() {\n    if (this.moreButton && this.moreButton.length) {\n      this.moreButton\n        .off('click.tabs keydown.tabs focus.tabs mousedown.tabs');\n    }\n\n    if (this.addTabButton && this.addTabButton.length) {\n      this.addTabButton\n        .off('click.tabs keydown.tabs focus.tabs');\n    }\n\n    return this;\n  },\n\n  /**\n   * Setup a mousedown event on tabs to determine in the focus handler whether\n   * or a not a keystroked cause a change in focus, or a click.  Keystroke focus\n   * changes cause different visual situations\n   * @private\n   * @param {$.Event} e incoming focus event\n   * @param {jQuery[]} elem element\n   * @returns {undefined}\n   */\n  handleAddFocusData(e, elem) {\n    let tab = elem;\n    if (tab.is('.is-disabled')) {\n      e.preventDefault();\n      return false;\n    }\n\n    if (!tab.is(this.moreButton)) {\n      tab = tab.children('a');\n    }\n\n    this.hideFocusState();\n    tab.data('focused-by-click', true);\n    return true;\n  },\n\n  /**\n   * Handler for Tab Click\n   * @private\n   * @param {jQuery.Event} e incoming click event\n   * @param {jQuery[]} li list item representing the clicked tab\n   * @returns {boolean|undefined} ? // TODO: why?\n   */\n  handleTabClick(e, li) {\n    if (this.element.is('.is-disabled') || (li && (li.is('.is-disabled') || li.is('.separator')))) {\n      e.stopPropagation();\n      e.preventDefault();\n      return false;\n    }\n\n    const appMenuResult = this.handleAppMenuTabKeydown(e);\n    if (!appMenuResult) {\n      return true;\n    }\n\n    let a = li.children('a');\n    a.data('focused-by-click', true);\n\n    if (this.popupmenu && this.popupmenu.element.hasClass('is-open')) {\n      this.popupmenu.close();\n    }\n\n    // Don't activate a dropdown tab.  Clicking triggers the Popupmenu Control attached.\n    if (li.is('.has-popupmenu')) {\n      this.positionFocusState(a);\n      return true;\n    }\n\n    let href = a.attr('href');\n\n    if (li.is('.add-tab-button')) {\n      a = this.handleAddButton();\n      li = a.parent();\n      href = a.attr('href');\n      this.element.trigger('tab-added', [a]);\n    }\n\n    // close tab on middle click\n    if (e.which === 2) {\n      if (li.is('.dismissible') && $(e.target).is('.close')) {\n        this.closeDismissibleTab(href);\n      }\n      e.preventDefault();\n      return true;\n    }\n\n    if (!this.activate(href, a)) {\n      return true;\n    }\n    this.changeHash(href);\n\n    this.focusState.removeClass('is-visible');\n\n    a.focus();\n\n    if (this.isScrollableTabs()) {\n      this.scrollTabList(li);\n    }\n\n    // Hide these states\n    this.focusBar(li);\n    this.positionFocusState(a);\n\n    if (this.settings.lazyLoad === true && this.isURL(href)) {\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * Handler for click events on the \"More Tabs\" popupmenu trigger\n   * @private\n   * @param {jQuery.event} e Event\n   * @returns {boolean|undefined} ?\n   */\n  handleMoreButtonClick(e) {\n    if (this.element.is('.is-disabled') || this.moreButton.is('.is-disabled')) {\n      e.preventDefault();\n      e.stopPropagation();\n      return false;\n    }\n\n    this.moreButton.data('focused-by-click', true);\n\n    if (!(this.hasMoreButton())) {\n      e.stopPropagation();\n    }\n    if (this.moreButton.hasClass('popup-is-open')) {\n      this.popupmenu.close();\n      this.moreButton.removeClass('popup-is-open');\n    } else {\n      this.buildPopupMenu();\n    }\n\n    this.hideFocusState();\n    return true;\n  },\n\n  /**\n   * Handler for click events on the \"More Tabs\" popupmenu trigger\n   * @private\n   * @param {jQuery.event} e Event\n   * @param {jQuery[]} a represents an anchor tag\n   * @returns {boolean|undefined} ?\n   */\n  handleTabFocus(e, a) {\n    if (this.element.is('.is-disabled')) {\n      e.preventDefault();\n      return false;\n    }\n\n    const li = a.parent();\n    const dataFocusedClick = a.data('focused-by-click');\n    const focusedByKeyboard = dataFocusedClick === undefined ||\n      (dataFocusedClick && dataFocusedClick === false);\n\n    $.removeData(a[0], 'focused-by-click');\n\n    if (this.isTabOverflowed(li)) {\n      this.buildPopupMenu(a.attr('href'));\n      this.moreButton.addClass('is-focused');\n      this.positionFocusState(this.moreButton);\n    } else {\n      li.addClass('is-focused');\n      this.positionFocusState(a, focusedByKeyboard);\n    }\n\n    return true;\n  },\n\n  /**\n   * Handler for focus events on the \"More Tabs\" popupmenu trigger\n   * @private\n   * @param {jQuery.event} e incoming focus event\n   * @returns {void}\n   */\n  handleMoreButtonFocus(e) {\n    if (this.element.is('.is-disabled')) {\n      e.preventDefault();\n      return;\n    }\n\n    const dataFocusedClick = this.moreButton.data('focused-by-click');\n    const focusedByKeyboard = (dataFocusedClick && dataFocusedClick === false);\n\n    $.removeData(this.moreButton[0], 'focused-by-click');\n\n    this.focusState.removeClass('is-visible');\n    this.positionFocusState(this.moreButton, focusedByKeyboard);\n  },\n\n  /**\n   * Handler for keydown events on Tabs in the list\n   * @private\n   * @param {jQuery.event} e incoming keydown event\n   * @returns {boolean|undefined} ?\n   */\n  handleTabKeyDown(e) {\n    if (this.element.is('.is-disabled')) {\n      e.preventDefault();\n      return false;\n    }\n\n    if (e.shiftKey || e.ctrlKey || e.metaKey || (e.altKey && e.which !== 8)) {\n      return true;\n    }\n\n    const self = this;\n    const passableKeys = [8, 13, 32];\n\n    function isPassableKey() {\n      return $.inArray(e.which, passableKeys) > -1;\n    }\n\n    if ((e.which < 32 && !isPassableKey()) || e.which > 46) {\n      return true;\n    }\n\n    if (isPassableKey()) {\n      const appMenuResult = this.handleAppMenuTabKeydown(e);\n      if (!appMenuResult) {\n        return true;\n      }\n    }\n\n    function openMenu(oldHref) {\n      e.preventDefault();\n      // setTimeout is used to bypass triggering of the keyboard when\n      // self.buildPopupMenu() is invoked.\n      setTimeout(() => {\n        self.buildPopupMenu(oldHref);\n      }, 0);\n    }\n\n    const allExcludes = ':not(.separator):not(.is-disabled):not(:hidden)';\n    let currentLi = $(e.currentTarget).parent();\n    let currentA = currentLi.children('a');\n    let targetLi;\n    const tabs = self.tablist.children(`li${allExcludes}`);\n    const isRTL = Locale.isRTL();\n\n    function previousTab() {\n      let i = tabs.index(currentLi) - 1;\n      while (i > -1 && !targetLi) {\n        if (tabs.eq(i).is(allExcludes)) {\n          return tabs.eq(i);\n        }\n        i -= 1;\n      }\n\n      if (self.settings.addTabButton) {\n        return self.addTabButton;\n      }\n\n      const last = self.tablist.children(`li${allExcludes}`).last();\n\n      if (self.hasMoreButton() && self.isScrollableTabs()) {\n        openMenu(last.find('a').attr('href'));\n      }\n\n      return last;\n    }\n\n    function nextTab() {\n      let i = tabs.index(currentLi) + 1;\n      while (i < tabs.length && !targetLi) {\n        if (tabs.eq(i).is(allExcludes)) {\n          return tabs.eq(i);\n        }\n        i++;\n      }\n\n      const first = self.tablist.children(`li${allExcludes}`).first();\n\n      if (self.hasMoreButton() && self.isScrollableTabs()) {\n        openMenu(first.find('a').attr('href'));\n        return first;\n      }\n\n      if (self.settings.addTabButton) {\n        return self.addTabButton;\n      }\n      return first;\n    }\n\n    function checkAngularClick() {\n      if (currentA.attr('ng-click') || currentA.attr('data-ng-click')) { // Needed to fire the \"Click\" event in Angular situations\n        currentA.click();\n      }\n    }\n\n    function activate() {\n      if (currentLi.hasClass('has-popupmenu')) {\n        currentLi.data('popupmenu').open();\n        return;\n      }\n\n      let href = currentA.attr('href');\n\n      if (currentLi.is('.add-tab-button')) {\n        currentA = self.handleAddButton();\n        currentLi = currentA.parent();\n        href = currentA.attr('href');\n        self.element.trigger('tab-added', [currentA]);\n      }\n\n      if (!self.activate(href)) {\n        return;\n      }\n\n      self.changeHash(href);\n      self.focusBar(currentLi);\n      checkAngularClick();\n      currentA[0].focus();\n      self.hideFocusState();\n\n      // In the event that the activated tab is a full link that should be followed,\n      // the keystroke events need to manually activate the link change.  Clicks are handled\n      // automatically by the browser.\n      self.handleOutboundLink(href);\n    }\n\n    switch (e.which) {\n      case 8:\n        if (e.altKey && currentLi.is('.dismissible')) {\n          e.preventDefault();\n          self.closeDismissibleTab(currentA.attr('href'));\n        }\n        return true;\n      case 13: // Enter\n        activate();\n        return false;\n      case 32: // Spacebar\n        activate();\n        return false;\n      case 38:\n        targetLi = previousTab();\n        e.preventDefault();\n        break;\n      case 37:\n        targetLi = isRTL ? nextTab() : previousTab();\n        e.preventDefault();\n        break;\n      case 40:\n        targetLi = nextTab();\n        e.preventDefault();\n        break;\n      case 39:\n        targetLi = isRTL ? previousTab() : nextTab();\n        e.preventDefault();\n        break;\n      default:\n        break;\n    }\n\n    if (targetLi) {\n      const isAddTabButton = targetLi.is('.add-tab-button');\n      const focusStateTarget = isAddTabButton ? targetLi : targetLi.children('a');\n\n      // Use the matching option in the popup menu if the target is hidden by overflow.\n      if (this.isTabOverflowed(targetLi)) {\n        return openMenu(targetLi.children('a').attr('href'));\n      }\n\n      if (!isAddTabButton) {\n        focusStateTarget.focus();\n      } else {\n        self.addTabButton.focus();\n      }\n\n      if (this.isScrollableTabs()) {\n        this.scrollTabList(focusStateTarget);\n      }\n\n      self.positionFocusState(focusStateTarget, true);\n    }\n\n    return true;\n  },\n\n  /**\n   * Handler for keydown events on Dismissible tabs\n   * @private\n   * @param {jQuery.event} e incoming keydown event\n   * @returns {void}\n   */\n  handleDismissibleTabKeydown(e) {\n    const key = e.which;\n    let tab = $(e.target);\n\n    if (tab.is('a')) {\n      tab = tab.parent();\n    }\n\n    if (e.altKey && key === 46) { // Alt + Del\n      if (tab.children('a').is('[disabled]') || tab.hasClass('is-disabled')) {\n        return;\n      }\n\n      e.preventDefault();\n      this.closeDismissibleTab(tab.children('a').attr('href'));\n    }\n  },\n\n  /**\n   * Handler for keydown events on the \"App Menu\" tab (trigger button for the App Menu)\n   * @private\n   * @param {jQuery.event} e incoming keydown event\n   * @returns {boolean} ?\n   */\n  handleAppMenuTabKeydown(e) {\n    const target = $(e.target);\n    const li = target.parent();\n\n    if (!(li.is('.application-menu-trigger') || target.is('.application-menu-trigger'))) {\n      return true;\n    }\n\n    // If the tab is an application-menu trigger, open the app menu\n    // Used by Module Tabs\n    const menu = $('#application-menu');\n    if (!menu.length) {\n      return false;\n    }\n\n    e.preventDefault();\n\n    this.hideFocusState();\n\n    if (menu.hasClass('is-open')) {\n      menu.trigger('close-applicationmenu');\n      return false;\n    }\n\n    menu.trigger('open-applicationmenu');\n    return false;\n  },\n\n  /**\n   * Handler for keydown events on the \"More Tabs\" popupmenu trigger\n   * @private\n   * @param {jQuery.event} e incoming keydown event\n   * @returns {boolean|undefined} ?\n   */\n  handleMoreButtonKeydown(e) {\n    if (this.element.is('.is-disabled')) {\n      e.preventDefault();\n      return false;\n    }\n\n    const self = this;\n    const isRTL = Locale.isRTL();\n\n    function openMenu() {\n      e.preventDefault();\n      self.buildPopupMenu(self.tablist.find('.is-selected').children('a').attr('href'));\n      self.positionFocusState(self.moreButton, true);\n    }\n\n    function lastTab() {\n      e.preventDefault();\n      self.findLastVisibleTab();\n    }\n\n    switch (e.which) {\n      case 37: // left\n        if (isRTL) {\n          openMenu();\n          break;\n        }\n        lastTab();\n        break;\n      case 38: // up\n        lastTab();\n        break;\n      case 13: // enter\n      case 32: // spacebar\n        e.preventDefault();\n        break;\n      case 39: // right\n        if (isRTL) {\n          lastTab();\n          break;\n        }\n        openMenu();\n        break;\n      case 40: // down\n        openMenu();\n        break;\n      default:\n        break;\n    }\n\n    return true;\n  },\n\n  /**\n   * Handler for keydown events on the \"More Tabs\" popupmenu trigger\n   * @private\n   * @param {jQuery.event} e incoming keydown event\n   * @returns {void}\n   */\n  handlePanelKeydown(e) {\n    const key = e.which;\n    const panel = $(e.target);\n    const a = this.anchors.filter(`#${panel.attr('id')}`);\n    const tab = this.anchors.filter(`#${panel.attr('id')}`).parent();\n\n    if (tab.is('.dismissible')) {\n      // Close a Dismissible Tab\n      if (e.altKey && key === 46) { // Alt + Delete\n        e.preventDefault();\n        return this.closeDismissibleTab(a.attr('href'));\n      }\n    }\n\n    // Takes focus away from elements inside a Tab Panel and brings focus to its corresponding Tab\n    if ((e.ctrlKey && key === 38) &&\n      $.contains(document.activeElement, panel[0])) { // Ctrl + Up Arrow\n      e.preventDefault();\n      return this.activate(a.attr('href'), a);\n    }\n\n    return undefined;\n  },\n\n  /**\n   * Handles the Add Tab button being clicked\n   * @private\n   * @returns {boolean|undefined} ?\n   */\n  handleAddButton() {\n    const cb = this.settings.addTabButtonCallback;\n    if (cb && typeof cb === 'function') {\n      const newTabId = cb();\n      return this.anchors.filter(`[href=\"#${newTabId}\"]`);\n    }\n\n    function makeId() {\n      const stringName = 'new-tab';\n      const existing = $(`[id^=\"${stringName}\"]`);\n\n      if (!existing.length) {\n        return `${stringName}-0`;\n      }\n      return `${stringName}-${existing.length}`;\n    }\n\n    function makeName(id) {\n      const nameParts = id.toString().split('-');\n      nameParts.forEach((val, i) => {\n        nameParts[i] = val.charAt(0).toUpperCase() + val.slice(1);\n      });\n\n      return nameParts.join(' ');\n    }\n\n    let newIndex = this.tablist.children().index(this.addTabButton);\n    let newId = makeId();\n    const newName = makeName(newId);\n    let settings = {\n      name: newName,\n      content: '&nbsp;',\n      isDismissible: true\n    };\n\n    if (newIndex < 0) {\n      newIndex = this.tablist.find('li:not(.separator)').length;\n    }\n\n    // Allow the opportunity to pass in external settings for the new tab control\n    const externalSettings = this.element.triggerHandler('before-tab-added', [newId, settings, newIndex]);\n    if (!externalSettings) {\n      this.add(newId, settings, newIndex);\n      return this.anchors.filter(`[href=\"#${newId}\"]`);\n    }\n\n    if (externalSettings.newId &&\n      externalSettings.newId.length &&\n      typeof externalSettings.newId === 'string') {\n      newId = externalSettings.newId;\n    }\n    if (externalSettings.settings &&\n      typeof externalSettings.settings === 'object') {\n      settings = externalSettings.settings;\n    }\n    if (!isNaN(externalSettings.newIndex)) {\n      newIndex = externalSettings.newIndex;\n    }\n\n    this.add(newId, settings, newIndex);\n    return this.anchors.filter(`[href=\"#${newId}\"]`);\n  },\n\n  /**\n   * @private\n   * @param {jQuery.Event} e incoming keydown event\n   * @returns {undefined|boolean} ?\n   */\n  handleAddButtonKeydown(e) {\n    if (this.element.is('.is-disabled')) {\n      e.preventDefault();\n      return false;\n    }\n\n    const validKeys = [13, 32, 37, 38, 39, 40];\n    const key = e.which;\n\n    if (validKeys.indexOf(key) < 0) {\n      return false;\n    }\n\n    const self = this;\n    const isRTL = Locale.isRTL();\n    let targetLi;\n    const filter = 'li:not(.separator):not(.is-disabled):not(:hidden)';\n\n    function openMenu() {\n      e.preventDefault();\n      targetLi = self.tablist.find(filter).last();\n\n      if (self.isTabOverflowed(targetLi)) {\n        // Open the spillover\n        self.buildPopupMenu(targetLi.children('a').attr('href'));\n        self.positionFocusState(self.moreButton, true);\n      }\n    }\n\n    function firstTab() {\n      targetLi = self.tablist.find(filter).first();\n    }\n\n    switch (key) {\n      case 37: // left\n        if (isRTL) {\n          firstTab();\n          break;\n        }\n        openMenu();\n        break;\n      case 38: // up\n        openMenu();\n        break;\n      case 13: // enter\n      case 32: // spacebar\n        e.preventDefault();\n        return this.handleAddButton();\n      case 39: // right\n        if (isRTL) {\n          openMenu();\n          break;\n        }\n        firstTab();\n        break;\n      case 40: // down\n        firstTab();\n        break;\n      default:\n        break;\n    }\n\n    targetLi.children('a').focus();\n    return true;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  handleAddButtonFocus() {\n    const tabs = this.tablist.find('li:not(.separator)');\n    tabs.add(this.moreButton).removeClass('is-focused');\n\n    this.addTabButton.addClass('is-focused');\n    this.positionFocusState(this.addTabButton, true);\n  },\n\n  /**\n   * @private\n   * @param {boolean} ignoreResponsiveCheck if true, doesn't run `this.checkResponsive()`\n   * @returns {void}\n   */\n  handleResize(ignoreResponsiveCheck) {\n    if (!ignoreResponsiveCheck) {\n      this.checkResponsive(true);\n    }\n\n    this.setOverflow();\n\n    let selected = this.tablist.find('.is-selected');\n    if (!selected.length || this.moreButton.is('.is-selected') || this.isTabOverflowed(selected)) {\n      selected = this.moreButton;\n    }\n\n    if (!selected.length) {\n      this.defocusBar();\n      this.hideFocusState();\n    } else {\n      this.focusBar(selected);\n      this.positionFocusState(selected);\n    }\n\n    this.handleVerticalTabResize();\n    this.renderVisiblePanel();\n    this.renderEdgeFading();\n  },\n\n  /**\n   * Checks the window size to determine if a responsive-mode switch is needed.\n   * @private\n   * @returns {void}\n   * @param  {boolean} handleRebuild Do a rebuild after handling.\n   */\n  checkResponsive(handleRebuild) {\n    const self = this;\n    const classList = self.element[0].classList;\n\n    function rebuild() {\n      self.removeHelperMarkupEvents();\n      self.renderHelperMarkup();\n      self.setupHelperMarkupEvents();\n    }\n\n    function makeResponsive() {\n      if (!classList.contains('is-in-responsive-mode')) {\n        classList.add('is-in-responsive-mode');\n        classList.add('header-tabs');\n        classList.add('alternate');\n        classList.remove('vertical');\n        if (handleRebuild) {\n          rebuild();\n        }\n      }\n    }\n\n    function makeVertical() {\n      if (classList.contains('is-in-responsive-mode')) {\n        classList.add('vertical');\n        classList.remove('is-in-responsive-mode');\n        classList.remove('header-tabs');\n        classList.remove('alternate');\n        if (handleRebuild) {\n          rebuild();\n        }\n      }\n    }\n\n    // Check for responsive mode for Vertical tabs\n    if (this.isResponsiveVerticalTabs()) {\n      if (breakpoints.isBelow('phone-to-tablet')) {\n        makeResponsive();\n      } else {\n        makeVertical();\n      }\n    } else {\n      makeVertical();\n    }\n  },\n\n  /**\n   * Causes a vertical tabs container to stretch to the height of its parent container\n   * @private\n   * @returns {void}\n   */\n  handleVerticalTabResize() {\n    if (!this.isVerticalTabs()) {\n      return;\n    }\n\n    // When tabs are full-size (part of a layout) CSS rules should handle this better\n    // due to less strange sizing constraints.  JS resizing is necessary for nesting.\n    if (!this.isNested() || this.isNestedInLayoutTabs() || this.isHidden()) {\n      return;\n    }\n\n    const elemStyle = window.getComputedStyle(this.element[0]);\n    const elemOuterHeight = elemStyle.getPropertyValue('height') + elemStyle.getPropertyValue('margin-top') + elemStyle.getPropertyValue('margin-bottom');\n\n    this.tablist[0].style.height = elemOuterHeight;\n  },\n\n  /**\n   * Changes the location in the browser address bar to force outbound links.\n   * @param {string} href incoming href link\n   * @param {boolean} useRelativePath don't prepend the full domain, port,\n   * protocol, etc. to the HREF.\n   * @returns {void}\n   */\n  handleOutboundLink(href, useRelativePath) {\n    if (href.charAt(0) === '#') {\n      return;\n    }\n\n    if (href.charAt(0) === '/' && (!useRelativePath || useRelativePath === false)) {\n      href = window.location.origin + href;\n    }\n\n    window.location = href;\n  },\n\n  /**\n   * Determines whether or not this tabset's tab list should display an animated selected state on a tab.\n   * @returns {boolean} whether or not the animated selected state should display.\n   */\n  hasAnimatedBar() {\n    return !this.isModuleTabs() && !this.isVerticalTabs();\n  },\n\n  /**\n   * Determines whether or not this tabset currently has a \"More Tabs\" spillover button.\n   * @returns {boolean} whether or not the \"More Tabs\" button is currently displayed.\n   */\n  hasMoreButton() {\n    return this.element[0].classList.contains('has-more-button');\n  },\n\n  /**\n   * Determines whether or not this normally \"vertical\" tabset is in an optional \"horizontal\" responsive mode\n   * @returns {boolean} whether or not the responsive mode is active.\n   */\n  isInResponsiveMode() {\n    return this.element[0].classList.contains('is-in-responsive-mode');\n  },\n\n  /**\n   * Determines whether or not this tabset is currently operating as Module Tabs\n   * @returns {boolean} whether or not this is a Module tabset.\n   */\n  isModuleTabs() {\n    return this.element.hasClass('module-tabs');\n  },\n\n  /**\n   * Determines whether or not this tabset is currently operating as Vertical Tabs\n   * @returns {boolean} whether or not this is a Vertical tabset.\n   */\n  isVerticalTabs() {\n    return this.element.hasClass('vertical');\n  },\n\n  /**\n   * Determines whether or not this tabset is Vertical Tabs with a responsive, horizontal capability\n   * @returns {boolean} whether or not this is a Vertical tabset.\n   */\n  isResponsiveVerticalTabs() {\n    return this.settings.verticalResponsive === true;\n  },\n\n  /**\n   * Determines whether or not this tabset is currently operating as Header Tabs\n   * @returns {boolean} whether or not this is a Header tabset.\n   */\n  isHeaderTabs() {\n    return this.element.hasClass('header-tabs');\n  },\n\n  /**\n   * Determines whether or not this tabset is showing tabs that allow for selection via horizontal scrolling.\n   * @returns {boolean} whether or not horizontal scrolling is possible.\n   */\n  isScrollableTabs() {\n    return !this.isModuleTabs() && !this.isVerticalTabs();\n  },\n\n  /**\n   * Determines whether or not this tabset is currently hidden\n   * @returns {boolean} whether or not this tabset is hidden.\n   */\n  isHidden() {\n    return this.element.is(':hidden');\n  },\n\n  /**\n   * Determines whether or not this tabset is nested inside a parent Tab Panel\n   * @returns {boolean} whether or not this tabset is nested.\n   */\n  isNested() {\n    return this.element.closest('.tab-panel').length;\n  },\n\n  /**\n   * Determines whether or not a particular tab panel is currently the active (displayed) tab panel\n   * @param {string} href representing the HTML \"id\" attribute of a corresponding tab panel\n   * @returns {boolean} whether or not the tab panel is active.\n   */\n  isActive(href) {\n    if (!href || !href.length || (href.length === 1 && href.indexOf('#') < 1)) {\n      return false;\n    }\n\n    const panel = this.getPanel(href);\n    return panel[0].classList.contains('can-show');\n  },\n\n  /**\n   * Determines whether or not this tabset is nested inside a \"Layout\"-style of Tab container\n   * @returns {boolean} whether or not this tabset is nested.\n   */\n  isNestedInLayoutTabs() {\n    const nestedInModuleTabs = this.element.closest('.module-tabs').length;\n    const nestedInHeaderTabs = this.element.closest('.header-tabs').length;\n    const hasTabContainerClass = this.element.closest('.tab-panel-container').length;\n\n    return (nestedInModuleTabs > 0 || nestedInHeaderTabs > 0 || hasTabContainerClass > 0);\n  },\n\n  /**\n   * Determines if an object is an HTML List Item representing a tab\n   * @param {object} obj incoming object\n   * @returns {boolean} whether or not the item is a tab\n   */\n  isTab(obj) {\n    return obj instanceof jQuery && obj.length && obj.is('li.tab');\n  },\n\n  /**\n   * Determines if an object is an HTML Anchor Tag representing a tab's actionable element\n   * @param {object} obj incoming object\n   * @returns {boolean} whether or not the item is an anchor tag\n   */\n  isAnchor(obj) {\n    return obj instanceof jQuery && obj.length && obj.is('a');\n  },\n\n  /**\n   * Gets a reference to an Anchor tag.\n   * @param {string|jQuery} href either a string that can be used as a Tab ID, or an actual jQuery wrapped Anchor Tag.\n   * @returns {jQuery} the Anchor tag\n   */\n  getAnchor(href) {\n    if (this.isAnchor(href)) {\n      return href;\n    }\n\n    if (href.indexOf('#') === -1 && href.charAt(0) !== '/') {\n      href = `#${href}`;\n    }\n\n    return this.anchors.filter(`[href=\"${href}\"]`);\n  },\n\n  /**\n   * Gets a reference to a Tab panel.\n   * @param {string|jQuery} href either a string that can be used as a Tab ID, or an actual jQuery wrapped Anchor Tag.\n   * @returns {jQuery} the Anchor tag\n   */\n  getPanel(href) {\n    if (this.isTab(href)) {\n      href = href.children('a');\n    }\n\n    if (this.isAnchor(href)) {\n      href = href.attr('href');\n    }\n\n    if (!href || href === '' || href === '#') {\n      return $();\n    }\n\n    // uses angular LocationStrategy\n    if (href.substr(0, 2) === '#/') {\n      href = href.replace('#/', '#');\n    }\n    return this.panels.filter(`[id=\"${href.replace(/#/g, '')}\"]`);\n  },\n\n  getMenuItem(href) {\n    if (this.isAnchor(href)) {\n      href = href.attr('href');\n    }\n\n    if (href.indexOf('#') === -1) {\n      href = `#${href}`;\n    }\n    return this.moreMenu.children().children().filter(`[data-href=\"${href}\"]`).parent();\n  },\n\n  /**\n   * Takes a tab ID and returns a jquery object containing the previous available tab\n   * @param {string} tabId the tab ID\n   * @returns {jQuery[]} jQuery-wrapped element reference for the tab\n   */\n  getPreviousTab(tabId) {\n    const tab = this.getTab(null, tabId);\n    const filter = 'li:not(.separator):not(:hidden):not(.is-disabled)';\n    const tabs = this.tablist.find(filter);\n    const idx = tabs.index(tab);\n    let target = tabs.eq(idx === 0 ? 1 : idx - 1);\n\n    while (target.length && !target.is(filter)) {\n      target = tabs.eq(tabs.index(target) - 1);\n    }\n\n    // Top-level Dropdown Tabs don't have an actual panel associated with them.\n    // Get a Dropdown Tab's first child as the target.\n    if (target.is('.has-popupmenu')) {\n      const menuAPI = target.data('popupmenu');\n      if (menuAPI) {\n        target = menuAPI.menu.children('li').first();\n      }\n    }\n\n    return target;\n  },\n\n  /**\n   * Takes a tab ID and activates an adjacent available tab\n   * @param {object} e event object\n   * @param {string} tabId the tab ID\n   */\n  activateAdjacentTab(e, tabId) {\n    const tab = this.doGetTab(e, tabId);\n\n    if (typeof e === 'string') {\n      tabId = e;\n    }\n\n    if (tab.is('.is-selected')) {\n      if (tab.prevAll('li.tab').not('.hidden').not('.is-disabled').length > 0) {\n        this.select($(tab.prevAll('li.tab').not('.hidden').not('.is-disabled')[0]).find('a')[0].hash, true);\n      } else if (tab.nextAll('li.tab').not('.hidden').length > 0) {\n        this.select($(tab.nextAll('li.tab').not('.hidden').not('.is-disabled')[0]).find('a')[0].hash, true);\n      }\n    } else {\n      this.select($(this.element.find('li.tab.is-selected')[0]).find('a')[0].hash, true);\n    }\n  },\n\n  /**\n   * Takes a tab ID and returns a jquery object containing the previous available tab\n   * If an optional target Tab (li) is provided, use this to perform activation events\n   * @param {string} tabId the tab ID\n   * @param {jQuery[]} [target] a reference to the previous tab in the list (before this one)\n   * @returns {jQuery[]} potentially-updated target\n   */\n  activatePreviousTab(tabId, target) {\n    const tab = this.getTab(null, tabId);\n\n    if (!target || !(target instanceof jQuery)) {\n      target = this.getPreviousTab(tabId);\n    }\n\n    if (!target.length) {\n      this.hideFocusState();\n      this.defocusBar();\n      return target;\n    }\n\n    const a = target.children('a');\n    if (tab.is('.is-selected')) {\n      if (!this.activate(a.attr('href'), a)) {\n        return target;\n      }\n      a.focus();\n    }\n    this.positionFocusState(a);\n    this.focusBar(target);\n\n    return target;\n  },\n\n  /**\n   * Determines whether or not a string has an outbound URL, instead of a hash (#) that would match up to a Tab ID.\n   * @param {string} href a string that may or may not contain a URL\n   * @returns {boolean} whether or not the incoming string is a URL\n   */\n  isURL(href) {\n    if (!href || href.indexOf('#') === 0) {\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * Causes a new tab panel to become active.  Will also trigger AJAX calls on unloaded tab panels, if necessary.\n   * @param {string} href a string that either matches up to a Tab ID, or an outbound link to grab AJAX content from.\n   * @param {object} anchor in addition to the ref the anchor object may be passed to avoid extra querying.\n   * @returns {void}\n   */\n  activate(href, anchor) {\n    const self = this;\n\n    if (self.isURL(href)) {\n      return this.callSource(href, anchor, true);\n    }\n\n    const a = self.getAnchor(href);\n    const targetTab = a.parent();\n    const targetPanel = self.getPanel(href);\n    const targetPanelElem = targetPanel[0];\n    const oldTab = self.anchors.parents().filter('.is-selected');\n    let oldPanel;\n    let selectedStateTarget;\n    let activeStateTarget;\n\n    // Avoid filter(:visible)\n    for (let i = 0; i < self.panels.length; i++) {\n      if (self.panels[i].classList.contains('is-visible')) {\n        oldPanel = $(self.panels[i]);\n      }\n    }\n\n    if (!oldPanel) {\n      oldPanel = self.panels;\n    }\n\n    // NOTE: Breaking Change as of 4.3.3 - `beforeactivate` to `beforeactivated`\n    // See SOHO-5994 for more details\n    /**\n     * Fires when an attempt at activating a tab is started\n     *\n     * @event beforeactivated\n     * @memberof Tabs\n     * @param {jQuery.Event} e event object\n     * @param {jQuery} a the tab anchor attempting to activate\n     */\n    const isCancelled = self.element.trigger('beforeactivated', [a]);\n    if (!isCancelled) {\n      return false;\n    }\n\n    function completeActivate(vetoResult) {\n      if (targetPanel.length < 1) {\n        if (self.settings.source) {\n          self.callSource(href, a);\n          return true;\n        }\n      } else {\n        oldPanel[0].classList.remove('can-show');\n        oldPanel[0].classList.remove('is-visible');\n        oldPanel.closeChildren();\n\n        /**\n         * Fires when a new tab has been activated\n         *\n         * @event activated\n         * @memberof Tabs\n         * @param {jQuery.Event} e event object\n         * @param {jQuery} a the tab anchor attempting to activate\n         */\n        self.element.trigger('activated', [a]);\n\n        targetPanelElem.classList.add('can-show');\n        self.renderVisiblePanel();\n        // trigger reflow as display property is none for animation\n        // eslint-disable-next-line\n        targetPanelElem.offsetHeight;\n\n        // Register an `afteractivated` event trigger as a renderLoop callback\n        const timer = new RenderLoopItem({\n          duration: math.convertDelayToFPS(150),\n          timeoutCallback() {\n            /**\n             * Fires when a new tab has been completely activated, and the activation process is done\n             *\n             * @event afteractivated\n             * @memberof Tabs\n             * @param {jQuery.Event} e event object\n             * @param {jQuery} a the tab anchor attempting to activate\n             */\n            self.element.trigger('afteractivated', [a]);\n          }\n        });\n        renderLoop.register(timer);\n\n        // Triggers the CSS Animation\n        targetPanelElem.classList.add('is-visible');\n      }\n\n      // Update the currently-selected tab\n      self.updateAria(a);\n      oldTab.add(self.moreButton).removeClass('is-selected');\n      if (targetTab[0]) {\n        if (targetTab[0].classList.contains('tab')) {\n          selectedStateTarget = targetTab;\n          activeStateTarget = targetTab;\n        }\n      }\n\n      const ddMenu = targetTab.parents('.popupmenu');\n      let ddTab;\n\n      if (ddMenu.length) {\n        ddTab = ddMenu.data('trigger');\n        if (ddTab.length) {\n          selectedStateTarget = ddTab;\n          activeStateTarget = ddTab;\n        }\n      }\n\n      if (self.isTabOverflowed(activeStateTarget)) {\n        activeStateTarget = self.moreButton;\n        selectedStateTarget = self.moreButton;\n      }\n      self.focusBar(activeStateTarget);\n\n      if (selectedStateTarget) {\n        selectedStateTarget.addClass('is-selected');\n      }\n\n      // Fires a resize on any invoked child toolbars inside the tab panel.\n      // Needed to fix issues with Toolbar alignment, since we can't properly detect\n      // size on hidden elements.\n      const childToolbars = targetPanel.find('.toolbar');\n      if (childToolbars.length) {\n        childToolbars.each(function () {\n          const api = $(this).data('toolbar');\n          if (api && typeof api.handleResize === 'function') {\n            api.handleResize();\n          }\n        });\n      }\n\n      // Automatically refresh all icons inside Tab panels on activation.\n      // See SOHO-7313\n      utils.fixSVGIcons(targetPanel[0]);\n\n      return vetoResult || false;\n    }\n\n    // Handle an optional, veto-able \"beforeActivate\" callback.\n    if (this.settings.beforeActivate && typeof this.settings.beforeActivate === 'function') {\n      return this.settings.beforeActivate(oldTab, targetTab, completeActivate);\n    }\n\n    // Otherwise, simply continue\n    return completeActivate(true);\n  },\n\n  /**\n   * Shows/Hides some tabsets' faded edges based on scrolling position, if applicable.\n   * @private\n   * @returns {undefined}\n   */\n  renderEdgeFading() {\n    if (!this.isScrollableTabs() || !this.tablistContainer) {\n      return;\n    }\n\n    const isRTL = Locale.isRTL();\n    const tablistContainerElem = this.tablistContainer[0];\n    const scrollLeft = tablistContainerElem.scrollLeft;\n    const scrollWidth = tablistContainerElem.scrollWidth;\n    const containerWidth = parseInt(window.getComputedStyle(tablistContainerElem).getPropertyValue('width'), 10);\n\n    if (isRTL) {\n      this.element[0].classList[scrollLeft > 0 ? 'add' : 'remove']('scrolled-left');\n      this.element[0].classList[(scrollWidth - scrollLeft) <= containerWidth ? 'remove' : 'add']('scrolled-right');\n    } else {\n      this.element[0].classList[scrollLeft > 0 ? 'add' : 'remove']('scrolled-right');\n      this.element[0].classList[(scrollWidth - scrollLeft) <= containerWidth ? 'remove' : 'add']('scrolled-left');\n    }\n  },\n\n  /**\n   * Calls an options-provided source method to fetch content that will be displayed inside a tab.\n   * @param {string} href - string representing the target tab to load content under.\n   * @param {object} anchor - Reference to the dom object anchor tag.\n   * @param {boolean} isURL detects whether or not the URL is actually an external /\n   * call, or an ID for an existing tab in the page.\n   * @returns {boolean|$.Deferred} true if source call was successful, false for failure/ignore,\n   * or a promise object that will fire callbacks in either \"success\" or \"failure\" scenarios.\n   */\n  callSource(href, anchor, isURL) {\n    if ((isURL === undefined || isURL === null || isURL === false) && !this.settings.source) {\n      return false;\n    }\n    if (this.settings.lazyLoad !== true) {\n      return false;\n    }\n\n    const sourceType = typeof this.settings.source;\n    const response = (htmlContent) => {\n      if (htmlContent === undefined || htmlContent === null) {\n        return;\n      }\n\n      htmlContent = xssUtils.sanitizeHTML(htmlContent);\n\n      // Get a new random tab ID for this tab if one can't be derived from the URL string\n      if (isURL) {\n        const containerId = this.element[0].id || '';\n        const id = utils.uniqueId(anchor, 'tab', containerId);\n\n        href = `#${id}`;\n        // Replace the original URL on this anchor now that we've loaded content.\n        anchor[0].setAttribute('href', href);\n      }\n\n      this.createTabPanel(href, htmlContent, true);\n      this.activate(href);\n\n      this.element.triggerHandler('complete'); // For Busy Indicator\n      this.element.trigger('requestend', [href, htmlContent]);\n    };\n\n    this.container.triggerHandler('start'); // For Busy Indicator\n    this.container.trigger('requeststart');\n\n    function handleStringSource(url, options) {\n      const opts = $.extend({ dataType: 'html' }, options, {\n        url\n      });\n\n      const request = $.ajax(opts);\n      request.done(response);\n      return request;\n    }\n\n    if (isURL) {\n      return handleStringSource(href, this.ajaxOptions);\n    }\n\n    // return _true_ from this source function on if we're just loading straight content\n    // return a promise if you'd like to setup async handling.\n    if (sourceType === 'function') {\n      return this.settings.source(response, href, this.settings.sourceArguments);\n    }\n\n    if (sourceType === 'string') {\n      // Attempt to resolve source as a URL string.  Make an $.ajax() call with the URL\n      const safeHref = href.replace(/#/g, '');\n      let sourceURL = this.settings.source.toString();\n      const hasHref = sourceURL.indexOf(safeHref) > -1;\n\n      if (!hasHref) {\n        let param = `tab=${safeHref}`;\n        const paramIndex = sourceURL.indexOf('?');\n        const hashIndex = sourceURL.indexOf('#');\n        let insertIndex = sourceURL.length;\n\n        if (paramIndex < 0) {\n          param = `?${param}`;\n          if (hashIndex > -1) {\n            insertIndex = hashIndex + 1;\n          }\n        } else {\n          param += '&';\n          insertIndex = paramIndex + 1;\n        }\n\n        sourceURL = stringUtils.splice(sourceURL, insertIndex, 0, param);\n      }\n\n      return handleStringSource(sourceURL, this.ajaxOptions);\n    }\n\n    return false;\n  },\n\n  /**\n   * @private\n   */\n  renderVisiblePanel() {\n    // Recalculate all components inside of the visible tab to adjust\n    // widths/heights/display if necessary\n    this.resizeNestedTabs();\n    // TJM: Prioritizing performance fix.\n    // this.panels.filter(':visible').handleResize();\n  },\n\n  /**\n   *\n   * Update the hash in the link.\n   * @private\n   * @param  {HTMLElement} href The Dom Element.\n   * @returns {void}\n   */\n  changeHash(href) {\n    if (!this.settings.changeTabOnHashChange) {\n      return;\n    }\n\n    if (!href) {\n      href = '';\n    }\n\n    href.replace(/#/g, '');\n\n    const cb = this.settings.hashChangeCallback;\n    if (cb && typeof cb === 'function') {\n      cb(href);\n    } else {\n      window.location.hash = href;\n    }\n\n    /**\n     * @event hash-change\n     * @memberof Tabs\n     * @param {jQuery.Event} e the jQuery event object\n     * @param {string} href the new hash fragment for the URL\n     */\n    this.element.triggerHandler('hash-change', [href]);\n  },\n\n  /**\n   * Updates the aria-related markup on all tab elements\n   * @private\n   * @param {jQuery} a the 'selected' tab anchor\n   */\n  updateAria(a) {\n    if (!a) {\n      return;\n    }\n    // hide old tabs\n    this.anchors.attr({\n      'aria-selected': 'false',\n      'aria-expanded': 'false',\n      tabindex: '-1'\n    });\n    this.moreButton.attr({\n      tabindex: '-1'\n    });\n\n    // show current tab\n    if (a.length && this.element.is(':not(.is-disabled)')) {\n      a.parent().removeClass('is-selected');\n      if (!this.isTabOverflowed(a.parent())) {\n        a.attr({\n          'aria-selected': 'true',\n          'aria-expanded': 'true',\n          tabindex: '0'\n        }).parent().addClass('is-selected');\n      } else {\n        this.moreButton.attr({\n          tabindex: '0'\n        });\n      }\n    }\n  },\n\n  /**\n   * Causes `handleResize()` to be fired on any Tab components that are nested inside of this tab component's panels.\n   * @returns {void}\n   */\n  resizeNestedTabs() {\n    this.nestedTabControls.each((i, container) => {\n      const c = $(container);\n      const api = c.data('tabs');\n\n      if (api && api.handleResize && typeof api.handleResize === 'function') {\n        api.handleResize(true);\n      }\n    });\n  },\n\n  /**\n   * Adds a new tab into the list and properly binds all of its events\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @param {object} options incoming options for the new tab.\n   * @param {string} [options.name] the text title of the new tab.\n   * @param {boolean} [options.doActivate=false] if true, causes the newly-added tab to become activated and focused.\n   * @param {boolean} [options.isDismissible=false] if true, causes the tab to become dismissible (closable) with an \"X\" button.\n   * @param {boolean} [options.isDropdown=false] if true, causes the tab to become a dropdown tab.\n   * @param {string} [options.content] representing HTML markup that will be added inside of the new tab panel.\n   * @param {number} [atIndex] if defined, inserts the tab at a particular number index in the tab list.  Defaults to the last tab in the list.\n   * @returns {this} component instance\n   */\n  add(tabId, options, atIndex) {\n    if (!tabId) {\n      return this;\n    }\n\n    if (!options) {\n      options = {};\n    }\n\n    const startFromZero = this.tablist.find('li').not('.application-menu-trigger, .add-tab-button').length === 0;\n\n    // Sanitize\n    tabId = `${tabId.replace(/#/g, '')}`;\n    options.name = options.name ? options.name.toString() : '&nbsp;';\n    options.isDismissible = options.isDismissible ? options.isDismissible === true : false;\n    options.isDropdown = options.isDropdown ? options.isDropdown === true : false;\n\n    function getObjectFromSelector(sourceString) {\n      const contentType = typeof sourceString;\n      let hasId;\n\n      switch (contentType) {\n        case 'string':\n          hasId = sourceString.match(/#/g);\n          // Text Content or a Selector.\n          if (hasId !== null) {\n            const obj = $(sourceString);\n            sourceString = obj.length ? obj : sourceString;\n          }\n          // do nothing if it's just a string of text.\n          break;\n        default:\n          break;\n      }\n      return sourceString;\n    }\n\n    if (options.content) {\n      options.content = getObjectFromSelector(options.content);\n    }\n    if (options.dropdown) {\n      options.dropdown = getObjectFromSelector(options.dropdown);\n    }\n\n    // Build\n    const tabHeaderMarkup = $('<li role=\"presentation\" class=\"tab\"></li>');\n    const anchorMarkup = $(`<a href=\"#${tabId}\" role=\"tab\" aria-expanded=\"false\" aria-selected=\"false\" tabindex=\"-1\">${xssUtils.escapeHTML(options.name)}</a>`);\n    const tabContentMarkup = this.createTabPanel(tabId, options.content);\n\n    tabHeaderMarkup.html(anchorMarkup);\n\n    if (options.isDismissible) {\n      tabHeaderMarkup.addClass('dismissible');\n      tabHeaderMarkup.append($.createIconElement({ icon: 'close', classes: 'close icon' }));\n    }\n\n    if (this.settings.tabCounts) {\n      anchorMarkup.prepend('<span class=\"count\">0 </span>');\n    }\n\n    if (options.dropdown) {\n      // TODO: Need to implement the passing of Dropdown Tab menus into this method.\n    }\n\n    function insertIntoTabset(self, targetIndex) {\n      let method;\n      const tabs = self.tablist.children('li');\n      const nonSpecialTabs = tabs.not('.application-menu-trigger, .add-tab-button');\n      let finalIndex = tabs.length - 1;\n\n      if (!tabs.length) {\n        tabHeaderMarkup.appendTo(self.tablist);\n        tabContentMarkup.appendTo(self.container);\n        return;\n      }\n\n      const addTabButton = tabs.filter('.add-tab-button');\n      const appMenuTrigger = tabs.filter('.application-menu-trigger');\n\n      // NOTE: Cannot simply do !targetIndex here because zero is a valid index\n      if (targetIndex === undefined || targetIndex === null || isNaN(targetIndex)) {\n        targetIndex = tabs.length;\n      }\n\n      function pastEndOfTabset(index) {\n        return index > tabs.length - 1;\n      }\n\n      function atBeginningOfTabset(index) {\n        return index <= 0;\n      }\n\n      if (tabs.length > nonSpecialTabs.length) {\n        if (pastEndOfTabset(targetIndex) && addTabButton && addTabButton.length) {\n          targetIndex -= 1;\n        }\n\n        if (atBeginningOfTabset(targetIndex) && appMenuTrigger && appMenuTrigger.length) {\n          targetIndex += 1;\n        }\n      }\n\n      const conditionInsertTabBefore = tabs.eq(targetIndex).length > 0;\n\n      finalIndex = conditionInsertTabBefore ? targetIndex : finalIndex;\n\n      method = 'insertAfter';\n      if (conditionInsertTabBefore) {\n        method = 'insertBefore';\n      }\n\n      tabHeaderMarkup[method](tabs.eq(finalIndex));\n      tabContentMarkup.appendTo(self.container);\n    }\n\n    insertIntoTabset(this, atIndex);\n\n    // Add each new part to their respective collections.\n    this.panels = this.panels.add(tabContentMarkup);\n    this.anchors = this.anchors.add(anchorMarkup);\n\n    // Link the two items via data()\n    anchorMarkup.data('panel-link', tabContentMarkup);\n    tabContentMarkup.data('tab-link', anchorMarkup);\n    // TODO: When Dropdown Tabs can be added/removed, add that here\n\n    // Make it possible for Module Tabs to display a tooltip containing their contents\n    // if the contents are cut off by ellipsis.\n    if (this.settings.moduleTabsTooltips) {\n      anchorMarkup.on('beforeshow.toolbar', () => anchorMarkup.data('cutoffTitle') === 'yes').tooltip({\n        content: `${anchorMarkup.text().trim()}`\n      });\n    }\n\n    // Recalc tab width before detection of overflow\n    if (this.isModuleTabs()) {\n      this.adjustModuleTabs();\n    }\n\n    // Adjust tablist height\n    this.setOverflow();\n\n    // If started from zero, position the focus state/bar and activate the tab\n    if (startFromZero) {\n      this.positionFocusState(anchorMarkup);\n      this.focusBar(tabHeaderMarkup);\n      if (!this.activate(anchorMarkup.attr('href'))) {\n        return this;\n      }\n      anchorMarkup.focus();\n    }\n\n    if (options.doActivate) {\n      this.activate(anchorMarkup.attr('href'));\n    }\n\n    return this;\n  },\n\n  /**\n   * Removes a tab from the list and cleans up properly\n   * NOTE: Does not take advantage of _activatePreviousTab()_ due to specific needs\n   * of selecting certain Tabs/Anchors at certain times.\n   * @param {string} tabId tab ID that corresponds to a `.tab-panel` element's ID attribute\n   * @param {boolean} disableBeforeClose whether or not tab closing can become veteoed\n   * @returns {boolean|this} component instance\n   */\n  remove(tabId, disableBeforeClose) {\n    const self = this;\n    const targetLi = this.doGetTab(null, tabId);\n\n    if (!targetLi || !targetLi.length) {\n      return false;\n    }\n\n    const targetAnchor = targetLi.children('a');\n    const targetPanel = this.getPanel(tabId);\n    const hasTargetPanel = (targetPanel && targetPanel.length);\n    const targetLiIndex = this.tablist.children('li').index(targetLi);\n    const notATab = '.application-menu-trigger, .separator, .is-disabled, :hidden';\n    let prevLi = targetLi.prev();\n\n    if (!disableBeforeClose) {\n      const canClose = this.element.triggerHandler('beforeclose', [targetLi]);\n      if (canClose === false) {\n        return false;\n      }\n    }\n\n    let wasSelected = false;\n    if (targetLi.hasClass('is-selected')) {\n      wasSelected = true;\n    } else {\n      prevLi = this.tablist.children('li').not(notATab).filter('.is-selected');\n    }\n\n    // Remove these from the collections\n    if (hasTargetPanel) {\n      this.panels = this.panels.not(targetPanel);\n    }\n    this.anchors = this.anchors.not(targetAnchor);\n\n    // Destroy Anchor tooltips, if applicable\n    if (this.settings.moduleTabsTooltips) {\n      targetAnchor.off('beforeshow.toolbar').data('tooltip').destroy();\n    }\n\n    // Close Dropdown Tabs in a clean fashion\n    const popupAPI = targetLi.data('popupmenu');\n    if (targetLi.hasClass('has-popupmenu')) {\n      if (popupAPI) {\n        popupAPI.menu.children('li').each(function () {\n          self.remove($(this).children('a').attr('href'));\n        });\n        popupAPI.destroy();\n      }\n    }\n\n    // If this tab is inside of a Dropdown Tab's menu, detect if it was the last one\n    // remaining, and if so, close the entire Dropdown Tab.\n    // The actual check on these elements needs to be done AFTER the targetLi is removed\n    // from a Dropdown Tab, to accurately check the number of list items remaining.\n    // See: _isLastDropdownTabItem()_\n    const parentMenu = targetLi.closest('.dropdown-tab');\n    const trigger = parentMenu.data('trigger');\n\n    // Kill associated events\n    targetLi.off('click.tabs');\n    targetAnchor.off('click.tabs focus.tabs keydown.tabs');\n\n    // Remove Markup\n    targetLi.remove();\n    if (hasTargetPanel) {\n      targetPanel.remove();\n    }\n\n    const menuItem = targetAnchor.data('moremenu-link');\n    if (menuItem) {\n      menuItem.parent().off().remove();\n      $.removeData(targetAnchor[0], 'moremenu-link');\n    }\n\n    function isLastDropdownTabItem(menu) {\n      return menu.length && menu.children('li:not(.separator)').length === 0;\n    }\n    if (isLastDropdownTabItem(parentMenu)) {\n      prevLi = this.getPreviousTab(trigger);\n\n      setTimeout(() => {\n        self.remove(trigger);\n      }, 1);\n    }\n\n    // Close dropdown tab's menu\n    if (trigger && trigger.length) {\n      trigger.data('popupmenu').close();\n    }\n\n    // Recalc tab width before detection of overflow\n    if (this.isModuleTabs()) {\n      this.adjustModuleTabs();\n    }\n\n    // Adjust tablist height\n    this.setOverflow();\n\n    /**\n     * Fires when a tab is removed from the tabset\n     *\n     * @event close\n     * @memberof Tabs\n     * @param {jQuery.Event} e event object\n     * @param {jQuery} targetLi the tab list item being closed\n     */\n    this.element.trigger('close', [targetLi]);\n\n    // If any tabs are left in the list, set the first available tab as the currently selected one.\n    let count = targetLiIndex - 1;\n    while (count > -1) {\n      count = -1;\n      if (prevLi.is(notATab)) {\n        prevLi = this.tablist.children('li').not(notATab)[0];\n        count -= 1;\n      }\n    }\n\n    // If we find nothing, search for ANY available tab\n    if (!prevLi.length) {\n      prevLi = this.tablist.children('li').not(notATab).first();\n    }\n\n    // If there's really nothing, kick on out and defocus everything.\n    if (!prevLi.length) {\n      this.hideFocusState();\n      this.defocusBar();\n\n      this.element.trigger('afterclose', [targetLi]);\n      return this;\n    }\n\n    const a = prevLi.children('a');\n    let activateTargetA = a;\n\n    this.positionFocusState(a);\n\n    if (wasSelected) {\n      if (prevLi.is('.has-popupmenu') && prevLi.data('popupmenu')) {\n        activateTargetA = prevLi.data('popupmenu').menu.children().first().children('a');\n      }\n      if (!this.activate(activateTargetA.attr('href'))) {\n        return this;\n      }\n    }\n\n    this.focusBar(prevLi);\n    a.focus();\n\n    /**\n     * Fires after a tab is completely removed from the tabset, and the close process has completed.\n     *\n     * @event afterclose\n     * @memberof Tabs\n     * @param {jQuery.Event} e event object\n     * @param {jQuery} targetLi the tab list item being closed\n     */\n    this.element.trigger('afterclose', [targetLi]);\n\n    return this;\n  },\n\n  /**\n   * Adds a new tab into the list and properly binds all of its events\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @param {string} [content] representing HTML markup that will be added inside of the new tab panel.\n   * @param {boolean} [doInsert=false] if true, actually appends the new content to the tab panel.\n   * @returns {this} component instance\n   */\n  createTabPanel(tabId, content, doInsert) {\n    tabId = tabId.replace(/#/g, '');\n\n    // If a jQuery-wrapped element is provided, actually append the element.\n    // If content is text/string, simply inline it.\n    const markup = $(`<div id=\"${xssUtils.stripTags(tabId)}\" class=\"tab-panel\" role=\"tabpanel\"></div>`);\n    // if (content instanceof $) {\n    //   content = content[0];\n    // }\n    // DOM.html(markup[0], content || '', '*');\n\n    markup.append(content);\n\n    if (doInsert === true) {\n      this.container.append(markup);\n    }\n\n    this.panels = this.panels.add(markup);\n\n    return markup;\n  },\n\n  /**\n   * @param {jQuery} tab the tab to be checked for popupmenu items.\n   * @returns {jQuery[]} a list of avaiable popupmenu items\n   */\n  checkPopupMenuItems(tab) {\n    function getRemainingMenuItems(popupAPI) {\n      if (!popupAPI || !popupAPI.menu) {\n        return $();\n      }\n      const menu = popupAPI.menu;\n      const items = menu.children('li');\n\n      if (!items.length) {\n        popupAPI.destroy();\n        return $();\n      }\n      return items;\n    }\n\n    if (tab.is('.has-popupmenu')) {\n      return getRemainingMenuItems(tab.data('popupmenu'));\n    }\n\n    const ddTab = tab.closest('.dropdown-tab');\n    if (!ddTab.length) {\n      return $();\n    }\n    return getRemainingMenuItems(ddTab.data('popupmenu'));\n  },\n\n  // @private\n  getTab(e, tabId) {\n    const self = this;\n    const tab = $();\n\n    function getTabFromEvent(ev) {\n      const t = $(ev.currentTarget);\n      if (t.is('.tab')) {\n        return t;\n      }\n      if (t.closest('.tab').length) {\n        return t.closest('.tab').first();\n      }\n      return null;\n    }\n\n    function getTabFromId(id) {\n      if (!id || id === '' || id === '#') {\n        return null;\n      }\n\n      if (id.indexOf('#') === -1) {\n        id = `#${id}`;\n      }\n\n      const anchor = self.anchors.filter(`[href=\"${id}\"]`);\n      if (!anchor.length) {\n        return null;\n      }\n\n      return anchor.parent();\n    }\n\n    // TabId can also be a jQuery object containing a tab.\n    if (tabId instanceof $ && tabId.length > 0) {\n      if (tabId.is('a')) {\n        return tabId.parent();\n      }\n      return tabId;\n    }\n\n    if (e) {\n      return getTabFromEvent(e);\n    } else if (tabId) {\n      return getTabFromId(tabId);\n    }\n\n    return tab;\n  },\n\n  // @private\n  doGetTab(e, tabId) {\n    if (!e && !tabId) { return $(); }\n    if (e && !(e instanceof $.Event) && typeof e !== 'string') {\n      return $();\n    }\n\n    if (e) {\n      if (typeof e !== 'string') { // jQuery Event\n        return this.getTab(e);\n      }\n      return this.getTab(null, e); // String containing a selector\n    }\n\n    // Straight to the TabID\n    return this.getTab(null, tabId);\n  },\n\n  /**\n   * Hides a tab\n   * @param {jQuery.Event} e the jQuery Event\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @returns {this} component instance\n   */\n  hide(e, tabId) {\n    const tab = this.doGetTab(e, tabId);\n\n    this.activateAdjacentTab(e, tabId);\n\n    tab.addClass('hidden');\n    this.focusBar();\n    this.positionFocusState();\n    return this;\n  },\n\n  /**\n   * Shows a tab\n   * @param {jQuery.Event} e the jQuery Event\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @returns {this} component instance\n   */\n  show(e, tabId) {\n    const tab = this.doGetTab(e, tabId);\n\n    tab.removeClass('hidden');\n\n    this.select($(this.element.find('li.tab.is-selected')[0]).find('a')[0].hash);\n\n    this.focusBar();\n    this.positionFocusState();\n    return this;\n  },\n\n  /**\n   * Disables an individual tab\n   * @param {jQuery.Event} e the jQuery Event\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @returns {this} component instance\n   */\n  disableTab(e, tabId) {\n    const tab = this.doGetTab(e, tabId);\n\n    this.activateAdjacentTab(e, tabId);\n\n    tab.addClass('is-disabled');\n    this.focusBar();\n    this.positionFocusState();\n    return this;\n  },\n\n  /**\n   * Enables an individual tab\n   * @param {jQuery.Event} e the jQuery Event\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @returns {this} component instance\n   */\n  enableTab(e, tabId) {\n    const tab = this.doGetTab(e, tabId);\n\n    tab.removeClass('is-disabled');\n    this.focusBar();\n    this.positionFocusState();\n    return this;\n  },\n\n  /**\n   * Renames a tab and resets the focusable bar/animation.\n   * @param {jQuery.Event} e the jQuery Event\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @param {string} name the new tab name\n   * @returns {void}\n   */\n  rename(e, tabId, name) {\n    // Backwards compatibility with 4.2.0\n    if (e && typeof e === 'string') {\n      name = tabId;\n      tabId = e;\n    }\n\n    if (!name) {\n      return;\n    }\n\n    const tab = this.doGetTab(e, tabId);\n    const hasCounts = this.settings.tabCounts;\n    const hasTooltip = this.settings.moduleTabsTooltips;\n    const anchor = tab.children('a');\n    let count;\n\n    if (hasCounts) {\n      count = anchor.find('.count').clone();\n    }\n\n    anchor.text(name.toString());\n\n    if (hasCounts) {\n      anchor.prepend(count);\n    }\n\n    if (hasTooltip) {\n      anchor.data('tooltip').setContent(name.trim());\n    }\n\n    const doesTabExist = this.tablist.children('li').length < 2 ? tab : undefined;\n\n    this.positionFocusState(doesTabExist);\n    this.focusBar(doesTabExist);\n  },\n\n  /**\n   * For tabs with counts, updates the count and resets the focusable bar/animation\n   * @param {jQuery.Event} e the jQuery Event\n   * @param {string} tabId a string representing the HTML `id` attribute of the new tab panel.\n   * @param {number|string} count the new tab count\n   * @returns {void}\n   */\n  updateCount(e, tabId, count) {\n    // Backwards compatibility with 4.2.0\n    if (e && typeof e === 'string') {\n      count = tabId;\n      tabId = e;\n    }\n\n    if (!this.settings.tabCounts || !count) {\n      return;\n    }\n\n    const tab = this.doGetTab(e, tabId);\n\n    tab.children('a').find('.count').text(`${count.toString()} `);\n\n    const doesTabExist = this.tablist.children('li').length < 2 ? tab : undefined;\n\n    this.positionFocusState(doesTabExist);\n    this.focusBar(doesTabExist);\n  },\n\n  /**\n   * returns the currently active tab\n   * @returns {jQuery} the currently active tab anchor\n   */\n  getActiveTab() {\n    const visible = this.panels.filter(':visible');\n    return this.anchors.filter(`[href=\"#${visible.first().attr('id')}\"]`);\n  },\n\n  /**\n   * returns all visible tabs\n   * @returns {jQuery[]} all visible tabs\n   */\n  getVisibleTabs() {\n    const self = this;\n    let tabHash = $();\n\n    this.tablist.find('li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)')\n      .each(function tabOverflowIterator() {\n        const tab = $(this);\n\n        if (!self.isTabOverflowed(tab)) {\n          tabHash = tabHash.add(tab);\n        }\n      });\n\n    return tabHash;\n  },\n\n  /**\n   * returns a list of all tabs that are currently in the \"More...\" overflow menu.\n   * @returns {jQuery[]} all overflowed tabs\n   */\n  getOverflowTabs() {\n    const self = this;\n    let tabHash = $();\n\n    this.tablist.find('li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)')\n      .each(function tabOverflowIterator() {\n        const tab = $(this);\n\n        if (self.isTabOverflowed(tab)) {\n          tabHash = tabHash.add(tab);\n        }\n      });\n\n    return tabHash;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  setOverflow() {\n    const self = this;\n    const elem = this.element[0];\n    const tablist = this.tablist[0];\n    const HAS_MORE = 'has-more-button';\n    const hasMoreIndex = this.hasMoreButton();\n    const isScrollableTabs = this.isScrollableTabs();\n\n    function checkModuleTabs() {\n      if (self.isModuleTabs()) {\n        self.adjustModuleTabs();\n      }\n    }\n\n    // Recalc tab width before detection of overflow\n    checkModuleTabs();\n\n    let tablistStyle;\n    let tablistHeight;\n    let tablistContainerScrollWidth;\n    let tablistContainerWidth;\n    let overflowCondition;\n\n    if (isScrollableTabs) {\n      tablistContainerScrollWidth = this.tablistContainer[0].scrollWidth;\n      tablistContainerWidth = this.tablistContainer[0].offsetWidth;\n      overflowCondition = tablistContainerScrollWidth > tablistContainerWidth;\n    } else {\n      tablistStyle = window.getComputedStyle(tablist, null);\n      tablistHeight = parseInt(tablistStyle.getPropertyValue('height'), 10) + 1; // +1 to fix an IE bug\n      overflowCondition = tablist.scrollHeight > tablistHeight; // Normal tabs check the height\n    }\n\n    // Add \"has-more-button\" class if we need it, remove it if we don't\n    // Always display the more button on Scrollable Tabs\n    if (overflowCondition) {\n      if (!hasMoreIndex) {\n        elem.classList.add(HAS_MORE);\n        checkModuleTabs();\n      }\n    } else if (hasMoreIndex) {\n      elem.classList.remove(HAS_MORE);\n      checkModuleTabs();\n    }\n\n    this.adjustSpilloverNumber();\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  adjustModuleTabs() {\n    const self = this;\n    let sizeableTabs = this.tablist.find('li:not(.separator):not(.application-menu-trigger):not(:hidden)');\n    const appTrigger = this.tablist.find('.application-menu-trigger');\n    const hasAppTrigger = appTrigger.length > 0;\n    const tabContainerW = this.tablist.outerWidth();\n    const defaultTabSize = 120;\n    let visibleTabSize = 120;\n    const appTriggerSize = (hasAppTrigger ? appTrigger.outerWidth() : 0);\n\n    // Remove overflowed tabs\n    sizeableTabs.children('a').removeAttr('style');\n    sizeableTabs.removeAttr('style').each(function () {\n      const t = $(this);\n      if (self.isTabOverflowed(t)) {\n        sizeableTabs = sizeableTabs.not(t);\n      }\n    });\n\n    // Resize the more button to fit the entire space if no tabs can show\n    // Math: +101 is the padding of the <ul class=\"tab-list\"> element\n    if (!sizeableTabs.length) {\n      visibleTabSize = (tabContainerW - appTriggerSize + 101);\n      this.moreButton[0].style.width = `${visibleTabSize}px`;\n      return;\n    }\n    const anchorStyle = window.getComputedStyle(sizeableTabs.eq(0).children()[0]);\n    const anchorPadding = parseInt(anchorStyle.paddingLeft, 10) +\n      parseInt(anchorStyle.paddingRight, 10);\n\n    if (this.moreButton[0].hasAttribute('style')) {\n      this.moreButton[0].removeAttribute('style');\n    }\n\n    // Math explanation:\n    // Width of tab container - possible applcation menu trigger\n    // Divided by number of visible tabs\n    // (doesn't include app menu trigger which shouldn't change size).\n    // Minus one (for the left-side border of each tab)\n    visibleTabSize = ((tabContainerW - appTriggerSize) / sizeableTabs.length - 1);\n\n    if (visibleTabSize < defaultTabSize) {\n      visibleTabSize = defaultTabSize;\n    }\n\n    let a;\n    let prevWidth;\n    let cutoff = 'no';\n    const isSideBySide = this.element.closest('.side-by-side').length === 1;\n\n    for (let i = 0; i < sizeableTabs.length; i++) {\n      a = sizeableTabs.eq(i).children('a');\n      a[0].style.width = '';\n\n      if (this.settings.moduleTabsTooltips === true) {\n        cutoff = 'no';\n\n        prevWidth = parseInt(window.getComputedStyle(sizeableTabs[i]).width, 10);\n\n        if (prevWidth > (visibleTabSize - anchorPadding)) {\n          cutoff = 'yes';\n        }\n        a.data('cutoffTitle', cutoff);\n      }\n\n      let diff = 0;\n      if (env.os.name === 'ios' && env.devicespecs.isMobile && isSideBySide) {\n        diff = 25;\n      }\n      sizeableTabs[i].style.width = `${visibleTabSize - diff}px`;\n      a[0].style.width = `${visibleTabSize - diff}px`;\n    }\n\n    this.adjustSpilloverNumber();\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  adjustSpilloverNumber() {\n    const moreDiv = this.moreButton.find('.more-text');\n    const tabs = this.tablist.find('li:not(.separator):not(.hidden):not(.is-disabled):not(.application-menu-trigger)');\n    const overflowedTabs = this.getOverflowTabs();\n\n    if (tabs.length <= overflowedTabs.length) {\n      moreDiv.text(`${Locale.translate('Tabs')}`);\n    } else {\n      moreDiv.text(`${Locale.translate('More')}`);\n    }\n\n    let countDiv = this.moreButton.find('.count');\n    if (!countDiv.length) {\n      countDiv = $('<span class=\"count\"></span>');\n      this.moreButton.children('span').first().prepend(countDiv);\n    }\n\n    countDiv.text(`${overflowedTabs.length} `);\n  },\n\n  /**\n   * Selects a Tab\n   * @param {string} href a string representing the HTML `id` attribute of the new tab panel.\n   * @param {boolean} noFocus true to prevent focus.\n   * @returns {void}\n   */\n  select(href, noFocus) {\n    const modHref = href.replace(/#/g, '');\n    const anchor = this.getAnchor(modHref);\n\n    this.positionFocusState(undefined, false);\n    this.focusBar(anchor.parent());\n\n    if (!this.activate(anchor.attr('href'))) {\n      return;\n    }\n    this.changeHash(modHref);\n\n    if (!noFocus) {\n      anchor.focus();\n    }\n  },\n\n  /**\n   * Builds tab popupmenu\n   * @param {string} startingHref a string representing the HTML `href` attribute of the popupmenu item to be selected.\n   * @returns {void}\n   */\n  buildPopupMenu(startingHref) {\n    const self = this;\n    if (self.popupmenu) {\n      self.popupmenu.destroy();\n      $('#tab-container-popupmenu').off('focus.popupmenu').remove();\n      $(document).off('keydown.popupmenu');\n    }\n\n    // Build the new markup for the popupmenu if it doesn't exist.\n    // Reset it if it does exist.\n    let menuHtml = $('#tab-container-popupmenu');\n    let shouldBeSelectable = '';\n    if (this.isScrollableTabs()) {\n      shouldBeSelectable = ' is-selectable';\n    }\n\n    if (menuHtml.length === 0) {\n      menuHtml = $(`<ul id=\"tab-container-popupmenu\" class=\"tab-list-spillover${shouldBeSelectable}\">`).appendTo('body');\n    } else {\n      menuHtml.html('');\n    }\n\n    // Build menu options from overflowed tabs\n    const tabs = self.tablist.children('li');\n    const isRTL = Locale.isRTL();\n\n    function buildMenuItem(item) {\n      const $item = $(item);\n      const $itemA = $item.children('a');\n\n      if ($item.is(':hidden')) {\n        return;\n      }\n\n      if (!self.isScrollableTabs() && !self.isTabOverflowed($item)) {\n        return;\n      }\n\n      if ($item.is('.separator')) {\n        $item.clone().appendTo(menuHtml);\n        return;\n      }\n\n      const popupLi = $item.clone();\n      const popupA = popupLi.children('a');\n\n      popupLi[0].classList.remove('tab');\n      if (popupLi[0].classList.contains('is-selected')) {\n        popupLi[0].classList.remove('is-selected');\n        if (self.isScrollableTabs()) {\n          popupLi[0].classList.add('is-checked');\n        }\n      }\n\n      popupLi[0].removeAttribute('style');\n\n      popupLi.children('.icon').off().appendTo(popupA);\n      popupLi.appendTo(menuHtml);\n\n      // Link tab to its corresponding \"More Tabs\" menu option\n      $item.data('moremenu-link', popupA);\n      popupA.find('.icon-more').remove();\n\n      // Link \"More Tabs\" menu option to its corresponding Tab.\n      // Remove onclick methods from the popup <li> because they are called\n      // on the \"select\" event in context of the original button\n      popupA.data('original-tab', $itemA);\n      popupA.onclick = undefined;\n\n      if (!$item.is('.has-popupmenu')) {\n        return;\n      }\n\n      // If this is a Dropdown Tab, clone its menu and add it to the \"More Tabs\" menu\n      // As a submenu of the \"popupLi\".\n      const submenu = $(`#${item.getAttribute('aria-controls')}`);\n      const clone = submenu.clone();\n      const cloneLis = clone.children('li');\n\n      clone[0].classList.remove('has-popupmenu');\n\n      cloneLis.each(function (i) {\n        const li = $(this);\n        const a = li.children('a');\n        const originalLi = submenu.children('li').eq(i);\n        const originalA = originalLi.children('a');\n\n        a.data('original-tab', originalA);\n        originalA.data('moremenu-link', a);\n      });\n\n      clone.insertAfter(popupA);\n    }\n\n    // Build spillover menu options\n    for (let i = 0; i < tabs.length; i++) {\n      buildMenuItem(tabs[i]);\n    }\n\n    self.tablist.children('li:not(.separator)').removeClass('is-focused');\n    let xOffset = 1;\n    if (!this.isScrollableTabs()) {\n      xOffset = 3;\n    }\n\n    // Invoke the popup menu on the button.\n    self.moreButton.popupmenu({\n      autoFocus: false,\n      attachToBody: true,\n      menu: 'tab-container-popupmenu',\n      trigger: 'immediate',\n      offset: { x: xOffset }\n    });\n    self.moreButton.addClass('popup-is-open');\n    self.popupmenu = self.moreButton.data('popupmenu');\n\n    self.positionFocusState(self.moreButton);\n\n    function closeMenu() {\n      $(this).off('close.tabs selected.tabs');\n      self.moreButton.removeClass('popup-is-open');\n      self.positionFocusState(undefined);\n      self.focusBar();\n    }\n\n    function selectMenuOption(e, anchor) {\n      let href = anchor.attr('href');\n      const id = href.substr(1, href.length);\n      const tab = self.doGetTab(id) || $();\n      let a = tab ? tab.children('a') : $();\n      let originalTab = anchor.data('original-tab').parent();\n\n      if (originalTab.is('.add-tab-button')) {\n        a = self.handleAddButton();\n        originalTab = a.parent();\n        href = a.attr('href');\n        self.element.trigger('tab-added', [a]);\n      }\n\n      self.activate(href);\n\n      // Fire an onclick event associated with the original tab from the spillover menu\n      if (tab.length && a.length && typeof a[0].onclick === 'function') {\n        a[0].onclick.apply(a[0]);\n      }\n\n      // Focus the More Button\n      // NOTE: If we switch the focusing-operations back to how they used to be\n      // (blue bar moving around with the focus state)\n      // remove the line below.\n      self.moreButton.focus();\n\n      self.scrollTabList(tab);\n    }\n\n    self.moreButton\n      .on('close.tabs', closeMenu)\n      .on('selected.tabs', selectMenuOption);\n\n    const menu = self.popupmenu.menu;\n\n    function handleDestroy() {\n      menu.off();\n      self.hideFocusState();\n      $('#tab-container-popupmenu').remove();\n    }\n\n    function handleDismissibleIconClick(e) {\n      const icon = $(this);\n      const li = icon.closest('li');\n\n      if (!li.is('.dismissible') || !icon.is('.close')) {\n        return;\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (li.is('.dismissible') && li.is('.has-popupmenu') && li.is('.submenu')) {\n        const listMenu = li.find('.wrapper').children().children();\n        const hrefs = [];\n        $.each(listMenu, (i, item) => {\n          hrefs.push(item.children[0].href);\n        });\n        self.closeDismissibleTabs(hrefs);\n      } else {\n        self.closeDismissibleTab(li.children('a').attr('href'));\n      }\n      self.popupmenu.close();\n    }\n\n    menu\n      .on('destroy.popupmenu', handleDestroy)\n      .on('touchend.popupmenu touchcancel.popupmenu', '.icon', handleDismissibleIconClick)\n      .on('click.popupmenu', '.icon', handleDismissibleIconClick);\n\n    // If the optional startingIndex is provided, focus the popupmenu on the matching item.\n    // Otherwise, focus the first item in the list.\n    if (startingHref) {\n      self.popupmenu.highlight(menu.find(`a[href=\"${startingHref}\"]`));\n    } else if (self.tablist.children('.is-selected').length > 0) {\n      self.popupmenu.highlight(menu.find(`a[href=\"${self.tablist.children('.is-selected').children('a').attr('href')}\"]`));\n    } else {\n      self.popupmenu.highlight(menu.find('li:first-child > a'));\n    }\n\n    // Overrides a similar method in the popupmenu code that controls escaping of\n    // this menu when pressing certain keys.  We override this here so that the\n    // controls act in a manner as if all tabs are still visible (for accessiblity\n    // reasons), meaning you can use left and right to navigate the popup menu options\n    // as if they were tabs.\n    $(document).bindFirst('keydown.popupmenu', (e) => {\n      const key = e.which;\n      const currentMenuItem = $(e.target);\n\n      function isFocusedElement() {\n        return this === document.activeElement;\n      }\n\n      function prevMenuItem() {\n        // If the first item in the popup menu is already focused, close the menu and focus\n        // on the last visible item in the tabs list.\n        const first = menu.find('li:first-child > a');\n        if (first.filter(isFocusedElement).length > 0) {\n          e.preventDefault();\n          $(document).off(e);\n          self.popupmenu.close();\n          self.findLastVisibleTab();\n        }\n      }\n\n      function nextMenuItem() {\n        // If the last item in the popup menu is already focused, close the menu and focus\n        // on the first visible item in the tabs list.\n        const last = menu.find('li:last-child > a');\n        if (last.filter(isFocusedElement).length > 0 && last.parent().is(':not(.submenu)')) {\n          e.preventDefault();\n          $(document).off(e);\n          self.popupmenu.close();\n\n          if (self.settings.addTabButton) {\n            self.addTabButton.focus();\n            return;\n          }\n          self.focusFirstVisibleTab();\n        }\n      }\n\n      // Alt+Del or Alt+Backspace closes a dropdown tab item\n      function closeDropdownMenuItem() {\n        if (!e.altKey || !currentMenuItem.parent().is('.dismissible')) {\n          return;\n        }\n        // self.popupmenu.close();\n        self.closeDismissibleTab(currentMenuItem.attr('href'));\n      }\n\n      let pseudoKeycode;\n\n      switch (key) {\n        case 8:\n        case 46:\n          closeDropdownMenuItem(e);\n          break;\n        case 37: // left\n          pseudoKeycode = isRTL ? 40 : 38;\n          if (currentMenuItem.is('a')) {\n            if (currentMenuItem.parent().is(':not(:first-child)')) {\n              e.preventDefault(); // Prevent popupmenu from closing on left key\n            }\n            $(document).trigger({ type: 'keydown.popupmenu', which: pseudoKeycode });\n          }\n          break;\n        case 38: // up\n          prevMenuItem();\n          break;\n        case 39: // right\n          pseudoKeycode = isRTL ? 38 : 40;\n          if (currentMenuItem.is('a') && !currentMenuItem.parent('.submenu').length) {\n            $(document).trigger({ type: 'keydown.popupmenu', which: pseudoKeycode });\n          }\n          break;\n        case 40: // down\n          nextMenuItem();\n          break;\n        default:\n          break;\n      }\n    });\n  },\n\n  /**\n   * Used for checking if a particular tab (in the form of a jquery-wrapped list item)\n   * is spilled into the overflow area of the tablist container <UL>.\n   * @param {jQuery} li tab list item\n   * @returns {boolean} whether or not the tab is overflowed.\n   */\n  isTabOverflowed(li) {\n    if (this.isVerticalTabs() || this.isScrollableTabs()) {\n      return false;\n    }\n\n    if (this.tablist.scrollTop() > 0) {\n      this.tablist.scrollTop(0);\n    }\n\n    const liTop = Math.round(li[0].getBoundingClientRect().top);\n    let tablistTop = Math.round(this.tablist[0].getBoundingClientRect().top + 1);\n\n    // +1 to compensate for top border on Module Tabs\n    if (this.isModuleTabs()) {\n      tablistTop += 1;\n    }\n\n    return liTop > tablistTop;\n  },\n\n  /**\n   * @returns {jQuery} representing the last visible tab.\n   */\n  findLastVisibleTab() {\n    const tabs = this.tablist.children('li:not(.separator):not(.hidden):not(.is-disabled)');\n    let targetFocus = tabs.first();\n\n    // if Scrollable Tabs, simply get the last tab and focus.\n    if (this.isScrollableTabs()) {\n      return tabs.last().find('a').focus();\n    }\n\n    while (!(this.isTabOverflowed(targetFocus))) {\n      targetFocus = tabs.eq(tabs.index(targetFocus) + 1);\n    }\n\n    return tabs.eq(tabs.index(targetFocus) - 1).find('a').focus();\n  },\n\n  /**\n   * @returns {void}\n   */\n  focusFirstVisibleTab() {\n    const tabs = this.tablist.children('li:not(.separator):not(.hidden):not(.is-disabled)');\n    tabs.eq(0).find('a').focus();\n  },\n\n  /**\n   * Moves the animated \"selected\" state bar to a new tab\n   * @param {jQuery} li the new tab list item\n   * @param {function} callback fires after the animation is completed.\n   * @returns {void}\n   */\n  focusBar(li, callback) {\n    if (!this.hasAnimatedBar()) {\n      return;\n    }\n\n    if (!(li instanceof $) || !li.length) {\n      return;\n    }\n\n    const self = this;\n    const target = li;\n    const scrollingTablist = this.tablistContainer;\n    const isRTL = Locale.isRTL();\n    let tablistScrollWidth;\n    let tablistScrollLeft;\n    let anchorStyle;\n\n    this.animatedBar.removeClass('no-transition');\n\n    if (!target || target === undefined || !target.length || !self.anchors.length) {\n      this.animatedBar.removeClass('visible');\n      return;\n    }\n\n    const targetStyle = window.getComputedStyle(target[0], null);\n    let paddingRight = parseInt(targetStyle.getPropertyValue('padding-right'), 10) || 0;\n    const width = parseInt(targetStyle.getPropertyValue('width'), 10) || 0;\n\n    if (target.is('.tab')) {\n      anchorStyle = window.getComputedStyle(target.children('a')[0]);\n      paddingRight += parseInt(anchorStyle.getPropertyValue('padding-right'), 10) || 0;\n    }\n\n    const left = isRTL ?\n      (paddingRight + target.position().left + target.outerWidth(true)) : (target.position().left);\n\n    clearTimeout(self.animationTimeout);\n    this.animatedBar.addClass('visible');\n\n    function animationTimeout(cb) {\n      const style = self.animatedBar[0].style;\n      tablistScrollLeft = scrollingTablist[0].scrollLeft;\n      tablistScrollWidth = scrollingTablist[0].scrollWidth;\n\n      if (isRTL) {\n        style.right = `${tablistScrollWidth + paddingRight - (left + tablistScrollLeft)}px`;\n      } else {\n        style.left = `${left + tablistScrollLeft}px`;\n      }\n      style.width = `${width}px`;\n\n      if (cb && typeof cb === 'function') {\n        cb();\n      }\n    }\n\n    animationTimeout(callback);\n  },\n\n  /**\n   * Clears the animated \"selected\" state bar away.\n   * @returns {void}\n   */\n  defocusBar() {\n    if (!this.hasAnimatedBar()) {\n      return;\n    }\n\n    const self = this;\n    const left = Locale.isRTL() ? 0 :\n      (self.animatedBar.position().left + (self.animatedBar.outerWidth() / 2));\n\n    clearTimeout(self.animationTimeout);\n\n    this.animatedBar[0].style.left = `${left}px`;\n    this.animatedBar[0].style.width = 0;\n\n    this.animationTimeout = setTimeout(() => {\n      if (self.animatedBar && self.animatedBar.length) {\n        self.animatedBar.removeClass('visible').removeAttr('style');\n      }\n    }, 350);\n  },\n\n  /**\n   * Wrapper for the Soho behavior _smoothScrollTo()_ that will determine scroll distance.\n   * @param {jQuery[]} target - the target <li> or <a> tag\n   * @param {number} duration - the time it will take to scroll\n   * @returns {undefined}\n   */\n  scrollTabList(target) {\n    if (!this.tablistContainer || !target || !(target instanceof $) || !target.length) {\n      return;\n    }\n\n    const tabCoords = DOM.getDimensions(target[0]);\n    const tabContainerDims = DOM.getDimensions(this.tablistContainer[0]);\n    let d;\n\n    const FADED_AREA = 40; // the faded edges on the sides of the tabset\n    const adjustedLeft = tabCoords.left;\n    const adjustedRight = tabCoords.right;\n\n    if (adjustedLeft < tabContainerDims.left + FADED_AREA) {\n      d = (Math.round(Math.abs(tabContainerDims.left - adjustedLeft)) * -1) - FADED_AREA;\n    }\n    if (adjustedRight > tabContainerDims.right - FADED_AREA) {\n      d = Math.round(Math.abs(adjustedRight - tabContainerDims.right)) + FADED_AREA;\n    }\n\n    if (d === 0) {\n      d = undefined;\n    }\n\n    // Scroll the tablist container\n    this.tablistContainer.smoothScroll(d, 250);\n  },\n\n  /**\n   * Hides the focus state, if it's visible.\n   * @returns {void}\n   */\n  hideFocusState() {\n    this.focusState.removeClass('is-visible');\n  },\n\n  /**\n   * Updates the position of the focus state, to the tab/button that currently has focus.\n   * @param {jQuery[]|HTMLElement} target the element that will receive the focus state\n   * @param {boolean} [unhide] if true, unhides the focus state if it's previously been hidden.\n   * @returns {void}\n   */\n  positionFocusState(target, unhide) {\n    const self = this;\n\n    // TODO: Recheck this and improve\n    if (target !== undefined) {\n      target = $(target);\n    } else if (self.moreButton.hasClass('is-selected')) {\n      target = self.moreButton;\n    } else if (self.tablist.children('.is-selected').length > 0) {\n      target = self.tablist.children('.is-selected').children('a');\n    }\n\n    /*\n    NOTE: this used to replace the code directly above\n    target = target !== undefined ? $(target) :\n      self.moreButton.hasClass('is-selected') ? self.moreButton :\n      self.tablist.children('.is-selected').length > 0 ?\n      self.tablist.children('.is-selected').children('a') : undefined;\n    */\n\n    if (!target || target === undefined || !target.length ||\n      (target.is(this.moreButton) && this.isScrollableTabs())) {\n      this.focusState.removeClass('is-visible');\n      return;\n    }\n\n    // Use the parent <li> for anchors to get their dimensions.\n    if (target.is('a')) {\n      target = target.parent();\n    }\n\n    // Move the focus state from inside the tab list container, if applicable.\n    // Put it back into the tab list container, if not.\n    if (target.is('.add-tab-button, .tab-more')) {\n      if (!this.focusState.parent().is(this.element)) {\n        this.focusState.prependTo(this.element);\n      }\n    } else if (!this.focusState.parent().is(this.tablistContainer)) {\n      this.focusState.prependTo(this.tablistContainer);\n    }\n\n    const focusStateElem = this.focusState[0];\n    let targetPos = DOM.getDimensions(target[0]);\n    const targetClassList = target[0].classList;\n    const isNotHeaderTabs = (!this.isHeaderTabs() || this.isHeaderTabs() && this.element[0].classList.contains('alternate'));\n    const isVerticalTabs = this.isVerticalTabs();\n    const isRTL = Locale.isRTL();\n    const tabMoreWidth = !isVerticalTabs ? this.moreButton.outerWidth(true) : 0;\n    const parentContainer = this.element;\n    const scrollingTablist = this.tablistContainer;\n    const accountForPadding = scrollingTablist && this.focusState.parent().is(scrollingTablist);\n\n    function adjustForParentContainer(targetRectObj, parentElement, tablistContainer) {\n      const parentRect = parentElement[0].getBoundingClientRect();\n      let parentPadding;\n      let tabLeftMargin;\n      let tablistScrollWidth;\n      let tablistScrollLeft;\n\n      // Adjust from the top\n      targetRectObj.top -= parentRect.top;\n      if (isVerticalTabs) {\n        targetRectObj.top += parentElement[0].scrollTop;\n      }\n\n      if (isRTL) {\n        targetRectObj.right = parentRect.right - targetRectObj.right;\n      } else {\n        targetRectObj.left -= parentRect.left;\n      }\n\n      // If inside a scrollable tablist, account for the scroll position\n      if (tablistContainer) {\n        tablistScrollLeft = tablistContainer ? tablistContainer[0].scrollLeft : 0;\n        tablistScrollWidth = tablistContainer ? tablistContainer[0].scrollWidth : 0;\n\n        if (isRTL && !isVerticalTabs) {\n          // TODO: Improve this calculation because there's something off\n          const tmpLeft = targetRectObj.left;\n          if (isNotHeaderTabs) {\n            tabLeftMargin = parseInt(window.getComputedStyle(target[0]).marginLeft, 10);\n            targetRectObj.left = tablistScrollWidth - tabLeftMargin -\n              targetRectObj.right + tablistScrollLeft;\n            targetRectObj.right = tablistScrollWidth - tabLeftMargin - tmpLeft + tablistScrollLeft;\n          } else {\n            targetRectObj.left = tablistScrollWidth -\n              (targetRectObj.right + tablistScrollLeft + (tabMoreWidth) + 32);\n            targetRectObj.right = tablistScrollWidth -\n              (tmpLeft + tablistScrollLeft + (tabMoreWidth) + 32);\n          }\n        } else {\n          targetRectObj.left += tablistScrollLeft;\n          targetRectObj.right += tablistScrollLeft;\n        }\n\n        if (accountForPadding) {\n          parentPadding = parseInt(window.getComputedStyle(parentElement[0])[`padding${isRTL ? 'Right' : 'Left'}`], 10);\n          targetRectObj.left += (isRTL ? parentPadding : (parentPadding * -1));\n          targetRectObj.right += (isRTL ? parentPadding : (parentPadding * -1));\n        }\n      }\n\n      // Alternate Header Tabs have 1px removed from bottom to prevent overlap\n      // onto the bottom border\n      if (isNotHeaderTabs && !isVerticalTabs) {\n        targetRectObj.height -= 1;\n      }\n\n      return targetRectObj;\n    }\n\n    // Adjust the values one more time if we have tabs contained inside of a\n    // page-container, or some other scrollable container.\n    targetPos = adjustForParentContainer(targetPos, parentContainer, scrollingTablist);\n\n    // build CSS string containing each prop and set it:\n    let targetPosString = '';\n    Object.keys(targetPos).forEach((key) => {\n      if (targetPosString.length) {\n        targetPosString += ' ';\n      }\n      targetPosString += `${key}: ${targetPos[key]}px;`;\n    });\n    focusStateElem.style.cssText = targetPosString;\n\n    const selected = targetClassList.contains('is-selected') ? 'add' : 'remove';\n    focusStateElem.classList[selected]('is-selected');\n\n    const doHide = unhide === true ? 'add' : 'remove';\n    focusStateElem.classList[doHide]('is-visible');\n  },\n\n  /**\n   * Causes the entire tabset to reset with new settings.\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    return this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Disables all non-active tabs in the list\n   * @returns {void}\n   */\n  disableOtherTabs() {\n    return this.disable(true);\n  },\n\n  /**\n   * Disables the entire Tab Component\n   * @param {boolean} isPartial whether or not this disable call is a partial\n   *  disabling of the tabset\n   * @returns {void}\n   */\n  disable(isPartial) {\n    if (!isPartial) {\n      this.element.prop('disabled', true).addClass('is-disabled');\n    }\n\n    if (!this.disabledElems) {\n      this.disabledElems = [];\n    }\n\n    const self = this;\n    let tabs = this.tablist.children('li:not(.separator)');\n    if (isPartial) {\n      tabs = tabs.filter(':not(.application-menu-trigger)');\n    }\n\n    tabs.each(function () {\n      const li = $(this);\n      const a = li.children('a');\n\n      if (isPartial && self.isActive(a.attr('href'))) {\n        return;\n      }\n\n      if (li.is('.is-disabled') || a.prop('disabled') === true) {\n        self.disabledElems.push({\n          elem: li,\n          originalTabindex: li.attr('tabindex'),\n          originalDisabled: a.prop('disabled')\n        });\n      }\n\n      li.addClass('is-disabled');\n      a.prop('disabled', true);\n\n      if (li.is('.application-menu-trigger') || li.is('.add-tab-button')) {\n        return;\n      }\n\n      const panel = $(a.attr('href'));\n      panel.addClass('is-disabled');\n      panel.find('*').each(function () {\n        const t = $(this);\n\n        // These are shadow inputs.  They are already handled by virtue of running\n        // .disable() on the original select tag.\n        if (t.is('input.dropdown, input.multiselect')) {\n          return;\n        }\n\n        if (t.attr('tabindex') === '-1' || t.attr('disabled')) {\n          self.disabledElems.push({\n            elem: t,\n            originalTabindex: t.attr('tabindex'),\n            originalDisabled: t.prop('disabled')\n          });\n        }\n\n        t.disable();\n      });\n    });\n\n    this.moreButton.addClass('is-disabled');\n\n    if (this.isModuleTabs() && !isPartial) {\n      this.element.children('.toolbar').disable();\n    }\n\n    this.updateAria($());\n  },\n\n  /**\n   * Enables the entire Tabs component\n   * @returns {void}\n   */\n  enable() {\n    this.element.prop('disabled', false).removeClass('is-disabled');\n\n    const self = this;\n    const tabs = this.tablist.children('li:not(.separator)');\n\n    tabs.each(function () {\n      const li = $(this);\n      const a = li.children('a');\n\n      li.removeClass('is-disabled');\n      a.prop('disabled', false);\n\n      if (li.is('.application-menu-trigger') || li.is('.add-tab-button')) {\n        return;\n      }\n\n      const panel = $(a.attr('href'));\n      panel.removeClass('is-disabled');\n      panel.find('*').each(function () {\n        const t = $(this);\n        if (t.enable && typeof t.enable === 'function') {\n          t.enable();\n        }\n      });\n\n      $.each(self.disabledElems, (i, obj) => {\n        const attrTarget = obj.elem.is('.tab') ? obj.elem.children('a') : obj.elem;\n        if (obj.elem.disable && typeof obj.elem.disable === 'function') {\n          obj.elem.disable();\n        }\n\n        if (obj.elem.is('li')) {\n          obj.elem.addClass('is-disabled');\n          return;\n        }\n\n        // These are shadow inputs.  They are already handled by virtue of\n        // running .disable() on the original select tag.\n        if (obj.elem.is('input.dropdown, input.multiselect')) {\n          return;\n        }\n\n        obj.elem.attr('tabindex', obj.originalTabindex);\n        attrTarget.prop('disabled', obj.originalDisabled);\n      });\n    });\n\n    this.moreButton.removeClass('is-disabled');\n\n    if (this.isModuleTabs()) {\n      this.element.children('.toolbar').enable();\n    }\n\n    this.disabledElems = [];\n\n    this.updateAria(this.tablist.find('.is-selected > a'));\n  },\n\n  /**\n   * Pass-through for the `remove()` method, which gets used for removing a dismissible tab.\n   * @param {string} tabId the ID of the target tab panel\n   * @returns {this} component instance\n   */\n  closeDismissibleTab(tabId) {\n    return this.remove(tabId);\n  },\n\n  /**\n   * Remove top level dismissible tab with dropdown\n   * @param {array} tabUrlArray the Array of urls from the target popupmenu\n   */\n  closeDismissibleTabs(tabUrlArray) {\n    tabUrlArray.forEach((tabUrl) => {\n      const tabId = tabUrl.match(/#.*/);\n      return this.remove(tabId[0]);\n    });\n  },\n\n  /**\n   * Tears down this instance of the tabs component by removing events,\n   * other components, and extraneous markup.\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.panels.removeAttr('style');\n\n    this.tablist\n      .off()\n      .removeAttr('role')\n      .removeAttr('aria-multiselectable');\n\n    const tabs = this.tablist.children('li');\n    tabs\n      .off()\n      .removeAttr('role')\n      .removeClass('is-selected');\n\n    const dds = tabs.filter('.has-popupmenu');\n    dds.each(function () {\n      const popup = $(this).data('popupmenu');\n      if (popup) {\n        popup.menu.children('li:not(.separator)').each(function () {\n          const li = $(this);\n          const a = li.children('a');\n          const panel = a.data('panel-link');\n\n          $.removeData(a[0], 'panel-link');\n          if (panel && panel.length) {\n            $.removeData(panel[0], 'tab-link');\n          }\n        });\n        popup.destroy();\n      }\n    });\n\n    this.panels\n      .off();\n\n    this.anchors\n      .off()\n      .removeAttr('role')\n      .removeAttr('aria-expanded')\n      .removeAttr('aria-selected')\n      .removeAttr('tabindex');\n\n    if (this.settings.moduleTabsTooltips) {\n      this.anchors.each(function () {\n        const api = $(this).data('tooltip');\n        if (api && typeof api.destroy === 'function') {\n          api.destroy();\n        }\n      });\n    }\n\n    this.element.off('focusout.tabs updated.tabs activated.tabs');\n    $('body').off(`resize.tabs${this.tabsIndex}`);\n    this.tabsIndex = undefined;\n\n    if (this.moreButton.data('popupmenu')) {\n      const popup = this.moreButton.data('popupmenu');\n      popup.menu.find('li:not(.separator)').each(function () {\n        const li = $(this);\n        const a = li.children('a');\n\n        if (a.data('original-tab')) {\n          $.removeData(a[0], 'original-tab');\n        }\n      });\n      popup.destroy();\n    }\n\n    this.removeHelperMarkupEvents();\n\n    if (this.tablistContainer) {\n      this.tablistContainer.off('mousewheel.tabs');\n    }\n\n    this.focusState.remove();\n    this.focusState = undefined;\n\n    if (this.hasAnimatedBar()) {\n      this.animatedBar.remove();\n      this.animatedBar = undefined;\n    }\n    $('.tab-panel input').off('error.tabs valid.tabs');\n\n    return this;\n  },\n\n  /**\n   * Destroys this component instance, removing its attachment from its parent element.\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Tabs, COMPONENT_NAME };\n","import { Tabs, COMPONENT_NAME } from './tabs';\n\n/**\n * jQuery component wrapper for Tabs Component\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.tabs = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Tabs(this, settings));\n    }\n  });\n};\n\n// Deprecated the old Vertical Tabs code in favor of using the Tabs class.\n$.fn.verticaltabs = $.fn.tabs;\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Component Name\nconst COMPONENT_NAME = 'tag';\n\n// Default Tag Options\nconst TAG_DEFAULTS = {\n};\n\n/**\n* Implements functionality on tag objects, such as closing tabs.\n* @class Tag\n* @param {string} element The component element.\n* @param {string} settings The component settings.\n*/\nfunction Tag(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, TAG_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Tag Methods\nTag.prototype = {\n\n  init() {\n    this.element.hideFocus();\n    this.handleEvents();\n  },\n\n  /**\n   * Remove the tag from the DOM\n   * @private\n   * @param {object} event Type.\n   * @param {string} el The element.\n   * @returns {void}\n   */\n  remove(event, el) {\n    el = el instanceof jQuery ? el : $(el);\n    const parent = el.parent();\n\n    /**\n    * Fires before tag remove.\n    *\n    * @event beforetagremove\n    * @memberof Tag\n    * @type {object}\n    * @property {object} event - The jquery event object\n    * @property {object} The event used for removing and element\n    */\n    this.element.triggerHandler('beforetagremove', { event, element: el });\n    el.remove();\n\n    /**\n    * Fires after tag remove.\n    *\n    * @event aftertagremove\n    * @memberof Tag\n    * @type {object}\n    * @property {object} event - The jquery event object\n    */\n    parent.triggerHandler('aftertagremove', { event });\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.element.off('keydown.tag');\n    $('.dismissable-btn, .dismissible-btn', this.element).off('click.tag').remove();\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, TAG_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const btnDismissable = $('' +\n      `<span class=\"dismissible-btn\">\n        ${$.createIcon('close')}\n        <span class=\"audible\"> ${Locale.translate('Close')}</span>\n      </span>`);\n    const dismissibleClass = '.is-dismissable, .is-dismissible';\n\n    // EPC: Deprecating \"dismissable\" in favor of \"dismissible\" as of 4.3.0\n    if (self.element.is(dismissibleClass)) {\n      self.element.append(btnDismissable);\n\n      /**\n      * Fires when the tag is clicked (if enabled).\n      * @event click\n      * @memberof Tag\n      * @type {object}\n      * @property {object} event - The jquery event object\n      */\n      btnDismissable.on('click.tag', (event) => {\n        this.remove(event, this.element);\n      });\n\n      /**\n      * Fires when the tag is focused.\n      * @event keydown\n      * @memberof Tag\n      * @type {object}\n      * @property {object} event - The jquery event object\n      */\n      this.element.on('keydown.tag', function (event) {\n        const e = event || window.event;\n        if (e.keyCode === 8) { // Backspace\n          self.remove(event, this);\n        }\n      });\n    }\n  }\n};\n\nexport { Tag, COMPONENT_NAME };\n","import { Tag, COMPONENT_NAME } from './tag';\n\n// Initialize the plugin (Once)\n$.fn.tag = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Tag(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { xssUtils } from '../../utils/xss';\nimport { Locale } from '../locale/locale';\n\n// Name of this component\nconst COMPONENT_NAME = 'textarea';\n\n// Component Options\nconst TEXTAREA_DEFAULTS = {\n  autoGrow: false,\n  autoGrowAnimate: true,\n  autoGrowAnimateSpeed: 200,\n  autoGrowMaxHeight: null,\n  characterCounter: true,\n  maxLength: null,\n  printable: true,\n  charRemainingText: null,\n  charMaxText: null\n};\n\n/**\n* The Textarea Component wraps a standard HTML Textarea element and provides additional features.\n* @class Textarea\n* @param {object} element The component element.\n* @param {object} [settings] The component settings.\n* @param {boolean} [settings.autoGrow = false] Will automatically expand the textarea to fit the contents when typing.\n* @param {boolean} [settings.autoGrowAnimate  = true] Will animate the textarea grow.\n* @param {number} [settings.autoGrowAnimateSpeed = 200] The speed of the animation.\n* @param {number} [settings.autoGrowMaxHeight = null] The Max Height of the textarea when autoGrow is enabled.\n* @param {boolean} [settings.characterCounter = true] Displays a counter that counts down from the maximum.\n* @param {boolean} [settings.maxLength = number] Maximum characters allowed in textarea.\n* length allowed.\n* @param {boolean} [settings.printable = true] Determines whether or not the text area can be displayed on a\n* printed page.\n* @param {null|String} [settings.charRemainingText = 'Characters Left']  Text that will be used in place of the \"remaining\"\n* text defaulting to a localized 'Characters Left'.\n* @param {null|String} [settings.charMaxText = 'Character count maximum of']  Text that will be used in place of the \"Max\" text.\n* Defaults to a localized Version of 'Character count maximum of'.\n*/\nfunction Textarea(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, TEXTAREA_DEFAULTS);\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nTextarea.prototype = {\n\n  /**\n   * @private\n   */\n  init() {\n    this.isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\n    this.isSafari = (\n      navigator.userAgent.indexOf('Safari') !== -1 &&\n      navigator.userAgent.indexOf('Chrome') === -1 &&\n      navigator.userAgent.indexOf('Android') === -1\n    );\n\n    this.element.addClass(this.element.is('.textarea-xs') ? 'input-xs' : //eslint-disable-line\n      this.element.is('.textarea-sm') ? 'input-sm' : //eslint-disable-line\n        this.element.is('.textarea-lg') ? 'input-lg' : ''); //eslint-disable-line\n\n    if (this.settings.characterCounter && this.getMaxLength()) {\n      this.counter = $('<span class=\"textarea-wordcount\">Chars Left..</span>').insertAfter(this.element);\n    }\n    if (this.settings.printable) {\n      this.printarea = $('<span class=\"textarea-print\"></span>').insertBefore(this.element);\n    }\n\n    if (this.element.hasClass('autogrow')) {\n      this.settings.autoGrow = true;\n    }\n\n    if (this.settings.autoGrow && this.element.length) {\n      this.element.css('overflow', 'hidden');\n      this.handleResize(this);\n    }\n\n    this.handleEvents();\n    this.updateCounter();\n  },\n\n  /**\n   * Determines if the text is selected.\n   * @private\n   * @param  {object}  input The input dom element (jQuery)\n   * @returns {boolean} True if the text is selected in the input.\n   */\n  isSelected(input) {\n    if (typeof input.selectionStart === 'number') {\n      return input.selectionStart === 0 && input.selectionEnd === input.value.length;\n    } else if (typeof document.selection !== 'undefined') {\n      return document.selection.createRange().text === input.value;\n    }\n    return false;\n  },\n\n  /**\n   * Checks a keycode value and determines if it belongs to a printable character.\n   * @private\n   * @param {number} keycode - a number representing an ASCII keycode value\n   * @param {boolean} shiftKey - a boolean set to true if shift key is being pressed\n   * @returns {boolean} Returns true if the key is a printable one.\n   */\n  isPrintable(keycode, shiftKey) {\n    // (keycode > 47 && keycode < 58) || // number keys\n    // (keycode > 64 && keycode < 91) || // letter keys\n    // (keycode > 95 && keycode < 112) || // numpad keys\n    // (keycode > 185 && keycode < 193) || // ;=,-./` (in order)\n    // (keycode > 218 && keycode < 223); // [\\]' (in order)\n\n    let valid = false;\n\n    if (shiftKey) {\n      valid =\n        (keycode > 64 && keycode < 91) || // letter keys\n        (keycode >= 33 && keycode <= 38) ||\n        (keycode >= 40 && keycode <= 43) ||\n        (keycode === 126 || keycode === 58 || keycode === 60) ||\n        (keycode >= 123 && keycode <= 125) ||\n        (keycode === 94 || keycode === 95) ||\n        (keycode >= 62 && keycode <= 64);\n    } else {\n      valid =\n        keycode === 13 || // enter key\n        (keycode >= 48 && keycode <= 57) || // number keys\n        (keycode >= 97 && keycode <= 122) || // letter keys\n        (keycode === 59 || keycode === 61 ||\n        (keycode >= 44 && keycode <= 47) || keycode === 96) || // ;=,-./` (in order)\n        (keycode >= 91 && keycode <= 93) || keycode === 39; // [\\]' (in order)\n    }\n\n    return valid;\n  },\n\n  /**\n  * Resizes the texarea based on the content.\n  * @private\n  * @param {obkect} self The textaarea api\n  * @param {event} e The resive event object\n  */\n  handleResize(self, e) {\n    const value = self.element.val();\n    const oldHeight = self.element.innerHeight();\n    let newHeight = self.element.get(0).scrollHeight;\n    const minHeight = self.element.data('autogrow-start-height') || 0;\n    const maxHeight = self.settings.autoGrowMaxHeight || 0;\n    let clone;\n\n    if (maxHeight > 0 && maxHeight < newHeight) {\n      newHeight = maxHeight;\n      self.element.css('overflow', '');\n      if (oldHeight === newHeight) {\n        return;\n      }\n    } else {\n      self.element.css('overflow', 'hidden');\n    }\n\n    if (oldHeight < newHeight) {\n      self.scrollTop = 0;\n\n      if (self.settings.autoGrowAnimate && newHeight !== maxHeight) {\n        self.element.stop().animate({ height: newHeight }, self.settings.autoGrowAnimateSpeed);\n      } else {\n        self.element.innerHeight(newHeight);\n      }\n    } else if (!e || e.which === 8 || e.which === 46 || (e.ctrlKey && e.which === 88)) {\n      if (oldHeight > minHeight) {\n        clone = self.element.clone()\n          .addClass('clone')\n          .css({ position: 'absolute', zIndex: -10, height: '' })\n          .val(xssUtils.sanitizeHTML(value));\n\n        self.element.after(clone);\n        do {\n          newHeight = clone[0].scrollHeight - 1;\n          clone.innerHeight(newHeight);\n        } while (newHeight === clone[0].scrollHeight);\n\n        newHeight++;\n        clone.remove();\n\n        if (newHeight < minHeight) {\n          newHeight = minHeight;\n        }\n\n        if (oldHeight > newHeight && self.settings.autoGrowAnimate) {\n          self.element.stop().animate({ height: newHeight }, self.settings.autoGrowAnimateSpeed);\n        } else {\n          self.element.innerHeight(newHeight);\n        }\n      } else {\n        self.element.innerHeight(minHeight);\n      }\n    }\n  },\n\n  /**\n   * Counts the number of line breaks in a string\n   * @private\n   * @param {string} s The string to test.\n   * @returns {number} The number of found line countLinebreaks\n   */\n  countLinebreaks(s) {\n    return (s.match(/\\n/g) || []).length;\n  },\n\n  /**\n   * Updates the descriptive markup (counter, etc) to notify the user how many\n   * characters can be typed.\n   * @private\n   * @param {object} self The current object.\n   */\n  updateCounter() {\n    const self = this;\n    const value = self.element.val();\n    const isExtraLinebreaks = this.isChrome || this.isSafari;\n    const length = value.length + (isExtraLinebreaks ? this.countLinebreaks(value) : 0);\n    const max = self.getMaxLength();\n    const remaining = (parseInt(max, 10) - length);\n    let text = (self.settings.charRemainingText ? self.settings.charRemainingText : //eslint-disable-line\n      (Locale.translate('CharactersLeft') === 'CharactersLeft' ? 'Characters Left' :\n        Locale.translate('CharactersLeft'))).replace('{0}', remaining.toString());\n\n    if (self.counter) {\n      if (length >= max) {\n        text = (self.settings.charMaxText ? self.settings.charMaxText.replace('{0}', max) : Locale.translate('CharactersMax') + max);\n        self.counter.text(text);\n        self.counter.removeClass('almost-empty');\n      } else {\n        self.counter.text(text);\n        if (remaining < 10) {\n          self.counter.addClass('almost-empty');\n        } else {\n          self.counter.removeClass('almost-empty');\n        }\n      }\n    }\n\n    self.printarea.text(self.element.val());\n  },\n\n  /**\n   * Enables this component instance.\n   */\n  enable() {\n    this.element.prop('disabled', false).prop('readonly', false);\n  },\n\n  /**\n   * Disables this component instance.\n   */\n  disable() {\n    this.element.prop('disabled', true);\n  },\n\n  /**\n   * Returns true if the texarea is disabled\n   * @returns {boolean} True if the elemet is disabled.\n   */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n   * Sets this component instance to \"readonly\"\n   */\n  readonly() {\n    this.element.prop('readonly', true);\n  },\n\n  /**\n   * Call whenever the plugin's settings are changed\n   * @param {object} settings The settings object.\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.destroy();\n    this.init();\n  },\n\n  /**\n   * Returns max length if setting exists\n   * @private\n   * @returns {number} maxLength property in settings if exist otherwise maxlength attribute is returned if exist\n   */\n  getMaxLength() {\n    if (this.settings.maxLength) {\n      return this.settings.maxLength;\n    } else if (this.element.attr('maxlength')) {\n      return parseInt(this.element.attr('maxlength'), 10);\n    }\n\n    return undefined;\n  },\n\n  /**\n   * Destroys this component instance and unlinks it from its element.\n   */\n  destroy() {\n    if (this.printarea && this.printarea.length) {\n      this.printarea.remove();\n    }\n    if (this.counter && this.counter.length) {\n      this.counter.remove();\n    }\n    this.element.off('keyup.textarea, focus.textarea, updated.dropdown, keypress.textarea, blur.textarea');\n  },\n\n  /**\n   * Handle key events for functionality like counter and autoGrow.\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.on('keyup.textarea', (e) => {\n      const value = self.element.val();\n      const isExtraLinebreaks = self.isChrome || self.isSafari;\n      const length = value.length + (isExtraLinebreaks ? self.countLinebreaks(value) : 0);\n      const max = self.getMaxLength();\n\n      self.updateCounter();\n\n      if (length >= max) {\n        e.preventDefault();\n        return false;\n      }\n\n      if (self.settings.autoGrow) {\n        self.handleResize(self, e);\n      }\n\n      return true;\n    }).on('focus.textarea', () => {\n      if (self.counter) {\n        self.counter.addClass('focus');\n      }\n    }).on('updated.dropdown', () => {\n      self.updated();\n    }).on('keypress.textarea', function (e) {\n      const value = self.element.val();\n      const isExtraLinebreaks = self.isChrome || self.isSafari;\n      const length = value.length + (isExtraLinebreaks ? self.countLinebreaks(value) : 0);\n      const max = self.getMaxLength();\n\n      if ([97, 99, 118, 120].indexOf(e.which) > -1 && (e.metaKey || e.ctrlKey)) {\n        self.updateCounter();\n        return;\n      }\n\n      if (!self.isPrintable(e.which, e.shiftKey)) {\n        return;\n      }\n\n      if (length >= max && !self.isSelected(this)) {\n        e.preventDefault();\n      }\n    })\n      .on('blur.textarea', () => {\n        self.updateCounter();\n        if (self.counter) {\n          self.counter.removeClass('focus');\n        }\n      });\n  }\n};\n\nexport { Textarea, COMPONENT_NAME };\n","import { Textarea, COMPONENT_NAME } from './textarea';\n\n/**\n * jQuery Component wrapper for Textarea\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} textarea elements being acted on.\n */\n$.fn.textarea = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Textarea(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { deprecateMethod } from '../../utils/deprecated';\nimport { stringUtils } from '../../utils/string';\nimport { Locale } from '../locale/locale';\nimport { xssUtils } from '../../utils/xss';\n\n// jQuery Components\nimport '../button/button.jquery';\nimport '../popupmenu/popupmenu.jquery';\nimport '../searchfield/searchfield.jquery';\nimport '../tooltip/tooltip.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'toolbar';\n\n/**\n * The Toolbar Component manages various levels of application navigation.\n * It contains a group of buttons that functionally related content. Each panel\n * consists of two levels: the top level identifies the category or section header,\n * and the second level provides the associated options.\n *\n * @class Toolbar\n * @param {HTMLElement|jQuery[]} element the base Toolbar element\n * @param {object} [settings] incoming settings\n *\n * @param {boolean} [settings.rightAligned=false] Will always attempt to right-align the contents of\n *  the toolbar. By default if there is no title it will left align. This forces right alignment.\n * @param {number} [settings.maxVisibleButtons=3] Total amount of buttons that can be present, not\n *  including the More button.\n * @param {boolean} [settings.resizeContainers=true] If true, uses Javascript to size the Title and\n *  Buttonset elements in a way that shows as much of the Title area as possible.\n * @param {boolean} [settings.favorButtonset=true] If \"resizeContainers\" is true, setting this to\n *  true will try to display as many buttons as possible while resizing the toolbar.\n *  Setting to false attempts to show the entire title instead.\n * @param {object} [settings.moreMenuSettings] If defined, provides a toolbar-level method of\n *  defining settings that will be applied to the More Actions button's popupmenu instance.\n * @param {boolean} [settings.noSearchfieldReinvoke=false] If true, does not manage the lifecycle\n *  of an internal toolbarsearchfield automatically.  Allows an external controller\n *  to do it instead.\n */\nconst TOOLBAR_DEFAULTS = {\n  rightAligned: false,\n  maxVisibleButtons: 3,\n  resizeContainers: true,\n  favorButtonset: true,\n  moreMenuSettings: undefined,\n  noSearchfieldReinvoke: false,\n};\n\nfunction Toolbar(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, TOOLBAR_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nToolbar.prototype = {\n\n  /**\n   * Initializes the Toolbar Component\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  init() {\n    return this\n      .setup()\n      .build()\n      .handleEvents();\n  },\n\n  /**\n   * Detects discrepencies in settings.  In general, configures the component\n   * based on user settings.\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  setup() {\n    // Can't have zero buttons\n    if (this.settings.maxVisibleButtons <= 0) {\n      this.settings.maxVisibleButtons = TOOLBAR_DEFAULTS.maxVisibleButtons;\n    }\n\n    return this;\n  },\n\n  /**\n   * Adds additional markup, wraps some internal elements, and helps construct a\n   * complete Toolbar representation in the HTML Markup. This method also builds the\n   * \"More Actions\" menu and ties its elements to the toolbar items.\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  build() {\n    const self = this;\n\n    this.element.attr('role', 'toolbar');\n    if (this.settings.resizeContainers && this.element.is(':not(:hidden)')) {\n      this.element[0].classList.add('do-resize');\n    }\n\n    this.buildAriaLabel();\n\n    // keep track of how many popupmenus there are with an ID.\n    // Used for managing events that are bound to $(document)\n    if (!this.id) {\n      this.id = (parseInt($('.toolbar, .formatter-toolbar').index(this.element), 10));\n    }\n\n    // Check for a \"title\" element.  This element is optional.\n    // If a title element exists, a tooltip will be created for when it's not\n    // possible to show the entire title text on screen.\n    this.title = this.element.children('.title');\n    if (this.title.length) {\n      this.element[0].classList.add('has-title');\n\n      this.cutoffTitle = false;\n      this.title.on('beforeshow.toolbar', () => self.cutoffTitle).tooltip({\n        content: `${this.title.text().trim()}`\n      });\n    } else {\n      this.element[0].classList.remove('has-title');\n    }\n\n    // Container for main group of buttons and input fields.  Only these spill into the More menu.\n    this.buttonset = this.element.children('.buttonset');\n    if (!this.buttonset.length) {\n      this.buttonset = $('<div class=\"buttonset\"></div>');\n      if (this.title.length) {\n        this.buttonset.insertAfter(this.title);\n      } else {\n        this.buttonset.prependTo(this.element);\n      }\n    }\n\n    this.element[this.settings.rightAligned ? 'addClass' : 'removeClass']('right-aligned');\n\n    // Add and invoke More Button, if it doesn't exist\n    this.more = this.element.find('.btn-actions');\n    if (this.more.length === 0 && !this.element.hasClass('no-actions-button')) {\n      let moreContainer = this.element.find('.more');\n\n      if (!moreContainer.length) {\n        moreContainer = $('<div class=\"more\"></div>').appendTo(this.element);\n      }\n\n      this.more = $('<button class=\"btn-actions\" type=\"button\"></button>')\n        .html(`${$.createIcon({ icon: 'more' })\n        }<span class=\"audible\">${Locale.translate('MoreActions')}</span>`)\n        .attr('title', Locale.translate('More'))\n        .appendTo(moreContainer);\n    }\n\n    // Reference all interactive items in the toolbar\n    this.buttonsetItems = this.buttonset.children('button')\n      .add(this.buttonset.find('input')); // Searchfield Wrappers\n\n    // Items contains all actionable items in the toolbar, including the ones in\n    // the title, and the more button\n    this.items = this.buttonsetItems\n      .add(this.title.children('button'))\n      .add(this.more);\n\n    // Invoke buttons\n    const buttons = this.items.filter('button, input[type=\"button\"], [class^=\"btn\"]');\n    buttons.each(function () {\n      const buttonControl = $(this).data('button');\n      if (!buttonControl) {\n        $(this).button();\n      }\n\n      const tooltipControl = $(this).data('tooltip');\n      if (!tooltipControl && $(this).attr('title')) {\n        $(this).tooltip();\n      }\n    });\n\n    // Invoke searchfields\n    if (!this.settings.noSearchfieldReinvoke) {\n      const searchfields = this.items.filter('.searchfield, .toolbar-searchfield-wrapper, .searchfield-wrapper');\n      searchfields.each((i, item) => {\n        let sf = $(item);\n        if (sf.is('.toolbar-searchfield-wrapper, .searchfield-wrapper')) {\n          sf = sf.children('.searchfield');\n        }\n\n        if (!sf.data('searchfield')) {\n          const searchfieldOpts = $.extend({}, utils.parseSettings(sf[0]));\n          sf.searchfield(searchfieldOpts);\n        }\n      });\n    }\n\n    // Setup the More Actions Menu.  Add Menu Items for existing buttons/elements in\n    // the toolbar, but hide them initially. They are revealed when overflow checking\n    // happens as the menu is opened.\n    const popupMenuInstance = this.more.data('popupmenu');\n    const moreAriaAttr = this.more.attr('aria-controls');\n\n    if (!popupMenuInstance) {\n      this.moreMenu = $(`#${moreAriaAttr}`);\n      if (!this.moreMenu.length) {\n        this.moreMenu = this.more.next('.popupmenu, .popupmenu-wrapper');\n      }\n      if (!this.moreMenu.length) {\n        this.moreMenu = $(`<ul id=\"popupmenu-toolbar-${this.id}\" class=\"popupmenu\"></ul>`).insertAfter(this.more);\n      }\n\n      // Allow toolbar to understand pre-wrapped popupmenus\n      // Angular Support -- See SOHO-7008\n      if (this.moreMenu.is('.popupmenu-wrapper')) {\n        this.moreMenu = this.moreMenu.children('.popupmenu');\n      }\n    } else {\n      this.moreMenu = popupMenuInstance.menu;\n    }\n\n    function menuItemFilter() {\n      return $(this).parent('.buttonset, .inline').length;\n    }\n\n    const menuItems = [];\n    this.items.not(this.more).filter(menuItemFilter).each(function () {\n      menuItems.push(self.buildMoreActionsMenuItem($(this)));\n    });\n\n    menuItems.reverse();\n    $.each(menuItems, (i, item) => {\n      if (item.text() !== '') {\n        item.prependTo(self.moreMenu);\n      }\n    });\n\n    this.defaultMenuItems = this.moreMenu.children('li:not(.separator)');\n    this.hasDefaultMenuItems = this.defaultMenuItems.length > 0;\n\n    // Setup an Event Listener that will refresh the contents of the More Actions\n    // Menu's items each time the menu is opened.\n    const menuButtonSettings = utils.extend({}, this.settings.moreMenuSettings, {\n      trigger: 'click',\n      menu: this.moreMenu\n    }, (this.hasDefaultMenuItems ? { predefined: this.defaultMenuItems } : {}));\n    if (popupMenuInstance) {\n      this.more\n        .on('beforeopen.toolbar', () => {\n          self.refreshMoreActionsMenu(self.moreMenu);\n        })\n        .triggerHandler('updated', [menuButtonSettings]);\n    } else {\n      this.more.popupmenu(menuButtonSettings).on('beforeopen.toolbar', () => {\n        self.refreshMoreActionsMenu(self.moreMenu);\n      });\n    }\n\n    // Setup the tabindexes of all items in the toolbar and set the starting active button.\n    function setActiveToolbarItem() {\n      self.items.attr('tabindex', '-1');\n\n      let active = self.items.filter('.is-selected');\n      if (active.length) {\n        self.activeButton = active.first().attr('tabindex', '0');\n        self.items.not(self.activeButton).removeClass('is-selected');\n        return;\n      }\n\n      // Set active to the first item in the toolbar.\n      active = self.items.filter(':visible:not(:disabled)').first().attr('tabindex', '0');\n      self.activeButton = active;\n\n      // If the whole toolbar is hidden (contextual toolbars, etc),\n      // automatically set the first non-disabled item as visible\n      if (self.element.is(':hidden, .is-hidden')) {\n        self.activeButton = self.items.filter(':not(:disabled)').first().attr('tabindex', '0');\n        return;\n      }\n\n      if (self.isItemOverflowed(active)) {\n        active.attr('tabindex', '-1');\n        self.activeButton = self.more.addClass('is-selected').attr('tabindex', '0');\n      }\n    }\n\n    setActiveToolbarItem();\n\n    // Toggles the More Menu based on overflow of toolbar items\n    this.adjustMenuItemVisibility();\n    this.handleResize();\n\n    /**\n     * Fires when the Toolbar has completely rendered all its DOM elements.\n     *\n     * @event rendered\n     * @memberof Toolbar\n     * @param {jQuery.Event} e the jQuery Event object\n     */\n    this.element.triggerHandler('rendered');\n\n    const searchfieldWrapper = this.buttonset.find('.searchfield-wrapper, .toolbar-searchfield-wrapper');\n    if (searchfieldWrapper.length) {\n      searchfieldWrapper.trigger('reanimate');\n    }\n\n    return this;\n  },\n\n  /**\n   * Builds a single \"More Actions Menu\" item from a source toolbar item.\n   * Also sets up linkage between the menu item and the original toolbar item to\n   * allow events/properties to propagate when the More Actions item is acted upon.\n   * @private\n   * @param {jQuery[]} item the source item from the toolbar.\n   * @returns {jQuery[]} a jQuery-wrapped <li> representing a More Actions menu\n   *  implementation of the toolbar item.\n   */\n  buildMoreActionsMenuItem(item) {\n    const isSplitButton = false;\n    let popupLi;\n\n    // If this item should be skipped, just return out\n    if (item.data('skipit') === true) {\n      item.data('skipit', undefined);\n      return popupLi;\n    }\n\n    // Attempt to re-use an existing <li>, if possible.\n    // If a new one is created, setup the linkage between the original element and its\n    // \"More Actions\" menu counterpart.\n    let a = item.data('action-button-link');\n\n    if (!a || !a.length) {\n      popupLi = $('<li></li>');\n      a = $('<a href=\"#\"></a>').appendTo(popupLi);\n\n      // Setup data links between the buttons and their corresponding list items\n      item.data('action-button-link', a);\n      a.data('original-button', item);\n    } else {\n      popupLi = a.parent();\n    }\n\n    // Refresh states\n    if (item.hasClass('hidden')) {\n      popupLi.addClass('hidden');\n    }\n    if (item.is(':disabled')) {\n      popupLi.addClass('is-disabled');\n      a.prop('disabled', true);\n    } else {\n      popupLi.removeClass('is-disabled');\n      a.prop('disabled', false);\n    }\n\n    // Refresh Text\n    a.text(this.getItemText(item));\n\n    // Pass along any icons except for the dropdown (which is added as part of the submenu design)\n    const submenuDesignIcon = $.getBaseURL('#icon-dropdown');\n    const icon = item.children('.icon').filter(function () {\n      const iconName = $(this).getIconName();\n      return iconName && iconName !== submenuDesignIcon && iconName.indexOf('dropdown') === -1;\n    });\n\n    if (icon && icon.length) {\n      a.html(`<span>${a.text()}</span>`);\n      icon.clone().detach().prependTo(a);\n    }\n\n    const linkspan = popupLi.find('b');\n    if (linkspan.length) {\n      this.moreMenu.addClass('has-icons');\n      linkspan.detach().prependTo(popupLi);\n    }\n\n    function addItemLinksRecursively(menu, diffMenu, parentItem) {\n      const children = menu.children('li');\n      const id = diffMenu.attr('id');\n\n      diffMenu.children('li').each((i, diffMenuItem) => {\n        const dmi = $(diffMenuItem); // \"Diffed\" Menu Item\n        const omi = children.eq(i); // Corresponding \"Original\" menu item\n        const dmiA = dmi.children('a'); // Anchor inside of \"Diffed\" menu item\n        const omiA = omi.children('a'); // Anchor inside of \"Original\" menu item\n        const dmiID = dmi.attr('id');\n        const dmiAID = dmiA.attr('id');\n\n        // replace menu item ids with spillover-menu specific ids.\n        if (dmiID) {\n          dmi.removeAttr('id').attr('data-original-menu-item', dmiID);\n        }\n        if (dmiAID) {\n          dmiA.removeAttr('id').attr('data-original-menu-anchor', dmiAID);\n        }\n\n        omiA.data('action-button-link', dmiA);\n        dmiA.data('original-button', omiA);\n\n        const omiSubMenu = omi.children('.wrapper').children('.popupmenu');\n        const dmiSubMenu = dmi.children('.wrapper').children('.popupmenu');\n\n        if (omiSubMenu.length && dmiSubMenu.length) {\n          addItemLinksRecursively(omiSubMenu, dmiSubMenu, dmi);\n        }\n\n        if (isSplitButton) {\n          dmi.removeClass('is-checked');\n        }\n      });\n\n      diffMenu.removeAttr('id').attr('data-original-menu', id);\n      parentItem.addClass('submenu');\n\n      let appendTarget;\n      if (parentItem.is(popupLi)) {\n        appendTarget = parentItem.children('.wrapper');\n        if (!appendTarget || !appendTarget.length) {\n          appendTarget = $('<div class=\"wrapper\"></div>');\n        }\n        appendTarget.html(diffMenu);\n        parentItem.append(appendTarget);\n      }\n    }\n\n    if (item.is('.btn-menu')) {\n      if (!item.data('popupmenu')) {\n        item.popupmenu();\n      } else if (!a.children('.icon.arrow').length) {\n        a.append($.createIcon({\n          classes: 'icon arrow icon-dropdown',\n          icon: 'dropdown'\n        }));\n      }\n\n      const menu = item.data('popupmenu').menu;\n      const diffMenu = menu.clone();\n\n      addItemLinksRecursively(menu, diffMenu, popupLi);\n    }\n\n    if (item.is('[data-popdown]')) {\n      item.popdown();\n    }\n\n    return popupLi;\n  },\n\n  /**\n   * Refreshes the More Actions Menu items' text content, icons, states, and submenu content\n   * based on changes made directly to their counterpart elements in the Toolbar.  Can also\n   * optionally refresh only part of the menu.\n   * @param {jQuery[]} menu the menu/submenu to be refreshed.\n   */\n  refreshMoreActionsMenu(menu) {\n    const self = this;\n\n    $('li > a', menu).each(function () {\n      const a = $(this);\n      const li = a.parent();\n      const item = a.data('originalButton');\n      let itemParent;\n      const text = self.getItemText(item);\n      let submenu;\n\n      if (item) {\n        if (a.find('span').length) {\n          a.find('span').text(text.trim());\n        } else {\n          a.text(text.trim());\n        }\n\n        if (item.isHiddenAtBreakpoint() || item.parent().isHiddenAtBreakpoint()) {\n          li.addClass('hidden');\n        } else {\n          li.removeClass('hidden');\n        }\n\n        if (item.parent().is('.is-disabled') || item.is(':disabled')) { // if it's disabled menu item, OR a disabled menu-button\n          li.addClass('is-disabled');\n          a.prop('disabled', true);\n          a.attr('tabindex', '-1');\n        } else {\n          li.removeClass('is-disabled');\n          a.prop('disabled', false);\n        }\n\n        if (item.is('a')) {\n          itemParent = item.parent('li');\n\n          if (itemParent.is('.is-checked')) {\n            li.addClass('is-checked');\n          } else {\n            li.removeClass('is-checked');\n          }\n        }\n\n        if (item.is('.btn-menu')) {\n          submenu = a.parent().find('.popupmenu').first();\n          self.refreshMoreActionsMenu(submenu);\n        }\n      }\n    });\n  },\n\n  /**\n   * Gets the complete text contnts of a Toolbar Item, in order to create its\n   * corresponding \"more actions\" menu item.\n   *\n   * Order of operations for populating the List Item text:\n   * 1. span contents (.audible), then\n   * 2. button title attribute, then\n   * 3. tooltip text (if applicable)\n   * @param {jQuery[]} item the item being evaluated.\n   * @returns {string} the complete text representation.\n   */\n  getItemText(item) {\n    if (!item) {\n      return '';\n    }\n    const span = item.find('span').first();\n    const title = item.attr('title');\n    const tooltip = item.data('tooltip');\n    const tooltipText = tooltip && typeof tooltip.content === 'string' ? tooltip.content : undefined;\n    let popupLiText;\n\n    if (title !== '' && title !== undefined) {\n      popupLiText = title;\n    } else if (tooltipText) {\n      popupLiText = tooltipText;\n    } else if (span.length) {\n      popupLiText = span.text();\n    } else {\n      popupLiText = item.text();\n    }\n\n    return xssUtils.stripHTML(popupLiText);\n  },\n\n  /**\n   * Sets up all necessary event handling on a Toolbar component\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    this.items\n      .off('keydown.toolbar').on('keydown.toolbar', (e) => {\n        self.handleKeys(e);\n      }).off('click.toolbar').on('click.toolbar', (e) => {\n        self.handleClick(e);\n      });\n\n    this.items.filter('.btn-menu, .btn-actions')\n      .off('close.toolbar').on('close.toolbar', function onClosePopup() {\n        const el = $(this);\n        let last;\n\n        if (el.is('.is-overflowed')) {\n          last = self.getLastVisibleButton();\n          if (last && last.length) {\n            last[0].focus();\n          }\n          return;\n        }\n\n        if (document.activeElement && document.activeElement.tagName === 'INPUT') {\n          return;\n        }\n        if (el) {\n          el.focus();\n        }\n        self.buttonset.scrollTop(0);\n      });\n\n    this.items.not(this.more).off('selected.toolbar').on('selected.toolbar', (e, anchor) => {\n      e.stopPropagation();\n      self.handleSelected(e, anchor);\n    });\n\n    this.more.on('keydown.toolbar', (e) => {\n      self.handleKeys(e);\n    }).on('beforeopen.toolbar', () => {\n      self.adjustMenuItemVisibility();\n    }).on('selected.toolbar', (e, anchor) => {\n      e.stopPropagation();\n      self.handleSelected(e, anchor);\n    });\n\n    // Handle possible AJAX calls on Toolbar Menu buttons\n    // TODO: Need to handle mouseenter/touchstart/keydown events that will cause this to trigger,\n    // instead of directly handling this itself.\n    this.more\n      .off('show-submenu.toolbar')\n      .on('show-submenu.toolbar', (e, li) => {\n        self.handleTransferToMenuButtonItem(e, li);\n      });\n\n    this.element.off('updated.toolbar').on('updated.toolbar', (e, settings) => {\n      e.stopPropagation();\n      self.updated(settings);\n    }).off('recalculate-buttons.toolbar').on('recalculate-buttons.toolbar', (e, containerDims) => {\n      self.handleResize(containerDims);\n    })\n      .off('scrollup.toolbar')\n      .on('scrollup.toolbar', () => {\n        const moduleTabsParent = self.element.parents('.tab-container.module-tabs');\n        if (moduleTabsParent.length) {\n          moduleTabsParent.scrollTop(0);\n        }\n      });\n\n    $('body').off(`resize.toolbar-${this.id}`).on(`resize.toolbar-${this.id}`, () => {\n      self.handleResize();\n    });\n\n    // Trigger _handleResize()_ once to fix container sizes.\n    this.handleResize();\n\n    return this;\n  },\n\n  /**\n   * Event Handler for the Soho Popupmenu's custom 'show-submenu' event, specifically for\n   * the case of a menu button that's been spilled over into this Toolbar's More Actions menu.\n   * @param {jQuery.Event} e custom `show-submenu` jQuery event\n   * @param {jQuery[]} li the `li.submenu` element.\n   */\n  handleTransferToMenuButtonItem(e, li) {\n    const originalMenuButton = li.children('a').data('original-button');\n    if (!originalMenuButton) {\n      return;\n    }\n\n    const popupAPI = originalMenuButton.data('popupmenu');\n    if (!popupAPI || typeof popupAPI.settings.beforeOpen !== 'function') {\n      return;\n    }\n\n    // Call out to the MenuButton's AJAX source, get its contents, and populate\n    // the corresponding More Actions menu sub-item.\n    popupAPI.callSource(e);\n    this.buildMoreActionsMenuItem(originalMenuButton);\n  },\n\n  /**\n   * Event handler for the Soho `selected` event on toolbar items\n   * @private\n   * @param {jQuery.Event} e custom `selected` event\n   * @param {jQuery[]} anchor a reference to the anchor that was selected\n   * @returns {void}\n   */\n  handleSelected(e, anchor) {\n    const itemLink = anchor.data('original-button');\n    const li = anchor.parent();\n    let itemEvts;\n    let toolbarEvts;\n    let popup;\n    let popupTrigger;\n\n    // Don't continue if hidden/readonly/disabled\n    if (li.is('.hidden, .is-disabled') || anchor.is('[readonly], [disabled]')) {\n      e.preventDefault();\n      return;\n    }\n\n    if (itemLink && itemLink.length > 0) {\n      itemEvts = itemLink.listEvents();\n      toolbarEvts = this.element.listEvents();\n\n      // Make sure the active button is set properly\n      this.setActiveButton(itemLink);\n\n      // Handle popdowns with a custom placement algorithm that correctly pops the menu\n      // open against the \"More Actions\" button instead of in an empty space\n      // SOHO-7087\n      if (itemLink.is('[data-popdown]')) {\n        popupTrigger = itemLink.data('popdown');\n\n        if (this.isItemOverflowed(itemLink)) {\n          popupTrigger.settings.trigger = this.more;\n          popupTrigger.updated();\n        }\n      }\n\n      // Fire Angular Events\n      if (itemLink.attr('ng-click') || itemLink.attr('data-ng-click')) {\n        itemLink.trigger('click');\n        return;\n      }\n\n      // Check the Toolbar Button for the existence of certain event types.\n      // Checks the button, and checks the toolbar container element for delegated events.\n      const evtTypes = ['click', 'touchend', 'touchcancel'];\n      for (let i = 0; i < evtTypes.length; i++) {\n        const type = evtTypes[i];\n\n        // Check toolbar element for delegated-down events first\n        if (toolbarEvts && toolbarEvts[type] && toolbarEvts[type].delegateCount > 0) {\n          const el = this.element;\n          const evt = $.Event(type);\n\n          evt.target = el.find(itemLink)[0];\n          el.trigger(evt);\n          return;\n        }\n\n        // Check for events directly on the element\n        if ((itemEvts && itemEvts[type]) || itemLink[0][`on${type}`]) {\n          itemLink.trigger(type);\n          return;\n        }\n      }\n\n      // If the linked element is a child of a menu button, trigger its 'selected' event.\n      popup = itemLink.parents('.popupmenu');\n      popupTrigger = popup.data('trigger');\n      if (popup.length && popupTrigger instanceof $ && popupTrigger.length) {\n        popupTrigger.triggerHandler('selected', [itemLink]);\n        return;\n      }\n\n      // Manually Trigger Select on the linked item, since it won't be done by another event\n      this.triggerSelect(itemLink);\n      return;\n    }\n\n    // If no item link exists, it's a pre-defined menu item.\n    // Trigger 'selected' manually on the toolbar element.\n    // Normally this would happen by virtue of triggering the \"click\"\n    // handlers on a linked button above.\n    this.triggerSelect(anchor);\n  },\n\n  /**\n   * Event handler for clicks on toolbar items\n   * @private\n   * @listens {jQuery.Event} e\n   * @param {jQuery.Event} e jQuery click event\n   * @returns {boolean} basic \"false\" return expected for click events\n   */\n  handleClick(e) {\n    this.setActiveButton($(e.currentTarget));\n    this.triggerSelect($(e.currentTarget));\n    return false;\n  },\n\n  /**\n   * Event handler for key presses on toolbar items\n   * @private\n   * @listens {jQuery.Event} e\n   * @param {jQuery.Event} e `keypress` event\n   * @returns {void}\n   */\n  handleKeys(e) {\n    const self = this;\n    const key = e.which;\n    const target = $(e.target);\n    const isActionButton = target.is('.btn-actions');\n    const isRTL = Locale.isRTL();\n\n    if ((key === 37 && target.is(':not(input)')) ||\n      (key === 38 && target.is(':not(input.is-open)'))) { // Don't navigate away if Up Arrow in autocomplete field that is open\n      e.preventDefault();\n\n      if (isActionButton) {\n        self.setActiveButton(isRTL ? self.getFirstVisibleButton() : self.getLastVisibleButton());\n      } else {\n        self.navigate(isRTL ? 1 : -1);\n      }\n    }\n\n    if ((key === 39 && target.is(':not(input)')) ||\n      (key === 40 && target.is(':not(input.is-open)'))) { // Don't navigate away if Down Arrow in autocomplete field that is open\n      e.preventDefault();\n\n      if (isActionButton) {\n        self.setActiveButton(isRTL ? self.getLastVisibleButton() : self.getFirstVisibleButton());\n      } else {\n        self.navigate(isRTL ? -1 : 1);\n      }\n    }\n  },\n\n  /**\n   * Re-renders the toolbar element and adjusts all internal parts to account for the new size.\n   * @param {object} [containerDims] an object containing dimensions that can be set\n   *  on the Toolbar's title and buttonset elements.\n   * @param {number} [containerDims.title] represents the width that will be applied\n   *  to the title element\n   * @param {number} [containerDims.buttonset] represents the width that will be\n   *  applied to the buttonset element\n   * @returns {void}\n   */\n  handleResize(containerDims) {\n    if (this.settings.resizeContainers) {\n      const title = containerDims ? containerDims.title : undefined;\n      const buttonset = containerDims ? containerDims.buttonset : undefined;\n\n      this.sizeContainers(title, buttonset);\n    }\n\n    const buttons = this.getButtonsetButtons();\n    for (let i = 0; i < buttons.length; i++) {\n      buttons[i].removeClass('is-overflowed');\n    }\n\n    if (this.element.is(':not(:hidden)')) {\n      this.adjustMenuItemVisibility();\n      this.toggleMoreMenu(); // Added 9/16/2015 due to issue HFC-2876\n    }\n  },\n\n  /**\n   * Resizes the Toolbar's internal container areas (title, buttonset) to make\n   * efficient use of their space.\n   * @private\n   * @chainable\n   * @param {number} titleSize desired size of the title element.\n   * @param {number} buttonsetSize desired size of the buttonset element.\n   */\n  sizeContainers(titleSize, buttonsetSize) {\n    const containerElem = this.element[0];\n    const titleElem = this.title[0];\n    const buttonsetElem = this.buttonset[0];\n    const moreElem = this.more[0];\n\n    // Don't do this at all unless we have a title element (which is optional)\n    if (!this.title || !this.title.length) {\n      return;\n    }\n\n    // If the element's hidden and has defined sizes, remove them so we can use the defaults.\n    if (this.element.is(':hidden')) {\n      buttonsetElem.style.width = '';\n      titleElem.style.width = '';\n      containerElem.classList.remove('do-resize');\n      return;\n    }\n\n    const WHITE_SPACE = 30;\n    const MIN_TITLE_SIZE = 44 + WHITE_SPACE;\n    const MIN_BUTTONSET_SIZE = 0;\n\n    buttonsetElem.style.width = '';\n    titleElem.style.width = '';\n\n    if (!containerElem.classList.contains('do-resize')) {\n      containerElem.classList.add('do-resize');\n    }\n\n    const toolbarDims = $(containerElem).getHiddenSize();\n    const buttonsetDims = $(buttonsetElem).getHiddenSize();\n    const titleDims = $(titleElem).getHiddenSize();\n    const moreDims = $(moreElem).getHiddenSize();\n    const toolbarPadding = parseInt(toolbarDims.padding.left, 10) +\n      parseInt(toolbarDims.padding.right, 10);\n\n    if (isNaN(moreDims.width)) {\n      moreDims.width = 50;\n    }\n\n    if (isNaN(buttonsetDims.width) || buttonsetDims.width < MIN_BUTTONSET_SIZE) {\n      buttonsetDims.width = MIN_BUTTONSET_SIZE;\n    }\n\n    function addPx(val) {\n      return `${val}px`;\n    }\n\n    // Get the target size of the title element\n    const self = this;\n    const hasTitleSizeGetter = (titleSize !== undefined && !isNaN(titleSize));\n    const hasButtonsetSizeGetter = (buttonsetSize !== undefined && !isNaN(buttonsetSize));\n    let d;\n    this.cutoffTitle = false;\n\n    // Determine the target sizes for title, based on external setters,\n    //  or building an estimated size.\n    function getTargetTitleWidth() {\n      if (hasTitleSizeGetter) {\n        return parseInt(titleSize, 10);\n      }\n      if (self.settings.favorButtonset === true) {\n        return toolbarDims.width - (toolbarPadding +\n          (hasButtonsetSizeGetter ? parseInt(buttonsetSize, 10) : buttonsetDims.width) +\n          moreDims.width);\n      }\n      return titleDims.scrollWidth;\n    }\n    let targetTitleWidth = getTargetTitleWidth();\n\n    // Determine the target sizes for buttonset\n    function getTargetButtonsetWidth() {\n      if (hasButtonsetSizeGetter) {\n        return parseInt(buttonsetSize, 10);\n      }\n      if (self.settings.favorButtonset === true) {\n        return buttonsetDims.width;\n      }\n      return toolbarDims.width - (toolbarPadding +\n        (hasTitleSizeGetter ? parseInt(titleSize, 10) : titleDims.scrollWidth) +\n        moreDims.width);\n    }\n    let targetButtonsetWidth = getTargetButtonsetWidth();\n\n    if (this.settings.favorButtonset) {\n      // Cut off the buttonset anyway if title is completely hidden.  Something's gotta give!\n      if (targetTitleWidth < MIN_TITLE_SIZE) {\n        this.cutoffTitle = true;\n        d = Math.abs(targetTitleWidth - MIN_TITLE_SIZE);\n        targetTitleWidth = MIN_TITLE_SIZE;\n        targetButtonsetWidth -= d;\n      }\n\n      buttonsetElem.style.width = addPx(targetButtonsetWidth + 2);\n      titleElem.style.width = addPx(targetTitleWidth - 2);\n\n      // Recheck if title is overflowed to ellipsis\n      if (titleElem.textContent &&\n        targetTitleWidth < stringUtils.textWidth(titleElem.textContent.trim())) {\n        this.cutoffTitle = true;\n      }\n\n      if (targetTitleWidth > stringUtils.textWidth($(titleElem).find('h1').text().trim())) {\n        this.cutoffTitle = false;\n      }\n\n      return;\n    }\n    //= =========================\n    // Favor the title element\n    // Cut off the title anyway if buttonset is completely hidden.  Something's gotta give!\n    if (targetButtonsetWidth < MIN_BUTTONSET_SIZE) {\n      this.cutoffTitle = true;\n      d = Math.abs(targetButtonsetWidth - MIN_BUTTONSET_SIZE);\n      targetButtonsetWidth = MIN_BUTTONSET_SIZE;\n      targetTitleWidth -= d;\n    }\n\n    // Always favor the title by one extra px for Chrome\n    titleElem.style.width = addPx(targetTitleWidth + 2);\n    buttonsetElem.style.width = addPx(targetButtonsetWidth - 2);\n  },\n\n  /**\n   * Changes the \"active\" button on the toolbar.\n   * @param {number} direction can be `-1` (previous), `1` (next), or `0` (remain on current).\n   * @returns {void}\n   */\n  navigate(direction) {\n    const items = this.items.filter(':visible:not(:disabled)');\n    const current = items.index(this.activeButton);\n    const next = current + direction;\n    let target;\n\n    if (next >= 0 && next < items.length) {\n      target = items.eq(next);\n    }\n\n    if (next >= items.length) {\n      target = items.first();\n    }\n\n    if (next === -1) {\n      target = items.last();\n    }\n\n    if (this.isItemOverflowed(target)) {\n      target = this.more;\n    }\n\n    this.setActiveButton(target);\n  },\n\n  /**\n   * Gets a reference to the last visible (not overflowed) button inside of the buttonset.\n   * @returns {jQuery[]} the last visible button in the buttonset.\n   */\n  getLastVisibleButton() {\n    const items = $(this.items.get().reverse()).not(this.more);\n    let target;\n    let i = 0;\n    let elem;\n\n    while (!target && i < items.length) {\n      elem = $(items[i]);\n      if (!this.isItemOverflowed(elem)) {\n        target = elem;\n        break;\n      }\n      i++;\n    }\n\n    if (!target || target.length === 0) {\n      target = items.first();\n    }\n\n    while (target.length && target.is('.separator, *:disabled, *:hidden')) {\n      target = target.prev();\n    }\n\n    return target;\n  },\n\n  /**\n   * Gets a reference to the first visible (not overflowed) button inside of the buttonset.\n   * @returns {jQuery[]} the first visible button in the buttonset.\n   */\n  getFirstVisibleButton() {\n    let i = 0;\n    const items = this.items;\n    let target = items.eq(i);\n\n    while (target.is('.separator, *:disabled, *:hidden')) {\n      i++;\n      target = items.eq(i);\n    }\n\n    return target;\n  },\n\n  /**\n   * Sets the currently \"active\" (focused) Toolbar item\n   * @param {jQuery[]} activeButton the preferred target element to make active.\n   * @param {boolean} [noFocus] if defined, prevents this method from giving focus\n   *  to the new active button.\n   */\n  setActiveButton(activeButton, noFocus) {\n    // Return out of this if we're clicking the currently-active item\n    if (activeButton[0] === this.activeButton[0]) {\n      return;\n    }\n\n    const self = this;\n\n    function getMoreOrLast() {\n      if (self.moreButtonIsDisabled() || !self.element.hasClass('has-more-button')) {\n        return self.getLastVisibleButton();\n      }\n\n      return self.more;\n    }\n\n    function getActiveButton() {\n      // Menu items simply set the \"More Actions\" button as active\n      if (activeButton.is('a')) {\n        return getMoreOrLast();\n      }\n\n      // If it's the more button, hide the tooltip and set it as active\n      const tooltip = self.more.data('tooltip');\n      if (activeButton[0] === self.more[0]) {\n        if (tooltip && tooltip.tooltip.is(':not(.hidden)')) {\n          tooltip.hide();\n        }\n        return getMoreOrLast();\n      }\n\n      // Overflowed items also set\n      if (self.isItemOverflowed(activeButton)) {\n        if (!activeButton.is('.searchfield')) {\n          return getMoreOrLast();\n        }\n      }\n\n      return activeButton;\n    }\n\n    this.items.add(this.more).attr('tabindex', '-1').removeClass('is-selected');\n\n    this.activeButton = getActiveButton();\n    this.activeButton.addClass('is-selected').attr('tabindex', '0');\n\n    if (!noFocus && this.activeButton[0]) {\n      this.activeButton[0].focus();\n\n      /**\n       * Fires when the Toolbar's currently `active` element has changed.\n       *\n       * @event navigate\n       * @memberof Toolbar\n       * @param {jQuery.Event} e the jQuery Event object\n       * @param {jQuery} activeButton a reference to the new active button.\n       */\n      this.element.triggerHandler('navigate', [this.activeButton]);\n    }\n  },\n\n  /**\n   * Triggers a \"selected\" event on the base Toolbar element using a common element as an argument.\n   * @param {HTMLElement|SVGElement|jQuery[]} element a jQuery Object containing an\n   *  anchor tag, button, or input field.\n   */\n  triggerSelect(element) {\n    const elem = $(element);\n    if (elem.is(this.more) || (elem.is('.btn-menu, li.submenu'))) {\n      return;\n    }\n\n    /**\n     * Fires when a Toolbar item is selected.\n     *\n     * @event selected\n     * @memberof Toolbar\n     * @property {jQuery.Event} e the jQuery event object\n     * @property {jQuery[]} itemLink a reference to the corresponding toolbar item, wrapped in a jQuery selector\n     */\n    this.element.triggerHandler('selected', [elem]);\n  },\n\n  /**\n   * Assembles and returns a list of all buttons inside the Buttonset element.\n   * @returns {array} of elements inside the buttonset\n   */\n  getButtonsetButtons() {\n    const buttons = [];\n    const items = this.buttonsetItems;\n    let item;\n\n    for (let i = 0; i < items.length; i++) {\n      item = items.eq(i);\n      if (item.data('action-button-link') !== undefined && item.is(':not(.searchfield)')) {\n        buttons.push(item);\n      }\n    }\n\n    return buttons;\n  },\n\n  /**\n   * Gets and Iterates through a list of toolbar items and determines which are\n   * currently overflowed, and which are visible.\n   * @param {array} buttons an Array of jQuery-wrapped elements that represents toolbar items.\n   * @returns {object} containing a `visible` items array, and a `hidden` items array.\n   */\n  getVisibleButtons(buttons) {\n    const self = this;\n    const hiddenButtons = [];\n    const visibleButtons = [];\n\n    if (!buttons || !Array.isArray(buttons)) {\n      buttons = this.getButtonsetButtons();\n    }\n\n    for (let i = 0; i < buttons.length; i++) {\n      buttons[i][0].classList.remove('is-overflowed');\n    }\n\n    function getButtonVisibility(button) {\n      if (!self.isItemOverflowed(button)) {\n        visibleButtons.push(button);\n      } else {\n        hiddenButtons.push(button);\n      }\n    }\n\n    for (let i = 0; i < buttons.length; i++) {\n      getButtonVisibility(buttons[i]);\n    }\n\n    return {\n      visible: visibleButtons,\n      hidden: hiddenButtons\n    };\n  },\n\n  /**\n   * Gets and Iterates through the full list of Toolbar Items and determines which\n   *  ones should currently be present in the More Actions menu.\n   * @private\n   * @param {object} items an object (normally generated by `_.getVisibleButtons()`)\n   *  containing arrays of currently visible and hidden buttons, along with some meta-data.\n   * @returns {void}\n   */\n  adjustMenuItemVisibility(items) {\n    let iconDisplay = 'removeClass';\n\n    if (!items) {\n      items = this.getVisibleButtons();\n    }\n\n    function toggleClass($elem, doHide) {\n      const elem = $elem[0];\n      const li = $elem.data('action-button-link').parent()[0];\n      const elemIsHidden = $elem.isHiddenAtBreakpoint();\n\n      if (doHide) {\n        li.classList.add('hidden');\n        elem.classList.remove('is-overflowed');\n        return;\n      }\n\n      if (!elemIsHidden) {\n        li.classList.remove('hidden');\n      }\n      elem.classList.add('is-overflowed');\n\n      if ($elem.find('.icon').length) {\n        iconDisplay = 'addClass';\n      }\n    }\n\n    let i = 0;\n    for (i; i < items.visible.length; i++) {\n      toggleClass(items.visible[i], true);\n    }\n    for (i = 0; i < items.hidden.length; i++) {\n      toggleClass(items.hidden[i], false);\n    }\n\n    let numIcons = 0;\n    this.moreMenu.find('.icon').each(function () {\n      if (!$(this).parent().parent().hasClass('hidden')) {\n        numIcons++;\n      }\n    });\n\n    if (numIcons > 0) {\n      iconDisplay = 'addClass';\n    }\n\n    this.moreMenu[iconDisplay]('has-icons');\n  },\n\n  /**\n   * Detects whether or not a toolbar item is currently overflowed.  In general,\n   *  toolbar items are considered overflow if their right-most edge sits past the\n   *  right-most edge of the buttonset border.  There are some edge-cases.\n   * @param {jQuery[]} item the Toolbar item being tested.\n   * @returns {boolean} whether or not the item belongs in the More Actions menu\n   */\n  isItemOverflowed(item) {\n    // No items will be overflowed if the `More Actions` menu is purposefully disabled.\n    if (this.moreButtonIsDisabled()) {\n      return false;\n    }\n\n    if (!item || item.length === 0) {\n      return true;\n    }\n\n    const itemIndexInButtonset = this.buttonsetItems.filter(':not(.hidden)').index(item);\n    let maxVisibleButtons = this.settings.maxVisibleButtons;\n\n    // the `maxVisibleButtons` calculation should include a visible More Actions button.\n    // Subtract one from the `maxVisibleButtons` setting to account for the More Button,\n    // if it's visible. See SOHO-7237\n    if (this.moreButtonIsVisible()) {\n      maxVisibleButtons -= 1;\n    }\n\n    // In cases where a Title is present and buttons are right-aligned,\n    // only show up to the maximum allowed.\n    if (this.title.length) {\n      if (itemIndexInButtonset >= maxVisibleButtons) {\n        return true;\n      }\n    }\n\n    if (this.buttonset.scrollTop() > 0) {\n      this.buttonset.scrollTop(0);\n    }\n\n    // unwrap from jQuery\n    if (item instanceof $ && item.length) {\n      item = item[0];\n    }\n\n    const classList = item.classList;\n    const style = window.getComputedStyle(item);\n\n    if (classList.contains('btn-actions')) {\n      return true;\n    }\n    if (classList.contains('searchfield')) {\n      return false;\n    }\n    if (style.display === 'none') {\n      return true;\n    }\n\n    const isRTL = Locale.isRTL();\n    const itemRect = item.getBoundingClientRect();\n    const buttonsetRect = this.buttonset[0].getBoundingClientRect();\n    const itemOutsideXEdge = isRTL ? (itemRect.left <= buttonsetRect.left) :\n      (itemRect.right >= buttonsetRect.right);\n    const itemBelowYEdge = itemRect.bottom >= buttonsetRect.bottom;\n\n    return (itemBelowYEdge === true || itemOutsideXEdge === true);\n  },\n\n  /**\n   * @returns {boolean} whether or not this toolbar is able to have a More Button\n   */\n  moreButtonIsDisabled() {\n    return this.element[0].classList.contains('no-actions-button');\n  },\n\n  /**\n   * Detection for this toolbar to have a More Button\n   * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n   * @deprecated as of v4.4.0. Please use `moreButtonIsDisabled()` instead.\n   * @returns {boolean} whether or not the More Actions button is disabled.\n   */\n  hasNoMoreButton() {\n    return deprecateMethod(this.moreButtonIsDisabled, this.hasNoMoreButton).apply(this);\n  },\n\n  /**\n  * Detection for whether or not More Actions menu is currently visible.  This is\n  * different than the More Actions menu being disabled.  This check determines\n  * whether or not items have spilled over, causing the menu to be shown or hidden.\n  * @returns {boolean} whether or not More Actions menu is currently visible.\n  */\n  moreButtonIsVisible() {\n    return this.element[0].classList.contains('has-more-button');\n  },\n\n  /**\n   * Determines whether or not the \"more actions\" button should be displayed.\n   * @private\n   * @returns {undefined} whether or not the \"more actions\" button should be displayed.\n   */\n  toggleMoreMenu() {\n    if (this.moreButtonIsDisabled()) {\n      return;\n    }\n\n    const overflowItems = this.moreMenu.children('li:not(.separator)');\n    const hiddenOverflowItems = overflowItems.not('.hidden');\n\n    let method = 'removeClass';\n    if (hiddenOverflowItems.length > 0) {\n      method = 'addClass';\n    }\n\n    this.element[method]('has-more-button');\n\n    const popupAPI = this.more.data('popupmenu');\n    if (method === 'removeClass') {\n      if (!popupAPI) {\n        return;\n      }\n\n      popupAPI.close();\n\n      const menuItems = popupAPI.menu.find('li:not(.separator)').children('a');\n      let shouldFocus = false;\n\n      menuItems.add(this.more).each(function () {\n        if (document.activeElement === this) {\n          shouldFocus = true;\n        }\n      });\n\n      if (shouldFocus) {\n        const lastVisibleButton = this.getLastVisibleButton()[0];\n        if (lastVisibleButton) {\n          lastVisibleButton.focus();\n        }\n      }\n    }\n  },\n\n  /**\n   * Creates an `aria-label` attribute on the toolbar, for bettery accessibility.\n   * Based on AOL Access Guidelines:\n   * http://access.aol.com/dhtml-style-guide-working-group/#toolbar\n   * @private\n   * @returns {void}\n   */\n  buildAriaLabel() {\n    // Don't re-build if one already exists.\n    if (this.element.attr('aria-label')) {\n      return;\n    }\n\n    const isHeader = (this.element.closest('.header').length === 1);\n    const id = this.element.attr('id') || '';\n    const title = this.element.children('.title');\n    const prevLabel = this.element.prev('label');\n    const prevSpan = this.element.prev('.label');\n\n    function getLabelText() {\n      if (isHeader) {\n        return $('header.header').find('h1').text();\n      }\n      if (title.length) {\n        return title.filter('div').text();\n      }\n      if (prevLabel.length) {\n        return prevLabel.text();\n      }\n      if (prevSpan.length) {\n        return prevSpan.text();\n      }\n      return `${id} ${Locale.translate('Toolbar')}`;\n    }\n    const labelText = getLabelText();\n\n    this.element.attr('aria-label', labelText.replace(/\\s+/g, ' ').trim());\n  },\n\n  /**\n   * @param {object} [settings] incoming different settings\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    this\n      .teardown()\n      .init();\n  },\n\n  /**\n   * Enables the entire Toolbar component\n   * @returns {void}\n   */\n  enable() {\n    this.element.prop('disabled', false);\n    this.items.prop('disabled', false);\n    this.more.prop('disabled', false);\n  },\n\n  /**\n   * Disables the entire Toolbar component\n   * @returns {void}\n   */\n  disable() {\n    this.element.prop('disabled', true);\n    this.items.prop('disabled', true);\n    this.more.prop('disabled', true).data('popupmenu').close();\n  },\n\n  /**\n   * Removes currently associated event listeners from the Toolbar.\n   * @private\n   * @chainable\n   * @returns {this} component instance\n   */\n  unbind() {\n    this.items\n      .off('keydown.toolbar click.toolbar focus.toolbar blur.toolbar');\n\n    this.more.off('keydown.toolbar beforeopen.toolbar selected.toolbar');\n    $('body').off(`resize.toolbar-${this.id}`);\n    return this;\n  },\n\n  /**\n   * Returns the Toolbar's internal markup to its original state.\n   * @chainable\n   * @returns {this} component instance\n   */\n  teardown() {\n    const self = this;\n    this.unbind();\n\n    if (this.title && this.title.length) {\n      const dataTooltip = this.title.off('beforeshow.toolbar').data('tooltip');\n      if (dataTooltip) {\n        dataTooltip.destroy();\n      }\n    }\n\n    const moreMenuChildren = this.moreMenu.children('li');\n    moreMenuChildren.each(function () {\n      self.teardownMoreActionsMenuItem($(this), true);\n    });\n\n    // Remove AJAX-ified menu items.\n    moreMenuChildren.not(this.defaultMenuItems).remove();\n\n    return this;\n  },\n\n  /**\n   * Tears down a More Actions Menu item.\n   * @private\n   * @param {jQuery[]} item the existing <li> from inside the More Actions menu.\n   * @param {boolean} doRemove if defined, causes the list item to be removed from\n   *  the more actions menu.\n   */\n  teardownMoreActionsMenuItem(item, doRemove) {\n    const self = this;\n    const li = $(item);\n    const a = li.children('a');\n    const itemLink = a.data('original-button');\n\n    a.off('updated.toolbar mousedown.toolbar click.toolbar touchend.toolbar touchcancel.toolbar recalculate-buttons.toolbar');\n\n    const icons = li.find('.icon');\n    if (icons.length) {\n      icons.remove();\n    }\n\n    let submenuContainer;\n    if (li.is('.submenu')) {\n      submenuContainer = li.children('.wrapper').children('.popupmenu');\n      submenuContainer.children('li').each(function () {\n        self.teardownMoreActionsMenuItem($(this), true);\n      });\n    }\n\n    if (itemLink && itemLink.length) {\n      $.removeData(a[0], 'original-button');\n      $.removeData(itemLink[0], 'action-button-link');\n      a.remove();\n\n      if (submenuContainer) {\n        submenuContainer\n          .off()\n          .parent('.wrapper')\n          .off()\n          .remove();\n      }\n\n      if (doRemove) {\n        li.remove();\n      }\n    }\n  },\n\n  /**\n   * Destroys this Toolbar Component instance and completely disassociates it from\n   *  its corresponding DOM Element.\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n\n    if (this.buttonset.children('.searchfield-wrapper').length) {\n      const searchFields = this.buttonset.children('.searchfield-wrapper').children('.searchfield');\n      if (searchFields.data('searchfield')) {\n        searchFields.data('searchfield').destroy();\n      }\n    }\n\n    if (this.more.length && this.more.data('popupmenu') !== undefined) {\n      this.more.data('popupmenu').destroy();\n    }\n\n    this.element[0].classList.remove('do-resize');\n    this.buttonset[0].style.width = '';\n    if (this.title && this.title.length) {\n      this.title[0].style.width = '';\n    }\n\n    this.element.removeAttr('role').removeAttr('aria-label');\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Toolbar, COMPONENT_NAME };\n","import { Toolbar, COMPONENT_NAME } from './toolbar';\n\n/**\n * jQuery Component Wrapper for Toolbar\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.toolbar = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Toolbar(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\n\n// Component Name\nconst COMPONENT_NAME = 'toolbarflexitem';\n\n// Filters out buttons located inside of Searchfield wrappers.\n// Only `input` elements should be picked up by the item detector.\nfunction buttonFilter(elem) {\n  const searchfieldWrapper = $(elem).parents('.searchfield-wrapper, .toolbar-searchfield-wrapper');\n  return !searchfieldWrapper.length;\n}\n\n// Filters out hyperlinks that are part of menu/action button components\nfunction hyperlinkFilter(elem) {\n  if (elem.nodeName !== 'A') {\n    throw new Error('Unspecified error occured');\n  }\n\n  const wrapped = $(elem);\n  return wrapped.parents('.popupmenu').length < 1;\n}\n\n// Toolbar Focusable Element Selectors.\n// Any of these element/class types are valid toolbar items.\n// TODO: Designate between \"button\" and \"menu button\"\nconst TOOLBAR_ELEMENTS = [\n  { type: 'button', selector: 'button:not(.btn-menu):not(.btn-actions):not(.colorpicker-editor-button), input[type=\"button\"]:not(.btn-menu):not(.btn-actions):not(.colorpicker-editor-button)', filter: buttonFilter },\n  { type: 'menubutton', selector: '.btn-menu' },\n  { type: 'actionbutton', selector: '.btn-actions' },\n  { type: 'colorpicker', selector: '.colorpicker-editor-button' },\n  { type: 'hyperlink', selector: 'a[href]', filter: hyperlinkFilter },\n  { type: 'checkbox', selector: 'input[type=\"checkbox\"]' },\n  { type: 'radio', selector: 'input[type=\"radio\"]' },\n  { type: 'searchfield', selector: '.searchfield' },\n  { type: 'toolbarsearchfield', selector: '.toolbarsearchfield' } // temporary\n];\n\n// Mappings from toolbar item type to component API\nconst TOOLBAR_COMPONENT_APIS = {\n  actionbutton: 'popupmenu',\n  colorpicker: 'colorpicker',\n  menubutton: 'popupmenu',\n  hyperlink: 'hyperlink',\n  searchfield: 'searchfield',\n  toolbarsearchfield: 'searchfield'\n};\n\n/**\n * Default Settings\n * @namespace\n */\nconst TOOLBAR_FLEX_ITEM_DEFAULTS = {\n  disabled: false,\n  readOnly: false,\n  hidden: false,\n  componentSettings: undefined\n};\n\n/**\n * Gets the type of Toolbar Item that an element represents.\n * @param {HTMLElement} element being checked for a toolbar item.\n * @returns {string} representing the type\n */\nfunction getToolbarItemType(element) {\n  let type = false;\n  TOOLBAR_ELEMENTS.forEach((elemObj) => {\n    if (!$(element).is(elemObj.selector)) {\n      return;\n    }\n    if (typeof elemObj.filter === 'function' && !elemObj.filter(element)) {\n      return;\n    }\n    type = elemObj.type;\n  });\n\n  if (!type) {\n    throw new Error(`Element ${element} is not a valid Toolbar Item Type.`);\n  }\n\n  return type;\n}\n\n/**\n * Toolbar Item Wrapper Component\n * @constructor\n * @param {HTMLElement} element the base element\n * @param {object} [settings] incoming settings\n */\nfunction ToolbarFlexItem(element, settings) {\n  this.element = element;\n  this.settings = utils.mergeSettings(this.element, settings, TOOLBAR_FLEX_ITEM_DEFAULTS);\n\n  this.init();\n}\n\nToolbarFlexItem.prototype = {\n\n  /**\n   * @property {string} type used to determine the type of toolbar item.  Certain toolbar item types\n   *  have certain special properties.\n   * @property {HTMLElement} section the parent toolbar section that this item is housed in.\n   * @property {HTMLElement} toolbar the parent toolbar's base element.\n   */\n  type: undefined,\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    // internal flags\n    this.type = getToolbarItemType(this.element);\n    this.section = this.element.parentElement;\n    this.toolbar = this.section.parentElement;\n    this.trueSelected = false;\n  },\n\n  /**\n   * @returns {boolean} whether or not the toolbar item is currently able to be focused, based\n   *  on its `disabled`, `overflowed`, and `visible` properties.\n   */\n  get focusable() {\n    if (this.disabled === true) {\n      return false;\n    }\n    if (this.type === 'searchfield') {\n      return true;\n    }\n    if (this.type === 'actionbutton' && this.hasNoOverflowedItems === true) {\n      return false;\n    }\n    if (this.overflowed === true) {\n      return false;\n    }\n\n    return this.visible;\n  },\n\n  /**\n   * @returns {boolean} whether or not the toolbar item is the one that will currently be focused\n   */\n  get focused() {\n    return this.element.tabIndex === 0;\n  },\n\n  /**\n   * @param {boolean} boolean, if provided, sets a focused state on the toolbar item.\n   * @returns {void}\n   */\n  set focused(boolean) {\n    if (boolean) {\n      this.element.tabIndex = 0;\n      return;\n    }\n    this.element.tabIndex = -1;\n  },\n\n  /**\n   * @returns {boolean} whether or not the Toolbar item is selected.\n   */\n  get selected() {\n    return this.trueSelected;\n  },\n\n  /**\n   * @param {boolean} boolean, if provided, sets a selected state on the toolbar item.\n   * @returns {void}\n   */\n  set selected(boolean) {\n    if (boolean) {\n      this.trueSelected = true;\n      this.element.classList.add('is-selected');\n      this.triggerSelectedEvent();\n\n      if (this.selectedAnchor) {\n        delete this.selectedAnchor;\n      }\n      return;\n    }\n    this.trueSelected = false;\n    this.element.classList.remove('is-selected');\n  },\n\n  /**\n   * Retrieves an item's main Soho Component instance.\n   * @returns {object} Soho Component instance, if applicable\n   */\n  get componentAPI() {\n    const $element = $(this.element);\n    const componentType = TOOLBAR_COMPONENT_APIS[this.type];\n\n    if (!componentType) {\n      return undefined;\n    }\n\n    return $element.data(componentType);\n  },\n\n  /**\n   * @returns {ToolbarFlex} the parent toolbar API\n   */\n  get toolbarAPI() {\n    if (this.settings.toolbarAPI) {\n      return this.settings.toolbarAPI;\n    }\n    return $(this.toolbar).data('toolbar-flex');\n  },\n\n  /**\n   * @fires selected\n   * @returns {void}\n   */\n  triggerSelectedEvent() {\n    // Searchfields and Colorpickers aren't \"selectable\" in the same way actionable\n    // items are, so they shouldn't fire the \"selected\" event.\n    const disallowedTypes = ['colorpicker', 'searchfield', 'toolbarsearchfield'];\n    if (disallowedTypes.indexOf(this.type) > -1) {\n      return;\n    }\n\n    const eventArgs = [this];\n\n    // MenuButton types pass the currently-selected anchor\n    const selectedAnchorTypes = ['menubutton', 'actionbutton'];\n    if (selectedAnchorTypes.indexOf(this.type) > -1 && this.selectedAnchor) {\n      eventArgs.push(this.selectedAnchor);\n    }\n\n    $(this.element).trigger('selected', eventArgs);\n  },\n\n  /**\n   * Causes the toolbar item to become visible.\n   * @returns {void}\n   */\n  show() {\n    this.visible = true;\n  },\n\n  /**\n   * Causes the toolbar item to become hidden.\n   * @returns {void}\n   */\n  hide() {\n    this.visible = false;\n  },\n\n  /**\n   * Toggles the Toolbar item's visiblity.\n   * @param {boolean} boolean whether or not the `hidden` class should be set.\n   */\n  set visible(boolean) {\n    // NOTE: Temporary until Searchfield handles this better internally.\n    const isSearchfield = this.type === 'searchfield' || this.type === 'toolbarsearchfield';\n\n    if (boolean) {\n      if (isSearchfield) {\n        this.element.parentNode.classList.remove('hidden');\n      }\n      this.element.classList.remove('hidden');\n      return;\n    }\n\n    if (isSearchfield) {\n      this.element.parentNode.classList.add('hidden');\n    }\n    this.element.classList.add('hidden');\n  },\n\n  /**\n   * @returns {boolean} whether or not the Toolbar Item is visible.\n   */\n  get visible() {\n    return this.element.className.indexOf('hidden') === -1;\n  },\n\n  /**\n   * @returns {void}\n   */\n  enable() {\n    this.disabled = false;\n    if (this.hasReadOnly) {\n      this.readOnly = false;\n    }\n  },\n\n  /**\n   * @returns {boolean} whether or not the element is disabled\n   */\n  get disabled() {\n    return this.element.disabled;\n  },\n\n  /**\n   * @param {boolean} boolean, if provided, sets a disabled state on the toolbar item.\n   * @returns {void}\n   */\n  set disabled(boolean) {\n    if (boolean) {\n      this.element.disabled = true;\n      this.element.setAttribute('aria-disabled', true);\n      this.element.readOnly = false;\n      return;\n    }\n\n    this.element.disabled = false;\n    this.element.removeAttribute('aria-disabled');\n  },\n\n  /**\n   * @returns {boolean} whether or not `readOnly` as a property exists on this HTMLElement type.\n   */\n  get hasReadOnly() {\n    return 'readOnly' in this.element;\n  },\n\n  /**\n   * @returns {boolean} element's readOnly prop\n   */\n  get readOnly() {\n    if (!this.hasReadOnly) {\n      return false;\n    }\n    return this.element.readOnly;\n  },\n\n  /**\n   * @param {boolean} boolean, if provided, sets a readOnly state on the toolbar item, if possible.\n   * @returns {void}\n   */\n  set readOnly(boolean) {\n    if (!this.hasReadOnly) {\n      return;\n    }\n\n    if (boolean) {\n      this.disabled = false;\n      this.element.disabled = false;\n      this.element.readOnly = true;\n      return;\n    }\n\n    this.element.readOnly = false;\n  },\n\n  /**\n   * @returns {boolean} whether or not the item is pushed into overflow by the boundaries\n   *  of its container element.\n   */\n  get overflowed() {\n    const isRTL = env.rtl;\n    const elemRect = this.element.getBoundingClientRect();\n    const sectionRect = this.section.getBoundingClientRect();\n\n    if (isRTL) {\n      return elemRect.left < sectionRect.left;\n    }\n    return elemRect.right > sectionRect.right;\n  },\n\n  /**\n   * @param {boolean} isTrue whether or not the more actions menu has overflowed items, causing it to become displayed\n   * @returns {void}\n   */\n  set hasNoOverflowedItems(isTrue) {\n    if (this.type !== 'actionbutton' || !this.componentAPI) {\n      return;\n    }\n\n    const popupmenuLength = this.componentAPI.toData({ noMenuWrap: true }).length;\n    const menuIsEmpty = (popupmenuLength - this.predefinedItems.length) < 1;\n\n    if (isTrue && menuIsEmpty) {\n      this.element.classList.add('no-overflowed-items');\n      this.trueHasNoOverflowedItems = true;\n\n      if (this.focused) {\n        this.toolbarAPI.focusedItem = this;\n        this.toolbarAPI.navigate(-1, undefined, true);\n      }\n      return;\n    }\n    this.trueHasNoOverflowedItems = false;\n    this.element.classList.remove('no-overflowed-items');\n  },\n\n  /**\n   *\n   */\n  get hasNoOverflowedItems() {\n    if (!this.componentAPI) {\n      return true;\n    }\n    return this.trueHasNoOverflowedItems;\n  },\n\n  /**\n   * Sets up all event listeners for this element.\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const $element = $(this.element);\n\n    const popupmenuConsumers = ['menubutton', 'actionbutton', 'colorpicker'];\n    if (popupmenuConsumers.indexOf(this.type) > -1) {\n      // Listen to the Popupmenu's selected event\n      $element.on(`selected.${COMPONENT_NAME}`, (e, anchor) => {\n        if (this.selectedAnchor) {\n          return;\n        }\n\n        e.stopPropagation();\n\n        if (this.type === 'actionbutton') {\n          const li = $(anchor).parent();\n          let itemLink = li.data('originalButton');\n          let itemLinkAPI = $(itemLink).data('toolbarflexitem');\n          let elementLink;\n\n          if (li.parents('ul').length > 1) {\n            elementLink = li.data('original-menu-element');\n            itemLink = li.parents('li').last().data('originalButton');\n            itemLinkAPI = $(itemLink).data('toolbarflexitem');\n          }\n\n          // If this item is linked to another toolbar item, trigger its `selected` event instead\n          // of the one on the item in this menu.\n          if (itemLinkAPI) {\n            if (elementLink) {\n              e.preventDefault();\n              itemLinkAPI.selectedAnchor = $(elementLink).children('a');\n            } else {\n              // case of a menu button overflowed into more actions\n              itemLinkAPI.selectedAnchor = anchor;\n            }\n            itemLinkAPI.selected = true;\n            return;\n          }\n        }\n\n        self.selectedAnchor = anchor;\n        self.selected = true;\n      });\n    }\n\n    if (this.type === 'actionbutton') {\n      $element.on(`beforeopen.${COMPONENT_NAME}`, this.handleActionButtonBeforeOpen.bind(this));\n      $('body').off(`resize.${COMPONENT_NAME}`).on(`resize.${COMPONENT_NAME}`, this.handleActionButtonResize.bind(this));\n    }\n\n    $element.on(`focus.${COMPONENT_NAME}`, this.handleFocus.bind(this));\n  },\n\n  /**\n   * If this element is an Action Button, this listener runs before its popupmenu is opened\n   * To determine which elements need to be shown/hidden.\n   * @private\n   * @returns {void}\n   */\n  handleActionButtonBeforeOpen() {\n    this.refreshMoreActionsMenu();\n  },\n\n  /**\n   * If this element is an Action Button, this listener runs whenever Soho's custom resize event\n   * on the `<body>` tag fires, to determine which elements need to be shown/hidden.\n   * @private\n   * @returns {void}\n   */\n  handleActionButtonResize() {\n    this.refreshMoreActionsMenu();\n  },\n\n  /**\n   * @private\n   * @param {FocusEvent} e `focus`\n   * @returns {void}\n   */\n  handleFocus(e) {\n    if (e.target && e.target === this.element) {\n      this.toolbarAPI.focusedItem = this;\n    }\n  },\n\n  /**\n   * Renders extra markup or anything else needed on the toolbar item\n   * @returns {void}\n   */\n  render() {\n    this.disabled = this.disabled;\n    if (this.hasReadOnly) {\n      this.readonly = this.readonly;\n    }\n\n    // Setup component APIs, if applicable.\n    // NOTE: Soho Initializer doesn't invoke these automatically, by nature of the\n    // base elements existing inside the Flex Toolbar.\n    const $element = $(this.element);\n    const componentType = TOOLBAR_COMPONENT_APIS[this.type];\n    if (componentType) {\n      const api = $element.data(componentType);\n      if (!api) {\n        $element[componentType](this.settings.componentSettings);\n      } else {\n        api.updated(this.settings.componentSettings);\n      }\n    }\n\n    // Action Buttons need more stuff\n    if (this.type === 'actionbutton') {\n      this.renderMoreActionsMenu();\n      this.refreshMoreActionsMenu();\n    }\n\n    this.handleEvents();\n  },\n\n  /**\n   * Uses data from Toolbar Items to build Toolbar-linked, pre-defined items for the More Actions menu.\n   * NOTE: This method only runs when this toolbar item is a \"More Actions\" button\n   * @private\n   * @returns {void}\n   */\n  renderMoreActionsMenu() {\n    const menuAPI = this.componentAPI;\n    if (!menuAPI || !this.toolbarAPI) {\n      return;\n    }\n\n    // If the menu doesn't already exist, pre-define it.\n    let $menu = menuAPI.menu;\n    if (!$menu || !$menu.length) {\n      $menu = $('<ul class=\"popupmenu\"></ul>').insertAfter(this.element);\n    }\n\n    this.teardownPredefinedItems();\n\n    // Add Toolbar Items\n    const data = this.toolbarAPI.toPopupmenuData();\n    const menuItems = $(menuAPI.renderItem(data));\n    this.predefinedItems = menuItems;\n    this.linkToolbarItems(data);\n\n    // Notify the Popupmenu of predefined items\n    $menu.prepend(this.predefinedItems);\n    menuAPI.updated({\n      menu: $menu,\n      predefined: menuItems\n    });\n\n    this.menuRendered = true;\n  },\n\n  /**\n   * Refreshes the state of menu items in a \"More Actions\" menu that were constructed by the Flex Toolbar.\n   * @private\n   * @returns {void}\n   */\n  refreshMoreActionsMenu() {\n    if (this.type !== 'actionbutton') {\n      return;\n    }\n\n    this.hasNoOverflowedItems = true;\n\n    const menuAPI = this.componentAPI;\n    if (!menuAPI || !this.toolbarAPI) {\n      return;\n    }\n\n    // If there are toolbar items, but no predefined items, render the more-actions menu\n    if ((!this.predefinedItems || !this.predefinedItems.length) && this.toolbarAPI.items.length) {\n      this.renderMoreActionsMenu();\n    }\n\n    let hasNoOverflowedItems = true;\n\n    // Called at the end of the item refresh.\n    // Uses the Popupmenu's API to add overflow information.\n    function itemRefreshCallback(menuItem, data) {\n      if (data.isSubmenuItem) {\n        return;\n      }\n\n      if (data.overflowed === true) {\n        menuItem.classList.add('is-overflowed');\n\n        if (data.visible) {\n          menuItem.classList.remove('hidden');\n        }\n\n        hasNoOverflowedItems = false;\n        return;\n      }\n\n      menuItem.classList.remove('is-overflowed');\n      menuItem.classList.add('hidden');\n    }\n\n    // Each Linked Toolbar Item will be refreshed by the Popupmenu API\n    this.toolbarAPI.items.forEach((item) => {\n      if (!item.actionButtonLink) {\n        return;\n      }\n\n      const itemData = item.toPopupmenuData();\n      itemData.overflowed = item.overflowed;\n\n      menuAPI.refreshMenuItem(item.actionButtonLink, itemData, itemRefreshCallback);\n    });\n\n    // Set a record for display\n    this.hasNoOverflowedItems = hasNoOverflowedItems;\n  },\n\n  /**\n   * Removes links between the current set of Toolbar Items to `More Actions` menu items.\n   * @private\n   * @returns {void}\n   */\n  unlinkToolbarItems() {\n    if (this.type !== 'actionbutton' || !this.menuRendered || !this.predefinedItems || !this.predefinedItems.length) {\n      return;\n    }\n\n    function doUnlinkSubmenuItem(actionMenuElement) {\n      const $originalMenuElement = $($(actionMenuElement).data('original-menu-element'));\n      $originalMenuElement.removeData('action-button-link');\n      $(actionMenuElement).removeData('original-menu-element');\n\n      if ($originalMenuElement.hasClass('submenu')) {\n        const submenuItems = actionMenuElement.querySelector('.popupmenu').children;\n        for (let j = 0; j < submenuItems.length; j++) {\n          doUnlinkSubmenuItem(submenuItems[j]);\n        }\n      }\n    }\n\n    function doUnlinkToolbarItems(i, itemElement) {\n      const originalButton = $(itemElement).data('originalButton');\n      const originalButtonAPI = $(originalButton).data('toolbarflexitem');\n\n      originalButtonAPI.actionButtonLink = null;\n      $(itemElement).removeData('original-button');\n\n      if (originalButtonAPI.type === 'menubutton') {\n        const submenuItems = itemElement.querySelector('.popupmenu').children;\n        for (let j = 0; j < submenuItems.length; j++) {\n          doUnlinkSubmenuItem(submenuItems[j]);\n        }\n      }\n    }\n\n    this.predefinedItems.each(doUnlinkToolbarItems);\n  },\n\n  /**\n   * Links the current set of Toolbar Items to the `More Actions` menu items.\n   * @private\n   * @param {object} popupmenuData incoming popupmenu data\n   * @returns {void}\n   */\n  linkToolbarItems(popupmenuData) {\n    if (this.type !== 'actionbutton' || !popupmenuData) {\n      return;\n    }\n\n    if (!Array.isArray(popupmenuData)) {\n      popupmenuData = popupmenuData.menu;\n    }\n\n    function doLinkSubmenuItem(menuItemData, actionMenuElement) {\n      const originalMenuElement = menuItemData.elementLink;\n      $(originalMenuElement).data('action-button-link', actionMenuElement);\n      $(actionMenuElement).data('original-menu-element', originalMenuElement);\n\n      const submenu = menuItemData.submenu;\n      if (submenu && submenu.length) {\n        const submenuItems = actionMenuElement.querySelector('.popupmenu').children;\n        for (let j = 0; j < submenuItems.length; j++) {\n          doLinkSubmenuItem(submenu[j], submenuItems[j]);\n        }\n      }\n    }\n\n    function doLinkToolbarItems(i, itemElement) {\n      const originalButtonAPI = popupmenuData[i].itemLink;\n      originalButtonAPI.actionButtonLink = itemElement;\n      $(itemElement).data('original-button', originalButtonAPI.element);\n\n      const submenu = popupmenuData[i].submenu;\n      if (submenu && submenu.length) {\n        const submenuItems = itemElement.querySelector('.popupmenu').children;\n        for (let j = 0; j < submenuItems.length; j++) {\n          doLinkSubmenuItem(submenu[j], submenuItems[j]);\n        }\n      }\n    }\n\n    this.predefinedItems.each(doLinkToolbarItems);\n  },\n\n  /**\n   * Converts the contents of the Toolbar Item to a data structure that's compatible with a Popupmenu component.\n   * This data structure can be used to populate the contents of a \"More Actions\" menu.\n   * @returns {object} an object representation of the Toolbar Item as a Popupmenu Item.\n   */\n  toPopupmenuData() {\n    if (this.type === 'searchfield' || this.type === 'toolbarsearchfield' || this.type === 'actionbutton') {\n      return undefined;\n    }\n\n    const itemData = {\n      itemLink: this,\n      disabled: this.disabled,\n      visible: this.visible\n    };\n\n    const icon = this.element.querySelector('.icon:not(.close):not(.icon-dropdown) > use');\n    if (icon) {\n      itemData.icon = icon.getAttribute('xlink:href').replace('#icon-', '');\n    }\n\n    if (this.type === 'button' || this.type === 'menubutton') {\n      itemData.text = this.element.textContent.trim();\n    }\n\n    function addMenuElementLinks(menu, data) {\n      const elems = menu.querySelectorAll('li:not(.heading)');\n      data.forEach((item, i) => {\n        item.elementLink = elems[i];\n        if (item.submenu) {\n          const submenu = elems[i].querySelector('.popupmenu');\n          item.submenu = addMenuElementLinks(submenu, item.submenu);\n        }\n      });\n      return data;\n    }\n\n    // Add links to the menubutton's menu item elements to the Popupmenu data\n    if (this.type === 'menubutton') {\n      const menuElem = this.componentAPI.menu;\n      const originalSubmenuData = this.componentAPI.toData({ noMenuWrap: true });\n      itemData.id = this.componentAPI.element[0].id;\n      itemData.submenu = addMenuElementLinks(menuElem[0], originalSubmenuData);\n    }\n\n    return itemData;\n  },\n\n  /**\n   * Converts the current state of the toolbar item to an object structure that can be\n   * easily passed back/forth and tested.\n   * @returns {object} containing the current Toolbar Item state.\n   */\n  toData() {\n    const itemData = {\n      type: this.type,\n      disabled: this.disabled,\n      focused: this.focused,\n      selected: this.selected,\n      overflowed: this.overflowed,\n      visible: this.visible\n    };\n\n    if (this.hasReadOnly) {\n      itemData.readOnly = this.readOnly;\n    }\n\n    if (this.actionButtonLink) {\n      itemData.actionButtonLink = this.actionButtonLink;\n    }\n\n    if (this.componentAPI) {\n      itemData.componentAPI = this.componentAPI;\n    }\n\n    const icon = this.element.querySelector('.icon:not(.close):not(.icon-dropdown) > use');\n    if (icon) {\n      itemData.icon = icon.getAttribute('xlink:href').replace('#icon-', '');\n    }\n\n    if (this.type === 'button' || this.type === 'menubutton') {\n      itemData.text = this.element.textContent.trim();\n    }\n\n    if (this.type === 'actionbutton') {\n      itemData.predefinedItems = this.predefinedItems;\n    }\n\n    if (this.type === 'menubutton' || this.type === 'actionbutton') {\n      // TODO: Need to convert a Popupmenu's contents to the object format with this method\n      itemData.submenu = this.componentAPI.toData({ noMenuWrap: true });\n    }\n\n    return itemData;\n  },\n\n  /**\n   * Completely updates this component with (optional) new settings.\n   * @param {object} [settings] incoming settings\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.teardown();\n    this.init();\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  teardownPredefinedItems() {\n    if (this.type !== 'actionbutton') {\n      return;\n    }\n\n    this.unlinkToolbarItems();\n    if (this.predefinedItems && this.predefinedItems.length) {\n      this.predefinedItems.remove();\n    }\n  },\n\n  /**\n   * Unbinds events and removes preset internal flags for this component.\n   * @returns {void}\n   */\n  teardown() {\n    $(this.element)\n      .off(`selected.${COMPONENT_NAME}`)\n      .off(`beforeopen.${COMPONENT_NAME}`)\n      .off(`focus.${COMPONENT_NAME}`);\n\n    $('body').off(`resize.${COMPONENT_NAME}`);\n\n    this.teardownPredefinedItems();\n\n    delete this.type;\n    delete this.selected;\n    delete this.focusable;\n    delete this.visible;\n    delete this.disabled;\n    delete this.readOnly;\n\n    delete this.section;\n    delete this.toolbar;\n    delete this.trueSelected;\n    delete this.menuRendered;\n  }\n\n};\n\nexport { ToolbarFlexItem, getToolbarItemType, COMPONENT_NAME, TOOLBAR_ELEMENTS };\n","import { ToolbarFlexItem, COMPONENT_NAME } from './toolbar-flex.item';\n\n/**\n * jQuery component wrapper for Toolbar Flex Item Component\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.toolbarflexitem = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ToolbarFlexItem(this, settings));\n\n      // Remove the jQuery Component reference from $.data\n      const oldDestroy = instance.destroy;\n      instance.destroy = function () {\n        if (typeof oldDestroy === 'function') {\n          oldDestroy.call(this);\n        }\n        $.removeData(this, COMPONENT_NAME);\n      };\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { log } from '../../utils/debug';\nimport { ToolbarFlexItem, TOOLBAR_ELEMENTS } from './toolbar-flex.item';\n\n// jQuery Components\nimport './toolbar-flex.item.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'toolbar-flex';\n\n/**\n * Component Default Settings\n * @namespace\n */\nconst TOOLBAR_FLEX_DEFAULTS = {\n  // ajax function to be called before the more menu is opened\n  beforeMoreMenuOpen: null\n};\n\n/**\n * @constructor\n * @param {HTMLElement} element the base element\n * @param {object} [settings] incoming settings\n */\nfunction ToolbarFlex(element, settings) {\n  this.element = element;\n  this.settings = utils.mergeSettings(this.element, settings, TOOLBAR_FLEX_DEFAULTS);\n\n  this.init();\n}\n\nToolbarFlex.prototype = {\n\n  /**\n   * @private\n   */\n  trueFocusedItem: undefined,\n\n  sections: [],\n\n  items: [],\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.sections = utils.getArrayFromList(this.element.querySelectorAll('.toolbar-section'));\n    this.items = this.getElements().map((item) => {\n      const itemComponentSettings = {};\n      if ($(item).hasClass('btn-actions') && !!this.settings.beforeMoreMenuOpen) {\n        itemComponentSettings.beforeOpen = this.settings.beforeMoreMenuOpen;\n      }\n      $(item).toolbarflexitem({\n        toolbarAPI: this,\n        componentSettings: itemComponentSettings\n      });\n      return $(item).data('toolbarflexitem');\n    });\n\n    if (!this.items) {\n      return;\n    }\n\n    // Check for a focused item\n    this.items.forEach((item) => {\n      if (item.focused) {\n        if (this.focusedItem === undefined) {\n          this.focusedItem = item;\n        } else {\n          item.focused = false;\n        }\n      }\n    });\n    if (!this.focusedItem) {\n      this.focusedItem = this.items[0];\n    }\n\n    this.render();\n    this.handleEvents();\n  },\n\n  /**\n   * @returns {void}\n   */\n  render() {\n    this.element.setAttribute('role', 'toolbar');\n    this.items.forEach((item) => {\n      item.render();\n    });\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    this.keydownListener = this.handleKeydown.bind(this);\n    this.element.addEventListener('keydown', this.keydownListener);\n\n    this.keyupListener = this.handleKeyup.bind(this);\n    this.element.addEventListener('keyup', this.keyupListener);\n\n    this.clickListener = this.handleClick.bind(this);\n    this.element.addEventListener('click', this.clickListener);\n\n    $(this.element).on(`selected.${COMPONENT_NAME}`, (e, ...args) => {\n      log('dir', args);\n    });\n\n    // Inlined Searchfields can cause navigation requiring a focus change to occur on collapse.\n    $(this.element).on(`collapsed-responsive.${COMPONENT_NAME}`, (e, direction) => {\n      e.stopPropagation();\n      this.navigate(direction, null, true);\n    });\n  },\n\n  /**\n   * Event Handler for internal `keydown` events.\n   * @private\n   * @param {KeyboardEvent} e `keydown`\n   * @returns {void}\n   */\n  handleKeydown(e) {\n    const target = e.target;\n\n    // Toolbar Items get handled separately.\n    if ($(target).data('toolbarflexitem')) {\n      this.handleItemKeydown(e);\n    }\n  },\n\n  /**\n   * Event Handler for internal `keydown` events, specifically on Toolbar Items.\n   * @private\n   * @param {KeyboardEvent} e `keydown`\n   * @returns {void}\n   */\n  handleItemKeydown(e) {\n    const key = e.key;\n    const item = this.getItemFromElement(e.target);\n    function preventScrolling() {\n      e.preventDefault();\n    }\n\n    // NOTE: 'Enter' and 'SpaceBar' are purposely not handled on keydown, since\n    // a `click` event will be fired on Toolbar items while pressing either of these keys.\n    if (key === 'Enter') {\n      this.clickByEnterKey = true;\n      return;\n    }\n\n    if (key === ' ') { // SpaceBar\n      if (item.type === 'hyperlink') {\n        this.select(e.target);\n      }\n      return;\n    }\n\n    // Left Navigation\n    const leftNavKeys = ['ArrowLeft', 'Left', 'ArrowUp', 'Up'];\n    if (leftNavKeys.indexOf(key) > -1) {\n      if (item.type === 'searchfield' && (key === 'ArrowLeft' || key === 'Left')) {\n        return;\n      }\n      this.navigate(-1, undefined, true);\n      preventScrolling();\n      return;\n    }\n\n    // Right Navigation\n    const rightNavKeys = ['ArrowRight', 'Right', 'ArrowDown', 'Down'];\n    if (rightNavKeys.indexOf(key) > -1) {\n      if (item.type === 'searchfield' && (key === 'ArrowRight' || key === 'Right')) {\n        return;\n      }\n      this.navigate(1, undefined, true);\n      preventScrolling();\n    }\n  },\n\n  /**\n   * Event Handler for internal `keyup` events\n   * @private\n   * @param {KeyboardEvent} e `keyup`\n   * @returns {void}\n   */\n  handleKeyup(e) {\n    this.clearClickByEnter(e);\n  },\n\n  /**\n   * Event Handler for internal `click` events\n   * @private\n   * @param {MouseEvent} e `click`\n   * @returns {void}\n   */\n  handleClick(e) {\n    const target = e.target;\n\n    // Toolbar Items get handled separately.\n    if ($(target).data('toolbarflexitem')) {\n      this.handleItemClick(e);\n    }\n\n    this.clearClickByEnter();\n  },\n\n  /**\n   * Event Handler for internal `click` events, specifically on Toolbar Items.\n   * @private\n   * @param {MouseEvent} e `click`\n   * @returns {void}\n   */\n  handleItemClick(e) {\n    const item = this.getItemFromElement(e.target);\n\n    this.select(item);\n    this.focusedItem = item;\n  },\n\n  /**\n   * @private\n   * @param {Event} e incoming event of multiple types\n   * @returns {void}\n   */\n  clearClickByEnter(e) {\n    // Gets set in `this.handleItemKeydown` by pressing 'Enter'.\n    if (this.clickByEnterKey) {\n      // Prevents the enter key from triggering a `selected` event on the menu button.\n      if (this.type === 'menubutton' || this.type === 'actionbutton') {\n        e.preventDefault();\n      }\n      delete this.clickByEnterKey;\n    }\n  },\n\n  /**\n   * Gets all the elements currently inside the Toolbar Markup.\n   * The array of items produced is ordered by Toolbar Section.\n   * @returns {array} of Toolbar Items\n   */\n  getElements() {\n    const items = [];\n    let allSelectors = [];\n\n    // Build a really big selector containing all possible matches\n    TOOLBAR_ELEMENTS.forEach((elemObj) => {\n      allSelectors.push(elemObj.selector);\n    });\n    allSelectors = allSelectors.join(', ');\n\n    // Get all possible Toolbar Element matches\n    // NOTE: Important that the toolbar items are picked up by the querySelector\n    // in their actual, physical DOM order.\n    const thisElems = utils.getArrayFromList(this.element.querySelectorAll(allSelectors));\n\n    // Check each element for each type of toolbar item.\n    // If there's a match, push to the item array.\n    thisElems.forEach((elem) => {\n      let defined = false;\n      TOOLBAR_ELEMENTS.forEach((elemObj) => {\n        if (defined || !$(elem).is(elemObj.selector)) {\n          return;\n        }\n        if (typeof elemObj.filter === 'function') {\n          if (!elemObj.filter(elem)) {\n            return;\n          }\n        }\n        defined = true;\n        items.push(elem);\n      });\n    });\n\n    return items;\n  },\n\n  /**\n   * @param {HTMLElement|ToolbarFlexItem} element the element to be checked\n   * @returns {ToolbarFlexItem} an instance of a Toolbar item\n   */\n  getItemFromElement(element) {\n    if (element instanceof ToolbarFlexItem) {\n      return element;\n    }\n\n    let item;\n    for (let i = 0; i < this.items.length; i++) {\n      // Simple comparison of innerHTML to figure out if the elements match up\n      if (this.items[i].element.innerHTML === element.innerHTML) {\n        item = this.items[i];\n      }\n    }\n\n    if (!item) {\n      throw new Error(`No Toolbar Item instance available for element ${element}.`);\n    }\n\n    return item;\n  },\n\n  /**\n   * If this toolbar contains a searchfield, this alias returns a reference to its ComponentAPI property.\n   * If no searchfield exists, it returns `undefined`\n   * @returns {Searchfield|undefined} a reference to the componentAPI of the searchfield item.\n   */\n  get searchfieldAPI() {\n    for (let i = 0; i < this.items.length; i++) {\n      if (this.items[i].type === 'searchfield') {\n        return this.items[i].componentAPI;\n      }\n    }\n    return undefined;\n  },\n\n  /**\n   * @returns {ToolbarFlexItem|undefined} either a toolbar item, or undefined if one\n   *  wasn't previously focused.\n   */\n  get focusedItem() {\n    if (this.trueFocusedItem) {\n      return this.trueFocusedItem;\n    }\n    for (let i = 0; i < this.items.length; i++) {\n      if (this.items[i].focused === true) {\n        return this.items[i];\n      }\n    }\n    return undefined;\n  },\n\n  /**\n   * Sets the currently focused item\n   * @param {ToolbarFlexItem} item the item to be focused\n   */\n  set focusedItem(item) {\n    if (this.items.length === 0) {\n      return;\n    }\n\n    for (let i = 0; i < this.items.length; i++) {\n      this.items[i].focused = false;\n    }\n    item.focused = true;\n    this.trueFocusedItem = item;\n  },\n\n  // Flag for figuring out if a Toolbar's items are all completely unavailable for keyboard focus.\n  get hasFocusableItems() {\n    for (let i = 0; i < this.items.length; i++) {\n      if (this.items[i].focusable === true) {\n        return true;\n      }\n    }\n    return false;\n  },\n\n  /**\n   * @returns {boolean} determining whether or not the Flex Toolbar has the authority to currently control focus\n   */\n  get canManageFocus() {\n    const activeElement = document.activeElement;\n    if (this.element.contains(activeElement)) {\n      return true;\n    }\n\n    // If the searchfield currently has focus, return true\n    for (let i = 0; i < this.items.length; i++) {\n      if (this.items[i].type === 'searchfield' && this.items[i].componentAPI.isFocused) {\n        return true;\n      }\n    }\n\n    if (activeElement.tagName === 'BODY') {\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * @returns {ToolbarFlexItem[]} all overflowed items in the toolbar\n   */\n  get overflowedItems() {\n    const overflowed = [];\n\n    for (let i = 0; i < this.items.length; i++) {\n      if (this.items[i].overflowed === true) {\n        overflowed.push(this.items[i]);\n      }\n    }\n\n    return overflowed;\n  },\n\n  /**\n   * Navigates among toolbar items and gets a reference to a potential target for focus.\n   * @param {number} direction positive/negative value representing how many spaces to move\n   * @param {number} [currentIndex] the index to start checking from\n   *  the current focus either right/left respectively.\n   * @param {boolean} [doSetFocus=false] if set to true, will cause navigation to also set focus.\n   */\n  navigate(direction, currentIndex, doSetFocus) {\n    if (this.hasFocusableItems === false) {\n      log('No focusable items');\n      return;\n    }\n\n    // reference the original direction for later, if placement fails.\n    const originalDirection = 0 + direction;\n\n    if (currentIndex === undefined || currentIndex === null) {\n      currentIndex = this.items.indexOf(this.focusedItem);\n    }\n\n    log(`Toolbar Navigation: ${direction} points away from index ${currentIndex}`);\n\n    while (direction !== 0) {\n      if (direction > 0) {\n        if (currentIndex === this.items.length - 1) {\n          currentIndex = 0;\n        } else {\n          currentIndex++;\n        }\n        --direction;\n      }\n      if (direction < 0) {\n        if (currentIndex === 0) {\n          currentIndex = this.items.length - 1;\n        } else {\n          --currentIndex;\n        }\n        direction++;\n      }\n    }\n\n    const targetItem = this.items[currentIndex];\n    if (targetItem.focusable === false) {\n      this.navigate(originalDirection > 0 ? 1 : -1, currentIndex, doSetFocus);\n      return;\n    }\n\n    // Retain a reference to the focused item and set focus, if applicable.\n    this.focusedItem = targetItem;\n    if (doSetFocus && this.canManageFocus) {\n      this.focusedItem.element.focus();\n    }\n  },\n\n  /**\n   * @param {HTMLElement|ToolbarFlexItem} element an HTMLElement representing a\n   *  Toolbar Item, or an actual ToolbarFlexItem API to use.\n   * @returns {void}\n   */\n  select(element) {\n    const item = this.getItemFromElement(element);\n\n    switch (item.type) {\n      case 'searchfield':\n      case 'actionbutton':\n      case 'menubutton': {\n        if (this.clickByEnterKey) {\n          return;\n        }\n        item.selected = true;\n        break;\n      }\n      default:\n        item.selected = true;\n        break;\n    }\n\n    log('log', `Item ${item} selected.`);\n  },\n\n  /**\n   * Exports everything in the current `items` array as Popupmenu-friendly data to be\n   * converted to menu items.\n   * NOTE: Searchfields and other Action Buttons are ignored\n   * @returns {object} containing JSON-friendly Popupmenu data\n   */\n  toPopupmenuData() {\n    const data = {\n      noMenuWrap: true\n    };\n\n    let hasIcons = false;\n\n    function getItemData(item) {\n      const itemData = item.toPopupmenuData();\n      if (itemData && itemData.icon) {\n        hasIcons = true;\n      }\n      return itemData;\n    }\n\n    data.menu = this.items.filter((item) => {\n      if (item.type === 'actionbutton' || item.type === 'searchfield') {\n        return false;\n      }\n      return true;\n    }).map(item => getItemData(item));\n\n    data.hasIcons = hasIcons;\n\n    return data;\n  },\n\n  /**\n   * Exports everything in the current `items` array as a Flex Toolbar object structure\n   * @returns {object} containing JSON-friendly Flex Toolbar data\n   */\n  toData() {\n    const data = {};\n    data.items = this.items.map(item => item.toData());\n    return data;\n  },\n\n  get disabled() {\n    return this.trueDisabled;\n  },\n\n  set disabled(bool) {\n    this.trueDisabled = bool;\n    if (bool === true) {\n      this.element.classList.add('is-disabled');\n      return;\n    }\n    this.element.classList.remove('is-disabled');\n  },\n\n  /**\n   * @param {object} [settings] incoming settings\n   * @returns {void}\n   */\n  updated(settings) {\n    if (typeof settings === 'object') {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.teardown();\n    this.init();\n  },\n\n  /**\n   * @returns {void}\n   */\n  teardown() {\n    this.element.removeEventListener('keydown', this.keydownListener);\n    this.element.removeEventListener('keyup', this.keyupListener);\n    this.element.removeEventListener('click', this.clickListener);\n\n    $(this.element).off(`selected.${COMPONENT_NAME}`);\n    $(this.element).off(`collapsed-responsive.${COMPONENT_NAME}`);\n\n    this.items.forEach((item) => {\n      item.teardown();\n    });\n\n    delete this.items;\n    delete this.sections;\n  },\n\n  /**\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n  }\n\n};\n\nexport { ToolbarFlex, COMPONENT_NAME };\n","import { ToolbarFlex, COMPONENT_NAME } from './toolbar-flex';\n\n/**\n * jQuery component wrapper for Toolbar Flex Component\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.toolbarflex = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ToolbarFlex(this, settings));\n\n      // Remove the jQuery Component reference from $.data\n      const oldDestroy = instance.destroy;\n      instance.destroy = function () {\n        if (typeof oldDestroy === 'function') {\n          oldDestroy.call(this);\n        }\n        $.removeData(this, COMPONENT_NAME);\n      };\n    }\n  });\n};\n","import './searchfield.jquery';\n\n/**\n * jQuery Component Wrapper for Toolbar Searchfield\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.toolbarsearchfield = $.fn.searchfield;\n","import { Environment as env } from '../../utils/environment';\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// Component Name\nconst COMPONENT_NAME = 'trackdirty';\n\n// Default Trackdirty Options\nconst TRACKDIRTY_DEFAULTS = {\n};\n\n/**\n* Track changes on the inputs passed in the jQuery selector and show a dirty indicator\n* @class Trackdirty\n* @param {string} element The component element.\n* @param {string} [settings] The component settings.\n*/\nfunction Trackdirty(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, TRACKDIRTY_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Trackdirty Methods\nTrackdirty.prototype = {\n\n  init() {\n    this.isIe = env.browser.name === 'ie';\n    this.isIeEdge = env.browser.name === 'edge';\n\n    this.handleEvents();\n  },\n\n  /**\n   * Get the value or checked if checkbox or radio\n   * @private\n   * @param {object} element .\n   * @param {boolean} isOriginal .\n   * @returns {string} element value\n   */\n  valMethod(element, isOriginal) {\n    switch (element.attr('type')) {\n      case 'checkbox':\n      case 'radio':\n        return element.prop('checked');\n      case 'file': {\n        if (typeof isOriginal === 'boolean' && isOriginal) {\n          const original = element.attr('original');\n          return (original !== undefined) ? original : '';\n        }\n\n        const el = element.parent().find('[type=\"text\"]');\n        return el.val();\n      }\n      default:\n        return element.val();\n    }\n  },\n\n  /**\n   * Get absolute position for an element\n   * @private\n   * @param {object} element .\n   * @returns {object} position for given element\n   */\n  getAbsolutePosition(element) {\n    const pos = element.position();\n    // eslint-disable-next-line\n    element.parents().each(function () {\n      const el = this;\n      if (window.getComputedStyle(el, null).position === 'relative') {\n        return false;\n      }\n\n      pos.left += el.scrollLeft;\n      pos.top += el.scrollTop;\n    });\n\n    return { left: pos.left, top: pos.top };\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.element\n      .removeClass('dirty')\n      .off('resetdirty.dirty change.dirty doresetdirty.dirty');\n\n    if (this.settings && typeof this.settings.d === 'object') {\n      const d = this.settings.d;\n      $('.icon-dirty, .msg-dirty', d.field).add(d.icon).add(d.msg).remove();\n    }\n\n    $.removeData(this.element[0], 'original');\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, TRACKDIRTY_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Attach Events used by the Control\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const input = this.element;\n\n    if (input.is('.editor')) {\n      const textArea = input.parent().find('textarea');\n      textArea.data('original', this.valMethod(textArea));\n    }\n\n    input.data('original', this.valMethod(input, true))\n      .on('resetdirty.dirty', () => {\n        if (input.is('.editor')) {\n          const textArea = input.parent().find('textarea');\n          textArea.data('original', this.valMethod(textArea));\n        }\n\n        input.data('original', this.valMethod(input))\n          .triggerHandler('doresetdirty.dirty');\n      })\n      .on('change.dirty doresetdirty.dirty', (e) => {\n        let el = input;\n        const field = input.closest('.field, .radio-group');\n        let label = $('label:visible', field);\n        const d = { class: '', style: '' };\n\n        if (field.is('.field-fileupload')) {\n          el = field.find('input.fileupload-background-transparent');\n        }\n\n        if (field.is('.editor-container')) {\n          el = field.find('.editor-source');\n        }\n\n        // Used element without .field wrapper\n        if (!label[0]) {\n          label = input.next('label');\n        }\n        if (input.attr('data-trackdirty') !== 'true') {\n          return;\n        }\n\n        // Add class to element\n        input.addClass('dirty');\n\n        // Set css class\n        if (input.is('[type=\"checkbox\"], [type=\"radio\"]')) {\n          d.class += ` dirty-${input.attr('type')}`;\n          d.class += input.is(':checked') ? ' is-checked' : '';\n        }\n        if (input.is('select')) {\n          d.class += ' is-select';\n          el = input.next('.dropdown-wrapper').find('.dropdown');\n        }\n\n        // Add class and icon\n        d.icon = el.prev();\n        if (!d.icon.is('.icon-dirty')) {\n          if (input.is('[type=\"checkbox\"]')) {\n            d.rect = this.getAbsolutePosition(label);\n            d.style = `left:${d.rect.left}px; top:${d.rect.top}px;`;\n          } else if (input.is('.colorpicker') && !Locale.isRTL()) {\n            d.rect = this.getAbsolutePosition(input);\n            d.style = `left:${d.rect.left}px; top:${d.rect.top}px;`;\n          }\n          d.icon = `<span class=\"icon-dirty${d.class}\"></span>`;\n          d.msg = Locale.translate('MsgDirty') || '';\n          d.msg = `<span class=\"audible msg-dirty\">${d.msg}</span>`;\n\n          // Add icon and msg\n          const firstInput = $($(el[0].parentElement).find('input')[0]);\n          el = input.is('[type=\"radio\"]') ? firstInput : el;\n\n          if ($(el[0].parentElement).find('.icon-dirty').length === 0) {\n            el.before(d.icon);\n            label.append(d.msg);\n\n            if (d.style && el.prev('.icon-dirty')[0]) {\n              el.prev('.icon-dirty')[0].style.cssText = d.style;\n            }\n          }\n\n          // Cache icon and msg\n          d.icon = el.prev();\n          d.msg = label.find('.msg-dirty');\n        }\n\n        // Handle resetting value back\n        let original = input.data('original');\n        let current = this.valMethod(input);\n\n        d.field = field;\n        this.settings.d = d;\n        if (field.is('.editor-container')) {\n          // editors values are further down it's tree in a textarea,\n          // so get the elements with the value\n          const textArea = field.find('textarea');\n          original = textArea.data('original');\n          current = this.valMethod(textArea);\n\n          if (this.isIe || this.isIeEdge) {\n            current = input[0].innerHTML;\n          }\n        }\n        if (current === original || (input.attr('multiple') && utils.equals(current, original))) {\n          input.removeClass('dirty');\n          $('.icon-dirty, .msg-dirty', field).add(d.icon).add(d.msg).remove();\n          input.trigger(e.type === 'doresetdirty' ? 'afterresetdirty' : 'pristine');\n          return;\n        }\n\n        /**\n        * Fires when an inout becomes dirty.\n        * @event resetdirty\n        * @memberof Trackdirty\n        * @property {object} event - The jquery event object\n        */\n        input.trigger('dirty');\n      });\n  }\n};\n\nexport { Trackdirty, COMPONENT_NAME };\n","import { Trackdirty, COMPONENT_NAME } from './trackdirty';\n\n/**\n * jQuery Component Wrapper for TrackDirty\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.trackdirty = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Trackdirty(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\nimport { Locale } from '../locale/locale';\n\n// Jquery Functions\nimport '../../utils/animations';\n\n// The name of this component.\nconst COMPONENT_NAME = 'tree';\n\n// The Component Defaults.\nconst TREE_DEFAULTS = {\n  selectable: 'single', // ['single'|'multiple']\n  hideCheckboxes: false, // [true|false] -apply only with [selectable: 'multiple']\n  menuId: null, // Context Menu to add to nodes\n  useStepUI: false, // When using the UI as a stepped tree\n  folderIconOpen: 'open-folder',\n  folderIconClosed: 'closed-folder',\n  sortable: false, // Allow nodes to be sortable\n  onBeforeSelect: null,\n  onExpand: null,\n  onCollapse: null,\n  originalEnablementState: null\n};\n\n/**\n* The tree Component displays a hierarchical list.\n* @class Tree\n* @param {object} element The component element.\n* @param {object} [settings] The component settings.\n* @param {string} [settings.selectable = 'single'] 'single' or 'multiple'.\n* @param {boolean} [settings.hideCheckboxes = false] Only applies when `selectable` is set to 'multiple'.\n* @param {null|string} [settings.menuId] if defined, will be used to identify a Context Menu by ID attribute in which to add nodes.\n* @param {boolean} [settings.useStepUI = false] if `true`, turns this tree instance into a \"Stepped\" tree.\n* @param {string} [settings.folderIconOpen = 'open-folder']  the icon used when a tree folder node is open.\n* @param {string} [settings.folderIconClosed = 'closed-folder'] the icon used when a tree folder node is closed.\n* @param {boolean} [settings.sortable = false] if `true`, allows nodes to become sortable.\n* @param {null|function} [settings.onBeforeSelect] If defined as a function, fires that function as a callback before the selection on a node occurs.\n* @param {null|function} [settings.onExpand] If defined as a function, fires that function as a node is expanded.\n* @param {null|function} [settings.onCollapse] If defined as a function, fires that function as a node is collapsed.\n*/\nfunction Tree(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, TREE_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Tree Methods\nTree.prototype = {\n\n  /**\n   * @private\n   * @returns {undefined}\n   */\n  init() {\n    this.isIe11 = (env.browser.name === 'ie' && env.browser.version === '11');\n    this.initTree();\n    this.handleKeys();\n    this.setupEvents();\n\n    if (this.loadData(this.settings.dataset) === -1) {\n      this.syncDataset();\n      this.initSelected();\n      this.focusFirst();\n      this.attachMenu(this.settings.menuId);\n      this.createSortable();\n    }\n  },\n\n  /**\n   * Init Tree from ul, li, a markup structure in DOM\n   * @private\n  */\n  initTree() {\n    const self = this;\n    const s = this.settings;\n    const links = this.element.find('a');\n    const selectableAttr = this.element.attr('data-selectable');\n\n    // Set attribute \"data-selectable\"\n    s.selectable = ((typeof selectableAttr !== 'undefined') &&\n     (selectableAttr.toLowerCase() === 'single' ||\n       selectableAttr.toLowerCase() === 'multiple')) ?\n      selectableAttr : s.selectable;\n\n    // Set isMultiselect and checkboxes show/hide\n    this.isMultiselect = s.selectable === 'multiple';\n    s.hideCheckboxes = s.hideCheckboxes || !this.isMultiselect;\n\n    this.element.addClass(this.isMultiselect ? ' is-multiselect' : '');\n\n    links.each(function () {\n      const a = $(this);\n      self.decorateNode(a);\n    });\n  },\n\n  /**\n   * Init selected notes\n   * @private\n  */\n  initSelected() {\n    const listItems = [].slice.call(this.element[0].querySelectorAll('li'));\n    listItems.forEach(li => this.setNodeStatus($(li.querySelector('a'))));\n  },\n\n  /**\n   * Focus the first tree node\n   * @private\n   */\n  focusFirst() {\n    const a = this.element[0].querySelector('a');\n    if (a) {\n      a.setAttribute('tabindex', '0');\n    }\n  },\n\n  /**\n   * Set focus\n   * @private\n   * @param {object} node .\n   * @returns {void}\n   */\n  setFocus(node) {\n    node = this.isjQuery(node) ? node[0] : node;\n    if (!node) {\n      return;\n    }\n    node.focus();\n    node.classList.remove('hide-focus');\n  },\n\n  /**\n   * From the LI, Read props and add stuff\n   * @private\n   * @param {object} a an anchor tag reference wrapped in a jQuery object.\n   * @param {string} iconToSet icon for tree node.\n   * @param {bool} hideCheckbox to show or hide checkbox for tree node.\n   * @returns {void}\n   */\n  // Added parameters - To show check box and icon on demand for particular node\n  decorateNode(a, iconToSet, hideCheckbox) {\n    a = this.isjQuery(a) ? a : $(a);\n\n    let parentCount = 0;\n    let badgeData = a[0].getAttribute('data-badge');\n    const alertIcon = a[0].getAttribute('data-alert-icon');\n    const isParentsDisabled = a.parentsUntil(this.element, 'ul[role=group].is-disabled').length > 0;\n    const isDisabled = a[0].classList.contains('is-disabled') || isParentsDisabled;\n\n    if (typeof badgeData !== 'undefined') {\n      badgeData = utils.parseSettings(a, 'data-badge');\n    }\n\n    // Set initial 'role', 'tabindex', and 'aria selected' on each link (except the first)\n    a[0].setAttribute('role', 'treeitem');\n    a[0].setAttribute('tabindex', '-1');\n    a[0].setAttribute('aria-selected', 'false');\n\n    // Add Aria disabled\n    if (isDisabled) {\n      a[0].classList.add('is-disabled');\n      a[0].setAttribute('aria-disabled', 'true');\n      const childSection = a.next();\n\n      if (childSection[0] && childSection[0].tagName.toLowerCase() === 'ul' && childSection[0].classList.contains('is-open')) {\n        const childLinks = [].slice.call(childSection[0].querySelectorAll('a'));\n        childLinks.forEach((link) => {\n          link.classList.add('is-disabled');\n          link.setAttribute('aria-disabled', 'true');\n        });\n        const parentUls = [].slice.call(a[0].parentNode.querySelectorAll('ul'));\n        parentUls.forEach(ul => ul.classList.add('is-disabled'));\n      }\n    }\n\n    // ParentCount 'aria-level' to the node's level depth\n    parentCount = a.parentsUntil(this.element, 'ul').length - 1;\n    a[0].setAttribute('aria-level', parentCount + 1);\n\n    // Set the current tree item node position relative to its aria-setsize\n    const posinset = a.parent().index();\n    a[0].setAttribute('aria-posinset', posinset + 1);\n\n    // Set the current tree item aria-setsize\n    const listCount = a.closest('li').siblings().length + 1;\n    a[0].setAttribute('aria-setsize', listCount);\n\n    // Set the current tree item node expansion state\n    const subNode = a.next('ul');\n    if (subNode[0] && subNode.children().length > 0) {\n      a[0].setAttribute('aria-expanded', subNode[0].classList.contains('is-open') ? 'true' : 'false');\n    }\n\n    // Inject Icons\n    const text = a.contents().filter(function () {\n      return !$(this).is('.tree-badge');// Do not include badge text\n    }).text();\n\n    a[0].textContent = '';\n    if (a.children('svg.icon-tree').length === 0) {\n      // Show provided icon if any, if empty string provided then show empty icon otherwise show document icon.\n      if (iconToSet || iconToSet === '') {\n        a[0].insertAdjacentHTML('afterbegin', $.createIcon({ icon: iconToSet, classes: ['icon-tree'] }));\n      } else {\n        a[0].insertAdjacentHTML('afterbegin', $.createIcon({ icon: 'tree-node', classes: ['icon-tree'] }));\n      }\n\n      if (this.settings.useStepUI) {\n        a[0].insertAdjacentHTML('afterbegin', $.createIcon({ icon: alertIcon, classes: ['step-alert', `icon-${alertIcon}`] }));\n      }\n    }\n\n    // Inject checkbox\n    // Show check box for particular node on demand\n    if (this.isMultiselect && (!this.settings.hideCheckboxes || hideCheckbox === false)) {\n      a[0].insertAdjacentHTML('beforeend', '<span class=\"tree-checkbox\"></span>');\n    }\n\n    // Inject badge\n    const badgeHtml = this.getBadgeHtml(badgeData);\n    if (badgeHtml !== '') {\n      a[0].insertAdjacentHTML('beforeend', badgeHtml);\n    }\n\n    const span = document.createElement('span');\n    span.classList.add('tree-text');\n    span.textContent = text;\n    a[0].appendChild(span);\n\n    if (this.hasIconClass(a)) {\n      // CreateIconPath\n      this.setTreeIcon(a.find('svg.icon-tree'), a[0].getAttribute('class'));\n    }\n\n    // Adds role=group' to all subnodes\n    if (subNode[0] && subNode[0].tagName.toLowerCase() === 'ul') {\n      let aClass = a[0].getAttribute('class');\n      subNode[0].setAttribute('role', 'group');\n      subNode[0].parentNode.classList.add('folder');\n      this.setTreeIcon(a.find('svg.icon-tree'), subNode[0].classList.contains('is-open') ? this.settings.folderIconOpen : this.settings.folderIconClosed);\n\n      if (aClass && aClass.indexOf('open') === -1 && aClass.indexOf('closed') === -1) {\n        a[0].setAttribute('class', isDisabled ? 'is-disabled' : '');\n        this.setTreeIcon(a.find('svg.icon-tree'), subNode[0].classList.contains('is-open') ? this.settings.folderIconOpen : this.settings.folderIconClosed);\n      }\n\n      if (this.hasIconClass(a)) {\n        aClass = a[0].getAttribute('class');\n        this.setTreeIcon(a.find('svg.icon-tree'), subNode[0].classList.contains('is-open') ?\n          aClass : aClass.replace('open', 'closed'));\n      }\n    }\n\n    a.hideFocus();\n  },\n\n  /**\n   * Sets the correct icon to use on a particular SVG element.\n   * @private\n   * @param {object} svg an SVG element reference wrapped in a jQuery object\n   * @param {string} icon the ID of a Soho Icon type.\n   * @returns {void}\n   */\n  setTreeIcon(svg, icon) {\n    if (!svg || typeof icon !== 'string') {\n      return;\n    }\n    svg = this.isjQuery(svg) ? svg : $(svg);\n    // Replace all \"icon-\", \"hide-focus\", \"\\s? - all spaces if any\" with nothing\n    const iconStr = icon.replace(/#?icon-|hide-focus|\\s?/gi, '');\n    svg.changeIcon(iconStr);\n  },\n\n  /**\n   * Expands a collection of tree nodes.\n   * @param {object} nodes - a jQuery-wrapped collection of tree node elements.\n   If left undefined, this will automatically use all `ul[role=group]` elements.\n   * @returns {void}\n   */\n  expandAll(nodes) {\n    let groups = nodes;\n\n    if (typeof groups !== 'undefined') {\n      groups = this.isjQuery(groups) ? $.makeArray(groups) : groups;\n    } else {\n      groups = [].slice.call(this.element[0].querySelectorAll('ul[role=group]'));\n    }\n\n    groups.forEach((group) => {\n      const prev = group.previousElementSibling;\n      group.parentNode.classList.add('is-open');\n      group.classList.add('is-open');\n      group.style.height = '';\n\n      if (prev && prev.tagName.toLowerCase() === 'a') {\n        const svg = prev.querySelector('svg.icon-tree');\n        this.setTreeIcon(svg, this.settings.folderIconOpen);\n        prev.setAttribute('aria-expanded', true);\n        if (this.hasIconClass(prev)) {\n          this.setTreeIcon(svg, prev.getAttribute('class'));\n        }\n      }\n    });\n  },\n\n  /**\n   * Collapses a collection of tree nodes.\n   * @param {object} nodes - a jQuery-wrapped collection of tree node elements.\n   If left undefined, this will automatically use all `ul[role=group]` elements.\n   * @returns {void}\n   */\n  collapseAll(nodes) {\n    let groups = nodes;\n\n    if (typeof groups !== 'undefined') {\n      groups = this.isjQuery(groups) ? $.makeArray(groups) : groups;\n    } else {\n      groups = [].slice.call(this.element[0].querySelectorAll('ul[role=group]'));\n    }\n\n    groups.forEach((group) => {\n      const prev = group.previousElementSibling;\n      group.parentNode.classList.remove('is-open');\n      group.classList.remove('is-open');\n      group.style.height = 0;\n\n      if (prev && prev.tagName.toLowerCase() === 'a') {\n        const svg = prev.querySelector('svg.icon-tree');\n        this.setTreeIcon(svg, this.settings.folderIconClosed);\n        prev.setAttribute('aria-expanded', false);\n        prev.classList.remove('is-selected');\n        if (this.hasIconClass(prev)) {\n          this.setTreeIcon(svg, prev.getAttribute('class').replace('open', 'closed'));\n        }\n      }\n    });\n  },\n\n  /**\n   * Check if an object is an instance of a jQuery object\n   * @private\n   * @param {object} obj the object being tested.\n   * @returns {boolean} true if jQuery\n   */\n  isjQuery(obj) {\n    // TODO: Move this to a Soho utility object?\n    return (obj && (obj instanceof jQuery || obj.constructor.prototype.jquery));\n  },\n\n  /**\n   * Selects a tree node specifically using it's ID attribute.\n   * @param {string} id - the ID string to use.\n   * @returns {void}\n   */\n  selectNodeById(id) {\n    this.selectNodeByJquerySelector(`#${id}`);\n  },\n\n  /**\n   * Selects a tree node by [jquery selector] -or- [jquery object]\n   * @private\n   * @param {object} selector uses a string that represents a jQuery-wrapped\n   element's ID attribute, or a jQuery-wrapped reference to the element itself.\n   * @returns {void}\n   */\n  selectNodeByJquerySelector(selector) {\n    const target = this.isjQuery(selector) ? selector : $(selector);\n    if (target.length && !target.is('.is-disabled')) {\n      const nodes = target.parentsUntil(this.element, 'ul[role=group]');\n      this.expandAll(nodes);\n      this.selectNode(target, true);\n    }\n  },\n\n  /**\n   * Deselects a tree node\n   * @private\n   * @param {object} node - a jQuery-wrapped element reference to a tree node.\n   * @param {boolean} focus - if defined, causes the node to become focused.\n   * @returns {void}\n   */\n  unSelectedNode(node, focus) {\n    if (node.length === 0) {\n      return;\n    }\n\n    const self = this;\n    const aTags = $('a', this.element);\n\n    aTags.attr('tabindex', '-1');\n    node.attr('tabindex', '0');\n\n    $('a:not(.is-disabled)', node.parent()).attr('aria-selected', 'false').parent().removeClass('is-selected');\n\n    this.syncNode(node);\n    this.setNodeStatus(node);\n\n    if (focus) {\n      node.focus();\n    }\n\n    // Set active css class\n    const listItems = [].slice.call(this.element[0].querySelectorAll('li'));\n    listItems.forEach(li => li.classList.remove('is-active'));\n    node[0].parentNode.classList.add('is-active');\n\n    setTimeout(() => {\n      const jsonData = node.data('jsonData') || {};\n      /**\n      * Fires when the node is deselected.\n      * @memberof Tree\n      * @event unselected\n      * @type {object}\n      * @property {object} event - The jquery event object\n      * @property {object} args for node element, item\n      * @property {HTMLElement} args.node The DOM Element.\n      * @property {HTMLElement} args.data The JSON data attached to the node.\n      */\n      self.element.triggerHandler('unselected', { node, data: jsonData });\n    }, 0);\n  },\n\n  /**\n   * Selects a tree node\n   * @private\n   * @param {object} node - a jQuery-wrapped element reference to a tree node.\n   * @param {boolean} focus - if defined, causes the node to become focused.\n   * @returns {void}\n   */\n  selectNode(node, focus) {\n    const self = this;\n    const s = this.settings;\n\n    if (node.length === 0) {\n      return;\n    }\n\n    // Possibly Call the onBeforeSelect\n    let result;\n    if (typeof s.onBeforeSelect === 'function') {\n      result = s.onBeforeSelect(node);\n      if (result && result.done && typeof result.done === 'function') { // A promise is returned\n        result.done((continueSelectNode) => {\n          if (continueSelectNode) {\n            self.selectNodeFinish(node, focus);\n          }\n        });\n      } else if (result) { // Boolean is returned instead of a promise\n        self.selectNodeFinish(node, focus);\n      }\n    } else { // No Callback specified\n      self.selectNodeFinish(node, focus);\n    }\n  },\n\n  /**\n   * Select the node when finished\n   * @private\n   * @param {object} node - a jQuery-wrapped element reference to a tree node.\n   * @param {boolean} focus - if defined, causes the node to become focused.\n   * @param {object} e - jquery event.\n   * @returns {void}\n   */\n  selectNodeFinish(node, focus, e) {\n    // Don't do selection for toggle type only\n    if (this.isMultiselect && e) {\n      if (e.type === 'click' || e.type === 'touch') {\n        if (e.target.classList.contains('icon') &&\n          node[0].parentNode.classList.contains('folder')) {\n          return;\n        }\n      } else if (e.type === 'keydown') {\n        const charCode = e.charCode || e.keyCode;\n        if (charCode === 37 || charCode === 39) {\n          return;\n        }\n      }\n    }\n\n    const self = this;\n    const links = [].slice.call(this.element[0].querySelectorAll('a'));\n    links.forEach(a => a.setAttribute('tabindex', '-1'));\n    node[0].setAttribute('tabindex', '0');\n\n    if (this.isMultiselect) {\n      const links2 = [].slice.call(node[0].parentNode.querySelectorAll('a:not(.is-disabled)'));\n      links2.forEach((a) => {\n        a.setAttribute('aria-selected', 'true');\n        a.classList.add('is-selected');\n        a.parentNode.classList.add('is-selected');\n      });\n    } else {\n      if (node[0].classList.contains('is-selected')) {\n        return;\n      }\n      links.forEach((a) => {\n        const link = $(a);\n        const data = link.data('jsonData');\n        if (data) {\n          delete data.selected;\n          link.data('jsonData', data);\n        }\n        a.setAttribute('aria-selected', 'false');\n        a.classList.remove('is-selected');\n        a.parentNode.classList.remove('is-selected');\n      });\n      node[0].setAttribute('aria-selected', 'true');\n      node[0].classList.add('is-selected');\n      node[0].parentNode.classList.add('is-selected');\n    }\n\n    this.syncNode(node);\n    if (!this.loading) {\n      this.setNodeStatus(node);\n    }\n\n    if (focus) {\n      node.focus();\n    }\n\n    // Set active css class\n    const listItems = [].slice.call(this.element[0].querySelectorAll('li'));\n    listItems.forEach(li => li.classList.remove('is-active'));\n    node[0].parentNode.classList.add('is-active');\n\n    setTimeout(() => {\n      const jsonData = node.data('jsonData') || {};\n      /**\n       * Fires when the node is selected.\n       * @memberof Tree\n       * @event unselected\n       * @type {object}\n       * @property {object} event - The jquery event object\n       * @property {object} args for node element, item\n       * @property {HTMLElement} args.node The DOM Element.\n       * @property {HTMLElement} args.data The JSON data attached to the node.\n       */\n      self.element.triggerHandler('selected', { node, data: jsonData });\n    }, 0);\n  },\n\n  /**\n   * Set current node status\n   * @private\n   * @param {object} node - a jQuery-wrapped element reference to a tree node.\n   * @returns {void}\n   */\n  setNodeStatus(node) {\n    const self = this;\n    const data = node.data('jsonData');\n    let nodes;\n\n    // Not multiselect\n    if (!this.isMultiselect) {\n      const a = node[0];\n      const li = a.parentNode;\n      if (data && data.selected) {\n        li.classList.add('is-selected');\n        a.classList.add('is-selected');\n        a.setAttribute('aria-selected', true);\n      } else {\n        li.classList.remove('is-selected', 'is-partial');\n        a.classList.remove('is-selected', 'is-partial');\n        a.setAttribute('aria-selected', false);\n      }\n      return;\n    }\n\n    const setStatus = function (thisNodes, isFirstSkipped) {\n      thisNodes.forEach((li) => {\n        const a = $(li.querySelector('a'));\n        const status = self.getSelectedStatus(a, isFirstSkipped);\n\n        if (status === 'mixed') {\n          li.classList.remove('is-selected', 'is-partial');\n          li.classList.add('is-partial');\n        } else if (status) {\n          li.classList.remove('is-selected', 'is-partial');\n          li.classList.add('is-selected');\n        } else {\n          li.classList.remove('is-selected', 'is-partial');\n        }\n        self.syncNode(a);\n      });\n    };\n\n    // Multiselect\n    let isFirstSkipped = false;\n    nodes = [].slice.call(node[0].parentNode.querySelectorAll('li.folder'));\n    setStatus(nodes, isFirstSkipped);\n\n    isFirstSkipped = !(!nodes.length && data && !data.selected);\n    nodes = node.parentsUntil(this.element, 'li.folder');\n    nodes = [].slice.call(nodes.toArray());\n    setStatus(nodes, isFirstSkipped);\n  },\n\n  /**\n   * Get's a tree node's current 'selected' status\n   * @private\n   * @param {object} node - a jQuery-wrapped element reference to a tree node.\n   * @param {boolean} isFirstSkipped - ?\n   * @returns {boolean} status as true|false|'mixed'\n   */\n  getSelectedStatus(node, isFirstSkipped) {\n    let total = 0;\n    let selected = 0;\n    let unselected = 0;\n    let data;\n\n    node.parent().find('a').each(function (i) {\n      if (isFirstSkipped && i === 0) {\n        return;\n      }\n      total++;\n      data = $(this).data('jsonData');\n      if (data && data.selected) {\n        selected++;\n      } else {\n        unselected++;\n      }\n    });\n\n    let status;\n    if (total === selected) {\n      status = true;\n    } else if (total === unselected) {\n      status = false;\n    } else {\n      status = 'mixed';\n    }\n    return status;\n  },\n\n  /**\n   * Changes a node's open/close status to its opposite form.\n   * @private\n   * @param {object} node - a jQuery-wrapped element reference to a tree node.\n   * @param {object} e jquery event\n   * @returns {void}\n   */\n  toggleNode(node, e) {\n    const next = node.next();\n    const self = this;\n    const s = this.settings;\n    let result;\n    if (next[0] && next[0].tagName.toLowerCase() === 'ul' && next[0].getAttribute('role') === 'group') {\n      if (next[0].classList.contains('is-open')) {\n        if (typeof s.onCollapse === 'function') {\n          result = s.onCollapse(node);\n          if (result && result.done && typeof result.done === 'function') { // A promise is returned\n            result.done((continueSelectNode) => {\n              if (continueSelectNode) {\n                self.selectNodeFinish(node, focus, e);\n              }\n            });\n          } else if (result) { // Boolean is returned instead of a promise\n            self.selectNodeFinish(node, focus, e);\n          }\n        } else { // No Callback specified\n          self.selectNodeFinish(node, focus, e);\n        }\n\n        self.setTreeIcon(node.closest('.folder').removeClass('is-open').end().find('svg.icon-tree'), s.folderIconClosed);\n\n        if (self.hasIconClass(node.closest('.folder a'))) {\n          self.setTreeIcon(\n            node.closest('.folder a').find('svg.icon-tree'),\n            node.closest('.folder a').attr('class')\n              .replace('open', 'closed')\n              .replace(/\\s?is-selected/, '')\n          );\n        }\n\n        self.isAnimating = true;\n\n        if (!self.isMultiselect) {\n          self.unSelectedNode(node.parent().find('li.is-selected'), false);\n          node[0].classList.remove('is-selected');\n        }\n\n        next.one('animateclosedcomplete', () => {\n          next[0].classList.remove('is-open');\n          self.isAnimating = false;\n        }).animateClosed();\n\n        node[0].setAttribute('aria-expanded', node[0].getAttribute('aria-expanded') !== 'true');\n      } else {\n        if (typeof s.onExpand === 'function') {\n          result = s.onExpand(node);\n          if (result && result.done && typeof result.done === 'function') { // A promise is returned\n            result.done((continueSelectNode) => {\n              if (continueSelectNode) {\n                self.selectNodeFinish(node, focus, e);\n              }\n            });\n          } else if (result) { // Boolean is returned instead of a promise\n            self.selectNodeFinish(node, focus, e);\n          }\n        } else { // No Callback specified\n          self.selectNodeFinish(node, focus, e);\n        }\n\n        const nodeData = node.data('jsonData');\n\n        if (s.source && nodeData.children && nodeData.children.length === 0) {\n          const response = function (nodes) {\n            const id = nodeData.id;\n            const elem = self.findById(id);\n\n            // Add DB and UI nodes\n            elem.children = nodes;\n            self.addChildNodes(elem, node.parent());\n            node[0].classList.remove('is-loading');\n            self.loading = false;\n\n            // Open\n            self.accessNode(next, node);\n\n            // Sync data on node\n            nodeData.children = nodes;\n            node.data('jsonData', nodeData);\n            self.selectNode(node, true);\n            self.initSelected();\n          };\n\n          const args = { node, data: node.data('jsonData') };\n          node[0].classList.add('is-loading');\n          self.loading = true;\n          self.settings.source(args, response);\n\n          return;\n        }\n        self.accessNode(next, node);\n      }\n    }\n  },\n\n  /**\n   * Access The Node\n   * @private\n   * @param  {object} next The next element.\n   * @param  {object} node The DOM element.\n   */\n  accessNode(next, node) {\n    const nodeClass = node.attr('class');\n\n    this.setTreeIcon(node.closest('.folder').addClass('is-open').end().find('svg.icon-tree'), this.settings.folderIconOpen);\n\n    if (this.hasIconClass(nodeClass)) {\n      this.setTreeIcon(node.find('svg.icon-tree'), nodeClass.replace('is-selected', ''));\n    }\n\n    this.isAnimating = true;\n\n    next.one('animateopencomplete', () => {\n      this.isAnimating = false;\n    }).addClass('is-open').css('height', 0).animateOpen();\n    node[0].setAttribute('aria-expanded', node[0].getAttribute('aria-expanded') !== 'true');\n  },\n\n  /**\n   * Open The Node\n   * @private\n   * @param  {object} nextTarget The next tree element\n   * @param  {object} nodeTarget The DOM element to open.\n   */\n  openNode(nextTarget, nodeTarget) {\n    const self = this;\n    const nodeData = nodeTarget.data('jsonData');\n\n    if (self.settings.source && nodeData.children && nodeData.children.length === 0) {\n      const response = function (nodes) {\n        const id = nodeData.id;\n        const elem = self.findById(id);\n\n        // Add DB and UI nodes\n        elem.children = nodes;\n        self.addChildNodes(elem, nodeTarget.parent());\n        nodeTarget.removeClass('is-loading');\n        self.loading = false;\n\n        // Open\n        self.accessNode(nextTarget, nodeTarget);\n\n        // Sync data on node\n        nodeData.children = nodes;\n        nodeTarget.data('jsonData', nodeData);\n        self.selectNode(nodeTarget, true);\n        self.initSelected();\n      };\n\n      const args = { node: nodeTarget, data: nodeTarget.data('jsonData') };\n      nodeTarget.addClass('is-loading');\n      self.loading = true;\n      self.settings.source(args, response);\n\n      return;\n    }\n    self.accessNode(nextTarget, nodeTarget);\n  },\n\n  /**\n   * Check if given value has icon class\n   * @private\n   * @param  {string|object} elemClass class or element has icon class\n   * @returns  {boolean} true if has icon.\n   */\n  hasIconClass(elemClass) {\n    if (typeof elemClass !== 'string') {\n      if (this.isjQuery(elemClass)) {\n        elemClass = elemClass.length > 1 ? elemClass.first()[0] : elemClass[0];\n      }\n      elemClass = elemClass.getAttribute('class');\n    }\n    return elemClass && elemClass.indexOf('icon') > -1;\n  },\n\n  /**\n   * Close The Node\n   * @private\n   * @param  {object} nextTarget The next tree element\n   * @param  {object} nodeTarget The DOM element to open.\n   */\n  closeNode(nextTarget, nodeTarget) {\n    const self = this;\n    self.setTreeIcon(nodeTarget.closest('.folder').removeClass('is-open').end().find('svg.icon-tree'), self.settings.folderIconClosed);\n\n    if (self.hasIconClass(nodeTarget.closest('.folder a'))) {\n      self.setTreeIcon(\n        nodeTarget.closest('.folder a').find('svg.icon-tree'),\n        nodeTarget.closest('.folder a').attr('class')\n          .replace('open', 'closed')\n          .replace(/\\s?is-selected/, '')\n      );\n    }\n\n    self.isAnimating = true;\n\n    if (!self.isMultiselect) {\n      self.unSelectedNode(nodeTarget.parent().find('li.is-selected'), false);\n      nodeTarget.removeClass('is-selected');\n    }\n\n    nextTarget.one('animateclosedcomplete', () => {\n      nextTarget.removeClass('is-open');\n      self.isAnimating = false;\n    }).animateClosed();\n\n    nodeTarget.attr('aria-expanded', nodeTarget.attr('aria-expanded') !== 'true');\n  },\n\n  // Setup event handlers\n  setupEvents() {\n    const self = this;\n    self.element.on('updated.tree', (e, newSettings) => {\n      self.updated(newSettings);\n      self.initTree();\n    });\n  },\n\n  // Handle Keyboard Navigation\n  handleKeys() {\n    // Key Behavior as per: http://access.aol.com/dhtml-style-guide-working-group/#treeview\n    const self = this;\n    // On click give clicked element 0 tabindex and 'aria-selected=true', resets all other links\n    this.element.on('click.tree', 'a:not(.is-clone)', function (e) {\n      const target = $(this);\n      const parent = this.parentNode;\n      if (!target[0].classList.contains('is-disabled') && !target[0].classList.contains('is-loading')) {\n        if (self.isMultiselect) {\n          if (e.target.classList.contains('icon') && parent.classList.contains('folder')) {\n            self.toggleNode(target, e);\n          } else if (parent.classList.contains('is-selected') || parent.classList.contains('is-partial')) {\n            self.unSelectedNode(target, true);\n          } else {\n            self.selectNode(target, true);\n          }\n        } else {\n          self.selectNode(target, true);\n          self.toggleNode(target, e);\n        }\n        e.stopPropagation();\n      }\n\n      if (self.popupEl && self.popupEl.data('popupmenu')) {\n        self.popupEl.data('popupmenu').close();\n        self.popupEl = null;\n      }\n\n      return false; // Prevent Click from Going to Top\n    });\n\n    this.element\n    // Focus on \"a\" elements\n      .on('focus.tree', 'a', function () {\n        if (parseInt(this.getAttribute('aria-level'), 10) === 0 && parseInt(this.getAttribute('aria-posinset'), 10) === 1) {\n          // First element if disabled\n          if (this.classList.contains('is-disabled')) {\n            const e = $.Event('keydown.tree');\n            e.keyCode = 40; // move down\n            $(this).trigger(e);\n            return;// eslint-disable-line\n          }\n        }\n      });\n\n    // Handle Up/Down Arrow Keys and Space\n    this.element.on('keydown.tree', 'a', function (e) {\n      const charCode = e.charCode || e.keyCode;\n      const target = $(this);\n      let next;\n      let prev;\n\n      if (self.isAnimating) {\n        return;\n      }\n\n      // Down arrow\n      if (charCode === 40) {\n        const nextNode = self.getNextNode(target);\n        self.setFocus(nextNode);\n      }\n\n      // Up arrow,\n      if (charCode === 38) {\n        const prevNode = self.getPreviousNode(target);\n        self.setFocus(prevNode);\n      }\n\n      // Space\n      if (e.keyCode === 32) {\n        target.trigger('click.tree');\n      }\n\n      // Left arrow\n      if (charCode === 37) {\n        if (Locale.isRTL()) {\n          if (target.next().hasClass('is-open')) {\n            prev = target.next().find('a:first');\n            self.setFocus(prev);\n          } else {\n            self.toggleNode(target, e);\n          }\n        } else if (target.next().hasClass('is-open')) {\n          self.toggleNode(target, e);\n        } else {\n          prev = target.closest('.folder').find('a:first');\n          self.setFocus(prev);\n        }\n        e.stopPropagation();\n        return false;// eslint-disable-line\n      }\n\n      // Right arrow\n      if (charCode === 39) {\n        if (Locale.isRTL()) {\n          if (target.next().hasClass('is-open')) {\n            self.toggleNode(target, e);\n          } else {\n            next = target.closest('.folder').find('a:first');\n            self.setFocus(next);\n          }\n        } else if (target.next().hasClass('is-open')) {\n          next = target.next().find('a:first');\n          self.setFocus(next);\n        } else {\n          self.toggleNode(target, e);\n          self.setFocus(target);\n        }\n        e.stopPropagation();\n        return false;// eslint-disable-line\n      }\n\n      // Home  (fn-right on mac)\n      if (charCode === 36) {\n        next = self.element.find('a:first:visible');\n        self.setFocus(next);\n      }\n\n      // End (fn-right on mac)\n      if (charCode === 35) {\n        next = self.element.find('a:last:visible');\n        self.setFocus(next);\n      }\n    });\n\n    // Handle Left/Right Arrow Keys\n    // eslint-disable-next-line\n    this.element.on('keypress.tree', 'a', function (e) {\n      const charCode = e.charCode || e.keyCode;\n      const target = $(this);\n\n      if ((charCode >= 37 && charCode <= 40) || charCode === 32) {\n        e.stopPropagation();\n        return false;\n      }\n\n      // Printable Chars Jump to first high level node with it...\n      if (e.which !== 0) {\n        // eslint-disable-next-line\n        target.closest('li').nextAll().find('a:visible').each(function () {\n          const node = $(this);\n          const first = node.text().substr(0, 1).toLowerCase();\n          const term = String.fromCharCode(e.which).toLowerCase();\n\n          if (first === term) {\n            self.setFocus(node);\n            return false;\n          }\n        });\n      }\n    });\n  },\n\n  /**\n   * Handle Loading JSON.\n   * @param {object} dataset to load.\n   * @returns {void}\n   */\n  loadData(dataset) {// eslint-disable-line\n    if (!dataset) {\n      return -1;\n    }\n    const self = this;\n    self.element.empty();\n\n    self.loading = true;\n    dataset = this.arrangeDataset(dataset);\n    let html = '';\n    self.jsonData = [];\n    for (let i = 0, l = dataset.length; i < l; i++) {\n      html += self.getNodeHtml(dataset[i], i);\n    }\n\n    self.element[0].insertAdjacentHTML('beforeend', html);\n    const nodes = [].slice.call(self.element[0].querySelectorAll('a[role=\"treeitem\"]'));\n    nodes.forEach((node, i) => {\n      const a = $(node);\n      const data = self.jsonData[i];\n      a.data('jsonData', data);\n      if (data.selected) {\n        self.selectNode(a, data.focus);\n      }\n    });\n    const dropdowns = [].slice.call(self.element[0].querySelectorAll('select.dropdown'));\n    for (let i = 0; i < dropdowns.length; i++) {\n      const dropdown = dropdowns[i];\n      const data = self.jsonData[i];\n      if (data.disabled) {\n        $(dropdown).dropdown().disable();\n      } else {\n        $(dropdown).dropdown().on('selected.tree', function () {\n          const nodeToUpdate = self.findById(this.parentElement.previousElementSibling.id);\n          nodeToUpdate.text = this.value;\n          self.updateNode(nodeToUpdate);\n        });\n      }\n    }\n    self.jsonData = undefined;\n    self.loading = false;\n\n    self.syncDataset();\n    self.initSelected();\n    self.focusFirst();\n    self.attachMenu(self.settings.menuId);\n    self.createSortable();\n  },\n\n  /**\n   * Rearrange the given or default dataset. if dataset use `parent` key to arrange nodes\n   * @private\n   * @param {object} dataset a data object.\n   * @returns {object} arranged data object\n   */\n  arrangeDataset(dataset) {\n    if (!this.hasKeyInData('parent', dataset)) {\n      return dataset;\n    }\n\n    dataset = dataset || this.settings.dataset;\n    const arrangedData = JSON.parse(JSON.stringify(dataset));\n\n    // Add given node to parent\n    const addToParent = (node) => {\n      let arranged = false;\n      // Add child to given parent\n      const addChild = (parent) => {\n        parent.children = parent.children || [];\n        parent.children.push(node);\n        arranged = true;\n      };\n\n      // Traverse in given data and arrange it\n      const arrange = (data) => {\n        for (let i = 0; i < data.length && !arranged; i++) {\n          if (data[i].id === node.parent) {\n            addChild(data[i]);\n          }\n          if (typeof data[i].children !== 'undefined') {\n            arrange(data[i].children);\n          }\n        }\n      };\n      arrange(arrangedData);\n    };\n\n    // Traverse in given data and add to parent\n    const traverse = (data) => {\n      for (let i = 0; i < data.length; i++) {\n        if (typeof data[i].parent !== 'undefined') {\n          addToParent(data[i]);\n        }\n        if (typeof data[i].children !== 'undefined') {\n          traverse(data[i].children);\n        }\n      }\n    };\n    traverse(dataset);\n\n    // Clean old nodes with parent key\n    const clean = (data, id) => {\n      for (let i = 0; i < data.length; i++) {\n        if (typeof data[i].children !== 'undefined') {\n          clean(data[i].children, data[i].id);\n        }\n        if ((typeof id === 'undefined' && typeof data[i].parent !== 'undefined') ||\n          (typeof id !== 'undefined' && typeof data[i].parent !== 'undefined' && id !== data[i].parent)) {\n          data.splice(i, 1);\n          i--;\n        } else {\n          delete data[i].parent;\n        }\n      }\n    };\n    clean(arrangedData);\n\n    // Set and return the arranged data\n    this.settings.dataset = arrangedData;\n    return arrangedData;\n  },\n\n  /**\n   * Check if given key is exists in dataset.\n   * @private\n   * @param {string} key to check.\n   * @param {object} data to check in.\n   * @returns {boolean} true if key found\n   */\n  hasKeyInData(key, data) {\n    let found = false;\n    data = data || this.settings.dataset;\n\n    /* eslint-disable no-restricted-syntax */\n    const findkey = (obj) => {\n      for (const prop in obj) {\n        if (obj.hasOwnProperty(prop)) {// eslint-disable-line\n          const value = obj[prop];\n          if (typeof value === 'object' && !found) {\n            findkey(value);\n          } else if (key === prop) {\n            found = true;\n          }\n          if (found) {\n            break;\n          }\n        }\n      }\n    };\n    /* eslint-enable no-restricted-syntax */\n\n    for (let i = 0, l = data.length; i < l; i++) {\n      if (found) {\n        break;\n      }\n      findkey(data[i]);\n    }\n    return found;\n  },\n\n  /**\n   * Create html for given json data.\n   * @private\n   * @param {object} data to do html.\n   * @param {number} position for node.\n   * @param {number} level for node.\n   * @param {boolean} isParentsDisabled for node.\n   * @returns {string} created html\n   */\n  getNodeHtml(data, position, level, isParentsDisabled) {\n    let selectHtml = '';\n    let selectedOptionText = '';\n    level = level || 0;\n    position += 1;\n    const s = this.settings;\n    const isDisabled = isParentsDisabled || data.disabled || false;\n    const a = {\n      id: typeof data.id !== 'undefined' ? ` id=\"${data.id}\"` : '',\n      href: ` href=\"${typeof data.href !== 'undefined' ? data.href : '#'}\"`,\n      expanded: ` aria-expanded=\"${data.open ? 'true' : 'false'}\"`,\n      icon: (data.icon || data.icon === '') ? data.icon : 'tree-node',\n      alertIcon: '',\n      alertIconAttr: typeof data.alertIcon !== 'undefined' ? ` data-alert-icon=\"${data.alertIcon}\"` : '',\n      text: `<span class=\"tree-text\">${data.text}</span>`,\n      class: ['hide-focus'],\n      ariaDisabled: isDisabled ? 'aria-disabled=\"true\"' : '',\n      checkbox: this.isMultiselect && (!this.settings.hideCheckboxes || data.hideCheckbox === false) ? '<span class=\"tree-checkbox\"></span>' : '',\n      badge: typeof data.badge === 'object' ? this.getBadgeHtml(data.badge) : ''\n    };\n    this.jsonData.push(data);\n\n    if (s.useStepUI) {\n      a.alertIcon = `<svg class=\"icon step-alert icon-${data.alertIcon}\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-${data.alertIcon}\"></use>`;\n    }\n\n    const isChildren = typeof data.children !== 'undefined';\n    let liClassList = isChildren ? 'folder' : '';\n    liClassList += data.selected ? ' is-selected' : '';\n    if (liClassList !== '') {\n      liClassList += data.open ? ' is-open' : '';\n      liClassList = ` class=\"${liClassList}\"`;\n    }\n    if (isDisabled) {\n      a.class.push('is-disabled');\n    }\n    if (data.icon) {\n      a.icon = data.icon;\n      if (!isChildren || (isChildren && (/open|closed/i.test(data.icon)))) {\n        a.class.push(data.icon);\n      }\n    }\n    if (isChildren) {\n      if (data.open) {\n        a.icon = data.icon && /open|closed/i.test(data.icon) ? data.icon : s.folderIconOpen;\n        isParentsDisabled = isDisabled;\n      } else {\n        a.icon = data.icon && /open|closed/i.test(data.icon) ? data.icon.replace('open', 'closed') : s.folderIconClosed;\n      }\n    }\n    a.icon = `#icon-${a.icon.replace(/^#?icon-?/, '')}`;\n    a.class = ` class=\"${a.class.join(' ')}\"`;\n    a.style = '';\n\n    // Insert dropdown start\n    if (data.type === 'dropdown') {\n      a.style = 'style=\"display: none\"';\n\n      if (data.data) {\n        selectHtml = '<select class=\"dropdown\" close-on-select=\"true\">';\n\n        for (let i = 0; i < data.data.length; i++) {\n          const option = data.data[i];\n          if (option.value === data.text) {\n            selectedOptionText = option.text;\n            selectHtml += `<option value=\"${option.value}\" selected>${option.text}</option>`;\n          } else {\n            selectHtml += `<option value=\"${option.value}\">${option.text}</option>`;\n          }\n        }\n\n        selectHtml += `</select><div class=\"dropdown-wrapper\"><div class=\"dropdown\"><span>${selectedOptionText}`;\n        selectHtml += '</span></div><svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-dropdown\"></use></svg></div>';\n        selectHtml = `<div class=\"treeDropdown\" style=\"width: 80px; margin-left: 35px; margin-bottom: -15px\">${selectHtml}</div>`;\n      }\n    }\n    // Insert dropdown end\n\n    let html = `\n      <li${liClassList}>\n        <a role=\"treeitem\" aria-selected=\"false\" tabindex=\"-1\" ${a.style}\n          aria-level=\"${level}\"\n          aria-position=\"${position}\"\n          aria-setsize=\"${position}\"\n          ${a.id + a.href + a.class + a.expanded + a.ariaDisabled + a.alertIconAttr}>\n            <svg class=\"icon-tree icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"${a.icon}\"></use>\n            </svg>${a.checkbox + a.alertIcon + a.badge + a.text}\n        </a>\n        ${selectHtml}`;\n\n    if (isChildren) {\n      html += `<ul class=\"folder${data.open ? ' is-open' : ''}\" role=\"group\">`;\n      for (let i = 0, l = data.children.length; i < l; i++) {\n        html += this.getNodeHtml(data.children[i], i, (level + 1), isParentsDisabled);\n      }\n      html += '</ul>';\n    }\n    html += '</li>';\n\n    return html;\n  },\n\n  /**\n   * Create badge html.\n   * @private\n   * @param {object} badgeData to do html.\n   * @returns {string} html created\n   */\n  getBadgeHtml(badgeData) {\n    const badge = { html: '', style: '', class: ['badge', 'tree-badge'] };\n\n    if (badgeData && !badgeData.remove) {\n      badge.text = '';\n\n      if (typeof badgeData.text !== 'undefined') {\n        badge.text = badgeData.text.toString();\n        if (badge.text.length === 1) {\n          badge.class.push('round');\n        }\n      }\n\n      if (/info|good|error|alert|pending/i.test(badgeData.type)) {\n        badge.class.push(badgeData.type);\n      } else if (badgeData.type && badgeData.type.charAt(0) === '#' && badgeData.type.length === 7) {\n        badge.style = `background-color: ${badgeData.type} !important;`;\n      }\n      if (badgeData.backColor) {\n        badge.style = `background-color: ${badgeData.backColor} !important;`;\n      }\n      if (badgeData.foreColor) {\n        badge.style += `color: ${badgeData.foreColor} !important;`;\n      }\n      if (badge.style !== '') {\n        badge.style = ` style=\"${badge.style}\"`;\n      }\n      if (badge.text !== '') {\n        if (badgeData.type && badgeData.type.indexOf('pending') !== -1) {\n          badge.text = '';\n        }\n        badge.html = `<span class=\"${badge.class.join(' ')}\"${badge.style}>${badge.text}</span>`;\n      }\n    }\n    return badge.html;\n  },\n\n  // Functions to Handle Internal Data Store\n  addToDataset(node, location) {\n    let elem;\n    let updatedNode;\n    let index;\n\n    if (node.parent) {\n      elem = this.findById(node.parent);\n    }\n\n    // Update dataset after inserting node before or after other node\n    if (location instanceof jQuery && location.is('li')) {\n      updatedNode = this.findById($(location[0].parentNode.parentNode).find('a')[0].id);\n      const childNodes = updatedNode.children || updatedNode.node.data('jsonData').children;\n      index = childNodes.findIndex(element => element.text.trim() === $(location).text().trim());\n\n      childNodes.splice(index, 0, node);\n    }\n\n    if (location === 'bottom' && !node.parent && !elem) {\n      this.settings.dataset.push(node);\n    }\n\n    if (location === 'top' && !node.parent && !elem) {\n      this.settings.dataset.unshift(node);\n    }\n\n    if (node.parent && elem) {\n      if (!elem.children) {\n        elem.children = [];\n      }\n\n      if (location === 'bottom') {\n        elem.children.push(node);\n      } else {\n        elem.children.unshift(node);\n      }\n    }\n\n    return !(node.parent && !elem);\n  },\n\n  // Find the Node (Dataset) By Id\n  findById(id, source) {\n    const self = this;\n\n    if (!source) {\n      source = this.settings.dataset;\n    }\n\n    /* eslint-disable guard-for-in */\n    /* eslint-disable no-restricted-syntax */\n    for (const key in source) {\n      const item = source[key];\n      if (item.id === id) {\n        return item;\n      }\n\n      if (item.children || item.node.data('jsonData').children) {\n        const subresult = self.findById(id, item.children || item.node.data('jsonData').children);\n\n        if (subresult) {\n          return subresult;\n        }\n      }\n    }\n    /* eslint-enable no-restricted-syntax */\n    /* eslint-enable guard-for-in */\n    return null;\n  },\n\n  // Get node by ID if selected\n  getNodeByIdIfSelected(id, source) {\n    const node = this.findById(id, source);\n    return (node && node.selected) ? node : null;\n  },\n\n  /**\n   * Get selected nodes.\n   * @returns {object} selected nodes\n   */\n  getSelectedNodes() {\n    let node;\n    let data;\n    const selected = [];\n\n    $('li.is-selected', this.element).each(function () {\n      node = $('a:first', this);\n      data = node.data('jsonData');\n      selected.push({ node, data });\n    });\n    return selected;\n  },\n\n  getNextNode(target) {\n    let next = target.parent().next().find('a:first');\n    const subTarget = target.next();\n\n    // Move Into Children\n    if (subTarget.is('ul.is-open')) {\n      next = subTarget.find('a:first');\n    }\n\n    // Skip disabled\n    if (next.hasClass('is-disabled')) {\n      next = next.parent().next().find('a:first');\n    }\n\n    // Bottom of a group..{l=1000: max folders to be deep }\n    if (next.length === 0) {\n      for (let i = 0, l = 1000, closest = target; i < l; i++) {\n        closest = closest.parent().closest('.folder');\n        next = closest.next().find('a:first');\n        if (next.length) {\n          break;\n        }\n      }\n    }\n\n    // Another check for disabled\n    if (next.hasClass('is-disabled')) {\n      next = this.getNextNode(next);\n    }\n\n    return next;\n  },\n\n  getPreviousNode(target) {\n    let prev = target.parent().prev().find('a:first');\n    let subTarget = prev.parent();\n\n    // Move into children at bottom\n    if (subTarget.is('.folder.is-open') &&\n        subTarget.find('ul.is-open a').length &&\n        !subTarget.find('ul.is-disabled').length) {\n      prev = subTarget.find('ul.is-open a:last');\n    }\n\n    // Skip disabled\n    if (prev.hasClass('is-disabled')) {\n      prev = prev.parent().prev().find('a:first');\n\n      // Another check if get to prev open folder\n      subTarget = prev.parent();\n      if (subTarget.is('.folder.is-open') &&\n          subTarget.find('ul.is-open a').length &&\n          !subTarget.find('ul.is-disabled').length) {\n        prev = subTarget.find('ul.is-open a:last');\n      }\n    }\n\n    // Top of a group\n    if (prev.length === 0) {\n      prev = target.closest('ul').prev('a');\n    }\n\n    // Another check for disabled\n    if (prev.hasClass('is-disabled')) {\n      prev = this.getPreviousNode(prev);\n    }\n\n    return prev;\n  },\n\n  /**\n   * Sync the tree with the underlying dataset\n   * @private\n   * @param {object} node the jQuery element to sync (Optional)\n   * @returns {void}\n   */\n  syncDataset(node) {\n    const json = [];\n    const self = this;\n    node = node || this.element;\n\n    const items = [].slice.call(node.children('li').toArray());\n    items.forEach((li) => {\n      json.push(self.syncNode(li.querySelector('a')));\n    });\n\n    this.settings.dataset = json;\n    this.element.triggerHandler('rendered', { data: this.settings.dataset });\n  },\n\n  /**\n   * Sync a node with its dataset record\n   * @private\n   * @param {object} node The node to sync (jQuery or DOM element)\n   * @returns {object} synced node data\n   */\n  syncNode(node) {\n    const self = this;\n    const nodeJQ = this.isjQuery(node) ? node : $(node);\n    node = nodeJQ[0];\n    const parent = node.parentNode;\n    const hasClass = (el, className) => el.classList.contains(className);\n\n    let entry = {\n      node: nodeJQ,\n      id: node.getAttribute('id'),\n      text: node.querySelector('.tree-text').textContent\n    };\n\n    // Is folder open\n    if (hasClass(node, 'is-open') ||\n        (parent && parent.tagName.toLowerCase() === 'li') && hasClass(parent, 'is-open')) {\n      entry.open = true;\n    }\n\n    // Href\n    const href = node.getAttribute('href');\n    if (href) {\n      entry.href = href;\n    }\n\n    // Selected\n    if (hasClass(parent, 'is-selected')) {\n      entry.selected = true;\n    }\n\n    // Disabled\n    if (hasClass(node, 'is-disabled')) {\n      entry.disabled = true;\n    }\n\n    // Icon\n    const classAttribute = node.getAttribute('class');\n    if (classAttribute && classAttribute.indexOf('icon') > -1) {\n      entry.icon = classAttribute;\n    }\n\n    // Children\n    const ul = nodeJQ.next();\n    if (ul[0] && ul[0].tagName.toLowerCase() === 'ul') {\n      entry.children = [];\n\n      const items = [].slice.call(ul.children('li').toArray());\n      items.forEach((li) => {\n        entry.children.push(self.syncNode(li.querySelector('a')));\n      });\n    }\n\n    // Merge json data\n    const jsonData = nodeJQ.data('jsonData');\n    if (jsonData) {\n      delete jsonData.selected;\n      delete jsonData.children;\n      entry = $.extend({}, jsonData, entry);\n    }\n\n    nodeJQ.data('jsonData', entry);\n    return entry;\n  },\n\n  /**\n   * Add a node and all its related markup.\n   * @param {object} nodeData to add.\n   * @param {object} location in tree.\n   * @param {string} isBeforeOrAfter to insert node before or after selected tree node.\n   * @returns {object} li added\n   */\n\n  // Parameter added - to add node before or after the node\n  addNode(nodeData, location, isBeforeOrAfter) {\n    const self = this;\n    let selectedOptionText;\n    let selectHtml;\n    let option;\n\n    const badgeAttr = typeof nodeData.badge === 'object' ? JSON.stringify(nodeData.badge) : nodeData.badge;\n\n    nodeData.href = typeof nodeData.href !== 'undefined' ? nodeData.href : '#';\n\n    location = (!location ? 'bottom' : location); // supports button or top or jquery node\n\n    let a = document.createElement('a');\n    a.setAttribute('id', nodeData.id);\n    a.setAttribute('href', nodeData.href);\n    if (typeof badgeAttr !== 'undefined') {\n      a.setAttribute('data-badge', badgeAttr);\n    }\n    if (typeof nodeData.alertIcon !== 'undefined') {\n      a.setAttribute('data-alert-icon', nodeData.alertIcon);\n    }\n\n    if (nodeData.text) {\n      a.textContent = nodeData.text;\n    }\n\n    if (nodeData.disabled) {\n      a.classList.add('is-disabled');\n    }\n    if (nodeData.icon) {\n      a.classList.add(nodeData.icon);\n    }\n\n    let li = document.createElement('li');\n\n    if (nodeData.open) {\n      li.classList.add('is-open');\n    }\n\n    li.appendChild(a);\n\n    // Insert dropdown start\n    if (nodeData.type === 'dropdown') {\n      a.setAttribute('style', 'display: none');\n\n      if (nodeData.data) {\n        selectHtml = '<select class=\"dropdown\" close-on-select=\"true\">';\n\n        for (let i = 0; i < nodeData.data.length; i++) {\n          option = nodeData.data[i];\n          if (option.value === nodeData.text) {\n            selectedOptionText = option.text;\n            selectHtml += `<option value=\"${option.value}\" selected>${option.text}</option>`;\n          } else {\n            selectHtml += `<option value=\"${option.value}\">${option.text}</option>`;\n          }\n        }\n\n        selectHtml += `</select><div class=\"dropdown-wrapper\"><div class=\"dropdown\"><span>${selectedOptionText}`;\n\n        selectHtml += '</span></div><svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-dropdown\"></use></svg></div>';\n\n        $(`<div class=\"treeDropdown\" style=\"width: 80px; margin-left: 35px; margin-bottom: -15px\">${selectHtml}</div>`).appendTo(li);\n\n        if (nodeData.disabled) {\n          $(li).find('select.dropdown').dropdown().disable();\n        } else {\n          $(li).find('select.dropdown').dropdown().on('selected.tree', function () {\n            const nodeToUpdate = self.findById(this.parentElement.previousElementSibling.id);\n            nodeToUpdate.text = this.value;\n            self.updateNode(nodeToUpdate);\n          });\n        }\n      }\n    }\n    // Insert dropdown end\n\n    // Handle Location\n    let found = this.loading ? true : this.addToDataset(nodeData, location);\n\n    if (nodeData.parent instanceof jQuery) {\n      found = true;\n    }\n\n    // Insert node in between the node\n    if (location instanceof jQuery && isBeforeOrAfter === 'before') {\n      $(li).insertBefore(location);\n      found = true;\n    } else if (location instanceof jQuery && isBeforeOrAfter === 'after') {\n      $(li).insertAfter(location);\n      found = true;\n    }\n\n    if (location instanceof jQuery &&\n      (!nodeData.parent || !found) && !(nodeData.parent instanceof jQuery)\n      && !(isBeforeOrAfter === 'before' || isBeforeOrAfter === 'after')) {\n      location[0].appendChild(li);\n      found = true;\n    }\n\n    if (location === 'bottom' && (!nodeData.parent || !found)) {\n      this.element[0].appendChild(li);\n    }\n\n    if (location === 'top' && (!nodeData.parent || !found)) {\n      this.element.prepend(li);\n    }\n\n    // Support ParentId in JSON Like jsTree\n    if (nodeData.parent) {\n      if (found && typeof nodeData.parent === 'string') {\n        li = this.element.find(`#${nodeData.parent}`).parent();\n\n        if (!nodeData.disabled && li.is('.is-selected') && typeof nodeData.selected === 'undefined') {\n          nodeData.selected = true;\n        }\n        this.addAsChild(nodeData, li);\n      }\n\n      if (nodeData.parent && nodeData.parent instanceof jQuery) {\n        li = nodeData.parent;\n        if (nodeData.parent.is('a')) {\n          li = nodeData.parent.parent();\n        }\n        this.addAsChild(nodeData, li);\n      }\n      if (this.isjQuery(li)) {\n        nodeData.node = li.find(`ul li a#${nodeData.id}`);\n      }\n    } else {\n      li = $(li);\n      this.addChildNodes(nodeData, li);\n      nodeData.node = li.children('a').first();\n    }\n\n    a = $(a);\n    // Added parameter to show or hide checkbox according to node.\n    this.decorateNode(a, nodeData.icon, nodeData.hideCheckbox);\n\n    if (nodeData.selected) {\n      this.selectNode(a, nodeData.focus);\n    }\n\n    a.data('jsonData', nodeData);\n    return li;\n  },\n\n  /**\n   * Add a node to an existing node, making it a folder if need be\n   * @private\n   * @param {object} nodeData data for node to be added.\n   * @param {object} li parent node to add node.\n   * @returns {void}\n   */\n  addAsChild(nodeData, li) {\n    li = this.isjQuery(li) ? li[0] : li;\n    let ul = li.querySelector('ul');\n    if (!ul) {\n      li.insertAdjacentHTML('beforeend', '<ul class=\"folder\"></ul>');\n      ul = li.querySelector('ul');\n    }\n\n    if (nodeData.open) {\n      ul.classList.add('is-open');\n    }\n\n    this.decorateNode(li.querySelector('a'));\n\n    nodeData.parent = '';\n    this.addNode(nodeData, $(ul));\n  },\n\n  /**\n   * Add the children for the specified node element,\n   * and if `nodeData.children` not passed will remove current children from node\n   * @private\n   * @param {object} nodeData data for children to be added.\n   * @param {object} li parent node to add children.\n   * @returns {void}\n   */\n  addChildNodes(nodeData, li) {\n    li = this.isjQuery(li) ? li[0] : li;\n    let ul = li.querySelector('ul');\n\n    if (!nodeData.children) {\n      if (ul) {\n        ul.parentNode.removeChild(ul);\n      }\n      return;\n    }\n\n    if (!ul) {\n      li.insertAdjacentHTML('beforeend', `<ul class=\"folder${nodeData.open ? ' is-open' : ''}\"></ul>`);\n      ul = li.querySelector('ul');\n    }\n\n    ul.innerHTML = '';\n\n    if (nodeData.children) {\n      nodeData.children.forEach(elem => this.addNode(elem, $(ul)));\n    }\n  },\n\n  // Check for true value\n  isTrue(v) {\n    return (typeof v !== 'undefined' && v !== null && ((typeof v === 'boolean' && v === true) || (typeof v === 'string' && v.toLowerCase() === 'true')));\n  },\n\n  // Check for false value\n  isFalse(v) {\n    return (typeof v !== 'undefined' && v !== null && ((typeof v === 'boolean' && v === false) || (typeof v === 'string' && v.toLowerCase() === 'false')));\n  },\n\n  /**\n   * Update fx rename a node.\n   * @param {object} nodeData to update.\n   * @returns {void}\n   */\n  updateNode(nodeData) {\n    // Passed in the node element or find the node in the dataset and ui and sync it\n    const elem = nodeData.node ? { node: nodeData.node } : this.findById(nodeData.id);\n    if (!elem || !elem.node[0]) {\n      return;\n    }\n\n    const parent = elem.node[0].parentNode;\n    const nodetext = elem.node[0].querySelector('.tree-text');\n    const isDisabled = this.isTrue(nodeData.disabled) || this.isFalse(nodeData.enabled);\n    const isEnabled = this.isTrue(nodeData.enabled) || this.isFalse(nodeData.disabled);\n\n    // Update badge\n    if (nodeData.badge) {\n      let badge = elem.node[0].querySelector('.tree-badge');\n      if (!badge && !nodeData.badge.remove) {\n        if (typeof nodeData.badge.text !== 'undefined' && $.trim(nodeData.badge.text) !== '') {\n          const newBadge = document.createElement('span');\n          newBadge.classList.add('tree-badge', 'badge');\n          nodetext.parentNode.insertBefore(newBadge, nodetext);\n          badge = elem.node[0].querySelector('.tree-badge');\n        }\n      }\n      // Make update changes\n      if (badge) {\n        if (typeof nodeData.badge.text !== 'undefined') {\n          nodeData.badge.text = nodeData.badge.text.toString();\n          badge.textContent = nodeData.badge.text;\n          badge.classList.remove('round');\n          if (nodeData.badge.text.length === 1) {\n            badge.classList.add('round');\n          }\n        }\n        if (typeof nodeData.badge.type !== 'undefined') {\n          badge.classList.remove('info', 'good', 'error', 'alert', 'pending');\n          if (/info|good|error|alert|pending/i.test(nodeData.badge.type)) {\n            badge.classList.add(nodeData.badge.type);\n          } else if (nodeData.badge.type.charAt(0) === '#' && nodeData.badge.type.length === 7) {\n            badge.style.backgroundColor = nodeData.badge.type;\n          }\n\n          if (nodeData.badge.type.indexOf('pending') !== -1) {\n            badge.textContent = '';\n          }\n        }\n        elem.badge = nodeData.badge;\n\n        // Remove badge\n        if (this.parseBool(nodeData.badge.remove)) {\n          badge.parentNode.removeChild(badge);\n          if (typeof elem.badge !== 'undefined') {\n            delete elem.badge;\n          }\n        }\n      }\n    }\n\n    if (nodeData.text) {\n      nodetext.textContent = nodeData.text;\n      elem.text = nodeData.text;\n    }\n\n    if (nodeData.icon) {\n      this.setTreeIcon(elem.node[0].querySelector('svg.icon-tree'), nodeData.icon);\n      elem.icon = nodeData.icon;\n    } else if (nodeData.children && nodeData.children.length &&\n      !parent.classList.contains('folder')) {\n      this.convertFileToFolder(elem.node);\n    }\n\n    if (isDisabled) {\n      elem.node[0].classList.add('is-disabled');\n      elem.node[0].setAttribute('aria-disabled', 'true');\n\n      if (parent.classList.contains('folder') && parent.classList.contains('is-open')) {\n        const nodes = [].slice.call(parent.querySelectorAll('a, ul[role=group]'));\n        nodes.forEach((node) => {\n          node.classList.add('is-disabled');\n          node.setAttribute('aria-disabled', 'true');\n        });\n      }\n    }\n\n    if (isEnabled) {\n      const isParentsDisabled = elem.node.parentsUntil(this.element, 'ul[role=group].is-disabled').length > 0;\n\n      if (!isParentsDisabled) {\n        elem.node[0].classList.remove('is-disabled');\n        elem.node[0].removeAttribute('aria-disabled');\n\n        if (parent.classList.contains('folder') && parent.classList.contains('is-open')) {\n          const nodes = [].slice.call(parent.querySelectorAll('a, ul[role=group]'));\n          nodes.forEach((node) => {\n            node.classList.remove('is-disabled');\n            node.removeAttribute('aria-disabled');\n          });\n        }\n      }\n    }\n\n    if (nodeData.node) {\n      this.syncDataset();\n    }\n\n    if (nodeData.children) {\n      if (nodeData.children.length) {\n        this.addChildNodes(nodeData, parent);\n      } else {\n        this.removeChildren(nodeData, parent);\n      }\n    }\n    this.createSortable();\n  },\n\n  // Performs the usual Boolean coercion with the exception of\n  // the strings \"false\" (case insensitive) and \"0\"\n  parseBool(b) {\n    return !(/^(false|0)$/i).test(b) && !!b;\n  },\n\n  /**\n   * Delete children nodes\n   * @private\n   * @param {object} nodeData data for icon to be replaced.\n   * @param {object} li parent node to delete children.\n   * @returns {void}\n   */\n  removeChildren(nodeData, li) {\n    li = this.isjQuery(li) ? li[0] : li;\n    const ul = li.querySelector('ul');\n\n    this.setTreeIcon(li.querySelector('svg.icon-tree'), (nodeData.icon || 'icon-tree-node'));\n    li.classList.remove('folder', 'is-open');\n    if (ul) {\n      ul.parentNode.removeChild(ul);\n    }\n  },\n\n  /**\n   * Delete a node from the dataset or tree.\n   * @param {object} nodeData to delete.\n   * @returns {void}\n   */\n  removeNode(nodeData) {\n    let elem = this.findById(nodeData.id);\n\n    if (nodeData instanceof jQuery) {\n      elem = nodeData;\n      elem.parent().remove();\n    } else if (elem) {\n      elem.node.parent().remove();\n    }\n\n    if (!elem) {\n      return;\n    }\n    this.syncDataset();\n  },\n\n  // Attach Context Menus\n  attachMenu(menuId) {\n    const self = this;\n\n    if (!menuId) {\n      return;\n    }\n\n    this.element.off('contextmenu.tree').on('contextmenu.tree', 'a', function (e) {\n      const node = $(this);\n      e.preventDefault();\n      self.popupEl = $(e.currentTarget).popupmenu({ menuId, eventObj: e, trigger: 'immediate', attachToBody: true }).off('selected').on('selected', (event, args) => {\n        /**\n        * Fires when the an attached context menu item is selected.\n        *\n        * @event menuselect\n        * @memberof Tree\n        * @type {object}\n        * @property {object} event - The jquery event object\n        * @property {object} args for node element, item\n        * @property {HTMLElement} args.node The DOM Element.\n        * @property {object} data.item The attached node data.\n        */\n        self.element.triggerHandler('menuselect', { node, item: args });\n      });\n\n      /**\n      * Fires when the attached context menu is opened. Use it to update the menu as needed\n      * @memberof Tree\n      * @event menuopen\n      * @type {object}\n      * @property {object} event - The jquery event object\n      * @property {object} args for node element, item\n      * @property {HTMLElement} args.menu The menu item\n      * @property {HTMLElement} args.node The DOM Element.\n      */\n      self.element.triggerHandler('menuopen', { menu: $(`#${menuId}`), node });\n      return false;\n    });\n  },\n\n  /**\n   * Create sortable.\n   * @private\n   * @returns {void}\n   */\n  createSortable() {\n    if (!this.settings.sortable) {\n      return;\n    }\n\n    const self = this;\n    let clone;\n    let interval;\n    let doDrag;\n\n    self.targetArrow = self.element[0].previousElementSibling;\n    self.linkSelector = 'a:not(.is-dragging-clone):not(.is-disabled)';\n\n    if (!self.targetArrow || (self.targetArrow && !self.targetArrow.classList.contains('tree-drag-target-arrow'))) {\n      const div = document.createElement('div');\n      div.classList.add('tree-drag-target-arrow');\n      self.element[0].parentNode.insertBefore(div, self.element[0]);\n      self.targetArrow = self.element[0].previousElementSibling;\n    }\n\n    function isReady() {\n      // Make sure all dynamic nodes sync\n      if (!self.loading) {\n        clearInterval(interval);\n\n        const links = [].slice.call(self.element[0].querySelectorAll(self.linkSelector));\n        links.forEach((link) => {\n          const a = $(link);\n\n          // Quit if already binded with `drag`\n          if (a.data('drag')) {\n            return;\n          }\n\n          // Don't drag with folder icon, save for toggle nodes\n          a.on('mousedown.tree', (e) => {\n            e.preventDefault();\n\n            if (e.which === 3) {\n              doDrag = false;\n            } else {\n              doDrag = e.target.classList.contains('icon') ?\n                !link.parentNode.classList.contains('folder') : true;\n            }\n          })\n\n            // Invoke drag\n            .drag({\n              clone: true,\n              cloneAppendTo: a.closest('li'),\n              clonePosIsFixed: true\n            })\n\n            // Drag start =======================================\n            .on('dragstart.tree', (e, pos, thisClone) => {\n              if (!thisClone || !doDrag) {\n                link.classList.remove('is-dragging');\n                if (thisClone) {\n                  thisClone[0].parentNode.removeChild(thisClone[0]);\n                }\n                return;\n              }\n              clone = thisClone;\n              clone[0].removeAttribute('id');\n              clone[0].classList.add('is-dragging-clone');\n\n              const items = [].slice.call(clone[0].querySelectorAll('.tree-checkbox, .tree-badge'));\n              items.forEach(node => node.parentNode.removeChild(node));\n\n              const startUl = a.closest('ul');\n              self.sortable = {\n                // Do not use index from each loop, get updated index on drag start\n                startIndex: $(self.linkSelector, self.element).index(a),\n                startNode: a,\n                startIcon: $('svg.icon-tree', a).getIconName(),\n                startUl,\n                startLi: a.closest('li'),\n                startFolderNode: startUl.prev('a'),\n                startWidth: a.outerWidth()\n              };\n\n              self.element.triggerHandler('sortstart', self.sortable);\n              e.preventDefault();\n              e.stopImmediatePropagation();\n            })\n\n            // While dragging ===================================\n            .on('drag.tree', (e, pos) => {\n              if (!clone) {\n                return;\n              }\n              clone[0].style.left = `${pos.left}px`;\n              clone[0].style.top = `${pos.top}px`;\n              clone[0].style.opacity = '1';\n              self.setDragOver(clone, pos);\n            })\n\n            // Drag end =========================================\n            .on('dragend.tree', (e, pos) => {\n              self.targetArrow.style.display = 'none';\n              const items = [].slice.call(self.element[0].querySelectorAll(self.linkSelector));\n              items.forEach(node => node.classList.remove('is-over'));\n\n              if (!clone || !self.sortable.overDirection) {\n                return;\n              }\n              clone[0].style.left = `${pos.left}px`;\n              clone[0].style.top = `${pos.top}px`;\n\n              const start = self.sortable.startNode.parent();\n              const end = self.sortable.overNode.parent();\n\n              // Over\n              if (self.sortable.overDirection === 'over') {\n                if (!end[0].classList.contains('folder')) {\n                  self.convertFileToFolder(self.sortable.overNode);\n                }\n                end[0].querySelector('ul').appendChild(start[0]);\n                if (!end[0].classList.contains('is-open')) {\n                  self.toggleNode(self.sortable.overNode, e);\n                }\n              } else if (self.sortable.overDirection === 'up') {\n                // Up\n                start.insertBefore(end);\n              } else if (self.sortable.overDirection === 'down') {\n                // Down\n                if (end[0].classList.contains('is-open') && end[0].classList.contains('folder')) {\n                  $('ul:first', end).prepend(start);\n                } else {\n                  start.insertAfter(end);\n                }\n              }\n\n              // Restore file type\n              if (!self.sortable.startUl[0].querySelector('li') &&\n                !!self.sortable.startFolderNode.data('oldData') &&\n                  self.sortable.startFolderNode.data('oldData').type === 'file') {\n                self.convertFolderToFile(self.sortable.startFolderNode);\n              }\n\n              // Fix: On windows 10 with IE-11 icons disappears\n              utils.fixSVGIcons(start);\n\n              self.element.triggerHandler('sortend', self.sortable);\n              // Sync dataset and ui\n              self.syncDataset();\n              if (self.isMultiselect) {\n                self.initSelected();\n              }\n            });\n        });\n      }\n    }\n    // Wait for make sure all dynamic nodes sync\n    interval = setInterval(isReady, 10);\n  },\n\n  /**\n   * Set actions while drag over.\n   * @private\n   * @param {object} clone node.\n   * @param {object} pos node positions to compare.\n   * @returns {void}\n   */\n  setDragOver(clone, pos) {\n    const self = this;\n    const cloneSvg = clone[0].querySelector('svg.icon-tree');\n    const treeRec = self.element[0].getBoundingClientRect();\n    let extra = 20;\n    let exMargin;\n    let isParentsStartNode;\n    let isBeforeStart;\n    let isAfterSttart;\n    let li;\n    let a;\n    let ul;\n    let links;\n    let rec;\n    let left;\n    let top;\n    let direction;\n    let doAction;\n\n    // Set as out of range\n    const outOfRange = function () {\n      self.sortable.overNode = null;\n      self.sortable.overIndex = null;\n      self.sortable.overDirection = null;\n\n      self.targetArrow.style.display = 'none';\n      self.setTreeIcon(cloneSvg, 'icon-cancel');\n    };\n\n    // Moving inside tree\n    if (pos.top > (treeRec.top - extra) &&\n        pos.top < (treeRec.bottom + extra) &&\n        pos.left > (treeRec.left - extra - self.sortable.startWidth) &&\n        pos.left < (treeRec.left + treeRec.height + extra)) {\n      extra = 2;\n      links = [].slice.call(self.element[0].querySelectorAll(self.linkSelector));\n\n      links.forEach((link, i) => {\n        direction = null;\n        rec = link.getBoundingClientRect();\n\n        // Moving on/around node range\n        if (pos.top > rec.top - extra && pos.top < rec.bottom + extra) {\n          a = $(link);\n\n          // Moving on/around node has parents as same node need to rearrange\n          // Cannot rearrange parents to child\n          isParentsStartNode = !!a.parentsUntil(self.element, '.folder')\n            .filter(function () {\n              return $('a:first', this).is(self.sortable.startNode) && self.sortable.startLi.is('.folder');\n            }).length;\n          if (isParentsStartNode) {\n            outOfRange();\n            return;\n          }\n\n          li = link.parentNode;\n          left = rec.left;\n          ul = a.closest('ul');\n          exMargin = parseInt(li.style.marginTop, 10) > 0 ? 2 : 0;\n          isBeforeStart = ((i - 1) === self.sortable.startIndex && ul.is(self.sortable.startUl));\n          isAfterSttart = ((i + 1) === self.sortable.startIndex && ul.is(self.sortable.startUl));\n          links.forEach(node => node.classList.remove('is-over'));\n\n          // Apply actions\n          /* eslint-disable no-loop-func */\n          doAction = function () {\n            if (!direction) {\n              outOfRange();\n              return;\n            }\n\n            // Reset icon\n            self.setTreeIcon(cloneSvg, self.sortable.startIcon);\n\n            // Over\n            if (direction === 'over') {\n              self.targetArrow.style.display = 'none';\n              if (!link.classList.contains('is-disabled')) {\n                link.classList.add('is-over');\n              }\n            } else {\n              // Up -or- Down\n              links.forEach(node => node.classList.remove('is-over'));\n              top = (direction === 'up') ?\n                (rec.top - 1.5 - (li.classList.contains('is-active') ? 3 : 0)) :\n                (rec.bottom + (li.nextElementSibling && li.nextElementSibling.classList.contains('is-active') ? -1 : 1.5) + exMargin);\n              self.targetArrow.style.left = `${left}px`;\n              self.targetArrow.style.top = `${top}px`;\n              self.targetArrow.style.display = 'block';\n            }\n\n            // Set changes\n            self.sortable.overNode = a;\n            self.sortable.overIndex = i;\n            self.sortable.overDirection = direction;\n          };\n          /* eslint-disable no-loop-func */\n\n          // Set moveing directions\n          if (i !== self.sortable.startIndex) {\n            // If hover on link\n            if (pos.left > rec.left - extra - self.sortable.startWidth &&\n              pos.left < rec.right + extra) {\n              if (!isBeforeStart && pos.top < rec.top) {\n                direction = 'up';\n              } else if (!isAfterSttart && pos.top > rec.top + (extra * 2)) {\n                direction = 'down';\n              } else {\n                direction = 'over';\n              }\n            } else if (!isBeforeStart && pos.top < rec.top) {\n              // Not hover on link\n              direction = 'up';\n            } else if (!isAfterSttart) {\n              direction = 'down';\n            }\n          }\n          doAction(direction);\n        }\n      });\n    } else {\n      // Out side from tree area\n      outOfRange();\n    }\n  },\n\n  // Convert file node to folder type\n  convertFileToFolder(node) {\n    const newFolder = document.createElement('ul');\n    newFolder.setAttribute('role', 'group');\n    const oldData = {\n      icon: $('svg.icon-tree', node).getIconName(),\n      type: 'file'\n    };\n    if (this.hasIconClass(node)) {\n      const iconClass = node.attr('class').replace(/\\s?is-selected/, '');\n      oldData.iconClass = iconClass;\n      node.removeClass(iconClass);\n    }\n    node.data('oldData', oldData);\n    const parent = node[0].parentNode;\n    if (parent && parent.tagName.toLowerCase() === 'li') {\n      parent.classList.add('folder');\n      parent.appendChild(newFolder);\n    }\n    this.setTreeIcon($('svg.icon-tree', node), this.settings.folderIconClosed);\n  },\n\n  // Convert folder node to file type\n  convertFolderToFile(node) {\n    const parent = node.parent('.folder');\n    parent.removeClass('folder is-open');\n    $('ul:first', parent).remove();\n    if (parent.length) {\n      this.setTreeIcon(\n        $('svg.icon-tree', node),\n        node.data('oldData') ? node.data('oldData').icon : 'tree-node'\n      );\n      if (node.data('oldData') && node.data('oldData').iconClass) {\n        node.addClass(node.data('oldData').iconClass);\n      }\n      node.data('oldData', null);\n    }\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    if (this.settings.sortable) {\n      this.element.find('a').each(function () {\n        const a = $(this);\n        const dragApi = a.data('drag');\n        a.off('mousedown.tree');\n        if (!!dragApi && !!dragApi.destroy) {\n          dragApi.destroy();\n        }\n      });\n      this.element.prev('.tree-drag-target-arrow').remove();\n    }\n    this.element.off('contextmenu.tree updated.tree click.tree focus.tree keydown.tree keypress.tree');\n\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, TREE_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    this.element.empty();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * Disables all nodes in the Tree component\n   * @returns {void}\n   */\n  disable() {\n    const nodes = [].slice.call(this.element[0].querySelectorAll('a'));\n    nodes.forEach((node) => {\n      node.classList.add('is-disabled');\n      node.setAttribute('aria-disabled', 'true');\n    });\n  },\n\n  /**\n   * Enables all nodes in the Tree component\n   * @returns {void}\n   */\n  enable() {\n    const nodes = [].slice.call(this.element[0].querySelectorAll('a'));\n    nodes.forEach((node) => {\n      node.classList.remove('is-disabled');\n      node.removeAttribute('aria-disabled');\n    });\n  },\n\n  /**\n   * Preserves all nodes' enablement states in the Tree component\n   * @returns {array} of node objects containing attributes nodeId and state (enablement state)\n   */\n  preserveEnablementState() {\n    const nodes = [].slice.call(this.element[0].querySelectorAll('a'));\n    const enablementStates = [];\n\n    nodes.forEach((node) => {\n      if ((node.classList.contains('is-disabled')) || (node.getAttribute('aria-disabled') === true)) {\n        enablementStates.push({ nodeId: node.id, state: 'disabled' });\n      } else {\n        enablementStates.push({ nodeId: node.id, state: 'enabled' });\n      }\n    });\n\n    this.settings.originalEnablementState = enablementStates;\n    return enablementStates;\n  },\n\n  /**\n   * Restores all nodes' original enablement states in the Tree component\n   * @returns {void}\n   */\n  restoreEnablementState() {\n    const nodes = [].slice.call(this.element[0].querySelectorAll('a'));\n\n    // check to prevent error if preserveEnablementState() has not been invoked\n    if (!(this.settings.originalEnablementState === null)) {\n      nodes.forEach((node) => {\n        this.settings.originalEnablementState.forEach((origNode) => {\n          if (origNode.nodeId === node.id) {\n            if (origNode.state === 'disabled') {\n              node.classList.add('is-disabled');\n              node.setAttribute('aria-disabled', 'true');\n            } else {\n              node.classList.remove('is-disabled');\n              node.removeAttribute('aria-disabled');\n            }\n          }\n        });\n      });\n    }\n  }\n\n};\n\nexport { Tree, COMPONENT_NAME };\n","import { Tree, COMPONENT_NAME } from './tree';\n\n/**\n * jQuery Component Wrapper for Tree\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.tree = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Tree(this, settings));\n    }\n  });\n};\n","// Shared Imports\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { charts } from '../charts/charts';\nimport { Locale } from '../locale/locale';\nimport { theme } from '../theme/theme';\n\nimport '../emptymessage/emptymessage.jquery';\n\n// Settings and Options\nconst COMPONENT_NAME = 'treemap';\n\n// Default Radar Options\nconst TREEMAP_DEFAULTS = {\n  dataset: [],\n  redrawOnResize: true,\n  margin: { top: 20, right: 20, bottom: 20, left: 20 },\n  colors: null,\n  showLabel: true,\n  labelFormatter: '.0%',\n  showTitle: true,\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' }\n};\n\n/**\n * A radar chart is a diagram representing hierarchical data in the form of nested rectangles,\n * the area of each corresponding to its numerical value.\n * @class Treemap\n * @param {string} element The plugin element for the constuctor\n * @param {string} settings The settings element.\n * @param {array} settings.dataset The data to use in the radar\n * @param {boolean} [settings.redrawOnResize = true] If false, the component will not resize when resizing the page.\n * @param {object} [settings.margin] The margins of the SVG, which you may want to adjust depending on text location.\n * @param {array} [settings.colors] An array of colors used in sequence from front to end of the array.\n * @param {boolean} [settings.showLabel] If false then the percentage wont be shown in the blocks.\n * @param {string} [settings.labelFormatter] The d3 formatter function for the value label.\n * @param {boolean} [settings.showTitle] If true then the first name will be used for the title area.\n * @param {object} [settings.emptyMessage] An empty message will be displayed when there is no chart data.\n * This accepts an object of the form emptyMessage:\n * `{title: 'No Data Available',\n *  info: 'Make a selection on the list above to see results', icon: 'icon-empty-no-data',\n *  button: {text: 'xxx', click: <function>}\n *  }`\n*   Set this to null for no message or will default to 'No Data Found with an icon.'\n*/\nfunction Treemap(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, TREEMAP_DEFAULTS);\n  if (settings && settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeStart(COMPONENT_NAME);\n}\n\n// Plugin Methods\nTreemap.prototype = {\n\n  /**\n   * Do initialization, build up and / or add events ect.\n   * @private\n   * @returns {object} The component prototype for chaining.\n   */\n  init() {\n    this\n      .build()\n      .handleEvents();\n\n    /**\n    * Fires when the chart is complete done rendering, for customization.\n    * @event rendered\n    * @memberof Treemap\n    * @property {object} event - The jquery event object\n    * @property {array} svg - The svg object.\n    */\n    this.element.trigger('rendered', [this.svg]);\n\n    return this;\n  },\n\n  /**\n   * Build the Component.\n   * @returns {object} The component prototype for chaining.\n   * @private\n   */\n  build() {\n    if (!this.settings.colors) {\n      const palette = theme.themeColors().palette;\n      this.settings.colors = [\n        palette.azure['100'].value,\n        palette.azure['90'].value,\n        palette.azure['80'].value,\n        palette.azure['70'].value,\n        palette.azure['60'].value,\n        palette.azure['40'].value,\n        palette.azure['30'].value,\n        palette.azure['20'].value,\n        palette.amethyst['100'].value,\n        palette.amethyst['90'].value,\n        palette.amethyst['80'].value,\n        palette.amethyst['70'].value,\n        palette.amethyst['60'].value,\n        palette.amethyst['50'].value,\n        palette.amethyst['40'].value,\n        palette.amethyst['40'].value,\n        palette.amethyst['30'].value,\n        palette.amethyst['20'].value,\n        palette.turquoise['100'].value,\n        palette.turquoise['90'].value,\n        palette.turquoise['80'].value,\n        palette.turquoise['70'].value,\n        palette.turquoise['60'].value,\n        palette.turquoise['50'].value,\n        palette.turquoise['40'].value,\n        palette.turquoise['40'].value,\n        palette.turquoise['30'].value,\n        palette.turquoise['20'].value\n      ];\n    }\n\n    this.updateData(this.settings.dataset);\n    return this;\n  },\n\n  /**\n   * Update the chart with a new dataset\n   * @param  {object} data The data to use.\n   */\n  updateData(data) {\n    const margin = Object.create(this.settings.margin);\n    const width = this.element.parent().width() - margin.left - margin.right;\n    let height = this.element.parent().height() - margin.top - margin.bottom;\n    // Define the colors\n    const color = d3.scaleOrdinal().range(this.settings.colors);\n\n    // Handle Empty Data Set\n    if (data.length === 0) {\n      this.element.emptymessage(this.settings.emptyMessage);\n      return;\n    }\n\n    // Show the title area\n    if (this.settings.showTitle && data.name) {\n      d3.select(this.element[0])\n        .append('div')\n        .attr('class', 'chart-treemap-title')\n        .text(data.name);\n\n      height -= 35;\n      margin.top -= 19;\n    }\n\n    // Run the d3 tree map algorithm\n    const treemap = d3.treemap().size([width, height]);\n\n    // Set the height / width and class\n    this.root = d3.select(this.element[0]).classed('chart-treemap', true)\n      .append('div')\n      .style('position', 'relative')\n      .style('width', `${width + margin.left + margin.right}px`)\n      .style('height', `${height + margin.top + margin.bottom}px`)\n      .style('left', `${margin.left}px`)\n      .style('top', `${margin.top}px`);\n\n    // Format the data into a hierarchy tree\n    const root = d3.hierarchy(data, d => d.children)\n      .sum(d => d.value);\n    const tree = treemap(root);\n\n    this.total = d3.sum(tree.leaves(), d => d.value);\n\n    // Add the tree map nodes\n    this.root.datum(root).selectAll('.chart-treemap-node')\n      .data(tree.leaves())\n      .enter()\n      .append('div')\n      .attr('class', 'chart-treemap-node')\n      .style('left', d => `${d.x0}px`)\n      .style('top', d => `${d.y0}px`)\n      .style('width', d => `${Math.max(0, d.x1 - d.x0 - 1)}px`)\n      .style('height', d => `${Math.max(0, d.y1 - d.y0 - 1)}px`)\n      .style('background', (d) => {\n        if (!d || !d.parent || !d.parent.data) {\n          return '';\n        }\n        return color(d.parent.data.name);\n      })\n      .text(d => d.data.name);\n\n    if (this.settings.showLabel) {\n      this.root.selectAll('.chart-treemap-node')\n        .append('span')\n        .attr('class', 'chart-treemap-percent')\n        .text(d => d3.format(this.settings.labelFormatter)(d.value / this.total));\n    }\n  },\n\n  /**\n   * Sets up event handlers for this component and its sub-elements.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  handleEvents() {\n    this.element.on(`updated.${COMPONENT_NAME}`, () => {\n      this.updated();\n    });\n\n    if (this.settings.redrawOnResize) {\n      $('body').on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n\n      this.element.on(`resize.${COMPONENT_NAME}`, () => {\n        this.handleResize();\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * Handles resizing a chart.\n   * @private\n   * @returns {void}\n   */\n  handleResize() {\n    if (this.width === this.element.width()) {\n      return;\n    }\n\n    this.width = this.element.width();\n\n    if (!this.element.is(':visible')) {\n      return;\n    }\n\n    this.updated();\n  },\n\n  /**\n   * Handle updated settings and values.\n   * @param  {object} settings The new settings to use.\n   * @returns {object} The api for chaining.\n   */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n\n    this.element.empty();\n    return this\n      .build();\n  },\n\n  /**\n   * Simple Teardown - remove events & rebuildable markup.\n   * @private\n   * @returns {object} The Component prototype, useful for chaining.\n   */\n  teardown() {\n    this.element.off(`updated.${COMPONENT_NAME}`);\n    $('body').off(`resize.${COMPONENT_NAME}`);\n    return this;\n  },\n\n  /**\n   * Teardown - Remove added markup and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.element.empty().removeClass('chart-treemap');\n    charts.removeTooltip();\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Treemap, COMPONENT_NAME };\n","import { Treemap, COMPONENT_NAME } from './treemap';\n\n/**\n * jQuery Component Wrapper for Tremmap\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.treemap = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Treemap(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { deprecateMethod } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\n\n// Component Name\nconst COMPONENT_NAME = 'wizard';\n\n// Component Default Settings\nconst WIZARD_DEFAULTS = {\n  ticks: null\n};\n\n/**\n * A horizontal form based wizard component.\n * @class Wizard\n * @param {jQuery[]|HTMLElement} element the Wizard container\n * @param {object} [settings] incoming settings\n * @param {jQuery[]} [settings.ticks]  Defines the data to use, must be specified.\n */\nfunction Wizard(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, WIZARD_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nWizard.prototype = {\n\n  /**\n   * @private\n   */\n  init() {\n    this\n      .build()\n      .handleEvents();\n  },\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  build() {\n    this.header = this.element.find('.wizard-header');\n    if (!this.header.length) {\n      this.header = $('<div class=\"wizard-header\"></div>').appendTo(this.element);\n    }\n\n    this.bar = this.element.find('.bar');\n    if (!this.bar.length) {\n      this.bar = $('<div class=\"bar\"></div>').appendTo(this.header);\n    }\n\n    this.completedRange = this.element.find('.completed-range');\n    if (!this.completedRange.length) {\n      this.completedRange = $('<div class=\"completed-range\"></div>').appendTo(this.bar);\n    }\n\n    this\n      .buildTicks()\n      .updateRange();\n\n    return this;\n  },\n\n  /**\n   * Builds the HTML Markup that draws out defined Wizard tick marks.\n   * @private\n   * @returns {this} component instance\n   */\n  buildTicks() {\n    const settingTicks = this.settings.ticks;\n    const self = this;\n\n    this.ticks = this.bar.children('.tick');\n\n    if (!this.ticks.length && settingTicks) {\n      for (let i = 0; i < settingTicks.length; i++) {\n        const link = $(`<a ng-click=\"handleClick()\" class=\"tick ${settingTicks[i].state ? settingTicks[i].state : ''}\" href=\"${settingTicks[i].href ? settingTicks[i].href : '#'}\"><span class=\"label\">${settingTicks[i].label}</span></a>`);\n\n        if (settingTicks[i].ngClick) {\n          link.attr('ng-click', settingTicks[i].ngClick);\n        }\n\n        self.bar.append(link);\n      }\n      this.ticks = this.bar.children('.tick');\n    }\n    this.positionTicks();\n\n    $('.tick', self.element).each(function () {\n      const tick = $(this);\n      if (tick.hasClass('is-disabled')) {\n        tick.removeAttr('onclick ng-click');\n      }\n    });\n\n    this.element.find('.wizard-header')[0].style.opacity = '1';\n    return this;\n  },\n\n  positionTicks() {\n    const l = this.ticks.length;\n    const delta = 100 / (l - 1);\n    const tickPos = [];\n\n    function getPoint(i) {\n      if (i === 0) {\n        return 0;\n      }\n      if (i === l - 1) {\n        return 100;\n      }\n      return delta * i;\n    }\n\n    for (let i = 0; i < l; i++) {\n      tickPos.push(getPoint(i));\n    }\n\n    this.ticks.each(function (i) {\n      const tick = $(this);\n      const label = tick.children('.label');\n      const left = (Locale ? Locale.isRTL() : false) ? (100 - tickPos[i]) : tickPos[i];\n\n      this.style.left = `${left}%`;\n\n      for (let i2 = 0, l2 = label.length; i2 < l2; i2++) {\n        label[i2].style.left = `-${label.outerWidth() / 2 - tick.outerWidth() / 2}px`;\n      }\n\n      if (tick.is('.is-disabled')) {\n        tick.attr('tabindex', '-1');\n      }\n    });\n  },\n\n  /**\n   * Re-renders the Wizard Range with updated ticks\n   * @private\n   * @returns {this} component instance\n   */\n  updateRange() {\n    const currentTick = this.ticks.filter('.current').last();\n    let widthPercentage = 0;\n\n    if (currentTick.length) {\n      widthPercentage = (100 * parseFloat(window.getComputedStyle(currentTick[0]).left) /\n        parseFloat(window.getComputedStyle(currentTick.parent()[0]).width));\n      widthPercentage = (Locale ? Locale.isRTL() : false) ? (100 - widthPercentage)\n        : widthPercentage;\n    }\n\n    this.completedRange[0].style.width = `${widthPercentage}%`;\n    return this;\n  },\n\n  /**\n   * Update the wizard component with new settings.\n   * @param {object} [settings] incoming settings\n   * @returns {this} component instance\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    this\n      .buildTicks()\n      .updateRange();\n\n    return this;\n  },\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  teardown() {\n    this.ticks.off('click.wizard');\n    this.element.off('updated.wizard');\n\n    this.ticks.remove();\n    return this;\n  },\n\n  /**\n   * Activates one of the Wizard's ticks.\n   * This method is slated to be removed in a future v4.10.0 or v5.0.0.\n   * @deprecated as of v4.4.0.  Please use `activate()` instead.\n   * @param {jQuery.Event} e the activate event object\n   * @param {jQuery[]|HTMLElement} tick the target tick to be activated\n   * @returns {this} component instance\n   */\n  select(e, tick) {\n    return deprecateMethod(this.activate, this.select).apply(this, [e, tick]);\n  },\n\n  /**\n   * Activates one of the Wizard's ticks.\n   * Tick can either be a number (representing the tick's index) or a jQuery\n   * element reference to a tick.\n   * @param {jQuery.Event} e the activate event object\n   * @param {jQuery[]|HTMLElement} tick the target tick to be activated\n   * @returns {this} component instance\n   */\n  activate(e, tick) {\n    if (e === undefined && !tick) {\n      return this;\n    }\n\n    const self = this;\n\n    function getTick() {\n      let target;\n\n      // Use the first variable as the tick definition or index if \"e\" is null,\n      // undefined, or not an event object. This is for backwards compatibility with\n      // this control's old select() method, which took an index as an argument.\n      if (e !== undefined && (e === undefined || e === null || !e.type || !e.target) && !tick) {\n        tick = e;\n      }\n\n      if (tick === undefined) {\n        target = $(e.target);\n        return target.is('.label') ? target.parent() : target;\n      }\n\n      if (typeof tick === 'number') {\n        return self.ticks.eq(tick);\n      }\n\n      return tick;\n    }\n\n    tick = getTick();\n\n    if (e && (tick.is('[disabled], .is-disabled') || !tick.is('a'))) {\n      e.preventDefault();\n      e.stopPropagation();\n      return this;\n    }\n\n    /**\n     * Fires before a step is activated/pressed. You can cancel selection by returning a 'beforeactivate'\n     * handler as 'false'\n     * @event beforeactivate\n     * @memberof Wizard\n     * @property {object} event - The jquery event object\n     * @property {HTMLElement} tick - The tick (link) that was activated.\n     */\n    const canNav = this.element.triggerHandler('beforeactivate', [tick]);\n    if (canNav === false) {\n      return this;\n    }\n\n    const trueIndex = this.ticks.index(tick);\n    this.ticks.removeClass('complete current')\n      .eq(trueIndex).addClass('current')\n      .prevAll('.tick')\n      .addClass('complete');\n\n    this.updateRange();\n\n    /**\n     * Fires while a step is activated/pressed.\n     * handler as 'false'\n     * @event activated\n     * @memberof Wizard\n     * @property {object} event - The jquery event object\n     * @property {HTMLElement} tick - The tick (link) that was activated.\n     */\n    this.element.trigger('activated', [tick]);\n\n    /**\n     * Fires after a step is activated/pressed. And the new Dom is loaded.\n     * handler as 'false'\n     * @event afteractivated\n     * @memberof Wizard\n     * @property {object} event - The jquery event object\n     * @property {HTMLElement} tick - The tick (link) that was activated.\n     */\n    setTimeout(() => {\n      self.element.trigger('afteractivated', [tick]);\n    }, 300);\n\n    return this;\n  },\n\n  /**\n   * Destroy and remove added markup and events\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n\n  /**\n   * This component listens to the following events:\n   * @private\n   * @listens updated custom updated event\n   * @listens click jQuery click event\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element.on('updated', () => {\n      self.updated();\n    });\n\n    this.ticks.on('click.wizard', function (e) {\n      self.activate(e, $(this));\n    });\n\n    return this;\n  }\n};\n\nexport { Wizard, COMPONENT_NAME };\n","import { Wizard, COMPONENT_NAME } from './wizard';\n\n/**\n * jQuery Component Wrapper for Wizard\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.wizard = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Wizard(this, settings));\n    }\n  });\n};\n","import { Locale } from '../locale/locale';\nimport { Tmpl } from '../tmpl/tmpl';\nimport { xssUtils } from '../../utils/xss';\n\n/**\n* A object containing all the supported UI formatters.\n* @private\n*/\nconst formatters = {\n  Text(row, cell, value) {\n    const str = ((value === null || value === undefined || value === '') ? '' : value.toString());\n    return str;\n  },\n\n  Input(row, cell, value, col) {\n    if (col.inlineEditor) {\n      const html = `<label for=\"datagrid-inline-input-${row}-${cell}\" class=\"audible\">${col.name}</label><input id=\"datagrid-inline-input-${row}-${cell}\" class=\"${(col.align === 'right' ? 'is-number-mask' : '')}\" value=\"${value}\">`;\n\n      return html;\n    }\n\n    const str = ((value === null || value === undefined || value === '') ? '' : value.toString());\n    return str;\n  },\n\n  Placeholder(row, cell, value, col, item) {\n    if (col.placeholder && value === '') {\n      let placeholder = col.placeholder;\n      const getType = {};\n      if (getType.toString.call(placeholder) === '[object Function]') {\n        placeholder = placeholder(row, cell, value, col, item);\n      } else if (item && placeholder in item) {\n        placeholder = item[placeholder];\n      }\n      const html = `<span class=\"is-placeholder\">${placeholder}</span>`;\n\n      return html;\n    }\n\n    const str = ((value === null || value === undefined || value === '') ? '' : value.toString());\n    return str;\n  },\n\n  Ellipsis(row, cell, value, col) {\n    const str = ((value === null || value === undefined || value === '') ? '' : value.toString());\n    col.textOverflow = 'ellipsis';\n    return str;\n  },\n\n  Password(row, cell, value) {\n    const str = ((value === null || value === undefined || value === '') ? '' : value.toString());\n    return str.replace(/./g, '*');\n  },\n\n  Readonly(row, cell, value) {\n    return `<span class=\"is-readonly\">${((value === null || value === undefined) ? '' : value)}</span>`;\n  },\n\n  Date(row, cell, value, col, isReturnValue) {\n    let formatted = ((value === null || value === undefined) ? '' : value);\n    let value2;\n\n    if (typeof value === 'string' && value) {\n      if (col.sourceFormat) {\n        value2 = Locale.parseDate(value, (typeof col.sourceFormat === 'string' ? { pattern: col.sourceFormat } : col.sourceFormat));\n      } else {\n        value2 = Locale.parseDate(value, (typeof col.dateFormat === 'string' ? { pattern: col.dateFormat } : col.dateFormat));\n      }\n\n      if (value2) {\n        formatted = Locale.formatDate(value2, (typeof col.dateFormat === 'string' ? { pattern: col.dateFormat } : col.dateFormat));\n      } else {\n        formatted = Locale.formatDate(value, (typeof col.dateFormat === 'string' ? { pattern: col.dateFormat } : col.dateFormat));\n\n        if ((formatted === 'NaN/NaN/NaN' || !formatted) && formatted !== '') { // show invalid dates not NaN/NaN/NaN\n          formatted = value;\n        }\n      }\n    } else if (value) {\n      formatted = Locale.formatDate(value, (typeof col.dateFormat === 'string' ? { pattern: col.dateFormat } : col.dateFormat));\n    }\n\n    if (!col.editor || isReturnValue === true) {\n      return formatted;\n    }\n    return `<span class=\"trigger\">${formatted}</span>${$.createIcon({ icon: 'calendar', classes: ['icon-calendar'] })}`;\n  },\n\n  Time(row, cell, value, col) {\n    let formatted = ((value === null || value === undefined) ? '' : value);\n    const localeDateFormat = ((typeof Locale === 'object' && Locale.calendar().dateFormat) ? Locale.calendar().dateFormat.short : null);\n    const localeTimeFormat = ((typeof Locale === 'object' && Locale.calendar().timeFormat) ? Locale.calendar().timeFormat : null);\n    let value2;\n\n    const parseTime = function (timeString) {\n      if (timeString === '') {\n        return null;\n      }\n      const time = timeString.match(/(\\d+)(?::(\\d\\d))(?::(\\d\\d))?\\s*([pP]?)/i);\n      if (time === null) {\n        return null;\n      }\n      const d = new Date();\n      d.setHours(parseInt(time[1], 10) + (time[4] ? 12 : 0));\n      d.setMinutes(parseInt(time[2], 10) || 0);\n      d.setSeconds(parseInt(time[3], 10) || 0);\n      return d;\n    };\n\n    if (typeof value === 'string' && value) {\n      value2 = Locale.formatDate(parseTime(value), { pattern: (`${localeDateFormat} ${(col.sourceFormat || col.timeFormat || localeTimeFormat)}`) });\n\n      if (value2) {\n        formatted = value2.slice(value2.indexOf(' '));\n      }\n    } else if (value) {\n      value2 = Locale.formatDate(value, { pattern: (`${localeDateFormat} ${(col.sourceFormat || col.timeFormat || localeTimeFormat)}`) });\n      if (value2) {\n        formatted = value2.slice(value2.indexOf(' '));\n      }\n    }\n\n    // Remove extra space in begining\n    formatted = formatted.replace(/^\\s/, '');\n\n    if (!col.editor) {\n      return formatted;\n    }\n    return `<span class=\"trigger\">${formatted}</span>${$.createIcon({ icon: 'clock', classes: ['icon-clock'] })}`;\n  },\n\n  Autocomplete(row, cell, value) {\n    const formatted = ((value === null || value === undefined) ? '' : value);\n    return formatted;\n  },\n\n  Lookup(row, cell, value, col, item) {\n    let formatted = ((value === null || value === undefined) ? '' : value);\n    if (!col.editor) {\n      return formatted;\n    }\n\n    if (col.editorOptions && typeof col.editorOptions.field === 'function') {\n      formatted = col.editorOptions.field(item, null, null);\n    }\n\n    if (formatted === null || formatted === undefined || formatted === '') {\n      formatted = '';\n    }\n    return `<span class=\"trigger ${col.align === 'right' ? 'align-text-right' : ''}\">${formatted}</span>${$.createIcon({ icon: 'search-list', classes: ['icon-search-list'] })}`;\n  },\n\n  Decimal(row, cell, value, col) {\n    let formatted = value;\n    if (typeof Locale !== 'undefined' &&\n        formatted !== null && formatted !== undefined && formatted !== '') {\n      formatted = Locale.formatNumber(value, col.numberFormat);\n    }\n    return ((formatted === null || formatted === undefined || formatted === 'NaN') ? '' : formatted);\n  },\n\n  Integer(row, cell, value, col) {\n    let formatted = value;\n    if (typeof Locale !== 'undefined' &&\n        formatted !== null && formatted !== undefined && formatted !== '') {\n      formatted = Locale.formatNumber(value, col.numberFormat || { style: 'integer' });\n    }\n    return (formatted === null || formatted === undefined || formatted === 'NaN') ? '' : formatted;\n  },\n\n  Hyperlink(row, cell, value, col, item, api) {\n    let colHref = col.href || '#';\n\n    // Support for dynamic links based on content\n    if (col.href && typeof col.href === 'function') {\n      colHref = col.href(row, cell, item, col);\n      // Passing a null href will produce \"just text\" with no link\n      if (colHref == null) {\n        return col.text || value;\n      }\n    } else {\n      colHref = colHref.replace('{{value}}', value);\n    }\n\n    const textValue = col.text || value;\n    if (!textValue && !col.icon) {\n      return '';\n    }\n\n    return col.icon ?\n      (`<a href=\"${colHref}\" class=\"btn-icon row-btn ${(col.cssClass || '')}\" ${(!api.settings.rowNavigation ? '' : 'tabindex=\"-1\"')}${(col.hyperlinkTooltip ? ` title=\"${col.hyperlinkTooltip}\"` : '')}>\n          ${$.createIcon({ icon: col.icon, file: col.iconFile })}\n          <span class=\"audible\">${textValue}</span>\n        </a>`) :\n      (`<a href=\"${colHref}\" ${(!api.settings.rowNavigation ? '' : 'tabindex=\"-1\"')} role=\"presentation\" class=\"hyperlink ${(col.cssClass || '')}\"${(col.target ? ` target=\"${col.target}\"` : '')}${(col.hyperlinkTooltip ? ` title=\"${col.hyperlinkTooltip}\"` : '')}>${textValue}</a>`);\n  },\n\n  Template(row, cell, value, col, item) {\n    const tmpl = col.template;\n    let renderedTmpl = '';\n\n    if (Tmpl && item && tmpl) {\n      renderedTmpl = Tmpl.compile(`{{#dataset}}${tmpl}{{/dataset}}`, { dataset: item });\n    }\n\n    return renderedTmpl;\n  },\n\n  Drilldown() {\n    let text = Locale.translate('Drilldown');\n\n    if (text === undefined) {\n      text = '';\n    }\n\n    return (\n      `<button type=\"button\" tabindex=\"-1\" class=\"btn-icon small datagrid-drilldown\">\n         ${$.createIcon({ icon: 'drilldown' })}\n        <span>${text}</span>\n      </button>`\n    );\n  },\n\n  RowReorder() {\n    let text = Locale.translate('ReorderRows');\n\n    if (text === undefined) {\n      text = 'Reorder Rows';\n    }\n\n    return (\n      `<div class=\"datagrid-reorder-icon\">\n         ${$.createIcon({ icon: 'drag' })}\n        <span class=\"audible\">${text}</span>\n      </div>`\n    );\n  },\n\n  Checkbox(row, cell, value, col, item, api) {\n    let isChecked;\n\n    // Use isChecked function if exists\n    if (col.isChecked) {\n      isChecked = col.isChecked(value);\n    } else {\n      // treat 1, true or '1' as checked\n      isChecked = (value === undefined ? false : (value === true || parseInt(value, 10) === 1));\n    }\n\n    // We add hidden Yes/No text so that the exported excel spreadsheet shows\n    // this text in checkbox columns\n    const hiddenText = `<span class=\"hidden\" aria-hidden=\"true\" role=\"presentation\"> ${Locale.translate(isChecked ? 'Yes' : 'No')}</span>`;\n\n    const animate = api.wasJustUpdated;\n    api.wasJustUpdated = false;\n    return `<div class=\"datagrid-checkbox-wrapper\"><span role=\"checkbox\" aria-label=\"${col.name}\" class=\"datagrid-checkbox\n     ${(isChecked ? `is-checked ${(!animate ? ' no-animation' : ' ')}` : '')}\" aria-checked=\"${isChecked}\"></span>${hiddenText}</div>`;\n  },\n\n  SelectionCheckbox(row, cell, value, col, item, api) {\n    let isChecked = (value === undefined ? false : value === true);\n    if (!value) {\n      isChecked = api.isRowSelected(item);\n    }\n    return `<div class=\"datagrid-checkbox-wrapper\"><span role=\"checkbox\" aria-label=\"${(col.name ? col.name : Locale.translate('Select'))}\" class=\"datagrid-checkbox datagrid-selection-checkbox${(isChecked ? ' is-checked no-animate' : '')}\" aria-checked=\"${isChecked}\"></span></div>`;\n  },\n\n  Actions(row, cell, value, col) {\n    // Render an Action Formatter\n    return (\n      `<button type=\"button\" class=\"btn-actions\" aria-haspopup=\"true\" aria-expanded=\"false\" aria-owns=\"${col.menuId} +'\">\n        <span class=\"audible\">${col.title}</span>\n        ${$.createIcon({ icon: 'more' })}\n      </button>`\n    );\n  },\n\n  // Multi Line TextArea\n  Textarea(row, cell, value) {\n    const formatted = ((value === null || value === undefined) ? '' : value);\n    return `<span class=\"datagrid-multiline-text\">${formatted}</span>`;\n  },\n\n  // Rich Text Editor\n  Editor(row, cell, value, col) {\n    const formatted = ((value === null || value === undefined) ? '' : value);\n    let classes = 'is-editor';\n    classes += col.singleline ? ' is-singleline' : ' datagrid-multiline-text';\n    classes += col.contentTooltip ? ' content-tooltip' : '';\n    return `<div class=\"${classes}\">${xssUtils.unescapeHTML(formatted)}</div>`;\n  },\n\n  // Expand / Collapse Button\n  Expander(row, cell, value) {\n    const button = `<button type=\"button\" aria-label=\"${Locale.translate('ExpandCollapse')}\" class=\"btn-icon datagrid-expand-btn\" tabindex=\"-1\">\n      <span class=\"icon plus-minus\"></span>\n      </button>${(value ? `<span> ${value}</span>` : '')}`;\n\n    return button;\n  },\n\n  // Datagrid Group Row\n  GroupRow(row, cell, value, col, item, api) {\n    const groupSettings = api.settings.groupable;\n    const rowHtml = { left: '', center: '', right: '' };\n    let groups = '';\n    let isOpen = groupSettings.expanded === undefined ? true : groupSettings.expanded;\n\n    if (groupSettings.expanded && typeof groupSettings.expanded === 'function') {\n      isOpen = groupSettings.expanded(row, cell, value, col, item, api);\n    }\n\n    for (let i = 0; i < groupSettings.fields.length; i++) {\n      groups += item[groupSettings.fields[i]] + (i === 0 ? '' : ',');\n    }\n\n    if (groupSettings.groupRowFormatter) {\n      groups = groupSettings.groupRowFormatter(row, cell, value, col, item, api);\n    }\n\n    const button = `<button type=\"button\" class=\"btn-icon datagrid-expand-btn${(isOpen ? ' is-expanded' : '')}\" tabindex=\"-1\">\n    <span class=\"icon plus-minus${(isOpen ? ' active' : '')}\"></span>\n    <span class=\"audible\">${Locale.translate('ExpandCollapse')}</span>\n    </button><span> ${groups}</span>`;\n\n    // Take the first\n    const container = api.getContainer(groupSettings.fields ? groupSettings.fields[0] : '');\n    rowHtml[container] = button;\n    return rowHtml;\n  },\n\n  GroupFooterRow(row, cell, value, col, item, api) {\n    const groupSettings = api.settings.groupable;\n    const rowHtml = { left: '', center: '', right: '' };\n    const visibleColumnsLeft = api.settings.frozenColumns.left.length;\n    const visibleColumnsRight = api.settings.frozenColumns.right.length;\n    const idx = api.columnIdxById(groupSettings.aggregate);\n    const container = api.getContainer(groupSettings.aggregate);\n    rowHtml.left = `<td role=\"gridcell\" colspan=\"${visibleColumnsLeft}\"><div class=\"datagrid-cell-wrapper\"></div></td><td role=\"gridcell\"><div class=\"datagrid-cell-wrapper\">${container === 'left' ? item.sum : '<span>&nbsp;</span>'}</div></td>`;\n    rowHtml.center = `<td role=\"gridcell\" colspan=\"${idx - visibleColumnsLeft - visibleColumnsRight}\"><div class=\"datagrid-cell-wrapper\"></div></td><td role=\"gridcell\"><div class=\"datagrid-cell-wrapper\">${container === 'center' ? item.sum : '<span>&nbsp;</span>'}</div></td>`;\n    rowHtml.right = `<td role=\"gridcell\" colspan=\"${visibleColumnsRight}\"><div class=\"datagrid-cell-wrapper\"></div></td><td role=\"gridcell\"><div class=\"datagrid-cell-wrapper\">${container === 'right' ? item.sum : '<span>&nbsp;</span>'}</div></td>`;\n\n    if (groupSettings.groupFooterRowFormatter) {\n      rowHtml[container] = groupSettings.groupFooterRowFormatter(\n        idx,\n        row,\n        cell,\n        value,\n        col,\n        item,\n        api\n      );\n    }\n\n    return rowHtml;\n  },\n\n  SummaryRow(row, cell, value, col) {\n    let afterText = '';\n    let beforeText = col.summaryText || '';\n\n    if (col.summaryTextPlacement === 'after') {\n      afterText = beforeText;\n      beforeText = '';\n    }\n\n    if (typeof Locale !== 'undefined' && col.numberFormat &&\n      value !== null && value !== undefined && value !== '') {\n      value = Locale.formatNumber(+value, col.numberFormat);\n    }\n\n    return (beforeText + ((value === null || value === undefined || value === '') ? '' : value.toString()) + afterText);\n  },\n\n  // Tree Expand / Collapse Button and Paddings\n  Tree(row, cell, value, col, item, api) {\n    let isOpen = item ? item.expanded : true;\n    const depth = api && api.settings.treeDepth && api.settings.treeDepth[row] ?\n      api.settings.treeDepth[row].depth : 0;\n\n    // When use filter then\n    // If (settings.allowChildExpandOnMatch === false) and only parent node got match\n    // then make expand/collapse button to be collapsed and disabled\n    const isExpandedBtnDisabled = item && item.isAllChildrenFiltered;\n    const expandedBtnDisabledHtml = isExpandedBtnDisabled ? ' disabled' : '';\n    if (isOpen && isExpandedBtnDisabled) {\n      isOpen = false;\n    }\n    if (item && typeof item.isAllChildrenFiltered !== 'undefined') {\n      // Remove key after use to reset\n      delete item.isAllChildrenFiltered;\n    }\n\n    const button = `<button type=\"button\" class=\"btn-icon datagrid-expand-btn${(isOpen ? ' is-expanded' : '')}\" tabindex=\"-1\"${(depth ? ` style=\"margin-left: ${(depth ? `${(30 * (depth - 1))}px` : '')}\"` : '')}${expandedBtnDisabledHtml}>\n      <span class=\"icon plus-minus ${(isOpen ? ' active' : '')}\"></span>\n      <span class=\"audible\">${Locale.translate('ExpandCollapse')}</span>\n      </button>${(value ? ` <span>${value}</span>` : '')}`;\n    const node = ` <span class=\"datagrid-tree-node\"${(depth ? ` style=\"margin-left: ${(depth ? `${(30 * (depth))}px` : '')}\"` : '')}>${value}</span>`;\n\n    return (item && item[col.children ? col.children : 'children'] ? button : node);\n  },\n\n  // Badge / Tags and Visual Indictors\n  ClassRange(row, cell, value, col) {\n    const ranges = col.ranges;\n    let classes = '';\n    let text = '';\n\n    if (!ranges) {\n      return {};\n    }\n\n    for (let i = 0; i < ranges.length; i++) {\n      if (value >= ranges[i].min && value <= ranges[i].max) {\n        classes = ranges[i].classes;\n        text = (ranges[i].text ? ranges[i].text : classes.split(' ')[0]);\n      }\n\n      if (value === ranges[i].value) {\n        classes = ranges[i].classes;\n        text = (ranges[i].text ? ranges[i].text : value);\n      }\n    }\n\n    return { classes, text };\n  },\n\n  // Badge (Visual Indictors)\n  Badge(row, cell, value, col) {\n    let colorClasses = col.color;\n    let text = col.name;\n\n    if (col.ranges) {\n      const ranges = formatters.ClassRange(row, cell, value, col);\n      colorClasses = ranges.classes;\n      text = ranges.text;\n    }\n    return `<span class=\"badge ${colorClasses}\">${value} <span class=\"audible\">${text}</span></span>`;\n  },\n\n  Tag(row, cell, value, col) {\n    const ranges = formatters.ClassRange(row, cell, value, col);\n    return `<span class=\"tag ${ranges.classes}\">${value}</span>`;\n  },\n\n  Alert(row, cell, value, col) {\n    const ranges = formatters.ClassRange(row, cell, value, col);\n    const icon = $.createIcon({\n      icon: ranges.classes,\n      classes: [\n        'icon',\n        'datagrid-alert-icon',\n        `icon-${ranges.classes}`\n      ]\n    });\n    return `${icon}<span class=\"datagrid-alert-text\">${(ranges.text === 'value' ? value : ranges.text)}</span>`;\n  },\n\n  Image(row, cell, value, col) {\n    return `<img class=\"datagrid-img\" src=\"${value}\" alt=\"${(col.alt ? col.alt : Locale.translate('Image'))}\"${(col.dimensions ? ` style=\"height:${col.dimensions.height};width:${col.dimensions.height}\"` : '')}/>`;\n  },\n\n  Color(row, cell, value, col) {\n    const ranges = formatters.ClassRange(row, cell, value, col);\n    const text = ((value === null || value === undefined || value === '') ? '' : value.toString());\n\n    return `<span class=\"${ranges.classes}\">${text}</span>`;\n  },\n\n  Colorpicker(row, cell, value, col) {\n    let html = ((value === null || value === undefined || value === '') ? '' : value.toString());\n    if (col.inlineEditor) {\n      return html;\n    }\n    const classList = `swatch${value === '' ? ' is-empty' : ''}`;\n    html = `<span class=\"colorpicker-container trigger dropdown-trigger\"><span class=\"${classList}\" style=\"background-color: ${value}\"></span><input class=\"colorpicker\" id=\"colorpicker-${cell}\" name=\"colorpicker-${cell}\" type=\"text\" role=\"combobox\" aria-autocomplete=\"list\" value=\"${value}\" aria-describedby=\"\">`;\n    html += `<span class=\"trigger\">${$.createIcon({ icon: 'dropdown' })}</span></span>`;\n\n    return html;\n  },\n\n  Button(row, cell, value, col, item, api) {\n    let text;\n    if (col.text) {\n      text = col.text;\n    } else {\n      text = (value === null || value === undefined || value === '') ? '' : value.toString();\n    }\n    let markup = `<button type=\"button\" class=\"${(col.icon ? 'btn-icon' : 'btn-secondary')} row-btn ${(col.cssClass ? col.cssClass : '')}\"${(!api.settings.rowNavigation ? '' : ' tabindex=\"-1\"')} >`;\n\n    if (col.icon) {\n      markup += $.createIcon({ icon: col.icon, file: col.iconFile });\n    }\n    markup += `<span>${text}</span></button>`;\n\n    return markup;\n  },\n\n  Dropdown(row, cell, value, col) {\n    let formattedValue = value;\n    let compareValue;\n    let option;\n    let optionValue;\n\n    if (col.options && value !== undefined) {\n      compareValue = col.caseInsensitive && typeof value === 'string' ? value.toLowerCase() : value;\n\n      for (let i = 0, l = col.options.length; i < l; i++) {\n        option = col.options[i];\n        optionValue = col.caseInsensitive && typeof option.value === 'string' ? option.value.toLowerCase() : option.value;\n\n        if (optionValue === compareValue) {\n          formattedValue = option.label;\n          break;\n        }\n      }\n    }\n\n    let html = `<span class=\"trigger dropdown-trigger\">${formattedValue}</span>${$.createIcon({ icon: 'dropdown' })}`;\n\n    if (col.inlineEditor) {\n      html = `<label for=\"full-dropdown\" class=\"audible\">${col.name}</label><select id=\"datagrid-dropdown${row}\" class=\"dropdown\">`;\n\n      for (let i = 0, l = col.options.length; i < l; i++) {\n        const opt = col.options[i];\n        let labelOrValue;\n        if (opt.label !== undefined) {\n          labelOrValue = opt.label;\n        } else {\n          labelOrValue = opt.value !== undefined ? opt.value : '';\n        }\n        html += `<option${(opt.id === undefined ? '' : ` id=\"${opt.id}\"`)}  value=\"${opt.value}\"${(opt.selected || opt.value === compareValue ? ' selected ' : '')}>${labelOrValue}</option>`;\n      }\n\n      html += `</select>\n      <div class=\"dropdown-wrapper is-inline\">\n        <div class=\"dropdown\"><span>${formattedValue}</span></div>\n        <svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\">\n          <use xlink:href=\"#icon-dropdown\"></use>\n        </svg>\n      </div>`;\n    }\n\n    return html;\n  },\n\n  Fileupload(row, cell, value, col) {\n    let html = ((value === null || value === undefined || value === '') ? '' : value.toString());\n\n    if (!col.inlineEditor) {\n      if ($.trim(html) === '') {\n        html = `<span class=\"trigger\">${html}</span>${$.createIcon({ icon: 'folder', classes: ['icon-fileupload'] })}`;\n      } else {\n        html = `<span class=\"trigger is-clearable\">${html}</span>${$.createIcon({ icon: 'close', classes: ['icon-close'] })}${$.createIcon({ icon: 'folder', classes: ['icon-fileupload'] })}`;\n      }\n    }\n\n    return html;\n  },\n\n  Spinbox(row, cell, value, col) {\n    let html = ((value === null || value === undefined || value === '') ? '' : value.toString());\n\n    if (col.inlineEditor) {\n      html = `<label for=\"spinbox-${cell}\" class=\"audible\">Quantity</label>\n        <span class=\"spinbox-wrapper\"><span class=\"spinbox-control down\">-</span>\n        <input id=\"spinbox-${cell}\" name=\"spinbox-${cell}\" type=\"text\" class=\"spinbox\" value=\"${value}\">\n        <span class=\"spinbox-control up\">+</span></span>`;\n    }\n\n    return html;\n  },\n\n  Favorite(row, cell, value, col, item, api) {\n    let isChecked;\n\n    // Use isChecked function if exists\n    if (col.isChecked) {\n      isChecked = col.isChecked(value);\n    } else {\n      isChecked = (value === undefined ? false : value === true);\n    }\n\n    const isEditable = col.editor && api.settings.editable;\n\n    if (isChecked) {\n      return `<span aria-label=\"${Locale.translate('Favorite')}\" class=\"icon-favorite${(isEditable ? ' is-editable' : '')}\">${$.createIcon({ icon: 'star-filled' })}</span>`;\n    }\n    return col.showEmpty ? `<span aria-label=\"${Locale.translate('Favorite')}\" class=\"icon-favorite${(isEditable ? ' is-editable' : '')}\">${$.createIcon({ icon: 'star-outlined' })}</span>` : '';\n  },\n\n  Status(row, cell, value, col, item) {\n    if (!item || !item.rowStatus) {\n      return '<span></span>';\n    }\n\n    return `${$.createIcon({ icon: item.rowStatus.icon, classes: ['icon', `icon-${item.rowStatus.icon}`] })}<span class=\"audible\">${item.rowStatus.text}</span>`;\n  },\n\n  TargetedAchievement(row, cell, value, col) {\n    const perc = (100 * value);\n    let text = `${perc}%`;\n    const ranges = formatters.ClassRange(row, cell, perc, col);\n    const target = col.target;\n    let isWhite = perc > 60;\n\n    if (col.text) {\n      text = col.text;\n      text = text.replace('{{value}}', value);\n      text = text.replace('<% value %>', value);\n      text = text.replace('<%value%>', value);\n\n      text = text.replace('{{percent}}', perc);\n      text = text.replace('<% percent %>', perc);\n      text = text.replace('<%percent%>', perc);\n\n      col.showPercentText = true;\n      isWhite = perc > 75;\n    }\n\n    const barClass = (col.ranges && ranges.classes ? ranges.classes : 'primary');\n    return `<div class=\"total bar chart-completion-target chart-targeted-achievement\">\n              <div class=\"target remaining bar\" style=\"width: ${(target || 0)}%;\"></div>\n              <div class=\"completed bar ${barClass}\" style=\"width: ${perc}%;\"></div>\n              ${(col.showPercentText ? `<div class=\"chart-targeted-text l-center\" ${(isWhite ? 'style=\"color: white\"' : '')}>${text}</div>\n            </div>` : '')}`;\n  }\n\n  // TODO Possible future Formatters\n  // Multi Select\n  // Sparkline\n  // Progress Indicator (n of 100%)\n  // Process Indicator\n  // File Upload (Simple)\n  // Menu Button\n  // Color Picker (Low)\n  // Radio\n};\n\nexport { formatters as Formatters };\n","import { DOM } from '../../utils/dom';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\nimport { Formatters } from './datagrid.formatters';\nimport { xssUtils } from '../../utils/xss';\n\n// Adds all the basic input features to any Datagrid Editor.\nfunction addStandardInputFeatures(input, row, cell, value, container, column, e, api, item) {\n  if (column.align) {\n    input.addClass(`l-${column.align}-text`);\n  }\n\n  if (column.maxLength) {\n    input.attr('maxlength', column.maxLength);\n  }\n\n  if (column.uppercase) {\n    input.addClass('uppercase-text');\n  }\n\n  if (column.mask && typeof column.mask === 'function') {\n    const mask = column.mask(row, cell, value, column, item);\n    input.mask({ pattern: mask, mode: column.maskMode });\n  } else if (column.maskOptions && typeof column.maskOptions === 'function') {\n    const maskOptions = column.maskOptions(row, cell, value, column, item);\n    input.mask(maskOptions);\n  } else if (column.mask) {\n    input.mask({ pattern: column.mask, mode: column.maskMode });\n  }\n\n  let defaults = {\n    patternOptions: {\n      allowNegative: true,\n      allowDecimal: true,\n      integerLimit: 4,\n      decimalLimit: 2,\n      symbols: {\n        thousands: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.group : ',',\n        decimal: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.decimal : '.',\n        negative: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.minusSign : '-'\n      }\n    },\n    process: 'number'\n  };\n\n  let useMask = false;\n\n  if (column.maskOptions) {\n    useMask = true;\n  }\n\n  if (column.numberFormat) {\n    useMask = true;\n    defaults = { patternOptions: { decimalLimit: column.numberFormat.maximumFractionDigits } };\n  }\n\n  if (column.maskOptions && typeof column.maskOptions === 'function') {\n    useMask = false;\n  }\n\n  if (useMask) {\n    column.maskOptions = utils.extend(true, {}, defaults, column.maskOptions);\n    input.mask(column.maskOptions);\n  }\n\n  if (!column.align || column.align !== 'right') {\n    input.removeClass('is-number-mask');\n  }\n}\n\n/**\n*  A object containing all the supported Editors\n* @private\n*/\nconst editors = {\n\n  // Supports, Text, Numeric, Integer via mask\n  Input(row, cell, value, container, column, e, api, item) {\n    this.name = 'input';\n    this.originalValue = value;\n    this.useValue = !!column.inlineEditor;\n\n    this.init = function () {\n      if (column.inlineEditor) {\n        this.input = container.find('input');\n      } else {\n        this.input = $(`<input type=\"${(column.inputType || 'text')}\"/>`)\n          .appendTo(container);\n      }\n\n      addStandardInputFeatures(this.input, row, cell, value, container, column, e, api, item);\n    };\n\n    this.val = function (v) {\n      let thisValue;\n      if (v) {\n        this.input.val(v);\n      }\n      if (column && column.numberFormat && column.numberFormat.style === 'percent') {\n        thisValue = this.input.val().trim().replace(/(\\s%?|%)$/g, '');\n        return Locale.parseNumber(thisValue) / 100;\n      }\n      return this.input.val();\n    };\n\n    this.focus = function () {\n      this.input.focus().select();\n    };\n\n    this.destroy = function () {\n      if (column.inlineEditor) {\n        return;\n      }\n\n      setTimeout(() => {\n        this.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Textarea(row, cell, value, container, column) {\n    this.name = 'textarea';\n    this.originalValue = value;\n\n    this.init = function () {\n      this.input = $('<textarea class=\"textarea\"></textarea>').appendTo(container);\n\n      if (column.maxLength) {\n        this.input.attr('maxlength', column.maxLength);\n      }\n\n      if (column.uppercase) {\n        this.input.addClass('uppercase-text');\n      }\n    };\n\n    this.val = function (v) {\n      if (v) {\n        // note that focus will help move text to end of input.\n        this.input.focus().val(v);\n      }\n      return this.input.val();\n    };\n\n    this.focus = function () {\n      this.input.focus();\n    };\n\n    this.destroy = function () {\n      setTimeout(() => {\n        this.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  // Rich Text Editor\n  Editor(row, cell, value, container, column, e, api) {\n    this.name = 'editor';\n    this.originalValue = value;\n\n    this.init = function () {\n      const self = this;\n      // Editor options\n      const editorOptions = $.extend({}, {\n        buttons: { editor: ['bold', 'italic', 'underline', 'strikethrough', 'separator', 'foreColor'], source: [] },\n        excludeButtons: { editor: [] }\n      }, column.editorOptions);\n\n      // Editor width\n      this.editorWidth = api.setUnit(editorOptions.width || container.outerWidth());\n      delete editorOptions.width;\n\n      container[0].innerHTML =\n        `<div class=\"editor-wrapper\" style=\"width: ${this.editorWidth};\">\n          <div class=\"editor\" data-init=\"false\">${xssUtils.unescapeHTML(value)}</div>\n        </div>`;\n      this.td = container.closest('td');\n      this.input = $('.editor', container);\n\n      this.input\n        .popover({\n          content: $('.editor-wrapper', container),\n          placementOpts: {\n            x: 0,\n            y: `-${(parseInt(container[0].style.height, 10) + 35)}`,\n            parent: this.td,\n            parentXAlignment: Locale.isRTL() ? 'right' : 'left',\n            strategies: ['flip', 'nudge', 'shrink'],\n          },\n          placement: 'bottom',\n          popover: true,\n          trigger: 'immediate',\n          tooltipElement: '#editor-popup',\n          extraClass: 'editor-popup'\n        })\n        .editor(editorOptions)\n        .on('hide.editor', () => {\n          api.commitCellEdit(self.input);\n        })\n        .on('keydown.editor', (event) => {\n          const key = event.which || event.keyCode || event.charCode || 0;\n          // Ctrl + Enter (Some browser return keyCode: 10, not 13)\n          if ((event.ctrlKey || event.metaKey) && (key === 13 || key === 10)) {\n            const apiPopover = self.input.data('tooltip');\n            if (apiPopover) {\n              apiPopover.hide();\n              api.setNextActiveCell(event);\n            }\n          }\n        });\n      utils.fixSVGIcons($('#editor-popup'));\n    };\n\n    this.val = function () {\n      return this.input.html();\n    };\n\n    this.focus = function () {\n      setTimeout(() => {\n        this.input.focus();\n      }, 0);\n    };\n\n    this.destroy = function () {\n      const self = this;\n      container.removeAttr('style');\n      api.quickEditMode = false;\n      self.input.off('hide.editor keydown.editor');\n      setTimeout(() => {\n        self.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Checkbox(row, cell, value, container, column, event, grid) {\n    this.name = 'checkbox';\n    this.originalValue = value;\n    this.useValue = true; // use the data set value not cell value\n    this.container = container;\n\n    this.init = function () {\n      this.input = $('<input type=\"checkbox\" class=\"checkbox\"/>').appendTo(container);\n      this.input.after('<label class=\"checkbox-label\"></label>');\n\n      if (column.align) {\n        this.input.addClass(`l-${column.align}-text`);\n      }\n    };\n\n    this.val = function (v) {// eslint-disable-line\n      let isChecked;\n\n      if (v === undefined) {\n        return this.input.prop('checked');\n      }\n\n      // Use isChecked function if exists\n      if (column.isChecked) {\n        isChecked = column.isChecked(v);\n      } else {\n        isChecked = v;\n      }\n\n      // just toggle it if we click right on it\n      if ((event.type === 'click' || (event.type === 'keydown' && event.keyCode === 32)) && !$(event.target).is('.datagrid-checkbox-wrapper, .datagrid-cell-wrapper')) {\n        isChecked = !isChecked;\n        grid.setNextActiveCell(event);\n      }\n\n      this.input.prop('checked', isChecked);\n    };\n\n    this.focus = function () {\n      this.input.trigger('focusout');\n      this.container.parent().focus();\n    };\n\n    this.destroy = function () {\n      setTimeout(() => {\n        this.input.next('.checkbox-label').remove();\n        this.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Colorpicker(row, cell, value, container, column, event, grid) {\n    this.name = 'colorpicker';\n    this.originalValue = value;\n    this.useValue = true; // use the data set value not cell value\n    value = xssUtils.stripTags(value);\n\n    this.init = function () {\n      this.input = $(`<input id=\"colorpicker-${cell}\" name=\"colorpicker-${cell}\" class=\"colorpicker\" value=\"${value}\" type=\"text\" />`).appendTo(container);\n      this.input.colorpicker(column.editorOptions);\n    };\n\n    this.val = function (v) {\n      return v ? this.input.val(v) : this.input.val();\n    };\n\n    this.focus = function () {\n      const self = this;\n\n      this.input.trigger('openlist');\n      const rowNodes = grid.rowNodes(row);\n      rowNodes.removeClass('is-hover-row');\n      this.input.focus().select();\n\n      this.input.off('listclosed').on('listclosed', () => {\n        grid.commitCellEdit(self.input);\n\n        container.parent('td').focus();\n        return;// eslint-disable-line\n      });\n    };\n\n    this.destroy = function () {\n      // We dont need to destroy since it will when the list is closed\n    };\n\n    this.init();\n  },\n\n  Dropdown(row, cell, value, container, column, event, grid, rowData) {\n    this.name = 'dropdown';\n    this.originalValue = value;\n    this.useValue = true; // use the data set value not cell value\n    this.cell = grid.activeCell;\n\n    this.init = function () {\n      if (column.inlineEditor) {\n        this.input = container.find('select');\n        return;\n      }\n\n      this.input = $('<select class=\"dropdown\"></select>').appendTo(container);\n\n      if (column.options) {\n        let html;\n        let opt;\n        let optionValue;\n        value = grid.fieldValue(rowData, column.field);\n\n        const compareValue = column.caseInsensitive && typeof value === 'string' ? value.toLowerCase() : value;\n\n        for (let i = 0; i < column.options.length; i++) {\n          html = $('<option></option>');\n          opt = column.options[i];\n          optionValue = column.caseInsensitive && typeof opt.value === 'string' ? opt.value.toLowerCase() : opt.value;\n\n          if (opt.selected || compareValue === optionValue) {\n            html.attr('selected', 'true');\n            this.originalValue = optionValue;\n          }\n\n          html.attr('value', opt.value).attr('id', opt.id).attr('data-type', typeof opt.value);\n          html.text(opt.label);\n          this.input.append(html);\n        }\n      }\n\n      const editorOptions = column.editorOptions || {};\n\n      function hasEditingClass() {\n        return editorOptions.cssClass && /is-editing/g.test(editorOptions.cssClass);\n      }\n      // Add the class to both the options being passed, as well as the column's original options\n      if (!hasEditingClass()) {\n        editorOptions.cssClass = editorOptions.cssClass || '';\n        editorOptions.cssClass += ' is-editing';\n      }\n\n      this.input.dropdown(editorOptions);\n      this.input.on('requestend', () => {\n        this.val(this.datasetValue);\n      });\n\n      // Append the Dropdown's sourceArguments with some row/col meta-data\n      const api = this.input.data('dropdown');\n      api.settings.sourceArguments = {\n        column,\n        container,\n        grid,\n        cell,\n        event,\n        row,\n        rowData,\n        value\n      };\n    };\n\n    this.val = function (v) {\n      this.datasetValue = v;\n\n      if (v !== undefined) {\n        const compareValue = column.caseInsensitive && typeof v === 'string' ? v.toLowerCase() : v;\n        this.input.val(v);\n\n        this.input.find('option').each(function () {\n          const opt = $(this);\n          const valueAttr = opt.attr('value');\n          const type = opt.attr('data-type');\n          let optionValue = valueAttr;\n\n          // Get option value in proper type before checking equality\n          if (type === 'number') {\n            optionValue = parseFloat(valueAttr);\n          } else if (type === 'boolean') {\n            optionValue = valueAttr === 'true';\n          } else if (type === 'string' && column.caseInsensitive) {\n            optionValue = valueAttr.toLowerCase();\n          }\n\n          if (optionValue === compareValue) {\n            opt.attr('selected', 'true');\n          }\n        });\n      }\n\n      const selected = this.input.find(':selected');\n      let val = selected.attr('value');\n      const dataType = selected.attr('data-type');\n\n      // For non-string option values (number, boolean, etc.),\n      // convert string attr value to proper type\n      if (dataType === 'number') {\n        val = parseFloat(val);\n      } else if (dataType === 'boolean') {\n        val = val === 'true';\n      }\n\n      if (val === undefined) {\n        val = selected.text();\n      }\n\n      return val;\n    };\n\n    this.focus = function () {\n      const self = this;\n\n      // Check if isClick or cell touch and just open the list\n      if (event.type === 'click') {\n        this.input.trigger('openlist');\n        const rowNodes = grid.rowNodes(row);\n        rowNodes.removeClass('is-hover-row');\n        $('#dropdown-list input').focus();\n      } else {\n        this.input[0].parentNode.querySelector('div.dropdown').focus();\n      }\n\n      this.input.off('listclosed').on('listclosed', (e, type) => {\n        grid.commitCellEdit(self.input);\n\n        if (type === 'select') {\n          container.parent('td').focus();\n          return;\n        }\n\n        if (type === 'tab') {\n          setTimeout(() => {\n            container.parent('td').focus();\n          }, 100);\n        }\n      });\n    };\n\n    this.destroy = function () {\n      // We dont need to destroy since it will when the list is closed\n    };\n\n    this.init();\n  },\n\n  Date(row, cell, value, container, column, event, grid) {\n    this.name = 'date';\n    this.originalValue = value;\n\n    this.init = function () {\n      this.input = $('<input class=\"datepicker\"/>').appendTo(container);\n      this.input.datepicker(column.editorOptions || { dateFormat: column.dateFormat });\n    };\n\n    this.val = function (v) {\n      if (v === '0000' || v === '000000' || v === '00000000') {\n        // Means no date in some applications\n        v = '';\n      }\n      if (v) {\n        // Note that the value should be formatted from the formatter.\n        this.input.val(v);\n      }\n      return Formatters.Date(row, cell, this.input.val(), column, true);\n    };\n\n    this.focus = function () {\n      const self = this;\n\n      this.input.select().focus();\n\n      // Check if isClick or cell touch and just open the list\n      if (event.type === 'click' && $(event.target).is('.icon')) {\n        this.input.parent().find('.icon').trigger('click');\n        this.input.closest('td').addClass('is-focused');\n      }\n\n      this.input.on('listclosed', () => {\n        self.input.closest('td').removeClass('is-focused');\n\n        setTimeout(() => {\n          self.input.trigger('focusout');\n          container.parent().focus();\n          grid.setNextActiveCell(event);\n        }, 1);\n      });\n    };\n\n    this.destroy = function () {\n      setTimeout(() => {\n        grid.quickEditMode = false;\n        this.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Fileupload(row, cell, value, container, column, event, grid) {\n    const s = utils.mergeSettings(undefined, column.editorOptions, {\n      allowedTypes: '*' // restrict file types(ie. 'jpg|png|gif') ['*' all types]\n    });\n    const fileExtensions = s.allowedTypes.split(/[\\s|]+/g);\n    let id = utils.uniqueId(this, `fileupload-${row}-${cell}-`);\n\n    let multiple = s.useMultiple ? ' multiple' : '';\n    let disabled = s.isDisabled ? ' disabled' : '';\n    let types = '';\n\n    if (fileExtensions.length === 1) {\n      if (fileExtensions[0] !== '*') {\n        types = `.${xssUtils.ensureAlphaNumeric(fileExtensions[0])}`;\n      }\n    } else {\n      for (let i = 0, l = fileExtensions.length; i < l; i++) {\n        types += `.${(xssUtils.ensureAlphaNumeric(fileExtensions[i]) + (i !== (l - 1) ? ',' : ''))}`;\n      }\n    }\n    if (types !== '') {\n      types = ` accept=\"${types}\"`;\n    }\n\n    this.name = 'fileupload';\n    this.originalValue = value;\n    this.status = 'init';\n    this.useValue = true; // use the data set value not cell value\n\n    this.init = function () {\n      id = xssUtils.ensureAlphaNumeric(id);\n      multiple = xssUtils.ensureAlphaNumeric(multiple);\n      disabled = xssUtils.ensureAlphaNumeric(disabled);\n\n      this.input = $(`<input id=\"${id}\" name=\"${id}\" class=\"fileupload\" type=\"file\" ${types}${multiple}${disabled} />`);\n      container.append(`<label>${this.input[0].outerHTML}</label>`);\n      this.api = this.input.fileupload(column.editorOptions).data('fileupload');\n      this.input.closest('td').addClass('is-fileupload').find('label:eq(1)').addClass('audible');\n    };\n\n    this.val = function (v) {\n      if (v) {\n        v = xssUtils.stripTags(v);\n        this.input.attr('value', v);\n        return v;\n      }\n      return this.input.val();\n    };\n\n    this.focus = () => {\n      /**\n       * Handle cancel on file-input\n       * Bind body to listen one time only, right after file chooser window popup open\n       * Listen on body `focusin`(on close popup window),\n       * if no `change` event triggered means it canceled\n       * @private\n       * @returns {void}\n       */\n      const handleCancel = () => {\n        $('body').one('focusin.fileuploadeditor', () => {\n          setTimeout(() => {\n            if (this.status !== 'change') {\n              this.status = 'cancel';\n              grid.commitCellEdit(this.input);\n            }\n          }, 100);\n        });\n      };\n\n      /**\n       * Handle clear the value on file-input\n       * @private\n       * @returns {void}\n       */\n      const handleClear = () => {\n        if (this.originalValue !== '') {\n          this.status = 'clear';\n        }\n        grid.commitCellEdit(this.input);\n      };\n\n      /**\n       * Open file chooser popup window for file-input\n       * @private\n       * @returns {void}\n       */\n      const openFileChooserWindow = () => {\n        if (this.api) {\n          handleCancel();\n          this.api.fileInput.trigger('click');\n        }\n      };\n\n      // Handle change for file-input\n      this.input.on('change.fileuploadeditor', () => {\n        this.status = 'change';\n        grid.commitCellEdit(this.input);\n      });\n\n      // Using keyboard\n      if (event.type === 'keydown') {\n        const key = event.which || event.keyCode || event.charCode || 0;\n\n        if (key === 8 || key === 46) {\n          // Backspace: 8, Delete: 46\n          handleClear();\n        } else if (key === 13 || key === 10) {\n          // Enter (Some browser return keyCode: 10, not 13)\n          openFileChooserWindow();\n        } else {\n          grid.commitCellEdit(this.input);\n        }\n      }\n\n      // Check if isClick or cell touch\n      if (event.type === 'click') {\n        const target = $(event.target);\n        if (target.is('.icon-close')) {\n          handleClear();\n        } else if (target.is('.icon-fileupload')) {\n          openFileChooserWindow();\n        } else {\n          grid.commitCellEdit(this.input);\n        }\n      }\n    };\n\n    this.destroy = () => {\n      this.input.off('change.fileuploadeditor');\n      grid.quickEditMode = false;\n      if (this.api) {\n        this.api.destroy();\n      }\n    };\n\n    this.init();\n  },\n\n  Time(row, cell, value, container, column, event, grid) {\n    this.name = 'time';\n    this.originalValue = value;\n\n    this.init = function () {\n      this.input = $('<input class=\"timepicker\"/>').appendTo(container);\n      this.api = this.input.timepicker(column.editorOptions || '').data('timepicker');\n    };\n\n    this.val = function (v) {\n      if (v) {\n        // Note that the value should be formatted from the formatter.\n        this.input.val(v);\n      }\n\n      return this.input.val();\n    };\n\n    this.focus = function () {\n      const self = this;\n\n      this.input.select().focus();\n\n      // Check if isClick or cell touch and just open the list\n      if (event.type === 'click' && $(event.target).is('.icon')) {\n        this.input.parent().find('.icon').trigger('click');\n        this.input.closest('td').addClass('is-focused');\n      }\n\n      this.api.trigger.on('hide.editortime', () => {\n        self.input.closest('td').removeClass('is-focused');\n\n        setTimeout(() => {\n          self.input.trigger('focusout');\n          container.parent().focus();\n          grid.setNextActiveCell(event);\n        }, 1);\n      });\n    };\n\n    this.destroy = function () {\n      const self = this;\n      if (self.api && self.api.trigger) {\n        self.api.trigger.off('hide.editortime');\n      }\n\n      setTimeout(() => {\n        grid.quickEditMode = false;\n        self.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Lookup(row, cell, value, container, column, event, grid, rowData) {\n    this.name = 'lookup';\n    this.originalValue = value;\n\n    this.init = function () {\n      this.input = $(`<input class=\"lookup ${column.align === 'right' ? 'align-text-right' : ''}\" data-init=\"false\" />`).appendTo(container);\n\n      addStandardInputFeatures(\n        this.input,\n        row, cell, value, container, column, event, grid, rowData\n      );\n\n      this.input.lookup(column.editorOptions);\n\n      // Append the Lookup's clickArguments with some row/col meta-data\n      const api = this.input.data('lookup');\n      api.settings.clickArguments = {\n        column,\n        container,\n        grid,\n        cell,\n        event,\n        row,\n        rowData,\n        value\n      };\n    };\n\n    this.val = function (v) {\n      let fieldValue = this.input.val();\n      if (fieldValue && fieldValue.indexOf('|') > -1) {\n        fieldValue = fieldValue.substr(0, fieldValue.indexOf('|'));\n      }\n      return v ? this.input.val(v) : fieldValue;\n    };\n\n    this.focus = function () {\n      const self = this;\n      const api = self.input.data('lookup');\n      const td = self.input.closest('td');\n\n      // Using keyboard\n      if (event.type === 'keydown') {\n        self.input.select().focus();\n        td.on('keydown.editorlookup', (e) => {\n          if (e.keyCode === 40) {\n            e.preventDefault();\n            e.stopPropagation();\n          }\n        });\n      }\n\n      // Check if isClick or cell touch and just open the list\n      if (event.type === 'click') {\n        if ($(event.target).is('svg')) {\n          api.openDialog(event);\n        } else {\n          self.input.select().focus();\n          td.on('touchcancel.editorlookup touchend.editorlookup', '.trigger', () => {\n            api.openDialog();\n          });\n        }\n      }\n\n      // Update on change from lookup\n      self.input.on('change', () => {\n        setTimeout(() => {\n          container.parent().focus();\n          grid.quickEditMode = false;\n        }, 1);\n      });\n    };\n\n    this.destroy = function () {\n      const self = this;\n      const td = this.input.closest('td');\n      setTimeout(() => {\n        grid.quickEditMode = false;\n        td.off('keydown.editorlookup')\n          .find('.trigger').off('touchcancel.editorlookup touchend.editorlookup');\n        self.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Autocomplete(ow, cell, value, container, column, event, grid) {\n    this.name = 'autocomplete';\n    this.originalValue = value;\n\n    this.init = function () {\n      this.input = $('<input class=\"autocomplete datagrid-autocomplete\" />').appendTo(container);\n\n      if (!column.editorOptions) {\n        column.editorOptions = {};\n      }\n      column.editorOptions.width = container.parent().width();\n      column.editorOptions.offset = { left: -1, top: (grid.settings.rowHeight === 'medium' ? 1 : 5) };\n\n      if (column.maxLength) {\n        this.input.attr('maxlength', column.maxLength);\n      }\n\n      if (column.uppercase) {\n        this.input.addClass('uppercase-text');\n      }\n\n      this.input.autocomplete(column.editorOptions);\n    };\n\n    this.val = function (v) {\n      return v ? this.input.val(v) : this.input.val();\n    };\n\n    this.focus = function () {\n      grid.quickEditMode = true;\n      this.input.select().focus();\n    };\n\n    this.destroy = function () {\n      setTimeout(() => {\n        grid.quickEditMode = false;\n        this.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Spinbox(ow, cell, value, container, column, event, grid) {\n    this.name = 'spinbox';\n    this.originalValue = value;\n    this.useValue = true; // use the data set value not cell value\n\n    this.init = function () {\n      if (column.inlineEditor) {\n        this.input = container.find('input');\n        return;\n      }\n\n      const markup = `<label for=\"spinbox-${cell}\" class=\"audible\">Quantity</label>\n        <span class=\"spinbox-wrapper\"><span class=\"spinbox-control down\">-</span>\n        <input id=\"spinbox-${cell}\" name=\"spinbox-${cell}\" type=\"text\" class=\"spinbox\" value=\"'+ ${value} +'\">\n        <span class=\"spinbox-control up\">+</span></span>`;\n\n      DOM.append(container, markup, '<label><span><input>');\n      this.input = container.find('input');\n\n      if (!column.editorOptions) {\n        column.editorOptions = {};\n      }\n\n      this.input.spinbox(column.editorOptions);\n    };\n\n    this.val = function (v) {\n      return v ? parseInt(this.input.val(v), 10) : parseInt(this.input.val(), 10);\n    };\n\n    this.focus = function () {\n      grid.quickEditMode = true;\n      this.input.select().focus();\n    };\n\n    this.destroy = function () {\n      if (column.inlineEditor) {\n        return;\n      }\n\n      setTimeout(() => {\n        grid.quickEditMode = false;\n        this.input.remove();\n      }, 0);\n    };\n\n    this.init();\n  },\n\n  Favorite(row, cell, value, container, column, event, grid) {\n    this.name = 'favorite';\n    this.useValue = true;\n    this.originalValue = value;\n\n    this.init = function () {\n      this.input = $(`<span class=\"icon-favorite\">${$.createIcon({ icon: value ? 'star-filled' : 'star-outlined' })}<input type=\"checkbox\"></span>`).appendTo(container);\n\n      this.input = this.input.find('input');\n    };\n\n    this.val = function (v) {// eslint-disable-line\n      let isChecked;\n\n      if (v === undefined) {\n        return this.input.prop('checked');\n      }\n\n      // Use isChecked function if exists\n      if (column.isChecked) {\n        isChecked = column.isChecked(v);\n      } else {\n        isChecked = v;\n      }\n\n      // just toggle it when clicked\n      if ((event.type === 'click' || (event.type === 'keydown' && event.keyCode === 32)) && (!$(event.target).is('.datagrid-cell-wrapper'))) {\n        isChecked = !isChecked;\n        grid.setNextActiveCell(event);\n      }\n\n      this.input.prop('checked', isChecked);\n      this.input.find('use').attr('xlink:href', isChecked ? '#icon-star-filled' : '#icon-star-outlined');\n    };\n\n    this.focus = function () {\n      this.input.trigger('focusout').focus();\n    };\n\n    this.destroy = function () {\n      setTimeout(() => {\n        this.input.parent().remove();\n      }, 0);\n    };\n\n    this.init();\n  }\n};\n\nexport { editors as Editors };\n","import { Environment as env } from './environment';\nimport { Formatters } from '../components/datagrid/datagrid.formatters';\nimport { Editors } from '../components/datagrid/datagrid.editors';\n\n/* eslint-disable import/prefer-default-export */\nconst excel = {};\n\n/**\n * Remove Hidden Columns and Non Exportable Columns.\n * @private\n * @param {string} customDs An optional customized version of the data to use.\n * @param {string} self The grid api to use (if customDs is not used)\n * @returns {object} an table element cleaned extra stuff\n */\nexcel.cleanExtra = function (customDs, self) {\n  const clean = function (table) {\n    const removeNode = (node) => {\n      if (node.parentNode) {\n        node.parentNode.removeChild(node);\n      }\n    };\n    const nonExportables = [];\n    const elements = [].slice.call(table[0].querySelectorAll('tr, th, td, div, span'));\n\n    elements.forEach((el) => {\n      if (el.classList.contains('is-hidden') || el.classList.contains('datagrid-expandable-row')) {\n        removeNode(el);\n        return;\n      }\n\n      // THEAD\n      const attrExportable = el.getAttribute('data-exportable');\n      if (attrExportable && attrExportable === 'no') {\n        const index = parseInt(el.id.slice(-1), 10);\n        nonExportables.push(index + 1);\n        removeNode(el);\n        return;\n      }\n\n      // TBODY\n      const attrAriaColindex = el.getAttribute('aria-colindex');\n      if (el.tagName.toLowerCase() === 'td' && attrAriaColindex) {\n        if (nonExportables.indexOf(parseInt(attrAriaColindex, 10)) !== -1) {\n          removeNode(el);\n          return;\n        }\n      }\n\n      const innerElements = [].slice.call(table[0].querySelectorAll('.is-hidden, .datagrid-expand-btn, .is-draggable-target, .handle, .sort-indicator, .datagrid-filter-wrapper'));\n      innerElements.forEach(innerEl => removeNode(innerEl));\n\n      while (el.attributes.length > 0) {\n        el.removeAttribute(el.attributes[0].name);\n      }\n\n      // White Hat Security Violation. Remove Excel formulas\n      // Excel Formulas Start with =SOMETHING\n      const text = el.textContent;\n      if (text.substr(0, 1) === '=' && text.substr(1, 1) !== '') {\n        el.textContent = `'${text}'`;\n      }\n    });\n\n    return table;\n  };\n\n  let table = [];\n  if (!self && customDs) {\n    table = excel.datasetToHtml(customDs);\n  } else {\n    table = excel.appendRows(self.settings.dataset, self.table[0].cloneNode(true), self);\n  }\n\n  // Create the header row\n  if (!customDs && !table[0].querySelector('thead')) {\n    const tbody = table[0].querySelector('tbody');\n    const header = table[0].createTHead();\n    const row = table[0].insertRow(0);\n    const allHeaderNodes = self.headerNodes();\n\n    for (let i = 0; i < allHeaderNodes.length; i++) {\n      const headerNode = allHeaderNodes[i];\n      const cell = row.insertCell(i);\n      cell.innerHTML = headerNode.querySelector('.datagrid-header-text').textContent.trim();\n      cell.setAttribute('class', headerNode.classList);\n      cell.setAttribute('id', headerNode.getAttribute('id'));\n      if (headerNode.getAttribute('data-exportable')) {\n        cell.setAttribute('data-exportable', headerNode.getAttribute('data-exportable'));\n      }\n    }\n    tbody.parentNode.insertBefore(header, tbody);\n  }\n\n  table = clean(table);\n\n  // Exporting data with trailing negative signs moved in front\n  if (self && self.settings.exportConvertNegative) {\n    const cells = [].slice.call(table[0].querySelectorAll('td'));\n    cells.forEach((td) => {\n      td.textContent = td.textContent.replace(/^(.+)(-$)/, '$2$1');\n    });\n  }\n  return table;\n};\n\n/**\n * Save file to download `.xls or .csv`.\n * @private\n * @param {string} content The content for the file in the download.\n * @param {string} fileName The desired export filename in the download.\n * @returns {void}\n */\nexcel.save = function (content, fileName) {\n  const ext = (fileName.match(/\\.([^.]*?)(?=\\?|#|$)/) || [])[1];\n  const isTypeExcel = typeof ext === 'string' && /\\b(xlsx|xls)\\b/g.test(ext);\n\n  if (env.browser.name === 'ie' || env.browser.name === 'edge') {\n    if (window.navigator.msSaveBlob) {\n      const blob = new Blob([content], {\n        type: 'application/csv;charset=utf-8;'\n      });\n      navigator.msSaveBlob(blob, fileName);\n    }\n  } else if (window.URL.createObjectURL) { // createObjectURL api allows downloading larger files\n    const blob = new Blob([content], {\n      type: `application/${isTypeExcel ? 'vnd.ms-excel' : 'csv'};charset=utf-8;`\n    });\n    const objectUrl = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = objectUrl;\n    link.download = fileName;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(objectUrl);\n  } else {\n    const link = document.createElement('a');\n    link.href = this.base64(content);\n    link.download = fileName;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n  }\n};\n\n/**\n* Convert a dataset to a html table for conversion to excel.\n* @private\n* @param {string} dataset The array of objects to convert\n* @returns {string} an html table as a string\n*/\nexcel.datasetToHtml = function (dataset) {\n  let tableHtml = '<tbody>';\n  for (let i = 0; i < dataset.length; i++) {\n    tableHtml += '<tr>';\n    Object.keys(dataset[i]).forEach((key, index) => { //eslint-disable-line\n      if (dataset[i] && Object.prototype.hasOwnProperty.call(dataset[i], key)) {\n        tableHtml += `<td>${dataset[i][key]}</td>`;\n      }\n    });\n    tableHtml += '</tr>';\n  }\n\n  tableHtml += '</tbody>';\n  return $('<table></table>').append(tableHtml);\n};\n\n/**\n* Convert a dataset to a html table for conversion to excel.\n* @private\n* @param {array} dataset The array of objects to convert.\n* @param {object} table The table object.\n* @param {object} self The grid API.\n* @returns {object} The table with rows appended.\n*/\nexcel.appendRows = function (dataset, table, self) {\n  const isjQuery = obj => (obj && (obj instanceof jQuery || obj.constructor.prototype.jquery));\n  const tableJq = isjQuery(table) ? table : $(table);\n  table = tableJq[0];\n\n  let tableHtml = '';\n  const body = table.querySelector('tbody');\n  body.innerHTML = '';\n  const appendRow = function (d, i) {\n    if (!d.isFiltered) {\n      const rowHtml = self.rowHtml(d, i, i, false, false, i, true);\n      const tr = document.createElement('tr');\n      tr.innerHTML = rowHtml.left + rowHtml.center + rowHtml.right;\n      tableHtml += tr.outerHTML;\n\n      // Add tree rows\n      if (d.children) {\n        for (let j = 0, l = d.children.length; j < l; j++) {\n          appendRow(d.children[j], j);\n        }\n      }\n    }\n  };\n\n  dataset.forEach((d, i) => {\n    appendRow(d, i);\n  });\n\n  body.insertAdjacentHTML('beforeend', tableHtml);\n  return tableJq;\n};\n\n/**\n * Convert a excel string to base64 format for download.\n * @private\n * @param {string} s The string containing the document.\n * @returns {string} The excel doc as a base64 string.\n */\nexcel.base64 = function (s) {\n  if (window.btoa) {\n    return `data:application/vnd.ms-excel;base64,${window.btoa(unescape(encodeURIComponent(s)))}`;\n  }\n  return `data:application/vnd.ms-excel;,${unescape(encodeURIComponent(s))}`;\n};\n\n/**\n * Copy pasted data into the dataset to facilitate copy from excel.\n * @param {object} pastedData The paste data from the paste event.\n * @param {[type]} rowCount The number of rows.\n * @param {[type]} colIndex The column index we started on.\n * @param {[type]} dataSet The dataset.\n * @param {[type]} self The datagrid API.\n * @returns {void}\n */\nexcel.copyToDataSet = function (pastedData, rowCount, colIndex, dataSet, self) {\n  const validateFields = function (values, settings, rowData, idx) {\n    for (let j = 0; j < values.length; j++) {\n      const col = settings.columns[idx];\n\n      if (col.formatter !== Formatters.Readonly) {\n        switch (col.editor.name) {\n          case Editors.Input.name:\n            if (col.filterType === 'integer' || col.filterType === 'decimal' || col.filterType === 'number') {\n              // Number Values\n\n              // Validates if input is number. If true, will overwrite the data in cell otherwise nothing will happen.\n              if (!isNaN(values[j].trim())) {\n                rowData[col.field] = values[j];\n              }\n            } else {\n              // String Values\n              // Just overwrite the data in the cell\n              rowData[col.field] = values[j];\n            }\n            break;\n          case Editors.Date.name:\n            // Validates if input is date. If true, will overwrite the data in cell otherwise nothing will happen.\n            if (!isNaN(Date.parse(values[j]))) {\n              rowData[col.field] = new Date(values[j]);\n            }\n            break;\n          default:\n            break;\n        }\n      }\n\n      idx++;\n    }\n  };\n\n  for (let i = 0; i < pastedData.length; i++) {\n    const rawVal = pastedData[i].split('\\t');\n    const startColIndex = colIndex;\n\n    if (rowCount < dataSet.length) {\n      const currentRowData = dataSet[rowCount];\n      validateFields(rawVal, self.settings, currentRowData, startColIndex);\n    } else {\n      const newRowData = {};\n      for (let k = 0; k < self.settings.columns.length; k++) {\n        newRowData[self.settings.columns[k].field] = '';\n      }\n      validateFields(rawVal, self.settings, newRowData, startColIndex);\n      dataSet.push(newRowData);\n    }\n    rowCount++;\n  }\n\n  self.renderRows();\n  self.syncSelectedUI();\n  self.pagerRefresh('bottom');\n};\n\n/**\n * Export the grid contents to xls format. This may give a warning when opening the file.\n * exportToCsv may be prefered.\n * @param {string} fileName The desired export filename in the download.\n * @param {string} worksheetName A name to give the excel worksheet tab.\n * @param {string} customDs An optional customized version of the data to use.\n * @param {object} self The grid api if customDS is not used\n * @returns {void}\n */\nexcel.exportToExcel = function (fileName, worksheetName, customDs, self) {\n  const template = '' +\n    '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\">' +\n      '<head>' +\n        '<!--[if gte mso 9]>' +\n          '<xml>' +\n            '<x:ExcelWorkbook>' +\n              '<x:ExcelWorksheets>' +\n                '<x:ExcelWorksheet>' +\n                  '<x:Name>{worksheet}</x:Name>' +\n                  '<x:WorksheetOptions>' +\n                    '<x:Panes></x:Panes>' +\n                    '<x:DisplayGridlines></x:DisplayGridlines>' +\n                  '</x:WorksheetOptions>' +\n                '</x:ExcelWorksheet>' +\n              '</x:ExcelWorksheets>' +\n            '</x:ExcelWorkbook>' +\n          '</xml>' +\n        '<![endif]-->' +\n        '<meta http-equiv=\"content-type\" content=\"text/plain; charset=UTF-8\"/>' +\n      '</head>' +\n      '<body>' +\n        '<table border=\"1px solid #999999\">{table}</table>' +\n      '</body>' +\n    '</html>';\n\n  const formatExcel = function (s, c) {\n    return s.replace(/{(\\w+)}/g, (m, p) => c[p]);\n  };\n\n  const table = excel.cleanExtra(customDs, self);\n  const ctx = { worksheet: (worksheetName || 'Worksheet'), table: table[0].innerHTML };\n\n  fileName = `${fileName || self.element[0].id || 'Export'}.xls`;\n  excel.save(formatExcel(template, ctx), fileName);\n};\n\n/**\n * Export the grid contents to csv\n * @param {string} fileName The desired export filename in the download.\n * @param {string} customDs An optional customized version of the data to use.\n * @param {string} separator (optional) If user's machine is configured for a locale with alternate default seperator.\n * @param {string} self The grid api to use (if customDs is not used)\n * @returns {void}\n */\nexcel.exportToCsv = function (fileName, customDs, separator = 'sep=,', self) {\n  const formatCsv = function (table) {\n    const csv = [];\n    const rows = [].slice.call(table[0].querySelectorAll('tr'));\n    rows.forEach((row) => {\n      const rowContent = [];\n      const cols = [].slice.call(row.querySelectorAll('td, th'));\n      cols.forEach(col => rowContent.push(col.textContent.replace(/\\r?\\n|\\r/g, '').replace(/\"/g, '\"\"').trim()));\n      csv.push(rowContent.join('\",\"'));\n    });\n    csv.unshift([`${separator}`]);\n    return `\"${csv.join('\"\\n\"')}\"`;\n  };\n\n  const table = excel.cleanExtra(customDs, self);\n\n  fileName = `${fileName || self.element[0].id || 'Export'}.csv`;\n  excel.save(formatCsv(table), fileName);\n};\n\nexport { excel };\n\n/* eslint-enable import/prefer-default-export */\n","import { utils } from '../../utils/utils';\n\n/**\n* An api for grouping data by a given field (s)\n* @private\n*/\nconst groupBy = (function () {\n  // Can also use in isEquivalent: function(obj1, obj2)  in datagrid.js\n  const equals = utils.equals;\n\n  // See if the object has these proprties or not\n  const has = function (obj, target) {\n    return obj.some(value => equals(value, target));\n  };\n\n  // Return just the object properties matching the names\n  const pick = function (obj, names) {\n    const chosen = {};\n    for (let i = 0, l = names.length; i < l; i++) {\n      chosen[names[i]] = obj[names[i]];\n    }\n    return chosen;\n  };\n\n  // Return the specific keys from the object\n  const keys = function (data, names) {\n    return data.reduce((memo, item) => {\n      const key = pick(item, names);\n\n      if (!has(memo, key)) {\n        memo.push(key);\n      }\n      return memo;\n    }, []);\n  };\n\n  // Look through each value in the list and return an array of all the values\n  // that contain all of the key-value pairs listed in properties.\n  const where = function (data, names) {\n    const chosen = [];\n\n    /* eslint-disable */\n    data.map(function (item) {\n      let match = true;\n      for (const prop in names) {\n        if (names[prop] !== item[prop]) {\n          match = false;\n          return;\n        }\n      }\n      chosen.push(item);\n      return;\n    });\n    /* eslint-enable */\n\n    return chosen;\n  };\n\n  // Grouping Function with Plugins/Aggregator\n  const group = function (data, names) {\n    const stems = keys(data, names);\n\n    return stems.map(stem => ({\n      key: stem,\n      values: where(data, stem).map(item => item)\n    }));\n  };\n\n  // Register an aggregator\n  group.register = function (name, converter) {\n    group[name] = function (data, names, extra) {\n      const that = this;\n      that.extra = extra;\n      return group(data, names).map(converter, that);\n    };\n    return group[name];\n  };\n\n  return group;\n}());\n\n/**\n* Register built in aggregators\n* @private\n*/\ngroupBy.register('none', item => $.extend({}, item.key, { values: item.values }));\n\ngroupBy.register('sum', function (item) {\n  const extra = this.extra;\n  return $.extend(\n    {}, item.key,\n    { values: item.values },\n    { sum: item.values.reduce((memo, node) => memo + Number(node[extra]), 0) }\n  );\n});\n\ngroupBy.register('max', function (item) {\n  const extra = this.extra;\n  return $.extend(\n    {},\n    item.key,\n    { values: item.values }, // eslint-disable-next-line\n    { max: item.values.reduce((memo, node) => Math.max(memo, Number(node[extra])), Number.NEGATIVE_INFINITY) }\n  );\n});\n\ngroupBy.register('list', function (item) {\n  const extra = this.extra;\n\n  return $.extend(\n    {},\n    item.key,\n    { values: item.values },\n    {\n      list: item.values.map((thisItem) => {\n        const list = [];\n\n        for (let i = 0, l = extra.list.length; i < l; i++) {\n          const exclude = extra.exclude ? thisItem[extra.exclude] : false;\n          if (thisItem[extra.list[i]] && !exclude) {\n            list.push({ value: thisItem[extra.list[i]], key: extra.list[i] });\n          }\n        }\n        return list;\n      })\n    }\n  );\n});\n\n/**\n* Simple Summary Row Accumlator\n* @private\n*/\nconst aggregators = {};\naggregators.aggregate = function (items, columns) {\n  const totals = {};\n  const self = this;\n\n  for (let i = 0, l = columns.length; i < l; i++) {\n    if (columns[i].aggregator) {\n      const field = columns[i].field;\n\n      self.sum = function (sum, node) {\n        if (node.isFiltered) { // If excluded / filtered out.\n          return sum;\n        }\n\n        let value;\n\n        if (field.indexOf('.') > -1) {\n          value = field.split('.').reduce((o, x) => (o ? o[x] : ''), node);\n        } else {\n          value = node[field];\n        }\n        return sum + Number(value);\n      };\n\n      const total = items.reduce(self[columns[i].aggregator], 0);\n\n      if (field.indexOf('.') > -1) {\n        let currentObj = totals;\n        for (let j = 0, k = field.split('.').length; j < k; j++) {\n          if (j === field.split('.').length - 1) {\n            currentObj[field.split('.')[j]] = total;\n          } else {\n            if (!(field.split('.')[j] in currentObj)) {\n              currentObj[field.split('.')[j]] = {};\n            }\n\n            currentObj = currentObj[field.split('.')[j]];\n          }\n        }\n      } else {\n        totals[field] = total;\n      }\n    }\n  }\n\n  return totals;\n};\n\nexport { groupBy as GroupBy, aggregators as Aggregators };\n","/* eslint-disable no-underscore-dangle, no-continue, no-nested-ternary */\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { excel } from '../../utils/excel';\nimport { Locale } from '../locale/locale';\nimport { Tmpl } from '../tmpl/tmpl';\nimport { debounce } from '../../utils/debounced-resize';\nimport { warnAboutDeprecation } from '../../utils/deprecated';\nimport { stringUtils } from '../../utils/string';\nimport { xssUtils } from '../../utils/xss';\nimport { DOM } from '../../utils/dom';\nimport { Environment as env } from '../../utils/environment';\n\nimport { Formatters } from '../datagrid/datagrid.formatters';\nimport { GroupBy, Aggregators } from '../datagrid/datagrid.groupby';\n// eslint-disable-next-line\nimport { Editors } from '../datagrid/datagrid.editors';\n\n// jQuery components\nimport '../../utils/animations';\nimport '../emptymessage/emptymessage.jquery';\nimport '../pager/pager.jquery';\nimport '../mask/mask-input.jquery';\nimport '../multiselect/multiselect.jquery';\nimport '../timepicker/timepicker.jquery';\nimport '../drag/drag.jquery';\n\n// The name of this component.\nconst COMPONENT_NAME = 'datagrid';\n\n/**\n * The Datagrid Component displays and process data in tabular format.\n * @class Datagrid\n * @constructor\n *\n * @param {jQuery[]|HTMLElement} element The component element.\n * @param {object}   [settings] The component settings.\n * @param {boolean}  [settings.actionableMode=false] If actionableMode is \"true, tab and shift tab behave like left and right arrow key, if the cell is editable it goes in and out of edit mode. F2 - toggles actionableMode \"true\" and \"false\"\n * @param {boolean}  [settings.cellNavigation=true] If cellNavigation is \"false, will show border around whole row on focus\n * @param {boolean}  [settings.rowNavigation=true] If rowNavigation is \"false, will NOT show border around the row\n * @param {boolean}  [settings.showHoverState=true] If false there will be no hover effect.\n * @param {boolean}  [settings.alternateRowShading=false] Sets shading for readonly grids\n * @param {array}    [settings.columns=[]] An array of columns (see column options)\n * @param {array}    [settings.frozenColumns={ left: [], right: [] }] An object with two arrays of column id's. One for freezing columns to the left side, and one for freezing columns to the right side.\n * @param {array}    [settings.dataset=[]] An array of data objects\n * @param {boolean}  [settings.columnReorder=false] Allow Column reorder\n * @param {boolean}  [settings.saveColumns=false] Save Column Reorder and resize, this is deprecated, use saveUserSettings\n * @param {object}   [settings.saveUserSettings]\n * @param {object}   [settings.saveUserSettings.columns=true]\n * @param {object}   [settings.saveUserSettings.rowHeight=true]\n * @param {object}   [settings.saveUserSettings.sortOrdertrue]\n * @param {object}   [settings.saveUserSettings.pageSize=true]\n * @param {object}   [settings.saveUserSettings.activePage=true]\n * @param {object}   [settings.saveUserSettings.filter=true]\n * @param {boolean}  [settings.focusAfterSort=false] If true will focus the active cell after sorting.\n * @param {boolean}  [settings.editable=false] Enable editing in the grid, requires column editors.\n * @param {boolean}  [settings.isList=false] Makes the grid have readonly \"list\" styling\n * @param {string}   [settings.menuId=null]  ID of the menu to use for a row level right click context menu\n * @param {string}   [settings.menuSelected=null] Callback for the grid level context menu\n * @param {string}   [settings.menuBeforeOpen=null] Callback for the grid level beforeopen menu event\n * @param {string}   [settings.headerMenuId=null] Id of the menu to use for a header right click context menu\n * @param {string}   [settings.headerMenuSelected=false] Callback for the header level context menu\n * @param {string}   [settings.headerMenuBeforeOpen=false] Callback for the header level beforeopen menu event\n * @param {string}   [settings.uniqueId=null] Unique DOM ID to use as local storage reference and internal variable names\n * @param {string}   [settings.rowHeight=normal] Controls the height of the rows / number visible rows. May be (short, medium or normal)\n * @param {string}   [settings.selectable=false] Controls the selection Mode this may be: false, 'single' or 'multiple' or 'mixed' or 'siblings'\n * @param {object}   [settings.groupable=null]  Controls fields to use for data grouping Use Data grouping, e.g. `{fields: ['incidentId'], supressRow: true, aggregator: 'list', aggregatorOptions: ['unitName1']}`\n * @param {boolean}  [settings.spacerColumn=false] if true and the grid is not wide enough to fit the last column will get filled with an empty spacer column.\n * @param {boolean}  [settings.showNewRowIndicator=true] If true, the new row indicator will display after adding a row.\n * @param {boolean}  [settings.stretchColumn='last'] If 'last' the last column will stretch using 100% css and work on resize.\n * @param {boolean}  [settings.clickToSelect=true] Controls if using a selection mode if you can click the rows to select\n * @param {object}   [settings.toolbar=false]  Toggles and appends various toolbar features for example `{title: 'Data Grid Header Title', results: true, keywordFilter: true, filter: true, rowHeight: true, views: true}`\n * @param {boolean}  [settings.selectChildren=true] Will prevent selecting of all child nodes on a multiselect tree.\n * @param {boolean}  [settings.allowSelectAcrossPages=null] Makes it possible to save selections when changing pages on server side paging. You may want to also use showSelectAllCheckBox: false\n * @param {boolean}  [settings.initializeToolbar=true] Set to false if you will initialize the toolbar yourself\n * @param {boolean}  [settings.paging=false] Enable paging mode\n * @param {number}   [settings.pagesize=25] Number of rows per page\n * @param {array}    [settings.pagesizes=[10, 25, 50, 75]] Array of page sizes to show in the page size dropdown.\n * @param {boolean}  [settings.indeterminate=false] Disable the ability to go to a specific page when paging.\n * @param {Function} [settings.source=false]  Callback function for paging\n * @param {boolean}  [settings.hidePagerOnOnePage=false]  If true, hides the pager if there's only one page worth of results.\n * @param {boolean}  [settings.filterable=false] Enable Column Filtering, This will require column filterTypes as well.\n * @param {boolean}  [settings.filterWhenTyping=true] Enable Column Filtering as you stop typing in inputs\n * @param {boolean}  [settings.disableClientFilter=false] Disable Filter Logic client side and let your server do it\n * @param {boolean}  [settings.disableClientSort=false] Disable Sort Logic client side and let your server do it\n * @param {string}   [settings.resultsText=null] Can provide a custom function to adjust results text on the toolbar\n * @param {boolean}  [settings.showFilterTotal=true] Paging results display filter count, change to false to not show filtered count\n * @param {boolean}  [settings.rowReorder=false] If set you can reorder rows. Requires rowReorder formatter\n * @param {boolean}  [settings.showDirty=false]  If true the dirty indicator will be shown on the rows\n * @param {boolean}  [settings.showSelectAllCheckBox=true] Allow to hide the checkbox header (true to show, false to hide)\n * @param {boolean}  [settings.allowOneExpandedRow=true] Controls if you cna expand more than one expandable row.\n * @param {boolean}  [settings.enableTooltips=false] Process tooltip logic at a cost of performance\n * @param {boolean}  [settings.disableRowDeactivation=false] if a row is activated the user should not be able to deactivate it by clicking on the activated row\n * @param {boolean}  [settings.sizeColumnsEqually=false] If true make all the columns equal width\n * @param {boolean}  [settings.expandableRow=false] If true we append an expandable row area without the rowTemplate feature being needed.\n * @param {boolean}  [settings.exportConvertNegative=false] If set to true export data with trailing negative signs moved in front.\n * @param {array}    [settings.columnGroups=null] An array of columns to use for grouped column headers.\n * @param {boolean}  [settings.treeGrid=false] If true a tree grid is expected so addition calculations will be used to calculate of the row children\n * @param {Function} [settings.onPostRenderCell=null] A call back function that will fire and send you the cell container and related information for any cells cells with a component attribute in the column definition.\n * @param {Function} [settings.onDestroyCell=null] A call back that goes along with onPostRenderCel and will fire when this cell is destroyed and you need noification of that.\n * @param {Function} [settings.onEditCell=null] A callback that fires when a cell is edited, the editor object is passed in to the function\n * @param {Function} [settings.onExpandRow=null] A callback function that fires when expanding rows. To be used. when expandableRow is true. The function gets eventData about the row and grid and a response function callback. Call the response function with markup to append and delay opening the row.\n * @param {boolean}  [settings.searchExpandableRow=true] If true keywordSearch will search in expandable rows (default). If false it will not search expandable rows.\n * @param {object}   [settings.emptyMessage]\n * @param {object}   [settings.emptyMessage.title='No Data Available']\n * @param {object}   [settings.emptyMessage.info='']\n * @param {object}   [settings.emptyMessage.icon='icon-empty-no-data']\n * An empty message will be displayed when there is no rows in the grid. This accepts an object of the form\n * emptyMessage: {title: 'No Data Available', info: 'Make a selection on the list above to see results',\n * icon: 'icon-empty-no-data', button: {text: 'xxx', click: <function>}} set this to null for no message\n * or will default to 'No Data Found with an icon.'\n * @param {boolean}  [settings.allowChildExpandOnMatch=false] use  with filter\n * if true:\n * and if only parent has a match then add all children nodes too\n * or if one or more child node got match then add parent node and all the children nodes\n * if false:\n * and if only parent has a match then make expand/collapse button to be collapsed, disabled\n * and do not add any children nodes\n * or if one or more child node got match then add parent node and only matching children nodes\n */\nconst DATAGRID_DEFAULTS = {\n  // F2 - toggles actionableMode \"true\" and \"false\"\n  // If actionableMode is \"true, tab and shift tab behave like left and right arrow key,\n  // if the cell is editable it goes in and out of edit mode\n  actionableMode: false,\n  cellNavigation: true, // If cellNavigation is \"false, will show border around whole row on focus\n  rowNavigation: true, // If rowNavigation is \"false, will NOT show border around the row\n  showHoverState: true,\n  alternateRowShading: false,\n  columns: [],\n  frozenColumns: {\n    left: [],\n    right: []\n  },\n  dataset: [],\n  columnReorder: false, // Allow Column reorder\n  saveColumns: false, // Save Column Reorder and resize\n  saveUserSettings: {},\n  focusAfterSort: false, // If true will focus the active cell after sorting.\n  editable: false,\n  isList: false, // Makes a readonly \"list\"\n  menuId: null, // Id to the right click context menu\n  headerMenuId: null, // Id to the right click context menu to use for the header\n  menuSelected: null, // Callback for the grid level right click menu\n  menuBeforeOpen: null, // Call back for the grid level before open menu event\n  headerMenuSelected: null, // Callback for the header level right click menu\n  headerMenuBeforeOpen: null, // Call back for the header level before open menu event\n  uniqueId: null, // Unique ID for local storage reference and variable names\n  rowHeight: 'normal', // (short, medium or normal)\n  selectable: false, // false, 'single' or 'multiple' or 'siblings'\n  selectChildren: true, // can prevent selecting of all child nodes on multiselect\n  allowSelectAcrossPages: null,\n  groupable: null,\n  spacerColumn: false,\n  showNewRowIndicator: true,\n  stretchColumn: 'last',\n  twoLineHeader: false,\n  clickToSelect: true,\n  toolbar: false,\n  initializeToolbar: true, // can set to false if you will initialize the toolbar yourself\n  // Paging settings\n  paging: false,\n  pagesize: 25,\n  pagesizes: [10, 25, 50, 75],\n  showPageSizeSelector: true, // Will show page size selector\n  indeterminate: false, // removed ability to go to a specific page.\n  source: null, // callback for paging\n  hidePagerOnOnePage: false, // If true, hides the pager if there's only one page worth of results.\n  // Filtering settings\n  filterable: false,\n  filterWhenTyping: true,\n  disableClientFilter: false, // Disable Filter Logic client side and let your server do it\n  disableClientSort: false, // Disable Sort Logic client side and let your server do it\n  resultsText: null, // Can provide a custom function to adjust results text\n  showFilterTotal: true, // Paging results show filtered count, false to not show.\n  virtualized: false, // Prevent Unused rows from being added to the DOM\n  virtualRowBuffer: 10, // how many extra rows top and bottom to allow as a buffer\n  rowReorder: false, // Allows you to reorder rows. Requires rowReorder formatter\n  showDirty: false,\n  showSelectAllCheckBox: true, // Allow to hide the checkbox header (true to show, false to hide)\n  allowOneExpandedRow: true, // Only allows one expandable row at a time\n  enableTooltips: false, // Process tooltip logic at a cost of performance\n  disableRowDeactivation: false,\n  sizeColumnsEqually: false, // If true make all the columns equal width\n  expandableRow: false, // Supply an empty expandable row template\n  exportConvertNegative: false, // Export data with trailing negative signs moved in front\n  columnGroups: null, // The columns to use for grouped column headings\n  treeGrid: false,\n  onPostRenderCell: null,\n  onDestroyCell: null,\n  onEditCell: null,\n  onExpandRow: null,\n  emptyMessage: { title: (Locale ? Locale.translate('NoData') : 'No Data Available'), info: '', icon: 'icon-empty-no-data' },\n  searchExpandableRow: true,\n  allowChildExpandOnMatch: false\n};\n\nfunction Datagrid(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, DATAGRID_DEFAULTS);\n  this.element = $(element);\n  if (settings.dataset) {\n    this.settings.dataset = settings.dataset;\n  }\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n/**\n* Actual Datagrid prototype\n* @private\n*/\nDatagrid.prototype = {\n\n  /**\n   * @returns {Pager} IDS Pager component API.\n   */\n  get pagerAPI() {\n    let api;\n    if (this.tableBody && this.tableBody.length) {\n      api = this.tableBody.data('pager');\n    }\n    return api;\n  },\n\n  /**\n   * Reference to the pager API, if applicable.\n   * This method is slated to be removed in a future v4.22.0 or v5.0.0.\n   * @deprecated as of v4.16.0. Please use `pagerAPI` property instead.\n   * @returns {Pager} IDS Pager component API.\n   */\n  get pager() {\n    warnAboutDeprecation('pagerAPI', 'pager');\n    return this.pagerAPI;\n  },\n\n  /**\n  * Init the datagrid from its uninitialized state.\n  * @private\n  * @returns {void}\n  */\n  init() {\n    const html = $('html');\n\n    this.isTouch = env.features.touch;\n    this.isSafari = html.is('.is-safari');\n    this.isWindows = (navigator.userAgent.indexOf('Windows') !== -1);\n    this.appendTooltip();\n    this.initSettings();\n    this.originalColumns = this.columnsFromString(JSON.stringify(this.settings.columns));\n    this.removeToolbarOnDestroy = false;\n    this.nonVisibleCellErrors = [];\n    this.recordCount = 0;\n    this.canvas = null;\n    this.totalWidths = { left: 0, center: 0, right: 0 };\n    this.totalMinWidths = { left: 0, center: 0, right: 0 };\n    this.editor = null; // Current Cell Editor thats in Use\n    this.activeCell = { node: null, cell: null, row: null }; // Current Active Cell\n    this.dontSyncUi = false;\n    this.widthPercent = false;\n    this.rowSpans = [];\n    this.headerWidths = []; // Cache\n    this.filterRowRendered = false; // Flag used to determine if the header is rendered or not.\n    this.scrollLeft = 0;\n    this.scrollTop = 0;\n    this._selectedRows = [];\n    this.restoreColumns();\n    this.restoreUserSettings();\n    this.appendToolbar();\n    this.setTreeDepth();\n    this.setRowGrouping();\n    this.setTreeRootNodes();\n    this.firstRender();\n    this.handleEvents();\n    this.handleKeys();\n\n    /**\n     * Fires after the grid is rendered.\n    * @event rendered\n    * @memberof Datagrid\n    * @property {object} event - The jquery event object\n    * @property {array} ui - An array with references to the domElement, header and pagerBar\n    */\n    this.element.trigger('rendered', [this.element, this.headerContainer.find('thead'), this.pagerBar]);\n  },\n\n  /**\n  * Initialize internal variables and states.\n  * @private\n  */\n  initSettings() {\n    this.ignoredColumnById('rowStatus');\n    this.sortColumn = { sortField: null, sortAsc: true };\n    this.gridCount = $('.datagrid').length + 1;\n    this.lastSelectedRow = 0; // Remember index to use shift key\n\n    this.contextualToolbar = this.element.prev('.contextual-toolbar');\n    this.contextualToolbar.addClass('datagrid-contextual-toolbar');\n  },\n\n  /**\n  * Ignore given Column from settings.\n  * @private\n  * @param {string} columnId for column to be ignored\n  * @returns {void}\n  */\n  ignoredColumnById(columnId) {\n    const s = this.settings;\n    if (!columnId || !s.columns || (s.columns && !s.columns.length)) {\n      return;\n    }\n    const column = { index: -1 };\n    for (let i = 0, l = s.columns.length; i < l; i++) {\n      if (s.columns[i].id === columnId) {\n        column.index = i;\n      }\n    }\n    if (column.index > -1) {\n      s.columns.splice(column.index, 1);\n    }\n  },\n\n  /**\n   * Render or render both the header and row area.\n   * @param {string} isToggleFilter Check if filterrow type should be passed to the data source request\n   * @param {object} pagingInfo information about the pager state\n   * @returns {void}\n   */\n  render(isToggleFilter, pagingInfo) {\n    if (!pagingInfo) {\n      pagingInfo = {};\n    }\n\n    if (isToggleFilter) {\n      pagingInfo.type = 'filterrow';\n    }\n\n    if (this.settings.source) {\n      pagingInfo.preserveSelected = true;\n      this.triggerSource(pagingInfo);\n      return;\n    }\n\n    this.loadData(this.settings.dataset, pagingInfo);\n  },\n\n  /**\n  * Run the initial render on the Header and Rows.\n  * @private\n  */\n  firstRender() {\n    const self = this;\n    this.hasLeftPane = this.settings.frozenColumns.left.length > 0;\n    this.hasRightPane = this.settings.frozenColumns.right.length > 0;\n    self.bodyContainer = $('<div class=\"datagrid-body-container\"></div>');\n\n    if (this.hasLeftPane) {\n      self.bodyWrapperLeft = $('<div class=\"datagrid-body left\"></div>');\n      self.tableLeft = $('<table></table>').addClass('datagrid').attr('role', this.settings.treeGrid ? 'treegrid' : 'grid').appendTo(self.bodyWrapperLeft);\n      self.bodyContainer.append(self.bodyWrapperLeft);\n    }\n\n    self.bodyWrapperCenter = $(`<div class=\"datagrid-body center scroll-x${!this.hasRightPane ? ' scroll-y' : ''}\"></div>`);\n    self.table = $('<table></table>').addClass('datagrid').attr('role', this.settings.treeGrid ? 'treegrid' : 'grid').appendTo(self.bodyWrapperCenter);\n    self.bodyContainer.append(self.bodyWrapperCenter);\n\n    if (this.hasRightPane) {\n      self.bodyWrapperRight = $('<div class=\"datagrid-body right scroll-y\"></div>');\n      self.tableRight = $('<table></table>').addClass('datagrid').attr('role', this.settings.treeGrid ? 'treegrid' : 'grid').appendTo(self.bodyWrapperRight);\n      self.bodyContainer.append(self.bodyWrapperRight);\n    }\n\n    this.element.addClass('datagrid-container').attr('x-ms-format-detection', 'none');\n\n    if (this.isWindows) {\n      this.element.addClass('is-windows'); // need since scrollbars are visible\n    }\n\n    // initialize row height by a setting\n    if (this.settings.rowHeight !== 'normal') {\n      if (this.hasLeftPane) {\n        self.tableLeft.addClass(`${this.settings.rowHeight}-rowheight`);\n      }\n      self.table.addClass(`${this.settings.rowHeight}-rowheight`);\n      if (this.hasRightPane) {\n        self.tableRight.addClass(`${this.settings.rowHeight}-rowheight`);\n      }\n      this.element.addClass(`${this.settings.rowHeight}-rowheight`);\n    }\n\n    if (this.settings.isList) {\n      $(this.element).addClass('is-gridlist');\n    } else {\n      $(this.element).removeClass('is-gridlist');\n    }\n\n    this.isInitialRender = true;\n    self.table.empty();\n    self.clearHeaderCache();\n    self.renderRows();\n    self.element.append(this.bodyContainer);\n    self.renderHeader();\n    self.container = self.element.closest('.datagrid-container');\n\n    if (this.settings.emptyMessage) {\n      self.setEmptyMessage(this.settings.emptyMessage);\n      self.checkEmptyMessage();\n    }\n\n    self.buttonSelector = '.btn, .btn-secondary, .btn-primary, .btn-modal-primary, .btn-tertiary, .btn-icon, .btn-actions, .btn-menu, .btn-split';\n    $(self.buttonSelector, self.table).button();\n\n    this.handlePaging();\n    this.triggerSource('initial');\n  },\n\n  /**\n  * If the datagrid is a html table, convert that table to an internal dataset to use.\n  * @private\n  * @returns {void}\n  */\n  htmlToDataset() {\n    const rows = $(this.element).find('tbody tr');\n    const self = this;\n    const specifiedCols = (self.settings.columns.length > 0);\n    const dataset = [];\n\n    // Geneate the columns if not supplier\n    if (!specifiedCols) {\n      const headers = $(this.element).find('thead th');\n      const firstRow = self.element.find('tbody tr:first()');\n\n      headers.each((i, col) => {\n        const colSpecs = {};\n        const column = $(col);\n        const colName = `column${i}`;\n\n        colSpecs.id = column.text().toLowerCase();\n        colSpecs.name = column.text();\n        colSpecs.field = colName;\n\n        const link = firstRow.find('td').eq(i).find('a');\n        if (link.length > 0) {\n          colSpecs.formatter = Formatters.Hyperlink;\n          colSpecs.href = link.attr('href');\n        }\n\n        self.settings.columns.push(colSpecs);\n      });\n    }\n\n    rows.each(function () {\n      const cols = $(this).find('td');\n      const newRow = {};\n\n      cols.each((i, col) => {\n        const column = $(col);\n        const colName = `column${i}`;\n\n        if (self.settings.columns[i].formatter) {\n          newRow[colName] = column.text();\n        } else {\n          newRow[colName] = column.html();\n        }\n\n        if (specifiedCols) {\n          self.settings.columns[i].field = colName;\n        }\n      });\n\n      dataset.push(newRow);\n    });\n\n    return dataset;\n  },\n\n  /**\n  * Add a row of data to the grid and dataset.\n  * @param {object} data An data row object\n  * @param {string} location Where to add the row. This can be 'bottom' or 'top', default is top.\n  */\n  addRow(data, location) {\n    const self = this;\n    let isTop = false;\n    let row = 0;\n    const cell = 0;\n    let args;\n    let rowNode;\n\n    if (!location || location === 'top') {\n      location = 'top';\n      isTop = true;\n    }\n    // Add row status\n    data.rowStatus = { icon: 'new', text: Locale.translate('New'), tooltip: Locale.translate('New') };\n\n    // Add to array\n    if (typeof location === 'string') {\n      self.settings.dataset[isTop ? 'unshift' : 'push'](data);\n    } else {\n      self.settings.dataset.splice(location, 0, data);\n    }\n\n    // Add to ui\n    self.renderRows();\n\n    // Sync with others\n    self.syncSelectedUI();\n\n    // Set active and fire handler\n    setTimeout(() => {\n      row = isTop ? row : self.settings.dataset.length - 1;\n      self.setActiveCell(row, cell);\n\n      rowNode = self.tableBody.find(`tr[aria-rowindex=\"${row + 1}\"]`);\n      args = { row, cell, target: rowNode, value: data, oldValue: {} };\n\n      self.pagerRefresh(location);\n\n      /**\n       * Fires after a row is added via the api.\n      * @event addrow\n      * @memberof Datagrid\n      * @property {object} event The jquery event object\n      * @property {number} args.row The row index\n      * @property {number} args.cell The cell index\n      * @property {HTMLElement} args.target The html element.\n      * @property {object} args.value - An object all the row data.\n      * @property {object} args.oldValue - Always an empty object added for consistent api.\n      */\n      self.element.triggerHandler('addrow', args);\n    }, 100);\n  },\n\n  /**\n  * Refresh the pager based on the current page and dataset.\n  * @private\n  * @param {object} location Deprecated - Can be set to 'top' or left off for bottom pager.\n  */\n  pagerRefresh(location) {\n    if (!this.pagerAPI) {\n      return;\n    }\n\n    const pagingInfo = {};\n\n    if (typeof location === 'string') {\n      pagingInfo.activePage = location === 'top' ? 1 : this.pagerAPI._pageCount;\n    } else if (typeof location === 'number') {\n      pagingInfo.activePage = Math.floor(location / (this.pagerAPI.settings.pagesize + 1));\n    }\n\n    if (!this.settings.source) {\n      pagingInfo.total = this.settings.dataset.length;\n      pagingInfo.pagesize = this.settings.pagesize;\n    }\n    this.renderPager(pagingInfo, true);\n  },\n\n  /**\n  * Remove a row of data to the grid and dataset.\n  * @param {number} row The row index\n  * @param {boolean} nosync Dont sync the selected rows.\n  */\n  removeRow(row, nosync) {\n    const rowNode = this.tableBody.find(`tr[aria-rowindex=\"${row + 1}\"]`);\n    const rowData = this.settings.dataset[row];\n\n    this.unselectRow(row, nosync);\n    this.settings.dataset.splice(row, 1);\n    this.renderRows();\n\n    /**\n    *  Fires after a row is removed via the api\n    * @event rowremove\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Object with the arguments\n    * @property {number} args.row The row index\n    * @property {number} args.cell The cell index\n    * @property {HTMLElement} args.target The row node that is being dragged.\n    * @property {HTMLElement} args.item The dragged rows data.\n    */\n    this.element.trigger('rowremove', { row, cell: null, target: rowNode, item: rowData, oldValue: rowData });\n  },\n\n  /**\n  * Remove all selected rows from the grid and dataset.\n  */\n  removeSelected() {\n    this._selectedRows.sort((a, b) => (a.idx < b.idx ? -1 : (a.idx > b.idx ? 1 : 0)));\n\n    for (let i = this._selectedRows.length - 1; i >= 0; i--) {\n      this.removeRow(this._selectedRows[i].idx, true);\n    }\n    this.pagerRefresh();\n    this.syncSelectedUI();\n  },\n\n  /**\n  * Send in a new data set to display in the datagrid.\n  * @param {object} dataset The array of objects to show in the grid. Should match\n  * the column definitions.\n  * @param {object} pagerInfo The pager info object with information like activePage ect.\n  */\n  updateDataset(dataset, pagerInfo) {\n    if (this.settings.toolbar && this.settings.toolbar.keywordFilter) {\n      const searchField = this.element.parent().find('.toolbar').find('.searchfield');\n      searchField.val('');\n      searchField.parent().removeClass('has-text');\n\n      this.clearFilter();\n    }\n\n    this.loadData(dataset, pagerInfo);\n  },\n\n  /**\n  * Trigger the source method to call to the backend on demand.\n  * @param {object|string} [pagerType=undefined] The pager info object with information like activePage ect.\n  * @param {function} callback The call back functions\n  * @param {string} [op=undefined] an optional info string that can be applied to identify which operation cause the source call\n  */\n  triggerSource(pagerType, callback, op) {\n    if (!this.settings.source) {\n      return;\n    }\n\n    const self = this;\n    let pagingInfo = {};\n    if (this.pagerAPI) {\n      pagingInfo = this.pagerAPI.state;\n    }\n\n    if (typeof pagerType === 'string') {\n      pagingInfo.type = pagerType;\n      pagingInfo.trigger = op;\n    } else if (pagerType) {\n      pagingInfo = utils.extend({}, pagingInfo, pagerType);\n    }\n\n    if (callback && typeof callback !== 'function') {\n      if (typeof callback.type === 'string') {\n        pagingInfo.type = callback.type;\n      }\n    }\n\n    /**\n    * Fires just before changing page. Returning false from the request function will cancel paging.\n    * @event beforepaging\n    * @memberof Pager\n    * @property {object} event - The jquery event object\n    * @property {function} request - The paging request info\n    */\n    const doPaging = this.element.triggerHandler('beforepaging', pagingInfo);\n    if (doPaging === false) {\n      return;\n    }\n\n    function response(data, updatedPagingInfo) {\n      if (updatedPagingInfo.activePage > -1) {\n        self.activePage = updatedPagingInfo.activePage;\n      }\n\n      if (updatedPagingInfo.grandTotal) {\n        self.grandTotal = updatedPagingInfo.grandTotal;\n      }\n\n      // Set the remote dataset on the grid\n      self.loadData(data, updatedPagingInfo);\n\n      if (callback && typeof callback === 'function') {\n        callback(true);\n      }\n\n      /**\n      * Fires after changing paging has completed.\n      * @event afterpaging\n      * @memberof Pager\n      * @property {object} event - The jquery event object\n      * @property {object} pagingInfo - The paging info object\n      */\n      self.element.trigger('afterpaging', pagingInfo);\n    }\n\n    if (this.sortColumn && this.sortColumn.sortId) {\n      pagingInfo.sortAsc = this.sortColumn.sortAsc;\n      pagingInfo.sortField = this.sortColumn.sortField;\n      pagingInfo.sortId = this.sortColumn.sortId;\n    }\n\n    if (this.filterExpr && this.filterExpr.length) {\n      pagingInfo.filterExpr = this.filterExpr;\n    }\n\n    /**\n     * Fires when change page.\n     * @event paging\n     * @memberof Pager\n     * @property {object} event The jquery event object\n     * @property {object} request The paging request object\n     */\n    this.element.trigger('paging', pagingInfo);\n\n    this.settings.source(pagingInfo, response);\n  },\n\n  /**\n  * Send in a new data set to display in the datagrid. Use better named updateDataset\n  * @private\n  * @param {object} dataset The array of objects to show in the grid.\n  * Should match the column definitions.\n  * @param {object} pagerInfo The pager info object with information like activePage ect.\n  */\n  loadData(dataset, pagerInfo) {\n    this.settings.dataset = dataset;\n\n    if (!pagerInfo) {\n      pagerInfo = {};\n    }\n\n    if (pagerInfo.type === 'filterrow') {\n      pagerInfo.activePage = this.pagerAPI && this.pagerAPI.activePage || 1;\n      pagerInfo.pagesize = this.settings.pagesize;\n      pagerInfo.total = pagerInfo.total || -1;\n      pagerInfo.type = 'filterrow';\n    }\n\n    if (!pagerInfo.activePage) {\n      pagerInfo.activePage = 1;\n      pagerInfo.pagesize = this.settings.pagesize;\n      pagerInfo.total = -1;\n      pagerInfo.type = 'initial';\n      if (this.settings.treeGrid) {\n        pagerInfo.preserveSelected = true;\n      }\n    }\n\n    if (this.settings.source && pagerInfo.grandTotal) {\n      this.grandTotal = pagerInfo.grandTotal;\n    } else {\n      this.grandTotal = null;\n    }\n\n    if (this.pagerAPI) {\n      if (this.settings.showDirty && this.settings.source &&\n        /first|last|next|prev|sorted/.test(pagerInfo.type)) {\n        this.dirtyArray = undefined;\n      }\n    }\n\n    // Update Paging and Clear Rows\n    this.setTreeDepth();\n    this.setRowGrouping();\n    this.setTreeRootNodes();\n\n    // Figure out whether or not to preserve previously selected rows\n    if (pagerInfo.preserveSelected === undefined) {\n      if (this.settings.source) {\n        this._selectedRows = [];\n      } else if (pagerInfo.type === 'initial') {\n        this.unSelectAllRows();\n      }\n    } else if (pagerInfo.preserveSelected === false) {\n      if (this.settings.source) {\n        this._selectedRows = [];\n      } else {\n        this.unSelectAllRows();\n      }\n    }\n\n    if (this.settings.disableClientFilter) {\n      this.restoreFilter = true;\n      this.restoreSortOrder = true;\n      this.savedFilter = this.filterConditions();\n      this.restoreFilterClientSide = true;\n    }\n\n    // Resize and re-render if have a new dataset\n    // (since automatic column sizing depends on the dataset)\n    if (pagerInfo.type === 'initial') {\n      this.clearHeaderCache();\n      this.restoreUserSettings();\n      this.renderRows();\n      this.renderHeader();\n    } else {\n      this.renderRows();\n    }\n\n    // Setup focus on the first cell\n    this.cellNode(0, 0, true).attr('tabindex', '0');\n    this.renderPager(pagerInfo, true);\n    this.syncSelectedUI();\n    this.displayCounts();\n  },\n\n  /**\n  * Generate a unique id based on the page and grid count. Add a suffix.\n  * @private\n  * @param {object} suffix Add this string to make the id more unique\n  * @returns {string} The unique id.\n  */\n  uniqueId(suffix) {\n    suffix = (suffix === undefined || suffix === null) ? '' : suffix;\n    const uniqueid = this.settings.uniqueId ?\n      `${this.settings.uniqueId}-${suffix}` :\n      (`${window.location.pathname.split('/').pop()\n        .replace(/\\.xhtml|\\.shtml|\\.html|\\.htm|\\.aspx|\\.asp|\\.jspx|\\.jsp|\\.php/g, '')\n        .replace(/[^-\\w]+/g, '')\n        .replace(/\\./g, '-')\n        .replace(/ /g, '-')\n        .replace(/%20/g, '-')}-${\n        this.element.attr('id') || 'datagrid'}-${this.gridCount || 0}${suffix}`);\n\n    return uniqueid.replace(/--/g, '-');\n  },\n\n  /**\n  * Returns an array with all visible columns.\n  * @param {boolean} skipBuiltIn If true then built in columns like selectionCheckbox are skipped.\n  * @returns {array} An array with the visible columns.\n  */\n  visibleColumns(skipBuiltIn) {\n    const visible = [];\n    for (let j = 0; j < this.settings.columns.length; j++) {\n      const column = this.settings.columns[j];\n\n      if (column.hidden) {\n        continue;\n      }\n\n      if (skipBuiltIn && column.id === 'selectionCheckbox') {\n        continue;\n      }\n      visible.push(column);\n    }\n    return visible;\n  },\n\n  /**\n  * Returns the index of the last column.\n  * @private\n  * @returns {number} The last columns index.\n  */\n  lastColumnIdx() {\n    let last = 0;\n\n    if (this.lastColumn) {\n      return this.lastColumn;\n    }\n\n    for (let j = 0; j < this.settings.columns.length; j++) {\n      const column = this.settings.columns[j];\n\n      if (column.hidden) {\n        continue;\n      }\n\n      last = j;\n    }\n\n    this.lastColumn = last;\n    return last;\n  },\n\n  /**\n  * Gets an if for the column group used for grouped headers.\n  * @private\n  * @param {object} idx The index of the column group\n  * @returns {string} The name of the column group\n  */\n  getColumnGroup(idx) {\n    let total = 0;\n    const colGroups = this.settings.columnGroups;\n\n    for (let l = 0; l < colGroups.length; l++) {\n      if (colGroups[l].hidden) {\n        continue;\n      }\n      total += colGroups[l].colspan;\n\n      if (total >= idx) {\n        return this.uniqueId(`-header-group-${l}`);\n      }\n    }\n\n    return '';\n  },\n\n  /**\n  * Gets an if for the column group used for grouped headers.\n  * @private\n  * @param {number} idx The index of the column group\n  * @param {boolean} show Did we show or hide the col.\n  */\n  updateColumnGroup() {\n    const colGroups = this.settings.columnGroups;\n    if (!this.originalColGroups) {\n      this.originalColGroups = JSON.parse(JSON.stringify(colGroups));\n    }\n\n    if (this.settings.groupable) {\n      // need to rerender here to get the colspans correct.\n      const groupHeaders = this.tableBody.find('.datagrid-rowgroup-header');\n      const newColspan = this.visibleColumns().length;\n\n      for (let i = 0; i < groupHeaders.length; i++) {\n        groupHeaders[i].children[0].setAttribute('colspan', newColspan);\n      }\n      return;\n    }\n\n    if (!colGroups) {\n      return;\n    }\n\n    // Update the dom\n    if (!this.colGroups) {\n      return;\n    }\n\n    const headGroups = [].slice.call(this.colGroups[0].querySelectorAll('th'));\n    const columns = this.settings.columns;\n    const columnsLen = columns.length;\n    const visibleColumnsLen = this.visibleColumns().length;\n    const groups = colGroups.map(group => parseInt(group.colspan, 10));\n    const getGroupsTotal = () => groups.reduce((a, b) => a + b, 0);\n    const getDiff = () => {\n      const groupsTotal = getGroupsTotal();\n      return groupsTotal > columnsLen ? groupsTotal - columnsLen : columnsLen - groupsTotal;\n    };\n\n    const groupsTotal = getGroupsTotal();\n    let diff;\n    if (groupsTotal > columnsLen) {\n      let move = true;\n      for (let i = groups.length - 1; i >= 0 && move; i--) {\n        diff = getDiff();\n        if (groups[i] >= diff) {\n          groups[i] -= diff;\n          move = false;\n        } else {\n          groups[i] = 0;\n        }\n      }\n    }\n\n    let i = 0;\n    let total = 0;\n    groups.forEach((groupColspan, k) => {\n      let colspan = groupColspan;\n      for (let l = i + groupColspan; i < l; i++) {\n        if (i < columnsLen && columns[i].hidden) {\n          colspan--;\n        }\n      }\n\n      if (colspan > 0) {\n        total += colspan;\n      }\n\n      const groupHeaderEl = headGroups[k];\n      groupHeaderEl.setAttribute('colspan', colspan > 0 ? colspan : 1);\n\n      if ((colGroups[k].hidden || colspan < 1)) {\n        groupHeaderEl.classList.add('hidden');\n      } else {\n        groupHeaderEl.classList.remove('hidden');\n      }\n    });\n\n    if (total < visibleColumnsLen) {\n      const groupHeaderEl = headGroups[headGroups.length - 1];\n      diff = visibleColumnsLen - total;\n      groupHeaderEl.setAttribute('colspan', diff > 0 ? diff : 1);\n    }\n  },\n\n  /**\n  * Update group headers after column reorder/dragged.\n  * @private\n  * @param {number} indexFrom The column index dragged from.\n  * @param {number} indexTo The column index dragged to.\n  * @returns {void}\n  */\n  updateGroupHeadersAfterColumnReorder(indexFrom, indexTo) {\n    const colGroups = this.settings.columnGroups;\n    if (!colGroups) {\n      return;\n    }\n\n    if (!this.originalColGroups) {\n      this.originalColGroups = JSON.parse(JSON.stringify(colGroups));\n    }\n\n    const groups = colGroups.map(group => parseInt(group.colspan, 10));\n    const changed = { from: null, to: null, total: 0 };\n\n    groups.forEach((colspan, i) => {\n      changed.total += colspan;\n\n      if (changed.total > indexFrom && changed.from === null) {\n        changed.from = i;\n      }\n      if (changed.total > indexTo && changed.to === null) {\n        changed.to = i;\n      }\n    });\n\n    if (changed.from !== changed.to) {\n      colGroups[changed.from].colspan -= 1;\n      colGroups[changed.to].colspan += 1;\n    }\n  },\n\n  /**\n  * Returns the text for a header adding built in defaults\n  * @private\n  * @param {object} col The column id.\n  * @returns {string} The current header text\n  */\n  headerText(col) {\n    let text = col.name ? col.name : '';\n\n    if (!text && col.id === 'drilldown') {\n      text = Locale.translate('Drilldown');\n      return `<span class=\"audible\">${text}</span>`;\n    }\n\n    return text;\n  },\n\n  /**\n   * Get the name of the container (left, right, center) that this column will appear in.\n   * @private\n   * @param  {string} id The column id to check using the id property.\n   * @returns {string} The container that the column appears in.\n   */\n  getContainer(id) {\n    if (this.settings.frozenColumns.left && this.settings.frozenColumns.left.indexOf(id) > -1) {\n      return 'left';\n    }\n    if (this.settings.frozenColumns.right && this.settings.frozenColumns.right.indexOf(id) > -1) {\n      return 'right';\n    }\n    return 'center';\n  },\n\n  /**\n  * Render the header area.\n  * @private\n  */\n  renderHeader() {\n    const self = this;\n    const headerRows = { left: '', center: '', right: '' };\n    const headerColGroups = { left: '<colgroup>', center: '<colgroup>', right: '<colgroup>' };\n    const headerColGroupCols = { left: '', center: '', right: '' };\n    let uniqueId;\n\n    // Handle Nested Headers\n    const colGroups = this.settings.columnGroups;\n    if (colGroups) {\n      this.element.addClass('has-group-headers');\n\n      const columns = this.settings.columns;\n      const columnsLen = columns.length;\n      const visibleColumnsLen = this.visibleColumns().length;\n      const groups = colGroups.map(group => parseInt(group.colspan, 10));\n      const getGroupsTotal = () => groups.reduce((a, b) => a + b, 0);\n      const getDiff = () => {\n        const groupsTotal = getGroupsTotal();\n        return groupsTotal > columnsLen ? groupsTotal - columnsLen : columnsLen - groupsTotal;\n      };\n\n      headerRows.left += '<tr role=\"row\" class=\"datagrid-header-groups\">';\n      headerRows.center += '<tr role=\"row\" class=\"datagrid-header-groups\">';\n      headerRows.right += '<tr role=\"row\" class=\"datagrid-header-groups\">';\n\n      const groupsTotal = getGroupsTotal();\n      let diff;\n      if (groupsTotal > columnsLen) {\n        let move = true;\n        for (let i = groups.length - 1; i >= 0 && move; i--) {\n          diff = getDiff();\n          if (groups[i] >= diff) {\n            groups[i] -= diff;\n            move = false;\n          } else {\n            groups[i] = 0;\n          }\n        }\n      }\n\n      let i = 0;\n      let total = 0;\n      groups.forEach((groupColspan, k) => {\n        let colspan = groupColspan;\n        for (let l = i + groupColspan; i < l; i++) {\n          if (i < columnsLen && columns[i].hidden) {\n            colspan--;\n          }\n        }\n        const hiddenStr = colGroups[k].hidden || colspan < 1 ? ' class=\"hidden\"' : '';\n        const colspanStr = ` colspan=\"${colspan > 0 ? colspan : 1}\"`;\n        const groupedHeaderAlignmentClass = colGroups[k].align ? `l-${colGroups[k].align}-text` : '';\n        uniqueId = self.uniqueId(`-header-group-${k}`);\n        if (colspan > 0) {\n          total += colspan;\n        }\n\n        headerRows.center += `<th${hiddenStr}${colspanStr} id=\"${uniqueId}\" class=\"${groupedHeaderAlignmentClass}\"><div class=\"datagrid-column-wrapper\"><span class=\"datagrid-header-text\">${colGroups[k].name}</span></div></th>`;\n      });\n\n      if (total < visibleColumnsLen) {\n        diff = visibleColumnsLen - total;\n        const colspanStr = ` colspan=\"${diff > 0 ? diff : 1}\"`;\n        headerRows.center += `<th${colspanStr}></th>`;\n      }\n      headerRows.center += '</tr><tr>';\n    } else {\n      headerRows.left += '<tr role=\"row\">';\n      headerRows.center += '<tr role=\"row\">';\n      headerRows.right += '<tr role=\"row\">';\n    }\n\n    for (let j = 0; j < this.settings.columns.length; j++) {\n      const column = self.settings.columns[j];\n      const container = self.getContainer(column.id);\n      const id = self.uniqueId(`-header-${j}`);\n      const isSortable = (column.sortable === undefined ? true : column.sortable);\n      const isResizable = (column.resizable === undefined ? true : column.resizable);\n      const isExportable = (column.exportable === undefined ? true : column.exportable);\n      const isSelection = column.id === 'selectionCheckbox';\n      const headerAlignmentClass = this.getHeaderAlignmentClass(column);\n\n      // Make frozen columns hideable: false\n      if ((self.hasLeftPane || self.hasRightPane)\n        && (self.settings.frozenColumns.left &&\n          self.settings.frozenColumns.left.indexOf(column.id) > -1 ||\n        self.settings.frozenColumns.right &&\n        self.settings.frozenColumns.right.indexOf(column.id) > -1)) {\n        column.hideable = false;\n      }\n\n      // Assign css classes\n      let cssClass = '';\n      cssClass += isSortable ? ' is-sortable' : '';\n      cssClass += isResizable ? ' is-resizable' : '';\n      cssClass += column.hidden ? ' is-hidden' : '';\n      cssClass += column.filterType ? ' is-filterable' : '';\n      cssClass += column.textOverflow === 'ellipsis' ? ' text-ellipsis' : '';\n      cssClass += headerAlignmentClass !== '' ? headerAlignmentClass : '';\n\n      // Apply css classes\n      cssClass = cssClass !== '' ? ` class=\"${cssClass.substr(1)}\"` : '';\n\n      headerRows[container] += `<th scope=\"col\" role=\"columnheader\" id=\"${id}\" data-column-id=\"${column.id}\"${column.field ? ` data-field=\"${column.field}\"` : ''}${column.headerTooltip ? ` title=\"${column.headerTooltip}\"` : ''}${column.reorderable === false ? ' data-reorder=\"false\"' : ''}${colGroups ? ` headers=\"${self.getColumnGroup(j)}\"` : ''} data-exportable=\"${isExportable ? 'yes' : 'no'}\"${cssClass}>`;\n\n      let sortIndicator = '';\n      if (isSortable) {\n        sortIndicator = `${'<div class=\"sort-indicator\">' +\n          '<span class=\"sort-asc\">'}${$.createIcon({ icon: 'dropdown' })}</span>` +\n          `<span class=\"sort-desc\">${$.createIcon({ icon: 'dropdown' })}</div>`;\n      }\n\n      // If header text is center aligned, for proper styling,\n      // place the sortIndicator as a child of datagrid-header-text.\n      headerRows[container] += `<div class=\"${isSelection ? 'datagrid-checkbox-wrapper ' : 'datagrid-column-wrapper'}${headerAlignmentClass}\">\n      <span class=\"datagrid-header-text${column.required ? ' required' : ''}\">${self.headerText(this.settings.columns[j])}${headerAlignmentClass === ' l-center-text' ? sortIndicator : ''}</span>`;\n      headerColGroupCols[container] += `<col${this.columnWidth(column, j)}${column.hidden ? ' class=\"is-hidden\"' : ''}>`;\n\n      if (isSelection) {\n        if (self.settings.showSelectAllCheckBox) {\n          headerRows[container] += '<span aria-checked=\"false\" class=\"datagrid-checkbox\" aria-label=\"Selection\" role=\"checkbox\"></span>';\n        } else {\n          headerRows[container] += '<span aria-checked=\"false\" class=\"datagrid-checkbox\" aria-label=\"Selection\" role=\"checkbox\" style=\"display:none\"></span>';\n        }\n      }\n\n      // Note the space in classname.\n      // Place sortIndicator via concatenation if\n      // header text is not center aligned.\n      if (isSortable && headerAlignmentClass !== ' l-center-text') {\n        headerRows[container] += sortIndicator;\n      }\n\n      headerRows[container] += `</div>${self.filterRowHtml(column, j)}</th>`;\n    }\n    headerRows.left += '</tr>';\n    headerRows.center += '</tr>';\n    headerRows.right += '</tr>';\n\n    headerColGroups.left += `${headerColGroupCols.left}</colgroup>`;\n    headerColGroups.center += `${headerColGroupCols.center}</colgroup>`;\n    headerColGroups.right += `${headerColGroupCols.right}</colgroup>`;\n\n    // Set Up Header Panes\n    if (self.headerRow === undefined) {\n      self.headerContainer = $('<div class=\"datagrid-header-container\"></div>').prependTo(self.element);\n      const headerHtml = '<div class=\"datagrid-header\"><table role=\"grid\"></table></div>';\n\n      if (self.hasLeftPane) {\n        self.headerContainerLeft = $(headerHtml).addClass('left');\n        self.headerContainer.append(self.headerContainerLeft);\n        self.headerTableLeft = self.headerContainerLeft.find('table');\n        self.headerTableLeft.width(this.headerTableWidth('left'));\n        self.headerTableLeft.css('min-width', this.headerTableMinWidth('left'));\n        self.headerColGroupLeft = $(headerColGroups.left).appendTo(self.headerTableLeft);\n        DOM.append(self.headerContainerLeft.find('table'), `<thead>${headerRows.left}</thead>`, '*');\n        self.headerRowLeft = self.headerContainerLeft.find('thead');\n      }\n\n      self.headerContainerCenter = $(headerHtml).addClass('center');\n      self.headerContainer.append(self.headerContainerCenter);\n      self.headerTable = self.headerContainerCenter.find('table');\n      self.headerTable.width(this.headerTableWidth('center'));\n      self.headerTable.css('min-width', this.headerTableMinWidth('center'));\n      self.headerColGroup = $(headerColGroups.center).appendTo(self.headerTable);\n      DOM.append(self.headerContainerCenter.find('table'), `<thead>${headerRows.center}</thead>`, '*');\n      self.headerRow = self.headerContainerCenter.find('thead');\n\n      if (self.hasRightPane) {\n        self.headerContainerRight = $(headerHtml).addClass('right');\n        self.headerContainer.append(self.headerContainerRight);\n        self.headerTableRight = self.headerContainerRight.find('table');\n        self.headerTableRight.width(this.headerTableWidth('right'));\n        self.headerTableRight.css('min-width', this.headerTableMinWidth('right'));\n        self.headerColGroupRight = self.hasRightPane ? $(headerColGroups.right).appendTo(self.headerTableRight) : '';\n        DOM.append(self.headerContainerRight.find('table'), `<thead>${headerRows.right}</thead>`, '*');\n        self.headerRowRight = self.headerContainerRight.find('thead');\n      }\n    } else {\n      if (self.hasLeftPane) {\n        self.headerTableLeft.width(this.headerTableWidth('left'));\n        self.headerTableLeft.css('min-width', this.headerTableMinWidth('left'));\n        DOM.html(self.headerRowLeft, headerRows.left, '*');\n        self.headerColGroupLeft.html(headerColGroupCols.left);\n      }\n\n      self.headerTable.width(this.headerTableWidth('center'));\n      self.headerTable.css('min-width', this.headerTableMinWidth('center'));\n      DOM.html(self.headerRow, headerRows.center, '*');\n      self.headerColGroup.html(headerColGroupCols.center);\n\n      if (self.hasRightPane) {\n        self.headerTableRight.width(this.headerTableWidth('right'));\n        self.headerTableRight.css('min-width', this.headerTableMinWidth('right'));\n        DOM.html(self.headerRowRight, headerRows.right, '*');\n        self.headerColGroupRight.html(headerColGroupCols.right);\n      }\n    }\n\n    if (colGroups && self.headerRow) {\n      self.colGroups = self.headerRow.find('.datagrid-header-groups');\n    }\n\n    self.syncHeaderCheckbox(this.settings.dataset);\n    self.setScrollClass();\n    self.attachFilterRowEvents();\n\n    if (self.settings.columnReorder) {\n      self.createDraggableColumns();\n    }\n\n    if (this.restoreSortOrder) {\n      this.setSortIndicator(this.sortColumn.sortId, this.sortColumn.sortAsc);\n      this.restoreSortOrder = false;\n    }\n\n    if (this.restoreFilter) {\n      this.applyFilter(this.savedFilter, 'render');\n      this.restoreFilter = false;\n      this.savedFilter = null;\n    }\n\n    this.activeEllipsisHeaderAll();\n  },\n\n  /**\n   * Get the alignment class based on settings. Note there is a space at the front of the classname.\n   * @private\n   * @param {object} column The column info.\n   * @returns {string} The class as a string.\n   */\n  getHeaderAlignmentClass(column) {\n    let headerAlignmentClass = '';\n\n    if (column.headerAlign === undefined) {\n      headerAlignmentClass = column.align ? ` l-${column.align}-text` : '';\n    } else {\n      headerAlignmentClass = ` l-${column.headerAlign}-text`;\n    }\n    return headerAlignmentClass;\n  },\n\n  /**\n  * Set filter datepicker with range/single date.\n  * @private\n  * @param {object} input element to target datepicker.\n  * @param {string} operator filter type.\n  * @param {object} options pass in to datepicker.\n  * @returns {void}\n  */\n  filterSetDatepicker(input, operator, options) {\n    const datepickerApi = input.data('datepicker');\n    const isRange = input.data('is-range');\n    options = options || {};\n\n    // Init datepicker\n    const initDatepicker = function () {\n      if (datepickerApi && typeof datepickerApi.destroy === 'function') {\n        datepickerApi.destroy();\n      }\n      input.datepicker(options);\n    };\n\n    // invoke datepicker\n    if ((!datepickerApi || !isRange) && operator === 'in-range') {\n      input.data('is-range', true);\n      options.range = { useRange: true };\n      initDatepicker();\n    } else if ((!datepickerApi || isRange) && operator !== 'in-range') {\n      options.range = { useRange: false };\n      input.removeData('is-range');\n      initDatepicker();\n    }\n  },\n\n  /**\n  * Returns the markup for a specific filter row area.\n  * @private\n  * @param {object} columnDef The column object for the header\n  * @param {object} idx The column idx for the header\n  * @returns {string} The filter html to use\n  */\n  filterRowHtml(columnDef, idx) {\n    const self = this;\n    let filterMarkup = '';\n    const headerAlignmentClass = this.getHeaderAlignmentClass(columnDef);\n\n    // Generate the markup for the various Types\n    // Supported Filter Types: text, integer, date, select, decimal,\n    // lookup, percent, checkbox, contents\n    if (columnDef.filterType) {\n      const col = columnDef;\n      const filterId = self.uniqueId(`-header-filter-${idx}`);\n      let integerDefaults;\n\n      filterMarkup = `<div class=\"datagrid-filter-wrapper${headerAlignmentClass}\" ${!self.settings.filterable ? ' style=\"display:none\"' : ''}>${self.filterButtonHtml(col)}<label class=\"audible\" for=\"${filterId}\">${\n        col.name}</label>`;\n\n      switch (col.filterType) {\n        case 'checkbox':\n          // just the button\n          break;\n        case 'date':\n          filterMarkup += `<input ${col.filterDisabled ? ' disabled' : ''} type=\"text\" class=\"datepicker\" id=\"${filterId}\"/>`;\n          break;\n        case 'integer': {\n          integerDefaults = {\n            patternOptions: {\n              allowNegative: true,\n              allowThousandsSeparator: false,\n              allowDecimal: false,\n              symbols: {\n                thousands: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.group : ',',\n                decimal: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.decimal : '.',\n                negative: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.minusSign : '-'\n              }\n            },\n            process: 'number'\n          };\n\n          col.maskOptions = utils.extend(true, {}, integerDefaults, col.maskOptions);\n          filterMarkup += `<input${col.filterDisabled ? ' disabled' : ''} type=\"text\" id=\"${filterId}\" />`;\n          break;\n        }\n        case 'percent':\n        case 'decimal': {\n          const decimalDefaults = {\n            patternOptions: {\n              allowNegative: true,\n              allowDecimal: true,\n              symbols: {\n                thousands: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.group : ',',\n                decimal: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.decimal : '.',\n                negative: Locale.currentLocale.data.numbers ? Locale.currentLocale.data.numbers.minusSign : '-'\n              }\n            },\n            process: 'number'\n          };\n\n          if (col.numberFormat) {\n            integerDefaults = {\n              patternOptions: { decimalLimit: col.numberFormat.maximumFractionDigits }\n            };\n\n            col.maskOptions = utils.extend(\n              true,\n              {},\n              integerDefaults,\n              decimalDefaults,\n              col.maskOptions\n            );\n          } else {\n            col.maskOptions = utils.extend(true, {}, decimalDefaults, col.maskOptions);\n          }\n\n          filterMarkup += `<input${col.filterDisabled ? ' disabled' : ''} type=\"text\" id=\"${filterId}\" />`;\n          break;\n        }\n        case 'contents':\n        case 'select':\n\n          filterMarkup += `<select ${col.filterDisabled ? ' disabled' : ''}${col.filterType === 'select' ? ' class=\"dropdown\"' : ' multiple class=\"multiselect\"'}id=\"${filterId}\">`;\n          if (col.options) {\n            if (col.filterType === 'select') {\n              filterMarkup += '<option></option>';\n            }\n\n            for (let i = 0; i < col.options.length; i++) {\n              const option = col.options[i];\n              const optionValue = col.caseInsensitive && typeof option.value === 'string' ? option.value.toLowerCase() : option.value;\n              if (option && optionValue !== '') {\n                filterMarkup += `<option value = \"${optionValue}\">${option.label}</option>`;\n              }\n            }\n          }\n          filterMarkup += '</select><div class=\"dropdown-wrapper\"><div class=\"dropdown\"><span></span></div><svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-dropdown\"></use></svg></div>';\n\n          break;\n        case 'multiselect':\n          filterMarkup += `<select ${col.filterDisabled ? ' disabled' : ''}${col.filterType === 'select' ? ' class=\"dropdown\"' : ' multiple class=\"multiselect\"'}id=\"${filterId}\">`;\n          if (col.options) {\n            for (let i = 0; i < col.options.length; i++) {\n              const option = col.options[i];\n              const optionValue = col.caseInsensitive && typeof option.value === 'string' ? option.value.toLowerCase() : option.value;\n              if (option && option.label) {\n                filterMarkup += `<option value = \"${optionValue}\">${option.label}</option>`;\n              }\n            }\n          }\n          filterMarkup += '</select><div class=\"dropdown-wrapper\"><div class=\"dropdown\"><span></span></div><svg class=\"icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-dropdown\"></use></svg></div>';\n\n          break;\n        case 'time':\n          filterMarkup += `<input ${col.filterDisabled ? ' disabled' : ''} type=\"text\" class=\"timepicker\" id=\"${filterId}\"/>`;\n          break;\n        case 'lookup':\n          filterMarkup += `<input ${col.filterDisabled ? ' disabled' : ''} type=\"text\" class=\"lookup\" id=\"${filterId}\" >`;\n          break;\n        default:\n          filterMarkup += `<input${col.filterDisabled ? ' disabled' : ''} type=\"text\" id=\"${filterId}\"/>`;\n          break;\n      }\n\n      filterMarkup += '</div>';\n    }\n\n    if (!columnDef.filterType && this.settings.filterable) {\n      filterMarkup = `<div class=\"datagrid-filter-wrapper is-empty ${headerAlignmentClass}\"></div>`;\n    }\n    return filterMarkup;\n  },\n\n  /**\n  * Attach Events and initialize plugins for the filter row.\n  * @private\n  */\n  attachFilterRowEvents() {\n    const self = this;\n\n    if (!this.settings.filterable) {\n      return;\n    }\n\n    this.element.addClass('has-filterable-columns');\n\n    if (this.settings.twoLineHeader) {\n      this.element.addClass('has-two-line-header');\n    }\n\n    // Attach Keyboard support\n    this.headerContainer.off('click.datagrid-filter').on('click.datagrid-filter', '.btn-filter', function () {\n      const popupOpts = { trigger: 'immediate', offset: { y: 15 }, placementOpts: { strategies: ['flip', 'nudge'] } };\n      const popupmenu = $(this).data('popupmenu');\n\n      if (popupmenu) {\n        popupmenu.close(true, true);\n      } else {\n        $(this).off('beforeopen.datagrid-filter').on('beforeopen.datagrid-filter', function () {\n          const menu = $(this).next('.popupmenu-wrapper');\n          utils.fixSVGIcons(menu);\n          self.hideTooltip();\n        }).popupmenu(popupOpts)\n          .off('selected.datagrid-filter')\n          .on('selected.datagrid-filter', (e, anchor) => {\n            const rowElem = anchor.closest('th[role=\"columnheader\"]');\n            const col = self.columnById(rowElem.attr('data-column-id'))[0];\n\n            // Set datepicker with range/single date\n            if (col && col.filterType === 'date') {\n              const input = rowElem.find('input');\n              const svg = rowElem.find('.btn-filter .icon-dropdown:first');\n              const operator = svg.getIconName().replace('filter-', '');\n              self.filterSetDatepicker(input, operator, col.editorOptions);\n            }\n            self.applyFilter(null, 'selected');\n          })\n          .off('close.datagrid-filter')\n          .on('close.datagrid-filter', function () {\n            const data = $(this).data('popupmenu');\n            if (data) {\n              data.destroy();\n            }\n          });\n      }\n      return false;\n    });\n\n    let typingTimer;\n    this.headerContainer.off('keydown.datagrid').on('keydown.datagrid', '.datagrid-filter-wrapper input', (e) => {\n      clearTimeout(typingTimer);\n      e.stopPropagation();\n\n      if (e.which === 13) {\n        self.applyFilter(null, 'enter');\n        e.preventDefault();\n        e.stopPropagation();\n        return false;\n      }\n      return true;\n    });\n\n    if (this.settings.filterWhenTyping) {\n      this.headerContainer.off('keyup.datagrid').on('keyup.datagrid', '.datagrid-filter-wrapper input', (e) => {\n        if (e.which === 13) {\n          return;\n        }\n\n        if (this.activeCell && this.activeCell.isFocused) {\n          this.activeCell.isFocused = false;\n        }\n\n        clearTimeout(typingTimer);\n        typingTimer = setTimeout(() => {\n          self.applyFilter(null, 'keyup');\n        }, 400);\n      });\n    }\n\n    this.headerContainer.find('tr:last th').each(function () {\n      const col = self.columnById($(this).attr('data-column-id'))[0];\n      const elem = $(this);\n\n      if (!col) { // No ID found\n        return true;\n      }\n\n      elem.find('select.dropdown').each(function () {\n        const dropdown = $(this);\n        dropdown.dropdown(col.editorOptions).on('selected.datagrid', () => {\n          self.applyFilter(null, 'selected');\n        }).on('listopened.datagrid', () => {\n          const api = dropdown.data('dropdown');\n          if (api) {\n            if (!self.isInViewport(api.list[0])) {\n              self.adjustPosLeft(api.list[0]);\n            }\n          }\n        });\n\n        // Append the Dropdown's sourceArguments with some row/col meta-data\n        const api = dropdown.data('dropdown');\n        api.settings.sourceArguments = {\n          column: col,\n          container: elem,\n          grid: self,\n          cell: col,\n          event: undefined,\n          row: -1,\n          rowData: {},\n          value: undefined\n        };\n      });\n\n      elem.find('select.multiselect').each(function () {\n        const multiselect = $(this);\n        multiselect.multiselect(col.editorOptions).on('selected.datagrid', () => {\n          self.applyFilter(null, 'selected');\n        });\n\n        // Append the Dropdown's sourceArguments with some row/col meta-data\n        const api = multiselect.data('dropdown');\n        api.settings.sourceArguments = {\n          column: col,\n          container: elem,\n          grid: self,\n          cell: col,\n          event: undefined,\n          row: -1,\n          rowData: {},\n          value: undefined\n        };\n      });\n\n      if (col.maskOptions) {\n        elem.find('input').mask(col.maskOptions);\n      }\n\n      if (col.mask) {\n        elem.find('input').mask(col.mask);\n      }\n\n      const datepickerEl = elem.find('.datepicker');\n      if (datepickerEl.length && typeof $().datepicker === 'function') {\n        datepickerEl\n          .datepicker(col.editorOptions || { dateFormat: col.dateFormat })\n          .on('listclosed.datepicker', () => {\n            self.applyFilter(null, 'selected');\n          });\n      }\n\n      const lookupEl = elem.find('.lookup');\n      if (lookupEl.length && typeof $().lookup === 'function') {\n        if (col.editorOptions) {\n          if (col.editorOptions.clickArguments) {\n            col.editorOptions.clickArguments.grid = self;\n          } else {\n            col.editorOptions.clickArguments = {\n              grid: self\n            };\n          }\n        }\n\n        lookupEl\n          .lookup(col.editorOptions || {})\n          .on('change', () => {\n            self.applyFilter(null, 'selected');\n          });\n      }\n\n      const timepickerEl = elem.find('.timepicker');\n      if (timepickerEl.length && typeof $().timepicker === 'function') {\n        timepickerEl.timepicker(col.editorOptions || { timeFormat: col.timeFormat });\n      }\n\n      // Attach Mask\n      if (col.mask) {\n        elem.find('input').mask({ pattern: col.mask, mode: col.maskMode });\n      }\n\n      return null;\n    });\n\n    self.filterRowRendered = true;\n  },\n\n  /**\n  * Render one filter item as used in renderFilterButton\n  * @private\n  * @param {object} icon The icon for the menu item\n  * @param {object} text The text for the menu item\n  * @param {object} checked If the menu item is selected\n  * @returns {string} The html for the filter item.\n  */\n  filterItemHtml(icon, text, checked) {\n    const iconMarkup = $.createIcon({ classes: 'icon icon-filter', icon: `filter-${icon}` });\n    return `<li ${checked ? 'class=\"is-checked\"' : ''}><a href=\"#\">${iconMarkup}<span>${Locale.translate(text)}</span></a></li>`;\n  },\n\n  /**\n  * Render the Filter Button and Menu based on filterType - which determines the options\n  * @private\n  * @param {object} col The column object\n  * @returns {string} The html for the filter button.\n  */\n  filterButtonHtml(col) {\n    if (!col.filterType) {\n      return '';\n    }\n\n    const self = this;\n    const isDisabled = col.filterDisabled;\n    const filterConditions = $.isArray(col.filterConditions) ? col.filterConditions : [];\n    const inArray = function (s, array) {\n      array = array || filterConditions;\n      return ($.inArray(s, array) > -1);\n    };\n    const render = function (icon, text, checked) {\n      return filterConditions.length && !inArray(icon) ?\n        '' : self.filterItemHtml(icon, text, checked);\n    };\n    const renderButton = function (defaultValue) {\n      return `<button type=\"button\" class=\"btn-menu btn-filter\" data-init=\"false\" ${isDisabled ? ' disabled' : ''}${defaultValue ? ` data-default=\"${defaultValue}\"` : ''} type=\"button\"><span class=\"audible\">Filter</span>` +\n      `<svg class=\"icon-dropdown icon\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"#icon-filter-{{icon}}\"></use></svg>${\n        $.createIcon({ icon: 'dropdown', classes: 'icon-dropdown' })\n      }</button><ul class=\"popupmenu has-icons is-translatable is-selectable\">`;\n    };\n    let btnMarkup = '';\n\n    // Just the dropdown\n    if (col.filterType === 'contents' || col.filterType === 'select' || col.filterType === 'multiselect') {\n      return '';\n    }\n\n    if (col.filterType === 'text') {\n      btnMarkup = renderButton('contains') +\n        render('contains', 'Contains', true) +\n        render('does-not-contain', 'DoesNotContain') +\n        render('equals', 'Equals') +\n        render('does-not-equal', 'DoesNotEqual') +\n        render('is-empty', 'IsEmpty') +\n        render('is-not-empty', 'IsNotEmpty');\n      btnMarkup = btnMarkup.replace('{{icon}}', 'contains');\n    }\n\n    if (col.filterType === 'checkbox') {\n      btnMarkup += renderButton('selected-notselected') +\n        render('selected-notselected', 'All', true) +\n        render('selected', 'Selected') +\n        render('not-selected', 'NotSelected');\n      btnMarkup = btnMarkup.replace('{{icon}}', 'selected-notselected');\n    }\n\n    if (col.filterType !== 'checkbox' && col.filterType !== 'text') {\n      btnMarkup += renderButton('equals') +\n        render('equals', 'Equals', (col.filterType === 'lookup' || col.filterType === 'integer' || col.filterType === 'decimal' || col.filterType === 'date' || col.filterType === 'time')) +\n        render('does-not-equal', 'DoesNotEqual') +\n        render('is-empty', 'IsEmpty') +\n        render('is-not-empty', 'IsNotEmpty');\n      btnMarkup = btnMarkup.replace('{{icon}}', 'equals');\n    }\n\n    if (col.filterType === 'date') {\n      btnMarkup += render('in-range', 'InRange');\n    }\n\n    if (/\\b(integer|decimal|date|time|percent)\\b/g.test(col.filterType)) {\n      btnMarkup += `${\n        render('less-than', 'LessThan')\n      }${render('less-equals', 'LessOrEquals')\n      }${render('greater-than', 'GreaterThan')\n      }${render('greater-equals', 'GreaterOrEquals')}`;\n      btnMarkup = btnMarkup.replace('{{icon}}', 'less-than');\n    }\n\n    if (col.filterType === 'text') {\n      btnMarkup += `${\n        render('end-with', 'EndsWith')\n      }${render('does-not-end-with', 'DoesNotEndWith')\n      }${render('start-with', 'StartsWith')\n      }${render('does-not-start-with', 'DoesNotStartWith')}`;\n      btnMarkup = btnMarkup.replace('{{icon}}', 'end-with');\n    }\n\n    if (col.filterType === 'lookup') {\n      btnMarkup = renderButton('contains') +\n        render('contains', 'Contains', true) +\n        render('does-not-contain', 'DoesNotContain') +\n        render('equals', 'Equals') +\n        render('does-not-equal', 'DoesNotEqual') +\n        render('is-empty', 'IsEmpty') +\n        render('is-not-empty', 'IsNotEmpty') +\n        render('end-with', 'EndsWith') +\n        render('does-not-end-with', 'DoesNotEndWith') +\n        render('start-with', 'StartsWith') +\n        render('does-not-start-with', 'DoesNotStartWith') +\n        render('less-than', 'LessThan') +\n        render('less-equals', 'LessOrEquals') +\n        render('greater-than', 'GreaterThan') +\n        render('greater-equals', 'GreaterOrEquals');\n      btnMarkup = btnMarkup.replace('{{icon}}', 'contains');\n    }\n\n    btnMarkup += '</ul>';\n    return btnMarkup;\n  },\n\n  /**\n  * Toggle the visibility of the filter row.\n  */\n  toggleFilterRow() {\n    if (this.settings.filterable) {\n      this.headerContainer.find('.datagrid-filter-wrapper').hide();\n      this.settings.filterable = false;\n      this.filterRowRendered = false;\n      this.element.removeClass('has-filterable-columns');\n      this.element.removeClass('has-two-line-header');\n      /**\n      *  Fires after the filter row is closed by the user.\n      * @event closefilterrow\n      * @memberof Datagrid\n      * @property {object} event The jquery event object\n      */\n      this.element.triggerHandler('closefilterrow');\n    } else {\n      this.settings.filterable = true;\n      this.filterRowRendered = true;\n\n      this.element.addClass('has-filterable-columns');\n\n      if (this.settings.twoLineHeader) {\n        this.element.addClass('has-two-line-header');\n      }\n\n      this.headerContainer.find('.datagrid-filter-wrapper').show();\n\n      /**\n      * Fires after the filter row is opened by the user.\n      * @event openfilterrow\n      * @memberof Datagrid\n      * @property {object} event The jquery event object\n      */\n      this.element.triggerHandler('openfilterrow');\n      this.attachFilterRowEvents();\n    }\n    this.setupTooltips();\n  },\n\n  /**\n  * Apply the Filter with the currently selected conditions, or the ones passed in.\n  * @param {object} conditions An array of objects with the filter conditions.\n  * @param {string} [trigger] A string to identify the triggering action.\n  */\n  applyFilter(conditions, trigger) {\n    const self = this;\n\n    if (conditions) {\n      this.setFilterConditions(conditions);\n    } else {\n      conditions = this.filterConditions();\n    }\n\n    const checkRow = function (rowData) {\n      let isMatch = true;\n\n      for (let i = 0; i < conditions.length; i++) {\n        const columnDef = self.columnById(conditions[i].columnId)[0];\n\n        let rowValue = rowData && rowData[columnDef.field] !== undefined ?\n          rowData[columnDef.field] : self.fieldValue(rowData, columnDef.field);\n        let rowValueStr = (rowValue === null || rowValue === undefined) ? '' : rowValue.toString().toLowerCase();\n        let conditionValue = conditions[i].value.toString().toLowerCase();\n        let rangeData = null;\n\n        // Percent filter type\n        if (columnDef.filterType === 'percent') {\n          conditionValue = (conditionValue / 100).toString();\n          if ((`${columnDef.name}`).toLowerCase() === 'decimal') {\n            rowValue = Formatters.Decimal(false, false, rowValue, columnDef);\n            conditionValue = Formatters.Decimal(false, false, conditionValue, columnDef);\n          } else if ((`${columnDef.name}`).toLowerCase() === 'integer') {\n            rowValue = Formatters.Integer(false, false, rowValue, columnDef);\n            conditionValue = Formatters.Integer(false, false, conditionValue, columnDef);\n          }\n        }\n\n        // Run Data over the formatter\n        if (columnDef.filterType === 'text') {\n          const fmt = columnDef.formatter;\n          const id = conditions[i].columnId;\n          rowValue = self.formatValue(fmt, i, id, rowValue, columnDef, rowData, self);\n\n          // Strip any html markup that might be in the formatters\n          const rex = /(<([^>]+)>)|(amp;)|(&lt;([^>]+)&gt;)/ig;\n          rowValue = rowValue.replace(rex, '').trim().toLowerCase();\n\n          rowValueStr = (rowValue === null || rowValue === undefined) ? '' : rowValue.toString().toLowerCase();\n        }\n\n        if (columnDef.filterType === 'contents' || columnDef.filterType === 'select' || columnDef.filterType === 'multiselect') {\n          rowValue = (rowValue === null || rowValue === undefined) ? '' : rowValue.toString().toLowerCase();\n        }\n\n        if ((typeof rowValue === 'number' || (!isNaN(rowValue) && rowValue !== '')) &&\n              columnDef.filterType !== 'date' && columnDef.filterType !== 'time') {\n          rowValue = parseFloat(rowValue);\n          conditionValue = Locale.parseNumber(conditionValue);\n        }\n\n        if (columnDef.filterType === 'date' || columnDef.filterType === 'time') {\n          if (columnDef.filterType === 'date' && typeof rowValue === 'string') {\n            rowValue = columnDef.formatter(false, false, rowValue, columnDef, true);\n          }\n          const getValues = (rValue, cValue) => {\n            cValue = Locale.parseDate(cValue, conditions[i].format);\n            if (cValue) {\n              if (columnDef.filterType === 'time') {\n                // drop the day, month and year\n                cValue.setDate(1);\n                cValue.setMonth(0);\n                cValue.setYear(0);\n              }\n\n              cValue = cValue.getTime();\n            }\n\n            if (rValue instanceof Date) {\n              // Copy date\n              rValue = new Date(rValue.getTime());\n              if (columnDef.filterType === 'time') {\n                // drop the day, month and year\n                rValue.setDate(1);\n                rValue.setMonth(0);\n                rValue.setYear(0);\n              } else if (!(columnDef.editorOptions && columnDef.editorOptions.showTime)) {\n                // Drop any time component of the row data for the filter as it is a date only field\n                rValue.setHours(0);\n                rValue.setMinutes(0);\n                rValue.setSeconds(0);\n                rValue.setMilliseconds(0);\n              }\n              rValue = rValue.getTime();\n            } else if (typeof rValue === 'string' && rValue) {\n              if (!columnDef.sourceFormat) {\n                rValue = Locale.parseDate(rValue, { pattern: conditions[i].format });\n              } else {\n                rValue = Locale.parseDate(rValue, (typeof columnDef.sourceFormat === 'string' ? { pattern: columnDef.sourceFormat } : columnDef.sourceFormat));\n              }\n\n              if (rValue) {\n                if (columnDef.filterType === 'time') {\n                  // drop the day, month and year\n                  rValue.setDate(1);\n                  rValue.setMonth(0);\n                  rValue.setYear(0);\n                } else if (!(columnDef.editorOptions && columnDef.editorOptions.showTime)) {\n                  // Drop any time component of the row data for the filter\n                  // as it is a date only field\n                  rValue.setHours(0);\n                  rValue.setMinutes(0);\n                  rValue.setSeconds(0);\n                  rValue.setMilliseconds(0);\n                }\n                rValue = rValue.getTime();\n              }\n            }\n            return { rValue, cValue };\n          };\n\n          let values = null;\n          if (conditions[i].operator === 'in-range') {\n            const cell = self.settings.columns.indexOf(columnDef);\n            const input = self.headerContainer.find(`th:eq(${cell}) .datagrid-filter-wrapper input`);\n            const datepickerApi = input.data('datepicker');\n            if (datepickerApi) {\n              rangeData = datepickerApi.settings.range.data;\n              if (rangeData && rangeData.start) {\n                values = getValues(rowValue, rangeData.start);\n              }\n            }\n          } else {\n            values = getValues(rowValue, conditions[i].value);\n          }\n          rowValue = values ? values.rValue : rowValue;\n          conditionValue = values ? values.cValue : conditionValue;\n        }\n\n        switch (conditions[i].operator) {\n          case 'equals':\n\n            // This case is multiselect\n            if (conditions[i].value instanceof Array) {\n              isMatch = false;\n\n              for (let k = 0; k < conditions[i].value.length; k++) {\n                const match = conditions[i].value[k].toLowerCase() === rowValue && (rowValue.toString() !== '' || conditions[i].value[k] === '');\n                if (match) {\n                  isMatch = true;\n                }\n              }\n            } else {\n              isMatch = (rowValue === conditionValue && rowValue !== '');\n            }\n\n            break;\n          case 'does-not-equal':\n            isMatch = (rowValue !== conditionValue);\n            break;\n          case 'contains':\n            isMatch = (rowValueStr.indexOf(conditionValue) > -1 && rowValue.toString() !== '');\n            break;\n          case 'does-not-contain':\n            isMatch = (rowValueStr.indexOf(conditionValue) === -1);\n            break;\n          case 'end-with':\n            isMatch = (rowValueStr.lastIndexOf(conditionValue) === (rowValueStr.length - conditionValue.toString().length) && rowValueStr !== '' && (rowValueStr.length >= conditionValue.toString().length));\n            break;\n          case 'start-with':\n            isMatch = (rowValueStr.indexOf(conditionValue) === 0 && rowValueStr !== '');\n            break;\n          case 'does-not-end-with':\n            isMatch = (rowValueStr.lastIndexOf(conditionValue) === (rowValueStr.length - conditionValue.toString().length) && rowValueStr !== '' && (rowValueStr.length >= conditionValue.toString().length));\n            isMatch = !isMatch;\n            break;\n          case 'does-not-start-with':\n            isMatch = !(rowValueStr.indexOf(conditionValue) === 0 && rowValueStr !== '');\n            break;\n          case 'is-empty':\n            isMatch = (rowValueStr === '');\n            break;\n          case 'is-not-empty':\n            if (rowValue === '') {\n              isMatch = (rowValue !== '');\n              break;\n            }\n            isMatch = !(rowValue === null);\n            break;\n          case 'in-range':\n            isMatch = false;\n            if (rangeData && rangeData.startDate && rangeData.endDate) {\n              const d1 = rangeData.startDate.getTime();\n              const d2 = rangeData.endDate.getTime();\n              isMatch = rowValue >= d1 && rowValue <= d2;\n            }\n            break;\n          case 'less-than':\n            isMatch = (rowValue < conditionValue && rowValue !== '');\n            break;\n          case 'less-equals':\n            isMatch = (rowValue <= conditionValue && rowValue !== '');\n            break;\n          case 'greater-than':\n            isMatch = (rowValue > conditionValue && rowValue !== '');\n            break;\n          case 'greater-equals':\n            isMatch = (rowValue >= conditionValue && rowValue !== '');\n            break;\n          case 'selected':\n            if (columnDef && columnDef.isChecked) {\n              isMatch = columnDef.isChecked(rowValue);\n              break;\n            }\n            isMatch = (rowValueStr === '1' || rowValueStr === 'true' || rowValue === true || rowValue === 1) && rowValueStr !== '';\n            break;\n          case 'not-selected':\n            if (columnDef && columnDef.isChecked) {\n              isMatch = !columnDef.isChecked(rowValue);\n              break;\n            }\n            isMatch = (rowValueStr === '0' || rowValueStr === 'false' || rowValue === false || rowValue === 0 || rowValueStr === '');\n            break;\n          case 'selected-notselected':\n            isMatch = true;\n            break;\n          default:\n        }\n\n        if (!isMatch) {\n          return false;\n        }\n      }\n      return isMatch;\n    };\n\n    if (!this.settings.disableClientFilter) {\n      let dataset;\n      let isFiltered;\n      let i;\n      let i2;\n      let len;\n      let dataSetLen;\n\n      if (this.settings.treeGrid) {\n        dataset = this.settings.dataset;\n\n        const checkChildNodes = function (nodeData, parentNode) {\n          for (let j = 0; j < nodeData.length; j++) {\n            const childNode = nodeData[j];\n\n            if (isFiltered) {\n              isFiltered = !checkRow(childNode);\n            }\n\n            childNode.isFiltered = !checkRow(childNode);\n\n            if (parentNode && !childNode.isFiltered) {\n              parentNode.isFiltered = false;\n            }\n\n            if (childNode.children && childNode.children.length) {\n              checkChildNodes(childNode.children, childNode);\n            }\n          }\n        };\n\n        for (i = 0, len = dataset.length; i < len; i++) {\n          isFiltered = !checkRow(dataset[i]);\n\n          if (dataset[i].children && dataset[i].children.length) {\n            checkChildNodes(dataset[i].children);\n          }\n\n          dataset[i].isFiltered = isFiltered;\n        }\n      } else if (this.settings.groupable) {\n        for (i = 0, len = this.settings.dataset.length; i < len; i++) {\n          let isGroupFiltered = true;\n          for (i2 = 0, dataSetLen = this.settings.dataset[i].values.length; i2 < dataSetLen; i2++) {\n            isFiltered = !checkRow(this.settings.dataset[i].values[i2]);\n            this.settings.dataset[i].values[i2].isFiltered = isFiltered;\n\n            if (!isFiltered) {\n              isGroupFiltered = false;\n            }\n          }\n\n          this.settings.dataset[i].isFiltered = isGroupFiltered;\n        }\n      } else {\n        for (i = 0, len = this.settings.dataset.length; i < len; i++) {\n          isFiltered = !checkRow(this.settings.dataset[i]);\n          this.settings.dataset[i].isFiltered = isFiltered;\n        }\n      }\n    }\n\n    this.setChildExpandOnMatch();\n\n    if (!this.settings.source) {\n      this.renderRows();\n    }\n\n    if (this.restoreFilterClientSide) {\n      this.restoreFilterClientSide = false;\n    } else {\n      /**\n      * Fires after a filter action ocurs\n      * @event filtered\n      * @memberof Datagrid\n      * @property {object} event The jquery event object\n      * @property {object} args Object with the arguments\n      * @property {number} args.op The filter operation, this can be 'apply', 'clear'\n      * @property {object} args.conditions An object with all the condition data.\n      * @property {string} args.trigger Info on what was the triggering action. May be render, select or key\n      */\n      this.element.trigger('filtered', { op: 'apply', conditions, trigger });\n    }\n\n    this.setSearchActivePage({\n      trigger,\n      type: 'filtered'\n    });\n    this.saveUserSettings();\n  },\n\n  /**\n   * Adjust the left positon for given element to be in viewport\n   * @private\n   * @param {object} el The element\n   * @returns {void}\n   */\n  adjustPosLeft(el) {\n    const padding = 20;\n    const b = el.getBoundingClientRect();\n    const w = (window.innerWidth || document.documentElement.clientWidth);\n    if (b.left < 0 && b.right <= w) {\n      el.style.left = `${padding}px`; // Left side\n    } else if (b.left >= 0 && !(b.right <= w)) {\n      el.style.left = `${(w - b.width) - padding}px`; // Right side\n    }\n  },\n\n  /**\n   * Check if given element is in the viewport\n   * @private\n   * @param {object} el The element to check\n   * @returns {boolean} true if is in the viewport\n   */\n  isInViewport(el) {\n    const b = el.getBoundingClientRect();\n    return (\n      b.top >= 0 && b.left >= 0 &&\n      b.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n      b.right <= (window.innerWidth || document.documentElement.clientWidth)\n    );\n  },\n\n  /**\n   * Set child nodes when use filter as\n   * settings.allowChildExpandOnMatch === true\n   * and if only parent got match then add all children nodes too\n   * or if one or more child node got match then add parent node and all the children nodes\n   * settings.allowChildExpandOnMatch === false\n   * and if only parent got match then make expand/collapse button to be collapsed, disabled\n   * and do not add any children nodes\n   * or if one or more child node got match then add parent node and only matching children nodes\n   * @private\n   * @returns {void}\n   */\n  setChildExpandOnMatch() {\n    const s = this.settings;\n    if (s.treeGrid) {\n      const checkNodes = function (nodeData, depth) {\n        for (let i = 0, l = nodeData.length; i < l; i++) {\n          const node = nodeData[i];\n          const children = node.children;\n          const childrenLen = children ? children.length : 0;\n\n          if (childrenLen) {\n            if (!node.isFiltered) {\n              if (s.allowChildExpandOnMatch) {\n                for (let i2 = 0; i2 < childrenLen; i2++) {\n                  children[i2].isFiltered = false;\n                }\n              } else {\n                let isAllChildrenFiltered = true;\n                for (let i2 = 0; i2 < childrenLen; i2++) {\n                  if (!children[i2].isFiltered) {\n                    isAllChildrenFiltered = false;\n                  }\n                }\n                node.isAllChildrenFiltered = isAllChildrenFiltered;\n              }\n            }\n            checkNodes(children, node, depth++);\n          }\n        }\n      };\n      checkNodes(s.dataset, 0);\n    }\n  },\n\n  /**\n  * Clear the Filter row Conditions and Reset the Data.\n  */\n  clearFilter() {\n    if (!this.settings.filterable) {\n      return;\n    }\n\n    this.headerContainer.find('input, select').val('').trigger('updated');\n    // reset all the filters to first item\n    this.headerContainer.find('.btn-filter').each(function () {\n      const btn = $(this);\n      const ul = btn.next();\n      const first = ul.find('li:first');\n\n      btn.find('svg:first > use').attr('xlink:href', `#icon-filter-${btn.attr('data-default')}`);\n      ul.find('.is-checked').removeClass('is-checked');\n      first.addClass('is-checked');\n    });\n\n    this.applyFilter();\n    this.element.trigger('filtered', { op: 'clear', conditions: [] });\n  },\n\n  /**\n  * Set the Filter Conditions on the UI Only.\n  * @param {object} conditions An array of objects with the filter conditions.\n  */\n  setFilterConditions(conditions) {\n    for (let i = 0; i < conditions.length; i++) {\n      // Find the filter row\n      const rowElem = this.headerContainer.find(`th[data-column-id=\"${conditions[i].columnId}\"]`);\n      const input = rowElem.find('input, select');\n      const btn = rowElem.find('.btn-filter');\n\n      if (conditions[i].value === undefined) {\n        conditions[i].value = '';\n      }\n\n      input.val(conditions[i].value);\n\n      if (input.is('select')) {\n        if (conditions[i].value instanceof Array) {\n          for (let j = 0; j < conditions[i].value.length; j++) {\n            input.find(`option[value=\"${conditions[i].value[j]}\"]`).prop('selected', true);\n          }\n        } else {\n          input.find(`option[value=\"${conditions[i].value}\"]`).prop('selected', true);\n        }\n        input.trigger('updated');\n      }\n\n      btn.find('svg:first > use').attr('xlink:href', `#icon-filter-${conditions[i].operator}`);\n    }\n  },\n\n  /**\n  * Get filter conditions in array from whats set in the UI.\n  * @returns {array} An array with the currently showing filter conditions.\n  */\n  filterConditions() {\n    // Do not modify keyword search filter expr\n    if (this.filterExpr && this.filterExpr.length === 1 && this.filterExpr[0].keywordSearch) {\n      delete this.filterExpr[0].keywordSearch;\n      return this.filterExpr;\n    }\n\n    const self = this;\n    this.filterExpr = [];\n\n    // Create an array of objects with: field, id, filterType, operator, value\n    this.headerContainer.find('th').each(function () {\n      const rowElem = $(this);\n      const btn = rowElem.find('.btn-filter');\n      const input = rowElem.find('input, select');\n      const isDropdown = input.is('select');\n      const svg = btn.find('.icon-dropdown:first');\n      let op = null;\n      let format = null;\n\n      if (!btn.length && !isDropdown) {\n        return;\n      }\n\n      op = isDropdown ? 'equals' : svg.getIconName().replace('filter-', '');\n\n      if (op === 'selected-notselected') {\n        return;\n      }\n\n      if (input.val() === '' && ['is-not-empty', 'is-empty', 'selected', 'not-selected'].indexOf(op) === -1) {\n        return;\n      }\n\n      if (input.val() instanceof Array && input.val().length === 0) {\n        return;\n      }\n\n      let value = input.val() ? input.val() : '';\n      if (input.attr('data-mask-mode') && input.attr('data-mask-mode') === 'number') {\n        value = Locale.parseNumber(value);\n      }\n\n      const condition = {\n        columnId: rowElem.attr('data-column-id'),\n        operator: op,\n        value\n      };\n\n      if (input.data('datepicker')) {\n        format = input.data('datepicker').settings.dateFormat;\n        if (format === 'locale') {\n          format = Locale.calendar().dateFormat.short;\n        }\n        condition.format = format;\n      }\n\n      if (input.data('timepicker')) {\n        format = input.data('timepicker').settings.timeFormat;\n        condition.format = format;\n      }\n\n      self.filterExpr.push(condition);\n    });\n\n    return self.filterExpr;\n  },\n\n  /**\n  * Get extra top position for current target in header\n  * @private\n  * @returns {number} the extra top position of the rows depending on rowHeight setting.\n  */\n  getExtraTop() {\n    const s = this.settings;\n    const topPositions = {\n      default: { short: 0, medium: 0, normal: 0 },\n      filterable: { short: 0, medium: 0, normal: 0 },\n      group: { short: -25, medium: -30, normal: -39 },\n      groupFilterable: { short: -29, medium: -30, normal: -41 }\n    };\n    let extraTop = 0;\n    if (s.columnGroups) {\n      extraTop = s.filterable ?\n        topPositions.groupFilterable[s.rowHeight] : topPositions.group[s.rowHeight];\n    } else {\n      extraTop = s.filterable ?\n        topPositions.filterable[s.rowHeight] : topPositions.default[s.rowHeight];\n    }\n    return extraTop;\n  },\n\n  /**\n  * Get height for current target in header\n  * @private\n  * @returns {number} the height of the rows depending on rowHeight setting.\n  */\n  getTargetHeight() {\n    const s = this.settings;\n    const heights = {\n      default: { short: 20, medium: 28, normal: 35 },\n      filterable: { short: 53, medium: 54, normal: 60 },\n      group: { short: 46, medium: 56, normal: 74 },\n      groupFilterable: { short: 83, medium: 87, normal: 103 }\n    };\n    let height = 0;\n    if (s.columnGroups) {\n      height = s.filterable && this.filterRowRendered ?\n        heights.groupFilterable[s.rowHeight] : heights.group[s.rowHeight];\n    } else {\n      height = s.filterable && this.filterRowRendered ?\n        heights.filterable[s.rowHeight] : heights.default[s.rowHeight];\n    }\n    return height;\n  },\n\n  /**\n  * Create draggable columns\n  * @private\n  */\n  createDraggableColumns() {\n    const self = this;\n    const headers = self.headerNodes().not('[data-column-id=\"selectionCheckbox\"]');\n    let showTarget = $('.drag-target-arrows', self.element);\n\n    if (!showTarget.length) {\n      self.element.prepend(`<span class=\"drag-target-arrows\" style=\"height: ${self.getTargetHeight()}px;\"></span>`);\n      showTarget = $('.drag-target-arrows', self.element);\n    }\n\n    headers.not('[data-reorder=\"false\"]').prepend('</span><span class=\"handle\">&#8286;</span>');\n    headers.prepend('<span class=\"is-draggable-target\"></span>');\n    headers.last().append('<span class=\"is-draggable-target last\"></span>');\n    self.element.addClass('has-draggable-columns');\n\n    // Initialize Drag api\n    $('.handle', headers).each(function () {\n      let clone = null;\n      let headerPos = null;\n      let offPos = null;\n      let extraTopPos = 0;\n      const handle = $(this);\n      const header = handle.parent();\n\n      handle.on('mousedown.datagrid', (e) => {\n        e.preventDefault();\n\n        header.drag({\n          clone: true, cloneAppendTo: headers.first().parent().parent(), clonePosIsFixed: true\n        })\n          .on('dragstart.datagrid', (dragStartEvent, pos, thisClone) => {\n            clone = thisClone;\n\n            clone.removeAttr('id').addClass('is-dragging-clone')\n              .css({ left: pos.left, top: pos.top, height: header.height(), border: 0 });\n\n            $('.is-draggable-target', clone).remove();\n\n            self.setDraggableColumnTargets();\n\n            extraTopPos = self.getExtraTop();\n            headerPos = header.position();\n            offPos = { top: (pos.top - headerPos.top), left: (pos.left - headerPos.left) };\n\n            const index = self.targetColumn(headerPos);\n            self.draggableStatus.startIndex = index;\n            e.stopImmediatePropagation();\n          })\n          .on('drag.datagrid', (dragEvent, pos) => {\n            clone[0].style.left = `${parseInt(pos.left, 10)}px`;\n            clone[0].style.top = `${parseInt(pos.top, 10)}px`;\n            headerPos = { top: (pos.top - offPos.top), left: (pos.left - offPos.left) };\n\n            let n = 0;\n            let target = null;\n            let rect = null;\n            const index = self.targetColumn(headerPos);\n\n            $('.is-draggable-target', headers).add(showTarget).removeClass('is-over');\n\n            if (index !== -1) {\n              for (let i = 0, l = self.draggableColumnTargets.length; i < l; i++) {\n                target = self.draggableColumnTargets[i];\n                n = i + 1;\n\n                if (target.index === index && target.index !== self.draggableStatus.startIndex) {\n                  if (target.index > self.draggableStatus.startIndex && (n < l)) {\n                    target = self.draggableColumnTargets[n];\n                  }\n\n                  target.el.addClass('is-over');\n                  showTarget.addClass('is-over');\n                  rect = target.el[0].getBoundingClientRect();\n                  showTarget[0].style.left = `${parseInt(rect.left, 10)}px`;\n                  showTarget[0].style.top = `${(parseInt(rect.top, 10) + 1) + extraTopPos}px`;\n                }\n              }\n            }\n\n            e.stopImmediatePropagation();\n          })\n          .on('dragend.datagrid', (dragendEvent, pos) => {\n            clone[0].style.left = `${parseInt(pos.left, 10)}px`;\n            clone[0].style.top = `${parseInt(pos.top, 10)}px`;\n\n            headerPos = { top: (pos.top - offPos.top), left: (pos.left - offPos.left) };\n\n            const index = self.targetColumn(headerPos);\n            const dragApi = header.data('drag');\n            const tempArray = [];\n            let i;\n            let l;\n            let indexFrom;\n            let indexTo;\n\n            // Unbind drag from header\n            if (dragApi && dragApi.destroy) {\n              dragApi.destroy();\n            }\n\n            self.draggableStatus.endIndex = index;\n            $('.is-draggable-target', headers).add(showTarget).removeClass('is-over');\n\n            if (self.draggableStatus.endIndex !== -1) {\n              if (self.draggableStatus.startIndex !== self.draggableStatus.endIndex) {\n                // Swap columns\n                for (i = 0, l = self.settings.columns.length; i < l; i++) {\n                  if (!self.settings.columns[i].hidden &&\n                        self.settings.columns[i].id !== 'selectionCheckbox') {\n                    tempArray.push(i);\n                  }\n                }\n\n                indexFrom = tempArray[self.draggableStatus.startIndex] || 0;\n                indexTo = tempArray[self.draggableStatus.endIndex] || 0;\n\n                self.updateGroupHeadersAfterColumnReorder(indexFrom, indexTo);\n                self.arrayIndexMove(self.settings.columns, indexFrom, indexTo);\n                self.updateColumns(self.settings.columns);\n              }\n            }\n          });\n      });\n    });\n  },\n\n  /**\n  * Set draggable columns target elements\n  * @private\n  */\n  setDraggableColumnTargets() {\n    const self = this;\n    const headers = self.headerNodes()\n      .not('.is-hidden').not('[data-column-id=\"selectionCheckbox\"]');\n    let target;\n    let pos;\n    let extra;\n\n    self.draggableColumnTargets = [];\n    self.draggableStatus = {};\n\n    // Move last target if not found in last header\n    if (!$('.is-draggable-target.last', headers.last()).length) {\n      headers.last().append($('.is-draggable-target.last', self.headerNodes()));\n    }\n\n    $('.is-draggable-target', headers).each(function (index) {\n      const idx = ($(this).is('.last')) ? index - 1 : index; // Extra target for last header th\n      target = headers.eq(idx);\n      pos = target.position();\n      // Extra space around, if dropped item bit off from drop area\n      extra = 20;\n\n      self.draggableColumnTargets.push({\n        el: $(this),\n        index: idx,\n        pos,\n        width: target.outerWidth(),\n        height: target.outerHeight(),\n        dropArea: {\n          x1: pos.left - extra,\n          x2: pos.left + target.outerWidth() + extra,\n          y1: (pos.top - extra) + self.getExtraTop(),\n          y2: pos.top + target.outerHeight() + extra\n        }\n      });\n    });\n  },\n\n  /**\n  * Get column index for dragging columns\n  * @private\n  * @param {object} pos The position index\n  * @returns {number} The column array index\n  */\n  targetColumn(pos) {\n    const self = this;\n    let idx = -1;\n    let target;\n    let i;\n    let l;\n\n    for (i = 0, l = self.draggableColumnTargets.length - 1; i < l; i++) {\n      target = self.draggableColumnTargets[i];\n      if (pos.left > target.dropArea.x1 && pos.left < target.dropArea.x2 &&\n          pos.top > target.dropArea.y1 && pos.top < target.dropArea.y2) {\n        idx = target.index;\n      }\n    }\n    return idx;\n  },\n\n  /**\n  * Move an array element to a different position. May be dups of this function.\n  * @private\n  * @param {array} arr The array\n  * @param {array} from The from position\n  * @param {array} to The to position\n  */\n  arrayIndexMove(arr, from, to) {\n    arr.splice(to, 0, arr.splice(from, 1)[0]);\n  },\n\n  /**\n  * Attach Drag Events to Rows\n  * @private\n  */\n  createDraggableRows() {\n    const self = this;\n\n    if (!this.settings.rowReorder) {\n      return;\n    }\n\n    this.tableBody.children().filter(function () {\n      return $(this).find('.datagrid-reorder-icon').length < 1;\n    }).attr('data-arrange-exclude', true);\n\n    // Attach the Drag API\n    this.tableBody.arrange({\n      placeholder: `<tr class=\"datagrid-reorder-placeholder\"><td colspan=\"${this.visibleColumns().length}\"></td></tr>`,\n      handle: '.datagrid-reorder-icon',\n      isVisualItems: true\n    })\n      .off('beforearrange.datagrid').on('beforearrange.datagrid', (e, status) => {\n        if (self.isSafari) {\n          status.start.css({ display: 'inline-block' });\n        }\n      })\n      .off('arrangeupdate.datagrid')\n      .on('arrangeupdate.datagrid', (e, status) => {\n        if (self.isSafari) {\n          status.end.css({ display: '' });\n        }\n\n        self.reorderRow(status.startIndex, status.endIndex, status);\n      });\n  },\n\n  /**\n   * Move a row from one position to another.\n   * @param {number} startIndex The row to move.\n   * @param {boolean} endIndex The end index.\n   * @param {object} status The drag event object.\n   */\n  reorderRow(startIndex, endIndex, status) {\n    const moveDown = endIndex > startIndex;\n    const startRow = this.tableBody.find('tr').eq(startIndex);\n    const endRow = this.tableBody.find('tr').eq(endIndex);\n\n    // Move the elem in the data set\n    const startRowIdx = this.settings.dataset.splice(startIndex, 1)[0];\n    this.settings.dataset.splice(endIndex, 0, startRowIdx);\n\n    // move in the ui\n    if (!status && moveDown) {\n      startRow.insertAfter(endRow);\n    }\n\n    if (!status && !moveDown) {\n      startRow.insertBefore(endRow);\n    }\n\n    // If using expandable rows move the expandable row with it\n    if ((this.settings.rowTemplate || this.settings.expandableRow) && moveDown) {\n      this.tableBody.find('tr').eq(startIndex * 2).insertAfter(status.end);\n      status.end.next().next().insertAfter(status.over);\n    }\n\n    if ((this.settings.rowTemplate || this.settings.expandableRow) && !moveDown) {\n      this.tableBody.find('tr').eq(startIndex * 2).next().insertAfter(status.end);\n    }\n\n    // Resequence the rows\n    const allRows = this.tableBody.find('tr:not(.datagrid-expandable-row)');\n    for (let i = 0; i < allRows.length; i++) {\n      allRows[i].setAttribute('data-index', i);\n      allRows[i].setAttribute('aria-rowindex', i + 1);\n    }\n\n    /**\n    * Fires after a row is moved via the rowReorder option.\n    * @event rowremove\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} status Object with row reorder info\n    * @property {number} status.endIndex The ending row index\n    * @property {number} status.startIndex The starting row index\n    * @property {HTMLElement} status.over The row object that was dragged over.\n    * @property {HTMLElement} status.start The starting row object.\n    */\n    this.element.trigger('rowreorder', [{\n      endIndex,\n      startIndex,\n      over: endRow,\n      start: startRow,\n    }]);\n    this.syncSelectedRowsIdx();\n  },\n\n  /**\n  * Return the value in a field, taking into account nested objects. Fx obj.field.id\n  * @private\n  * @param {object} obj The object to use\n  * @param {string} field The field as a string fx 'field' or 'obj.field.id'\n  * @returns {any} The current value in the field.\n  */\n  fieldValue(obj, field) {\n    if (!field || !obj) {\n      return '';\n    }\n\n    if (field.indexOf('.') > -1) {\n      return field.split('.').reduce((o, x) => (o ? o[x] : ''), obj);\n    }\n\n    const rawValue = obj[field];\n    let value = (rawValue || rawValue === 0 || rawValue === false ? rawValue : '');\n\n    value = xssUtils.escapeHTML(value);\n    return value;\n  },\n\n  /**\n  * Setup internal tree root nodes array.\n  * @private\n  */\n  setTreeRootNodes() {\n    if (!this.settings.treeGrid) {\n      return;\n    }\n    this.settings.treeRootNodes = this.settings.treeDepth\n      .filter(node => node.depth === 1);\n  },\n\n  /**\n   * Setup internal tree depth array.\n   * @private\n   * @param {array} dataset The json array to use for calculating tree depth.\n   */\n  setTreeDepth(dataset) {\n    if (!this.settings.treeGrid) {\n      return;\n    }\n    const self = this;\n    let idx = 0;\n    const iterate = function (node, depth) {\n      idx++;\n      self.settings.treeDepth.push({ idx, depth, node });\n      const children = node.children || [];\n      for (let i = 0, len = children.length; i < len; i++) {\n        iterate(children[i], depth + 1);\n      }\n    };\n\n    dataset = dataset || this.settings.dataset;\n    self.settings.treeDepth = [];\n\n    for (let i = 0, len = dataset.length; i < len; i++) {\n      iterate(dataset[i], 1);\n    }\n  },\n\n  /**\n  * Setup internal row grouping\n  * @private\n  */\n  setRowGrouping() {\n    const groupSettings = this.settings.groupable;\n    if (!groupSettings) {\n      return;\n    }\n\n    this.originalDataset = this.settings.dataset.slice();\n\n    if (!groupSettings.aggregator || groupSettings.aggregator === 'none') {\n      this.settings.dataset = GroupBy.none(this.settings.dataset, groupSettings.fields);\n      return;\n    }\n\n    if (groupSettings.aggregator === 'sum') {\n      this.settings.dataset = GroupBy.sum(\n        this.settings.dataset,\n        groupSettings.fields,\n        groupSettings.aggregate\n      );\n      return;\n    }\n\n    if (groupSettings.aggregator === 'max') {\n      this.settings.dataset = GroupBy.max(\n        this.settings.dataset,\n        groupSettings.fields,\n        groupSettings.aggregate\n      );\n      return;\n    }\n\n    if (groupSettings.aggregator === 'list') {\n      this.settings.dataset = GroupBy.list(\n        this.settings.dataset,\n        groupSettings.fields,\n        groupSettings.aggregatorOptions\n      );\n      return;\n    }\n\n    this.settings.dataset = GroupBy(this.settings.dataset, groupSettings.fields);\n  },\n\n  /**\n  * Clear the table body and rows.\n  * @private\n  */\n  renderRows() {\n    let tableHtml = '';\n    let tableHtmlLeft = '';\n    let tableHtmlRight = '';\n    const self = this;\n    const s = self.settings;\n    const body = self.table.find('tbody');\n    let activePage = 1;\n    if (self.pagerAPI) {\n      const pagerState = self.pagerAPI.state;\n      if (pagerState.filteredActivePage) {\n        activePage = pagerState.filteredActivePage;\n      } else {\n        activePage = pagerState.activePage;\n      }\n    }\n\n    self.bodyColGroupHtmlLeft = '<colgroup>';\n    self.bodyColGroupHtml = '<colgroup>';\n    self.bodyColGroupHtmlRight = '<colgroup>';\n    self.triggerDestroyCell(); // Trigger Destroy on previous cells\n\n    // Prevent flashing message area on filter / reload\n    if (self.emptyMessageContainer) {\n      self.emptyMessageContainer.hide();\n    }\n\n    if (body.length === 0) {\n      if (self.hasLeftPane) {\n        self.tableBodyLeft = $('<tbody></tbody>');\n        self.tableLeft.append(self.tableBodyLeft);\n      }\n      self.tableBody = $('<tbody></tbody>');\n      self.table.append(self.tableBody);\n      if (self.hasRightPane) {\n        self.tableBodyRight = $('<tbody></tbody>');\n        self.tableRight.append(self.tableBodyRight);\n      }\n    }\n\n    self.groupArray = [];\n\n    self.recordCount = 0;\n    self.filteredCount = 0;\n\n    // Reset recordCount for paging\n    if (s.treeGrid && s.paging && !s.source && activePage > 1) {\n      self.recordCount = s.treeRootNodes[(s.pagesize * activePage) - s.pagesize].idx - 1;\n    }\n\n    if (this.restoreSortOrder) {\n      this.sortDataset();\n    }\n\n    let rowStatusTooltip = false;\n    for (let i = 0; i < s.dataset.length; i++) {\n      // For better performance dont render out of page\n      if (s.paging && !s.source) {\n        if (activePage === 1 && (i - this.filteredCount) >= s.pagesize) {\n          if (!s.dataset[i].isFiltered) {\n            this.recordCount++;\n          } else {\n            this.filteredCount++;\n          }\n          continue; //eslint-disable-line\n        }\n\n        if (activePage > 1 && !((i - this.filteredCount) >= s.pagesize * (activePage - 1) &&\n          (i - this.filteredCount) < s.pagesize * activePage)) {\n          if (!s.dataset[i].isFiltered) {\n            if (this.filteredCount) {\n              this.recordCount++;\n            }\n          } else {\n            this.filteredCount++;\n          }\n          continue; //eslint-disable-line\n        }\n      }\n\n      if (s.virtualized) {\n        if (!this.isRowVisible(this.recordCount)) {\n          this.recordCount++;\n          continue;  //eslint-disable-line\n        }\n      }\n\n      // Exclude Filtered Rows\n      if ((!s.treeGrid && s.dataset[i]).isFiltered) {\n        this.filteredCount++;\n        continue; //eslint-disable-line\n      }\n\n      // Handle Grouping\n      if (this.settings.groupable) {\n        // First push group row\n        if (!this.settings.groupable.suppressGroupRow) {\n          // Show the grouping row\n          const groupHtml = self.rowHtml(s.dataset[i], this.recordCount, i, true);\n          if (this.hasLeftPane && groupHtml.left) {\n            tableHtmlLeft += groupHtml.left;\n          }\n          if (groupHtml.center) {\n            tableHtml += groupHtml.center;\n          }\n          if (this.hasRightPane && groupHtml.right) {\n            tableHtmlRight += groupHtml.right;\n          }\n        }\n\n        if (this.settings.groupable.showOnlyGroupRow && s.dataset[i].values[0]) {\n          const rowData = s.dataset[i].values[0];\n\n          if (s.dataset[i].list) {\n            rowData.list = s.dataset[i].list;\n          }\n\n          rowData.values = s.dataset[i].values;\n          const groupHtml = self.rowHtml(rowData, this.recordCount, i);\n          if (this.hasLeftPane && groupHtml.left) {\n            tableHtmlLeft += groupHtml.left;\n          }\n          if (groupHtml.center) {\n            tableHtml += groupHtml.center;\n          }\n          if (this.hasRightPane && groupHtml.right) {\n            tableHtmlRight += groupHtml.right;\n          }\n\n          this.recordCount++;\n          self.groupArray.push({ group: i, node: 0 });\n          continue;  //eslint-disable-line\n        }\n\n        // Now Push Groups\n        for (let k = 0; k < s.dataset[i].values.length; k++) {\n          if (!s.dataset[i].values[k].isFiltered) {\n            const rowHtml = self.rowHtml(s.dataset[i].values[k], this.recordCount, i);\n            if (self.hasLeftPane && rowHtml.left) {\n              tableHtmlLeft += rowHtml.left;\n            }\n            if (rowHtml.center) {\n              tableHtml += rowHtml.center;\n            }\n            if (self.hasRightPane && rowHtml.right) {\n              tableHtmlRight += rowHtml.right;\n            }\n            this.recordCount++;\n            self.groupArray.push({ group: i, node: k });\n          }\n        }\n\n        // Now Push summary rowHtml\n        if (this.settings.groupable.groupFooterRow) {\n          const rowHtml = self.rowHtml(s.dataset[i], this.recordCount, i, true, true);\n          if (self.hasLeftPane && rowHtml.left) {\n            tableHtmlLeft += rowHtml.left;\n          }\n          if (rowHtml.center) {\n            tableHtml += rowHtml.center;\n          }\n          if (self.hasRightPane && rowHtml.right) {\n            tableHtmlRight += rowHtml.right;\n          }\n        }\n\n        continue;  //eslint-disable-line\n      }\n\n      let currentCount = i;\n      if (s.treeGrid) {\n        currentCount = this.recordCount;\n      }\n\n      const rowHtml = self.rowHtml(s.dataset[i], currentCount, i);\n      if (self.hasLeftPane && rowHtml.left) {\n        tableHtmlLeft += rowHtml.left;\n      }\n      if (rowHtml.center) {\n        tableHtml += rowHtml.center;\n      }\n      if (self.hasRightPane && rowHtml.right) {\n        tableHtmlRight += rowHtml.right;\n      }\n      this.recordCount++;\n\n      if (s.dataset[i].rowStatus) {\n        rowStatusTooltip = true;\n      }\n    }\n\n    // Append a Summary Row\n    if (this.settings.summaryRow) {\n      const totals = self.calculateTotals();\n      const summaryRowHtml = self.rowHtml(totals, this.recordCount, null, false, true);\n      if (self.hasLeftPane && summaryRowHtml.left) {\n        tableHtmlLeft += summaryRowHtml.left;\n      }\n      if (summaryRowHtml.center) {\n        tableHtml += summaryRowHtml.center;\n      }\n      if (self.hasRightPane && summaryRowHtml.right) {\n        tableHtmlRight += summaryRowHtml.right;\n      }\n    }\n\n    if (self.bodyColGroupHtml !== '<colgroup>') {\n      self.bodyColGroupHtmlLeft += '</colgroup>';\n      self.bodyColGroupHtml += '</colgroup>';\n      self.bodyColGroupHtmlRight += '</colgroup>';\n\n      if (self.bodyColGroupLeft) {\n        self.bodyColGroupLeft.remove();\n      }\n\n      if (self.bodyColGroup) {\n        self.bodyColGroup.remove();\n      }\n\n      if (self.bodyColGroupRight) {\n        self.bodyColGroupRight.remove();\n      }\n\n      if (self.hasLeftPane) {\n        self.bodyColGroupLeft = $(self.bodyColGroupHtmlLeft);\n        self.tableBodyLeft.before(self.bodyColGroupLeft);\n      }\n\n      self.bodyColGroup = $(self.bodyColGroupHtml);\n      self.tableBody.before(self.bodyColGroup);\n\n      if (self.hasRightPane) {\n        self.bodyColGroupRight = $(self.bodyColGroupHtmlRight);\n        self.tableBodyRight.before(self.bodyColGroupRight);\n      }\n    }\n\n    if (self.hasLeftPane) {\n      DOM.html(self.tableBodyLeft, tableHtmlLeft, '*');\n    }\n\n    DOM.html(self.tableBody, tableHtml, '*');\n\n    if (self.hasRightPane) {\n      DOM.html(self.tableBodyRight, tableHtmlRight, '*');\n    }\n    self.setVirtualHeight();\n    self.setScrollClass();\n    self.setupTooltips(rowStatusTooltip);\n    self.afterRender();\n  },\n\n  /**\n  * Fire events and do steps needed after a full render.\n  * @private\n  */\n  afterRender() {\n    const self = this;\n\n    // Column column postRender functions\n    if (this.settings.onPostRenderCell) {\n      for (let i = 0; i < this.settings.columns.length; i++) {\n        const col = self.settings.columns[i];\n\n        if (col.component) {\n          self.tableBody.find('tr').each(function () {\n            const row = $(this);\n            const rowIdx = row.attr('data-index');\n            const lineage = row.attr('data-lineage');\n            let value = self.settings.dataset;\n            if (lineage) {\n              const drilldown = lineage.split('.');\n              drilldown.push(rowIdx);\n              let first = true;\n              drilldown.forEach((childIdx) => {\n                if (first && value[childIdx]) {\n                  value = value[childIdx];\n                } else if (value.children && value.children[childIdx]) {\n                  value = value.children[childIdx];\n                }\n                first = false;\n              });\n            } else {\n              value = value[rowIdx];\n            }\n            const colIdx = self.columnIdxById(col.id);\n            const args = {\n              row: rowIdx,\n              cell: colIdx,\n              value,\n              col,\n              api: self\n            };\n\n            self.settings.onPostRenderCell(row.find('td').eq(colIdx).find('.datagrid-cell-wrapper .content')[0], args);\n          });\n        }\n      }\n    }\n\n    // Init Inline Elements\n    const dropdowns = self.tableBody.find('select.dropdown');\n    if (dropdowns.dropdown) {\n      dropdowns.dropdown();\n    }\n\n    // Commit Edits for inline editing\n    self.tableBody.find('.dropdown-wrapper.is-inline').prev('select')\n      .on('listclosed', function () {\n        const elem = $(this);\n        const newValue = elem.val();\n        const row = elem.closest('tr');\n\n        self.updateCellNode(row.attr('aria-rowindex'), elem.closest('td').index(), newValue, false, true);\n      });\n\n    const spinboxes = self.tableBody.find('.spinbox');\n    if (spinboxes.spinbox) {\n      spinboxes.spinbox();\n    }\n\n    // Set UI elements after dataload\n    if (!self.settings.source) {\n      self.displayCounts();\n      self.checkEmptyMessage();\n    }\n\n    self.setAlternateRowShading();\n    self.createDraggableRows();\n\n    if (!self.activeCell || !self.activeCell.node) {\n      self.activeCell = { node: self.cellNode(0, 0).attr('tabindex', '0'), isFocused: false, cell: 0, row: 0 };\n    }\n\n    if (self.activeCell.isFocused) {\n      self.setActiveCell(self.activeCell.row, self.activeCell.cell);\n    }\n\n    // Deselect rows when changing pages\n    if (self.settings.paging && self.settings.source && !self.settings.allowSelectAcrossPages) {\n      self._selectedRows = [];\n      self.syncSelectedUI();\n    }\n\n    // Restore selected rows when pages change\n    if (self.settings.paging && self.settings.source && self.settings.allowSelectAcrossPages) {\n      self.syncSelectedRows();\n      self.syncSelectedUI();\n    }\n\n    // Restore selected rows when pages change for single select\n    if (self.settings.paging && !self.settings.source &&\n      self.settings.allowSelectAcrossPages === null) {\n      self.syncSelectedRows();\n      self.syncSelectedUI();\n    }\n\n    /**\n    * Fires after the entire grid is rendered.\n    * @event afterrender\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} body Object table body area\n    * @property {HTMLElement} header Object table header area\n    * @property {HTMLElement} pager Object pager body area\n    */\n    setTimeout(() => {\n      self.element.trigger('afterrender', { body: self.bodyContainer, header: self.headerContainer, pager: self.pagerBar });\n\n      // Hack for scrolling issue on windows\n      if (self.hasRightPane && this.isWindows) {\n        const w = self.tableRight.width() + 17;\n        self.tableRight.parent().width(w);\n        self.tableRight.parent().find('.datagrid-column-wrapper').eq(0).width(w);\n        self.headerTableRight.width(w);\n      }\n    });\n  },\n\n  /**\n  * Trigger the onDestroyCell for each cell\n  * @private\n  */\n  triggerDestroyCell() {\n    const self = this;\n\n    if (!self.tableBody) {\n      return;\n    }\n\n    // Call onDestroyCell\n    if (this.settings.onPostRenderCell && this.settings.onDestroyCell) {\n      const rows = self.tableBody.find('tr');\n\n      if (rows.length === 0) {\n        return;\n      }\n\n      for (let i = 0; i < this.settings.columns.length; i++) {\n        const col = this.settings.columns[i];\n\n        if (col.component) {\n          rows.each(function () {\n            const row = $(this);\n            const rowIdx = row.index();\n            const colIdx = self.columnIdxById(col.id);\n            const args = {\n              row: row.index(),\n              cell: colIdx,\n              value: self.settings.dataset[rowIdx],\n              col,\n              api: self\n            };\n\n            self.settings.onDestroyCell(row.find('td').eq(colIdx).find('.datagrid-cell-wrapper .content')[0], args);\n          });\n        }\n      }\n    }\n  },\n\n  /**\n  * Cache info on virtual scrolling for better performance.\n  * @private\n  */\n  cacheVirtualStats() {\n    const containerHeight = this.element[0].offsetHeight;\n    const scrollTop = this.bodyWrapperCenter[0].scrollTop;\n    const headerHeight = this.settings.rowHeight === 'normal' ? 40 : (this.settings.rowHeight === 'medium' ? 30 : 25);\n    const bodyH = containerHeight - headerHeight;\n    const rowH = this.settings.rowHeight === 'normal' ? 50 : (this.settings.rowHeight === 'medium' ? 40 : 30);\n\n    this.virtualRange = {\n      rowHeight: rowH,\n      top: Math.max(scrollTop - ((this.settings.virtualRowBuffer - 1) * rowH), 0),\n      bottom: scrollTop + bodyH + ((this.settings.virtualRowBuffer - 1) * rowH),\n      totalHeight: rowH * this.settings.dataset.length,\n      bodyHeight: bodyH\n    };\n  },\n\n  /**\n  * Check if the row is in the visble scroll area + buffer\n  * Just call renderRows() on events that change\n  * @private\n  * @param  {number} rowIndex Row index to check.\n  * @returns {boolean} Current row visibility.\n  */\n  isRowVisible(rowIndex) {\n    if (!this.settings.virtualized) {\n      if (this.settings.paging && !this.settings.source && rowIndex && this.pagerAPI) {\n        return (this.pagerAPI.activePage - 1) * this.settings.pagesize >= rowIndex &&\n            (this.pagerAPI.activePage) * this.settings.pagesize <= rowIndex;\n      }\n\n      return true;\n    }\n\n    if (rowIndex === 0) {\n      this.cacheVirtualStats();\n    }\n\n    // determine if the row is in view\n    const pos = rowIndex * this.virtualRange.rowHeight;\n\n    if (pos >= this.virtualRange.top && pos < this.virtualRange.bottom) {\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * Set the heights on top or bottom based on scroll position\n   * @private\n   */\n  setVirtualHeight() {\n    if (!this.settings.virtualized || !this.virtualRange) {\n      return;\n    }\n\n    const bottom = this.virtualRange.totalHeight - this.virtualRange.bottom;\n    const vTop = this.virtualRange.top;\n\n    this.topSpacer = this.tableBody.find('.datagrid-virtual-row-top');\n    this.bottomSpacer = this.tableBody.find('.datagrid-virtual-row-bottom');\n\n    if (vTop > 0 && !this.topSpacer.length) {\n      this.topSpacer = $(`<tr class=\"datagrid-virtual-row-top\" style=\"height: ${vTop}px\"><td colspan=\"${this.visibleColumns().length}\"></td></tr>`);\n      this.tableBody.prepend(this.topSpacer);\n    }\n\n    if (vTop > 0 && this.topSpacer.length) {\n      this.topSpacer.css('height', `${vTop}px`);\n    }\n\n    if (vTop === 0 && (this.topSpacer.length || this.virtualRange.topRow <= 1)) {\n      this.topSpacer.remove();\n    }\n\n    if (bottom > 0 && !this.bottomSpacer.length) {\n      this.bottomSpacer = $(`<tr class=\"datagrid-virtual-row-bottom\" style=\"height: ${bottom}px\"><td colspan=\"${this.visibleColumns().length}\"></td></tr>`);\n      this.tableBody.append(this.bottomSpacer);\n    }\n\n    if (bottom > 0 && this.bottomSpacer.length) {\n      this.bottomSpacer.css('height', `${bottom}px`);\n    }\n\n    if (bottom <= 0 && (this.bottomSpacer.length ||\n      (this.virtualRange.bottomRow >= this.settings.dataset.length))) {\n      this.bottomSpacer.remove();\n    }\n  },\n\n  /**\n   * Set the alternate shading class.\n   * @private\n   */\n  setAlternateRowShading() {\n    if (this.settings.alternateRowShading && this.settings.treeGrid) {\n      $('tr[role=\"row\"]:visible', this.tableBody)\n        .removeClass('alt-shading').filter(':odd').addClass('alt-shading');\n    }\n  },\n\n  /**\n   * The default cell formatters thats used when no formatter is provided.\n   * @private\n   * @param  {function} formatter The formatter function.\n   * @param  {number} row The row index.\n   * @param  {number} cell The cell index.\n   * @param  {string} fieldValue The current field value.\n   * @param  {object} columnDef The column settings.\n   * @param  {object} rowData The current row data.\n   * @param  {object} api The grid API reference.\n   * @returns {void}\n   */\n  formatValue(formatter, row, cell, fieldValue, columnDef, rowData, api) {\n    let formattedValue;\n    api = api || this;\n\n    // Use default formatter if undefined\n    if (formatter === undefined) {\n      formatter = this.defaultFormatter;\n    }\n\n    if (typeof formatter === 'string') {\n      formattedValue = Formatters[formatter](row, cell, fieldValue, columnDef, rowData, api);\n      formattedValue = formattedValue.toString();\n    } else {\n      formattedValue = formatter(row, cell, fieldValue, columnDef, rowData, api).toString();\n    }\n    return formattedValue;\n  },\n\n  /**\n   * Return the html markup for the row.\n   * @private\n   * @param  {object} rowData The data to use to render the row\n   * @param  {number} dataRowIdx The row index.\n   * @param  {number} actualIndex The actual data index\n   * @param  {boolean} isGroup If true we are building a group row.\n   * @param  {object} isFooter If true we are building a footer row.\n   * @param  {string} actualIndexLineage Series of actualIndex values to reach a child actualIndex in a tree\n   * @param  {boolean} skipChildren If true we dont append children.\n   * @returns {string} The html used to construct the row.\n   */\n  rowHtml(rowData, dataRowIdx, actualIndex, isGroup, isFooter, actualIndexLineage, skipChildren) {\n    let isEven = false;\n    const self = this;\n    const isSummaryRow = this.settings.summaryRow && !isGroup && isFooter;\n    const activePage = self.pagerAPI ? self.pagerAPI.activePage : 1;\n    const containerHtml = { left: '', center: '', right: '' };\n    let d = self.settings.treeDepth ? self.settings.treeDepth[dataRowIdx] : 0;\n    let depth = null;\n    let j = 0;\n    let isHidden = false;\n    let skipColumns;\n\n    if (!rowData) {\n      return '';\n    }\n\n    // Default\n    d = d ? d.depth : 0;\n    depth = d;\n\n    // Setup if this row will be hidden or not\n    if (self.settings.treeDepth && self.settings.treeDepth.length) {\n      for (let i = 0; i < self.settings.treeDepth.length; i++) {\n        const treeDepthItem = self.settings.treeDepth[i];\n\n        if (dataRowIdx === (treeDepthItem.idx - 1)) {\n          let parentNode = null;\n          let currentDepth = 0;\n          for (let i2 = i; i2 >= 0; i2--) {\n            currentDepth = self.settings.treeDepth[i2].depth < currentDepth ||\n            currentDepth === 0 ? self.settings.treeDepth[i2].depth : currentDepth;\n            if (currentDepth < treeDepthItem.depth) {\n              parentNode = self.settings.treeDepth[i2];\n\n              if (parentNode.node.isExpanded !== undefined && !parentNode.node.isExpanded\n                || currentDepth === 1) {\n                break;\n              }\n            }\n          }\n\n          if (parentNode && parentNode.node.expanded !== undefined && !parentNode.node.expanded) {\n            isHidden = true;\n          } else {\n            isHidden = rowData.isFiltered;\n          }\n\n          depth = treeDepthItem.depth;\n\n          break;\n        }\n      }\n    }\n\n    if (this.settings.groupable) {\n      const groupSettings = this.settings.groupable;\n      isHidden = (groupSettings.expanded === undefined ? false : !groupSettings.expanded);\n\n      if (groupSettings.expanded && typeof groupSettings.expanded === 'function') {\n        isHidden = !groupSettings.expanded(dataRowIdx, 0, null, null, rowData, this);\n      }\n    }\n\n    // Group Rows\n    const visibleColumnsLeft = this.settings.frozenColumns.left.length;\n    const visibleColumnsRight = this.settings.frozenColumns.right.length;\n    const visibleColumnsCenter = this.visibleColumns().length -\n      visibleColumnsLeft - visibleColumnsRight;\n\n    if (this.settings.groupable && isGroup && !isFooter) {\n      const groupRowHtml = Formatters.GroupRow(dataRowIdx, 0, null, null, rowData, this);\n      containerHtml.left = `<tr class=\"datagrid-rowgroup-header${isHidden ? '' : ' is-expanded'}\" role=\"rowgroup\"><td role=\"gridcell\" colspan=\"${visibleColumnsLeft}\">${groupRowHtml.left || '<span>&nbsp;</span>'}</td></tr>`;\n      containerHtml.center = `<tr class=\"datagrid-rowgroup-header${isHidden ? '' : ' is-expanded'}\" role=\"rowgroup\"><td role=\"gridcell\" colspan=\"${visibleColumnsCenter}\">${groupRowHtml.center || '<span>&nbsp;</span>'}</td></tr>`;\n      containerHtml.right = `<tr class=\"datagrid-rowgroup-header${isHidden ? '' : ' is-expanded'}\" role=\"rowgroup\"><td role=\"gridcell\" colspan=\"${visibleColumnsRight}\">${groupRowHtml.right || '<span>&nbsp;</span>'}</td></tr>`;\n      return containerHtml;\n    }\n\n    if (this.settings.groupable && isGroup && isFooter) {\n      const groupFooterHtml = Formatters.GroupFooterRow(dataRowIdx, 0, null, null, rowData, this);\n      containerHtml.left = `<tr class=\"datagrid-row datagrid-rowgroup-footer${isHidden ? '' : ' is-expanded'}\" role=\"rowgroup\">${groupFooterHtml.left || '<span>&nbsp;</span>'}</tr>`;\n      containerHtml.center = `<tr class=\"datagrid-row datagrid-rowgroup-footer${isHidden ? '' : ' is-expanded'}\" role=\"rowgroup\">${groupFooterHtml.center || '<span>&nbsp;</span>'}</tr>`;\n      containerHtml.right = `<tr class=\"datagrid-row datagrid-rowgroup-footer${isHidden ? '' : ' is-expanded'}\" role=\"rowgroup\">${groupFooterHtml.right || '<span>&nbsp;</span>'}</tr>`;\n      return containerHtml;\n    }\n\n    const ariaRowindex = ((dataRowIdx + 1) +\n      (self.settings.source && !self.settings.indeterminate ?\n        ((activePage - 1) * self.settings.pagesize) : 0));\n\n    isEven = (this.recordCount % 2 === 0);\n    const isSelected = this.isRowSelected(rowData);\n    const isActivated = rowData._rowactivated;\n    const rowStatus = { class: '', svg: '' };\n\n    if (rowData && rowData.rowStatus && (rowData.rowStatus.icon === 'new' ? self.settings.showNewRowIndicator : true)) {\n      rowStatus.show = true;\n      rowStatus.class = ` rowstatus-row-${rowData.rowStatus.icon}`;\n      rowStatus.icon = (rowData.rowStatus.icon === 'success') ? '#icon-check' : '#icon-exclamation';\n      rowStatus.title = (rowData.rowStatus.tooltip !== '') ? ` title=\"${rowData.rowStatus.tooltip}\"` : '';\n      rowStatus.svg = `<svg class=\"icon icon-rowstatus\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"${rowStatus.title}><use xlink:href=\"${rowStatus.icon}\"></use></svg>`;\n    }\n\n    containerHtml.center = `<tr role=\"row\" aria-rowindex=\"${ariaRowindex}\"` +\n      ` data-index=\"${actualIndex}\"${\n        actualIndexLineage ? ` data-lineage=\"${actualIndexLineage}\"` : ''\n      }${\n        self.settings.treeGrid && rowData.children ? ` aria-expanded=\"${rowData.expanded ? 'true\"' : 'false\"'}` : ''\n      }${self.settings.treeGrid ? ` aria-level= \"${depth}\"` : ''\n      }${isSelected ? ' aria-selected= \"true\"' : ''} class=\"datagrid-row${rowStatus.class}${\n        isHidden ? ' is-hidden' : ''}${\n        rowData.isFiltered ? ' is-filtered' : ''\n      }${isActivated ? ' is-rowactivated' : ''\n      }${isSelected ? this.settings.selectable === 'mixed' ? ' is-selected hide-selected-color' : ' is-selected' : ''\n      }${self.settings.alternateRowShading && !isEven ? ' alt-shading' : ''\n      }${isSummaryRow ? ' datagrid-summary-row' : ''\n      }${!self.settings.cellNavigation && self.settings.selectable !== false ? ' is-clickable' : ''\n      }${self.settings.treeGrid ? (rowData.children ? ' datagrid-tree-parent' : (depth > 1 ? ' datagrid-tree-child' : '')) : ''\n      }\">`;\n\n    containerHtml.left = containerHtml.center;\n    containerHtml.right = containerHtml.center;\n\n    for (j = 0; j < self.settings.columns.length; j++) {\n      const col = self.settings.columns[j];\n      const container = this.getContainer(col.id);\n      let cssClass = '';\n      const defaultFormatter = col.summaryRowFormatter || col.formatter || self.defaultFormatter;\n      const formatter = isSummaryRow ? defaultFormatter : col.formatter || self.defaultFormatter;\n      let formatted = self.formatValue(\n        formatter,\n        dataRowIdx,\n        j,\n        self.fieldValue(rowData, self.settings.columns[j].field),\n        self.settings.columns[j],\n        rowData,\n        self\n      );\n\n      if (formatted.indexOf('<span class=\"is-readonly\">') === 0) {\n        col.readonly = true;\n      }\n\n      if (formatted.indexOf('datagrid-checkbox') > -1 ||\n        formatted.indexOf('btn-actions') > -1) {\n        cssClass += ' l-center-text';\n      }\n\n      if (formatted.indexOf('trigger') > -1) {\n        cssClass += ' datagrid-trigger-cell';\n      }\n\n      if (col.editor) {\n        cssClass += ' has-editor';\n      }\n\n      if (col.expanded) {\n        self.treeExpansionField = col.expanded;\n      }\n\n      if (col.align) {\n        cssClass += ` l-${col.align}-text`;\n      }\n\n      if (col.textOverflow === 'ellipsis') {\n        cssClass += ' text-ellipsis';\n      }\n\n      if (col.uppercase) {\n        cssClass += ' uppercase-text';\n      }\n\n      // Add Column Css Classes\n\n      // Add a readonly class if set on the column\n      cssClass += (col.readonly ? ' is-readonly' : '');\n      cssClass += (col.hidden ? ' is-hidden' : '');\n\n      // Run a function that helps check if editable\n      if (col.isEditable && !col.readonly) {\n        const fieldVal = self.fieldValue(rowData, self.settings.columns[j].field);\n        const canEdit = col.isEditable(ariaRowindex - 1, j, fieldVal, col, rowData);\n\n        if (!canEdit) {\n          cssClass += ' is-readonly';\n        }\n      }\n\n      // Run a function that helps check if readonly\n      let ariaReadonly = (col.id !== 'selectionCheckbox' &&\n        (col.readonly || col.editor === undefined)) ?\n        'aria-readonly=\"true\"' : '';\n\n      if (col.isReadonly && !col.readonly && col.id !== 'selectionCheckbox') {\n        const fieldVal = self.fieldValue(rowData, self.settings.columns[j].field);\n        const isReadonly = col.isReadonly(this.recordCount, j, fieldVal, col, rowData);\n\n        if (isReadonly) {\n          cssClass += ' is-cell-readonly';\n          ariaReadonly = 'aria-readonly=\"true\"';\n        }\n      }\n\n      const cellValue = self.fieldValue(rowData, self.settings.columns[j].field);\n\n      // Run a function that dynamically adds a class\n      if (col.cssClass && typeof col.cssClass === 'function') {\n        cssClass += ` ${col.cssClass(this.recordCount, j, cellValue, col, rowData)}`;\n      }\n\n      if (col.cssClass && typeof col.cssClass === 'string') {\n        cssClass += ` ${col.cssClass}`;\n      }\n\n      cssClass += (col.focusable ? ' is-focusable' : '');\n\n      const rowspan = this.calculateRowspan(cellValue, dataRowIdx, col);\n\n      if (rowspan === '') {\n        continue;\n      }\n\n      // Set Width of table col / col group elements\n      let colWidth = '';\n\n      if (this.recordCount === 0) {\n        colWidth = this.columnWidth(col, j);\n\n        switch (container) {\n          case 'left':\n            self.bodyColGroupHtmlLeft += `<col${colWidth}${col.hidden ? ' class=\"is-hidden\"' : ''}></col>`;\n            break;\n          case 'right':\n            self.bodyColGroupHtmlRight += `<col${colWidth}${col.hidden ? ' class=\"is-hidden\"' : ''}></col>`;\n            break;\n          default:\n            self.bodyColGroupHtml += `<col${colWidth}${col.hidden ? ' class=\"is-hidden\"' : ''}></col>`;\n        }\n\n        if (col.colspan) {\n          this.hasColSpans = true;\n        }\n      }\n\n      if (skipColumns > 0 && !col.hidden) {\n        skipColumns -= 1;\n        cssClass += ' is-hidden';\n      }\n\n      // Run an optional function to calculate a colspan\n      let colspan = null;\n      if (col.colspan && typeof col.colspan === 'function') {\n        const fieldVal = self.fieldValue(rowData, self.settings.columns[j].field);\n        colspan = col.colspan(ariaRowindex - 1, j, fieldVal, col, rowData, self);\n\n        const max = self.settings.columns.length - j;\n        colspan = (colspan && colspan > max) ? max : colspan;\n        if (colspan && colspan > 1) {\n          skipColumns = colspan - 1;\n          if (col.align) {\n            cssClass = cssClass.replace(` l-${col.align}-text`, '');\n          }\n          cssClass += ' l-left-text';\n        } else {\n          colspan = null;\n        }\n      }\n\n      // Set rowStatus info\n      if (j !== 0) {\n        rowStatus.class = '';\n        rowStatus.svg = '';\n      }\n\n      if (rowStatus.class !== '') {\n        cssClass += ' rowstatus-cell';\n      }\n\n      if (self.isCellDirty(dataRowIdx, j)) {\n        cssClass += ' is-dirty-cell';\n      }\n\n      // Trim extra spaces\n      if (cssClass !== '') {\n        cssClass = cssClass.replace(/^\\s+|\\s+$/g, '').replace(/\\s+/g, ' ');\n      }\n\n      containerHtml[container] += `<td role=\"gridcell\" ${ariaReadonly} aria-colindex=\"${j + 1}\"` +\n          ` aria-describedby=\"${self.uniqueId(`-header-${j}`)}\"${\n            isSelected ? ' aria-selected= \"true\"' : ''\n          }${cssClass ? ` class=\"${cssClass}\"` : ''\n          }${colspan ? ` colspan=\"${colspan}\"` : ''\n          }${col.tooltip && typeof col.tooltip === 'string' ? ` title=\"${col.tooltip.replace('{{value}}', cellValue)}\"` : ''\n          }${self.settings.columnGroups ? `headers = \"${self.uniqueId(`-header-${j}`)} ${self.getColumnGroup(j)}\"` : ''\n          }${rowspan || ''}>${rowStatus.svg}<div class=\"datagrid-cell-wrapper\">`;\n\n      if (col.contentVisible) {\n        const canShow = col.contentVisible(dataRowIdx + 1, j, cellValue, col, rowData);\n        if (!canShow) {\n          formatted = '';\n        }\n      }\n\n      if (self.settings.onPostRenderCell && col.component) {\n        containerHtml[container] += '<div class=\"content\"></div>';\n        formatted = '';\n      }\n\n      containerHtml[container] += `${formatted}</div></td>`;\n    }\n\n    containerHtml.left += '</tr>';\n    containerHtml.center += '</tr>';\n    containerHtml.right += '</tr>';\n\n    if (self.settings.rowTemplate) {\n      const tmpl = self.settings.rowTemplate;\n      const item = rowData;\n      let renderedTmpl = '';\n\n      if (Tmpl && item) {\n        renderedTmpl = Tmpl.compile(`{{#dataset}}${tmpl}{{/dataset}}`, { dataset: item });\n      }\n\n      if (this.hasLeftPane) {\n        containerHtml.left += `<tr class=\"datagrid-expandable-row no-border\"><td colspan=\"${visibleColumnsLeft}\">\n          <div class=\"datagrid-row-detail\"><div style=\"height: ${self.settings.rowTemplateHeight || '107'}px\"></div></div>\n          </td></tr>`;\n      }\n      containerHtml.center += `<tr class=\"datagrid-expandable-row\"><td colspan=\"${visibleColumnsCenter}\">\n        <div class=\"datagrid-row-detail\"><div class=\"datagrid-row-detail-padding\">${renderedTmpl}</div></div>\n        </td></tr>`;\n      if (this.hasRightPane) {\n        containerHtml.right += `<tr class=\"datagrid-expandable-row\"><td colspan=\"${visibleColumnsLeft}\">\n          </td></tr>`;\n      }\n    }\n\n    if (self.settings.expandableRow) {\n      if (this.hasLeftPane) {\n        containerHtml.left += `<tr class=\"datagrid-expandable-row\"><td colspan=\"${visibleColumnsLeft}\">` +\n          '<div class=\"datagrid-row-detail\"><div class=\"datagrid-row-detail-padding\"></div></div>' +\n          '</td></tr>';\n      }\n      containerHtml.center += `<tr class=\"datagrid-expandable-row\"><td colspan=\"${visibleColumnsCenter}\">` +\n        '<div class=\"datagrid-row-detail\"><div class=\"datagrid-row-detail-padding\"></div></div>' +\n        '</td></tr>';\n    }\n\n    // Render Tree Children\n    if (rowData.children && !skipChildren) {\n      for (let i = 0, l = rowData.children.length; i < l; i++) {\n        const lineage = actualIndexLineage ? `${actualIndexLineage}.${actualIndex}` : `${actualIndex}`;\n        this.recordCount++;\n        const childRowHtml = self.rowHtml(\n          rowData.children[i],\n          this.recordCount,\n          i,\n          false,\n          false,\n          lineage\n        );\n\n        containerHtml.center += childRowHtml.center;\n        containerHtml.left += childRowHtml.center;\n        containerHtml.right += childRowHtml.right;\n      }\n    }\n\n    return containerHtml;\n  },\n\n  /**\n   * This Function approximates the table auto widthing\n   * Except use all column values and compare the text width of the header as max\n   * @private\n   * @param  {object} columnDef The column to check.\n   * @returns {number} The text width.\n   */\n  calculateTextWidth(columnDef) {\n    let max = 0;\n    let maxText = '';\n    let chooseHeader = false;\n    let hasButton = false;\n    const self = this;\n    const title = columnDef.name || '';\n\n    // Get max cell value length for this column\n    for (let i = 0; i < this.settings.dataset.length; i++) {\n      let val = this.fieldValue(this.settings.dataset[i], columnDef.field);\n      let len = 0;\n      const row = this.settings.dataset[i];\n\n      // Get formatted value (without html) so we have accurate string that\n      // will display for this cell\n      val = self.formatValue(columnDef.formatter, i, 0, val, columnDef, row, self);\n      hasButton = val.toString().indexOf('btn-secondary') > -1;\n      val = xssUtils.stripHTML(val);\n\n      len = val.toString().length;\n\n      if (this.settings.groupable && row.values) {\n        for (let k = 0; k < row.values.length; k++) {\n          let groupVal = this.fieldValue(row.values[k], columnDef.field);\n          groupVal = self.formatValue(columnDef.formatter, i, 0, groupVal, columnDef, row, self);\n          groupVal = xssUtils.stripHTML(groupVal);\n\n          len = groupVal.toString().length;\n          if (len > max) {\n            max = len;\n            maxText = groupVal;\n          }\n        }\n      }\n\n      if (len > max) {\n        max = len;\n        maxText = val;\n      }\n    }\n\n    const hasTag = columnDef.formatter ?\n      columnDef.formatter.toString().indexOf('<span class=\"tag') > -1 : false;\n\n    const hasAlert = columnDef.formatter ?\n      columnDef.formatter.toString().indexOf('datagrid-alert-icon') > -1 : false;\n\n    if (hasAlert) {\n      max += 10;\n    }\n\n    // Use header text length as max if bigger than all data cells\n    if (title.length > max) {\n      max = title.length;\n      maxText = title;\n      chooseHeader = true;\n    }\n\n    if (maxText === '' || this.settings.dataset.length === 0) {\n      maxText = columnDef.name || ' Default ';\n      chooseHeader = true;\n    }\n\n    // if given, use cached canvas for better performance, else, create new canvas\n    this.canvas = this.canvas || (this.canvas = document.createElement('canvas'));\n    const context = this.canvas.getContext('2d');\n    context.font = '14px arial';\n\n    const metrics = context.measureText(maxText);\n    let padding = chooseHeader ? 40 : 45;\n\n    if (hasAlert && !chooseHeader) {\n      padding += 20;\n    }\n\n    if (hasTag && !chooseHeader) {\n      padding += 10;\n    }\n\n    if (hasButton) {\n      padding += 50;\n    }\n\n    if (columnDef.filterType) {\n      let minWidth = columnDef.filterType === 'date' ? 170 : 100;\n\n      if (columnDef.filterType === 'checkbox') {\n        minWidth = 40;\n        padding = 40;\n      }\n\n      return Math.round(Math.max(metrics.width + padding, minWidth));\n    }\n\n    return Math.round(metrics.width + padding); // Add padding and borders\n  },\n\n  /**\n   * Return the currently cached table width ready for the css style.\n   * @private\n   * @param  {string} container The container (left, right, center).\n   * @returns {string} The css width\n   */\n  headerTableWidth(container) {\n    const cacheWidths = this.headerWidths[this.settings.columns.length - 1];\n    let hasVisibleScrollbars = false;\n\n    if (!cacheWidths) {\n      return '';\n    }\n\n    if (this.hasRightPane && container === 'right') {\n      hasVisibleScrollbars = env.os.name === 'Mac OS X' && this.bodyWrapperRight.width() - this.tableRight.width() > 0;\n    }\n\n    if (cacheWidths.widthPercent) {\n      return '100%';\n    } else if (!isNaN(this.totalWidths[container])) {\n      if (hasVisibleScrollbars) {\n        return `${parseFloat(this.totalWidths[container]) + 15}px`;\n      }\n      return `${parseFloat(this.totalWidths[container])}px`;\n    }\n\n    return '';\n  },\n\n  /**\n   * Return the currently cached table min width ready for the css style.\n   * @private\n   * @param  {string} container The container (left, right, center).\n   * @returns {string} The css width\n   */\n  headerTableMinWidth(container) {\n    if (!isNaN(this.totalMinWidths[container])) {\n      return `${parseFloat(this.totalMinWidths[container])}px`;\n    }\n    return '';\n  },\n\n  /**\n   * Set the scroll class if the scrollbar is visible to effect the scrollheight.\n   * @private\n   */\n  setScrollClass() {\n    const height = parseInt(this.bodyWrapperCenter[0].offsetHeight, 10);\n    const hasScrollBarV = parseInt(this.bodyWrapperCenter[0].scrollHeight, 10) > height + 2;\n    const width = parseInt(this.bodyWrapperCenter[0].offsetWidth, 10);\n    const hasScrollBarH = parseInt(this.bodyWrapperCenter[0].scrollWidth, 10) > width;\n    this.element.removeClass('has-vertical-scroll has-less-rows');\n\n    if (hasScrollBarV) {\n      this.element.addClass('has-vertical-scroll');\n    }\n    if (hasScrollBarH) {\n      this.element.addClass('has-horizontal-scroll');\n    }\n\n    if (!hasScrollBarV && this.tableBody[0].offsetHeight < height) {\n      this.element.addClass('has-less-rows');\n    }\n\n    if (this.hasRightPane) {\n      this.element.addClass('has-frozen-right-columns');\n\n      if (utils.getScrollbarWidth() > 0) {\n        this.element.addClass('has-visible-scrollbars');\n      }\n    }\n  },\n\n  /**\n   * Clear internal header cache info.\n   * @private\n   * @returns {void}\n   */\n  clearHeaderCache() {\n    this.headerWidths = [];\n    this.totalWidths.left = 0;\n    this.totalWidths.center = 0;\n    this.totalWidths.right = 0;\n    this.totalMinWidths.left = 0;\n    this.totalMinWidths.center = 0;\n    this.totalMinWidths.right = 0;\n    this.elemWidth = 0;\n    this.lastColumn = null;\n    this.isInitialRender = true;\n    this.cacheColumnWidths();\n  },\n\n  /**\n   * Calculate and cache the width for all the columns\n   * Simulates https://www.w3.org/TR/CSS21/tables.html#width-layout\n   * @private\n   */\n  cacheColumnWidths() {\n    for (let i = 0; i < this.settings.columns.length; i++) {\n      const col = this.settings.columns[i];\n      this.calculateColumnWidth(col, i);\n    }\n  },\n\n  /**\n   * Return the width for a column (upfront with no rendering)\n   * Simulates https://www.w3.org/TR/CSS21/tables.html#width-layout\n   * @private\n   * @param  {[type]} col The column object to use\n   * @param  {[type]} index The column index\n   * @returns {void}\n   */\n  columnWidth(col, index) {\n    if (!this.elemWidth) {\n      this.elemWidth = this.element.outerWidth();\n\n      if (this.elemWidth === 0) { // handle on invisible tab container\n        this.elemWidth = this.element.closest('.tab-container').outerWidth();\n      }\n\n      this.widthSpecified = false;\n    }\n\n    // use cache\n    if (this.headerWidths[index]) {\n      const cacheWidths = this.headerWidths[index];\n\n      if (cacheWidths.width === 'default' || !cacheWidths.width) {\n        return '';\n      }\n      return ` style=\"width: ${cacheWidths.width}${cacheWidths.widthPercent ? '%' : 'px'}\"`;\n    }\n    return this.calculateColumnWidth(col, index);\n  },\n\n  /**\n   * Calculate the width for a column (upfront with no rendering)\n   * Simulates https://www.w3.org/TR/CSS21/tables.html#width-layout\n   * @private\n   * @param {object} col The column object to use\n   * @param {number} index The column index\n   * @returns {void}\n   */\n  calculateColumnWidth(col, index) {\n    let colPercWidth;\n    const visibleColumns = this.visibleColumns(true);\n    let lastColumn = (index === this.lastColumnIdx());\n    const container = this.getContainer(col.id);\n\n    if (!this.elemWidth) {\n      this.elemWidth = this.element.outerWidth();\n\n      if (this.elemWidth === 0) { // handle on invisible tab container\n        this.elemWidth = this.element.closest('.tab-container').outerWidth();\n      }\n\n      this.widthSpecified = false;\n      this.widthPixel = false;\n    }\n\n    // use cache\n    if (this.headerWidths[index]) {\n      const cacheWidths = this.headerWidths[index];\n\n      if (cacheWidths.width === 'default') {\n        return '';\n      }\n\n      if (this.widthSpecified && !cacheWidths.width) {\n        return '';\n      }\n\n      return ` style=\"width: ${cacheWidths.width}${cacheWidths.widthPercent ? '%' : 'px'}\"`;\n    }\n\n    // A column element with a value other than 'auto' for the 'width' property\n    // sets the width for that column.\n    if (col.width) {\n      this.widthSpecified = true;\n      this.widthPercent = false;\n    }\n\n    if (!this.widthPixel && col.width) {\n      this.widthPixel = typeof col.width !== 'string';\n    }\n\n    let colWidth = col.width;\n\n    if (typeof col.width === 'string' && col.width.indexOf('px') === -1) {\n      this.widthPercent = true;\n      colPercWidth = col.width.replace('%', '');\n    }\n\n    const textWidth = this.calculateTextWidth(col); // reasonable default on error\n\n    if (!this.widthSpecified || !colWidth) {\n      colWidth = Math.max(textWidth, colWidth || 0);\n    }\n\n    lastColumn = index === this.lastColumnIdx();\n\n    // Simulate Auto Width Algorithm\n    if ((!this.widthSpecified || col.width === undefined) && this.settings.sizeColumnsEqually &&\n      (['selectionCheckbox', 'expander', 'drilldown', 'rowStatus', 'favorite'].indexOf(col.id) === -1)) {\n      const percentWidth = Math.round(this.elemWidth / visibleColumns.length);\n      colWidth = percentWidth - (lastColumn ? 2 : 0); // borders causing scroll\n\n      // Handle Columns where auto width is bigger than the percent width\n      if (percentWidth < textWidth) {\n        colWidth = textWidth;\n      }\n    }\n\n    // Some Built in columns\n    if (col.id === 'selectionCheckbox' || col.id === 'favorite') {\n      colWidth = 43;\n      col.width = colWidth;\n    }\n\n    if (col.id === 'favorite') {\n      colWidth = 62;\n      col.width = colWidth;\n    }\n\n    if (col.id === 'expander') {\n      colWidth = 55;\n      col.width = colWidth;\n    }\n\n    if (col.id === 'rowStatus') {\n      colWidth = 62;\n      col.width = colWidth;\n    }\n\n    if (col.id === 'rowReorder') {\n      colWidth = 62;\n      col.width = colWidth;\n    }\n\n    if (col.id === 'drilldown') {\n      colWidth = 78;\n      col.width = colWidth;\n    }\n\n    // cache the header widths\n    this.headerWidths[index] = {\n      id: col.id,\n      width: (this.widthPercent ? colPercWidth : colWidth),\n      widthPercent: this.widthPercent\n    };\n\n    if (col.id !== 'spacerColumn') {\n      this.totalWidths[container] += col.hidden ? 0 : colWidth;\n    }\n\n    // For the last column stretch it if it doesnt fit the area\n    if (lastColumn && this.isInitialRender && !this.settings.spacerColumn) {\n      const diff = this.elemWidth - this.totalWidths[container];\n\n      if (this.settings.stretchColumn === 'last' && !this.settings.sizeColumnsEqually) {\n        if (diff > 0 && diff > colWidth && !this.widthPercent && !col.width) {\n          colWidth = '';\n          this.headerWidths[index] = {\n            id: col.id,\n            width: colWidth,\n            widthPercent: this.widthPercent\n          };\n          this.totalMinWidths[container] = this.totalWidths[container];\n          this.totalWidths[container] = '100%';\n        }\n        if (diff > 0 && diff < colWidth && !this.widthPercent && !col.width) {\n          colWidth += diff;\n          this.headerWidths[index] = {\n            id: col.id,\n            width: colWidth,\n            widthPercent: this.widthPercent\n          };\n          this.totalWidths[container] += colWidth;\n          this.totalMinWidths[container] = this.totalWidths[container];\n        }\n      }\n\n      if (this.settings.stretchColumn !== 'last') {\n        this.headerWidths[index] = { id: col.id, width: colWidth, widthPercent: this.widthPercent };\n        const diff2 = this.elemWidth - this.totalWidths[container];\n        const stretchColumn = $.grep(this.headerWidths, e => e.id === this.settings.stretchColumn);\n        if ((diff2 > 0) && !stretchColumn[0].widthPercent) {\n          stretchColumn[0].width += diff2 - 2;\n        }\n        this.totalWidths[container] = '100%';\n      }\n\n      if (this.widthPercent) {\n        this.table.css('width', '100%');\n      } else if (!isNaN(this.totalWidths[container])) {\n        this.table.css('width', this.totalWidths.center);\n      }\n      if (!isNaN(this.totalMinWidths.center) && this.totalMinWidths.center > 0) {\n        this.table.css('min-width', `${this.totalMinWidths.center}px`);\n      }\n\n      if (this.hasLeftPane) {\n        this.tableLeft.css('width', this.totalWidths.left);\n      }\n      if (!isNaN(this.totalMinWidths.left) && this.totalMinWidths.left > 0) {\n        this.table.css('min-width', `${this.totalMinWidths.left}px`);\n      }\n      if (this.hasRightPane) {\n        this.tableRight.css('width', this.totalWidths.right);\n      }\n      if (!isNaN(this.totalMinWidths.right) && this.totalMinWidths.right > 0) {\n        this.table.css('min-width', `${this.totalMinWidths.right}px`);\n      }\n      this.isInitialRender = false;\n    }\n\n    if (lastColumn && this.isInitialRender && this.settings.spacerColumn) {\n      const diff = this.elemWidth - this.totalWidths[container];\n      this.totalWidths[container] += diff;\n\n      if ((diff > 0) && !this.widthPercent && !col.width) {\n        this.settings.columns.push({ id: 'spacerColumn', cssClass: 'is-spacer', name: '', field: '', width: diff - 4 - colWidth });\n      }\n    }\n\n    if (lastColumn && this.settings.spacerColumn && this.isInitialRender) {\n      if (this.widthPercent) {\n        this.table.css('width', '100%');\n      } else if (!isNaN(this.totalWidths[container])) {\n        this.table.css('width', this.totalWidths[container]);\n      }\n      this.isInitialRender = false;\n    }\n\n    if (!this.widthPercent && colWidth === undefined) {\n      return '';\n    }\n\n    return ` style=\"width: ${this.widthPercent ? `${colPercWidth}%` : `${colWidth}px`}\"`;\n  },\n\n  /**\n  * Figure out if the row spans and should skip rendiner.\n  * @private\n  * @param  {any} value Value to check\n  * @param  {number} row Row index\n  * @param  {number} col Column index\n  * @returns {void}\n  */\n  calculateRowspan(value, row, col) {\n    let total = 0;\n    let min = null;\n\n    if (!col.rowspan) {\n      return null;\n    }\n\n    for (let i = 0; i < this.settings.dataset.length; i++) {\n      if (value === this.settings.dataset[i][col.field]) {\n        total++;\n        if (min === null) {\n          min = i;\n        }\n      }\n    }\n\n    return row === min ? ` rowspan =\"${total}\"` : '';\n  },\n\n  /**\n  * Summary Row Totals use the aggregators\n  * @private\n  * @returns {number} the total widths\n  */\n  calculateTotals() {\n    this.settings.totals = Aggregators.aggregate(this.settings.dataset, this.settings.columns);\n    return this.settings.totals;\n  },\n\n  /**\n  * Set unit type (pixel or percent)\n  * @private\n  * @param  {any} v value to check\n  * @returns {number} the total widths\n  */\n  setUnit(v) {\n    return v + (/(px|%)/i.test(`${v}`) ? '' : 'px');\n  },\n\n  /**\n   * Setup tooltips on the cells.\n   * @private\n   * @param  {boolean} rowstatus true set tootip with row status\n   * @param  {boolean} isForced true set tootip\n   * @returns {void}\n   */\n  setupTooltips(rowstatus, isForced) {\n    if (!rowstatus && !isForced && !this.settings.enableTooltips) {\n      return;\n    }\n\n    const self = this;\n    const defaultDelay = 400;\n    let tooltipTimer;\n\n    // Set selector\n    const selector = {\n      th: '.datagrid-header th',\n      td: '.datagrid-body tr.datagrid-row td[role=\"gridcell\"]:not(.rowstatus-cell)',\n      rowstatus: '.datagrid-body tr.datagrid-row td[role=\"gridcell\"] .icon-rowstatus'\n    };\n\n    if (this.settings.filterable) {\n      selector.headerColumn = `${selector.th} .datagrid-column-wrapper`;\n      selector.headerFilter = `${selector.th} .datagrid-filter-wrapper .btn-menu`;\n      selector.header = `${selector.headerColumn}, ${selector.headerFilter}`;\n    } else {\n      selector.header = selector.th;\n    }\n\n    selector.iconAlert = `${selector.td} .icon-alert`;\n    selector.iconSuccess = `${selector.td} .icon-success`;\n    selector.iconError = `${selector.td} .icon-error`;\n    selector.iconInfo = `${selector.td} .icon-info`;\n\n    selector.icons = `${selector.iconAlert}, ${selector.iconSuccess}, ${selector.iconError}, ${selector.iconInfo}`;\n\n    // Selector string\n    if (rowstatus && this.settings.enableTooltips) {\n      selector.str = `${selector.header}, ${selector.td}, ${selector.icons}, ${selector.rowstatus}`;\n    } else if (rowstatus) {\n      selector.str = `${selector.header}, ${selector.rowstatus}`;\n    } else {\n      selector.str = `${selector.header}, ${selector.td}, ${selector.icons}`;\n    }\n\n    // Handle tooltip to show\n    const handleShow = (elem, delay) => {\n      delay = typeof delay === 'undefined' ? defaultDelay : delay;\n      tooltipTimer = setTimeout(() => {\n        const isHeaderColumn = utils.hasClass(elem, 'datagrid-column-wrapper');\n        const isHeaderFilter = utils.hasClass(elem.parentNode, 'datagrid-filter-wrapper');\n        const isPopup = isHeaderFilter ?\n          elem.parentNode.querySelectorAll('.popupmenu.is-open').length > 0 : false;\n        const tooltip = $(elem).data('gridtooltip') || self.cacheTooltip(elem);\n        const containerEl = isHeaderColumn ? elem.parentNode : elem;\n        const width = self.getOuterWidth(containerEl);\n        if (tooltip && (tooltip.forced || (tooltip.textwidth > (width - 35))) && !isPopup) {\n          self.showTooltip(tooltip);\n        }\n      }, delay);\n    };\n\n    // Handle tooltip to hide\n    const handleHide = (elem, delay) => {\n      delay = typeof delay === 'undefined' ? defaultDelay : delay;\n      clearTimeout(tooltipTimer);\n      setTimeout(() => {\n        self.hideTooltip();\n        // Clear cache for header filter, so it can use always current selected\n        if (utils.hasClass(elem.parentNode, 'datagrid-filter-wrapper')) {\n          self.removeTooltipData(elem);\n        }\n      }, delay);\n    };\n\n    // Bind events\n    this.element\n      .off('mouseenter.gridtooltip', selector.str)\n      .on('mouseenter.gridtooltip', selector.str, function () {\n        handleShow(this);\n      })\n      .off('mouseleave.gridtooltip click.gridtooltip', selector.str)\n      .on('mouseleave.gridtooltip click.gridtooltip', selector.str, function () {\n        handleHide(this);\n      })\n      .off('longpress.gridtooltip', selector.str)\n      .on('longpress.gridtooltip', selector.str, function () {\n        handleShow(this, 0);\n      })\n      .off('keydown.gridtooltip', selector.str)\n      .on('keydown.gridtooltip', selector.str, function (e) {\n        const key = e.which || e.keyCode || e.charCode || 0;\n        let handle = false;\n\n        if (e.shiftKey && key === 112) { // Shift + F1\n          handleShow(this, 0);\n        } else if (key === 27) { // Escape\n          handle = self.isGridtooltip();\n          handleHide(this, 0);\n        }\n\n        if (handle) {\n          e.preventDefault();\n        }\n        return !handle;\n      });\n  },\n\n  /**\n   * Get outerWidth for a given element.\n   * @private\n   * @param  {boolean} element to calculate the outerWidth\n   * @returns {number} computed outerWidth\n   */\n  getOuterWidth(element) {\n    const style = getComputedStyle(element);\n    let width = element.offsetWidth;\n    width += parseInt(style.marginLeft, 10) + parseInt(style.marginRight, 10);\n    return width;\n  },\n\n  /**\n   * Get closest element of a given element by passing callback to\n   * target by class, id, or tag name\n   * Callback usage as:\n   * const elem = this.element[0].querySelector(selectorString);\n   * class: const closestEl = this.closest(elem, el => el.classList.contains('some-class'));\n   * id: const closestEl = this.closest(elem, el => el.id === 'some-id');\n   * tag: const closestEl = this.closest(elem, el => el.tagName.toLowerCase() === 'some-tag');\n   * http://clubmate.fi/jquerys-closest-function-and-pure-javascript-alternatives/\n   * @private\n   * @param  {object} el The element to start from.\n   * @param  {object} fn The callback function.\n   * @returns {object} The closest element.\n   */\n  closest(el, fn) {\n    return el && (fn(el) ? el : this.closest(el.parentNode, fn));\n  },\n\n  /**\n   * Returns all header nodes (not the groups)\n   * @private\n   * @returns {array} Array with all header dom nodes\n   */\n  headerNodes() {\n    if (!this.headerContainer) {\n      return $();\n    }\n    return this.headerContainer.find('tr:not(.datagrid-header-groups) th');\n  },\n\n  /**\n   * Refresh one row in the grid\n   * @param  {number} idx The row index to update.\n   * @param  {object} data The data object.\n   * @returns {void}\n   */\n  updateRow(idx, data) {\n    const s = this.settings;\n    let rowData = data;\n\n    if (!rowData) {\n      rowData = s.treeGrid ? s.treeDepth[idx].node : s.dataset[idx];\n    }\n\n    for (let j = 0; j < this.settings.columns.length; j++) {\n      const col = this.settings.columns[j];\n\n      if (col.hidden) {\n        continue;\n      }\n\n      this.updateCellNode(idx, j, this.fieldValue(rowData, col.field), true);\n    }\n  },\n\n  /**\n   * Given a new column set update the rows and reload\n   * @param  {array} columns The array with columns to use.\n   * @param  {array} columnGroups The array with new columns groups to use.\n   * @returns {void}\n   */\n  updateColumns(columns, columnGroups) {\n    this.settings.columns = columns;\n\n    if (columnGroups) {\n      this.settings.columnGroups = columnGroups;\n    }\n\n    this.rerender();\n    this.resetPager('updatecolumns');\n\n    /**\n    * Fires after the entire grid is rendered.\n    * @event columnchange\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {HTMLElement} args Additional arguments\n    * @property {string} args.type Info on the type of column change action, can be 'updatecolumns', 'hidecolumn', 'showcolumn', 'resizecolumn'\n    * @property {object} args.columns The columns object\n    */\n    this.element.trigger('columnchange', [{ type: 'updatecolumns', columns: this.settings.columns }]);\n    this.saveUserSettings();\n  },\n\n  /**\n   * Save the columns to local storage\n   * This method is slated to be removed in a future v4.16.0 or v5.0.0.\n   * @deprecated as of v4.10.0. Please use `saveUserSettings()` instead.\n   * @returns {void}\n   */\n  saveColumns() {\n    warnAboutDeprecation(this.saveUserSettings, this.saveColumns);\n\n    if (!this.settings.saveColumns) {\n      return;\n    }\n\n    // Save to local storage\n    if (this.canUseLocalStorage()) {\n      localStorage[this.uniqueId('columns')] = JSON.stringify(this.settings.columns);\n    }\n  },\n\n  /**\n   * Omit events and save to local storage for supported settings.\n   * @returns {void}\n   */\n  saveUserSettings() {\n    /**\n    * Fires after settings are changed in some way\n    * @event settingschanged\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {number} args.rowHeight The current row height\n    * @property {object} args.columns The columns object\n    * @property {string} args.sortOrder The current sort column.\n    * @property {number} args.pagesize The current page size\n    * @property {boolean} args.showPageSizeSelector If the page size selector is shown.\n    * @property {number} args.activePage The currently active page.\n    * @property {string} args.filter Info on the type of column change action, can be 'updatecolumns'\n    */\n    this.element.trigger('settingschanged', [{\n      rowHeight: this.settings.rowHeight,\n      columns: this.settings.columns,\n      sortOrder: this.sortColumn,\n      pagesize: this.settings.pagesize,\n      showPageSizeSelector: this.settings.showPageSizeSelector,\n      activePage: this.pagerAPI ? this.pagerAPI.activePage : 1,\n      filter: this.filterConditions()\n    }]);\n\n    // Save to Local Storage if the settings are set\n    const savedSettings = this.settings.saveUserSettings;\n    if ($.isEmptyObject(savedSettings) || !this.canUseLocalStorage()) {\n      return;\n    }\n\n    // Save Columns\n    if (savedSettings.columns) {\n      localStorage[this.uniqueId('usersettings-columns')] = JSON.stringify(this.settings.columns);\n    }\n\n    // Save Row Height\n    if (savedSettings.rowHeight) {\n      localStorage[this.uniqueId('usersettings-row-height')] = this.settings.rowHeight;\n    }\n\n    // Save Sort Order\n    if (savedSettings.sortOrder) {\n      localStorage[this.uniqueId('usersettings-sort-order')] = JSON.stringify(this.sortColumn);\n    }\n\n    // Save Page Size\n    if (savedSettings.pagesize) {\n      localStorage[this.uniqueId('usersettings-pagesize')] = this.settings.pagesize;\n    }\n\n    // Save Show Page Size Selector\n    if (savedSettings.showPageSizeSelector) {\n      localStorage[this.uniqueId('usersettings-show-pagesize-selector')] = this.settings.showPageSizeSelector;\n    }\n\n    // Save Page Num\n    if (savedSettings.activePage && this.pagerAPI) {\n      localStorage[this.uniqueId('usersettings-active-page')] = this.pagerAPI.activePage;\n    }\n\n    // Filter Conditions\n    if (savedSettings.filter) {\n      localStorage[this.uniqueId('usersettings-filter')] = JSON.stringify(this.filterConditions());\n    }\n  },\n\n  /**\n   * Returns true if local storage may be used / is available\n   * @private\n   * @returns {boolean} If it can be used.\n   */\n  canUseLocalStorage() {\n    try {\n      if (localStorage.getItem) {\n        return true;\n      }\n    } catch (exception) {\n      return false;\n    }\n\n    return false;\n  },\n\n  /**\n   * Parse a JSON array with columns and return the column object.\n   * @private\n   * @param  {string} columnStr The json represntation of the column object.\n   * @returns {array} The array of columns.\n   */\n  columnsFromString(columnStr) {\n    if (!columnStr) {\n      return [];\n    }\n\n    const self = this;\n    const columns = JSON.parse(columnStr);\n\n    if (!columns) {\n      return [];\n    }\n\n    // Map back the missing functions/objects\n    for (let i = 0; i < columns.length; i++) {\n      let isHidden;\n      const orgColumn = self.columnById(columns[i].id);\n\n      if (orgColumn) {\n        isHidden = columns[i].hidden;\n\n        $.extend(columns[i], orgColumn[0]);\n\n        if (isHidden !== undefined) {\n          columns[i].hidden = isHidden;\n        }\n      }\n    }\n\n    return columns;\n  },\n\n  /**\n  * Restore the columns from a provided list or local storage\n  * @param {array} cols - The columns list to restore, if you saved the settings manually.\n  */\n  restoreColumns(cols) {\n    if (!this.settings.saveColumns || !this.canUseLocalStorage()) {\n      return;\n    }\n\n    if (cols) {\n      this.updateColumns(cols);\n      return;\n    }\n\n    // Done on load as apposed to passed in\n    const lsCols = localStorage[this.uniqueId('columns')];\n\n    if (!cols && lsCols) {\n      this.originalColumns = this.settings.columns;\n      this.settings.columns = this.columnsFromString(lsCols);\n    }\n  },\n\n  /**\n   * Restore the user settings from local Storage or as passed in.\n   * @param  {object} settings The object containing the settings to use.\n   * @returns {void}\n   */\n  restoreUserSettings(settings) {\n    const options = this.settings.saveUserSettings;\n\n    if (!settings && ($.isEmptyObject(options) || !this.canUseLocalStorage())) {\n      return;\n    }\n\n    // Restore The data thats passed in\n    if (settings) {\n      if (settings.columns) {\n        this.updateColumns(settings.columns);\n      }\n\n      if (settings.rowHeight) {\n        this.rowHeight(settings.rowHeight);\n      }\n\n      if (settings.sortOrder) {\n        this.setSortColumn(settings.sortOrder.sortId, settings.sortOrder.sortAsc);\n      }\n\n      if (settings.pagesize) {\n        this.settings.pagesize = parseInt(settings.pagesize, 10);\n        this.pagerAPI.settings.pagesize = parseInt(settings.pagesize, 10);\n        this.pagerAPI.setActivePage(1, true);\n      }\n\n      if (settings.showPageSizeSelector) {\n        this.settings.showPageSizeSelector = settings.showPageSizeSelector;\n        this.pagerAPI.showPageSizeSelector(settings.showPageSizeSelector);\n      }\n\n      if (settings.activePage) {\n        this.pagerAPI.setActivePage(parseInt(settings.activePage, 10), true);\n      }\n\n      if (settings.filter) {\n        this.applyFilter(settings.filter, 'restore');\n      }\n      return;\n    }\n\n    // Restore Column Width and Order\n    if (options.columns) {\n      const savedColumns = localStorage[this.uniqueId('usersettings-columns')];\n      if (savedColumns) {\n        this.originalColumns = this.settings.columns;\n        this.settings.columns = this.columnsFromString(savedColumns);\n      }\n    }\n\n    // Restore Row Height\n    if (options.rowHeight) {\n      const savedRowHeight = localStorage[this.uniqueId('usersettings-row-height')];\n\n      if (savedRowHeight) {\n        this.settings.rowHeight = savedRowHeight;\n      }\n    }\n\n    // Restore Sort Order\n    if (options.sortOrder) {\n      const savedSortOrder = localStorage[this.uniqueId('usersettings-sort-order')];\n      if (savedSortOrder) {\n        this.sortColumn = JSON.parse(savedSortOrder);\n        this.restoreSortOrder = true;\n      }\n    }\n\n    // Restore Page Size\n    if (options.pagesize) {\n      const savedPagesize = localStorage[this.uniqueId('usersettings-pagesize')];\n      if (savedPagesize) {\n        this.settings.pagesize = parseInt(savedPagesize, 10);\n      }\n    }\n\n    // Restore Show Page Size Selector\n    if (options.showPageSizeSelector) {\n      let savedShowPageSizeSelector = localStorage[this.uniqueId('usersettings-show-pagesize-selector')];\n      savedShowPageSizeSelector = savedShowPageSizeSelector.toString().toLowerCase() === 'true';\n      if (savedShowPageSizeSelector) {\n        this.settings.showPageSizeSelector = savedShowPageSizeSelector;\n      }\n    }\n\n    // Restore Active Page\n    if (options.activePage) {\n      const savedActivePage = localStorage[this.uniqueId('usersettings-active-page')];\n      if (savedActivePage) {\n        this.savedActivePage = parseInt(savedActivePage, 10);\n        this.restoreActivePage = true;\n      }\n    }\n\n    if (options.filter) {\n      const savedFilter = localStorage[this.uniqueId('usersettings-filter')];\n      if (savedFilter) {\n        this.savedFilter = JSON.parse(savedFilter);\n        this.restoreFilter = true;\n      }\n    }\n  },\n\n  /**\n  * Reset Columns to defaults (used on restore menu item)\n  */\n  resetColumns() {\n    if (this.canUseLocalStorage()) {\n      localStorage.removeItem(this.uniqueId('columns'));\n    }\n\n    if (this.originalColumns) {\n      const originalColumns = this.columnsFromString(JSON.stringify(this.originalColumns));\n      const columnGroups = this.settings.columnGroups && this.originalColGroups ?\n        this.originalColGroups : null;\n      this.updateColumns(originalColumns, columnGroups);\n    }\n\n    this.clearFilter();\n  },\n\n  /**\n  * Hide a column.\n  * @param {string} id The id of the column to hide.\n  */\n  hideColumn(id) {\n    let idx = this.columnIdxById(id);\n\n    if (idx === -1) {\n      return;\n    }\n\n    this.settings.columns[idx].hidden = true;\n    this.headerNodes().eq(idx).addClass('is-hidden');\n    this.tableBody.find(`> tr > td:nth-child(${idx + 1})`).addClass('is-hidden');\n    this.headerColGroup.find('col').eq(idx).addClass('is-hidden');\n\n    // Shrink or remove colgroups\n    this.updateColumnGroup();\n\n    if (this.bodyColGroup) {\n      this.bodyColGroup.find('col').eq(idx).addClass('is-hidden');\n    }\n\n    // Handle colSpans if present on the column\n    if (this.hasColSpans) {\n      let colSpan = this.headerContainer.find('th').eq(idx).attr('colspan');\n\n      if (colSpan && colSpan > 0) {\n        colSpan -= 1;\n        for (let i = 0; i < colSpan; i++) {\n          idx += colSpan;\n          this.tableBody.find(`> tr > td:nth-child(${idx + 1})`).addClass('is-hidden');\n        }\n      }\n    }\n\n    // Handle expandable rows\n    if (this.settings.rowTemplate || this.settings.expandableRow) {\n      this.syncExpandableRowColspan();\n    }\n\n    this.element.trigger('columnchange', [{ type: 'hidecolumn', index: idx, columns: this.settings.columns }]);\n    this.saveUserSettings();\n  },\n\n  /**\n  * Sync the colspan on the expandable row. (When column count changes)\n  * @private\n  */\n  syncExpandableRowColspan() {\n    const visibleColumnCount = this.visibleColumns().length;\n    this.tableBody.find('.datagrid-expandable-row > td').attr('colspan', visibleColumnCount);\n  },\n\n  /**\n  * Show a hidden column.\n  * @param {string} id The id of the column to show.\n  */\n  showColumn(id) {\n    let idx = this.columnIdxById(id);\n\n    if (idx === -1) {\n      return;\n    }\n\n    this.settings.columns[idx].hidden = false;\n    this.headerNodes().eq(idx).removeClass('is-hidden');\n    this.tableBody.find(`> tr > td:nth-child(${idx + 1})`).removeClass('is-hidden');\n    this.headerColGroup.find('col').eq(idx).removeClass('is-hidden');\n\n    if (this.bodyColGroup) {\n      this.bodyColGroup.find('col').eq(idx).removeClass('is-hidden');\n    }\n\n    // Shrink or add colgroups\n    this.updateColumnGroup();\n\n    // Handle colSpans if present on the column\n    if (this.hasColSpans) {\n      let colSpan = this.headerContainer.find('th').eq(idx).attr('colspan');\n\n      if (colSpan && colSpan > 0) {\n        colSpan -= 1;\n        for (let i = 0; i < colSpan; i++) {\n          idx += colSpan;\n          this.tableBody.find(`> tr > td:nth-child(${idx + 1})`).removeClass('is-hidden');\n        }\n      }\n    }\n\n    // Handle expandable rows\n    if (this.settings.rowTemplate || this.settings.expandableRow) {\n      this.syncExpandableRowColspan();\n    }\n\n    this.element.trigger('columnchange', [{ type: 'showcolumn', index: idx, columns: this.settings.columns }]);\n    this.saveUserSettings();\n  },\n\n  /**\n  * Export the grid contents to csv\n  * @param {string} fileName The desired export filename in the download.\n  * @param {string} customDs An optional customized version of the data to use.\n  * @param {string} separator (optional) If user's machine is configured for a locale with alternate default seperator.\n  */\n  exportToCsv(fileName, customDs, separator) {\n    excel.exportToCsv(fileName, customDs, separator, this);\n  },\n\n  /**\n  * Export the grid contents to xls format. This may give a warning when opening the file.\n  * exportToCsv may be prefered.\n  * Consider Deprecated use excel.exportToExcel\n  * @param {string} fileName The desired export filename in the download.\n  * @param {string} worksheetName A name to give the excel worksheet tab.\n  * @param {string} customDs An optional customized version of the data to use.\n  */\n  exportToExcel(fileName, worksheetName, customDs) {\n    excel.exportToExcel(fileName, worksheetName, customDs, this);\n  },\n\n  copyToDataSet(pastedValue, rowCount, colIndex, dataSet) {\n    excel.copyToDataSet(pastedValue, rowCount, colIndex, dataSet, this);\n  },\n\n  /**\n  * Open the personalization dialog.\n  * @private\n  */\n  personalizeColumns() {\n    const self = this;\n    let spanNext = 0;\n    let markup = `<div class=\"listview-search alternate-bg\"><label class=\"audible\" for=\"gridfilter\">Search</label><input class=\"searchfield\" placeholder=\"${Locale.translate('SearchColumnName')}\" name=\"searchfield\" id=\"gridfilter\"></div>`;\n    markup += '<div class=\"listview alternate-bg\" id=\"search-listview\"><ul>';\n\n    for (let i = 0; i < this.settings.columns.length; i++) {\n      const col = this.settings.columns[i];\n      let colName = col.name;\n\n      if (colName && spanNext <= 0) {\n        colName = colName.replace('<br>', ' ').replace('<br/>', ' ').replace('<br />', ' ');\n        markup += `<li><a href=\"#\" target=\"_self\" tabindex=\"-1\"> <label class=\"inline\"><input tabindex=\"-1\" ${col.hideable === false ? 'disabled' : ''} type=\"checkbox\" class=\"checkbox\" ${col.hidden ? '' : ' checked'} data-column-id=\"${col.id || i}\"><span class=\"label-text\">${colName}</span></label></a></li>`;\n      }\n\n      if (spanNext > 0) {\n        spanNext--;\n      }\n\n      if (col.colspan) {\n        spanNext = col.colspan - 1;\n      }\n    }\n    markup += '</ul></div>';\n\n    $('body').modal({\n      title: Locale.translate('PersonalizeColumns'),\n      content: markup,\n      cssClass: 'full-width datagrid-columns-dialog',\n      buttons: [{\n        text: Locale.translate('Close'),\n        click(e, modal) {\n          modal.close();\n          $('body').off('open.datagrid');\n        }\n      }]\n    }).on('beforeopen.datagrid', () => {\n      self.isColumnsChanged = false;\n    }).on('open.datagrid', (e, modal) => {\n      modal.element.find('.searchfield').searchfield({ clearable: true });\n      modal.element.find('.listview').listview({ searchable: true, selectOnFocus: false })\n        .on('selected', (selectedEvent, args) => {\n          const chk = args.elem.find('.checkbox');\n          const id = chk.attr('data-column-id');\n          const isChecked = chk.prop('checked');\n\n          args.elem.removeClass('is-selected hide-selected-color');\n\n          if (chk.is(':disabled')) {\n            return;\n          }\n          self.isColumnsChanged = true;\n\n          if (!isChecked) {\n            self.showColumn(id);\n            chk.prop('checked', true);\n          } else {\n            self.hideColumn(id);\n            chk.prop('checked', false);\n          }\n        });\n\n      modal.element.on('close.datagrid', () => {\n        self.isColumnsChanged = false;\n      });\n      modal.element.on('keydown.datagrid', (event) => {\n        // Escape Button Code. Make sure to close the modal correctly.\n        if (event.keyCode === 27) {\n          modal.close();\n          $('body').off('open.datagrid');\n        }\n      });\n    });\n  },\n\n  /**\n  * Explicitly Set the width of a column\n  * @private\n  * @param {string} id Specifies if the column info is provide by id or as a node reference.\n  * @param {number} width The width of the column\n  * @param {number} diff The difference between the old and new width\n  */\n  setColumnWidth(id, width) {\n    const self = this;\n    const percent = parseFloat(width);\n    const columnSettings = this.columnById(id)[0];\n    let idx = -1;\n\n    if (!percent) {\n      return;\n    }\n\n    if (typeof id === 'string') {\n      self.headerNodes().each(function (i) {\n        const col = $(this);\n\n        if (col.attr('data-column-id') === id) {\n          idx = i;\n        }\n      });\n    }\n\n    // calculate percentage\n    if (typeof width !== 'number') {\n      width = (percent / 100) * self.element.width();\n    }\n\n    // Prevent Sub Pixel Thrashing\n    if (Math.abs(width - columnSettings.width) < 2) {\n      return;\n    }\n\n    // Handle Col Span - as the width is calculated on the total\n    if (typeof columnSettings.colspan === 'number') {\n      width /= columnSettings.colspan;\n    }\n\n    // Save the column back in settings for later\n    if (columnSettings) {\n      columnSettings.width = width;\n    }\n\n    this.element.trigger('columnchange', [{ type: 'resizecolumn', index: idx, columns: this.settings.columns }]);\n    this.saveUserSettings();\n    this.headerWidths[idx].width = width;\n  },\n\n  /**\n   * Check if given column header should be able to set active ellipsis\n   * @private\n   * @param {string} column to check ellipsis\n   * @returns {boolean} true if should be able to set ellipsis\n   */\n  isEllipsisActiveHeader(column) {\n    column = column || {};\n    const isSortable = (column.sortable === undefined ? true : column.sortable);\n    return isSortable && (column.textOverflow === 'ellipsis');\n  },\n\n  /**\n   * Set active ellipsis on all columns header\n   * @private\n   * @returns {void}\n   */\n  activeEllipsisHeaderAll() {\n    for (let i = 0, l = this.settings.columns.length; i < l; i++) {\n      const id = this.settings.columns[i].id;\n      const column = this.columnById(id)[0];\n      if (this.isEllipsisActiveHeader(column)) {\n        const columnEl = this.headerContainer[0].querySelector(`th[data-column-id=\"${id}\"]`);\n        this.activeEllipsisHeader(columnEl);\n      }\n    }\n  },\n\n  /**\n   * Set active ellipsis on given column header\n   * @private\n   * @param {string} columnEl to set ellipsis active\n   * @returns {void}\n   */\n  activeEllipsisHeader(columnEl) {\n    if (columnEl) {\n      const textEl = columnEl.querySelector('.datagrid-column-wrapper .datagrid-header-text');\n      const isEllipsisActive = columnEl.scrollWidth < (textEl.scrollWidth + 65);// 65:sort-icons\n      columnEl.classList[isEllipsisActive ? 'add' : 'remove']('is-ellipsis-active');\n    }\n  },\n\n  /**\n   * Change the width of the column as the user drags the resizeHandle\n   * @private\n   * @param {boolean} idOrNode Specifies if the column info is provide by id or as a node reference.\n   * @param {number} width The width of the column\n   * @param {number} diff The difference between the old and new width\n   */\n  resizeColumnWidth(idOrNode, width, diff) {\n    const idx = idOrNode.index();\n    this.headerColGroup.find('col').eq(idx)[0].style.width = (`${width}px`);\n\n    if (this.settings.dataset.length > 0) {\n      this.bodyColGroup.find('col').eq(idx)[0].style.width = (`${width}px`);\n    }\n\n    if (this.tableWidth && diff) {\n      this.headerTable.css('width', parseInt(this.tableWidth, 10) + diff);\n      this.table.css('width', parseInt(this.tableWidth, 10) + diff);\n    }\n  },\n\n  /**\n  * Generate the ui handles used to resize columns.\n  * @private\n  */\n  createResizeHandle() {\n    const self = this;\n    if (this.resizeHandle) {\n      return;\n    }\n\n    this.resizeHandle = $('<div class=\"resize-handle\" aria-hidden=\"true\"></div>');\n    if (this.settings.columnGroups) {\n      this.resizeHandle[0].style.height = '80px';\n    }\n\n    if (this.settings.filterable) {\n      this.resizeHandle[0].style.height = '62px';\n    }\n\n    this.headerContainerCenter.find('table').before(this.resizeHandle);\n\n    let columnId;\n    let startingLeft;\n    let draggingLeft;\n    let columnStartWidth;\n    let column;\n\n    this.resizeHandle.drag({ axis: 'x', containment: this.element })\n      .on('dragstart.datagrid', () => {\n        if (!self.currentHeader) {\n          return;\n        }\n\n        self.dragging = true;\n\n        columnId = self.currentHeader.attr('data-column-id');\n        column = self.columnById(columnId)[0]; // eslint-disable-line\n\n        startingLeft = self.currentHeader.position().left + (self.table.scrollLeft() - 10);\n        self.tableWidth = self.table[0].offsetWidth;\n        columnStartWidth = self.currentHeader[0].offsetWidth;\n        if (self.isEllipsisActiveHeader(column)) {\n          self.currentHeader[0].classList.add('is-ellipsis-active');\n        }\n      })\n      .on('drag.datagrid', (e, ui) => {\n        if (!self.currentHeader || !column) {\n          return;\n        }\n\n        let width = (ui.left - startingLeft - 1);\n        const minWidth = column.minWidth || 12;\n        const maxWidth = column.maxWidth || 1000;\n\n        if (width < minWidth || width > maxWidth) {\n          self.resizeHandle.css('cursor', 'inherit');\n          return;\n        }\n\n        width = Math.round(width);\n        draggingLeft = ui.left;\n        self.resizeColumnWidth(self.currentHeader, width, width - columnStartWidth);\n      })\n      .on('dragend.datagrid', () => {\n        const width = (draggingLeft - startingLeft - 1);\n        self.dragging = false;\n        self.setColumnWidth(self.currentHeader.attr('data-column-id'), width);\n        if (self.isEllipsisActiveHeader(column)) {\n          self.activeEllipsisHeader(self.currentHeader[0]);\n        }\n      });\n  },\n\n  /**\n  * Show Summary and any other count info\n  * @private\n  * @param {boolean} totals The total to display on the UI.\n  */\n  displayCounts(totals) {\n    const self = this;\n    let count = self.tableBody.find('tr:visible').length;\n    const isClientSide = self.settings.paging && !(self.settings.source);\n\n    if (isClientSide || (!totals)) {\n      this.recordCount = self.settings.dataset.length;\n      count = self.settings.dataset.length;\n    }\n\n    // Update Selected\n    if (self.contextualToolbar && self.contextualToolbar.length) {\n      self.contextualToolbar.find('.selection-count').text(`${self._selectedRows.length} ${Locale.translate('Selected')}`);\n    }\n\n    if (totals && totals !== -1) {\n      count = totals;\n    }\n\n    if (!totals && this.settings.source) {\n      count = this.lastCount;\n    }\n\n    const formatInteger = v => Locale.formatNumber(v, { style: 'integer' });\n    let countText;\n    if (self.settings.showFilterTotal && self.filteredCount > 0) {\n      countText = `(${Locale.translate(count === 1 ? 'ResultOf' : 'ResultsOf')})`;\n      countText = countText.replace('{0}', formatInteger(count - self.filteredCount));\n      countText = countText.replace('{1}', formatInteger(count));\n    } else {\n      countText = `({0} ${Locale.translate(count === 1 ? 'Result' : 'Results')})`;\n      countText = countText.replace('{0}', formatInteger(count));\n    }\n\n    if (self.settings.resultsText) {\n      if (typeof self.settings.resultsText === 'function') {\n        if (self.grandTotal) {\n          countText = self.settings.resultsText(self, self.grandTotal, count);\n        } else {\n          const filteredCount = (self.filteredCount === 0 ? 0 : count - self.filteredCount);\n          countText = self.settings.resultsText(self, count, filteredCount);\n        }\n      } else {\n        countText = self.settings.resultsText;\n      }\n    }\n\n    if (self.toolbar) {\n      DOM.html(self.toolbar.find('.datagrid-result-count'), countText, '<span>');\n      self.toolbar[0].setAttribute('aria-label', self.toolbar.find('.title').text());\n      self.toolbar.find('.datagrid-row-count').text(count);\n    }\n    DOM.html(self.element.closest('.modal').find('.datagrid-result-count'), countText, '<span>');\n    this.lastCount = count;\n\n    this.checkEmptyMessage();\n  },\n\n  /**\n  * Set the content dynamically on the empty message area.\n  * @param {object} emptyMessage The update empty message config object.\n  */\n  setEmptyMessage(emptyMessage) {\n    if (!this.emptyMessage) {\n      this.emptyMessageContainer = $('<div>');\n      this.bodyContainer.before(this.emptyMessageContainer);\n      this.emptyMessage = this.emptyMessageContainer.emptymessage(emptyMessage).data('emptymessage');\n      this.checkEmptyMessage();\n    } else {\n      this.emptyMessage.settings = emptyMessage;\n      this.emptyMessage.updated();\n    }\n  },\n\n  /**\n  * See if the empty message object should be shown.\n  * @private\n  */\n  checkEmptyMessage() {\n    if (this.emptyMessage && this.emptyMessageContainer) {\n      if (this.filteredCount === this.recordCount || this.recordCount === 0) {\n        this.emptyMessageContainer.show();\n        this.element.addClass('is-empty');\n      } else {\n        this.emptyMessageContainer.hide();\n        this.element.removeClass('is-empty');\n      }\n    }\n  },\n\n  /**\n  * Trigger event on parent and compose the args\n  * @private\n  * @param  {strung} eventName Event to trigger\n  * @param  {object} e  Actual event\n  * @param  {boolean} stopPropagation If stopPropagation should be done\n  * @returns {boolean} False when the event should not propagte.\n  */\n  triggerRowEvent(eventName, e, stopPropagation) {\n    const self = this;\n    const cell = $(e.target).closest('td').index();\n    const rowElem = $(e.target).closest('tr');\n    let row = this.settings.treeGrid ? this.actualRowIndex(rowElem) : this.dataRowIndex(rowElem);\n    let isTrigger = true;\n\n    if ($(e.target).is('a')) {\n      stopPropagation = false;\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n\n    let item = self.settings.dataset[row];\n\n    //  Groupable\n    if (this.settings.groupable) {\n      if (rowElem.is('.datagrid-rowgroup-header, .datagrid-rowgroup-footer')) {\n        isTrigger = false; // No need to trigger if no data item\n      } else {\n        row = self.actualPagingRowIndex(self.actualRowIndex(rowElem));\n        item = self.settings.dataset[self.groupArray[row].group];\n        if (item && item.values) {\n          item = item.values[self.groupArray[row].node];\n        }\n      }\n    }\n\n    if (isTrigger) {\n      self.element.trigger(eventName, [{ row, cell, item, originalEvent: e }]);\n    }\n\n    return false;\n  },\n\n  /**\n   * Sync the containers when scrolling on the y axis.\n   * @private\n   */\n  handleScrollX() {\n    const left = this.bodyWrapperCenter[0].scrollLeft;\n\n    if (left !== this.scrollLeft && this.headerContainerCenter) {\n      this.scrollLeft = left;\n      this.headerContainerCenter[0].scrollLeft = this.scrollLeft;\n    }\n  },\n\n  /**\n   * Sync the containers when scrolling on the y axis.\n   * @private\n   * @param  {jQuery} e The event object\n   */\n  handleScrollY(e) {\n    const elem = e.currentTarget;\n    const top = elem.scrollTop;\n\n    if (top !== this.scrollTop && this.bodyWrapperCenter &&\n      (this.bodyWrapperLeft || this.bodyWrapperRight)) {\n      this.scrollTop = top;\n\n      if (this.bodyWrapperLeft) {\n        this.bodyWrapperLeft[0].scrollTop = this.scrollTop;\n      }\n      if (this.bodyWrapperRight) {\n        this.bodyWrapperRight[0].scrollTop = this.scrollTop;\n      }\n      this.bodyWrapperCenter[0].scrollTop = this.scrollTop;\n    }\n  },\n\n  /**\n  * Resize event handler.\n  * @private\n  */\n  rerender() {\n    this.clearHeaderCache();\n    this.renderRows();\n    this.renderHeader();\n  },\n\n  /**\n   * Attach All relevant event handlers.\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n    const isMultiple = this.settings.selectable === 'multiple';\n    const isMixed = this.settings.selectable === 'mixed';\n\n    // Set Focus on rows\n    if (!self.settings.cellNavigation && self.settings.rowNavigation) {\n      self.bodyContainer\n        .on('focus.datagrid', 'tbody > tr', function () {\n          $(this).addClass('is-active-row');\n        })\n        .on('blur.datagrid', 'tbody > tr', () => {\n          $('tbody > tr', self.table).removeClass('is-active-row');\n        });\n    }\n\n    // Handle Paging\n    if (this.settings.paging) {\n      this.element.on(`afterpaging.${COMPONENT_NAME}`, (e, args) => {\n      // Hide the entire pager bar if we're only showing one page, if applicable\n        if (self.pagerAPI.hidePagerBar(args)) {\n          self.element.removeClass('paginated');\n        } else {\n          self.element.addClass('paginated');\n        }\n\n        self.recordCount = args.total;\n        self.displayCounts(args.total);\n\n        // Handle row selection across pages\n        self.syncSelectedUI();\n\n        if (self.filterExpr && self.filterExpr[0] && self.filterExpr[0].column === 'all') {\n          self.highlightSearchRows(self.filterExpr[0].value);\n        }\n      });\n\n      this.tableBody.on(`page.${COMPONENT_NAME}`, (e, pagingInfo) => {\n        if (pagingInfo.type === 'filtered' && this.settings.source) {\n          return;\n        }\n        self.render(null, pagingInfo);\n      }).on(`pagesizechange.${COMPONENT_NAME}`, (e, pagingInfo) => {\n        self.render(null, pagingInfo);\n      });\n    }\n\n    // Handle Hover States\n    if (self.settings.showHoverState) {\n      self.bodyContainer\n        .off('mouseenter.datagrid, mouseleave.datagrid')\n        .on('mouseenter.datagrid', 'tbody > tr', function () {\n          const rowNodes = self.rowNodes($(this));\n          rowNodes.addClass('is-hover-row');\n        }).on('mouseleave.datagrid', 'tbody > tr', function () {\n          const rowNodes = self.rowNodes($(this));\n          rowNodes.removeClass('is-hover-row');\n        });\n    }\n\n    // Sync Header and Body During scrolling\n    self.bodyContainer.find('.datagrid-body')\n      .on('scroll.table', (e) => {\n        self.handleScrollY(e);\n      });\n\n    if (this.hasLeftPane || this.hasRightPane) {\n      self.bodyContainer.find('.datagrid-body')\n        .on('wheel.table', (e) => {\n          if (e.originalEvent.deltaY !== 0) {\n            e.currentTarget.scrollTop += (e.originalEvent.deltaY);\n            e.preventDefault();\n            self.handleScrollY(e);\n          }\n        });\n    }\n\n    self.bodyContainer.find('.datagrid-body.scroll-x')\n      .on('scroll.tablex', (e) => {\n        self.handleScrollX(e);\n      });\n\n    if (this.settings.virtualized) {\n      let oldScroll = 0;\n      let oldHeight = 0;\n\n      self.bodyWrapperCenter\n        .on('scroll.vtable', debounce(function () {\n          const scrollTop = this.scrollTop;\n          const buffer = 25;\n          const hitBottom = scrollTop >\n            (self.virtualRange.bottom - self.virtualRange.bodyHeight - buffer);\n          const hitTop = scrollTop < (self.virtualRange.top + buffer);\n\n          if (scrollTop !== oldScroll && (hitTop || hitBottom)) {\n            oldScroll = this.scrollTop;\n            self.renderRows();\n          }\n        }, 0));\n\n      $('body').on('resize.vtable', function () {\n        const height = this.offsetHeight;\n\n        if (height !== oldHeight) {\n          oldHeight = this.scrollTop;\n          self.renderRows();\n        }\n      });\n    }\n\n    // Handle Sorting\n    this.headerContainer\n      .off('click.datagrid-header')\n      .on('click.datagrid-header', '.datagrid-header th.is-sortable, .datagrid-header th.btn-filter', function (e) {\n        if ($(e.target).parent().is('.datagrid-filter-wrapper') || $(e.target).parent().is('.lookup-wrapper')) {\n          return;\n        }\n\n        self.setSortColumn($(this).attr('data-column-id'));\n      });\n\n    // Prevent redirects\n    this.element\n      .off('click.datagrid')\n      .on('click.datagrid', 'tbody .datagrid-row a', (e) => {\n        const href = e.currentTarget.getAttribute('href');\n        if (!href || href === '#') {\n          e.preventDefault();\n        }\n      });\n\n    // Add a paste event for handling pasting from excel\n    if (self.settings.editable) {\n      this.element.off('paste.datagrid').on('paste.datagrid', (e) => {\n        let pastedData;\n        if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.getData) {\n          pastedData = e.originalEvent.clipboardData.getData('text/plain');\n        } else {\n          pastedData = window.clipboardData && window.clipboardData.getData ? window.clipboardData.getData('Text') : false;\n        }\n\n        const hasLineFeed = /\\n/.exec(pastedData);\n        const hasCarriageReturn = /\\r/.exec(pastedData);\n        const hasBoth = /\\r\\n/.exec(pastedData);\n\n        if (self.activeCell && self.activeCell.node.hasClass('is-readonly')) {\n          return; // disallow pasting on non editable cells.\n        }\n\n        if (pastedData && hasCarriageReturn || hasLineFeed || hasBoth) {\n          let splitData = hasLineFeed ? pastedData.split('\\n') : pastedData.split('\\r');\n          if (hasBoth) {\n            splitData = pastedData.split('\\r\\n');\n          }\n\n          splitData.pop();\n\n          const startRowCount = parseInt($(e.target)[0].parentElement.parentElement.parentElement.getAttribute('data-index'), 10);\n          const startColIndex = parseInt($(e.target)[0].parentElement.parentElement.getAttribute('aria-colindex'), 10) - 1;\n\n          if (self.editor && self.editor.input && !this.editor.stayInEditMode) {\n            self.commitCellEdit(self.editor.input);\n          }\n          self.copyToDataSet(splitData, startRowCount, startColIndex, self.settings.dataset);\n        }\n      });\n    }\n\n    this.element.off('click.datagrid').on('click.datagrid', 'tbody td', function (e) {\n      let rowNode = null;\n      let dataRowIdx = null;\n      const target = $(e.target);\n\n      if ($(e.currentTarget).parent().hasClass('.datagrid-row-detail')) {\n        return;\n      }\n\n      if (target.parents('td').length > 1) {\n        e.preventDefault(); // stop nested clicks from propagating\n        e.stopPropagation();\n      }\n\n      /**\n      * Fires after a row is clicked.\n      * @event click\n      * @memberof Datagrid\n      * @property {object} event The jquery event object\n      * @property {object} args Additional arguments\n      * @property {number} args.row The current row height\n      * @property {number} args.cell The columns object\n      * @property {object} args.item The current sort column.\n      * @property {object} args.originalEvent The original event object.\n      */\n      self.triggerRowEvent('click', e, true);\n      self.setActiveCell(target.closest('td'));\n\n      // Dont Expand rows or make cell editable when clicking expand button\n      if (target.is('.datagrid-expand-btn')) {\n        rowNode = $(this).closest('tr');\n        dataRowIdx = self.actualRowIndex(rowNode);\n\n        self.toggleRowDetail(dataRowIdx);\n        self.toggleGroupChildren(rowNode);\n        self.toggleChildren(e, dataRowIdx);\n        return false; //eslint-disable-line\n      }\n\n      const isSelectionCheckbox = target.is('.datagrid-selection-checkbox') ||\n                                target.find('.datagrid-selection-checkbox').length === 1;\n      let canSelect = self.settings.clickToSelect ? true : isSelectionCheckbox;\n\n      if (target.is('.datagrid-drilldown')) {\n        canSelect = false;\n      }\n\n      if (isMixed) {\n        canSelect = isSelectionCheckbox;\n\n        // Then Activate\n        if (!canSelect) {\n          if (e.shiftKey && self.activatedRow().length) {\n            self.selectRowsBetweenIndexes([self.activatedRow()[0].row, target.closest('tr').index()]);\n            e.preventDefault();\n          }\n\n          self.toggleRowActivation(target.closest('tr'));\n        }\n      }\n\n      if (canSelect && isMultiple && e.shiftKey) {\n        self.selectRowsBetweenIndexes([self.lastSelectedRow, target.closest('tr').index()]);\n        e.preventDefault();\n      } else if (canSelect) {\n        self.toggleRowSelection(target.closest('tr'));\n      }\n\n      const isEditable = self.makeCellEditable(self.activeCell.rowIndex, self.activeCell.cell, e);\n\n      // Handle Cell Click Event\n      const elem = $(this).closest('td');\n      const cell = elem.attr('aria-colindex') - 1;\n      const col = self.columnSettings(cell);\n\n      if (col.click && typeof col.click === 'function' && target.is('button, input[checkbox], a') || target.parent().is('button')) {   //eslint-disable-line\n        const rowElem = $(this).closest('tr');\n        let rowIdx = self.actualRowIndex(rowElem);\n        dataRowIdx = self.dataRowIndex(rowElem);\n        let item = self.settings.treeGrid ?\n          self.settings.treeDepth[rowIdx].node :\n          self.settings.dataset[dataRowIdx];\n\n        if (elem.hasClass('is-focusable')) {\n          if (!target.is(self.buttonSelector)) {\n            if (!target.parent('button').is(self.buttonSelector)) {\n              return;\n            }\n          }\n        }\n\n        if (self.settings.groupable) {\n          if (!rowElem.is('.datagrid-rowgroup-header, .datagrid-rowgroup-footer')) {\n            rowIdx = self.actualPagingRowIndex(self.actualRowIndex(rowElem));\n            item = self.settings.dataset[self.groupArray[rowIdx].group];\n            if (item && item.values) {\n              item = item.values[self.groupArray[rowIdx].node];\n            }\n          }\n        }\n\n        if (!elem.hasClass('is-cell-readonly') && target.is('button, input[checkbox], a') || target.parent().is('button')) {  //eslint-disable-line\n          col.click(e, [{ row: rowIdx, cell: self.activeCell.cell, item, originalEvent: e }]);\n        }\n      }\n\n      // Handle Context Menu on Some\n      if (col.menuId) {\n        const btn = $(this).find('button');\n        btn.popupmenu({ attachToBody: true, autoFocus: false, mouseFocus: true, menuId: col.menuId, trigger: 'immediate', offset: { y: 5 } });\n\n        if (col.selected) {\n          btn.on('selected.datagrid', col.selected);\n        }\n      }\n\n      // Apply Quick Edit Mode\n      if (isEditable) {\n        setTimeout(() => {\n          if ($('textarea, input', elem).length &&\n              (!$('.dropdown,' +\n              '[type=file],' +\n              '[type=image],' +\n              '[type=button],' +\n              '[type=submit],' +\n              '[type=reset],' +\n              '[type=checkbox],' +\n              '[type=radio]', elem).length)) {\n            self.quickEditMode = true;\n          }\n        }, 0);\n      }\n    });\n\n    if (this.stretchColumn !== 'last') {\n      $(window).on('orientationchange.datagrid', () => {\n        this.rerender();\n      });\n    }\n\n    /**\n    * Fires after a row is double clicked.\n    * @event dblclick\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {number} args.row The current row height\n    * @property {number} args.cell The columns object\n    * @property {object} args.item The current sort column.\n    * @property {object} args.originalEvent The original event object.\n    */\n    this.element.off('dblclick.datagrid').on('dblclick.datagrid', 'tbody tr', (e) => {\n      self.triggerRowEvent('dblclick', e, true);\n    });\n\n    /**\n    * Fires after a row has a right click action.\n    * @event contextmenu\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {number} args.row The current row height\n    * @property {number} args.cell The columns object\n    * @property {object} args.item The current sort column.\n    * @property {object} args.originalEvent The original event object.\n    */\n    this.element.off('contextmenu.datagrid').on('contextmenu.datagrid', 'tbody tr', (e) => {\n      if (!self.isSubscribedTo(e, 'contextmenu')) {\n        return;\n      }\n\n      self.triggerRowEvent('contextmenu', e, (!!self.settings.menuId));\n      e.preventDefault();\n\n      if (self.settings.menuId && $(`#${self.settings.menuId}`).length > 0) {\n        $(e.currentTarget).popupmenu({\n          menuId: self.settings.menuId,\n          eventObj: e,\n          beforeOpen: self.settings.menuBeforeOpen,\n          attachToBody: true,\n          trigger: 'immediate'\n        })\n          .off('selected').on('selected', (selectedEvent, args) => {\n            if (self.settings.menuSelected) {\n              self.settings.menuSelected(selectedEvent, args);\n            }\n          })\n          .off('close')\n          .on('close', function () {\n            const elem = $(this);\n            if (elem.data('popupmenu')) {\n              elem.data('popupmenu').destroy();\n            }\n          });\n      }\n\n      return false; // eslint-disable-line\n    });\n\n    // Move the drag handle to the end or start of the column\n    this.headerRow\n      .off('mousemove.datagrid')\n      .on('mousemove.datagrid', 'th', (e) => {\n        if (self.dragging) {\n          return;\n        }\n\n        self.currentHeader = $(e.target).closest('th');\n\n        if (!self.currentHeader.hasClass('is-resizable')) {\n          return;\n        }\n\n        const headerDetail = self.currentHeader.closest('.header-detail');\n        const extraMargin = headerDetail.length ? parseInt(headerDetail.css('margin-left'), 10) : 0;\n        const leftEdge = (parseInt(self.currentHeader.position().left, 10) - (extraMargin || 0)) +\n          self.element.scrollLeft();\n        const rightEdge = leftEdge + self.currentHeader.outerWidth();\n        const alignToLeft = (e.pageX - leftEdge > rightEdge - e.pageX);\n        let leftPos = 0;\n        leftPos = (alignToLeft ? (rightEdge - 6) : (leftEdge - 6));\n\n        // Ignore First Column\n        if (self.currentHeader.index() === 0 && !alignToLeft) {\n          leftPos = '-999';\n        }\n\n        if (!alignToLeft) {\n          self.currentHeader = self.currentHeader.prevAll(':visible').not('.is-hidden').first();\n        }\n\n        if (!self.currentHeader.hasClass('is-resizable')) {\n          return;\n        }\n\n        self.createResizeHandle();\n        self.resizeHandle[0].style.left = `${leftPos}px`;\n        self.resizeHandle[0].style.cursor = '';\n      }).off('contextmenu.datagrid').on('contextmenu.datagrid', 'th', (e) => {\n        // Add Header Context Menu Support\n        e.preventDefault();\n\n        if (self.settings.headerMenuId) {\n          $(e.currentTarget)\n            .popupmenu({\n              menuId: self.settings.headerMenuId,\n              eventObj: e,\n              attachToBody: true,\n              beforeOpen: self.settings.headerMenuBeforeOpen,\n              trigger: 'immediate'\n            })\n            .off('selected.gridpopup')\n            .on('selected.gridpopup', (selectedEvent, args) => {\n              self.settings.headerMenuSelected(selectedEvent, args);\n            });\n        }\n\n        return false;\n      });\n\n    // Handle Clicking Header Checkbox\n    this\n      .headerContainer\n      .off('click.datagrid-header-select')\n      .on('click.datagrid-header-select', 'th .datagrid-checkbox', function () {\n        const checkbox = $(this);\n\n        if (!checkbox.hasClass('is-checked')) {\n          checkbox.addClass('is-checked').attr('aria-checked', 'true');\n\n          self.selectAllRows();\n        } else {\n          checkbox.removeClass('is-checked').attr('aria-checked', 'true');\n          self.unSelectAllRows();\n        }\n      });\n\n    // Implement Editing Auto Commit Functionality\n    this.element.off('focusout.datagrid').on('focusout.datagrid', 'tbody td input, tbody td textarea, tbody div.dropdown', (e) => {\n      // Keep icon clickable in edit mode\n      const target = e.target;\n\n      if ($(target).is('input.lookup, input.timepicker, input.datepicker, input.spinbox, input.colorpicker')) {\n        // Wait for modal popup, if did not found modal popup means\n        // icon was not clicked, then commit cell edit\n        setTimeout(() => {\n          const focusElem = $('*:focus');\n\n          if (!$('.lookup-modal.is-visible, #timepicker-popup, #monthview-popup, #colorpicker-menu').length &&\n              self.editor) {\n            if (focusElem.is('.spinbox, .trigger') ||\n              !$(target).is(':visible') || self.editor.stayInEditMode) {\n              return;\n            }\n\n            if (focusElem && self.editor.className &&\n              focusElem.closest(self.editor.className).length > 0) {\n              return;\n            }\n            self.commitCellEdit(self.editor.input);\n          }\n        }, 150);\n\n        return;\n      }\n\n      // Popups are open\n      if ($('#dropdown-list, .autocomplete.popupmenu.is-open, #timepicker-popup, .is-editing .code-block').is(':visible')) {\n        return;\n      }\n\n      if (self.editor && self.editor.input && !this.editor.stayInEditMode) {\n        self.commitCellEdit(self.editor.input);\n      }\n    });\n  },\n\n  /**\n  * Check if the event is subscribed to.\n  * @private\n  * @param {object} e The update empty message config object.\n  * @param {object} eventName The update empty message config object.\n  * @returns {boolean} If the event is subscribed to.\n  */\n  isSubscribedTo(e, eventName) {\n    const self = this;\n\n    for (const event in $._data(self.element[0]).events) { //eslint-disable-line\n      if (event === eventName) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  /**\n  * Refresh the heights based on the rowHeight setting.\n  * @private\n  */\n  refreshSelectedRowHeight() {\n    const toolbar = this.element.parent().find('.toolbar:not(.contextual-toolbar)');\n    const short = toolbar.find('[data-option=\"row-short\"]');\n    const med = toolbar.find('[data-option=\"row-medium\"]');\n    const normal = toolbar.find('[data-option=\"row-normal\"]');\n\n    if (this.settings.rowHeight === 'short') {\n      short.parent().addClass('is-checked');\n      med.parent().removeClass('is-checked');\n      normal.parent().removeClass('is-checked');\n    }\n\n    if (this.settings.rowHeight === 'medium') {\n      short.parent().removeClass('is-checked');\n      med.parent().addClass('is-checked');\n      normal.parent().removeClass('is-checked');\n    }\n\n    if (this.settings.rowHeight === 'normal') {\n      short.parent().removeClass('is-checked');\n      med.parent().removeClass('is-checked');\n      normal.parent().addClass('is-checked');\n    }\n\n    // Set draggable targets arrow height\n    $('.drag-target-arrows', this.element).css('height', `${this.getTargetHeight()}px`);\n  },\n\n  /**\n  * Append all the UI elements for the toolbar above the grid.\n  * @private\n  */\n  appendToolbar() {\n    let toolbar = null;\n    let title = '';\n    let more = null;\n    const self = this;\n\n    if (!this.settings.toolbar) {\n      return;\n    }\n\n    // Allow menu to be added manually\n    if (this.element.parent().find('.toolbar:not(.contextual-toolbar)').length === 1) {\n      toolbar = this.element.parent().find('.toolbar:not(.contextual-toolbar)');\n      this.refreshSelectedRowHeight();\n    } else {\n      toolbar = $('<div class=\"toolbar\" role=\"toolbar\"></div>');\n      this.removeToolbarOnDestroy = true;\n\n      if (this.settings.toolbar.title) {\n        title = $(`<div class=\"title\">${this.settings.toolbar.title}  </div>`);\n      }\n\n      if (!title) {\n        title = toolbar.find('.title');\n      }\n      toolbar.append(title);\n\n      if (this.settings.toolbar.results) {\n        // Actually value filled in displayResults\n        title.append('<span class=\"datagrid-result-count\"></span>');\n      }\n\n      const buttonSet = $('<div class=\"buttonset\"></div>').appendTo(toolbar);\n\n      if (this.settings.toolbar.keywordFilter) {\n        const labelMarkup = $(`<label class=\"audible\" for=\"gridfilter\">${Locale.translate('Keyword')}</label>`);\n        const searchfieldMarkup = $(`<input class=\"searchfield\" name=\"searchfield\" placeholder=\"${Locale.translate('Keyword')}\" id=\"gridfilter\">`);\n\n        buttonSet.append(labelMarkup);\n\n        if (!this.settings.toolbar.collapsibleFilter) {\n          searchfieldMarkup.attr('data-options', '{ \"collapsible\": false }');\n        }\n\n        buttonSet.append(searchfieldMarkup);\n      }\n\n      if (this.settings.toolbar.dateFilter) {\n        buttonSet.append(`<button class=\"btn\" type=\"button\">${$.createIcon({ icon: 'calendar' })}<span>${Locale.translate('Date')}</span></button>`);\n      }\n\n      if (this.settings.toolbar.actions) {\n        more = $('<div class=\"more\"></div>').insertAfter(buttonSet);\n        more.append(`<button class=\"btn-actions\" title=\"More\" type=\"button\">${$.createIcon({ icon: 'more' })}<span class=\"audible\">Grid Features</span></button>`);\n        toolbar.addClass('has-more-button');\n      }\n\n      const menu = $('<ul class=\"popupmenu\"></ul>');\n\n      if (this.settings.toolbar.personalize) {\n        menu.append(`<li><a href=\"#\" data-option=\"personalize-columns\">${Locale.translate('PersonalizeColumns')}</a></li>`);\n      }\n\n      if (this.settings.toolbar.resetLayout) {\n        menu.append(`<li><a href=\"#\" data-option=\"reset-layout\">${Locale.translate('ResetDefault')}</a></li>`);\n      }\n\n      if (this.settings.toolbar.exportToExcel) {\n        menu.append(`<li><a href=\"#\" data-option=\"export-to-excel\">${Locale.translate('ExportToExcel')}</a></li>`);\n      }\n\n      if (this.settings.toolbar.advancedFilter) {\n        menu.append(`<li><a href=\"#\">${Locale.translate('AdvancedFilter')}</a></li>`);\n      }\n\n      if (this.settings.toolbar.views) {\n        menu.append(`<li><a href=\"#\">${Locale.translate('SaveCurrentView')}</a></li> ` +\n          '<li class=\"separator\"></li> ' +\n          `<li class=\"heading\">${Locale.translate('SavedViews')}</li>` +\n          '<li><a href=\"#\">View One</a></li>');\n      }\n\n      if (this.settings.toolbar.rowHeight) {\n        menu.append(`${'<li class=\"separator single-selectable-section\"></li>' +\n          '<li class=\"heading\">'}${Locale.translate('RowHeight')}</li>` +\n          `<li class=\"is-selectable${this.settings.rowHeight === 'short' ? ' is-checked' : ''}\"><a data-option=\"row-short\">${Locale.translate('Short')}</a></li>` +\n          `<li class=\"is-selectable${this.settings.rowHeight === 'medium' ? ' is-checked' : ''}\"><a data-option=\"row-medium\">${Locale.translate('Medium')}</a></li>` +\n          `<li class=\"is-selectable${this.settings.rowHeight === 'normal' ? ' is-checked' : ''}\"><a data-option=\"row-normal\">${Locale.translate('Normal')}</a></li>`);\n      }\n\n      if (this.settings.toolbar.filterRow) {\n        menu.append(`${'<li class=\"separator\"></li>' +\n          '<li class=\"heading\">'}${Locale.translate('Filter')}</li>` +\n          `<li class=\"${this.settings.filterable ? 'is-checked ' : ''}is-toggleable\"><a data-option=\"show-filter-row\">${Locale.translate('ShowFilterRow')}</a></li>` +\n          `<li class=\"is-indented\"><a data-option=\"run-filter\">${Locale.translate('RunFilter')}</a></li>` +\n          `<li class=\"is-indented\"><a data-option=\"clear-filter\">${Locale.translate('ClearFilter')}</a></li>`);\n      }\n\n      if (this.settings.toolbar.actions) {\n        more.append(menu);\n      }\n\n      if (this.element.prev().is('.contextual-toolbar')) {\n        this.element.prev().before(toolbar);\n      } else {\n        this.element.before(toolbar);\n      }\n    }\n\n    toolbar.find('.btn-actions').popupmenu().on('selected', (e, args) => {\n      const action = args.attr('data-option');\n      if (action === 'row-short' || action === 'row-medium' || action === 'row-normal') {\n        self.rowHeight(action.substr(4));\n      }\n\n      if (action === 'personalize-columns') {\n        self.personalizeColumns();\n      }\n\n      if (action === 'reset-layout') {\n        self.resetColumns();\n      }\n\n      if (action === 'export-to-excel') {\n        // self.exportToExcel();\n        self.exportToCsv();\n      }\n\n      // Filter actions\n      if (action === 'show-filter-row') {\n        self.toggleFilterRow();\n      }\n      if (action === 'run-filter') {\n        self.applyFilter(null, 'menu');\n      }\n      if (action === 'clear-filter') {\n        self.clearFilter();\n      }\n    });\n\n    if (this.settings.initializeToolbar && !toolbar.data('toolbar')) {\n      const opts = $.fn.parseOptions(toolbar);\n\n      if (this.settings.toolbar.fullWidth) {\n        opts.rightAligned = true;\n      }\n\n      toolbar.toolbar(opts);\n    }\n\n    if (this.settings.toolbar && this.settings.toolbar.keywordFilter) {\n      const thisSearch = toolbar.find('.searchfield');\n      const xIcon = thisSearch.parent().find('.close.icon');\n\n      thisSearch.off('keypress.datagrid').on('keypress.datagrid', (e) => {\n        if (e.keyCode === 13 || e.type === 'change') {\n          e.preventDefault();\n          self.keywordSearch(thisSearch.val());\n        }\n      });\n\n      xIcon.off('click.datagrid').on('click.datagrid', () => {\n        self.keywordSearch(thisSearch.val());\n      });\n    }\n\n    if (this.settings.toolbar && this.settings.toolbar.contextualToolbar) {\n      const contextualToolbar = `\n        <div class=\"contextual-toolbar datagrid-contextual-toolbar toolbar is-hidden\">\n          <div class=\"title selection-count\">1 Selected</div>\n        </div>`;\n\n      this.element.before(contextualToolbar);\n      this.contextualToolbar = this.element.prev('.contextual-toolbar');\n    }\n\n    this.toolbar = toolbar;\n    this.element.addClass('has-toolbar');\n  },\n\n  /**\n   * Get or Set the Row Height.\n   * @param  {string} height The row height to use, can be 'short', 'normal' or 'medium'\n   * @Returns {string} The current row height\n   */\n  rowHeight(height) {\n    if (height) {\n      this.settings.rowHeight = height;\n    }\n\n    this.element\n      .add(this.table)\n      .add(this.tableLeft)\n      .add(this.tableRight)\n      .removeClass('short-rowheight medium-rowheight normal-rowheight')\n      .addClass(`${this.settings.rowHeight}-rowheight`);\n\n    if (this.virtualRange && this.virtualRange.rowHeight) {\n      this.virtualRange.rowHeight = (height === 'normal' ? 40 : (height === 'medium' ? 30 : 25));\n    }\n\n    this.saveUserSettings();\n    this.refreshSelectedRowHeight();\n    return this.settings.rowHeight;\n  },\n\n  /**\n  * Search a Term across all columns\n  * @param  {string} term The term to search for.\n  */\n  keywordSearch(term) {\n    this.bodyContainer.find('tr[role=\"row\"]').removeClass('is-filtered').show();\n    this.filterExpr = [];\n\n    this.bodyContainer.find('.datagrid-expandable-row').each(function () {\n      const row = $(this);\n      // Collapse All rows\n      row.prev().find('.datagrid-expand-btn').removeClass('is-expanded');\n      row.prev().find('.plus-minus').removeClass('active');\n      row.removeClass('is-expanded').css('display', '');\n      row.find('.datagrid-row-detail').css('height', '');\n    });\n\n    this.bodyContainer.find('.search-mode').each(function () {\n      const cell = $(this);\n      const text = cell.text();\n      cell.text(text.replace('<i>', '').replace('</i>', ''));\n    });\n\n    term = (term || '').toLowerCase();\n    this.filterExpr.push({ column: 'all', operator: 'contains', value: term, keywordSearch: true });\n\n    this.filterKeywordSearch();\n    this.renderRows();\n    this.setSearchActivePage({ trigger: 'searched' });\n\n    if (!this.settings.paging) {\n      this.highlightSearchRows(term);\n    }\n  },\n\n  /**\n   * Sets optional filtering conditions on the pager during changes\n   * in searching/filtering of datagrid rows\n   * @private\n   * @param {object} pagingInfo incoming paging state information\n   * @returns {void}\n   */\n  setSearchActivePage(pagingInfo) {\n    if (!this.pagerAPI) {\n      return;\n    }\n\n    const self = this;\n    if (!pagingInfo) {\n      pagingInfo = {};\n    }\n\n    function reset(obj) {\n      obj.activePage = 1;\n      if (self.grandTotal) {\n        obj.grandTotal = self.grandTotal;\n      }\n      return obj;\n    }\n\n    if (this.filterExpr && this.filterExpr.length === 1) {\n      if (this.filterExpr[0].value !== '') {\n        pagingInfo.activePage = this.pagerAPI.filteredActivePage || 1;\n      } else if (this.filterExpr[0].value === '' && this.pagerAPI.filteredActivePage) {\n        pagingInfo = reset(pagingInfo);\n      }\n    } else {\n      pagingInfo = reset(pagingInfo);\n    }\n\n    this.renderPager(pagingInfo);\n  },\n\n  /**\n   * Filter to keyword search.\n   * @private\n   */\n  filterKeywordSearch() {\n    const self = this;\n    let dataset;\n    let isFiltered;\n    let i;\n    let len;\n    let filterExpr = self.filterExpr;\n\n    const checkRow = function (data, row) {\n      let isMatch = false;\n\n      const checkColumn = function (columnId) {\n        const column = self.columnById(columnId)[0];\n        const fieldValue = self.fieldValue(data, column.field);\n        let value;\n        const cell = self.settings.columns.indexOf(column);\n\n        // Use the formatted value (what the user sees in the cells)\n        // since it's a more reliable match\n        value = self.formatValue(column.formatter, row, cell, fieldValue, column, data, self);\n        value = value.toLowerCase();\n\n        // Strip any html markup that might be in the formatted value\n        value = value.replace(/(<([^>]+)>)|(amp;)|(&lt;([^>]+)&gt;)/ig, '');\n\n        return value.indexOf(filterExpr.value) > -1;\n      };\n\n      // Check in all visible columns\n      if (filterExpr.column === 'all') {\n        self.headerContainer.find('th:visible').each(function () { //eslint-disable-line\n          const th = $(this);\n          const columnId = th.attr('data-column-id');\n\n          isMatch = checkColumn(columnId);\n          if (isMatch) {\n            return false;\n          }\n        });\n      } else if (filterExpr.columnId) { // Check in only one column, given by columnId\n        isMatch = checkColumn(filterExpr.columnId);\n      }\n      return isMatch;\n    };\n\n    // Make sure not more/less than one filter expr\n    if (!filterExpr || filterExpr.length !== 1) {\n      return;\n    }\n    filterExpr = filterExpr[0];\n\n    // Check in dataset\n    if (self.settings.treeGrid) {\n      dataset = self.settings.treeDepth;\n      for (i = 0, len = dataset.length; i < len; i++) {\n        isFiltered = filterExpr.value === '' ? false : !checkRow(dataset[i].node, i);\n        dataset[i].node.isFiltered = isFiltered;\n      }\n    } else {\n      dataset = self.settings.dataset;\n      for (i = 0, len = dataset.length; i < len; i++) {\n        isFiltered = filterExpr.value === '' ? false : !checkRow(dataset[i], i);\n        dataset[i].isFiltered = isFiltered;\n      }\n    }\n  },\n\n  /**\n   * Highlight the term in the grid.\n   * @private\n   * @param  {string} term The term to highlight\n   * @returns {void}\n   */\n  highlightSearchRows(term) {\n    const self = this;\n\n    if (!term || term === '') {\n      return;\n    }\n\n    const findInRows = (rowNodes) => {\n      let found = false;\n      rowNodes.toArray().forEach((row) => {\n        [].slice.call(row.querySelectorAll('td')).forEach((cell) => {\n          const cellText = cell.innerText.toLowerCase();\n          const isSearchExpandableRow = self.settings.searchExpandableRow ? true : !DOM.hasClass(this, 'datagrid-expandable-row');\n\n          if (cellText.indexOf(term) > -1 && isSearchExpandableRow) {\n            found = true;\n            [].slice.call(cell.querySelectorAll('*')).forEach((node) => {\n              if (xssUtils.unescapeHTML(node.innerHTML) === node.textContent) {\n                const contents = node.textContent;\n                const exp = new RegExp(`(${stringUtils.escapeRegExp(term)})`, 'gi');\n\n                DOM.addClass(node, 'search-mode');\n                DOM.html(node, contents.replace(exp, '<i>$1</i>'));\n              }\n            });\n          }\n        });\n      });\n      return found;\n    };\n\n    // Move across all visible cells and rows, highlighting\n    const visibleRows = self.tableBody.find('tr');\n    visibleRows.toArray().forEach((row) => {\n      const rowContainers = self.rowNodes(row.getAttribute('aria-rowindex') - 1);\n      const found = findInRows(rowContainers);\n\n      // Hide non matching rows and non detail rows\n      if (!found && !rowContainers.find('.datagrid-row-detail').length) {\n        rowContainers.addClass('is-filtered').hide();\n      } else if (self.settings.searchExpandableRow && found && rowContainers.is('.datagrid-expandable-row') && term !== '') {\n        rowContainers.prev().show();\n        rowContainers.prev().find('.datagrid-expand-btn').addClass('is-expanded');\n        rowContainers.prev().find('.plus-minus').addClass('active');\n        rowContainers.addClass('is-expanded').css('display', 'table-row');\n        rowContainers.find('.datagrid-row-detail').css('height', 'auto');\n      }\n    });\n  },\n\n  /**\n  * Select all rows. If serverside paging, this will be only the current page.\n  * For client side paging, all rows across all pages are selected.\n  */\n  selectAllRows() {\n    const rows = [];\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n\n    for (let i = 0, l = dataset.length; i < l; i++) {\n      const idx = this.pagingRowIndex(i);\n      if (this.filterRowRendered ||\n        (this.filterExpr && this.filterExpr[0] && this.filterExpr[0].keywordSearch)) {\n        if (!dataset[i].isFiltered) {\n          rows.push(idx);\n        }\n      } else {\n        rows.push(idx);\n      }\n    }\n\n    this.dontSyncUi = true;\n    this.selectRows(rows, true, true);\n    this.dontSyncUi = false;\n    this.syncSelectedUI();\n\n    /**\n    * Fires after a row is selected.\n    * @event contextmenu\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {array} args.selectedRows An array of selected rows.\n    * @property {string} args.trigger The action can be 'selectall', 'deselectall', 'select', 'deselect'\n    * @property {object} args.item The current sort column.\n    * @property {object} args.originalEvent The original event object.\n    */\n    this.element.triggerHandler('selected', [this._selectedRows, 'selectall']);\n  },\n\n  /**\n  * Deselect all rows that are currently selected.\n  */\n  unSelectAllRows() {\n    this.dontSyncUi = true;\n\n    for (let i = this._selectedRows.length - 1; i >= 0; i--) {\n      const idx = this.pagingRowIndex(this._selectedRows[i].idx);\n      this.unselectRow(idx, true, true);\n    }\n    this.dontSyncUi = false;\n    this.syncSelectedUI();\n    this.element.triggerHandler('selected', [this._selectedRows, 'deselectall']);\n  },\n\n  /**\n  * Check if node index is exists in selected nodes\n  * @private\n  * @param {object} row The row to compare.\n  * @returns {boolean} If its selected or not.\n  */\n  isRowSelected(row) {\n    // As of 4.3.3, return the rows that have _selected = true\n    return row ? row._selected === true : false;\n  },\n\n  /**\n   * Select a row node on the UI\n   * @private\n   * @param {object} elem The row node to select\n   * @param {number} index The row index to select\n   * @param {object} data The object attached to the row\n   * @param {boolean} force Dont check if already selected\n   * @returns {void}\n   */\n  selectNode(elem, index, data, force) {\n    let checkbox = null;\n    const self = this;\n    const selectClasses = `is-selected${self.settings.selectable === 'mixed' ? ' hide-selected-color' : ''}`;\n\n    // do not add if already exists in selected\n    if ((!data || self.isRowSelected(data)) && !force) {\n      return;\n    }\n\n    checkbox = elem.find('.datagrid-selection-checkbox').closest('td');\n    elem.addClass(selectClasses).attr('aria-selected', 'true');\n\n    if (self.columnIdxById('selectionCheckbox') !== -1) {\n      checkbox = self.cellNode(elem, self.columnIdxById('selectionCheckbox'));\n      checkbox.find('.datagrid-cell-wrapper .datagrid-checkbox')\n        .addClass('is-checked').attr('aria-checked', 'true');\n    }\n\n    if (data) {\n      data._selected = true;\n    }\n  },\n\n  /**\n   * Toggle selection on a single row\n   * @param {number} idx The row index to select\n   * @param {boolean} nosync Do sync the header\n   * @param {boolean} noTrigger Do not trigger events.\n   * @returns {void}\n   */\n  selectRow(idx, nosync, noTrigger) {\n    let rowNode = null;\n    let dataRowIndex;\n    const self = this;\n    const s = this.settings;\n\n    if (idx === undefined || idx === -1 || !s.selectable) {\n      return;\n    }\n\n    rowNode = this.rowNodes(idx);\n    dataRowIndex = this.dataRowIndex(rowNode);\n\n    if (isNaN(dataRowIndex)) {\n      dataRowIndex = idx;\n    }\n\n    if (!rowNode || (!rowNode.length && s.source)) {\n      return;\n    }\n\n    if (s.selectable === 'single') {\n      let selectedIndex = -1;\n      if (this._selectedRows.length > 0) {\n        selectedIndex = this._selectedRows[0].idx;\n      } else if (rowNode[0] && rowNode[0].classList.contains('is-selected')) {\n        selectedIndex = dataRowIndex;\n      }\n      if (selectedIndex !== -1) {\n        this.unselectRow(selectedIndex, true, true);\n      }\n    }\n\n    if (!rowNode.hasClass('is-selected')) {\n      let rowData;\n\n      if (s.treeGrid) {\n        if (rowNode.is('.datagrid-tree-parent') && s.selectable === 'multiple') {\n          // Select node and node-children\n          rowNode.add(rowNode.nextUntil('[aria-level=\"1\"]')).each(function (i) {\n            const elem = $(this);\n            const index = elem.attr('aria-rowindex') - 1;\n            const data = s.treeDepth[index].node;\n\n            // Allow select node if selectChildren is true or only first node\n            // if selectChildren is false\n            if (s.selectChildren || (!s.selectChildren && i === 0)) {\n              self.selectNode(elem, index, data);\n            }\n          });\n        } else if (s.selectable === 'siblings') {\n          this.unSelectAllRows();\n\n          // Select node and node-siblings\n          const level = rowNode.attr('aria-level');\n          let nexts = rowNode.nextUntil(`[aria-level!=\"${level}\"]`);\n          let prevs = rowNode.prevUntil(`[aria-level!=\"${level}\"]`);\n\n          if (level === '1') {\n            nexts = rowNode.parent().find('[aria-level=\"1\"]');\n            prevs = null;\n          }\n\n          rowNode.add(nexts).add(prevs).each(function (i) {\n            const elem = $(this);\n            const index = elem.attr('aria-rowindex') - 1;\n            const data = s.treeDepth[index].node;\n\n            // Allow select node if selectChildren is true or only first node\n            // if selectChildren is false\n            if (s.selectChildren || (!s.selectChildren && i === 0)) {\n              self.selectNode(elem, index, data);\n            }\n          });\n        } else { // Default to Single element selection\n          rowData = s.treeDepth[self.pagerAPI && s.source ? rowNode.index() : idx].node;\n          self.selectNode(rowNode, idx, rowData);\n        }\n        self.setNodeStatus(rowNode);\n      } else {\n        rowData = s.dataset[dataRowIndex];\n        if (s.groupable) {\n          const row = self.actualPagingRowIndex(self.actualRowIndex(rowNode));\n          if (isNaN(row)) {\n            return;\n          }\n          const gData = self.groupArray[row];\n          rowData = self.settings.dataset[gData.group].values[gData.node];\n          dataRowIndex = self.actualPagingRowIndex(idx);\n          this._selectedRows.push({\n            idx: dataRowIndex,\n            data: rowData,\n            elem: rowNode,\n            group: s.dataset[self.groupArray[row].group]\n          });\n        }\n        self.selectNode(rowNode, dataRowIndex, rowData);\n        self.lastSelectedRow = idx; // Rememeber index to use shift key\n      }\n\n      // Append data to selectedRows\n      if (!s.groupable) {\n        let actualIdx = self.actualPagingRowIndex(idx);\n        if (actualIdx === -1) {\n          actualIdx = idx;\n        }\n\n        this._selectedRows.push({\n          idx: actualIdx,\n          data: rowData,\n          elem: self.visualRowNode(actualIdx),\n          page: this.pagerAPI ? this.pagerAPI.activePage : 1,\n          pagingIdx: idx,\n          pagesize: this.settings.pagesize\n        });\n      }\n    }\n\n    if (!nosync) {\n      self.syncSelectedUI();\n    }\n\n    if (!noTrigger) {\n      this.element.triggerHandler('selected', [this._selectedRows, 'select']);\n    }\n  },\n\n  /**\n  * Select rows between indexes\n  * @private\n  * @param  {array} indexes The ranges to select.\n  * @returns {void}\n  */\n  selectRowsBetweenIndexes(indexes) {\n    indexes.sort((a, b) => a - b);\n    for (let i = indexes[0]; i <= indexes[1]; i++) {\n      this.selectRow(i);\n    }\n\n    this.displayCounts();\n  },\n\n  /**\n  * Set the checkbox on the header based on selections.\n  * @private\n  * @param  {array} rows The rows to select.\n  * @returns {void}\n  */\n  syncHeaderCheckbox(rows) {\n    if (this.headerNodes().length === 0) {\n      return;\n    }\n\n    const headerCheckbox = this.headerNodes().find('.datagrid-checkbox');\n    const rowsLength = rows.length;\n    const selectedRowsLength = this._selectedRows.length;\n    const status = headerCheckbox.data('selected');\n\n    // Do not run if checkbox in same state\n    if ((selectedRowsLength !== rowsLength &&\n          selectedRowsLength > 0 && status === 'partial') ||\n            (selectedRowsLength === rowsLength && status === 'all' && selectedRowsLength !== 0) ||\n              (selectedRowsLength === 0 && status === 'none')) {\n      return;\n    }\n\n    // Sync the header checkbox\n    if (selectedRowsLength > 0) {\n      headerCheckbox.data('selected', 'partial')\n        .addClass('is-checked is-partial');\n    }\n\n    if (selectedRowsLength === rowsLength) {\n      headerCheckbox.data('selected', 'all')\n        .addClass('is-checked').removeClass('is-partial');\n    }\n\n    if (selectedRowsLength === 0) {\n      headerCheckbox.data('selected', 'none')\n        .removeClass('is-checked is-partial');\n    }\n  },\n\n  /**\n   * Mark selected rows on the page as selected\n   * @private\n   * @returns {void}\n   */\n  syncSelectedRows() {\n    let idx = null;\n\n    for (let i = 0; i < this._selectedRows.length; i++) {\n      if (this.pagerAPI && this._selectedRows[i].page === this.pagerAPI.activePage) {\n        idx = this._selectedRows[i].idx;\n        this.selectNode(this.visualRowNode(idx), idx, this.settings.dataset[idx], true);\n      }\n      // Check for rows that changed page\n      idx = this._selectedRows[i].pagingIdx;\n      if (this._selectedRows[i].pagesize !== this.settings.pagesize && this.settings.dataset[idx]) {\n        this.selectNode(this.visualRowNode(idx), idx, this.settings.dataset[idx], true);\n        this._selectedRows[i].pagesize = this.settings.pagesize;\n        this._selectedRows[i].idx = idx;\n        this._selectedRows[i].page = this.pagerAPI.activePage;\n      }\n\n      if (this._selectedRows[i].pagesize !== this.settings.pagesize &&\n        !this.settings.dataset[idx]) {\n        this._selectedRows[i].idx = idx % this.settings.pagesize;\n        this._selectedRows[i].page = Math.round(idx / this.settings.pagesize) + 1;\n        this._selectedRows[i].pagesize = this.settings.pagesize;\n      }\n    }\n  },\n\n  /**\n   * Run throught the array and remark the idx's after a row reorder.\n   * @private\n   * @returns {void}\n   */\n  syncSelectedRowsIdx() {\n    if (this._selectedRows.length === 0 || this.settings.dataset.length === 0) {\n      return;\n    }\n    this._selectedRows = [];\n\n    for (let i = 0; i < this.settings.dataset.length; i++) {\n      if (this.settings.dataset[i]._selected) {\n        this._selectedRows.push({\n          idx: i,\n          data: this.settings.dataset[i],\n          elem: this.dataRowNode(i),\n          page: this.pagerAPI ? this.pagerAPI.activePage : 1,\n          pagingIdx: i,\n          pagesize: this.settings.pagesize\n        });\n      }\n    }\n  },\n\n  /**\n   * Set ui elements based on selected rows\n   * @private\n   * @returns {void}\n   */\n  syncSelectedUI() {\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    let rows = dataset;\n\n    if (this.settings.groupable) {\n      rows = [];\n      for (let i = 0, l = dataset.length; i < l; i++) {\n        if (dataset[i].values) {\n          for (let i2 = 0, l2 = dataset[i].values.length; i2 < l2; i2++) {\n            rows.push(i2);\n          }\n        }\n      }\n    }\n\n    if (this.filterRowRendered) {\n      rows = [];\n      for (let i = 0, l = dataset.length; i < l; i++) {\n        if (!dataset[i].isFiltered) {\n          rows.push(i);\n        }\n      }\n    }\n\n    this.syncHeaderCheckbox(rows);\n\n    // Open or Close the Contextual Toolbar.\n    if (this.contextualToolbar.length !== 1 || this.dontSyncUi) {\n      return;\n    }\n\n    if (this._selectedRows.length === 0) {\n      this.contextualToolbar.animateClosed();\n    }\n\n    if (this._selectedRows.length > 0 && this.contextualToolbar.height() === 0) {\n      this.contextualToolbar.css('display', 'block').one('animateopencomplete.datagrid', function () {\n        $(this).triggerHandler('recalculate-buttons');\n      }).animateOpen();\n    }\n  },\n\n  /**\n   * Activate a row when in mixed selection mode\n   * @param  {number} idx The index.\n   */\n  activateRow(idx) {\n    if (this.activatedRow()[0].row !== idx) {\n      this.toggleRowActivation(idx);\n    }\n  },\n\n  /**\n  * Deactivate the currently activated row.\n  */\n  deactivateRow() {\n    const idx = this.activatedRow()[0].row;\n    if (idx >= 0) {\n      this.toggleRowActivation(idx);\n    }\n  },\n\n  /**\n  * Gets the currently activated row.\n  * @returns {object} Information about the activated row.\n  */\n  activatedRow() {\n    let r = [{ row: -1, item: undefined, elem: undefined }];\n\n    if (this.tableBody) {\n      const s = this.settings;\n      const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n      const activatedRow = this.tableBody.find('tr.is-rowactivated');\n\n      if (activatedRow.length) {\n        const dataRowIndex = this.dataRowIndex(activatedRow);\n        const rowIndex = s.indeterminate ? dataRowIndex : this.actualRowIndex(activatedRow);\n        r = [{ row: rowIndex, item: dataset[rowIndex], elem: activatedRow }];\n      } else {\n        r = null;\n        // Activated row may be filtered or on another page, so check all until find it\n        for (let i = 0; i < dataset.length; i++) {\n          if (dataset[i]._rowactivated) {\n            r = [{ row: i, item: dataset[i], elem: undefined }];\n            break;\n          }\n        }\n\n        if (r === null) {\n          r = [{ row: -1, item: undefined, elem: activatedRow }];\n        }\n      }\n    }\n    return r;\n  },\n\n  /**\n  * Toggle the current activation state from on to off.\n  * @param  {number} idx The row to toggle\n  * @returns {void}\n  */\n  toggleRowActivation(idx) {\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    let row;\n    let rowJq;\n    let rowIndex;\n\n    if (typeof idx === 'number') {\n      row = this.tableBody[0].querySelector(`tr[aria-rowindex=\"${idx + 1}\"]`);\n      rowIndex = idx;\n\n      if (this.pagerAPI && s.source && s.indeterminate) {\n        const rowIdx = idx + ((this.pagerAPI.activePage - 1) * s.pagesize);\n        row = this.tableBody[0].querySelector(`tr[aria-rowindex=\"${rowIdx + 1}\"]`);\n      }\n    } else {\n      rowJq = idx instanceof jQuery ? idx : $(idx);\n      row = rowJq[0];\n      rowIndex = (s.treeGrid || s.groupable) ?\n        this.actualRowIndex(rowJq) : this.dataRowIndex(rowJq);\n    }\n\n    if (s.indeterminate && !row) {\n      rowJq = this.actualRowNode(rowIndex);\n      row = rowJq[0];\n    }\n\n    const isActivated = dataset[rowIndex] ? dataset[rowIndex]._rowactivated : false;\n\n    // Toggle it\n    if (isActivated) {\n      this.deactivateRowNode(rowIndex, dataset);\n    } else {\n      this.deactivateAllRowNodes(dataset);\n      this.activateAllRowNodes(rowIndex, dataset);\n    }\n  },\n\n  /**\n   * Activate given row with mixed selection mode.\n   * @private\n   * @param  {number} idx The row index to activated\n   * @param  {object} dataset Optional data to use\n   * @returns {void}\n   */\n  activateAllRowNodes(idx, dataset) {\n    if (typeof idx !== 'number' || idx < 0) {\n      return;\n    }\n    const s = this.settings;\n\n    if (typeof dataset === 'undefined') {\n      dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    }\n\n    let args = [{ row: idx, item: dataset[idx] }];\n\n    const doRowactivated = () => {\n      const rowNodes = this.rowNodes(idx).toArray();\n      rowNodes.forEach((rowElem) => {\n        rowElem.classList.add('is-rowactivated');\n      });\n      dataset[idx]._rowactivated = true;\n      args = [{ row: idx, item: dataset[idx] }];\n\n      /**\n       * Fires after a row is activated in mixed selection mode.\n       * @event rowactivated\n       * @memberof Datagrid\n       * @property {object} event The jquery event object\n       * @property {object} args Additional arguments\n       * @property {array} args.row An array of selected rows.\n       * @property {object} args.item The current sort column.\n       */\n      this.element.triggerHandler('rowactivated', args);\n    };\n\n    if (dataset[idx]) {\n      $.when(this.element.triggerHandler('beforerowactivated', args)).done((response) => {\n        const isFalse = v => ((typeof v === 'string' && v.toLowerCase() === 'false') ||\n          (typeof v === 'boolean' && v === false) ||\n          (typeof v === 'number' && v === 0));\n        if (!isFalse(response)) {\n          doRowactivated();\n        }\n      });\n    }\n  },\n\n  /**\n  * Deactivate given row with mixed selection mode.\n  * @private\n  * @param  {number} idx The row index to deactivated\n  * @param  {object} dataset Optional data to use\n  * @returns {void}\n  */\n  deactivateRowNode(idx, dataset) {\n    if (typeof idx !== 'number' || idx < 0) {\n      return;\n    }\n    const s = this.settings;\n\n    if (typeof dataset === 'undefined') {\n      dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    }\n\n    if (dataset[idx] && !s.disableRowDeactivation) {\n      const rowNodes = this.rowNodes(idx).toArray();\n      rowNodes.forEach((row) => {\n        row.classList.remove('is-rowactivated');\n      });\n      delete dataset[idx]._rowactivated;\n\n      /**\n       * Fires after a row is deactivated in mixed selection mode.\n       * @event rowdeactivated\n       * @memberof Datagrid\n       * @property {object} event The jquery event object\n       * @property {object} args Additional arguments\n       * @property {array} args.row An array of selected rows.\n       * @property {object} args.item The current sort column.\n       */\n      this.element.triggerHandler('rowdeactivated', [{ row: idx, item: dataset[idx] }]);\n    }\n  },\n\n  /**\n  * Deactivate all rows with mixed selection mode.\n  * @private\n  * @param  {object} dataset Optional data to use\n  * @returns {void}\n  */\n  deactivateAllRowNodes(dataset) {\n    const s = this.settings;\n    let triggerData = null;\n\n    if (typeof dataset === 'undefined') {\n      dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    }\n\n    // Deselect activated row\n    const activated = [].slice.call(this.bodyContainer[0].querySelectorAll('tr.is-rowactivated'));\n    if (activated.length > 0) {\n      activated.forEach((row) => {\n        row.classList.remove('is-rowactivated');\n      });\n      const idx = (s.treeGrid || s.groupable) ?\n        this.actualRowIndex($(activated)) : this.dataRowIndex($(activated));\n      triggerData = { row: idx, item: dataset[idx] };\n      if (dataset[idx]) {\n        delete dataset[idx]._rowactivated;\n      }\n    } else {\n      // actived row may be filtered or on another page, so check all until find it\n      for (let i = 0; i < dataset.length; i++) {\n        const data = dataset[i];\n        if (data._rowactivated) {\n          delete data._rowactivated;\n          triggerData = { row: i, item: data };\n          break;\n        }\n      }\n    }\n\n    if (triggerData !== null) {\n      this.element.triggerHandler('rowdeactivated', [triggerData]);\n    }\n  },\n\n  /**\n  * Toggle the current selection state from on to off.\n  * @param  {number} idx The row to select/unselect\n  * @returns {void}\n  */\n  toggleRowSelection(idx) {\n    const row = (typeof idx === 'number' ? this.tableBody.find(`tr[aria-rowindex=\"${idx + 1}\"]`) : idx);\n    const isSingle = this.settings.selectable === 'single';\n    const rowIndex = (typeof idx === 'number' ? idx :\n      (this.settings.treeGrid || this.settings.groupable) ?\n        this.actualRowIndex(row) : this.actualRowIndex(row));\n\n    if (this.settings.selectable === false) {\n      return;\n    }\n\n    if (this.editor && row.hasClass('is-selected')) {\n      return;\n    }\n\n    if (isSingle && row.hasClass('is-selected')) {\n      this.unselectRow(rowIndex);\n      this.displayCounts();\n      return this._selectedRows; // eslint-disable-line\n    }\n\n    if (row.hasClass('is-selected')) {\n      this.unselectRow(rowIndex);\n    } else {\n      this.selectRow(rowIndex);\n    }\n\n    this.displayCounts();\n\n    return this._selectedRows; // eslint-disable-line\n  },\n\n  /**\n  * De-select a selected row.\n  * @param  {number} idx The row index\n  * @param  {boolean} nosync Do not sync the header\n  * @param  {boolean} noTrigger Do not trgger any events\n  */\n  unselectRow(idx, nosync, noTrigger) {\n    const self = this;\n    const s = self.settings;\n    const rowNode = self.rowNodes(idx);\n    let checkbox = null;\n\n    if (!rowNode || idx === undefined) {\n      return;\n    }\n\n    // Unselect it\n    const unselectNode = function (elem, index) {\n      const removeSelected = function (node, selIdx) {\n        delete node._selected;\n        self.selectedRowCount--;\n        if (typeof selIdx === 'undefined') {\n          selIdx = index;\n        }\n        for (let i = 0; i < self._selectedRows.length; i++) {\n          if (self._selectedRows[i].idx === selIdx) {\n            self._selectedRows.splice(i, 1);\n            break;\n          }\n        }\n      };\n\n      const selectClasses = 'is-selected hide-selected-color';\n      checkbox = self.cellNode(elem, self.columnIdxById('selectionCheckbox'));\n      elem.removeClass(selectClasses).removeAttr('aria-selected');\n\n      if (self.columnIdxById('selectionCheckbox') !== -1) {\n        checkbox = self.cellNode(elem, self.columnIdxById('selectionCheckbox'));\n        checkbox.find('.datagrid-cell-wrapper .datagrid-checkbox')\n          .removeClass('is-checked no-animate').attr('aria-checked', 'false');\n      }\n\n      if (s.treeGrid) {\n        for (let i = 0; i < s.treeDepth.length; i++) {\n          if (self.isRowSelected(s.treeDepth[i].node)) {\n            if (typeof index !== 'undefined') {\n              if (index === s.treeDepth[i].idx - 1) {\n                removeSelected(s.treeDepth[i].node);\n              }\n            } else {\n              removeSelected(s.treeDepth[i].node);\n            }\n          }\n        }\n      } else {\n        const selIdx = elem.length ? self.dataRowIndex(elem) : index;\n        let rowData;\n\n        if (selIdx !== undefined && selIdx > -1) {\n          rowData = s.dataset[selIdx];\n        }\n        if (s.groupable) {\n          const row = self.actualPagingRowIndex(self.actualRowIndex(rowNode));\n          const gData = self.groupArray[row];\n          rowData = s.dataset[gData.group].values[gData.node];\n        }\n        if (rowData !== undefined) {\n          if (s.paging && s.source) {\n            removeSelected(rowData, selIdx);\n          } else {\n            removeSelected(rowData);\n          }\n        }\n      }\n    };\n\n    if (s.treeGrid) {\n      if (rowNode.is('.datagrid-tree-parent') && s.selectable === 'multiple') {\n        // Select node and node-children\n        rowNode.add(rowNode.nextUntil('[aria-level=\"1\"]')).each(function (i) {\n          const elem = $(this);\n          const index = elem.attr('aria-rowindex') - 1;\n\n          // Allow unselect node if selectChildren is true or only first node\n          if (s.selectChildren || (!s.selectChildren && i === 0)) {\n            unselectNode(elem, index);\n          }\n        });\n      } else if (s.selectable === 'siblings') {\n        rowNode.parent().find('.is-selected').each(function (i) {\n          const elem = $(this);\n          const index = elem.attr('aria-rowindex') - 1;\n\n          // Allow unselect node if selectChildren is true or only first node\n          if (s.selectChildren || (!s.selectChildren && i === 0)) {\n            unselectNode(elem, index);\n          }\n        });\n      } else { // Single element unselection\n        unselectNode(rowNode, idx);\n      }\n      self.setNodeStatus(rowNode);\n    } else {\n      unselectNode(rowNode, idx);\n    }\n\n    if (!nosync) {\n      self.syncSelectedUI();\n    }\n\n    if (!noTrigger) {\n      self.element.triggerHandler('selected', [self._selectedRows, 'deselect']);\n    }\n  },\n\n  /**\n   * Set the current status on the row status column\n   * @param {HTMLElement} node The node to set the status on\n   */\n  setNodeStatus(node) {\n    const self = this;\n    const isMultiselect = self.settings.selectable === 'multiple';\n    const s = self.settings;\n    const checkbox = self.cellNode(node, self.columnIdxById('selectionCheckbox'));\n    let nodes;\n\n    // Not multiselect\n    if (!isMultiselect) {\n      checkbox.find('.datagrid-cell-wrapper .datagrid-checkbox')\n        .removeClass('is-checked is-partial').attr('aria-checked', 'false');\n\n      if (node.is('.is-selected')) {\n        checkbox.find('.datagrid-cell-wrapper .datagrid-checkbox')\n          .addClass('is-checked').attr('aria-checked', 'true');\n      }\n      return;\n    }\n\n    const setStatus = function (nodeElems, isFirstSkipped) {\n      nodeElems.each(function () {\n        const nodeToUse = $(this);\n        const checkboxToUse = self.cellNode(nodeToUse, self.columnIdxById('selectionCheckbox'));\n        const status = self.getSelectedStatus(nodeToUse, isFirstSkipped);\n\n        checkboxToUse.find('.datagrid-cell-wrapper .datagrid-checkbox')\n          .removeClass('is-checked is-partial').attr('aria-checked', 'false');\n\n        if (status === 'mixed') {\n          checkboxToUse.find('.datagrid-cell-wrapper .datagrid-checkbox')\n            .addClass('is-checked is-partial').attr('aria-checked', 'mixed');\n        } else if (status) {\n          checkboxToUse.find('.datagrid-cell-wrapper .datagrid-checkbox')\n            .addClass('is-checked').attr('aria-checked', 'true');\n        }\n      });\n    };\n\n    // Multiselect\n    nodes = node.add(node.nextUntil('[aria-level=\"1\"]')).filter('.datagrid-tree-parent');\n\n    // Prevent selecting of parent element when selectChildren is false\n    if (s.selectChildren) {\n      setStatus(nodes);\n    }\n\n    nodes = node;\n    if (+node.attr('aria-level') > 1) {\n      nodes = nodes.add(node.prevUntil('[aria-level=\"1\"]'))\n        .add(node.prevAll('[aria-level=\"1\"]:first'));\n    }\n    nodes = nodes.filter('.datagrid-tree-parent');\n\n    // Prevent selecting of parent element when selectChildren is false\n    if (s.selectChildren) {\n      setStatus(nodes);\n    }\n  },\n\n  /**\n  * Get current selection status.\n  * @private\n  * @param  {object} node The dom element.\n  * @returns {object} The status\n  */\n  getSelectedStatus(node) {\n    let status = false;\n    let total = 0;\n    let selected = 0;\n    let unselected = 0;\n\n    node.add(node.nextUntil('[aria-level=\"1\"]')).each(function () {\n      total++;\n      if ($(this).is('.is-selected')) {\n        selected++;\n      } else {\n        unselected++;\n      }\n    });\n\n    status = ((total === selected) ? true : ((total === unselected) ? false : 'mixed'));\n    return status;\n  },\n\n  /**\n   * Get the currently selected rows.\n   * @returns {array} An array containing the selected rows\n   */\n  selectedRows() {\n    return this._selectedRows;\n  },\n\n  /**\n   * Set the selected rows by passing the row index or an array of row indexes.\n   * @param  {number/array} row A row index or array of row indexes to select.\n   * @param  {boolean} nosync Dont sync the header.\n   * @param  {boolean} selectAll Internally used.\n   * @returns {void}\n   */\n  selectRows(row, nosync, selectAll) {\n    let idx = -1;\n    const s = this.settings;\n    const isSingle = s.selectable === 'single';\n    const isMultiple = s.selectable === 'multiple' || s.selectable === 'mixed';\n    const isSiblings = s.selectable === 'siblings';\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    let gIdx = idx;\n\n    if (typeof row === 'number') {\n      row = [row];\n    }\n\n    if (!row || row.length === 0) {\n      return this._selectedRows;\n    }\n\n    if (isSingle) {\n      // Unselect\n      if (this._selectedRows.length) {\n        this.unselectRow(this._selectedRows[0].idx, true, true);\n      }\n\n      // Select - may be passed array or int\n      idx = ((Object.prototype.toString.call(row) === '[object Array]') ? row[0] : row.index());\n      this.selectRow(idx, true, true);\n    }\n\n    if (isMultiple || isSiblings) {\n      if (Object.prototype.toString.call(row) === '[object Array]') {\n        for (let i = 0; i < row.length; i++) {\n          if (s.groupable) {\n            for (let k = 0; k < dataset[i].values.length; k++) {\n              gIdx++;\n              this.selectRow(gIdx, true, true);\n            }\n          } else {\n            this.selectRow(row[i], true, true);\n          }\n        }\n\n        if (row.length === 0) {\n          for (let j = 0, l = dataset.length; j < l; j++) {\n            this.unselectRow(j, true, true);\n          }\n        }\n      } else {\n        this.selectRow(row.index(), true, true);\n      }\n    }\n\n    this.displayCounts();\n\n    if (!nosync) {\n      this.syncSelectedUI();\n    }\n    if (!selectAll) {\n      this.element.triggerHandler('selected', [this._selectedRows, 'select']);\n    }\n\n    return this._selectedRows;\n  },\n\n  /**\n   * Returns an array of row numbers for the rows containing the value for the specified field.\n   * @param  {string} fieldName The field name to search.\n   * @param  {any} value The value to use in search.\n   * @returns {array} an array of row numbers.\n   */\n  findRowsByValue(fieldName, value) {\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    let idx = -1;\n    const matchedRows = [];\n    for (let i = 0, data; i < dataset.length; i++) {\n      if (s.groupable) {\n        for (let k = 0; k < dataset[i].values.length; k++) {\n          idx++;\n          data = dataset[i].values[k];\n          if (data[fieldName] === value) {\n            matchedRows.push(idx);\n          }\n        }\n      } else {\n        data = s.treeGrid ? dataset[i].node : dataset[i];\n        if (data[fieldName] === value) {\n          matchedRows.push(i);\n        }\n      }\n    }\n    return matchedRows;\n  },\n\n  /**\n  * Sets the row status\n  * @param {object} idx The index of the row to add status to.\n  * @param {string} status The status type 'error', 'info' ect\n  * @param {object} tooltip The information for the message/tooltip\n  */\n  rowStatus(idx, status, tooltip) {\n    if (!status) {\n      delete this.settings.dataset[idx].rowStatus;\n      this.updateRow(idx);\n      return;\n    }\n\n    if (/dirty/.test(status)) {\n      return;\n    }\n\n    if (!this.settings.dataset[idx]) {\n      return;\n    }\n\n    this.settings.dataset[idx].rowStatus = {};\n    const rowStatus = this.settings.dataset[idx].rowStatus;\n\n    rowStatus.icon = status;\n    status = status.charAt(0).toUpperCase() + status.slice(1);\n    status = status.replace('-progress', 'Progress');\n    rowStatus.text = Locale.translate(status);\n\n    tooltip = tooltip ? tooltip.charAt(0).toUpperCase() + tooltip.slice(1) : rowStatus.text;\n    rowStatus.tooltip = tooltip;\n\n    this.updateRow(idx);\n    this.setupTooltips(true);\n  },\n\n  /**\n  * Get the column object by id\n  * @param  {number} id The column id to find\n  * @returns {object} The corresponding column.\n  */\n  columnById(id) {\n    return $.grep(this.settings.columns, e => e.id === id);\n  },\n\n  /**\n  * Get the column index from the col's id\n  * @param  {number} id The column id to find\n  * @returns {object} The corresponding columns current position.\n  */\n  columnIdxById(id) {\n    const cols = this.settings.columns;\n    let idx = -1;\n\n    for (let i = 0; i < cols.length; i++) {\n      if (cols[i].id === id) {\n        idx = i;\n        break;\n      }\n    }\n    return idx;\n  },\n\n  /**\n  * Handle all keyboard behavior\n  * @private\n  * @returns {void}\n  */\n  handleKeys() {\n    const self = this;\n    const isMultiple = self.settings.selectable === 'multiple';\n    const checkbox = $('th .datagrid-checkbox', self.headerRow);\n\n    // Handle header navigation\n    self.headerContainer.on('keydown.datagrid', 'th', function (e) {\n      const key = e.which || e.keyCode || e.charCode || 0;\n      const th = $(this);\n      const index = self.columnIdxById(th.attr('data-column-id'));\n      const last = self.visibleColumns().length - 1;\n      let triggerEl;\n      let move;\n\n      if ($(e.target).closest('.popupmenu').length > 0) {\n        return;\n      }\n\n      // Enter or Space\n      if (key === 13 || key === 32) {\n        triggerEl = (isMultiple && index === 0) ? $('.datagrid-checkbox', th) : th;\n        triggerEl.trigger('click.datagrid').focus();\n\n        if (key === 32) { // Prevent scrolling with space\n          e.preventDefault();\n        }\n      }\n\n      // Press Home, End, Left and Right arrow to move to first, last, previous or next\n      if ([35, 36, 37, 39].indexOf(key) !== -1) {\n        move = index;\n\n        // Home, End or Ctrl/Meta + Left/Right arrow to move to the first or last\n        if (/35|36/i.test(key) || ((e.ctrlKey || e.metaKey) && /37|39/i.test(key))) {\n          if (Locale.isRTL()) {\n            move = (key === 36 || ((e.ctrlKey || e.metaKey) && key === 37)) ? last : 0;\n          } else {\n            move = (key === 35 || ((e.ctrlKey || e.metaKey) && key === 39)) ? last : 0;\n          }\n        } else if (Locale.isRTL()) { // Left and Right arrow\n          move = key === 39 ? (index > 0 ? index - 1 : index) : (index < last ? index + 1 : last);\n        } else {\n          move = key === 37 ? (index > 0 ? index - 1 : index) : (index < last ? index + 1 : last);\n        }\n        // Update active cell\n        self.activeCell.cell = move;\n\n        // Making moves\n        th.removeAttr('tabindex').removeClass('is-active');\n        $('th:not(.is-hidden)', this.headerContainer).eq(move).attr('tabindex', '0').addClass('is-active')\n          .focus();\n        e.preventDefault();\n\n        // Sync the body scroll area\n        self.syncBodyScroll(th);\n      }\n\n      // Down arrow\n      if (key === 40) {\n        th.removeAttr('tabindex');\n        self.activeCell.node = self.cellNode(0, self.settings.groupable ? 0 : self.activeCell.cell).attr('tabindex', '0').focus();\n        e.preventDefault();\n      }\n    });\n\n    // Handle Editing / Keyboard\n    self.bodyContainer.on('keydown.datagrid', 'td, input', (e) => { //eslint-disable-line\n      const key = e.which || e.keyCode || e.charCode || 0;\n      let handled = false;\n\n      // F2 - toggles actionableMode \"true\" and \"false\"\n      if (key === 113) {\n        self.settings.actionableMode = !self.settings.actionableMode;\n        handled = true;\n      }\n\n      if (handled) {\n        e.preventDefault();\n        e.stopPropagation();\n        return handled;\n      }\n    });\n\n    // Press PageUp or PageDown to open the previous or next page and set focus to the first row.\n    // Press Alt+Up or Alt+Down to set focus to the first or last row on the current page.\n    // Press Alt+PageUp or Alt+PageDown to open the first or last page and\n    // set focus to the first row.\n\n    // Handle rest of the keyboard\n    self.bodyContainer.on('keydown.datagrid', 'td', function (e) {\n      const key = e.which || e.keyCode || e.charCode || 0;\n      let handled = false;\n      const isRTL = Locale.isRTL();\n      const node = self.activeCell.node;\n      const rowNode = $(this).parent();\n      const prevRow = rowNode.prevAll(':not(.is-hidden, .datagrid-expandable-row)').first();\n      const nextRow = rowNode.nextAll(':not(.is-hidden, .datagrid-expandable-row)').first();\n      let row = self.activeCell.row;\n      let cell = self.activeCell.cell;\n      const col = self.columnSettings(cell);\n      const isGroupRow = rowNode.is('.datagrid-rowgroup-header, .datagrid-rowgroup-footer');\n      const item = self.settings.dataset[self.dataRowIndex(node)];\n      const visibleRows = self.tableBody.find('tr:visible');\n      const getVisibleRows = function (index) {\n        const visibleRow = visibleRows.filter(`[aria-rowindex=\"${index + 1}\"]`);\n        if (visibleRow.is('.datagrid-rowgroup-header')) {\n          return visibleRow.index();\n        }\n        return self.dataRowIndex(visibleRow);\n      };\n\n      const getGroupCell = function (currentCell, lastCell, prev) {\n        const n = self.activeCell.groupNode || node;\n        let nextCell = currentCell + (prev ? -1 : +1);\n\n        if (nextCell > lastCell) {\n          nextCell = prev ?\n            n.prevAll(':visible').last() : n.nextAll(':visible').last();\n        } else {\n          nextCell = prev ?\n            n.prevAll(':visible').first() : n.nextAll(':visible').first();\n        }\n        return nextCell;\n      };\n\n      const getNextVisibleCell = function (currentCell, lastCell, prev) {\n        if (isGroupRow) {\n          return getGroupCell(currentCell, lastCell, prev);\n        }\n        let nextCell = currentCell + (prev ? -1 : +1);\n        if (nextCell > lastCell) {\n          return lastCell;\n        }\n        while (self.settings.columns[nextCell] && self.settings.columns[nextCell].hidden) {\n          nextCell = prev ? nextCell - 1 : nextCell + 1;\n        }\n        return nextCell;\n      };\n\n      const isSelectionCheckbox = !!($('.datagrid-selection-checkbox', node).length);\n      const lastRow = visibleRows.last();\n      const lastCell = self.settings.columns.length - 1;\n\n      // Tab, Left, Up, Right and Down arrow keys.\n      if ([9, 37, 38, 39, 40].indexOf(key) !== -1) {\n        if ($(e.target).closest('.code-block').length) {\n          return;\n        }\n      }\n\n      // Tab, Left and Right arrow keys.\n      if ([9, 37, 39].indexOf(key) !== -1) {\n        if (key === 9 && self.settings.onKeyDown) {\n          const ret = self.settings.onKeyDown(e);\n          if (ret === false) {\n            e.stopPropagation();\n            e.preventDefault();\n            return;\n          }\n        }\n\n        if (key === 9 && self.editor && self.editor.name === 'input' && col.inlineEditor === true) {\n          // Editor.destroy\n          self.editor.destroy();\n          self.editor = null;\n          return;\n        }\n\n        if (key === 9 && !self.settings.actionableMode) {\n          return;\n        }\n\n        if (key !== 9 && e.altKey) {\n          // [Alt + Left/Right arrow] to move to the first or last cell on the current row.\n          cell = ((key === 37 && !isRTL) || (key === 39 && isRTL)) ? 0 : lastCell;\n          self.setActiveCell(row, cell);\n        } else if (!self.quickEditMode || (key === 9)) {\n          if ((!isRTL && (key === 37 || key === 9 && e.shiftKey)) || // eslint-disable-line\n              (isRTL && (key === 39 || key === 9))) { // eslint-disable-line\n            cell = getNextVisibleCell(cell, lastCell, true);\n          } else {\n            cell = getNextVisibleCell(cell, lastCell);\n          }\n\n          if (cell instanceof jQuery) {\n            self.setActiveCell(cell);\n          } else {\n            self.setActiveCell(row, cell);\n          }\n\n          if (key === 9 && self.settings.actionableMode) {\n            self.makeCellEditable(self.activeCell.rowIndex, cell, e);\n            if (self.containsTextField(node) && self.containsTriggerField(node)) {\n              self.quickEditMode = true;\n            }\n          }\n          self.quickEditMode = false;\n          handled = true;\n        }\n      }\n\n      // Up arrow key\n      if (key === 38 && !self.quickEditMode) {\n        // Press [Control + Up] arrow to move to the first row on the first page.\n        if (e.altKey || e.metaKey) {\n          const firstRow = getVisibleRows(0);\n          self.setActiveCell(firstRow, cell);\n          handled = true;\n        } else { // Up arrow key to navigate by row.\n          if (row === 0 && !prevRow.is('.datagrid-rowgroup-header')) {\n            node.removeAttr('tabindex');\n            self.headerContainer.find('th').eq(cell).attr('tabindex', '0').focus();\n            return;\n          }\n          self.setActiveCell(prevRow, cell);\n          handled = true;\n        }\n      }\n\n      // Down arrow key\n      if (key === 40 && !self.quickEditMode) {\n        // Press [Control + Down] arrow to move to the last row on the last page.\n        if (e.altKey || e.metaKey) {\n          self.setActiveCell(lastRow, cell);\n          handled = true;\n        } else { // Down arrow key to navigate by row.\n          self.setActiveCell(nextRow, cell);\n          handled = true;\n        }\n      }\n\n      // Press Control+Spacebar to announce the current row when using a screen reader.\n      if (key === 32 && e.ctrlKey && node) {\n        let string = '';\n        row = node.closest('tr');\n\n        row.children().each(function () {\n          const cellNode = $(this);\n          // Read Header\n          // string += $('#' + cell.attr('aria-describedby')).text() + ' ' + cell.text() + ' ';\n          string += `${cellNode.text()} `;\n        });\n\n        $('body').toast({ title: '', audibleOnly: true, message: string });\n        handled = true;\n      }\n\n      // Press Home or End to move to the first or last cell on the current row.\n      if (key === 36) {\n        self.setActiveCell(row, 0);\n        handled = true;\n      }\n\n      // Home to Move to the end of the current row\n      if (key === 35) {\n        self.setActiveCell(row, lastCell);\n        handled = true;\n      }\n\n      // End to Move to last row of current cell\n      if (key === 34) {\n        self.setActiveCell(lastRow, cell);\n        handled = true;\n      }\n\n      // End to Move to first row of current cell\n      if (key === 33) {\n        self.setActiveCell(getVisibleRows(0), cell);\n        handled = true;\n      }\n\n      // For mode 'Selectable':\n      // Press Space to toggle row selection, or click to activate using a mouse.\n      if (key === 32 && (!self.settings.editable || isSelectionCheckbox)) {\n        row = node.closest('tr');\n\n        if ($(e.target).closest('.datagrid-row-detail').length === 1) {\n          return;\n        }\n        e.preventDefault();\n\n        // Toggle datagrid-expand with Space press\n        const btn = $(e.target).find('.datagrid-expand-btn, .datagrid-drilldown');\n        if (btn && btn.length) {\n          btn.trigger('click.datagrid');\n          e.preventDefault();\n          return;\n        }\n\n        if (isMultiple && e.shiftKey) {\n          self.selectRowsBetweenIndexes([self.lastSelectedRow, row.index()]);\n        } else {\n          self.toggleRowSelection(row);\n        }\n      }\n\n      // For Editable mode - press Enter or Space to edit or toggle a cell,\n      // or click to activate using a mouse.\n      if (self.settings.editable && key === 32) {\n        if (!self.editor) {\n          self.makeCellEditable(self.activeCell.rowIndex, cell, e);\n        }\n      }\n\n      // if column have click function to fire [ie. action button]\n      if (key === 13 && col.click && typeof col.click === 'function') {\n        if (!node.hasClass('is-cell-readonly')) {\n          col.click(e, [{ row, cell, item, originalEvent: e }]);\n        }\n      }\n\n      if (self.settings.editable && key === 13) {\n        const target = $(e.target);\n        // Allow shift to add a new line\n        if (target.is('textarea') && e.shiftKey) {\n          return;\n        }\n        // Allow the menu buttons\n        if (target.is('.btn-menu') || target.closest('.popupmenu.is-open').length) {\n          return;\n        }\n\n        if (self.editor) {\n          self.quickEditMode = false;\n          self.commitCellEdit(self.editor.input);\n          self.setNextActiveCell(e);\n        } else {\n          self.makeCellEditable(self.activeCell.rowIndex, cell, e);\n          if (self.containsTextField(node) && self.containsTriggerField(node)) {\n            self.quickEditMode = true;\n          }\n        }\n        handled = true;\n      }\n\n      // Any printable character - well make it editable\n      if ([9, 13, 32, 35, 36, 37, 38, 39, 40, 113].indexOf(key) === -1 &&\n        !e.altKey && !e.shiftKey && !e.ctrlKey && !e.metaKey && self.settings.editable) {\n        if (!self.editor) {\n          self.makeCellEditable(self.activeCell.rowIndex, cell, e);\n        }\n      }\n\n      // If multiSelect is enabled, press Control+A to toggle select all rows\n      if (isMultiple && !self.editor && ((e.ctrlKey || e.metaKey) && key === 65)) {\n        checkbox\n          .addClass('is-checked')\n          .removeClass('is-partial')\n          .attr('aria-checked', 'true');\n        self.selectAllRows();\n        handled = true;\n      }\n\n      if (handled) {\n        e.preventDefault();\n        e.stopPropagation();\n        return false; // eslint-disable-line\n      }\n    });\n  },\n\n  /**\n   * Sync the body area with the header or other containers.\n   * @private\n   * @param  {element} elem The element to check.\n   */\n  syncBodyScroll(elem) {\n    let container = elem.closest('.datagrid-header');\n    if (container.length > 0) {\n      const left = container.scrollLeft();\n      if (!(elem.is(':last-child') && left === 0)) {\n        this.bodyWrapperCenter.scrollLeft(container.scrollLeft());\n      }\n      return;\n    }\n\n    container = elem.closest('.datagrid-body.left, .datagrid-body.right');\n    if (container.length > 0) {\n      this.bodyWrapperCenter.scrollTop(container.scrollTop());\n    }\n  },\n\n  /**\n   * Does the column editor have a text field.\n   * @private\n   * @param  {object} container The dom element\n   * @returns {boolean} If it does or not\n   */\n  containsTextField(container) {\n    const noTextTypes = ['image', 'button', 'submit', 'reset', 'checkbox', 'radio'];\n    let selector = 'textarea, input';\n    const l = noTextTypes.length;\n    let i;\n\n    selector += l ? ':not(' : '';\n    for (i = 0; i < l; i++) {\n      selector += `[type=${noTextTypes[i]}],`;\n    }\n    selector = l ? (`${selector.slice(0, -1)})`) : '';\n\n    return !!($(selector, container).length);\n  },\n\n  /**\n   * Does the column editor have a picker/trigger field.\n   * @private\n   * @param  {object} container The dom element\n   * @returns {boolean} If it does or not\n   */\n  containsTriggerField(container) {\n    const selector = '.dropdown, .datepicker, .lookup';\n    return !($(selector, container).length);\n  },\n\n  /**\n   * Is a specific row/cell editable?\n   * @param  {number} row The row index\n   * @param  {number} cell The cell index\n   * @returns {boolean} returns true if the cell is editable\n   */\n  isCellEditable(row, cell) {\n    if (!this.settings.editable) {\n      return false;\n    }\n\n    const col = this.columnSettings(cell);\n    if (col.readonly) {\n      return false;\n    }\n\n    // Check if cell is editable via hook function\n    const cellNode = this.activeCell.node.find('.datagrid-cell-wrapper');\n    const cellValue = (cellNode.text() ? cellNode.text() :\n      this.fieldValue(this.settings.dataset[row], col.field));\n\n    if (col.isEditable) {\n      const canEdit = col.isEditable(row, cell, cellValue, col, this.settings.dataset[row]);\n\n      if (!canEdit) {\n        return false;\n      }\n    }\n\n    if (!col.editor) {\n      return false;\n    }\n\n    return true;\n  },\n\n  /**\n   * Invoked in three cases\n   * 1) a row click\n   * 2) keyboard and enter\n   * 3) In actionable mode and tabbing\n   * @private\n   * @param  {number} row The row index\n   * @param  {number} cell The cell index\n   * @param  {object} event The event information.\n   * @returns {boolean} returns true if the cell is editable\n   */\n  makeCellEditable(row, cell, event) {\n    if (this.activeCell.node.closest('tr').hasClass('datagrid-summary-row') ||\n      (this.editor && this.editor.stayInEditMode)) {\n      return;\n    }\n\n    // Already in edit mode\n    const cellNode = this.activeCell.node.find('.datagrid-cell-wrapper');\n    const cellParent = cellNode.parent('td');\n    const treeNode = $('.datagrid-tree-node', cellNode).length > 0;\n    const treeExpandBtn = $('.datagrid-expand-btn', cellNode).length > 0;\n\n    if (cellParent.hasClass('is-editing') || cellParent.hasClass('is-editing-inline')) {\n      return false; // eslint-disable-line\n    }\n\n    // Commit Previous Edit\n    if (this.editor && this.editor.input && !this.editor.stayInEditMode) {\n      this.commitCellEdit(this.editor.input);\n    }\n\n    // Locate the Editor\n    const col = this.columnSettings(cell);\n\n    // Select the Rows if the cell is editable\n    if (!col.editor) {\n      if (event.keyCode === 32 && !$(event.currentTarget).find('.datagrid-selection-checkbox').length) {\n        this.toggleRowSelection(this.activeCell.node.closest('tr'));\n      }\n      return false; // eslint-disable-line\n    }\n\n    const thisRow = this.actualRowNode(row);\n    const idx = this.settings.treeGrid ? this.actualRowIndex(thisRow) : this.dataRowIndex(thisRow);\n    const rowData = this.settings.treeGrid ?\n      this.settings.treeDepth[idx].node :\n      this.settings.dataset[idx];\n    const cellWidth = cellParent.outerWidth();\n    const isEditor = $('.is-editor', cellParent).length > 0;\n    const isPlaceholder = $('.is-placeholder', cellNode).length > 0;\n    let cellValue = (cellNode.text() ?\n      cellNode.text() : this.fieldValue(rowData, col.field));\n\n    if (isEditor || isPlaceholder) {\n      cellValue = this.fieldValue(rowData, col.field);\n    }\n\n    if (!this.isCellEditable(idx, cell)) {\n      return false; // eslint-disable-line\n    }\n\n    if (treeExpandBtn || treeNode) {\n      if (treeExpandBtn) {\n        cellValue = $('> span', cellNode).text();\n      }\n      if (typeof cellValue === 'string') {\n        cellValue = cellValue.replace(/^\\s/, '');\n      }\n    }\n\n    // In Show Editor mode the editor is on form already\n    if (!col.inlineEditor) {\n      if (isEditor) {\n        cellNode.css({ position: 'static', height: cellNode.outerHeight() });\n      }\n      // initialis Editor\n      cellParent\n        .addClass('is-editing')\n        .css({ 'max-width': cellWidth, 'min-width': cellWidth, width: cellWidth });\n\n      cellNode.empty();\n    } else {\n      cellParent.addClass('is-editing-inline');\n    }\n\n    /**\n    * Fires before a cell goes into edit mode. Giving you a chance to adjust column settings.\n    * @event entereditmode\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {number} args.row An array of selected rows.\n    * @property {number} args.cell An array of selected rows.\n    * @property {object} args.item The current sort column.\n    * @property {HTMLElement} args.target The cell html element that was entered.\n    * @property {any} args.value The cell value.\n    * @property {object} args.column The column object\n    * @property {object} args.editor The editor object.\n    */\n    this.element.triggerHandler('beforeentereditmode', [{ row: idx, cell, item: rowData, target: cellNode, value: cellValue, column: col, editor: this.editor }]);\n\n    this.editor =  new col.editor(idx, cell, cellValue, cellNode, col, event, this, rowData); // eslint-disable-line\n\n    if (this.settings.onEditCell) {\n      this.settings.onEditCell(this.editor);\n    }\n\n    if (this.editor.useValue) {\n      cellValue = this.fieldValue(rowData, col.field);\n    }\n    this.editor.val(cellValue);\n\n    // Set original data for trackdirty\n    if (this.settings.showDirty) {\n      let originalVal = cellValue;\n\n      if (originalVal === '' && /checkbox|favorite/i.test(this.editor.name)) {\n        originalVal = false;\n      }\n\n      const data = { originalVal, isDirty: false };\n      if (typeof this.dirtyArray === 'undefined') {\n        this.dirtyArray = [];\n      }\n      if (typeof this.dirtyArray[idx] === 'undefined') {\n        this.dirtyArray[idx] = [];\n        this.dirtyArray[idx][cell] = data;\n      } else if (typeof this.dirtyArray[idx][cell] === 'undefined') {\n        this.dirtyArray[idx][cell] = data;\n      }\n    }\n\n    this.editor.focus();\n\n    /**\n    * Fires after a cell goes into edit mode.\n    * @event entereditmode\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {number} args.row An array of selected rows.\n    * @property {number} args.cell An array of selected rows.\n    * @property {object} args.item The current sort column.\n    * @property {HTMLElement} args.target The cell html element that was entered.\n    * @property {any} args.value The cell value.\n    * @property {object} args.column The column object\n    * @property {object} args.editor The editor object.\n    */\n    this.element.triggerHandler('entereditmode', [{ row: idx, cell, item: rowData, target: cellNode, value: cellValue, column: col, editor: this.editor }]);\n\n    return true;  //eslint-disable-line\n  },\n\n  /**\n   * Commit the cell thats currently in edit mode.\n   * @private\n   * @param  {number} input The input dom element.\n   */\n  commitCellEdit(input) {\n    if (!this.editor) {\n      return;\n    }\n\n    input = input instanceof jQuery ? input : $(input);\n\n    let newValue;\n    let cellNode;\n    const isEditor = this.editor.name === 'editor';\n    const isFileupload = this.editor.name === 'fileupload';\n    const isUseActiveRow = !(input.is('.timepicker, .datepicker, .lookup, .spinbox .colorpicker'));\n\n    // Editor.getValue\n    if (typeof this.editor.val === 'function') {\n      newValue = this.editor.val();\n    }\n\n    if (isEditor) {\n      cellNode = this.editor.td;\n    } else if (isFileupload) {\n      if (this.editor.status === 'clear') {\n        newValue = '';\n      } else if (this.editor.status === 'init' || this.editor.status === 'cancel') {\n        newValue = this.editor.originalValue;\n      }\n      // Fix: Not sure why, but `input.closest('td')` did not work\n      cellNode = this.tableBody.find(`#${input.attr('id')}`).closest('td');\n      newValue = xssUtils.escapeHTML(newValue);\n    } else {\n      cellNode = input.closest('td');\n      newValue = xssUtils.escapeHTML(newValue);\n    }\n\n    let rowIndex;\n    let dataRowIndex;\n    if (this.settings.source !== null && isUseActiveRow) {\n      rowIndex = this.activeCell.rowIndex;\n      dataRowIndex = this.activeCell.dataRow;\n    } else {\n      rowIndex = this.actualRowIndex(cellNode.parent());\n      dataRowIndex = this.dataRowIndex(cellNode.parent());\n    }\n\n    const cell = cellNode.attr('aria-colindex') - 1;\n    const col = this.columnSettings(cell);\n    const rowData = this.settings.treeGrid ? this.settings.treeDepth[dataRowIndex].node :\n      this.settings.dataset[dataRowIndex];\n    const oldValue = this.fieldValue(rowData, col.field);\n\n    const doCommit = () => {\n      // Format Cell again\n      const isInline = cellNode.hasClass('is-editing-inline');\n      cellNode.removeClass('is-editing is-editing-inline');\n\n      // Editor.destroy\n      this.editor.destroy();\n      this.editor = null;\n\n      // Save the Cell Edit back to the data set\n      this.updateCellNode(rowIndex, cell, newValue, false, isInline);\n      const value = this.fieldValue(rowData, col.field);\n\n      /**\n      * Fires after a cell goes out of edit mode.\n      * @event exiteditmode\n      * @memberof Datagrid\n      * @property {object} event The jquery event object\n      * @property {object} args Additional arguments\n      * @property {number} args.row An array of selected rows.\n      * @property {number} args.cell An array of selected rows.\n      * @property {object} args.item The current sort column.\n      * @property {HTMLElement} args.target The cell html element that was entered.\n      * @property {any} args.value The cell value.\n      * @property {any} args.oldValue The previous cell value.\n      * @property {object} args.column The column object\n      * @property {object} args.editor The editor object.\n      */\n      this.element.triggerHandler('exiteditmode', [{\n        row: rowIndex,\n        cell,\n        item: rowData,\n        target: cellNode,\n        value,\n        oldValue,\n        column: col,\n        editor: this.editor\n      }]);\n    };\n\n    const args = [{\n      row: rowIndex,\n      cell,\n      item: rowData,\n      target: cellNode,\n      oldValue,\n      column: col,\n      editor: this.editor\n    }];\n\n    $.when(this.element.triggerHandler('beforecommitcelledit', args)).done((response) => {\n      const isFalse = v => ((typeof v === 'string' && v.toLowerCase() === 'false') ||\n      (typeof v === 'boolean' && v === false) ||\n      (typeof v === 'number' && v === 0));\n      if (!isFalse(response)) {\n        doCommit();\n      }\n    });\n  },\n\n  /**\n   * Run validation for the column, for a particular cell.\n   * @param  {number} row The row index\n   * @param  {number} cell The cell index\n   */\n  validateCell(row, cell) {\n    const self = this;\n    const column = this.columnSettings(cell);\n    const validate = column.validate;\n    let validationType;\n\n    if (!validate) {\n      return;\n    }\n\n    let dfd;\n    const dfds = [];\n    const rules = column.validate.split(' ');\n    const validator = $.fn.validation;\n    const cellValue = this.fieldValue(this.settings.dataset[row], column.field);\n    const messages = [];\n    let messageText = '';\n    let i;\n\n    function manageResult(result, displayMessage, ruleName, dfrd) {\n      const rule = validator.rules[ruleName];\n\n      validationType = $.fn.validation.ValidationTypes[rule.type] ||\n        $.fn.validation.ValidationTypes.error;\n      messageText = '';\n\n      if (messages[validationType.type]) {\n        messageText = messages[validationType.type];\n      }\n\n      if (!result && displayMessage) {\n        if (messageText) {\n          messageText = ((/^\\u2022/.test(messageText)) ? '' : '\\u2022 ') + messageText;\n          messageText += `<br/>${'\\u2022 '}${rule.message}`;\n        } else {\n          messageText = rule.message;\n        }\n\n        messages[validationType.type] = messageText;\n      }\n\n      dfrd.resolve();\n    }\n\n    for (i = 0; i < rules.length; i++) {\n      const rule = validator.rules[rules[i]];\n      const gridInfo = { row, cell, item: this.settings.dataset[row], column, grid: self };\n\n      dfd = $.Deferred();\n\n      if (rule.async) {\n        rule.check(cellValue, $('<input>').val(cellValue), gridInfo, manageResult, dfd);\n      } else {\n        manageResult(rule.check(cellValue, $('<input>').val(cellValue), gridInfo), true, rules[i], dfd);\n      }\n      dfds.push(dfd);\n    }\n\n    $.when(...dfds).then(() => {\n      const validationTypes = $.fn.validation.ValidationTypes;\n      for (const props in validationTypes) {  // eslint-disable-line\n        messageText = '';\n        validationType = validationTypes[props];\n        if (messages[validationType.type]) {\n          messageText = messages[validationType.type];\n        }\n        if (messageText !== '') {\n          self.showCellError(row, cell, messageText, validationType.type);\n          const rowNode = this.dataRowNode(row);\n          self.element.trigger(`cell${validationType.type}`, { row, cell, message: messageText, target: this.cellNode(rowNode, cell), value: cellValue, column });\n        } else {\n          self.clearCellError(row, cell, validationType.type);\n        }\n      }\n    });\n  },\n\n  /**\n  * Show the cell errors.\n  * @param  {number} row The row index.\n  * @param  {number} cell The cell index.\n  * @param  {string} message The message text.\n  * @param  {string} type The message type (infor, error, alert )\n  * @returns {void}\n  */\n  showCellError(row, cell, message, type) {\n    const rowNode = this.dataRowNode(row);\n    const node = this.cellNode(rowNode, cell);\n\n    // clear the table nonVisibleCellErrors for the row and cell\n    this.clearNonVisibleCellErrors(row, cell, type);\n\n    if (!node.length) {\n      // Store the nonVisibleCellError\n      this.nonVisibleCellErrors.push({ row, cell, message, type });\n      this.showNonVisibleCellErrors();\n      return;\n    }\n\n    // Add icon and classes\n    node.addClass(type).attr(`data-${type}message`, message);\n\n    // Add and show tooltip\n    let icon = node.find(`.icon-${type}`);\n    if (!icon.length) {\n      const wrapper = node.find('.datagrid-cell-wrapper');\n      wrapper.append($($.createIcon({ classes: [`icon-${type}`], icon: type })));\n      icon = node.find(`.icon-${type}`);\n\n      const tooltip = {\n        forced: true,\n        placement: 'bottom',\n        content: message,\n        isError: type === 'error' || type === 'dirtyerror',\n        wrapper: icon\n      };\n      this.cacheTooltip(icon, tooltip);\n      this.setupTooltips(false, true);\n    }\n  },\n\n  /**\n   * Show all non visible cell errors\n   * @private\n   * @returns {void}\n   */\n  showNonVisibleCellErrors() {\n    // Create empty toolbar\n    if (!this.toolbar) {\n      this.settings.toolbar = { title: ' ' };\n      this.appendToolbar();\n    }\n\n    // process via type\n    for (const props in $.fn.validation.ValidationTypes) {  // eslint-disable-line\n      const validationType = $.fn.validation.ValidationTypes[props].type;\n      const errors = $.grep(this.nonVisibleCellErrors, error => error.type === validationType);\n      this.showNonVisibleCellErrorType(errors, validationType);\n    }\n  },\n\n  /**\n   * Show all non visible cell errors, for a given message/validation type.\n   * @private\n   * @param  {array} nonVisibleCellErrors An array of non visible cells, in error state.\n   * @param  {string} type The message type to show\n   */\n  showNonVisibleCellErrorType(nonVisibleCellErrors, type) {\n    let messages;\n    let tableerrors;\n    let icon;\n    let i;\n    const nonVisiblePages = [];\n    const validationType = $.fn.validation.ValidationTypes[type] ||\n      $.fn.validation.ValidationTypes.error;\n\n    if (this.toolbar.parent().find('.table-errors').length === 1) {\n      tableerrors = this.toolbar.parent().find('.table-errors');\n    }\n\n    if (nonVisibleCellErrors.length === 0) {\n      // clear the displayed message\n      if (tableerrors && tableerrors.length) {\n        icon = tableerrors.find(`.icon-${validationType.type}`);\n        this.hideTooltip();\n        tableerrors.find(`.icon-${validationType.type}`).remove();\n      }\n      return;\n    }\n\n    // Process message type, so it displays one message per page\n    for (i = 0; i < nonVisibleCellErrors.length; i++) {\n      const page = Math.floor((nonVisibleCellErrors[i].row + this.settings.pagesize) /\n        this.settings.pagesize);\n      if ($.inArray(page, nonVisiblePages) === -1) {\n        nonVisiblePages.push(page);\n      }\n    }\n\n    for (i = 0; i < nonVisiblePages.length; i++) {\n      messages = `${(messages ? `${messages}<br>` : '') + Locale.translate(validationType.pagingMessageID)} ${nonVisiblePages[i]}`;\n    }\n\n    if (this.toolbar.parent().find('.table-errors').length === 0) {\n      tableerrors = $('<div class=\"table-errors\"></div>');\n    }\n    icon = tableerrors.find(`.icon-${type}`);\n    if (!icon.length) {\n      tableerrors.append($($.createIcon({ classes: [`icon-${type}`], icon: type })));\n      icon = tableerrors.find(`.icon-${type}`);\n    }\n\n    if (this.element.hasClass('has-toolbar')) {\n      // Add Error to the Toolbar\n      this.toolbar.children('.title').append(tableerrors);\n    }\n\n    this.cacheTooltip(icon, {\n      forced: true,\n      placement: 'bottom',\n      content: messages,\n      isError: type === 'error' || type === 'dirtyerror',\n      wrapper: icon\n    });\n  },\n\n  /**\n   * Clear all error for a given cell in a row\n   * @param {number} row The row index.\n   * @param {number} cell The cell index.\n   * @returns {void}\n   */\n  clearAllCellError(row, cell) {\n    const validationTypes = $.fn.validation.ValidationTypes;\n    for (const props in validationTypes) {  // eslint-disable-line\n      const validationType = validationTypes[props];\n      this.clearCellError(row, cell, validationType.type);\n    }\n  },\n\n  /**\n   * Clear a cell with an error of a given type\n   * @param {number} row The row index.\n   * @param {number} cell The cell index.\n   * @param {string} type of error.\n   * @returns {void}\n   */\n  clearCellError(row, cell, type) {\n    this.clearNonVisibleCellErrors(row, cell, type);\n    const rowNode = this.dataRowNode(row);\n    const node = this.cellNode(rowNode, cell);\n\n    if (!node.length) {\n      return;\n    }\n\n    this.clearNodeErrors(node, type);\n  },\n\n  /**\n   * Clear a non visible cells from errors of a given type\n   * @private\n   * @param {number} row The row index.\n   * @param {number} cell The cell index.\n   * @param {string} type of error.\n   * @returns {void}\n   */\n  clearNonVisibleCellErrors(row, cell, type) {\n    if (!this.nonVisibleCellErrors.length) {\n      return;\n    }\n\n    this.nonVisibleCellErrors = $.grep(this.nonVisibleCellErrors, (error) => {\n      if (!(error.row === row && error.cell === cell && error.type === type)) {\n        return error;\n      }\n      return '';\n    });\n\n    if (!this.nonVisibleCellErrors.length) {\n      this.showNonVisibleCellErrors();\n    }\n  },\n\n  /**\n   * Clear a row level all errors, alerts, info messages\n   * @param {number} row The row index.\n   * @returns {void}\n   */\n  clearRowError(row) {\n    const classList = 'error alert rowstatus-row-error rowstatus-row-alert rowstatus-row-info rowstatus-row-in-progress rowstatus-row-success';\n    const rowNode = this.dataRowNode(row);\n\n    rowNode.removeClass(classList);\n    this.rowStatus(row, '', '');\n    for (let cell = 0; cell < this.settings.columns.length; cell++) {\n      this.clearAllCellError(row, cell);\n    }\n  },\n\n  /**\n   * Clear all errors, alerts and info messages in entire datagrid.\n   * @returns {void}\n   */\n  clearAllErrors() {\n    let rowStatus = 0;\n    for (let row = 0; row < this.settings.dataset.length; row++) {\n      if (this.settings.dataset[row].rowStatus) {\n        delete this.settings.dataset[row].rowStatus;\n        rowStatus++;\n      }\n      for (let cell = 0; cell < this.settings.columns.length; cell++) {\n        this.clearAllCellError(row, cell);\n      }\n    }\n\n    if (rowStatus > 0) {\n      this.render();\n    }\n  },\n\n  /**\n   * Remove messages form a cell element.\n   * @private\n   * @param {object} node cell element.\n   * @param {string} type of messages.\n   * @returns {void}\n   */\n  clearNodeErrors(node, type) {\n    node = node instanceof jQuery ? node[0] : node;\n    node.classList.remove(type);\n    node.removeAttribute(`data-${type}message`);\n\n    const icon = node.querySelector(`.icon-${type}`);\n    if (icon) {\n      icon.parentNode.removeChild(icon);\n      this.hideTooltip();\n    }\n  },\n\n  /**\n  * Set the row status on a row to none.\n  * @returns {void}\n  */\n  resetRowStatus() {\n    const errors = this.settings.dataset.filter(row => row.rowStatus);\n    for (let i = 0; i < errors.length; i++) {\n      delete errors[i].rowStatus;\n    }\n    if (errors.length > 0) {\n      this.render();\n    }\n\n    // Clear dirty cells\n    this.clearDirty();\n  },\n\n  /**\n   * Clear dirty css class on all cells for given parent element.\n   * @private\n   * @param  {object} elem The parent element.\n   * @returns {void}\n   */\n  clearDirtyClass(elem) {\n    elem = elem instanceof jQuery ? elem[0] : elem;\n    if (elem) {\n      const cells = [].slice.call(elem.querySelectorAll('.is-dirty-cell'));\n      cells.forEach((cell) => {\n        cell.classList.remove('is-dirty-cell');\n      });\n    }\n  },\n\n  /**\n   * Clear all dirty cells.\n   * @returns {void}\n   */\n  clearDirty() {\n    if (this.settings.showDirty && this.dirtyArray) {\n      this.clearDirtyClass(this.element);\n      this.dirtyArray = undefined;\n    }\n  },\n\n  /**\n   * Clear all dirty cells in given row.\n   * @param  {number} row The row index.\n   * @returns {void}\n   */\n  clearDirtyRow(row) {\n    if (this.settings.showDirty && this.dirtyArray && typeof row === 'number') {\n      const rowNode = this.rowNodes(row);\n      this.clearDirtyClass(rowNode);\n      this.dirtyArray[row] = undefined;\n    }\n  },\n\n  /**\n   * Clear dirty on given cell.\n   * @param  {number} row The row index.\n   * @param  {number} cell The cell index.\n   * @returns {void}\n   */\n  clearDirtyCell(row, cell) {\n    if (this.settings.showDirty && this.dirtyArray &&\n      typeof row === 'number' && typeof cell === 'number') {\n      const dirtyRow = this.dirtyArray[row];\n      if (typeof dirtyRow !== 'undefined') {\n        this.cellNode(row, cell).removeClass('is-dirty-cell');\n        this.dirtyArray[row][cell] = undefined;\n      }\n    }\n  },\n\n  /**\n  * Return all of the currently dirty cells.\n  * @returns {array} An array of dirty cells.\n  */\n  dirtyCells() {\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    const cells = [];\n\n    if (s.showDirty && this.dirtyArray && this.dirtyArray.length) {\n      for (let i = 0, l = dataset.length; i < l; i++) {\n        const row = this.dirtyArray[i];\n        if (typeof row !== 'undefined') {\n          for (let i2 = 0, l2 = row.length; i2 < l2; i2++) {\n            const col = row[i2];\n            if (typeof col !== 'undefined' && col.isDirty) {\n              cells.push(s.treeGrid ? dataset[i].node : dataset[i]);\n            }\n          }\n        }\n      }\n    }\n    return cells;\n  },\n\n  /**\n  * Return all of the currently dirty rows by row index.\n  * @returns {array} An array of dirty rows.\n  */\n  dirtyRows() {\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    const rows = [];\n\n    if (s.showDirty && this.dirtyArray && this.dirtyArray.length) {\n      for (let i = 0, l = dataset.length; i < l; i++) {\n        const row = this.dirtyArray[i];\n        if (typeof row !== 'undefined') {\n          for (let i2 = 0, l2 = row.length; i2 < l2; i2++) {\n            const col = row[i2];\n            if (typeof col !== 'undefined' && col.isDirty) {\n              rows.push(s.treeGrid ? dataset[i].node : dataset[i]);\n              break;\n            }\n          }\n        }\n      }\n    }\n    return rows;\n  },\n\n  /**\n   * Show an error on a row of a given type.\n   * @param  {number} row The row index.\n   * @param  {string} message The row description.\n   * @param  {string} type The error type.\n   * @returns {void}\n   */\n  showRowError(row, message, type) {\n    const messageType = type || 'error';\n    const rowNode = this.dataRowNode(row);\n\n    rowNode.addClass(type);\n    this.rowStatus(row, messageType, message);\n  },\n\n  /**\n   * Validate all visible cells in a row if they have validation on the column\n   * @param  {number} row The row index.\n   * @returns {void}\n   */\n  validateRow(row) {\n    if (!row) {\n      return;\n    }\n\n    for (let i = 0; i < this.settings.columns.length; i++) {\n      this.validateCell(row, i);\n    }\n  },\n\n  /**\n   * Validate all rows and cells in the entire grid if they have validation on the column\n   * @returns {void}\n   */\n  validateAll() {\n    for (let j = 0; j < this.settings.dataset.length; j++) {\n      for (let i = 0; i < this.settings.columns.length; i++) {\n        this.validateCell(j, i);\n      }\n    }\n  },\n\n  /**\n   * Get the settings for a column by index.\n   * @private\n   * @param  {number} idx The column index.\n   * @returns {array} The settings array\n   */\n  columnSettings(idx) {\n    const foundColumn = this.settings.columns[idx];\n    return foundColumn || {};\n  },\n\n  /**\n   * Attempt to serialize the value back into the dataset\n   * @private\n   * @param {any} value The new column value\n   * @param {any} oldVal The old column value.\n   * @param {number} col The column definition\n   * @param {number} row  The row index.\n   * @param {number} cell The cell index.\n   * @returns {void}\n   */\n  coerceValue(value, oldVal, col, row, cell) {\n    let newVal;\n\n    if (col.serialize) {\n      newVal = col.serialize(value, oldVal, col, row, cell, this.settings.dataset[row]);\n      return newVal;\n    } else if (col.sourceFormat) {\n      if (value instanceof Date) {\n        newVal = Locale.parseDate(value, col.sourceFormat);\n      } else {\n        newVal = Locale.formatDate(value, { pattern: col.sourceFormat });\n      }\n    } else if (typeof oldVal === 'number' && value) {\n      newVal = Locale.parseNumber(value); // remove thousands sep , keep a number a number\n    }\n\n    return newVal;\n  },\n\n  /**\n   * Update one cell with a specific value\n   * @param {number} row  The row index.\n   * @param {number} cell The cell index.\n   * @param {any} value The value to use.\n   * @returns {void}\n   */\n  updateCell(row, cell, value) {\n    const col = this.columnSettings(cell);\n\n    if (value === undefined) {\n      value = this.fieldValue(this.settings.dataset[row], col.field);\n    }\n\n    this.updateCellNode(row, cell, value, true);\n  },\n\n  /**\n   * Update one cell with a specific value\n   * @private\n   * @param {number} row  The row index.\n   * @param {number} cell The cell index.\n   * @param {any} value The value to use.\n   * @param {boolean} fromApiCall Us from an api call.\n   * @param {boolean} isInline If the editor is an inline value.\n   * @returns {void}\n   */\n  updateCellNode(row, cell, value, fromApiCall, isInline) {\n    let coercedVal;\n    let rowNodes = this.rowNodes(row);\n    let cellNode = rowNodes.find('td').eq(cell);\n    const col = this.settings.columns[cell] || {};\n    let formatted = '';\n    const formatter = (col.formatter ? col.formatter : this.defaultFormatter);\n    const isEditor = $('.editor', cellNode).length > 0;\n    const isTreeGrid = this.settings.treeGrid;\n    let dataRowIndex = this.dataRowIndex(rowNodes);\n    if (dataRowIndex === null || dataRowIndex === undefined || isNaN(dataRowIndex)) {\n      dataRowIndex = row;\n    }\n    const rowData = isTreeGrid ?\n      this.settings.treeDepth[row].node :\n      this.settings.dataset[dataRowIndex];\n\n    if (rowNodes.length === 0 && this.settings.paging) {\n      // TODO Frozen Editing with Paging\n      rowNodes = this.visualRowNode(row);\n      cellNode = rowNodes.find('td').eq(cell);\n    }\n    const oldVal = this.fieldValue(rowData, col.field);\n\n    // Coerce/Serialize value if from cell edit\n    if (!fromApiCall) {\n      coercedVal = this.coerceValue(value, oldVal, col, row, cell);\n\n      // coerced value may be coerced to empty string, null, or 0\n      if (coercedVal === undefined) {\n        coercedVal = value;\n      }\n    } else {\n      coercedVal = value;\n    }\n\n    // Remove rowStatus icon\n    if (rowNodes.length && rowData && !rowData.rowStatus) {\n      const rowstatusIcon = rowNodes.find('svg.icon-rowstatus');\n      if (rowstatusIcon.length) {\n        rowstatusIcon.remove();\n      }\n    }\n\n    // Remove older tooltip data\n    this.removeTooltipData(cellNode);\n\n    // Update the value in the dataset\n    if (cell === 0 && rowData && rowData.rowStatus) {\n      let svg = cellNode.find('svg.icon-rowstatus');\n\n      if (rowNodes && cellNode[0]) {\n        for (let i = 0; i < rowNodes.length; i++) {\n          rowNodes[i].classList.add(`rowstatus-row-${rowData.rowStatus.icon}`);\n        }\n        cellNode[0].classList.add('rowstatus-cell');\n\n        if (!svg.length) {\n          const svgIcon = rowData.rowStatus.icon === 'success' ? '#icon-check' : '#icon-exclamation';\n          cellNode.prepend(`<svg class=\"icon icon-rowstatus\" focusable=\"false\" aria-hidden=\"true\" role=\"presentation\"><use xlink:href=\"${svgIcon}\"></use></svg>`);\n        }\n      }\n      if (rowData.rowStatus.tooltip) {\n        svg = cellNode.find('svg.icon-rowstatus');\n        const statusIcon = rowData.rowStatus.icon;\n        this.cacheTooltip(svg, {\n          forced: true,\n          placement: 'right',\n          content: rowData.rowStatus.tooltip,\n          isError: statusIcon === 'error' || statusIcon === 'dirtyerror',\n          wrapper: cellNode\n        });\n      }\n    }\n\n    coercedVal = xssUtils.unescapeHTML(coercedVal);\n\n    if (col.field && coercedVal !== oldVal) {\n      if (col.field.indexOf('.') > -1) {\n        let rowDataObj = rowData;\n        const nbrParts = col.field.split('.').length;\n        col.field.split('.').forEach((part, index) => {\n          if (index === nbrParts - 1) {\n            rowDataObj[part] = coercedVal;\n          } else {\n            rowDataObj = rowDataObj[part];\n          }\n        });\n      } else {\n        rowData[col.field] = coercedVal;\n      }\n    }\n\n    // update cell value\n    const escapedVal = xssUtils.escapeHTML(coercedVal);\n    const val = (isEditor ? coercedVal : escapedVal);\n    formatted = this.formatValue(formatter, row, cell, val, col, rowData);\n\n    if (col.contentVisible) {\n      const canShow = col.contentVisible(row, cell, escapedVal, col, rowData);\n      if (!canShow) {\n        formatted = '';\n      }\n    }\n\n    if (!isInline) {\n      cellNode.find('.datagrid-cell-wrapper').html(formatted);\n    }\n\n    if (!fromApiCall) {\n      // Validate the cell\n      this.validateCell(dataRowIndex, cell);\n\n      // Update and set trackdirty\n      if (this.isDirtyCellNotUndefined(row, cell)) {\n        this.dirtyArray[row][cell].value = value;\n        this.dirtyArray[row][cell].coercedVal = coercedVal;\n        this.dirtyArray[row][cell].escapedCoercedVal = xssUtils.escapeHTML(coercedVal);\n        this.dirtyArray[row][cell].cellNodeText = cellNode.text();\n        this.setIsDirtyAndIcon(row, cell, cellNode);\n      }\n    }\n\n    if (coercedVal !== oldVal && !fromApiCall) {\n      const args = {\n        row: this.settings.source !== null ? dataRowIndex : row,\n        relativeRow: row,\n        cell,\n        target: cellNode,\n        value: coercedVal,\n        oldValue: oldVal,\n        column: col\n      };\n      args.rowData = isTreeGrid && this.settings.treeDepth[row] ?\n        this.settings.treeDepth[row].node : rowData;\n\n      /**\n       * Fires when a cell value is changed via the editor.\n       * @event cellchange\n       * @memberof Datagrid\n       * @property {object} event The jquery event object\n       * @property {object} args Additional arguments\n       * @property {number} args.row An array of selected rows.\n       * @property {number} args.cell An array of selected rows.\n       * @property {HTMLElement} args.target The cell html element that was entered.\n       * @property {any} args.value The cell value.\n       * @property {any} args.oldValue The previous cell value.\n       * @property {object} args.column The column object\n       */\n      this.element.trigger('cellchange', args);\n      this.wasJustUpdated = true;\n    }\n  },\n\n  /**\n   * Function to check if given cell has true value for isDirty\n   * @private\n   * @param {number} row The row index\n   * @param {number} cell The cell index\n   * @returns {boolean} true if isDirty\n   */\n  isCellDirty(row, cell) {\n    return this.isDirtyCellNotUndefined(row, cell) ?\n      this.dirtyArray[row][cell].isDirty : false;\n  },\n\n  /**\n   * Set isDirty value and Add/Remove dirty icon to given cell\n   * must checked before to be true from `isDirtyCellNotUndefined(row, cell)`\n   * must checked before not undefined `cellNode`\n   * @private\n   * @param {number} row The row index\n   * @param {number} cell The cell index\n   * @param {object} cellNode jQuery cell node\n   * @returns {void}\n   */\n  setIsDirtyAndIcon(row, cell, cellNode) {\n    const d = this.dirtyArray[row][cell];\n    if ((d.originalVal === d.value) ||\n      (d.originalVal === d.coercedVal) ||\n      (d.originalVal === d.escapedCoercedVal) ||\n      (d.originalVal === d.cellNodeText)) {\n      this.dirtyArray[row][cell].isDirty = false;\n      cellNode[0].classList.remove('is-dirty-cell');\n    } else {\n      this.dirtyArray[row][cell].isDirty = true;\n      cellNode[0].classList.add('is-dirty-cell');\n    }\n  },\n\n  /**\n   * Function to check given cell is cache to dirtyArray\n   * @private\n   * @param {number} row The row index\n   * @param {number} cell The cell index\n   * @returns {boolean} true if found\n   */\n  isDirtyCellNotUndefined(row, cell) {\n    return (this.settings.showDirty &&\n      typeof row === 'number' &&\n      typeof cell === 'number' &&\n      row > -1 && cell > -1 &&\n      typeof this.dirtyArray !== 'undefined' &&\n      typeof this.dirtyArray[row] !== 'undefined' &&\n      typeof this.dirtyArray[row][cell] !== 'undefined');\n  },\n\n  /**\n   * For the row node get the index adjusting for paging / invisible rowsCache\n   * @private\n   * @param {number} row The row index\n   * @returns {number} The row index adjusted for paging/non visible rows.\n   */\n  visualRowIndex(row) {\n    const selector = 'tr:visible:not(.is-hidden, .datagrid-expandable-row)';\n    let idx = this.tableBody.find(selector).index(row);\n    if (idx === -1 && this.tableBodyLeft) {\n      idx = this.tableBodyLeft.find(selector).index(row);\n    }\n    if (idx === -1 && this.tableBodyRight) {\n      idx = this.tableBodyRight.find(selector).index(row);\n    }\n    return idx;\n  },\n\n  /**\n   * For the row index get the node adjusting for paging / invisible rowsCache\n   * @private\n   * @param {number} idx The row index\n   * @returns {object} The row node adjusted for paging/non visible rows.\n   */\n  visualRowNode(idx) {\n    let rowIdx = idx;\n\n    if (this.settings.paging && this.settings.source) {\n      rowIdx += ((this.pagerAPI.activePage - 1) * this.settings.pagesize);\n    }\n\n    if (!this.isRowVisible(idx)) {\n      return $([]);\n    }\n\n    return this.tableBody.find(`tr[aria-rowindex=\"${rowIdx + 1}\"]`);\n  },\n\n  /**\n   * For an internal row index, get the dataset row index\n   * @private\n   * @param {number} idx The row index\n   * @returns {object} The row index in the dataset.\n   */\n  actualRowNode(idx) {\n    return this.tableBody.find(`tr[aria-rowindex=\"${idx + 1}\"]`);\n  },\n\n  /**\n   * Returns the row dom jQuery node.\n   * @param  {number} row The row index.\n   * @returns {object} The dom jQuery node\n   */\n  rowNodes(row) {\n    if (row instanceof jQuery) {\n      row = row.attr('aria-rowindex') - 1;\n    }\n    const leftNodes = this.tableBodyLeft ? this.tableBodyLeft.find(`tr[aria-rowindex=\"${row + 1}\"]`) : $();\n    const centerNodes = this.tableBody.find(`tr[aria-rowindex=\"${row + 1}\"]`);\n    const rightNodes = this.tableBodyRight ? this.tableBodyRight.find(`tr[aria-rowindex=\"${row + 1}\"]`) : $();\n\n    return $(centerNodes)\n      .add(leftNodes)\n      .add(rightNodes);\n  },\n  /**\n   * Returns the cell dom node.\n   * @param  {number} row The row index.\n   * @param  {number} cell The cell index.\n   * @returns {object} The dom node\n   */\n  cellNode(row, cell) {\n    const cells = this.rowNodes(row).find('td');\n    return cells.eq(cell >= cells.length ? cells.length - 1 : cell);\n  },\n\n  /**\n   * For an internal row node, get the dataset row index.\n   * @private\n   * @param {number} row The row node.\n   * @returns {object} The row index in the dataset.\n   */\n  actualRowIndex(row) {\n    return row.attr('aria-rowindex') - 1;\n  },\n\n  /**\n   * For an internal row index, get row index across page number.\n   * This may or may not be the one in the dataset.\n   * @private\n   * @param {number} idx The row idx.\n   * @returns {object} The row index\n   */\n  pagingRowIndex(idx) {\n    let rowIdx = idx;\n\n    if (this.settings.paging && this.settings.source && !this.settings.indeterminate) {\n      rowIdx += ((this.pagerAPI.activePage - 1) * this.settings.pagesize);\n    }\n    return rowIdx;\n  },\n\n  /**\n   * For an internal row index, get row index across page number.\n   * This may or may not be the one in the dataset.\n   * @private\n   * @param {number} idx The row idx.\n   * @returns {object} The row index\n   */\n  actualPagingRowIndex(idx) {\n    let rowIdx = idx;\n\n    if (this.settings.paging && this.settings.source && !this.settings.indeterminate) {\n      rowIdx -= ((this.pagerAPI.activePage - 1) * this.settings.pagesize);\n    }\n    return rowIdx;\n  },\n\n  /**\n   * Return the data node for a row. This is the newer way of getting this info.\n   * @private\n   * @param {number} idx The row idx to find\n   * @returns {object} The row node\n   */\n  dataRowNode(idx) {\n    return this.tableBody.find(`tr[data-index=\"${idx}\"]`);\n  },\n\n  /**\n   * Return the data index for a row. This is the newer way of getting this info.\n   * @private\n   * @param {number} row The row idx\n   * @returns {number} The row index in the dataset.\n   */\n  dataRowIndex(row) {\n    return parseInt(row.attr('data-index'), 10);\n  },\n\n  /**\n   * Sets focus on a cell.\n   * @param  {number} row The row index\n   * @param  {number} cell The cell index\n   */\n  setActiveCell(row, cell) {\n    const self = this;\n    const prevCell = self.activeCell;\n    let rowElem = row;\n    let rowNum;\n    let rowIndex;\n    let dataRowNum;\n    let isGroupRow = row instanceof jQuery && row.is('.datagrid-rowgroup-header, .datagrid-rowgroup-footer');\n\n    if (row instanceof jQuery && row.length === 0) {\n      return;\n    }\n\n    if (typeof row === 'number') {\n      rowNum = row;\n      rowElem = this.tableBody.find('tr:visible').eq(row);\n      rowIndex = this.actualRowIndex(rowElem);\n      dataRowNum = this.dataRowIndex(rowElem);\n    }\n\n    // Support passing the td in to focus that cell\n    if (row instanceof jQuery && row.is('td')) {\n      isGroupRow = row.parent().is('.datagrid-rowgroup-header, .datagrid-rowgroup-footer');\n      if (isGroupRow) {\n        rowElem = row.parent();\n      }\n      cell = row.attr('aria-colindex') - 1;\n      rowNum = this.visualRowIndex(row.parent());\n      rowIndex = this.actualRowIndex(row.parent());\n      dataRowNum = this.dataRowIndex(row.parent());\n      rowElem = row.parent();\n    }\n\n    if (row instanceof jQuery && row.is('tr')) {\n      rowNum = this.visualRowIndex(row);\n      rowIndex = this.actualRowIndex(row);\n      dataRowNum = this.dataRowIndex(row);\n      rowElem = row;\n    }\n\n    if (rowNum < 0 || cell < 0) {\n      return;\n    }\n\n    // Remove previous tab index\n    if (prevCell.node && prevCell.node.length === 1) {\n      self.activeCell.node\n        .removeAttr('tabindex')\n        .removeClass('is-active');\n    }\n\n    // Hide any cell tooltips (Primarily for validation)\n    if (prevCell.cell !== cell || prevCell.row !== row) {\n      self.hideTooltip();\n    }\n\n    // Find the cell if it exists\n    self.activeCell.node = self.cellNode((isGroupRow || rowElem ? rowElem : (rowIndex > -1 ? rowIndex : rowNum)), cell).attr('tabindex', '0');\n\n    if (self.activeCell.node && prevCell.node.length === 1) {\n      self.activeCell.row = rowNum;\n      self.activeCell.cell = cell;\n      rowIndex = this.actualRowIndex(self.activeCell.node.parent());\n      dataRowNum = this.dataRowIndex(self.activeCell.node.parent());\n    } else {\n      self.activeCell = prevCell;\n    }\n\n    if (!$('input, button:not(.btn-secondary, .row-btn, .datagrid-expand-btn, .datagrid-drilldown, .btn-icon)', self.activeCell.node).length) {\n      self.activeCell.node.focus();\n      if (isGroupRow) {\n        self.activeCell.groupNode = self.activeCell.node;\n      }\n    }\n    if (self.activeCell.node.hasClass('is-focusable')) {\n      self.activeCell.node.find('button').focus();\n    }\n\n    if (dataRowNum !== undefined) {\n      self.activeCell.dataRow = dataRowNum;\n    }\n\n    if (rowIndex !== undefined) {\n      self.activeCell.rowIndex = rowIndex;\n    }\n\n    const colSpan = +rowElem.find('td[colspan]').attr('colspan');\n\n    if (isGroupRow && self.activeCell.node && prevCell.node && !(row instanceof jQuery && row.is('td'))) {\n      if (cell < colSpan) {\n        rowElem.find('td[colspan]').attr('tabindex', '0').focus();\n        self.activeCell.groupNode = rowElem.find('td[colspan]');\n      } else if (cell >= colSpan) {\n        rowElem.find('td').eq((cell - colSpan) + 1).attr('tabindex', '0').focus();\n        self.activeCell.groupNode = rowElem.find('td').eq((cell - colSpan) + 1);\n      } else {\n        rowElem.find('td').eq(cell).attr('tabindex', '0').focus();\n        self.activeCell.groupNode = rowElem.find('td').eq(cell);\n      }\n    }\n\n    if (isGroupRow && row instanceof jQuery && row.is('td')) {\n      self.activeCell.cell = (colSpan - 1) + cell;\n      if (row.is('[colspan]')) {\n        self.activeCell.cell = cell;\n      }\n    }\n\n    if (this.settings.cellNavigation) {\n      const headers = self.headerNodes();\n      let prevSpans = 0;\n\n      // Check if any previous rows are spanned\n      if (this.hasColSpans) {\n        prevSpans = 0;\n\n        headers.eq(cell).prevAll('[colspan]').each((i, elem) => {\n          const span = $(elem).attr('colspan') - 1;\n          prevSpans += span;\n        });\n\n        cell -= prevSpans;\n      }\n\n      headers.removeClass('is-active');\n      headers.eq(cell).addClass('is-active');\n    }\n    this.activeCell.isFocused = true;\n\n    // Expand On Activate Feature\n    const col = this.settings.columns[cell];\n    if (col && col.expandOnActivate && this.activeCell && this.activeCell.node) {\n      self.activeCell.node.addClass('is-active');\n    }\n\n    self.syncBodyScroll(self.activeCell.node);\n\n    /**\n    * Fires when a cell is focued.\n    * @event activecellchange\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {HTMLElement} args.node  The cell element that was entered.\n    * @property {number} args.cell The selected cell\n    * @property {number} args.row The selected row\n    */\n    self.element.trigger('activecellchange', [{ node: this.activeCell.node, row: this.activeCell.row, cell: this.activeCell.cell }]);\n  },\n\n  /**\n   * Sets focus to the next active cell, depending on a key.\n   * @private\n   * @param {object} e The event object\n   */\n  setNextActiveCell(e) {\n    const self = this;\n    if (e.type === 'keydown') {\n      if (this.settings.actionableMode) {\n        const keyCode = (e.keyCode === 13) ? 40 : e.keyCode;\n        setTimeout(() => {\n          const evt = $.Event('keydown.datagrid');\n          evt.keyCode = keyCode;\n\n          self.activeCell.node.trigger(evt);\n        }, 0);\n      } else {\n        this.setActiveCell(this.activeCell.row, this.activeCell.cell);\n      }\n    }\n  },\n\n  /**\n   * Add children to treegrid dataset\n   * @private\n   * @param {object} parent The parent object\n   * @param {object} data The data for the child\n   */\n  addChildren(parent, data) {\n    if (!data || (data && !data.length) || parent < 0) {\n      return;\n    }\n    const node = this.settings.treeDepth[parent].node;\n    node.children = node.children || [];\n\n    // Make sure it's not reference pointer to data object, make copy of data\n    data = JSON.parse(JSON.stringify(data));\n\n    for (let i = 0, len = data.length; i < len; i++) {\n      node.children.push(data[i]);\n    }\n    this.updateDataset(this.settings.dataset);\n  },\n\n  /**\n   * Set the expanded property in the dataset\n   * @private\n   * @param {number} dataRowIndex The index in the dataset.\n   * @param {boolean} isExpanded Expanded value to set.\n   */\n  setExpandedInDataset(dataRowIndex, isExpanded) {\n    this.settings.treeDepth[dataRowIndex].node.expanded = isExpanded;\n  },\n\n  /**\n   * Expand the tree children\n   * @private\n   * @param {object} e The event data from the click or keyboard event.\n   * @param {number} dataRowIndex Index in the dataset\n   */\n  toggleChildren(e, dataRowIndex) {\n    if (this.settings.groupable) {\n      return;\n    }\n    const self = this;\n    let rowElement = this.settings.treeGrid ?\n      this.actualRowNode(dataRowIndex) : this.visualRowNode(dataRowIndex);\n    let expandButton = rowElement.find('.datagrid-expand-btn');\n    const level = parseInt(rowElement.attr('aria-level'), 10);\n    let children = rowElement.nextUntil(`[aria-level=\"${level}\"]`);\n    const isExpanded = expandButton.hasClass('is-expanded');\n    const args = [{ grid: self, row: dataRowIndex, item: rowElement, children }];\n\n    if (self.settings.treeDepth && self.settings.treeDepth[dataRowIndex]) {\n      args[0].rowData = self.settings.treeDepth[dataRowIndex].node;\n    }\n\n    if (!rowElement.hasClass('datagrid-tree-parent') ||\n        (!$(e.target).is(expandButton) &&\n          (self.settings.editable || self.settings.selectable))) {\n      return;\n    }\n\n    const toggleExpanded = function () {\n      rowElement = self.settings.treeGrid ?\n        self.actualRowNode(dataRowIndex) : self.visualRowNode(dataRowIndex);\n      expandButton = rowElement.find('.datagrid-expand-btn');\n      children = rowElement.nextUntil(`[aria-level=\"${level}\"]`);\n\n      if (isExpanded) {\n        rowElement.attr('aria-expanded', false);\n        expandButton.removeClass('is-expanded')\n          .find('.plus-minus').removeClass('active');\n      } else {\n        rowElement.attr('aria-expanded', true);\n        expandButton.addClass('is-expanded')\n          .find('.plus-minus').addClass('active');\n      }\n      self.setExpandedInDataset(dataRowIndex, !isExpanded);\n\n      const setChildren = function (elem, lev, expanded) {\n        const nodes = elem.nextUntil(`[aria-level=\"${level}\"]`);\n\n        if (expanded) {\n          nodes.each(function () {\n            const node = $(this);\n            const nodeLevel = parseInt(node.attr('aria-level'), 10);\n            if (nodeLevel > lev) {\n              node.addClass('is-hidden');\n            }\n          });\n        } else {\n          nodes.each(function () {\n            const node = $(this);\n            const nodeLevel = parseInt(node.attr('aria-level'), 10);\n\n            if (nodeLevel === (lev + 1)) {\n              if (!node.hasClass('is-filtered')) {\n                node.removeClass('is-hidden');\n              }\n\n              if (node.is('.datagrid-tree-parent')) {\n                const nodeIsExpanded = node.find('.datagrid-expand-btn.is-expanded').length > 0;\n                if (nodeIsExpanded) {\n                  setChildren(node, nodeLevel, !nodeIsExpanded);\n                }\n              }\n            }\n          });\n        }\n      };\n\n      setChildren(rowElement, level, isExpanded);\n      self.setAlternateRowShading();\n    };\n\n    /**\n    * Fires when a row is collapsed to show its detail.\n    * @event collapserow\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {object} args.self The grid api.\n    * @property {number} args.row The selected row index\n    * @property {object} args.item The selected row data.\n    * @property {array} args.children The selected rows children (tree grid)\n    */\n\n    /**\n    * Fires when a row is expanded to show its detail.\n    * @event expandrow\n    * @memberof Datagrid\n    * @property {object} event The jquery event object\n    * @property {object} args Additional arguments\n    * @property {object} args.self The grid api.\n    * @property {number} args.row The selected row index\n    * @property {object} args.item The selected row data.\n    * @property {array} args.children The selected rows children (tree grid)\n    */\n    $.when(self.element.triggerHandler(isExpanded ? 'collapserow' : 'expandrow', args)).done(() => {\n      toggleExpanded();\n    });\n  },\n\n  /**\n   * Expand Detail Row Or Tree Row\n   * @param  {number} dataRowIndex The row to toggle\n   * @returns {void}\n   */\n  toggleRowDetail(dataRowIndex) {\n    const self = this;\n    let rowElement = self.rowNodes(dataRowIndex);\n    if (!rowElement.length && self.settings.paging &&\n      (self.settings.rowTemplate || self.settings.expandableRow)) {\n      dataRowIndex += ((self.pagerAPI.activePage - 1) * self.settings.pagesize);\n      rowElement = self.dataRowNode(dataRowIndex);\n    }\n    const expandRow = rowElement.next();\n    const expandButton = rowElement.find('.datagrid-expand-btn');\n    const detail = expandRow.find('.datagrid-row-detail');\n    const item = self.settings.dataset[self.dataRowIndex(rowElement)];\n\n    if (rowElement.hasClass('datagrid-tree-parent')) {\n      return;\n    }\n\n    if (self.settings.allowOneExpandedRow && self.settings.groupable === null) {\n      // collapse any other expandable rows\n      const prevExpandRow = self.tableBody.find('tr.is-expanded');\n      const prevExpandButton = prevExpandRow.prev().find('.datagrid-expand-btn');\n      const parentRow = prevExpandRow.prev();\n      const parentRowIdx = self.actualRowNode(parentRow);\n      const parentdataRowIdx = self.dataRowIndex(parentRow);\n\n      if (prevExpandRow.length && expandRow.index() !== prevExpandRow.index()) {\n        const prevDetail = prevExpandRow.find('.datagrid-row-detail');\n\n        prevExpandRow.add(prevExpandButton).removeClass('is-expanded');\n        parentRow.removeClass('is-rowactivated');\n        parentRow.find('.plus-minus').removeClass('active');\n        prevDetail.animateClosed().on('animateclosedcomplete', () => {\n          prevExpandRow.removeClass('is-expanded');\n          self.element.triggerHandler('collapserow', [{ grid: self, row: parentRowIdx, detail: prevDetail, item: self.settings.dataset[parentdataRowIdx] }]);\n        });\n\n        const prevActionBtn = prevExpandRow.prev().find('.btn-primary');\n        if (prevActionBtn.length) {\n          prevActionBtn.attr('class', prevActionBtn.attr('class').replace('btn-primary', 'btn-secondary'));\n        }\n      }\n\n      // Toggle the button to make it primary\n      const isExpanded = !expandRow.hasClass('is-expanded');\n      const actionButton = expandRow.prev().find(isExpanded ? '.btn-secondary' : '.btn-primary');\n\n      if (actionButton.length > 0 && parentRow && actionButton) {\n        const currentClass = actionButton.attr('class') || '';\n\n        actionButton.attr('class', currentClass.replace(\n          isExpanded ? 'btn-secondary' : 'btn-primary',\n          isExpanded ? 'btn-primary' : 'btn-secondary'\n        ));\n      }\n    }\n\n    if (expandRow.hasClass('is-expanded')) {\n      // expandRow.removeClass('is-expanded');\n      detail.one('animateclosedcomplete', () => {\n        expandRow.removeClass('is-expanded');\n      }).animateClosed();\n\n      expandButton.removeClass('is-expanded')\n        .find('.plus-minus').removeClass('active');\n\n      if (self.settings.allowOneExpandedRow) {\n        rowElement.removeClass('is-rowactivated');\n      }\n\n      // detail.animateClosed();\n      self.element.triggerHandler('collapserow', [{ grid: self, row: dataRowIndex, detail, item }]);\n    } else {\n      expandRow.addClass('is-expanded');\n      expandButton.addClass('is-expanded')\n        .find('.plus-minus').addClass('active');\n\n      // Optionally Contstrain the width\n      expandRow.find('.constrained-width').css('max-width', this.element.outerWidth());\n\n      const eventData = [{ grid: self, row: dataRowIndex, detail, item }];\n      self.element.triggerHandler('expandrow', eventData);\n\n      if (self.settings.allowOneExpandedRow) {\n        rowElement.addClass('is-rowactivated');\n      }\n\n      if (self.settings.onExpandRow) {\n        const response = function (markup) {\n          if (markup) {\n            detail.find('.datagrid-row-detail-padding').empty().append(markup);\n          }\n          detail.animateOpen();\n        };\n\n        self.settings.onExpandRow(eventData[0], response);\n      } else {\n        detail.animateOpen();\n      }\n    }\n  },\n\n  /**\n   * Expand the grouped row children\n   * @private\n   * @param {object} rowElement The row DOM element\n   */\n  toggleGroupChildren(rowElement) {\n    if (!this.settings.groupable) {\n      return;\n    }\n\n    const self = this;\n    const rowIdx = rowElement.index();\n    let childrenLeft = $();\n    let children = $();\n    let childrenRight = $();\n\n    if (this.hasLeftPane) {\n      childrenLeft = this.tableLeft.find('tr').eq(rowIdx).nextUntil('.datagrid-rowgroup-header');\n    }\n    children = this.table.find('tr').eq(rowIdx).nextUntil('.datagrid-rowgroup-header');\n    if (this.hasRightPane) {\n      childrenRight = this.tableRight.find('tr').eq(rowIdx).nextUntil('.datagrid-rowgroup-header');\n    }\n    const expandButton = rowElement.find('.datagrid-expand-btn');\n\n    if (rowElement.hasClass('is-expanded')) {\n      expandButton.removeClass('is-expanded')\n        .find('.plus-minus').removeClass('active');\n\n      childrenLeft.hide();\n      childrenLeft.addClass('is-hidden');\n      children.hide();\n      children.addClass('is-hidden');\n      childrenRight.hide();\n      childrenRight.addClass('is-hidden');\n      self.element.triggerHandler('collapserow', [{ grid: self, row: rowElement.index(), detail: children, item: {} }]);\n\n      rowElement.removeClass('is-expanded');\n    } else {\n      expandButton.addClass('is-expanded')\n        .find('.plus-minus').addClass('active');\n\n      childrenLeft.show();\n      childrenLeft.removeClass('is-hidden');\n      children.show();\n      children.removeClass('is-hidden');\n      childrenRight.show();\n      childrenRight.removeClass('is-hidden');\n      self.element.triggerHandler('expandrow', [{ grid: self, row: rowElement.index(), detail: children, item: {} }]);\n\n      rowElement.addClass('is-expanded');\n    }\n  },\n\n  /**\n   * Set the current datagrid sort column\n   * @param {string} id The column id\n   * @param {boolean} ascending Set the sort in ascending or descending order\n   */\n  setSortColumn(id, ascending) {\n    // Set Direction based on if passed in or toggling existing field\n    if (ascending !== undefined) {\n      this.sortColumn.sortAsc = ascending;\n    } else {\n      if (this.sortColumn.sortId === id) {\n        this.sortColumn.sortAsc = !this.sortColumn.sortAsc;\n      } else {\n        this.sortColumn.sortAsc = true;\n      }\n      ascending = this.sortColumn.sortAsc;\n    }\n\n    this.sortColumn.sortId = id;\n    this.sortColumn.sortField = (this.columnById(id)[0] ? this.columnById(id)[0].field : id);\n    this.sortColumn.sortAsc = ascending;\n\n    // Do Sort on Data Set\n    this.setSortIndicator(id, ascending);\n    this.sortDataset();\n\n    if (!this.settings.focusAfterSort && this.activeCell && this.activeCell.isFocused) {\n      this.activeCell.isFocused = false;\n    }\n\n    const wasFocused = this.activeCell.isFocused;\n    this.setTreeDepth();\n    this.setRowGrouping();\n    this.setTreeRootNodes();\n    this.renderRows();\n    // Update selected and Sync header checkbox\n    this.syncSelectedUI();\n\n    if (wasFocused && this.activeCell.node.length === 1) {\n      this.setActiveCell(this.activeCell.row, this.activeCell.cell);\n    }\n\n    this.resetPager('sorted');\n    this.tableBody.removeClass('is-loading');\n    this.saveUserSettings();\n    this.validateAll();\n    this.element.trigger('sorted', [this.sortColumn]);\n  },\n\n  /**\n   * Sort the currently attached dataset.\n   * @private\n   */\n  sortDataset() {\n    if (this.settings.disableClientSort) {\n      this.restoreSortOrder = true;\n      return;\n    }\n\n    if (this.originalDataset) {\n      this.settings.dataset = this.originalDataset;\n    }\n    const sort = this.sortFunction(this.sortColumn.sortId, this.sortColumn.sortAsc);\n\n    this.setDirtyBeforeSort();\n    this.settings.dataset.sort(sort);\n    this.setTreeDepth();\n    this.setDirtyAfterSort();\n\n    // Resync the _selectedRows array\n    if (this.settings.selectable) {\n      this.syncDatasetWithSelectedRows();\n    }\n  },\n\n  /**\n  * Set current data to sync up dirtyArray before sort\n  * @private\n  * @returns {void}\n  */\n  setDirtyBeforeSort() {\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    if (s.showDirty && !this.settings.source && this.dirtyArray && this.dirtyArray.length) {\n      for (let i = 0, l = dataset.length; i < l; i++) {\n        if (typeof this.dirtyArray[i] !== 'undefined') {\n          const node = s.treeGrid ? dataset[i].node : dataset[i];\n          node.tempNodeIndex = i;\n        }\n      }\n    }\n  },\n\n  /**\n  * Set current data to sync up dirtyArray after sort\n  * @private\n  * @returns {void}\n  */\n  setDirtyAfterSort() {\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    if (s.showDirty && this.dirtyArray && this.dirtyArray.length) {\n      const changes = [];\n      for (let i = 0, l = dataset.length; i < l; i++) {\n        const node = s.treeGrid ? dataset[i].node : dataset[i];\n        if (typeof node.tempNodeIndex !== 'undefined') {\n          changes.push({ newIdx: i, oldIdx: node.tempNodeIndex });\n          delete node.tempNodeIndex;\n        }\n      }\n      const newDirtyArray = [];\n      for (let i = 0, l = changes.length; i < l; i++) {\n        newDirtyArray[changes[i].newIdx] = this.dirtyArray[changes[i].oldIdx];\n      }\n      this.dirtyArray = newDirtyArray;\n    }\n  },\n\n  /**\n  * Sync the dataset._selected elements with the _selectedRows array\n  * @private\n  */\n  syncDatasetWithSelectedRows() {\n    this._selectedRows = [];\n    const s = this.settings;\n    const dataset = s.treeGrid ? s.treeDepth : s.dataset;\n    let idx = -1;\n\n    for (let i = 0, data; i < dataset.length; i++) {\n      if (s.groupable) {\n        for (let k = 0; k < dataset[i].values.length; k++) {\n          idx++;\n          data = dataset[i].values[k];\n          if (this.isRowSelected(data)) {\n            this._selectedRows.push({\n              idx,\n              data,\n              elem: this.dataRowNode(idx),\n              group: dataset[i],\n              page: this.pagerAPI ? this.pagerAPI.activePage : 1,\n              pagingIdx: idx,\n              pagesize: this.settings.pagesize\n            });\n          }\n        }\n      } else {\n        data = s.treeGrid ? dataset[i].node : dataset[i];\n        if (this.isRowSelected(data)) {\n          this._selectedRows.push({\n            idx: i,\n            data,\n            elem: this.visualRowNode(i),\n            pagesize: this.settings.pagesize,\n            page: this.pagerAPI ? this.pagerAPI.activePage : 1,\n            pagingIdx: idx\n          });\n        }\n      }\n    }\n  },\n\n  /**\n   * Sort the ui sort indicator on the column.\n   * @private\n   * @param {string} id The column id\n   * @param {boolean} ascending Set the sort in ascending or descending order\n   */\n  setSortIndicator(id, ascending) {\n    if (!this.headerRow) {\n      return;\n    }\n\n    // Set Visual Indicator\n    this.headerContainer.find('.is-sorted-asc, .is-sorted-desc')\n      .removeClass('is-sorted-asc is-sorted-desc')\n      .attr('aria-sort', 'none');\n    this.headerContainer.find(`[data-column-id=\"${id}\"]`)\n      .addClass(ascending ? 'is-sorted-asc' : 'is-sorted-desc')\n      .attr('aria-sort', ascending ? 'ascending' : 'descending');\n  },\n\n  /**\n  * Overridable function to conduct array sorting\n  * @param {string} id The matching field/id in the array to sort on\n  * @param {boolean} ascending Determines direction of the sort.\n  * @returns {boolean} If found.\n  */\n  sortFunction(id, ascending) {\n    const column = this.columnById(id);\n    // Assume the field and id match if no column found\n    const field = column.length === 0 ? id : column[0].field;\n\n    const self = this;\n    const primer = function (a) {\n      a = (a === undefined || a === null ? '' : a);\n\n      if (typeof a === 'string') {\n        a = a.toUpperCase();\n\n        if ($.isNumeric(a)) {\n          a = parseFloat(a);\n        }\n      }\n      return a;\n    };\n\n    const key = function (x) { return primer(self.fieldValue(x, field)); };\n\n    ascending = !ascending ? -1 : 1;\n\n    return function (a, b) {\n      a = key(a);\n      b = key(b);\n\n      if (typeof a !== typeof b) {\n        a = a.toString().toLowerCase();\n        b = b.toString().toLowerCase();\n      }\n\n      return ascending * ((a > b) - (b > a));\n    };\n  },\n\n  /**\n  * Determine equality for two deeply nested JavaScript objects.\n  * @private\n  * @param {object} obj1 First object to compare\n  * @param {object} obj2 Second object to compare\n  * @returns {boolean} If it is equal or not\n  */\n  isEquivalent(obj1, obj2) {\n    function _equals(a, b) {\n      return JSON.stringify(a) === JSON.stringify($.extend(true, {}, a, b));\n    }\n    return _equals(obj1, obj2) && _equals(obj2, obj1);\n  },\n\n  /**\n   * The default formatter to use (just plain text). When no formatter is specified.\n   * @param  {number} row The rowindex\n   * @param  {number} cell The cell index\n   * @param  {any} value The data value\n   * @returns {string} The html string\n   */\n  defaultFormatter(row, cell, value) {\n    return ((value === null || value === undefined || value === '') ? '' : value.toString());\n  },\n\n  /**\n  * Add the pager and paging functionality.\n  * @private\n  */\n  handlePaging() {\n    if (!this.settings.paging) {\n      return;\n    }\n\n    this.element.addClass('paginated');\n    this.tableBody.pager({\n      componentAPI: this,\n      dataset: this.settings.dataset,\n      hideOnOnePage: this.settings.hidePagerOnOnePage,\n      source: this.settings.source,\n      pagesize: this.settings.pagesize,\n      indeterminate: this.settings.indeterminate,\n      rowTemplate: this.settings.rowTemplate,\n      pagesizes: this.settings.pagesizes,\n      showPageSizeSelector: this.settings.showPageSizeSelector,\n      activePage: this.restoreActivePage ? parseInt(this.savedActivePage, 10) : 1\n    });\n\n    if (this.restoreActivePage) {\n      this.savedActivePage = null;\n      this.restoreActivePage = false;\n    }\n  },\n\n  /**\n  * Add the pager and paging functionality.\n  * @param {string} pagingInfo The paging object with activePage ect used by pager.js\n  * @param {boolean} isResponse Internal flag used to prevent callbacks from rexecuting.\n  * @param {function} callback The callback function.\n  */\n  renderPager(pagingInfo, isResponse, callback) {\n    if (!this.pagerAPI) {\n      return;\n    }\n\n    if (!this.settings.source) {\n      this.pagerAPI.settings.dataset = this.settings.dataset;\n      pagingInfo.isFilteredClientside = true;\n    }\n\n    this.pagerAPI.updatePagingInfo(pagingInfo, isResponse);\n\n    if (!isResponse) {\n      this.triggerSource(pagingInfo, callback);\n    }\n\n    // Update selected and Sync header checkbox\n    this.syncSelectedUI();\n  },\n\n  /**\n  * Reset the pager to the first page.\n  * @private\n  * @param {string} type The action type, which gets sent to the source callback.\n  * @param {string} trigger The triggering action\n  */\n  resetPager(type, trigger) {\n    if (!this.pagerAPI) {\n      return;\n    }\n\n    this.pagerAPI.reset(type, trigger);\n  },\n\n  /**\n   * Reliably gets all the pre-rendered elements in the container and returns them for use.\n   * @private\n   * @returns {array} TThe pagable items\n   */\n  getPageableElements() {\n    let elements = this.element.children().not('.datagrid-expandable-row');\n    if (elements.is('table')) {\n      elements = elements.find('tr');\n    }\n    return elements;\n  },\n\n  /**\n  * Add grid tooltip to the page.\n  * @private\n  * @param {string} extraClass class to add to target uniqueness\n  * @returns {void}\n  */\n  appendTooltip(extraClass) {\n    const defaultClass = 'grid-tooltip';\n    const regExp = new RegExp(`\\\\b${defaultClass}\\\\b`, 'g');\n\n    // Set default css class\n    if (typeof extraClass === 'string') {\n      if (!regExp.test(extraClass)) {\n        extraClass += ` ${defaultClass}`;\n      }\n    } else {\n      extraClass = defaultClass;\n    }\n\n    // Unique id for tooltip\n    const tooltipId = this.uniqueId('tooltip');\n    this.tooltip = document.getElementById(tooltipId);\n\n    if (!this.tooltip) {\n      const tooltip = '' +\n        `<div id=\"${tooltipId}\" class=\"tooltip ${extraClass} is-hidden\">\n          <div class=\"arrow\"></div>\n          <div class=\"tooltip-content\"></div>\n        </div>`;\n      document.body.insertAdjacentHTML('beforeend', tooltip);\n\n      this.tooltip = document.getElementById(tooltipId);\n\n      if (this.isTouch) {\n        this.tooltip.style.pointerEvents = 'auto';\n        $(this.tooltip).on('touchend.gridtooltip', () => {\n          this.hideTooltip();\n        });\n      }\n    }\n  },\n\n  /**\n   * Cache tooltip content so it can use for more then once\n   * @private\n   * @param  {object} elem The element to be cached.\n   * @param  {object} tooltip Optional to cache given data.\n   * @returns {object} tooltip object.\n   */\n  cacheTooltip(elem, tooltip) {\n    if (typeof tooltip === 'undefined') {\n      const contentTooltip = elem.querySelector('.is-editor.content-tooltip');\n      const aTitle = elem.querySelector('a[title]');\n      const isRowstatus = utils.hasClass(elem, 'rowstatus-cell');\n      const isSvg = elem.tagName.toLowerCase() === 'svg';\n      const isTh = elem.tagName.toLowerCase() === 'th';\n      const isHeaderColumn = utils.hasClass(elem, 'datagrid-column-wrapper');\n      const isHeaderFilter = utils.hasClass(elem.parentNode, 'datagrid-filter-wrapper');\n      const cell = elem.getAttribute('aria-colindex') - 1;\n      const col = this.columnSettings(cell);\n      let title;\n\n      tooltip = { content: '', wrapper: elem.querySelector('.datagrid-cell-wrapper') };\n\n      if (isTh || isHeaderColumn || isHeaderFilter) {\n        tooltip.wrapper = elem;\n        tooltip.distance = isHeaderFilter ? 15 : null;\n        tooltip.placement = isHeaderColumn ? 'top' : 'bottom';\n      }\n\n      // Cache rowStatus cell\n      if (isRowstatus || isSvg) {\n        const rowNode = this.closest(elem, el => utils.hasClass(el, 'datagrid-row'));\n        const classList = rowNode ? rowNode.classList : [];\n        tooltip.isError = classList.contains('rowstatus-row-error');\n        tooltip.placement = 'right';\n\n        // For nonVisibleCellErrors\n        if (isSvg) {\n          tooltip.wrapper = this.closest(elem, el => el.tagName.toLowerCase() === 'td');\n        }\n      }\n\n      if (contentTooltip) {\n        // Used with rich text editor\n        const width = col.editorOptions &&\n          col.editorOptions.width ? this.setUnit(col.editorOptions.width) : false;\n\n        // Width for tooltip can be come from column options\n        contentTooltip.style.width = width || `${elem.offsetWidth}px`;\n        const wrapperHTML = tooltip.wrapper.innerHTML;\n\n        if (xssUtils.stripHTML(wrapperHTML) !== '') {\n          tooltip.content = wrapperHTML;\n          tooltip.extraClassList = ['popover', 'alternate', 'content-tooltip'];\n        }\n      } else if (aTitle) {\n        // Title attribute on links `a`\n        tooltip.content = aTitle.getAttribute('title');\n        aTitle.removeAttribute('title');\n      } else {\n        title = elem.getAttribute('title');\n        if (title) {\n          // Title attribute on current element\n          tooltip.content = title;\n          elem.removeAttribute('title');\n        } else if (isTh && !isHeaderFilter) {\n          const targetEl = elem.querySelector('.datagrid-header-text');\n          tooltip.content = targetEl ? xssUtils.stripHTML(targetEl.textContent) : '';\n        } else if (isHeaderFilter) {\n          // Disabled filterable headers\n          const filterDisabled = elem.parentNode.querySelectorAll('.dropdown.is-disabled, input[type=\"text\"][disabled], .btn-filter[disabled]').length > 0;\n          if (!filterDisabled) {\n            const targetEl = elem.parentNode.querySelector('.is-checked');\n            tooltip.content = targetEl ? xssUtils.stripHTML(targetEl.textContent) : '';\n          }\n        } else {\n          // Default use wrapper content\n          tooltip.content = xssUtils.stripHTML(tooltip.wrapper.textContent);\n        }\n      }\n\n      // Clean up text in selects\n      const select = tooltip.wrapper.querySelector('select');\n      if (select && select.selectedIndex\n        && select.options[select.selectedIndex]\n        && select.options[select.selectedIndex].innerHTML) {\n        tooltip.content = env.features.touch ? '' : select.options[select.selectedIndex].innerHTML.trim();\n      }\n\n      if (isTh) {\n        tooltip.content = tooltip.content.trim();\n      }\n\n      if (tooltip.content !== '') {\n        const isEllipsis = utils.hasClass((isHeaderColumn ? elem.parentNode : elem), 'text-ellipsis');\n        const icons = [].slice.call(elem.querySelectorAll('.icon'));\n        let extraWidth = isEllipsis ? 8 : 0;\n        icons.forEach((icon) => {\n          extraWidth += icon.getBBox().width + 8;\n        });\n        if (isEllipsis && isHeaderColumn) {\n          const textEl = elem.querySelector('.datagrid-header-text');\n          tooltip.textwidth = textEl.scrollWidth + (select ? 0 : extraWidth);\n        } else {\n          tooltip.textwidth = stringUtils.textWidth(tooltip.content) + (select ? 0 : extraWidth);\n        }\n\n        if (isTh) {\n          tooltip.textwidth = stringUtils.textWidth(tooltip.content);\n        }\n\n        tooltip.content = contentTooltip ? tooltip.content : `<p>${tooltip.content}</p>`;\n        if (title || isHeaderFilter) {\n          tooltip.forced = true;\n        }\n      }\n\n      if (typeof col.tooltip === 'function') {\n        const rowNode = this.closest(elem, el => utils.hasClass(el, 'datagrid-row'));\n        const rowIdx = rowNode.getAttribute('data-index');\n        const value = this.fieldValue(this.settings.dataset[rowIdx], col.field);\n        tooltip.content = col.tooltip(cell, value);\n        tooltip.textwidth = stringUtils.textWidth(tooltip.content) + 20;\n      }\n    }\n\n    elem = elem instanceof jQuery ? elem : $(elem);\n    elem.data('gridtooltip', tooltip);\n    return tooltip;\n  },\n\n  /**\n   * Show Tooltip\n   * @private\n   * @param  {object} [options] for tooltip.\n   * @param  {string} [options.content] The tooltip contents.\n   * @param  {object} [options.wrapper] The parent DOM element.\n   * @param  {boolean} [options.isError] True for if is error color.\n   * @param  {string} [options.placement] 'top'|'right'|'bottom'|'left'.\n   * @param  {array} [options.extraClassList] list of css classes to be added to tooltip.\n   * @returns {void}\n   */\n  showTooltip(options) {\n    if (this.tooltip) {\n      const tooltip = $(this.tooltip);\n      const tooltipContentEl = this.tooltip.querySelector('.tooltip-content');\n      if (tooltipContentEl) {\n        tooltipContentEl.innerHTML = options.content;\n        this.tooltip.classList.remove('is-hidden', 'top', 'right', 'bottom', 'left');\n        this.tooltip.style.display = '';\n        this.tooltip.classList.add(options.placement || 'top');\n\n        if (options.isError) {\n          this.tooltip.classList.add('is-error');\n        }\n        if (options.extraClassList) {\n          options.extraClassList.map(className => this.tooltip.classList.add(className));\n        }\n\n        const distance = typeof options.distance === 'number' ? options.distance : 10;\n        const placeOptions = {\n          x: 0,\n          y: distance,\n          container: this.element.closest('.page-container.scrollable') || $('body'),\n          containerOffsetX: options.wrapper.offsetLeft,\n          containerOffsetY: options.wrapper.offsetTop,\n          parent: $(options.wrapper),\n          placement: options.placement || 'top',\n          strategies: ['flip', 'nudge']\n        };\n        if (placeOptions.placement === 'left' || placeOptions.placement === 'right') {\n          placeOptions.x = distance;\n          placeOptions.y = 0;\n        }\n\n        // If not already have place instance\n        if (!tooltip.data('place')) {\n          tooltip.place(placeOptions);\n        }\n\n        // Apply place\n        tooltip.data('place').place(placeOptions);\n\n        // Flag to mark as gridtooltip\n        tooltip.data('gridtooltip', true);\n\n        tooltip\n          .one('afterplace.gridtooltip', (e, placementObj) => {\n            this.handleAfterPlaceTooltip(e, placementObj);\n          })\n          .on('click.gridtooltip', () => {\n            this.hideTooltip();\n          });\n\n        // Hide the tooltip when the page scrolls.\n        $('body, .scrollable').off('scroll.gridtooltip').on('scroll.gridtooltip', () => {\n          this.hideTooltip();\n        });\n      }\n    }\n  },\n\n  /**\n   * Placement behavior's \"afterplace\" handler.\n   * @private\n   * @param {jquery.event} e custom `afterPlace` event\n   * @param {placementobject} placementObj object containing placement settings\n   * @returns {void}\n   */\n  handleAfterPlaceTooltip(e, placementObj) {\n    const tooltip = $('#tooltip');\n    if (tooltip[0]) {\n      tooltip.data('place').setArrowPosition(e, placementObj, tooltip);\n      tooltip.triggerHandler('tooltipafterplace', [placementObj]);\n    }\n  },\n\n  /**\n   * Hide the visible tooltip.\n   * @private\n   * @returns {void}\n   */\n  hideTooltip() {\n    if (this.tooltip) {\n      this.removeTooltipData(this.tooltip); // Remove flag as gridtooltip\n      this.tooltip.classList.add('is-hidden');\n      this.tooltip.classList.remove('is-error', 'popover', 'alternate', 'content-tooltip');\n      this.tooltip.style.left = '-999px';\n    }\n\n    // Remove scroll events\n    $('body, .scrollable').off('scroll.gridtooltip', () => {\n      this.hideTooltip();\n    });\n  },\n\n  /**\n   * Check for tooltip type gridtooltip or component\n   * @private\n   * @returns {boolean} True if is gridtooltip\n   */\n  isGridtooltip() {\n    let isGridtooltipType = false;\n    if (this.tooltip) {\n      const tooltipJQ = this.tooltip instanceof jQuery ? this.tooltip : $(this.tooltip);\n      if (tooltipJQ.data('gridtooltip')) {\n        isGridtooltipType = true;\n      }\n    }\n    return isGridtooltipType;\n  },\n\n  /**\n   * Remove the tooltip data from given node\n   * @private\n   * @param {object} elem The DOM element to remove data\n   * @returns {void}\n   */\n  removeTooltipData(elem) {\n    elem = elem instanceof jQuery ? elem : $(elem);\n    if (elem.data('gridtooltip')) {\n      $.removeData(elem[0], 'gridtooltip');\n    }\n  },\n\n  /**\n   * Remove the tooltip from the DOM\n   * @private\n   * @returns {void}\n   */\n  removeTooltip() {\n    if (this.tooltip) {\n      const tooltip = $(this.tooltip);\n\n      // Set selector\n      const selector = {\n        th: '.datagrid-header th',\n        td: '.datagrid-body tr.datagrid-row td[role=\"gridcell\"]:not(.rowstatus-cell)',\n        rowstatus: '.datagrid-body tr.datagrid-row td[role=\"gridcell\"] .icon-rowstatus'\n      };\n      selector.str = `${selector.th}, ${selector.td}, ${selector.rowstatus}`;\n\n      // Unbind events\n      $('body, .scrollable').off('scroll.gridtooltip');\n      tooltip.off('touchend.gridtooltip');\n      this.element.off('mouseenter.gridtooltip mouseleave.gridtooltip click.gridtooltip longpress.gridtooltip keydown.gridtooltip', selector.str);\n\n      // Remove the place component\n      const placeApi = tooltip.data('place');\n      if (placeApi) {\n        placeApi.destroy();\n      }\n\n      // Remove cached tooltip data\n      const nodes = [].slice.call(this.element[0].querySelectorAll(selector.str));\n      nodes.forEach(node => this.removeTooltipData(node));\n\n      if (this.tooltip.parentNode) {\n        this.tooltip.parentNode.removeChild(this.tooltip);\n      }\n    }\n    this.tooltip = undefined;\n  },\n\n  /**\n  * Unwrap the grid back to a simple div, and destory all events and pointers.\n  * @returns {object} The plugin api for chaining.\n  */\n  destroy() {\n    // Remove grid tooltip\n    this.removeTooltip();\n\n    // UnBind the pager\n    if (this.pagerAPI) {\n      this.pagerAPI.element.off(`afterpaging.${COMPONENT_NAME}`);\n      this.tableBody.off(`page.${COMPONENT_NAME} pagesizechange.${COMPONENT_NAME}`);\n      this.pagerAPI.destroy();\n    }\n\n    // Remove the toolbar, clean the div out and remove the pager\n    this.element.off().empty().removeClass('datagrid-container');\n    const toolbar = this.element.prev('.toolbar');\n\n    this.triggerDestroyCell();\n\n    if (this.removeToolbarOnDestroy && this.settings.toolbar &&\n      this.settings.toolbar.keywordFilter) {\n      const searchfield = toolbar.find('.searchfield');\n      if (searchfield.data('searchfield')) {\n        searchfield.data('searchfield').destroy();\n      }\n      searchfield.removeData('options');\n    }\n\n    if (this.removeToolbarOnDestroy) {\n      // only remove toolbar if it was created by this datagrid\n      if (toolbar.data('toolbar')) {\n        toolbar.data('toolbar').destroy();\n      }\n      toolbar.remove();\n    }\n\n    this.element.next('.pager-toolbar').remove();\n    $.removeData(this.element[0], COMPONENT_NAME);\n\n    this.element.off();\n    $(document).off('touchstart.datagrid touchend.datagrid touchcancel.datagrid click.datagrid touchmove.datagrid');\n    this.bodyContainer.off().remove();\n    $('body').off('resize.vtable resize.datagrid');\n    $(window).off('orientationchange.datagrid');\n    return this;\n  },\n\n  /**\n  * Update the datagrid and optionally apply new settings.\n  * @param  {object} settings the settings to update to.\n  * @returns {object} The plugin api for chaining.\n  */\n  updated(settings) {\n    this.settings = utils.mergeSettings(this.element, settings, this.settings);\n\n    if (settings && settings.frozenColumns) {\n      this.headerRow = undefined;\n      this.element.empty();\n      this.firstRender();\n    }\n\n    if (settings && settings.dataset) {\n      this.settings.dataset = settings.dataset;\n    }\n\n    if (settings && settings.columns) {\n      this.settings.columns = settings.columns;\n    }\n\n    this.render();\n\n    return this;\n  }\n};\n\nexport { Datagrid, COMPONENT_NAME };\n","import { Datagrid, COMPONENT_NAME } from './datagrid';\n\n/**\n * jQuery Component Wrapper for Datagrid\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.datagrid = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Datagrid(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\n\n// Component Name\nconst COMPONENT_NAME = 'formcompact';\n\n// Settings\nconst FORMCOMPACT_DEFAULTS = {};\n\n/**\n * @class FormCompact\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings=null] Incoming settings\n */\nfunction FormCompact(element, settings) {\n  if (!(element instanceof HTMLElement)) {\n    throw new Error('Element used for `FormCompact` component must be an instance of HTMLElement');\n  }\n\n  this.settings = utils.mergeSettings(element, settings, FORMCOMPACT_DEFAULTS);\n  this.element = element;\n\n  this.init();\n}\n\nFormCompact.prototype = {\n\n  /**\n   * @private\n   * Builds the component up from scratch\n   * @returns {void}\n   */\n  init() {\n    this.form = this.element.querySelector('form');\n    this.inputs = utils.getArrayFromList(this.element.querySelectorAll('input'));\n\n    this.renderProps();\n    this.handleEvents();\n  },\n\n  /**\n   * Render CSS classes on column containers for some states\n   * @returns {void}\n   */\n  renderProps() {\n    if (!this.inputs || !this.inputs.length) {\n      return;\n    }\n\n    const props = ['disabled', 'readonly'];\n    this.inputs.forEach((input) => {\n      props.forEach((prop) => {\n        this.setState(prop, input);\n      });\n    });\n  },\n\n  /**\n   * @private\n   * Sets up event listeners on the component\n   * @returns {void}\n   */\n  handleEvents() {\n    const focusedCssClass = 'is-focused';\n    $(this.form)\n      .on(`focusin.${COMPONENT_NAME}`, 'input', (e) => {\n        e.target.parentNode.classList.add(focusedCssClass);\n      })\n      .on(`focusout.${COMPONENT_NAME}`, 'input', (e) => {\n        e.target.parentNode.classList.remove(focusedCssClass);\n      });\n\n    // Listen to attribute changes (disabled/readonly) on cells\n    const attributeNames = ['disabled', 'readonly'];\n    this.inputsObserver = new MutationObserver((mutationsList) => {\n      if (!mutationsList.length) {\n        return;\n      }\n\n      mutationsList.forEach((mutation) => {\n        if (mutation.type === 'attributes') {\n          if (attributeNames.indexOf(mutation.attributeName) > -1) {\n            this.setState(mutation.attributeName, mutation.target);\n          }\n        }\n      });\n    });\n\n    const config = {\n      attributes: true\n    };\n    this.inputs.forEach((input) => {\n      this.inputsObserver.observe(input, config);\n    });\n  },\n\n  /**\n   * @private\n   * Sets a CSS Class on the parent column of a form input.\n   * @param {string} name property being set\n   * @param {HTMLElement} target the node to be evaluated\n   */\n  setState(name, target) {\n    if (typeof name !== 'string' || !(target instanceof HTMLElement)) {\n      return;\n    }\n\n    if (name === 'readonly') {\n      name = 'readOnly';\n    }\n    const isActive = target[name] === true;\n    const operation = isActive ? 'add' : 'remove';\n    target.parentNode.classList[operation](`is-${name.toLowerCase()}`);\n  },\n\n  /**\n   * Updates the component with new settings\n   * @param {object} [settings=null] if defined, new incoming settings\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.teardown();\n    this.init();\n  },\n\n  /**\n   * Removes all bound events and extraneous HTML markup\n   * @returns {void}\n   */\n  teardown() {\n    this.inputsObserver.disconnect();\n    delete this.inputsObserver;\n\n    $(this.form).off([\n      `focusin.${COMPONENT_NAME}`,\n      `focusout.${COMPONENT_NAME}`\n    ].join(' '));\n    delete this.form;\n    delete this.inputs;\n  },\n\n  /**\n   * Destroys the component and removes its contents from the DOM\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element, COMPONENT_NAME);\n  },\n\n};\n\nexport { FormCompact, COMPONENT_NAME };\n","import { FormCompact, COMPONENT_NAME } from './form-compact';\n\n/**\n * jQuery Component Wrapper for FormContact\n * @param {object} [settings=undefined] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.formcompact = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new FormCompact(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { warnAboutDeprecation } from '../../utils/deprecated';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../button/button.jquery';\nimport '../popupmenu/popupmenu.jquery';\nimport '../tabs/tabs.jquery';\nimport '../toolbar/toolbar.jquery';\nimport '../wizard/wizard.jquery';\n\n// The Component Name\nconst COMPONENT_NAME = 'header';\n\n/**\n * Special Header with Toolbar at the top of the page used to faciliate IDS Enterprise Nav Patterns\n * @class Header\n * @param {HTMLElement|jQuery[]} element the base element\n * @param {object} [settings] incoming settings\n * @param {boolean} [settings.addScrollClass = false] If true a class will be added as the page scrolls up and down\n * to the header for manipulation. Eg: Docs Page.\n * @param {boolean} [settings.demoOptions = true] Used to enable/disable default IDS Enterprise options for demo purposes\n * @param {array} [settings.tabs = null] If defined as an array of Tab objects, displays a series of tabs that represent application sections\n * @param {object} [settings.toolbarSettings = undefined] If defined, will be passed into the toolbar/toobarFlex component instance as settings\n * @param {boolean} [settings.useAlternate = null] If true, use alternate background/text color for sub-navigation areas\n * @param {boolean} [settings.useBackButton = true] If true, displays a back button next to the title in the header toolbar\n * @param {boolean} [settings.useBreadcrumb = false] If true, displays a breadcrumb on drilldown\n * @param {boolean} [settings.useFlexToolbar = false] If true, uses a Flex Toolbar component instead of a standard Toolbar component.\n * @param {boolean} [settings.usePopupmenu = false] If true, changes the Header Title into a popupmenu that can change the current page\n * @param {array} [settings.wizardTicks = null] If defined as an array of Wizard Ticks, displays a Wizard Control that represents steps in a process\n */\nconst HEADER_DEFAULTS = {\n  addScrollClass: false,\n  demoOptions: true,\n  tabs: null,\n  toolbarSettings: undefined,\n  useAlternate: false,\n  useBackButton: true,\n  useBreadcrumb: false,\n  useFlexToolbar: false,\n  usePopupmenu: false,\n  wizardTicks: null\n};\n\nfunction Header(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, HEADER_DEFAULTS);\n\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nHeader.prototype = {\n\n  /**\n   * @returns {Toolbar|ToolbarFlex|undefined} component instance, if applicable\n   */\n  get toolbarAPI() {\n    if (!this.toolbarElem) {\n      return undefined;\n    }\n    return this.toolbarElem.data('toolbar-flex') || this.toolbarElem.data('toolbar');\n  },\n\n  /**\n   * @deprecated as of v4.18.0. Please use the `toolbarAPI` property instead.\n   * @returns {Toolbar|ToolbarFlex|undefined} component instance, if applicable.\n   */\n  get toolbar() {\n    warnAboutDeprecation('toolbarAPI', 'toolbar');\n    return this.toolbarAPI;\n  },\n\n  /**\n   * @returns {jQuery[]} reference to the Header's button for controlling drilling/navigation\n   */\n  get titleButton() {\n    let query = '.title > button';\n    if (this.toolbarElem && this.toolbarElem.is('.flex-toolbar')) {\n      query = '.toolbar-section:first-child > button';\n    }\n    return this.element.find(query);\n  },\n\n  /**\n   * @returns {boolean} true if this Header component contains a button that precedes the title\n   */\n  get hasTitleButton() {\n    const btn = this.titleButton;\n    return btn.length > 0;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this\n      .setup()\n      .build()\n      .handleEvents();\n\n    // Theme, Personalization, Language Changer, Scrolling\n    if (this.settings.demoOptions) {\n      this.initPageChanger();\n    }\n  },\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  setup() {\n    // TODO: Settings all work independently, but give better descriptions\n    this.settings.demoOptions = this.element.attr('data-demo-options') ? this.element.attr('data-demo-options') === 'true' : this.settings.demoOptions;\n    this.settings.useBackButton = this.element.attr('data-use-backbutton') ? this.element.attr('data-use-backbutton') === 'true' : this.settings.useBackButton;\n    this.settings.useBreadcrumb = this.element.attr('data-use-breadcrumb') ? this.element.attr('data-use-breadcrumb') === 'true' : this.settings.useBreadcrumb;\n    this.settings.useAlternate = this.element.attr('data-use-alternate') ? this.element.attr('data-use-alternate') === 'true' : this.settings.useAlternate;\n\n    this.settings.tabs = !$.isArray(this.settings.tabs) ? null : this.settings.tabs;\n    this.settings.wizardTicks = !$.isArray(this.settings.wizardTicks) ? null :\n      this.settings.wizardTicks;\n\n    this.titleText = this.element.find('.title > h1');\n\n    // Used to track levels deep\n    this.levelsDeep = [];\n    this.levelsDeep.push(`${this.titleText.text()}`);\n\n    return this;\n  },\n\n  /**\n   * @private\n   * @returns {this} component instance\n   */\n  build() {\n    let isFlex = false;\n    const elem = this.element.find('.toolbar, .flex-toolbar');\n    if (!elem.length) {\n      return this;\n    }\n    if (elem.is('.flex-toolbar')) {\n      isFlex = true;\n    }\n    this.toolbarElem = elem;\n\n    // Build/update the toolbar instance\n    const toolbarSettings = this.settings.toolbarSettings;\n    this.toolbarElem[isFlex ? 'toolbarflex' : 'toolbar'](toolbarSettings);\n\n    // Build the title button if one is not present, and we are drilled in at least one level deep.\n    if (!this.hasTitleButton && this.levelsDeep.length > 1) {\n      this.buildTitleButton();\n    }\n\n    // Application Tabs would be available from the Application Start, so activate\n    // them during build if they exist\n    if (this.settings.tabs && this.settings.tabs.length) {\n      this.buildTabs();\n    }\n\n    if (this.settings.wizardTicks && this.settings.wizardTicks.length) {\n      this.buildWizard();\n    }\n\n    if (this.settings.usePopupmenu) {\n      this.buildPopupmenu();\n    }\n\n    // Add a Scrolling Class to manipulate the header\n    if (this.settings.addScrollClass) {\n      const self = $(this.element);\n      const scrollDiv = $(this.element).next('.scrollable');\n      const container = (scrollDiv.length === 1 ? scrollDiv : $(window));\n      const scrollThreshold = this.settings.scrollThreshold ? this.settings.scrollThreshold : 15;\n\n      container.on('scroll.header', function () {\n        if (this.scrollTop > scrollThreshold) {\n          self.addClass('is-scrolled-down');\n        } else {\n          self.removeClass('is-scrolled-down');\n        }\n      });\n\n      if (container.scrollTop() > scrollThreshold) {\n        self.addClass('is-scrolled-down');\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  buildTitleButton() {\n    if (this.levelsDeep.length > 1 && !this.hasTitleButton && !this.titleButton.length) {\n      // Deconstruct Toolbar\n      this.toolbarAPI.teardown();\n\n      // Build Title Button\n      const titleButton = $(`<button class=\"btn-icon back-button\" type=\"button\">\n        <span class=\"audible\">${Locale.translate('Drillup')}</span>\n        <span class=\"icon app-header go-back\">\n          <span class=\"one\"></span>\n          <span class=\"two\"></span>\n          <span class=\"three\"></span>\n        </span>\n      </button>`);\n\n      const titleElem = this.toolbarElem.find('.title');\n      if (this.settings.useFlexToolbar) {\n        let preTitleSection = titleElem.prev('.toolbar-section');\n        if (!preTitleSection.length) {\n          preTitleSection = $('<div class=\"toolbar-section\"></div>').insertBefore(titleElem);\n        }\n        titleButton.prependTo(preTitleSection);\n      } else {\n        titleButton.prependTo(titleElem);\n      }\n\n      // Rebuild Toolbar\n      this.toolbarAPI.init();\n    }\n\n    // Add CSS\n    this.toolbarElem.addClass('has-title-button');\n    this.titleButton.find('.icon.app-header').addClass('go-back');\n\n    // Link to the App Menu as a trigger\n    const appMenu = $('#application-menu').data('applicationmenu');\n    if (appMenu) {\n      appMenu.modifyTriggers([this.titleButton], null, true);\n    } else {\n      $('#application-menu').applicationmenu({\n        triggers: [this.titleButton]\n      });\n    }\n\n    this.handleTitleButtonEvents();\n  },\n\n  /**\n   * Used for adding a Breadcrumb Element to the Header\n   * @private\n   * @returns {void}\n   */\n  buildBreadcrumb() {\n    const self = this;\n    let breadcrumbClass = 'has-breadcrumb';\n\n    if (this.settings.useAlternate) {\n      breadcrumbClass = 'has-alternate-breadcrumb';\n    }\n    this.element.addClass(breadcrumbClass);\n\n    this.breadcrumb = this.element.find('.breadcrumb');\n    if (!this.breadcrumb.length) {\n      this.breadcrumb = $('<nav class=\"breadcrumb hidden\" role=\"navigation\"></nav>').appendTo(this.element);\n      this.breadcrumb.on('click', 'a', (e) => {\n        self.handleBreadcrumbClick(e);\n      });\n    }\n\n    this.breadcrumb[this.settings.useAlternate ? 'addClass' : 'removeClass']('alternate');\n    this.adjustBreadcrumb();\n  },\n\n  /**\n   * Builds Breadcrumb markup that reflects the current state of the application\n   * @private\n   * @returns {void}\n   */\n  adjustBreadcrumb() {\n    const last = this.levelsDeep[this.levelsDeep.length - 1];\n    this.breadcrumb.empty();\n\n    const bcMarkup = $('<ol aria-label=\"breadcrumb\"></ol>').appendTo(this.breadcrumb);\n    $.each(this.levelsDeep, (i, txt) => {\n      let current = '';\n      if (last === txt) {\n        current = ' current';\n      }\n\n      bcMarkup.append($(`<li><a href=\"#\" class=\"hyperlink${current}\">${txt}</a></li>`));\n    });\n  },\n\n  /**\n   * Builds Header Tabs\n   * @private\n   * @returns {void}\n   */\n  buildTabs() {\n    this.tabsContainer = this.element.find('.tab-container');\n    if (!this.tabsContainer.length) {\n      this.tabsContainer = $('<div class=\"tab-container\"></div>').appendTo(this.element);\n\n      // TODO: Flesh this out so that the header control can build tabs based on options\n      const tablist = $('<ul class=\"tab-list\" role=\"tablist\"></ul>').appendTo(this.tabsContainer);\n      $('<li class=\"tab\"><a href=\"#header-tabs-home\" role=\"tab\">IDS Enterprise Controls | Patterns</a></li>').appendTo(tablist);\n      $('<li class=\"tab\"><a href=\"#header-tabs-level-1\" role=\"tab\">Level 1 Detail</a></li>').appendTo(tablist);\n      $('<li class=\"tab\"><a href=\"#header-tabs-level-2\" role=\"tab\">Level 2 Detail</a></li>').appendTo(tablist);\n    }\n\n    this.element.addClass(this.settings.useAlternate ? 'has-alternate-tabs' : 'has-tabs');\n    this.tabsContainer[this.settings.useAlternate ? 'addClass' : 'removeClass']('alternate');\n\n    // NOTE: For demo purposes the markup for tab panels is already inside the\n    // Nav Patterns Test page.\n    $('#header-tabs-level-1').removeAttr('style');\n    $('#header-tabs-level-2').removeAttr('style');\n\n    // Invoke Tabs Control\n    this.tabsContainer.tabs({\n      containerElement: '#maincontent'\n    });\n  },\n\n  /**\n   * Builds a Header Wizard\n   * @private\n   * @returns {void}\n   */\n  buildWizard() {\n    this.element.addClass('has-wizard');\n\n    this.wizard = this.element.find('.wizard');\n    if (!this.wizard.length) {\n      this.wizard = $('<div class=\"wizard\"></div>').appendTo(this.element);\n      const header = $('<div class=\"wizard-header\"></div>').appendTo(this.wizard);\n      const bar = $('<div class=\"bar\"></div>').appendTo(header);\n      $('<div class=\"completed-range\"></div>').appendTo(bar);\n\n      // TODO: Flesh this out so the header control can build the Wizard Ticks based on options\n      $('<a href=\"#\" class=\"tick current\"><span class=\"label\">Context Apps</span></a>').appendTo(bar);\n      $('<a href=\"#\" class=\"tick\"><span class=\"label\">Utility Apps</span></a>').appendTo(bar);\n      $('<a href=\"#\" class=\"tick\"><span class=\"label\">Inbound Configuration</span></a>').appendTo(bar);\n      $('<a href=\"#\" class=\"tick\"><span class=\"label\">OID Mapping</span></a>').appendTo(bar);\n    }\n\n    this.wizard[this.settings.useAlternate ? 'addClass' : 'removeClass']('alternate');\n\n    // NOTE: For Demo Purposes, the shifting forms associated with the Wizard are coded\n    // inside the Nav Patterns Test page.\n    // TODO: Build shifting forms\n\n    // Invoke the Wizard Control\n    this.wizard.wizard();\n  },\n\n  /**\n   * Builds a Popupmenu in place of the usual Title text, to allow for context swapping.\n   * @private\n   * @returns {void}\n   */\n  buildPopupmenu() {\n    this.toolbarAPI.teardown();\n\n    const title = this.toolbarElem.children('.title');\n    this.titlePopup = title.find('.btn-menu');\n    if (!this.titlePopup.length) {\n      const heading = title.find('h1'); // If H1 doesn't exist here, you're doing it wrong.\n      heading.wrap('<button id=\"header-menu\" type=\"button\" class=\"btn-menu\"></button>');\n      this.titlePopup = heading.parent('.btn-menu');\n    }\n    this.titlePopupMenu = this.titlePopup.next('.popupmenu');\n    if (!this.titlePopupMenu.length) {\n      this.titlePopupMenu = $('<ul class=\"popupmenu is-selectable\"></ul>').insertAfter(this.titlePopup);\n      $('<li class=\"is-checked\"><a href=\"#\">Page One Title</a></li>' +\n        '<li><a href=\"#\">Page Two Title</a></li>' +\n        '<li><a href=\"#\">Page Three Title</a></li>' +\n        '<li class=\"is-disabled\"><a href=\"#\">Page Four Title</a></li>' +\n        '<li><a href=\"#\">Page Five Title</a></li>').appendTo(this.titlePopupMenu);\n    }\n    this.titlePopupMenu.addClass('is-selectable');\n\n    // Set the text on the Title\n    let selectedText = this.titlePopupMenu.children('.is-checked').first().text();\n    if (!selectedText) {\n      selectedText = this.titlePopupMenu.children().first().text();\n    }\n    this.titlePopup.children('h1').text(selectedText);\n\n    // Invoke the Popupmenu on the Title\n    this.titlePopup.button().popupmenu();\n\n    // Update the Header toolbar to account for the new button\n    this.element.addClass('has-popupmenu-title');\n    this.toolbarAPI.init();\n  },\n\n  /**\n   * Sets up header-level events\n   * @fires Header#events\n   * @listens updated\n   * @listens reset\n   * @listens drilldown\n   * @listens drillup\n   * @listens click\n   * @listens selected\n   * @returns {this} component instance\n   */\n  handleEvents() {\n    const self = this;\n\n    this.element\n      .on(`updated.${COMPONENT_NAME}`, (e, settings) => {\n        self.updated(settings);\n      })\n      .on(`reset.${COMPONENT_NAME}`, () => {\n        self.reset();\n      })\n      .on(`drilldown.${COMPONENT_NAME}`, (e, viewTitle) => {\n        self.drilldown(viewTitle);\n      })\n      .on(`drillup.${COMPONENT_NAME}`, (e, viewTitle) => {\n        self.drillup(viewTitle);\n      });\n\n    // Events for the title button.  e.preventDefault(); stops Application Menu\n    // functionality while drilled\n    this.handleTitleButtonEvents();\n\n    // Popupmenu Events\n    if (this.titlePopup && this.titlePopup.length) {\n      this.titlePopup.on(`selected.${COMPONENT_NAME}`, function (e, anchor) {\n        let text;\n        if (!(anchor instanceof $)) {\n          // Toolbar Flex Item\n          text = $(anchor.element).text();\n        } else {\n          // standard Toolbar\n          text = anchor.text();\n        }\n        $(this).children('h1').text(text);\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  handleTitleButtonEvents() {\n    if (!this.titleButton || !this.titleButton.length) {\n      return;\n    }\n\n    this.titleButton.bindFirst(`click.${COMPONENT_NAME}`, (e) => {\n      if (this.levelsDeep.length > 1) {\n        e.stopImmediatePropagation();\n        this.drillup();\n        e.returnValue = false;\n      }\n    });\n  },\n\n  /**\n   * Handles click events on Breadcrumb elements\n   * @private\n   * @param {jQuery.Event} e `click` event\n   * @returns {void}\n   */\n  handleBreadcrumbClick(e) {\n    const selected = $(e.target).parent();\n    const breadcrumbs = this.breadcrumb.find('li');\n    const selectedIndex = breadcrumbs.index(selected);\n    let delta;\n\n    if (selected.hasClass('current')) {\n      return;\n    }\n\n    if (selectedIndex === 0) {\n      this.reset();\n      return;\n    }\n\n    if (selectedIndex < breadcrumbs.length - 1) {\n      delta = (breadcrumbs.length - 1) - selectedIndex;\n      while (delta > 0) {\n        this.drillup();\n        delta -= 1;\n      }\n    }\n  },\n\n  /**\n   * Sets up the `selected` events on the More Actions area of the header, which can include\n   * Menu Options for changing the current theme, persoanlization colors, and language locale.\n   * @private\n   * @param {jQuery.Event} e `click` event\n   * @returns {void}\n   */\n  initPageChanger() {\n    this.element.find('.page-changer').on('selected.header', (e, link) => {\n      // Change Theme\n      if (link.attr('data-theme')) {\n        const theme = link.attr('data-theme');\n        $('body').trigger('changetheme', theme.replace('-theme', ''));\n        return;\n      }\n\n      // TODO: Change Lang\n      if (link.attr('data-lang')) {\n        Locale.set(link.attr('data-lang'));\n        return;\n      }\n\n      // Change Color\n      const color = link.attr('data-rgbcolor');\n      $('body').trigger('changecolors', [color]);\n    });\n  },\n\n  /**\n   * Drills deeper into a breadcrumb structure while updating the Header title to reflect state.\n   * @private\n   * @param {string} viewTitle text contents to put in place of the title area.\n   * @returns {void}\n   */\n  drilldown(viewTitle) {\n    this.element.addClass('is-drilldown');\n    this.levelsDeep.push(viewTitle.toString());\n    this.titleText.text(this.levelsDeep[this.levelsDeep.length - 1]);\n\n    if (this.settings.useBackButton) {\n      this.buildTitleButton();\n    }\n\n    if (this.settings.useBreadcrumb) {\n      if (!this.breadcrumb || !this.breadcrumb.length) {\n        this.buildBreadcrumb();\n        this.breadcrumb.css({ display: 'block', height: 'auto' }).removeClass('hidden');\n      } else {\n        this.adjustBreadcrumb();\n      }\n    }\n  },\n\n  /**\n   * Moves up into a breadcrumb structure while updating the Header title to reflect state.\n   * @private\n   * @param {string} viewTitle text contents to put in place of the title area.\n   * @returns {void}\n   */\n  drillup(viewTitle) {\n    let title;\n    this.element.removeClass('is-drilldown');\n\n    if (this.levelsDeep.length > 1) {\n      this.levelsDeep.pop();\n      title = this.levelsDeep[this.levelsDeep.length - 1];\n    }\n\n    if (viewTitle !== undefined) {\n      title = viewTitle;\n    }\n\n    if (this.levelsDeep.length > 1) {\n      if (this.settings.useBreadcrumb) {\n        this.adjustBreadcrumb();\n      }\n      this.titleText.text(title);\n      return;\n    }\n\n    // Completely reset all the way back to normal\n    title = this.levelsDeep[0];\n\n    if (this.settings.useBackButton) {\n      this.removeButton();\n    }\n    if (this.settings.useBreadcrumb) {\n      this.removeBreadcrumb();\n    }\n    if (this.settings.usePopupmenu) {\n      this.removePopupmenu();\n    }\n\n    this.titleText.text(title);\n    this.element.trigger('drillTop');\n  },\n\n  /**\n   * Reset the toolbar to its default removing the drilled in patterns.\n   * @returns {this} component instance\n   */\n  reset() {\n    while (this.levelsDeep.length > 1) {\n      this.levelsDeep.pop();\n    }\n    this.titleText.text(this.levelsDeep[0]);\n\n    this.removeBreadcrumb();\n    this.removeTabs();\n    this.removeWizard();\n    this.removePopupmenu();\n    this.removeButton();\n\n    this.element.trigger('afterreset');\n    return this;\n  },\n\n  /**\n   * Removes a previously-built Button pattern from the Header.\n   * @private\n   * @returns {void}\n   */\n  removeButton() {\n    if (this.hasTitleButton) {\n      this.titleButton.find('.icon.app-header').removeClass('go-back');\n      return;\n    }\n\n    if (this.titleButton && this.titleButton.length) {\n      this.toolbarAPI.teardown();\n\n      // Check for an active App Menu, and remove from the internal triggers, if applicable.\n      const appMenu = $('#application-menu').data('applicationmenu');\n      if (appMenu) {\n        appMenu.modifyTriggers([this.titleButton], true, true);\n      }\n\n      this.titleButton.off(`click.${COMPONENT_NAME}`).remove();\n      this.titleButton = $();\n\n      // Need to trigger an update on the toolbar control to make sure\n      // tabindexes and events are all firing on the button\n      this.toolbarAPI.init();\n    }\n  },\n\n  /**\n   * @public\n   * Manually remove go-back class from button\n   */\n  removeBackButton() {\n    if (!this.titleButton.length) {\n      return;\n    }\n    this.element.find('.go-back').removeClass('go-back');\n  },\n\n  /**\n   * Removes a previously-built Breadcrumb structure from the Header.\n   * @private\n   * @returns {void}\n   */\n  removeBreadcrumb() {\n    if (!this.breadcrumb || !this.breadcrumb.length) {\n      return;\n    }\n\n    const self = this;\n    const transitionEnd = $.fn.transitionEndName();\n    let timeout;\n\n    function destroyBreadcrumb() {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      self.element.off(`${transitionEnd}.breadcrumb-header`);\n      self.breadcrumb.off().remove();\n      self.breadcrumb = $();\n    }\n\n    self.element.removeClass('has-breadcrumb').removeClass('has-alternate-breadcrumb');\n    if (this.breadcrumb.is(':not(:hidden)')) {\n      this.element.one(`${transitionEnd}.breadcrumb-header`, destroyBreadcrumb);\n      timeout = setTimeout(destroyBreadcrumb, 300);\n    } else {\n      destroyBreadcrumb();\n    }\n  },\n\n  /**\n   * Removes a previously-built Header Tabs pattern from the Header.\n   * @private\n   * @returns {void}\n   */\n  removeTabs() {\n    if (!this.tabsContainer || !this.tabsContainer.length) {\n      return;\n    }\n\n    const self = this;\n    const transitionEnd = $.fn.transitionEndName();\n    let timeout;\n\n    function destroyTabs() {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      self.element.off(`${transitionEnd}.tabs-header`);\n      self.tabsContainer.data('tabs').destroy();\n      self.tabsContainer.remove();\n      self.tabsContainer = null;\n\n      // NOTE: For demo purposes the markup for tab panels is already\n      // inside the Nav Patterns Test page.\n      $('#header-tabs-level-1').css('display', 'none');\n      $('#header-tabs-level-2').css('display', 'none');\n    }\n\n    this.element.removeClass('has-tabs').removeClass('has-alternate-tabs');\n    if (this.tabsContainer.is(':not(:hidden)')) {\n      this.element.one(`${transitionEnd}.tabs-header`, destroyTabs);\n      timeout = setTimeout(destroyTabs, 300);\n    } else {\n      destroyTabs();\n    }\n  },\n\n  /**\n   * Removes a previously-built Header Wizard pattern from the Header.\n   * @private\n   * @returns {void}\n   */\n  removeWizard() {\n    if (!this.wizard || !this.wizard.length) {\n      return;\n    }\n\n    const self = this;\n    const transitionEnd = $.fn.transitionEndName();\n    let timeout;\n\n    function destroyWizard() {\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = null;\n      }\n\n      self.element.off(`${transitionEnd}.wizard-header`);\n      self.wizard.data('wizard').destroy();\n      self.wizard.remove();\n      self.wizard = null;\n    }\n\n    this.element.removeClass('has-wizard');\n    if (this.wizard.is(':not(:hidden)')) {\n      this.element.one(`${transitionEnd}.wizard-header`, destroyWizard);\n      timeout = setTimeout(destroyWizard, 300);\n    } else {\n      destroyWizard();\n    }\n  },\n\n  /**\n   * Removes a previously-built Popupmenu pattern from the Header's title.\n   * @private\n   * @returns {void}\n   */\n  removePopupmenu() {\n    const self = this;\n\n    if (!this.titlePopup || !this.titlePopup.length) {\n      return;\n    }\n\n    this.toolbarAPI.teardown();\n\n    this.titlePopup.data('popupmenu').destroy();\n    this.titlePopup.data('button').destroy();\n    this.titlePopupMenu.remove();\n    this.titlePopup.children('h1').detach().insertBefore(self.titlePopup);\n    this.titlePopup.remove();\n\n    this.titlePopup = undefined;\n    this.titlePopupMenu = undefined;\n\n    this.element.removeClass('has-popupmenu-title');\n\n    this.toolbarAPI.init();\n  },\n\n  /**\n   * Removes bound events from the Header\n   * @private\n   * @returns {this} component instance\n   */\n  unbind() {\n    if (this.titleButton && this.titleButton.length) {\n      this.titleButton.off(`click.${COMPONENT_NAME}`);\n    }\n\n    if (this.titlePopup && this.titlePopup.length) {\n      this.titlePopup.off(`updated.${COMPONENT_NAME}`);\n    }\n\n    this.element.off([\n      `updated.${COMPONENT_NAME}`,\n      `reset.${COMPONENT_NAME}`,\n      `drilldown.${COMPONENT_NAME}`,\n      `drillup.${COMPONENT_NAME}`,\n    ].join(' '));\n\n    return this;\n  },\n\n  /**\n   * Sync up the ui with settings.\n   * @param {object} [settings] incoming settings.\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    this\n      .reset()\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Teardown and destroy the menu and events.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    if (this.hasTitleButton) {\n      this.toolbarElem.removeClass('has-title-button');\n    }\n\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n};\n\nexport { Header, COMPONENT_NAME };\n","import { Header, COMPONENT_NAME } from './header';\n\n/**\n * jQuery Component Wrapper for Header\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.header = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Header(this, settings));\n    }\n  });\n};\n","/* eslint-disable no-continue: \"off, no-underscore-dangle */\nimport * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../locale/locale';\n\n// jQuery Components\nimport '../datagrid/datagrid.jquery';\nimport '../icons/icons.jquery';\nimport '../modal/modal.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'lookup';\n\n// Lookup components are \"modal\" (one on-screen at any given time)\nlet LOOKUP_GRID_ID = 'lookup-datagrid';\n\n/**\n * Input element that opens a dialog with a list for selection.\n * @class Lookup\n * @param {jquery[]|htmlelement} element the base element\n * @param {object} [settings] incoming settings\n * @param {function} [settings.click] Provide a special function to run when the dialog opens to customize the interaction entirely.\n * @param {string} [settings.clickArguments={}] If a click method is defined, this flexible object can be passed\n * into the click method, and augmented with parameters specific to the implementation.\n * @param {string} [settings.field='id'] Field name to return from the dataset or can be a function which returns a string on logic\n * @param {string} [settings.title] Dialog title to show, or befault shows  field label + \"Lookup\"\n * @param {array} [settings.buttons] Pass dialog buttons or Cancel / Apply\n * @param {object} [settings.options] Options to pass to the datagrid\n * @param {function} [settings.beforeShow] Call back that executes async before the lookup is opened.\n * @param {string} [settings.modalContent] Custom modal markup can be sent in here\n * @param {boolean} [settings.editable=true] Can the user type text in the field\n * @param {boolean} [settings.autoApply=true] If set to false the dialog wont apply the value on clicking a value.\n * @param {function} [settings.validator] A function that fires to let you validate form items on open and select\n * @param {boolean} [settings.autoWidth=false] If true the field will grow/change in size based on the content selected.\n * @param {char} [settings.delimiter=','] A character being used to separate data strings\n * @param {int} [settings.minWidth=400] Applys a minimum width to the lookup\n */\n\nconst LOOKUP_DEFAULTS = {\n  click: null,\n  field: 'id',\n  title: null,\n  buttons: [],\n  options: null,\n  beforeShow: null,\n  modalContent: null,\n  editable: true,\n  typeahead: false, // Future TODO\n  autoApply: true,\n  validator: null,\n  autoWidth: false,\n  clickArguments: {},\n  delimiter: ',',\n  minWidth: 400\n};\n\nfunction Lookup(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, LOOKUP_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\nLookup.prototype = {\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    this.inlineLabel = this.element.closest('label');\n    this.inlineLabelText = this.inlineLabel.find('.label-text');\n    this.isInlineLabel = !!this.inlineLabelText.length;\n    this.build();\n    this.handleEvents();\n    this.grid = null;\n    this.selectedRows = null;\n  },\n\n  /**\n   * Build the UI for the Lookup\n   * @private\n   * @returns {void}\n   */\n  build() {\n    const lookup = this.element;\n\n    // appends a wrapper to the lookup field.\n    function getWrapperCSSClass() {\n      let str = 'lookup-wrapper';\n\n      if (lookup.is('.input-xs')) {\n        str += ' xs';\n      }\n      if (lookup.is('.input-sm')) {\n        str += ' sm';\n      }\n      if (lookup.is('.input-lg')) {\n        str += ' lg';\n      }\n\n      return str;\n    }\n    let cssClass = getWrapperCSSClass();\n\n    if (this.element.is('.has-actions')) {\n      cssClass += ' has-actions-wrapper';\n    }\n\n    // Add Button\n    this.icon = $('<span class=\"trigger\" tabindex=\"-1\"></span>').append($.createIcon('search-list'));\n    if (this.isInlineLabel) {\n      this.inlineLabel.addClass(cssClass);\n    } else {\n      this.container = $(`<span class=\"${cssClass}\"></span>`);\n\n      if (this.element.is('.field-options')) {\n        const field = this.element.closest('.field');\n        const fieldOptionsTrigger = field.find('.btn-actions');\n\n        lookup\n          .add(fieldOptionsTrigger)\n          .add(fieldOptionsTrigger.next('.popupmenu'))\n          .wrapAll(this.container);\n      } else {\n        lookup.wrap(this.container);\n      }\n    }\n\n    lookup.after(this.icon);\n\n    // Hide icon if lookup input is hidden\n    if (lookup.hasClass('hidden')) {\n      this.icon.addClass('hidden');\n    }\n\n    if (this.settings.autoWidth) {\n      this.applyAutoWidth();\n    }\n\n    // Add Masking to show the #\n    if (lookup.attr('data-mask')) {\n      lookup.mask();\n    }\n\n    if (this.element.is(':disabled')) {\n      this.disable();\n    }\n\n    if (!this.settings.editable) {\n      this.element.attr('readonly', 'true').addClass('is-not-editable');\n    }\n\n    // Fix field options in case lookup is initialized after\n    const wrapper = this.element.parent('.lookup-wrapper');\n    if (wrapper.next().is('.btn-actions')) {\n      if (this.element.data('fieldoptions')) {\n        this.element.data('fieldoptions').destroy();\n      }\n      this.element.fieldoptions();\n    }\n\n    this.addAria();\n  },\n\n  /**\n   * Add/Update Aria\n   * @private\n   * @returns {void}\n   */\n  addAria() {\n    const self = this;\n    self.label = self.isInlineLabel ? self.inlineLabelText : $(`label[for=\"${self.element.attr('id')}\"]`);\n  },\n\n  /**\n   * Handle events on the field\n   * @private\n   * @returns {void}\n   */\n  handleEvents() {\n    const self = this;\n\n    this.icon.on('click.lookup', (e) => {\n      self.openDialog(e);\n    });\n\n    // Down Arrow opens the dialog in this field\n    this.element.on('keyup.lookup', (e) => {\n      // If autocomplete open dont open list\n      if ($('#autocomplete-list').length > 0) {\n        return;\n      }\n\n      if (e.which === 40) {\n        self.openDialog(e);\n      }\n    });\n  },\n\n  /**\n   * Create and Open the Dialog\n   * @private\n   * @param {jquery.event} e click or keyup event\n   * @returns {void}\n   */\n  openDialog(e) {\n    const self = this;\n    /**\n      * Fires before open dialog.\n      *\n      * @event beforeopen\n      * @memberof Lookup\n      * @property {object} event - The jquery event object\n      */\n    const canOpen = self.element.triggerHandler('beforeopen');\n\n    if (canOpen === false) {\n      return;\n    }\n\n    if (self.isDisabled() || (self.isReadonly() && !self.element.hasClass('is-not-editable'))) {\n      return;\n    }\n\n    if (self.settings.click) {\n      self.settings.click(e, this, self.settings.clickArguments);\n      return;\n    }\n\n    if (this.settings.beforeShow) {\n      const response = function (grid) {\n        if (grid) {\n          self.createGrid(grid);\n        }\n\n        if (typeof grid === 'boolean' && grid === false) {\n          return false;\n        }\n\n        self.createModal();\n        /**\n          * Fires on complete dialog open (for busy indicator).\n          *\n          * @event complete\n          * @memberof Lookup\n          * @property {object} event - The jquery event object\n          */\n        self.element.triggerHandler('complete'); // for Busy Indicator\n\n        /**\n          * Fires on open dialog.\n          *\n          * @event open\n          * @memberof Lookup\n          * @property {object} event - The jquery event object\n          * @property {object} modal instance\n          * @property {object} grid in lookup\n          */\n        self.element.trigger('open', [self.modal, self.grid]);\n\n        if (self.settings.validator) {\n          self.settings.validator(self.element, self.modal, self.grid);\n        }\n        return true;\n      };\n\n      /**\n        * Fires before start open dialog (for busy indicator).\n        *\n        * @event start\n        * @memberof Lookup\n        * @property {object} event - The jquery event object\n        */\n      this.element.triggerHandler('start'); // for Busy Indicator\n      this.settings.beforeShow(this, response);\n      return;\n    }\n\n    if (!this.settings.options) {\n      return;\n    }\n\n    self.createModal();\n    self.element.trigger('open', [self.modal, self.grid]);\n    self.modal.element.find('.btn-actions').removeClass('is-selected');\n\n    // Set tabindex on first row\n    if (self.grid) {\n      self.grid.cellNode(0, 0, true).attr('tabindex', '0');\n    }\n\n    // Fix: IE-11 more button was not showing\n    const thisMoreBtn = self.modal.element.find('.toolbar .more > .btn-actions');\n    if (thisMoreBtn.length) {\n      setTimeout(() => {\n        utils.fixSVGIcons(thisMoreBtn);\n      }, 600);\n    }\n\n    /**\n      * Fires after open dialog.\n      *\n      * @event afteropen\n      * @memberof Lookup\n      * @property {object} event - The jquery event object\n      * @property {object} modal instance\n      * @property {object} grid in lookup\n      */\n    self.element.trigger('afteropen', [self.modal, self.grid]);\n\n    if (self.settings.validator) {\n      self.settings.validator(self.element, self.modal, self.grid);\n    }\n  },\n\n  /**\n   * Overidable function to create the modal dialog\n   * @returns {void}\n   */\n  createModal() {\n    const self = this;\n    let content = `<div id=\"${LOOKUP_GRID_ID}\"></div>`;\n    const thisLabel = $(`label[for=\"${self.element.attr('id')}\"]`);\n\n    function getLabelText() {\n      if (self.isInlineLabel) {\n        return self.inlineLabelText;\n      }\n      if (thisLabel.length) {\n        return thisLabel.clone().find('span').remove().end()\n          .text();\n      }\n      if (self.settings.title) {\n        return self.settings.title;\n      }\n      return '';\n    }\n    const labelText = getLabelText();\n\n    const settingContent = this.settings.modalContent;\n    if (settingContent && settingContent instanceof jQuery) {\n      content = settingContent;\n      settingContent.show();\n    }\n\n    if (settingContent && !(settingContent instanceof jQuery)) {\n      content = settingContent;\n    }\n\n    let buttons = this.settings.buttons;\n    if (this.settings.options && this.settings.options.selectable === 'multiple' && buttons.length === 0 || (!self.settings.autoApply && buttons.length === 0)) {\n      buttons = [{\n        text: Locale.translate('Cancel'),\n        click(e, modal) {\n          self.element.focus();\n          modal.close();\n        }\n      }, {\n        text: Locale.translate('Apply'),\n        click(e, modal) {\n          modal.close();\n          self.insertRows(self.grid.selectedRows());\n        },\n        isDefault: true\n      }];\n    }\n\n    if (this.settings.options && this.settings.options.selectable === 'single' && buttons.length === 0 && self.settings.autoApply) {\n      buttons = [{\n        text: Locale.translate('Cancel'),\n        click(e, modal) {\n          self.element.focus();\n          modal.close();\n        }\n      }];\n    }\n\n    const hasKeywordSearch = this.settings.options && this.settings.options.toolbar &&\n      this.settings.options.toolbar.keywordFilter;\n\n    $('body').modal({\n      title: labelText,\n      content,\n      buttons,\n      cssClass: `lookup-modal${!hasKeywordSearch ? ' lookup-no-search' : ''}`\n    }).off('open.lookup').on('open.lookup', () => {\n      self.createGrid();\n    })\n      .off('close.lookup')\n      .on('close.lookup', () => {\n        self.element.focus();\n        /**\n          * Fires on close dialog.\n          *\n          * @event close\n          * @memberof Lookup\n          * @property {object} event - The jquery event object\n          * @property {object} modal instance\n          * @property {object} grid in lookup\n          */\n        self.element.triggerHandler('close', [self.modal, self.grid]);\n      });\n\n    self.modal = $('body').data('modal');\n    if (!this.settings.title) {\n      self.modal.element.find('.modal-title').append(' <span class=\"datagrid-result-count\"></span>');\n    }\n\n    self.modal.element.off('afterclose.lookup').on('afterclose.lookup', () => {\n      self.closeTearDown();\n    });\n\n    // Wait until search field available\n    setTimeout(() => {\n      $('.modal.is-visible .searchfield').on('keypress.lookup', (e) => {\n        if (e.keyCode === 13) {\n          return false; // Prevent for closing modal\n        }\n        return true;\n      });\n    }, 300);\n  },\n\n  /**\n   * Tears down the modal/grid elements by removing events, markup, and component instances.\n   * @private\n   * @returns {void}\n   */\n  closeTearDown() {\n    let search = $('.modal.is-visible .searchfield').off('keypress.lookup');\n    if (search.data() && search.data('searchfield')) {\n      search.data('searchfield').destroy();\n    }\n\n    if (search.data() && search.data('searchfield')) {\n      search.data('searchfield').destroy();\n      search.removeData();\n    }\n    search = null;\n\n    if (this.grid && this.grid.destroy) {\n      this.grid.destroy();\n      this.grid = null;\n    }\n  },\n\n  /**\n   * Overridable Function in which we create the grid on the current UI dialog.\n   * @interface\n   * @param {jquery[]} grid jQuery wrapped element containing a pre-invoked datagrid instance\n   * @returns {void}\n   */\n  createGrid(grid) {\n    const self = this;\n    let lookupGrid;\n\n    if (grid) {\n      lookupGrid = grid;\n      LOOKUP_GRID_ID = grid.attr('id');\n      self.settings.options = grid.data('datagrid').settings;\n    } else {\n      lookupGrid = self.modal.element.find(`#${LOOKUP_GRID_ID}`);\n    }\n\n    if (this.settings.minWidth) {\n      lookupGrid = this.applyMinWidth(lookupGrid);\n    }\n\n    if (self.settings.options) {\n      if (self.settings.options.selectable === 'single' && self.settings.autoApply) {\n        self.settings.options.cellNavigation = false;\n        lookupGrid.find('tr').addClass('is-clickable');\n      }\n\n      self.settings.options.isList = true;\n\n      // Create grid (unless already exists from passed in grid)\n      if (!lookupGrid.data('datagrid')) {\n        lookupGrid.datagrid(self.settings.options);\n      }\n    }\n\n    self.grid = lookupGrid.data('datagrid');\n    if (!this.settings.title && self.modal) {\n      self.modal.element.find('.title').not('.selection-count').remove();\n    }\n\n    const hasKeywordSearch = this.settings.options && this.settings.options.toolbar &&\n      this.settings.options.toolbar.keywordFilter;\n\n    if (!hasKeywordSearch && self.modal) {\n      self.modal.element.find('.toolbar').appendTo(self.modal.element.find('.modal-header'));\n    }\n\n    // Reset keyword search from previous loads\n    if (hasKeywordSearch && self.grid) {\n      if (!self.grid.filterExpr || (\n        self.grid.filterExpr &&\n        self.grid.filterExpr[0] &&\n        self.grid.filterExpr[0].value !== '')) {\n        self.grid.keywordSearch('');\n      }\n    }\n\n    // Mark selected rows\n    lookupGrid.off('selected.lookup');\n    const val = self.element.val();\n    if (val && !this.settings.options.source) {\n      self.selectGridRows(val);\n    }\n\n    // Restore selected rows when pages change\n    if (this.settings.options.source) {\n      lookupGrid.off('afterpaging.lookup').on('afterpaging.lookup', () => {\n        const fieldVal = self.element.val();\n        if (fieldVal) {\n          self.selectGridRows(fieldVal);\n        }\n      });\n    }\n\n    if (this.settings.options) {\n      lookupGrid.on('selected.lookup', (e, selectedRows) => {\n        // Only proceed if a row is selected\n        if (!selectedRows || selectedRows.length === 0) {\n          return;\n        }\n\n        if (self.settings.validator) {\n          self.settings.validator(self.element, self.modal, self.grid);\n        }\n\n        if (self.settings.options.selectable === 'single' && self.settings.autoApply) {\n          self.modal.close();\n          self.insertRows();\n        }\n      });\n    }\n  },\n\n  /**\n   * Given a field value, select the row\n   * @param {object} val incoming value from the grid row\n   * @returns {void}\n   */\n  selectGridRows(val) {\n    const selectedId = val;\n    let adjust = false;\n\n    if (!val) {\n      return;\n    }\n\n    if (this.grid && this.settings.options.source) {\n      for (let k = 0; k < this.grid._selectedRows.length; k++) {\n        if (isNaN(this.grid._selectedRows[k].idx)) {\n          this.grid._selectedRows.splice(k, 1);\n        }\n      }\n    }\n\n    // Multi Select\n    if (selectedId.indexOf(this.settings.delimiter) > 1) {\n      const selectedIds = selectedId.split(this.settings.delimiter);\n      let isFound = false;\n\n      for (let i = 0; i < selectedIds.length; i++) {\n        isFound = this.selectRowByValue(this.settings.field, selectedIds[i]);\n\n        if (this.grid && this.settings.options.source && !isFound) {\n          const data = {};\n          let foundInData = false;\n          for (let j = 0; j < this.grid._selectedRows.length; j++) {\n            if (this.grid._selectedRows[j].data[this.settings.field].toString() ===\n              selectedIds[i].toString()) {\n              foundInData = true;\n            }\n          }\n\n          if (!foundInData) {\n            data[this.settings.field] = selectedIds[i];\n            this.grid._selectedRows.push({ data });\n          }\n          adjust = true;\n        }\n      }\n\n      // There are rows selected off page. Update the count.\n      if (adjust) {\n        this.modal.element.find('.contextual-toolbar .selection-count').text(`${selectedIds.length} ${Locale.translate('Selected')}`);\n      }\n      return;\n    }\n\n    this.selectRowByValue(this.settings.field, selectedId);\n  },\n\n  /**\n   * Find the row and select it based on select value / function / field value\n   * @param {string} field the ID of the field whose value is to be returned.\n   * @param {string} value the value to set.\n   * @returns {boolean} True if the id is found.\n   */\n  selectRowByValue(field, value) {\n    if (!this.settings.options) {\n      return false;\n    }\n\n    const data = this.settings.options.source ?\n      this.grid.settings.dataset :\n      this.settings.options.dataset;\n    const selectedRows = [];\n\n    // in this case we will recall on source - server side paging\n    if (!data) {\n      return false;\n    }\n\n    for (let i = 0; i < data.length; i++) {\n      let isMatch = false;\n      if (typeof this.settings.match === 'function') {\n        if (this.settings.match(value, data[i], this.element, this.grid)) {\n          isMatch = true;\n        }\n      }\n\n      if (typeof this.settings.match !== 'function' &&\n        data[i][field].toString() === value.toString()) {\n        isMatch = true;\n      }\n\n      if (isMatch) {\n        const rowIndex = this.grid.settings.source ? this.grid.actualRowIndex(this.grid.tableBody.find('tr').eq(i)) : i;\n        selectedRows.push(rowIndex);\n      }\n    }\n\n    if (this.grid && selectedRows.length > 0) {\n      this.grid.selectRows(selectedRows, false, true);\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * Get the selected rows and return them to the UI\n   * @returns {void}\n   */\n  insertRows() {\n    let value = '';\n\n    this.selectedRows = this.grid.selectedRows();\n\n    for (let i = 0; i < this.selectedRows.length; i++) {\n      let currValue = '';\n\n      if (typeof this.settings.field === 'function') {\n        currValue = this.settings.field(this.selectedRows[i].data, this.element, this.grid);\n      } else {\n        currValue = this.selectedRows[i].data[this.settings.field];\n      }\n\n      value += (i !== 0 ? this.settings.delimiter : '') + currValue;\n\n      // Clear _selected tag\n      const idx = this.selectedRows[i].idx;\n      if (this.settings.options.dataset && this.settings.options.dataset[idx]) {\n        delete this.settings.options.dataset[idx]._selected;\n      }\n    }\n\n    /**\n      * Fires on input value change.\n      *\n      * @event change\n      * @memberof Lookup\n      * @property {object} event - The jquery event object\n      * @property {object} selected rows\n      */\n    this.element.val(value).trigger('change', [this.selectedRows]);\n    this.applyAutoWidth();\n    this.element.focus();\n  },\n\n  /**\n   * Enable the input.\n   * @returns {void}\n   */\n  enable() {\n    this.element.prop('disabled', false).prop('readonly', false);\n    this.element.parent().removeClass('is-disabled');\n  },\n\n  /**\n   * Disable the input.\n   * @returns {void}\n   */\n  disable() {\n    this.element.prop('disabled', true);\n    this.element.parent().addClass('is-disabled');\n  },\n\n  /**\n   * Make the input readonly.\n   * @returns {void}\n   */\n  readonly() {\n    this.element.prop('readonly', true);\n  },\n\n  /**\n   * Make the input the size of the text.\n   * @private\n   * @returns {void}\n   */\n  applyAutoWidth() {\n    const value = this.element.val();\n    const length = value.length;\n    const isUpperCase = (value === value.toUpperCase());\n    const isNumber = !isNaN(value);\n\n    this.element.attr('size', length + (isUpperCase && !isNumber ? 2 : 1));\n  },\n\n  /**\n   * apply the min width setting to the datagrid.\n   * @private\n   * @param {jquery[]} lookupGrid jQuery wrapped element\n   * @returns {jquery[]} grid jQuery wrapped element with the css applied\n   */\n  applyMinWidth(lookupGrid) {\n    if (this.settings.minWidth == null) {\n      return lookupGrid;\n    }\n\n    // check that the minWidth is less than the windows width, so\n    // that the control remains responsive\n    if ($(window).width() > this.settings.minWidth) {\n      const minWidth = `${this.settings.minWidth}px`;\n      lookupGrid.css({\n        'min-width': minWidth\n      });\n    }\n\n    return lookupGrid;\n  },\n\n  /**\n   * Input is disabled or not\n   * @returns {boolean} whether or not the Input is disabled\n   */\n  isDisabled() {\n    return this.element.prop('disabled');\n  },\n\n  /**\n   * Input is readonly or not\n   * @returns {boolean} whether or not the Input is readonly\n   */\n  isReadonly() {\n    return this.element.prop('readonly');\n  },\n\n  /**\n   * Updates the lookup instance with new settings\n   * @param {object} settings incoming settings\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n  },\n\n  /**\n  * Send in a new data set to display in the datagrid in the lookup.\n  * This will work whether or not the lookup is open or closed.\n  * @param {object} dataset The array of data to show in the datagridgrid.\n  * @param {object} pagerInfo The extra pager info object with information like activePage and pagesize.\n  */\n  updateDataset(dataset, pagerInfo) {\n    this.settings.options.dataset = dataset;\n\n    if (pagerInfo && pagerInfo.activePage) {\n      this.settings.options.activePage = pagerInfo.activePage;\n    }\n\n    if (pagerInfo && pagerInfo.pagesize) {\n      this.settings.options.pagesize = pagerInfo.pagesize;\n    }\n\n    if (this.grid) {\n      this.grid.updateDataset(dataset, pagerInfo);\n    }\n  },\n\n  /**\n  * Teardown events and objects.\n  * @returns {void}\n  */\n  destroy() {\n    $.removeData(this.element[0], COMPONENT_NAME);\n    this.element.off('click.dropdown keypress.dropdown');\n\n    this.icon.remove();\n    this.element.unwrap();\n  }\n};\n\nexport { Lookup, COMPONENT_NAME };\n","import { Lookup, COMPONENT_NAME } from './lookup';\n\n/**\n * jQuery Component Wrapper for Lookup\n * @param {object} settings The settings to apply.\n * @returns {jQuery[]} The jquery object for chaining.\n */\n$.fn.lookup = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Lookup(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\n\n// jQuery components\nimport '../tabs/tabs.jquery';\n\n// Component Name\nconst COMPONENT_NAME = 'multitabs';\n\n// Default Settings for MultiTabs\nconst MULTITABS_DEFAULTS = {\n  tabContainers: []\n};\n\n// Pre-defined names used internally for tab containers\nconst TAB_CONTAINER_NAMES = ['primary', 'secondary', 'tertiary'];\n\n/**\n * Scaffolding for containment of multiple, associated tabs containers.\n *\n * @class MultiTabs\n * @param {jQuery[]|HTMLElement} element base element\n * @param {object} [settings] incoming settings\n * @param {array} [settings.tabContainers] contains pre-set tab containers\n */\nfunction MultiTabs(element, settings) {\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, MULTITABS_DEFAULTS);\n\n  // internal stuff\n  this.tabContainers = {};\n\n  return this.init();\n}\n\nMultiTabs.prototype = {\n  /**\n   * Extra initializing steps\n   * @private\n   * @returns {void}\n   */\n  init() {\n    const self = this;\n    let tabContainers = [];\n\n    if (this.settings.tabContainers instanceof Array && this.settings.tabContainers.length) {\n      tabContainers = this.settings.tabContainers;\n    } else {\n      tabContainers = this.element.find('.tab-container').filter(function () {\n        return !$(this).parents('.tab-panel-container').length;\n      });\n    }\n\n    $(tabContainers).each(function () {\n      self.setupTabsInstance($(this));\n    });\n  },\n\n  /**\n   * Builds and stores an instance of a Tabs component.\n   * @param {jQuery[]} tabContainer a reference to a `.tab-container` element.\n   * @returns {void}\n   */\n  setupTabsInstance(tabContainer) {\n    if (!(tabContainer instanceof $)) {\n      return;\n    }\n\n    const self = this;\n    let didAdd = false;\n\n    TAB_CONTAINER_NAMES.forEach((propname) => {\n      if (didAdd || Object.prototype.hasOwnProperty.call(self.tabContainers, propname)) {\n        return;\n      }\n\n      let api = tabContainer.data('tabs');\n      if (!api) {\n        tabContainer.tabs();\n        api = tabContainer.data('tabs');\n      }\n      api.multitabsID = propname;\n\n      tabContainer.attr('data-multitabs', propname);\n      self.tabContainers[propname] = tabContainer;\n      didAdd = true;\n    });\n\n    if (!didAdd) {\n      throw new Error('all tab-container slots in MultiTabs component are taken, so a new tabs container was not invoked and stored');\n    }\n  },\n\n  /**\n   * Pass-through method for adding tabs that takes the container into account.\n   * @param {jQuery[]|String} tabContainer the tab container to target\n   * @param {string} tabId (directly passed into the Tabs `add` method)\n   * @param {object} options (directly passed into the Tabs `add` method)\n   * @param {number} [atIndex] (directly passed into the Tabs `add` method)\n   * @returns {Tabs} the tabs API\n   */\n  add(tabContainer, tabId, options, atIndex) {\n    tabContainer = this.checkForValidTabContainer(tabContainer);\n\n    const api = tabContainer.data('tabs');\n    return api.add(tabId, options, atIndex);\n  },\n\n  /**\n   * Pass-through method for removing tabs that takes the container into account.\n   * @param {jQuery[]|String} tabContainer the tab container being removed\n   * @param {string} tabId - (directly passed into the Tabs `add` method)\n   * @param {boolean} [disableBeforeClose] - (directly passed into the Tabs `add` method)\n   * @returns {Tabs} the tabs API instance\n   */\n  remove(tabContainer, tabId, disableBeforeClose) {\n    tabContainer = this.checkForValidTabContainer(tabContainer);\n\n    const api = tabContainer.data('tabs');\n    return api.remove(tabId, disableBeforeClose);\n  },\n\n  /**\n   * Finds an existing Tab Panel in any of the tab containers, and moves it\n   *  to a designated target tab container.\n   * @param {string} tabId the ID of the tab panel (and HREF attribute of the tab) being moved.\n   * @param {string} targetTabContainerName name of the tab container that will receive the panel.\n   * @param {boolean} [doActivate] optionally activtes the tab after it's moved.\n   * @returns {void}\n   */\n  move(tabId, targetTabContainerName, doActivate) {\n    if (!tabId || !targetTabContainerName) {\n      throw new Error('can\\'t move a tab without both a tabId and a targetTabContainerName');\n    }\n\n    let tabMarkup;\n    let panelMarkup;\n    const allTabContainers = this.getFilterableTabContainers();\n    let originalTabContainerName;\n\n    allTabContainers.each(function () {\n      const api = $(this).data('tabs');\n      const tab = api.getTab(null, tabId);\n\n      // No tabs exist by this id\n      if (tab === null) {\n        return;\n      }\n\n      originalTabContainerName = api.multitabsID;\n      tabMarkup = tab.clone();\n      panelMarkup = api.getPanel(tabId).children();\n    });\n\n    if (!tabMarkup) {\n      throw new Error(`No tab markup was found in any Multitabs container for href \"${tabId}\"`);\n    }\n\n    this.remove(originalTabContainerName, tabId);\n    this.add(targetTabContainerName, tabId, {\n      name: tabMarkup.children('a').text().trim(),\n      content: panelMarkup,\n      doActivate\n    }); // TODO: test atIndex\n  },\n\n  /**\n   * Uses the internal name of the tab container to either get a reference to an existing\n   *  Tab container, or a null reference.\n   * @private\n   * @param {string} name - the internal name used for this tabs instance\n   * @returns {jQuery[]|undefined} a tab container reference\n   */\n  getTabContainer(name) {\n    const self = this;\n    let ref;\n\n    TAB_CONTAINER_NAMES.forEach((propname) => {\n      if (ref || !self.tabContainers[propname]) {\n        return;\n      }\n\n      if (name === propname) {\n        ref = self.tabContainers[propname];\n      }\n    });\n\n    return ref;\n  },\n\n  /**\n   * Gets all currently-setup tab containers in a jQuery selector.\n   * @private\n   * @returns {jQuery[]} a jQuery-based collection of all available tab containers\n   */\n  getFilterableTabContainers() {\n    let ret = $();\n\n    this.performOnAllContainers((propname, container) => {\n      ret = ret.add(container);\n    });\n\n    return ret;\n  },\n\n  /**\n   * Validates an incoming tabContainer name, or jQuery-wrapped Tab Container instance, and returns.\n   * @private\n   * @param {jQuery[]|string} tabContainer the tab container being checked\n   * @returns {jQuery[]} the validated tab container\n   */\n  checkForValidTabContainer(tabContainer) {\n    if (!tabContainer) {\n      throw new Error('Need to have a tabContainer defined to hide a tabs instance');\n    }\n    if (typeof tabContainer === 'string') {\n      tabContainer = this.getTabContainer(tabContainer);\n    }\n    if (!(tabContainer instanceof $) || !tabContainer.length) {\n      throw new Error('No matching tabContainer could be found and hidden.');\n    }\n\n    return tabContainer;\n  },\n\n  /**\n   * Runs a callback function on all available tab containers.\n   * @param {function} callback the callback function to be executed\n   * @param {array} [additionalArgs] any additional arguments to be run in the\n   *  context of the callback.\n   * @returns {void}\n   */\n  performOnAllContainers(callback, additionalArgs) {\n    const self = this;\n\n    // Make sure additionalArgs is an array of some sort.\n    if (!Array.isArray(additionalArgs)) {\n      if (!additionalArgs) {\n        additionalArgs = [];\n      } else {\n        additionalArgs = [additionalArgs];\n      }\n    }\n\n    TAB_CONTAINER_NAMES.forEach(function (propname) {\n      const container = self.tabContainers[propname];\n      let args = [];\n\n      if (container) {\n        args.push(propname, container);\n        args = args.concat(additionalArgs);\n        callback.apply(this, args);\n      }\n    });\n  },\n\n  /**\n   * Re-adjust Module-tab containers' tab widths/alignments so everything lines up.\n   * @private\n   * @returns {void}\n   */\n  adjustModuleTabContainers() {\n    this.performOnAllContainers((propname, container) => {\n      const api = container.data('tabs');\n      if (api.isModuleTabs()) {\n        api.adjustModuleTabs();\n      }\n    });\n  },\n\n  /**\n   * Temporarily removes a tabset from view without destroying it.\n   * @param {jQuery[]|string} tabContainer the tab container to be hidden.\n   * @returns {void}\n   */\n  hideTabsInstance(tabContainer) {\n    tabContainer = this.checkForValidTabContainer(tabContainer);\n    tabContainer.parent('.multitabs-section').addClass('hidden');\n    this.adjustModuleTabContainers();\n  },\n\n  /**\n   * Re-displays a tabset that has temporarily been removed from view.\n   * @param {jQuery[]|string} tabContainer the tab container to be shown.\n   * @returns {void}\n   */\n  showTabsInstance(tabContainer) {\n    tabContainer = this.checkForValidTabContainer(tabContainer);\n    tabContainer.parent('.multitabs-section').removeClass('hidden');\n    this.adjustModuleTabContainers();\n  },\n\n  /**\n   * Destroys a tabs instance and removes it from the queue.\n   * NOTE: This only happens if the tabContainer is a part of this instance of Multitabs.\n   * @param {jQuery[]} tabContainer the tab container to be destroyed.\n   * @returns {void}\n   */\n  destroyTabsInstance(tabContainer) {\n    if (!(tabContainer instanceof $) || !tabContainer.data('tabs') || typeof tabContainer.data('tabs').destroy !== 'function') {\n      return;\n    }\n\n    const self = this;\n    let doRemove = false;\n\n    TAB_CONTAINER_NAMES.forEach((propname) => {\n      if (doRemove || !self.tabContainers[propname].is(tabContainer)) {\n        return;\n      }\n\n      const api = tabContainer.data('tabs');\n\n      delete api.multitabsID;\n      tabContainer.removeAttr('data-multitabs');\n\n      api.destroy();\n      delete self.tabContainers[propname];\n      doRemove = true;\n    });\n\n    if (!doRemove) {\n      throw new Error('could not destroy a tabContainer because it was not associated with this Multitabs instance');\n    }\n  },\n\n  /**\n   * Detects whether or not a Tab Container is currently hidden\n   * @param {jQuery[]|string} tabContainer the tab container to be checked.\n   * @returns {boolean} whether or not the tab container is currently hidden.\n   */\n  isHidden(tabContainer) {\n    tabContainer = this.checkForValidTabContainer(tabContainer);\n    return tabContainer.parent('.multitabs-section').is('.hidden');\n  },\n\n  /**\n   * Update this multi-tabs instance with new settings\n   * @param {object} [settings] incoming settings.\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n  },\n\n  /**\n   * Tears down a Multitabs instance\n   * @returns {this} component instance\n   */\n  teardown() {\n    const containers = Object.keys(this.tabContainers);\n    containers.forEach((container) => {\n      this.destroyTabsInstance(container);\n    });\n\n    return this;\n  },\n\n  /**\n   * Destroys a Multitabs instance\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  }\n\n};\n\nexport { MultiTabs, COMPONENT_NAME };\n","import { MultiTabs, COMPONENT_NAME } from './multi-tabs';\n\n/**\n * jQuery Component Wrapper for MultiTabs\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} invoked/updated component elements\n */\n$.fn.multitabs = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new MultiTabs(this, settings));\n    }\n  });\n};\n","import { utils } from '../../utils/utils';\nimport { DOM } from '../../utils/dom';\nimport { stringUtils } from '../../utils/string';\nimport { breakpoints } from '../../utils/breakpoints';\n\n// Component Name\nconst COMPONENT_NAME = 'listdetail';\n// Available breakpoint types for Edge Bleeding\nconst LIST_DETAIL_EDGE_BLEED_BREAKPOINTS = [\n  'phone',\n  'tablet'\n];\n\n/**\n * @class ListDetail\n * @param {string} element The plugin element for the constuctor\n * @param {string} [settings] The settings element.\n * @param {HTMLElement} [settings.backElement] defines a trigger button that will be used to \"drill up\" from the detail\n * back to the list on the responsive view of this pattern.\n * @param {boolean} [settings.edgeBleed=false] if true, will show an interactive edge of the \"list\" element while the\n * detail view is active.  Clicking the left edge (or a button in the left edge) will cause the \"drillup\" operation to occur\n * while making the list active.\n * @param {string} [settings.edgeBleedBreakpoint='phone'] Defines the breakpoint where the responsive \"edge bleeding\" style will occur.\n * @param {HTMLElement} [settings.listElement] the base element for the Soho component that will be used as the \"List\" to be chosen from.\n * Must implement a Soho Accordion or Listview element.\n * @param {HTMLElement} [settings.listCloseElement]  defines a trigger button element that can be used to collapse a bleeding-edge list drawer.\n * @param {HTMLElement} [settings.detailElement] the base element for the Soho component that will be used as \"detail\" or content area that can\n * change based on what is picked from the list.\n */\nconst LIST_DETAIL_DEFAULTS = {\n  backElement: undefined,\n  edgeBleed: false,\n  edgeBleedBreakpoint: LIST_DETAIL_EDGE_BLEED_BREAKPOINTS[0],\n  listElement: undefined,\n  listCloseElement: undefined,\n  detailElement: undefined\n};\n\n// Available Soho Elements to be used as the list\nconst LIST_DETAIL_SUPPORTED_LIST_TYPES = [\n  'accordion',\n  'listview'\n];\n\n/**\n * Gets the type of list component\n * @private\n * @param {HTMLElement} listElement the element being checked\n * @returns {string|undefined} the type of component, or undefined\n */\nfunction getListType(listElement) {\n  if (!(listElement instanceof HTMLElement)) {\n    return undefined;\n  }\n\n  const components = Object.keys($(listElement).data());\n  let type;\n  components.forEach((key) => {\n    if (LIST_DETAIL_SUPPORTED_LIST_TYPES.indexOf(key) > -1) {\n      type = key;\n    }\n  });\n\n  return type;\n}\n\n/**\n * Checks an HTMLElement for a Soho Component instance that can be used for the list\n * @private\n * @param {HTMLElement} listElement the element being checked\n * @returns {boolean} whether or not the element is a valid list type\n */\nfunction isValidList(listElement) {\n  if (!(listElement instanceof HTMLElement)) {\n    return false;\n  }\n\n  const type = getListType(listElement);\n  return type !== undefined;\n}\n\n/**\n * Implements cross-functionality between a list component and a content area that are described by\n * a Soho List/Detail pattern\n * @constructor\n * @param {HTMLElement} element the base element\n * @param {object} [settings] incoming settings\n * @returns {void}\n */\nfunction ListDetail(element, settings) {\n  if (!(element instanceof HTMLElement)) {\n    return;\n  }\n\n  this.element = element;\n  this.settings = utils.mergeSettings(this.element, settings, LIST_DETAIL_DEFAULTS);\n  this.init();\n}\n\nListDetail.prototype = {\n\n  /**\n   * @private\n   */\n  init() {\n    this.setInternalElementReference('listElement', elemType => isValidList(this.settings[elemType]));\n    this.setInternalElementReference('detailElement');\n    this.setInternalElementReference('backElement');\n    this.setInternalElementReference('listCloseElement');\n\n    // Single sanity-check for showing the detail area.\n    this.showDetail = false;\n    if (this.element.classList.contains('show-detail')) {\n      this.showDetail = true;\n    }\n\n    // If a proper listElement has been provided, set a flag on its Component API\n    // that notifies the API that it's controlling an adjacent detail area.\n    if (this.listElement) {\n      this.listComponentType = getListType(this.listElement);\n      const API = this.getListAPI();\n      if (API) {\n        API.isControllingDetails = true;\n      }\n    }\n\n    if (this.backElement) {\n      this.backElement.classList.add('list-detail-back-button');\n\n      // If it's an icon button, get a reference to the icon so we can change its state.\n      const hasIcon = this.backElement.querySelector('.icon');\n      if (hasIcon) {\n        this.backElementIcon = hasIcon;\n      }\n\n      // Setup internal references that can be used to find out where a backElement\n      // is located internally in this pattern instance.\n      this.listContainsBackElement = this.listElement.contains(this.backElement);\n      this.detailContainsBackElement = this.detailElement.contains(this.backElement);\n    }\n\n    // Gets children list/detail components\n    const children = this.element.querySelectorAll('.list-detail');\n    if (children) {\n      this.childrenListDetailElements = children;\n    }\n\n    // Change edgebleed setting\n    if (this.settings.edgeBleed) {\n      this.edgeBleed = true;\n      this.element.classList.add(`bleeding-edge__${this.settings.edgeBleedBreakpoint}`);\n    } else {\n      this.edgeBleed = false;\n      this.element.classList.remove('bleeding-edge__phone', 'bleeding-edge__tablet');\n    }\n\n    // Flags for responsive behavior\n    this.setBreakpointChecks();\n\n    this.handleEvents();\n  },\n\n  /**\n   * Sets internal checks for certain breakpoints\n   * @private\n   * @returns {void}\n   */\n  setBreakpointChecks() {\n    this.abovePhoneBreakpoint = breakpoints.isAbove('phone-to-tablet');\n    this.aboveTabletBreakpoint = breakpoints.isAbove('desktop');\n  },\n\n  /**\n   * Takes elements defined as settings properties, and evaluates them to determine if they\n   * are valid. If so, they are set as internal component properties for future use.\n   * @private\n   * @param {string} elementType corresponds to a setting on the pattern that\n   *  represents an element reference.\n   * @param {function} [storageConditions] if defined as a function, will provide an\n   *  additional set of parameters for determining if an HTMLElement is valid for this element type.\n   * @returns {void}\n   */\n  setInternalElementReference(elementType, storageConditions) {\n    if (typeof this.settings[elementType] === 'string' && this.settings[elementType].length) {\n      const queryForElem = document.querySelector(this.settings[elementType]);\n      if (queryForElem) {\n        this.settings[elementType] = queryForElem;\n      }\n    }\n\n    // Set to true to simply pass the next check, if a callback isn't provided.\n    // Otherwise, resolve the callback (which should return a boolean)\n    if (typeof storageConditions !== 'function') {\n      storageConditions = true;\n    } else {\n      storageConditions = storageConditions(elementType);\n    }\n\n    if (this.settings[elementType] instanceof HTMLElement && storageConditions) {\n      this[elementType] = this.settings[elementType];\n    }\n  },\n\n  /**\n   * @private\n   * @listens drilldown custom jQuery event that causes the detail area to become active\n   * @listens drillup custom jQuery event that causes the list area to become active\n   * @listens click\n   */\n  handleEvents() {\n    $(this.element).on(`drilldown.${COMPONENT_NAME}`, (e, item) => {\n      e.stopPropagation();\n      this.drilldown(item, e.target);\n    }).on(`drillup.${COMPONENT_NAME}`, (e) => {\n      e.stopPropagation();\n      this.drillup();\n    });\n\n    if (this.backElement) {\n      this.backElement.addEventListener('click', this.handleBackClick.bind(this));\n    }\n\n    if (this.listCloseElement) {\n      this.listCloseElement.addEventListener('click', this.handleClose.bind(this));\n    }\n\n    // Run certain responsive checks on page resize\n    $('body').off(`resize.${COMPONENT_NAME}`).on(`resize.${COMPONENT_NAME}`, () => {\n      this.handleResize();\n    });\n  },\n\n  /**\n   * Causes the list/detail pattern to activate the detail area, \"drilling down\"\n   *  into it, away from the list area.\n   * @param {HTMLElement} section provides context from the element chosen from the list\n   * @param {HTMLElement} [eventTarget] will cause the drilldown operation to stop if the\n   *  element provided isn't registered as the list in this list/detail instance (used when\n   *  events trigger this method).\n   * @returns {void}\n   */\n  drilldown(section, eventTarget) {\n    if (this.showDetail) {\n      return;\n    }\n\n    // If eventTarget's provided, check to see if it's the same element as the\n    // stored ListElement.  If they're not, don't continue (could have been triggered\n    // by an inner-detail area ListView/Accordion)\n    if (eventTarget && eventTarget.innerHTML !== this.listElement.innerHTML) {\n      return;\n    }\n\n    this.showDetail = true;\n    this.element.classList.add('show-detail');\n\n    this.addBackElementIconContext();\n\n    if (!this.isAboveBreakpoint()) {\n      this.getListAPI().disable();\n    }\n\n    // Pass an event to the Detail Area's main element with some context about\n    // what was clicked inside the list.\n    if (this.detailArea) {\n      $(this.detailElement).triggerHandler('activatescreen', [section]);\n    }\n  },\n\n  /**\n   * Causes the list/detail pattern to activate the list area, \"drilling up\" from the detail area.\n   * @returns {void}\n   */\n  drillup() {\n    if (!this.showDetail) {\n      return;\n    }\n\n    this.removeBackElementIconContext();\n\n    this.getListAPI().enable();\n\n    this.showDetail = false;\n    this.element.classList.remove('show-detail');\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  addBackElementIconContext() {\n    if (this.showDetail && this.backElementIcon && !this.backElementIcon.classList.contains('go-back')) {\n      this.backElementIcon.classList.add('go-back');\n    }\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  removeBackElementIconContext() {\n    if (this.backElementIcon && this.backElementIcon.classList.contains('go-back')) {\n      this.backElementIcon.classList.remove('go-back');\n    }\n  },\n\n  /**\n   * Handles `click` events passed to the `backElement`.\n   * @private\n   * @param {Event} e `click` event\n   * @returns {boolean} whether or not the click operation should be allowed to continue\n   */\n  handleBackClick(e) {\n    function cancelClick() {\n      // Prevent the normal `click` operation of the backElement.\n      // (FX: if `backElement` is the App Menu trigger, prevents the App Menu from opening)\n      e.stopPropagation();\n      e.stopImmediatePropagation();\n      e.preventDefault();\n    }\n\n    if (!this.showDetail) {\n      // In \"edgeBleed\" configuration, the BackElement can be used to drill back into a previously\n      // selected list item, if one was previously selected.\n      if (this.edgeBleed) {\n        const selected = this.getCurrentSelectedListItem();\n        if (selected) {\n          this.drilldown(selected);\n          cancelClick();\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    this.drillup();\n\n    if (this.childrenListDetailElements) {\n      this.childrenListDetailElements.forEach((elem) => {\n        const api = $(elem).data(COMPONENT_NAME);\n        if (api && typeof api.drillup === 'function') {\n          api.drillup();\n        }\n      });\n    }\n\n    cancelClick();\n    return false;\n  },\n\n  /**\n   * Handler for the listCloseElement's `click` event.\n   * @returns {void}\n   */\n  handleClose() {\n    if (this.showDetail) {\n      return;\n    }\n\n    // `selected` may be undefined here\n    const selected = this.getCurrentSelectedListItem();\n    this.drilldown(selected);\n  },\n\n  /**\n   * Event handler for `body.on('resize')`. Runs whenever the page is resized.\n   * @returns {void}\n   */\n  handleResize() {\n    this.setBreakpointChecks();\n    const listAPI = this.getListAPI();\n\n    if (this.isAboveBreakpoint()) {\n      if (this.edgeBleed && !this.showDetail && this.listElement.classList.contains('is-disabled')) {\n        listAPI.enable();\n      }\n    } else if (this.edgeBleed && this.showDetail && !this.listElement.classList.contains('is-disabled')) {\n      listAPI.disable();\n    }\n\n    // Removes the `go-back` class from the hamburger icon if we're above the breakpoint.\n    if (this.isAboveBreakpoint()) {\n      this.removeBackElementIconContext();\n    } else {\n      this.addBackElementIconContext();\n    }\n\n    // Make sure the list is always re-enabled on desktop\n    if (breakpoints.isAbove('desktop')) {\n      listAPI.enable();\n    }\n  },\n\n  /**\n   * Checks to see if the screen size is currently above the defined breakpoint\n   * @returns {boolean} whether or not the screen size is larger than the defined breakpoint.\n   */\n  isAboveBreakpoint() {\n    const breakpoint = this.settings.edgeBleedBreakpoint;\n    const breakpointPropname = `above${stringUtils.capitalize(breakpoint)}Breakpoint`;\n\n    return this[breakpointPropname];\n  },\n\n  /**\n   * Gets a reference to the defined List Element's Component API.\n   * @returns {object|undefined} a Soho Component API from a supported list type, or undefined\n   * if no API currently exists.\n   */\n  getListAPI() {\n    if (!this.listElement) {\n      return undefined;\n    }\n    return $(this.listElement).data(this.listComponentType);\n  },\n\n  /**\n   * Finds whatever item is currently selected by the listElement.\n   * @returns {HTMLElement} a reference to that element.\n   */\n  getCurrentSelectedListItem() {\n    if (!this.listElement) {\n      return '';\n    }\n\n    let item;\n    const API = this.getListAPI();\n\n    switch (this.listComponentType) {\n      case 'accordion':\n        item = API.getSelected();\n        break;\n      default: // 'listview'\n        item = API.getSelected();\n        break;\n    }\n\n    // Most components are still using jQuery,\n    // Run through a simple reference extraction to get at the HTMLElement\n    item = DOM.convertToHTMLElement(item);\n\n    return item;\n  },\n\n  /**\n   * Updates the List/Detail pattern with new settings\n   * @param {object} [settings] incoming settings\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element[0], settings, this.settings);\n    }\n\n    this.teardown();\n    this.init();\n  },\n\n  /**\n   * Removes all bound events and internal references to other components' elements/APIs\n   * @private\n   * @returns {void}\n   */\n  teardown() {\n    $('body').off(`resize.${COMPONENT_NAME}`);\n\n    $(this.element).off(`drilldown.${COMPONENT_NAME} drillup.${COMPONENT_NAME}`);\n\n    if (this.backElement) {\n      this.backElement.removeEventListener('click', this.handleBackClick.bind(this));\n    }\n\n    if (this.listCloseElement) {\n      this.listCloseElement.removeEventListener('click', this.handleClose.bind(this));\n    }\n\n    if (this.listComponentType) {\n      const API = this.getListAPI();\n      if (API) {\n        delete API.isControllingDetails;\n      }\n    }\n\n    delete this.listElement;\n    delete this.detailElement;\n    delete this.backElement;\n    delete this.backElementIcon;\n    delete this.edgeBleed;\n    delete this.listContainsBackElement;\n    delete this.detailContainsBackElement;\n    delete this.childrenListDetailElements;\n    delete this.showDetail;\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  destroy() {\n    this.teardown();\n    $.removeData(this.element, COMPONENT_NAME);\n  }\n\n};\n\nexport { ListDetail, COMPONENT_NAME };\n","import { ListDetail, COMPONENT_NAME } from './list-detail';\n\n/**\n * jQuery Component Wrapper for List/Detail Pattern\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} jQuery-wrapped components being acted on\n */\n$.fn.listdetail = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new ListDetail(this, settings));\n      instance.destroy = function destroy() {\n        this.teardown();\n        $.removeData(this, COMPONENT_NAME);\n      };\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../../components/locale/locale';\n\n// Jquery Imports\nimport '../../utils/animations';\n\n// Component Name\nconst COMPONENT_NAME = 'stepprocess';\n\n// Default Stepprocess Options\nconst STEPPROCESS_DEFAULTS = {\n  linearProgression: false,\n  folderIconOpen: 'caret-up',\n  folderIconClosed: 'caret-down',\n  stepList: '#step-list',\n  stepLi: '.js-step',\n  stepLink: '.js-step-link',\n  stepFolder: '.js-step-folder',\n  btnPrev: '.js-step-link-prev',\n  btnNext: '.js-step-link-next',\n  btnSaveClose: '.js-btn-save-changes',\n  beforeSelectStep: null,\n};\n\n/**\n * A Stepprocess/wizard control\n *\n * @class Stepprocess\n * @param {string} element The component element.\n * @param {string} [settings] The component settings.\n * @param {boolean} [settings.linearProgression = false] The Main Application Name to display\n in the header. (Defaults to false)\n * @param {string} [settings.folderIconOpen = 'caret-up'] A specific folder open icon. (Defaults to 'caret-up')\n * @param {string} [settings.folderIconClosed =  'caret-down'] A specific folder close icon. (Defaults to 'caret-down')\n * @param {boolean} [settings.stepList = '#step-list'] Determines whether or not to display device\n information (Browser, Platform, Locale, Cookies Enabled).\n * @param {string} [settings.stepLi = '.js-step'] jQuery selector for the step elements.\n * @param {boolean} [settings.stepLink =  '.js-step-link'] jQuery selector for the step link elements.\n * @param {string} [settings.stepFolder = '.js-step-folder'] jQuery selector for the step folder elements.\n * @param {string} [settings.btnPrev = '.js-step-link-prev'] jQuery selector for the previous step button.\n * @param {string} [settings.btnNext = '.js-step-link-prev'] jQuery selector for the next step button.\n * @param {function} [settings.beforeSelectStep] A callback (function or promise)\n that gives args: stepLink (the step link element) and isStepping\n (whether we are prev/next'ing or not).\n */\nfunction Stepprocess(element, settings) {\n  this.settings = utils.mergeSettings(element, settings, STEPPROCESS_DEFAULTS);\n\n  this.element = $(element);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Stepprocess Methods\nStepprocess.prototype = {\n\n  /**\n   * Init stepprocess\n   * @private\n   */\n  init() {\n    this.stepListJq = $(this.settings.stepList);\n    this.initStepprocess();\n    this.handleKeys();\n    this.setupEvents();\n    this.focusFirst();\n  },\n\n  /**\n   * Initialize stepprocess\n   * @private\n   * @returns {void}\n   */\n  initStepprocess() {\n    const steps = this.stepListJq.find(this.settings.stepLi);\n\n    for (let i = 0, l = steps.length; i < l; i++) {\n      this.decorateNode(steps[i]);\n    }\n\n    const startingStep = $(`${this.settings.stepLi}.is-selected`);\n    const startingStepLink = startingStep.find(this.settings.stepLink);\n    this.selectStep(startingStepLink);\n  },\n\n  /**\n   * Set initial attributes on each step its counterparts\n   * @private\n   * @param  {object} step - The step element to decorate\n   * @returns {void}\n   */\n  decorateNode(step) {\n    const self = this;\n    const stepJq = $(step);\n    const stepLinkJq = stepJq.children(this.settings.stepLink);\n    const stepFolderJq = stepJq.children(this.settings.stepFolder);\n    const isDisabled = stepLinkJq.hasClass('is-disabled');\n    const isOpen = stepFolderJq.hasClass('is-open');\n\n    if (isDisabled) {\n      stepLinkJq.attr('aria-disabled', 'true');\n    }\n\n    if (stepFolderJq.length) {\n      stepJq.addClass('folder');\n      stepFolderJq.attr('role', 'group');\n\n      if (isDisabled) {\n        stepFolderJq.addClass('disabled');\n\n        if (isOpen) {\n          const stepLinks = stepFolderJq.children();\n\n          for (let i = 0, l = stepLinks.length; i < l; i++) {\n            $(stepLinks[i]).find(self.settings.stepLink)\n              .addClass('is-disabled')\n              .attr('aria-disabled', 'true');\n          }\n        }\n      }\n\n      stepLinkJq.attr('aria-expanded', isOpen);\n    }\n\n    // parentCount 'aria-level' to the node's level depth\n    const parentCount = stepLinkJq.parentsUntil(this.stepListJq, 'ul').length - 1;\n\n    // Set the current stepprocess item node position relative to its aria-setsize\n    const posinset = stepJq.index();\n\n    // Set the current stepprocess item aria-setsize\n    const listCount = stepJq.siblings().addBack().length;\n\n    stepLinkJq\n      .attr({\n        role: 'stepitem',\n        tabindex: '-1',\n        'aria-selected': 'false',\n        'aria-level': parentCount + 1,\n        'aria-posinset': posinset + 1,\n        'aria-setsize': listCount,\n        'aria-disabled': isDisabled\n      })\n      .addClass('hide-focus')\n      .hideFocus();\n  },\n\n  /**\n   * Set tabindex to be focus first\n   * @private\n   * @returns {void}\n   */\n  focusFirst() {\n    this.stepListJq.find(`${this.settings.stepLi}:first`).attr('tabindex', '0');\n  },\n\n  /**\n   * Set initial attributes on each step its counterparts\n   * @private\n   * @param  {object} step - The step element\n   * @returns {void}\n   */\n  folderClose(step) {\n    const stepJq = $(step);\n    const stepLinkJq = stepJq.children(this.settings.stepLink);\n    const stepFolderJq = stepJq.children(this.settings.stepFolder);\n\n    const treeIcon = stepLinkJq\n      .closest('.folder')\n      .removeClass('is-open')\n      .end()\n      .find('svg.icon-tree');\n\n    this.setIcon(treeIcon, this.settings.folderIconClosed);\n    this.isAnimating = true;\n\n    stepFolderJq\n      .one('animateclosedcomplete', () => {\n        stepFolderJq.removeClass('is-open');\n        this.isAnimating = false;\n      })\n      .animateClosed();\n\n    stepLinkJq.attr('aria-expanded', 'false');\n  },\n\n  /**\n   * Folder open\n   * @private\n   * @param  {object} step - The step element\n   * @returns {void}\n   */\n  folderOpen(step) {\n    const stepJq = $(step);\n\n    if (!this.isOpen(stepJq)) {\n      const stepLinkJq = stepJq.children(this.settings.stepLink);\n      const stepFolderJq = stepJq.children(this.settings.stepFolder);\n\n      stepJq.addClass('is-open');\n      stepLinkJq.attr('aria-expanded', 'true');\n\n      const svgElem = stepLinkJq.find('svg.icon-tree');\n      this.setIcon(svgElem, this.settings.folderIconOpen);\n\n      this.isAnimating = true;\n\n      stepFolderJq\n        .one('animateopencomplete', () => {\n          this.isAnimating = false;\n        })\n        .addClass('is-open')\n        .css('height', 0)\n        .animateOpen();\n    }\n  },\n\n  /**\n   * Folder toggle\n   * @private\n   * @param  {object} stepLink - Description\n   * @returns {void}\n   */\n  folderToggle(stepLink) {\n    const stepJq = stepLink.closest(this.settings.stepLi);\n\n    if (this.isFolder(stepJq)) {\n      const stepFolderJq = stepJq.children(this.settings.stepFolder);\n      if (this.isOpen(stepFolderJq)) {\n        this.folderClose(stepJq);\n      } else {\n        this.folderOpen(stepJq);\n      }\n    }\n  },\n\n  /**\n   * Get selected step\n   * @private\n   * @returns {object} selected step\n   */\n  getSelectedStep() {\n    return $(`${this.settings.stepLi}.is-selected`, this.stepListJq);\n  },\n\n  /**\n   * Get next node\n   * @private\n   * @param  {object} stepLink - The step link element\n   * @returns {object} node\n   */\n  getNextNode(stepLink) {\n    const s = this.settings;\n    let next = stepLink.parent().next().find(`${s.stepLink}:first`);\n\n    // Possibly Move Into Children\n    if (stepLink.next().is(s.stepFolder) && stepLink.next().hasClass('is-open')) {\n      next = stepLink.next().find(`${s.stepLink}:first`);\n    }\n\n    // Skip disabled\n    if (next.hasClass('is-disabled')) {\n      next = this.getNextNode(next);\n    }\n\n    // Bottom of a group..{l=2: max folders to be deep }\n    if (next.length === 0) {\n      for (let i = 0, l = 2, closest = stepLink; i < l; i++) {\n        closest = closest.parent().closest('.folder');\n        next = closest.next().find(`${s.stepLink}:first`);\n        if (next.length) {\n          break;\n        }\n      }\n    }\n\n    return next;\n  },\n\n  /**\n   * Get the next step in the tree\n   * (not to be confused with getNextNode, which includes folders)\n   * @private\n   * @param  {object} curStepJq - The step link element\n   * @returns {object} next step\n   */\n  getNextStep(curStepJq) {\n    const curStepLinkJq = curStepJq.children(this.settings.stepLink);\n    const curStepFolderJq = curStepJq.next(this.settings.stepFolder);\n    const nextStepLinkJq = this.getNextNode(curStepLinkJq);\n    const nextStepFolderJq = nextStepLinkJq.next(this.settings.stepFolder);\n    let stepLinkToSelect = null;\n    let theFolder = null;\n\n    if (curStepFolderJq.length) {\n      // Select the first node of the current folder,\n      // unless its empty, which means nextStep will be the folder's \"title\"\n      theFolder = curStepFolderJq;\n      stepLinkToSelect = theFolder.children().length ?\n        theFolder.find(this.settings.stepLink).first() : nextStepLinkJq;\n    } else if (nextStepFolderJq.length) {\n      // Select the first node of the next node's folder,\n      // unless its empty, which means nextStep will be the folder's \"title\"\n      theFolder = nextStepFolderJq;\n      stepLinkToSelect = theFolder.children().length ?\n        theFolder.find(this.settings.stepLink).first() : nextStepLinkJq;\n    } else {\n      // Neither folders options work so select the next node\n      stepLinkToSelect = nextStepLinkJq;\n    }\n\n    // Skip disabled\n    if (stepLinkToSelect.hasClass('is-disabled')) {\n      stepLinkToSelect = this.getNextStep(stepLinkToSelect.parent());\n    }\n\n    return stepLinkToSelect;\n  },\n\n  /**\n   * Get the previous node\n   * @private\n   * @param  {object} stepLink - The step link element\n   * @returns {object} previous node\n   */\n  getPreviousNode(stepLink) {\n    const s = this.settings;\n    let prev = stepLink.parent().prev().find(`${s.stepLink}:first`);\n    const prevStepJq = prev.closest(s.stepLi);\n\n    // Move into children at bottom\n    if (prevStepJq.is('.folder.is-open') &&\n      prevStepJq.find('ul.is-open a').length &&\n      !prevStepJq.find('ul.is-disabled').length) {\n      prev = prevStepJq.find(`ul.is-open ${s.stepLink}:last`);\n    }\n\n    // Skip disabled\n    if (prev.hasClass('is-disabled')) {\n      this.getPreviousNode(prev);\n    }\n\n    // Top of a group\n    if (prev.length === 0) {\n      prev = stepLink.closest(s.stepFolder).prev(s.stepLink);\n    }\n    return prev;\n  },\n\n  /**\n   * Get the previous step in the tree\n   * (not to be confused with getPreviousNode, which includes folders)\n   * @private\n   * @param  {object} curStepJq - The step link element\n   * @returns {object} previous step\n   */\n  getPreviousStep(curStepJq) {\n    const s = this.settings;\n    const curStepLinkJq = curStepJq.children(s.stepLink);\n\n    // Get the previous step to switch to\n    const prevStepLinkJq = this.getPreviousNode(curStepLinkJq);\n    const prevStepJq = prevStepLinkJq.closest(s.stepLi);\n    let stepLinkToSelect = prevStepLinkJq;\n\n    // If we are moving upwards and hit a folder title step\n    if (this.isFolder(prevStepJq)) {\n      if (this.isOpen(prevStepJq)) {\n        // If the folder is open, and we got here, that means we\n        // were currently at the first step in the folder and need to\n        // go to the prev step above the folder step (aka the prev to the prev)\n        stepLinkToSelect = this.getPreviousNode(prevStepLinkJq);\n      } else {\n        const theFolder = prevStepJq.children(s.stepFolder);\n\n        if (theFolder.children().length) {\n          stepLinkToSelect = theFolder.find(s.stepLink).last();\n        }\n      }\n    }\n\n    // Skip disabled\n    if (stepLinkToSelect.hasClass('is-disabled')) {\n      stepLinkToSelect = this.getPreviousStep(stepLinkToSelect.parent());\n    }\n\n    return stepLinkToSelect;\n  },\n\n  /**\n   * Go to the next step element\n   * @private\n   * @returns {void}\n   */\n  goToNextStep() {\n    const self = this;\n    const curStepJq = this.getSelectedStep();\n    const stepLink = self.getNextStep(curStepJq);\n    if (stepLink.length) {\n      self.selectStep(stepLink, 'next');\n    } else if (typeof self.settings.beforeSelectStep === 'function') {\n      const args = { isStepping: 'next' };\n      self.settings.beforeSelectStep(args);\n    }\n  },\n\n  /**\n   * Go to the previous step element\n   * @private\n   * @returns {void}\n   */\n  goToPreviousStep() {\n    const curStepJq = this.getSelectedStep();\n    const stepLink = this.getPreviousStep(curStepJq);\n    if (stepLink.length) {\n      this.selectStep(stepLink, 'prev');\n    }\n  },\n\n  /**\n   * Key Behavior as per:\n   * http://access.aol.com/dhtml-style-guide-working-group/#treeview\n   * @private\n   * @returns {void}\n   */\n  handleKeys() {\n    /* eslint-disable consistent-return */\n    const self = this;\n    const s = this.settings;\n\n    this.stepListJq.on('focus.stepprocess', s.stepLink, function () {\n      const target = $(this);\n      if ((parseInt(target.attr('aria-level'), 10) === 0) &&\n        (parseInt(target.attr('aria-posinset'), 10) === 1)) {\n        // First element if disabled\n        if (target.hasClass('is-disabled')) {\n          const e = $.Event('keydown.stepprocess');\n          e.keyCode = 40; // move down\n          target.trigger(e);\n          return; // eslint-disable-line\n        }\n      }\n    });\n\n    // Handle Up/Down Arrow Keys and Space\n    this.stepListJq.on('keydown.stepprocess', s.stepLink, function (e) {\n      const charCode = e.charCode || e.keyCode;\n      const target = $(this);\n      let next;\n      let prev;\n\n      if (self.isAnimating) {\n        return;\n      }\n\n      // Down arrow\n      if (charCode === 40) {\n        const nextNode = self.getNextNode(target);\n        self.setFocus(nextNode);\n      }\n\n      // Up arrow,\n      if (charCode === 38) {\n        const prevNode = self.getPreviousNode(target);\n        self.setFocus(prevNode);\n      }\n\n      // Space\n      if (e.keyCode === 32) {\n        target.trigger('click.stepprocess');\n      }\n\n      // Left arrow\n      if (charCode === 37) {\n        if (Locale.isRTL()) {\n          if (target.next().hasClass('is-open')) {\n            prev = target.next().find(`${s.stepLink}:first`);\n            self.setFocus(prev);\n          } else {\n            self.folderToggle(target);\n          }\n        } else if (target.next().hasClass('is-open')) {\n          self.folderToggle(target);\n        } else {\n          prev = target.closest('.folder').find(`${s.stepLink}:first`);\n          self.setFocus(prev);\n        }\n        e.stopPropagation();\n        return false;\n      }\n\n      // Right arrow\n      if (charCode === 39) {\n        if (Locale.isRTL()) {\n          if (target.next().hasClass('is-open')) {\n            self.folderToggle(target);\n          } else {\n            next = target.closest('.folder').find(`${s.stepLink}:first`);\n            self.setFocus(next);\n          }\n        } else if (target.next().hasClass('is-open')) {\n          next = target.next().find(`${s.stepLink}:first`);\n          self.setFocus(next);\n        } else {\n          self.folderToggle(target);\n          self.setFocus(target);\n        }\n        e.stopPropagation();\n        return false; // eslint-disable-line\n      }\n\n      // Home  (fn-right on mac)\n      if (charCode === 36) {\n        next = self.stepListJq.find(`${s.stepLink}:first:visible`);\n        self.setFocus(next);\n      }\n\n      // End (fn-right on mac)\n      if (charCode === 35) {\n        next = self.stepListJq.find(`${s.stepLink}:last:visible`);\n        self.setFocus(next);\n      }\n    });\n\n    // Handle Left/Right Arrow Keys\n    this.stepListJq.on('keypress.stepprocess', s.stepLink, function (e) {\n      const charCode = e.charCode || e.keyCode;\n      const target = $(this);\n\n      if ((charCode >= 37 && charCode <= 40) || charCode === 32) {\n        e.stopPropagation();\n        return false;\n      }\n\n      // Printable Chars Jump to first high level node with it...\n      if (e.which !== 0) {\n        target.closest(s.stepLi)\n          .nextAll().find('.js-step-link:visible').each(function () {\n            const node = $(this);\n            const first = node.text().substr(0, 1).toLowerCase();\n            const term = String.fromCharCode(e.which).toLowerCase();\n\n            if (first === term) {\n              self.setFocus(node);\n              return false;\n            }\n          });\n      }\n    });\n    /* eslint-enable consistent-return */\n  },\n\n  /**\n   * Checks if given step element is folder.\n   * @private\n   * @param {object} step - The step element\n   * @returns {boolean} true if folder\n   */\n  isFolder(step) {\n    return $(step).hasClass('folder');\n  },\n\n  /**\n   * Checks if given step element is in folder.\n   * @private\n   * @param {object} step - The step element\n   * @returns {boolean} true is in folder\n   */\n  isInFolder(step) {\n    return $(step).closest(this.settings.stepFolder, this.stepListJq).length;\n  },\n\n  /**\n   * Checks if given step folder is open.\n   * @private\n   * @param {object} stepFolder element\n   * @returns {boolean} true is open\n   */\n  isOpen(stepFolder) {\n    return $(stepFolder).hasClass('is-open');\n  },\n\n  /**\n   * Set focus on given step link.\n   * @private\n   * @param {object} stepLink element\n   * @returns {void}\n   */\n  setFocus(stepLink) {\n    stepLink.focus();\n  },\n\n  /**\n   * Replace all \"icon-\", \"hide-focus\", \"\\s? - all spaces if any\" with nothing.\n   * @private\n   * @param {object} svg element.\n   * @param {string} icon to set.\n   * @returns {void}\n   */\n  setIcon(svg, icon) {\n    const iconStr = icon.replace(/icon-|hide-focus|\\s?/gi, '');\n    svg.changeIcon(iconStr);\n  },\n\n  /**\n   * Select a step\n   * @private\n   * @param  {object} stepLink - The jquery object for the step link element\n   * @param  {string} linearDirection - [none|previous|next] Which direction we are traveling\n   * @returns {void}\n   */\n  selectStep(stepLink, linearDirection) {\n    const self = this;\n    if (linearDirection === undefined) {\n      linearDirection = 'none';\n    }\n\n    // Possibly Call the beforeSelectStep\n    let result;\n    if (typeof self.settings.beforeSelectStep === 'function') {\n      const args = {\n        stepLink,\n        isStepping: linearDirection\n      };\n      result = self.settings.beforeSelectStep(args);\n\n      if (result.done && typeof result.done === 'function') { // A promise is returned\n        result.done((continueSelectNode, stepLinkToSelect) => {\n          if (continueSelectNode) {\n            if (stepLinkToSelect) {\n              stepLink = stepLinkToSelect;\n            }\n            self.selectStepFinish(stepLink, linearDirection);\n          }\n        });\n      } else if (result) { // boolean is returned instead of a promise\n        self.selectStepFinish(stepLink, linearDirection);\n      }\n    } else { // No Callback specified\n      self.selectStepFinish(stepLink, linearDirection);\n    }\n  },\n\n  /**\n   * Finishes selecting a step\n   * @private\n   * @param  {object} stepLink - Description\n   * @param  {string} [linearDirection=previous|next] - Description\n   * @returns {void}\n   */\n  selectStepFinish(stepLink, linearDirection) {\n    const self = this;\n    const allStepLinksJq = $(this.settings.stepLink, this.stepListJq);\n    const stepJq = stepLink.closest(this.settings.stepLi);\n\n    if (!this.isFolder(stepJq)) {\n      allStepLinksJq\n        .attr({\n          tabindex: '-1',\n          'aria-selected': 'false'\n        })\n        .parent().removeClass('is-selected');\n\n      stepLink.attr({\n        tabindex: '0',\n        'aria-selected': 'true'\n      });\n\n      stepJq.addClass('is-selected');\n    }\n\n    if (this.isFolder(stepJq)) {\n      // It is a folder\n      if (linearDirection === 'none') {\n        this.folderToggle(stepJq); // clicking toggles\n      } else {\n        this.folderOpen(stepJq); // going prev/next always opens\n      }\n    } else {\n      // Its not a folder\n      const parentIsFolder = stepJq.closest(this.settings.stepFolder, this.stepListJq);\n\n      if (parentIsFolder.length) {\n        // If the step is in a folder, make sure that folder opens\n        this.folderOpen(parentIsFolder.closest(this.settings.stepLi));\n      }\n\n      // Show the step's panel\n      this.showStepPanel(stepLink.attr('href'));\n    }\n    stepLink.focus();\n\n    setTimeout(() => {\n      /**\n       * Fires when selected step link.\n       * @event selected\n       * @memberof Stepprocess\n       * @type {object}\n       * @property {object} event - The jquery event object\n       * @property {object} stepLink element\n       */\n      self.element.triggerHandler('selected', stepLink);\n    }, 0);\n  },\n\n  /**\n   * Un selected node\n   * @private\n   * @param {object} step - The step element to decorate\n   * @returns {void}\n   */\n  unSelectedNode(step) {\n    const aTags = $(this.settings.stepLink, this.stepListJq);\n    const stepJq = $(step);\n    const stepLinkJq = stepJq.children(this.settings.stepLink);\n\n    aTags.attr('tabindex', '-1');\n    stepLinkJq.attr('tabindex', '0');\n\n    stepJq.removeClass('is-selected');\n    stepLinkJq.attr('aria-selected', 'false');\n  },\n\n  /**\n   * Setup events\n   * @private\n   * @returns {void}\n   */\n  setupEvents() {\n    const self = this;\n    const s = this.settings;\n\n    // Updated and Click events\n    this.stepListJq\n      .on('updated.stepprocess', () => {\n        this.initStepprocess();\n      })\n      .on('click.stepprocess', `${s.stepLink}:not(.is-clone)`, function (e) {\n        e.preventDefault();\n\n        if (!s.linearProgression) {\n          const targetJq = $(this);\n\n          if (!targetJq.is('.is-disabled, .is-loading')) {\n            self.selectStep(targetJq);\n            e.stopPropagation();\n          }\n        }\n      });\n\n    // Next Button Click\n    $(s.btnPrev).on('click', (e) => {\n      e.preventDefault();\n      this.goToPreviousStep.call(self);\n    });\n\n    // Previous Button Click\n    $(s.btnNext).on('click', (e) => {\n      e.preventDefault();\n      this.goToNextStep.call(self);\n    });\n\n    // Setup main scrolling\n    $(s.contentScroll).scrollaction({\n      scrollActionTarget: '.main'\n    });\n\n    // Setup sidebar scrolling\n    $(s.stepListScroll).scrollaction({\n      scrollActionTarget: '.sidebar'\n    });\n\n    // Toggle sidebar\n    // Button to toggle the tree in responsive view\n    $('.js-toggle-sidebar').click((e) => {\n      e.preventDefault();\n      this.element\n        .toggleClass('tablet-hide-steps')\n        .toggleClass('phone-hide-steps');\n    });\n  },\n\n  /**\n   * Show the content panel for the step\n   * @private\n   * @param  {string} contentId - The contentId to show\n   * @returns {void}\n   */\n  showStepPanel(contentId) {\n    $('.step-panel-active').removeClass('step-panel-active');\n    $(contentId).addClass('step-panel-active');\n    this.element.addClass('phone-hide-steps');\n  },\n\n  /**\n   * Removes event bindings from the instance.\n   * @private\n   * @returns {object} The api\n   */\n  unbind() {\n    this.stepListJq.off('updated.stepprocess click.stepprocess focus.stepprocess keydown.stepprocess keypress.stepprocess').empty();\n    return this;\n  },\n\n  /**\n   * Resync the UI and Settings.\n   * @param {object} settings The settings to apply.\n   * @returns {object} The api\n   */\n  updated(settings) {\n    if (typeof settings !== 'undefined') {\n      this.settings = utils.mergeSettings(this.element, settings, STEPPROCESS_DEFAULTS);\n    }\n    return this\n      .unbind()\n      .init();\n  },\n\n  /**\n   * Destroy this component instance and remove the link from its base element.\n   * @returns {void}\n   */\n  destroy() {\n    this.unbind();\n    $.removeData(this.element[0], COMPONENT_NAME);\n  },\n};\n\nexport { Stepprocess, COMPONENT_NAME };\n","import { Stepprocess, COMPONENT_NAME } from './stepprocess';\n\n/**\n * jQuery Component Wrapper for Stepprocess\n * @param {object} [settings] incoming settings\n * @returns {jQuery[]} elements being acted on\n */\n$.fn.stepprocess = function (settings) {\n  return this.each(function () {\n    let instance = $.data(this, COMPONENT_NAME);\n    if (instance) {\n      instance.updated(settings);\n    } else {\n      instance = $.data(this, COMPONENT_NAME, new Stepprocess(this, settings));\n    }\n  });\n};\n","import * as debug from '../../utils/debug';\nimport { utils } from '../../utils/utils';\nimport { Locale } from '../../components/locale/locale';\n\n// jQuery components\nimport '../behaviors.jquery';\nimport '../../components/components.jquery';\nimport '../../patterns/patterns.jquery';\n\n// The name of this component\nconst COMPONENT_NAME = 'initialize';\n\n// Component Defaults\nconst INITIALIZE_DEFAULTS = {\n  locale: null\n};\n\n// Contains excluded CSS selectors that prevent automatic initialization\nconst noinitExcludes = '.no-init, [data-init]';\n\n// Invokes a Soho component against an Element\nfunction invoke(elem, pluginName, settings) {\n  return $(elem)[pluginName](settings);\n}\n\n// Finds child elements that match a CSS selector\nfunction matchedItems(elem, selector) {\n  let items = elem.find(selector).not(noinitExcludes);\n  if (elem.filter(selector).length) {\n    items = items.add(elem);\n  }\n  return items;\n}\n\n// Array of plugin names, selectors (optional), and callback functions (optional),\n// for no-configuration initializations.\nconst PLUGIN_MAPPINGS = [\n\n  // Mobile Zoom Control\n  // Needs manual invokation because the rest of initialization is scoped to the\n  // calling element, which is the <body> tag.\n  ['zoom', null, function () {\n    $('head').zoom();\n  }],\n\n  // Application Menu\n  ['applicationmenu', '#application-menu', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      $(item).applicationmenu({\n        triggers: rootElem.find('.application-menu-trigger')\n      });\n    });\n  }],\n\n  // Personalization\n  ['personalize', null, function () {\n    $('html').personalize();\n  }],\n\n  // Hyperlinks\n  ['hyperlink'],\n\n  // Icons\n  ['icon'],\n\n  // Radio switch\n  ['radio', '.radio-section input:radio.handle', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).change(function () {\n      if (this.checked) {\n        const option = $(this).closest('.option');\n        const siblings = option.siblings();\n        const fields = 'button, select, input[type=\"text\"]';\n\n        $(fields, option).removeAttr('disabled');\n        $(fields, siblings).attr('disabled', 'disabled');\n      }\n    });\n  }],\n\n  ['splitter'],\n\n  // Tabs\n  ['tabs', '.tab-container:not(.vertical)'],\n\n  // Vertical Tabs\n  ['verticaltabs', '.tab-container.vertical'],\n\n  // MultiTabs Containers\n  ['multitabs', '.multitabs-container'],\n\n  // Select / DropDowns\n  ['dropdown', 'select.dropdown:not(.multiselect)'],\n  ['dropdown', 'select.dropdown-xs:not(.multiselect)'],\n  ['dropdown', 'select.dropdown-sm:not(.multiselect)'],\n  ['dropdown', 'select.dropdown-lg:not(.multiselect)'],\n\n  // Modals\n  ['modal'],\n\n  // Sliders\n  ['slider', 'input[type=\"range\"], .slider'],\n\n  // Editors\n  ['editor'],\n\n  // Tooltips\n  ['tooltip', 'button[title], span[title], .hyperlink[title], .icon[title], input[title]'],\n\n  // Tree\n  ['tree'],\n\n  // Rating\n  ['rating'],\n\n  // Listbuilder\n  ['listbuilder'],\n\n  // Composite Form Wrapper\n  ['compositeform', '.composite-form'],\n\n  // Progress\n  ['progress', '.progress-bar'],\n\n  // Format\n  ['mask', 'input[data-mask], .new-mask'],\n\n  // Auto Complete\n  ['autocomplete', '.autocomplete:not([data-init])'],\n\n  // Multiselect\n  ['multiselect', 'select[multiple]:not(.dropdown), .multiselect:not([data-init])'],\n\n  // Button with Effects\n  ['button', [\n    '.btn',\n    '.btn-toggle',\n    '.btn-secondary',\n    '.btn-primary',\n    '.btn-modal-primary',\n    '.btn-tertiary',\n    '.btn-icon',\n    '.btn-actions',\n    '.btn-menu',\n    '.btn-split',\n    '.btn-secondary-border'\n  ].join(', ')],\n\n  // Hide Focus\n  ['hideFocus', 'a.hide-focus, a.tick, .checkbox, .radio, .switch'],\n\n  // Circle Pager\n  ['circlepager'],\n\n  // Clear x\n  ['clearable', '[data-clearable=\"true\"]'],\n\n  // Text Area\n  ['textarea', 'textarea'],\n\n  // Spinbox\n  ['spinbox'],\n\n  // sort drag and drop\n  ['arrange'],\n\n  // Swap List\n  ['swaplist'],\n\n  // Color Picker\n  ['colorpicker'],\n\n  // Date Picker\n  ['datepicker'],\n\n  // Time Picker\n  ['timepicker'],\n\n  // Tag\n  ['tag'],\n\n  // Busy Indicator\n  ['busyindicator', '.busy, .busy-xs, .busy-sm'],\n\n  ['header'],\n\n  ['fileupload', 'input.fileupload:not(.fileupload-background-transparent)'],\n\n  ['fileuploadadvanced', '.fileupload-advanced'],\n\n  ['fieldfilter', '.field-filter'],\n\n  ['fieldoptions', '.field-options'],\n\n  ['about'],\n\n  ['contextualactionpanel', '.contextual-action-panel-trigger'],\n\n  ['expandablearea', '.expandable-area'],\n\n  ['signin'],\n\n  ['homepage'],\n\n  ['lookup', '.lookup:not([data-init])'],\n\n  ['wizard'],\n\n  ['popdown', '[data-popdown]'],\n\n  ['stepchart', '.step-chart'],\n\n  ['calendar', '.calendar'],\n\n  ['monthview', '.monthview'],\n\n  ['listview'],\n\n  // Track Dirty\n  ['trackdirty', '[data-trackdirty=\"true\"]'],\n\n  // Context Menus - Popupmenu Components with no trigger buttons\n  ['popupmenu', '[data-popupmenu]:not(.btn-actions, .btn-filter, .btn-menu)', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      const popupElem = $(item);\n      const settings = $.extend({}, utils.parseOptions(popupElem));\n      const popupData = popupElem.attr('data-popupmenu');\n\n      if (popupData) {\n        settings.menuId = popupData;\n      }\n\n      invoke(popupElem, pluginName, settings);\n    });\n  }],\n\n  // Menu Buttons - Popupmenu Components attached to trigger buttons\n  ['popupmenu', '.btn-actions, .btn-filter, .btn-menu', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      const triggerButton = $(item);\n\n      // Don't auto-invoke Toolbar's Popupmenus.\n      // Toolbar needs to completely control its contents and invoke each one manually.\n      if (triggerButton.parents('.toolbar, .flex-toolbar').length > 0) {\n        return;\n      }\n\n      invoke(triggerButton, pluginName);\n    });\n  }],\n\n  // Popover\n  ['popover', '[data-popover]', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each(function () {\n      const options = utils.parseOptions(this);\n      const obj = $(this);\n      const trigger = obj.attr('data-trigger');\n      const title = obj.attr('data-title');\n      const placement = obj.attr('data-placement');\n\n      if (!$.isEmptyObject(options)) {\n        obj.popover({\n          content: $(options.content),\n          popover: true,\n          trigger: options.trigger || 'click',\n          title: options.title || undefined,\n          placement: options.placement || 'right',\n          extraClass: options.extraClass || undefined\n        });\n      } else {\n        obj.popover({\n          content: $(`#${obj.attr('data-popover')}`),\n          popover: true,\n          trigger: trigger || 'click',\n          title: title || undefined,\n          placement: placement || 'right',\n          extraClass: options.extraClass || undefined\n        });\n      }\n    });\n  }],\n\n  // Searchfield components need to be filtered for ToolbarSearchfield components,\n  // which are invoked separately by their Toolbar element containers.\n  ['searchfield', '.searchfield', function (rootElem, pluginName, selector) {\n    let searchfields = matchedItems(rootElem, selector);\n    const toolbarSearchfields = searchfields.filter(function () {\n      return $(this).parents('.toolbar').length;\n    });\n    searchfields = searchfields.not(toolbarSearchfields);\n\n    searchfields.each(function () {\n      invoke(this, 'searchfield');\n    });\n  }],\n\n  // Toolbar components that are invoked by parent Headers, Contextual Action Panels, and\n  // Modal components should be excluded.\n  ['toolbar', '.toolbar', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      const t = $(item);\n\n      if (t.parents('.header, .contextual-action-panel .modal-header').length &&\n        !rootElem.is('.toolbar')) {\n        return;\n      }\n\n      invoke(t, 'toolbar');\n    });\n  }],\n\n  // Flex Toolbar\n  ['toolbarflex', '.flex-toolbar'],\n\n  // Accordion components that are invoked by Application Menus should be excluded.\n  ['accordion', '.accordion', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      const a = $(item);\n      if (a.parents('.application-menu').length) {\n        return;\n      }\n\n      invoke(a, 'accordion');\n    });\n  }],\n\n  // Form Compact Component\n  ['formcompact', '.form-compact-container', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      invoke($(item), 'formcompact');\n    });\n  }],\n\n  // List/Detail Pattern\n  ['listdetail', '.list-detail', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      invoke($(item), 'listdetail');\n    });\n  }],\n\n  // Inline text translations by Locale, via the `data-translate` attribute.\n  // (Not all inline text items are powered by JS components)\n  ['texttranslations', '[data-translate=\"text\"]', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).each((i, item) => {\n      const obj = $(item);\n      obj.text(Locale.translate(obj.text(), true));\n    });\n  }],\n\n  // Translate `aria-label` attributes on Breadcrumb lists\n  // (Breadcrumbs aren't invoked with a JS component)\n  ['breadcrumblabels', '.breadcrumb ol', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).attr('aria-label', Locale.translate('Breadcrumb'));\n  }],\n\n  // Validation on individual fields (Should run last)\n  ['validate', '[data-validate]', function (rootElem, pluginName, selector) {\n    matchedItems(rootElem, selector).closest('form, body').validate();\n  }],\n\n  // Form validation\n  ['validate', 'form[data-validate-on=\"submit\"]']\n];\n\n// Invokes a specific Soho component type against an element, in some cases with\n// specified rules or CSS selectors.\nfunction mapToInit(elem, plugin, selector, callback) {\n  // Don't continue if the jQuery constructor for this plugin isn't loaded.\n  if (!$.fn[plugin] && plugin !== 'texttranslations') {\n    return;\n  }\n\n  // Allow only the plugin name to be specified if the default selector is\n  // a class with the same name, Like `$.fn.header` applying to elements that\n  // match `.header`\n  if (typeof selector === 'undefined') {\n    selector = `.${plugin}`;\n  }\n\n  // If a callback function is provided, run that instead of the normal init.\n  // Functions contain more-customized initialization for some components.\n  if (typeof callback === 'function') {\n    callback(elem, plugin, selector);\n    return;\n  }\n\n  // Run the matcher and do normal init.\n  matchedItems(elem, selector).each(function () {\n    const thisElem = $(this);\n\n    // Don't init if this element or one of its containing elements is flagged\n    // with `[data-init]` or `.no-init`.\n    if (thisElem.is(noinitExcludes) || thisElem.parents(noinitExcludes).length) {\n      return;\n    }\n\n    invoke(this, plugin);\n  });\n}\n\n/**\n * Page Bootstrapper, will initialize all components on a page with default settings.\n * @class Initialize\n * @constructor\n * @param {jQuery[]|HTMLElement} element the root element to initialize\n * @param {object} [settings] incoming settings\n */\nfunction Initialize(element, settings) {\n  // Settings and Options\n  if (typeof settings === 'string') {\n    settings = {\n      locale: settings\n    };\n  }\n\n  this.element = $(element);\n  this.settings = utils.mergeSettings(this.element[0], settings, INITIALIZE_DEFAULTS);\n  debug.logTimeStart(COMPONENT_NAME);\n  this.init();\n  debug.logTimeEnd(COMPONENT_NAME);\n}\n\n// Plugin Methods\nInitialize.prototype = {\n\n  /**\n   * Makes sure the Locale is set before attempting initialize components\n   * @private\n   * @returns {this} component instance\n   */\n  init() {\n    const self = this;\n    let locale = this.settings.locale;\n    if ((!Locale || !Locale.currentLocale) && !this.settings.locale) {\n      locale = 'en-US';\n    }\n\n    if (locale) {\n      Locale.set(locale).done(() => {\n        self.initAll();\n      });\n    } else {\n      self.initAll();\n    }\n\n    return this;\n  },\n\n  /**\n   * Initializes all Soho components inside the root element provided.\n    * @returns {this} component instance\n   */\n  initAll() {\n    const self = this;\n\n    // Iterate all objects we are initializing\n    this.element.each(function () {\n      for (let i = 0; i < PLUGIN_MAPPINGS.length; i++) {\n        mapToInit($(this), ...PLUGIN_MAPPINGS[i]);\n      }\n    });\n\n    // NOTE: use of .triggerHandler() here causes event listeners for \"initialized\"\n    // to fire, but prevents the \"initialized\" event from bubbling up the DOM.\n    // It should be possible to initialize just the contents of an element on\n    // the page without causing the entire page to re-initialize.\n    this.element.triggerHandler('initialized');\n\n    // Run validation on the entire element, if applicable.\n    if ($.fn.validate) {\n      self.element.validate();\n    }\n\n    return this;\n  }\n};\n\nexport { Initialize, COMPONENT_NAME };\n","import { Initialize } from './initialize';\n\n/**\n * jQuery Component Wrapper for Initialize\n * @param {object} settings The settings to apply.\n * @returns {jQuery[]} The jquery object for chaining.\n */\n$.fn.initialize = function (settings) {\n  return this.each(function () {\n    return new Initialize(this, settings);\n  });\n};\n","import { utils, math } from '../../utils/utils';\nimport { Environment as env } from '../../utils/environment';\nimport { renderLoop, RenderLoopItem } from '../../utils/renderloop';\n\nconst BEHAVIOR_NAME = 'longpress';\n\n// Default LongPress settings\nconst LONGPRESS_DEFAULTS = {\n  delay: 400,\n  mouseEvents: false\n};\n\n/**\n * @class LongPress\n * @constructor\n * @param {Object} [settings] incoming settings\n * @param {Number} [settings.delay] the amount of time that should pass between the touch start, and\n *  the trigger of the \"longpress\" event.\n * @param {boolean} [settings.mouseEvents] if true, will setup longpress capability against mouse events\n *  as well as touch events.  If false, only touch events will be enabled, excluding mice from triggering\n *  the event.\n */\nfunction LongPress(settings) {\n  this.settings = utils.mergeSettings(this.element, settings, LONGPRESS_DEFAULTS);\n  return this.init();\n}\n\nLongPress.prototype = {\n\n  /**\n   * @property {RenderLoopItem} [timer=null]\n   */\n  timer: null,\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  init() {\n    const evts = this.getInputEventNames();\n    const self = this;\n\n    // User touches the screen.\n    // If this goes uninterrupted for the defined duration, it causes a\n    // `longpress` event to trigger on the target element.\n    $(document).on(`${evts.mousedown}.${BEHAVIOR_NAME}`, (e) => {\n      const target = e.target;\n\n      // Add a timer to the renderLoop\n      this.timer = new RenderLoopItem({\n        id: `${BEHAVIOR_NAME}-timer`,\n        duration: math.convertDelayToFPS(this.settings.delay),\n        timeoutCallback() {\n          self.fire(target, e);\n        }\n      });\n      renderLoop.register(this.timer);\n    });\n\n    // User moves or releases the touch, causing the timer to be cancelled.\n    $(document).on([\n      `${evts.mouseup}.${BEHAVIOR_NAME}`,\n      `${evts.mouseout}.${BEHAVIOR_NAME}`,\n      `${evts.mousemove}.${BEHAVIOR_NAME}`\n    ].join(' '), () => {\n      this.killTimer();\n    });\n  },\n\n  /**\n   * @param {HTMLElement} target the target element on which to trigger the event\n   * @param {jQuery.Event} [e=undefined] the original event, if applicable\n   * @returns {void}\n   */\n  fire(target, e) {\n    $(target).trigger(`${BEHAVIOR_NAME}`, [e]);\n  },\n\n  /**\n   * @private\n   * @returns {void}\n   */\n  killTimer() {\n    if (!this.timer) {\n      return;\n    }\n\n    // Kill the renderloop item with no call to the timeout callback\n    this.timer.destroy(true);\n    this.timer = null;\n  },\n\n  /**\n   * @private\n   * @returns {object} containing desired event names\n   */\n  getInputEventNames() {\n    const isTouch = env.features.touch;\n    const useMouse = this.settings.mouseEvents;\n    const testCondition = isTouch || !useMouse;\n\n    return {\n      mousedown: testCondition ? 'touchstart' : 'mousedown',\n      mouseout: testCondition ? 'touchcancel' : 'mouseout',\n      mouseup: testCondition ? 'touchend' : 'mouseup',\n      mousemove: testCondition ? 'touchmove' : 'mousemove'\n    };\n  },\n\n  /**\n   * @param {object} settings updated incoming settings\n   * @returns {void}\n   */\n  updated(settings) {\n    if (settings) {\n      this.settings = utils.mergeSettings(this.element, settings, this.settings);\n    }\n\n    this.teardown();\n    this.init();\n  },\n\n  /**\n   * @returns {void}\n   */\n  teardown() {\n    const evts = this.getInputEventNames();\n\n    this.killTimer();\n\n    $(document).off([\n      `${evts.mousedown}.${BEHAVIOR_NAME}`,\n      `${evts.mouseup}.${BEHAVIOR_NAME}`,\n      `${evts.mouseout}.${BEHAVIOR_NAME}`,\n      `${evts.mousemove}.${BEHAVIOR_NAME}`\n    ].join(' '));\n  }\n};\n\n// Setup a single instance of the LongPress behavior for export\nconst longPress = new LongPress();\n\nexport { longPress, BEHAVIOR_NAME };\n","/**\n * Hooks that match up to methods in the Personalization system,\n * that need to exist on the Soho object for backwards-compatibility reasons.\n * These exported functions end up on the Soho object during the bootstrapping process.\n * TODO: make this not the preferred way of accessing these methods, and instead\n * prefer access to the global `Personalize`\n */\nimport { personalization } from './personalize.bootstrap';\n\nexport function setTheme(theme) {\n  return personalization.setTheme(theme);\n}\n\nexport function setColors(colors) {\n  return personalization.setColors(colors);\n}\n\nexport function getColorStyleSheet(colors) {\n  return personalization.getColorStyleSheet(colors);\n}\n"]}